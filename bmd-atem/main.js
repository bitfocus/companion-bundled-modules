/*! For license information please see main.js.LICENSE.txt */
(()=>{var __webpack_modules__={131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},142:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertNever=t.ChangesTracker=void 0;const r=i(2622);t.ChangesTracker=class{#e=new Map;getResult(){return Array.from(this.#e.values())}#t(e){let t=this.#e.get(e);return t||(t={cameraId:e,changes:[],events:[],unhandledMessages:[],invalidMessages:[]},this.#e.set(e,t)),t}addChange(e,t){const i=this.#t(e);i.changes.includes(t)||i.changes.push(t)}addEvent(e,t){const i=this.#t(e);i.events.includes(t)||i.events.push(t)}addUnhandledMessage(e){this.#t(e.source).unhandledMessages.push({categoryId:e.category,parameterId:e.parameter})}checkMessageParameters(e,t,i){let a=e.properties.type===t;if(a)switch(t){case r.Commands.CameraControlDataType.BOOL:a=e.properties.boolData.length>=i;break;case r.Commands.CameraControlDataType.SINT8:case r.Commands.CameraControlDataType.SINT16:case r.Commands.CameraControlDataType.SINT32:case r.Commands.CameraControlDataType.FLOAT:a=e.properties.numberData.length>=i;break;case r.Commands.CameraControlDataType.SINT64:a=e.properties.bigintData.length>=i;break;case r.Commands.CameraControlDataType.STRING:a=e.properties.stringData.length>=i;break;default:a=!1}return a||this.#t(e.source).invalidMessages.push({categoryId:e.category,parameterId:e.parameter}),a}},t.assertNever=function(e){}},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,i="~";function r(){}function a(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function o(e,t,r,o,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new a(r,o||e,n),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function n(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),s.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,o=r.length,n=new Array(o);a<o;a++)n[a]=r[a].fn;return n},s.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,a,o,n){var s=i?i+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,a),!0;case 5:return c.fn.call(c.context,t,r,a,o),!0;case 6:return c.fn.call(c.context,t,r,a,o,n),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var p,m=c.length;for(u=0;u<m;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,a);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,i){return o(this,e,t,i,!1)},s.prototype.once=function(e,t,i){return o(this,e,t,i,!0)},s.prototype.removeListener=function(e,t,r,a){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return n(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||a&&!s.once||r&&s.context!==r||n(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||a&&!s[l].once||r&&s[l].context!==r)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:n(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&n(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=i,s.EventEmitter=s,e.exports=s},360:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,i,r){let a=(255&e)<<16|(255&t)<<8|255&i;return r&&r>=0&&r<1&&(a+=16777216*Math.round(255*(1-r))),a},t.splitRgb=a,t.splitHsl=function(e){const t=a(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=a(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=a(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()},t.parseEscapeCharacters=function(e){return e.replaceAll("\\n","\n").replaceAll("\\r","\r").replaceAll("\\t","\t").replaceAll("\\f","\f").replaceAll("\\v","\v").replaceAll("\\b","\b").replaceAll("\\\\","\\").replaceAll("\\x00","\0").replaceAll("\\x01","").replaceAll("\\x02","").replaceAll("\\x03","")},t.substituteEscapeCharacters=function(e){return e.replaceAll("\n","\\n").replaceAll("\r","\\r").replaceAll("\t","\\t").replaceAll("\f","\\f").replaceAll("\v","\\v").replaceAll("\b","\\b").replaceAll("\\","\\\\").replaceAll("\0","\\x00").replaceAll("","\\x01").replaceAll("","\\x02").replaceAll("","\\x03")};const r=i(6284);function a(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,r.colord)(e).isValid()){const t=(0,r.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}},409:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterExitHandlers=t.ThreadedClassManager=void 0;const r=i(9852),a=i(2081);Object.defineProperty(t,"ThreadedClassManager",{enumerable:!0,get:function(){return a.ThreadedClassManager}}),Object.defineProperty(t,"RegisterExitHandlers",{enumerable:!0,get:function(){return a.RegisterExitHandlers}}),(0,r.__exportStar)(i(3409),t),(0,r.__exportStar)(i(7369),t)},550:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerPlatformBase=void 0;const r=i(228);class a extends r.EventEmitter{constructor(){super(...arguments),this._isFakeProcess=!1}get isFakeProcess(){return this._isFakeProcess}}t.WorkerPlatformBase=a},681:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forkWorkerThread=t.WorkerThread=void 0;const r=i(6156),a=i(550),o=i(9896),n=i(6928),s=(0,r.getWorkerThreads)(),l=n.join(__dirname,"../../js/asar-loader.js");let u=!1;const c=process.versions.electron;if(c&&l.match(/.asar(\/|\\)/)){const[e,t]=c.split(".").map(e=>parseInt(e,10));(e<17||17===e&&t<3)&&(u=!0)}class d extends a.WorkerPlatformBase{constructor(e){if(super(),!s)throw new Error("Unable to create Worker thread! Not supported!");let t=process.env.THREADEDCLASS_WORKERTHREAD_LOADER;if(!t&&u&&(t=l),t){const i=(0,o.readFileSync)(t);this.worker=new s.Worker(i.toString(),{workerData:e,eval:!0})}else this.worker=new s.Worker(e,{workerData:""});this.worker.on("message",e=>{this.emit("message",e)}),this.worker.on("messageerror",e=>{this.emit("error",e)}),this.worker.on("error",e=>{this.emit("error",e)}),this.worker.on("exit",e=>{this.emit("close")}),this.worker.on("close",()=>{this.emit("close")})}kill(){const e=this.worker.terminate();e?e.then(()=>{this.emit("close")}).catch(e=>{console.error("Worker Thread terminate failed",e)}):this.emit("close")}send(e){this.worker.postMessage(e)}}t.WorkerThread=d,t.forkWorkerThread=function(e){return new d(e)}},994:(e,t,i)=>{"use strict";t.hn=t.YM=t.O2=void 0;const r=i(9115);t.O2=function(e,t,i){let a=e.media.players[t];return a||(a={playing:!1,loop:!1,atBeginning:!0,clipFrame:0,sourceType:r.MediaSourceType.Still,clipIndex:0,stillIndex:0},i||(e.media.players[t]=a)),a},t.YM=function(e,t,i){let a=e.video.mixEffects[t];return a||(a={index:t,programInput:0,previewInput:0,transitionPreview:!1,transitionPosition:{inTransition:!1,handlePosition:0,remainingFrames:0},transitionProperties:{style:r.TransitionStyle.MIX,selection:[r.TransitionSelection.Background],nextStyle:r.TransitionStyle.MIX,nextSelection:[r.TransitionSelection.Background]},transitionSettings:{},upstreamKeyers:[]},i||(e.video.mixEffects[t]=a)),a},t.hn=function(e,t,i){let r=e.video.superSources[t];return r||(r={index:t,boxes:[void 0,void 0,void 0,void 0]},i||(e.video.superSources[t]=r)),r}},1118:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const r=i(1635).__importDefault(i(3693)),a=i(2203),o=i(8895);class n extends r.default{#i;#r;#a;get isConnected(){return this.#i.isConnected}get isConnecting(){return this.#i.isConnecting}get isDestroyed(){return this.#i.isDestroyed}constructor(e,t,i){super(),this.#i=new o.TCPHelper(e,t,i),this.#r=new s,this.#i._socket.pipe(this.#r),this.#i.on("connect",()=>this.emit("connect")),this.#i.on("end",()=>this.emit("end")),this.#i.on("error",e=>this.emit("error",e)),this.#i.on("status_change",(e,t)=>this.emit("status_change",e,t)),this.#r.on("iac",(e,t)=>this.emit("iac",e,t)),this.#r.on("sb",e=>this.emit("sb",e)),this.#r.on("data",e=>this.emit("data",e)),this.#r.on("drain",()=>this.emit("drain")),this.#a=setTimeout(()=>{this.#a=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)},5e3)}connect(){return this.#i.connect()}async send(e){return this.#i.send(e)}destroy(){this.#i.destroy(),void 0!==this.#a&&(clearTimeout(this.#a),this.#a=void 0),this.#r.removeAllListeners(),this.#r.destroy()}}t.TelnetHelper=n;class s extends a.Transform{#o;#n;#s;constructor(e){super(e),this.#o=Buffer.alloc(0),this.#n=Buffer.alloc(0),this.#s=0}_transform(e,t,i){for(let t=0;t<e.length;++t)this.#l(e[t]);const r=this.#u();r.length&&this.push(r),i()}#l(e){if(0===this.#s){if(255===e)return void(this.#s=255);this.#o=Buffer.concat([this.#o,Buffer.from([e])])}else if(255===this.#s)switch(e){case 250:case 251:case 252:case 253:case 254:this.#s=e;break;default:this.#s=0}else{if(this.#s>=251&&this.#s<=254){let t;switch(this.#s){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#s=0)}if(250===this.#s){if(240===e)return this.emit("sb",this.#n),this.#s=0,void(this.#n=Buffer.alloc(0));this.#n=Buffer.concat([this.#n,Buffer.from([e])])}}}#u(){const e=this.#o;return this.#o=Buffer.alloc(0),e}}},1173:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlStateBuilder=void 0;const r=i(142),a=i(2558),o=i(3477),n=i(2083),s=i(6422),l=i(3796),u=i(8430);t.AtemCameraControlStateBuilder=class{#c=new Map;constructor(e){this.reset(e)}reset(e){this.#c.clear();for(let t=1;t<=e;t++)this.#c.set(t,(0,l.createEmptyState)(t))}get(e){return this.#c.get(e)}getAll(){return Array.from(this.#c.values())}#d(e){let t=this.#c.get(e);return t||(t=(0,l.createEmptyState)(e),this.#c.set(e,t)),t}applyCommands(e){if(0===e.length)return[];const t=new r.ChangesTracker;for(const i of e){const e=this.#d(i.source),l=i.category;switch(l){case u.AtemCameraControlCategory.Lens:(0,o.applyLensCommand)(t,i,e);break;case u.AtemCameraControlCategory.Video:(0,a.applyVideoCommand)(t,i,e);break;case u.AtemCameraControlCategory.Display:(0,n.applyDisplayCommand)(t,i,e);break;case u.AtemCameraControlCategory.ColorCorrection:(0,s.applyColorCorrectionCommand)(t,i,e);break;case u.AtemCameraControlCategory.Audio:case u.AtemCameraControlCategory.Output:case u.AtemCameraControlCategory.Tally:case u.AtemCameraControlCategory.Reference:case u.AtemCameraControlCategory.Configuration:case u.AtemCameraControlCategory.Media:case u.AtemCameraControlCategory.PTZControl:t.addUnhandledMessage(i);break;default:(0,r.assertNever)(l),t.addUnhandledMessage(i)}}return t.getResult()}}},1253:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=1253,e.exports=t},1400:(e,t)=>{"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(i||(t.InstanceStatus=i={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(r||(t.Regex=r={}))},1635:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__addDisposableResource:()=>$,__assign:()=>o,__asyncDelegator:()=>w,__asyncGenerator:()=>k,__asyncValues:()=>E,__await:()=>C,__awaiter:()=>b,__classPrivateFieldGet:()=>N,__classPrivateFieldIn:()=>R,__classPrivateFieldSet:()=>O,__createBinding:()=>g,__decorate:()=>s,__disposeResources:()=>V,__esDecorate:()=>u,__exportStar:()=>h,__extends:()=>a,__generator:()=>f,__importDefault:()=>M,__importStar:()=>T,__makeTemplateObject:()=>x,__metadata:()=>m,__param:()=>l,__propKey:()=>d,__read:()=>S,__rest:()=>n,__rewriteRelativeImportExtension:()=>F,__runInitializers:()=>c,__setFunctionName:()=>p,__spread:()=>v,__spreadArray:()=>I,__spreadArrays:()=>P,__values:()=>y,default:()=>B});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var o=function(){return o=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},o.apply(this,arguments)};function n(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(i[r[a]]=e[r[a]])}return i}function s(e,t,i,r){var a,o=arguments.length,n=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(n=(o<3?a(n):o>3?a(t,i,n):a(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n}function l(e,t){return function(i,r){t(i,r,e)}}function u(e,t,i,r,a,o){function n(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=r.kind,u="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?r.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),p=!1,m=i.length-1;m>=0;m--){var b={};for(var f in r)b[f]="access"===f?{}:r[f];for(var f in r.access)b.access[f]=r.access[f];b.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");o.push(n(e||null))};var g=(0,i[m])("accessor"===l?{get:d.get,set:d.set}:d[u],b);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=n(g.get))&&(d.get=s),(s=n(g.set))&&(d.set=s),(s=n(g.init))&&a.unshift(s)}else(s=n(g))&&("field"===l?a.unshift(s):d[u]=s)}c&&Object.defineProperty(c,r.name,d),p=!0}function c(e,t,i){for(var r=arguments.length>2,a=0;a<t.length;a++)i=r?t[a].call(e,i):t[a].call(e);return r?i:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,i){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function b(e,t,i,r){return new(i||(i=Promise))(function(a,o){function n(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,s)}l((r=r.apply(e,t||[])).next())})}function f(e,t){var i,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},n=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return n.next=s(0),n.throw=s(1),n.return=s(2),"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;n&&(n=0,s[0]&&(o=0)),o;)try{if(i=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var g=Object.create?function(e,t,i,r){void 0===r&&(r=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,a)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]};function h(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||g(t,e,i)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,a,o=i.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)n.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(a)throw a.error}}return n}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function P(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<i;t++)for(var o=arguments[t],n=0,s=o.length;n<s;n++,a++)r[a]=o[n];return r}function I(e,t,i){if(i||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}function C(e){return this instanceof C?(this.v=e,this):new C(e)}function k(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=i.apply(e,t||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),n("next"),n("throw"),n("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function n(e,t){a[e]&&(r[e]=function(t){return new Promise(function(i,r){o.push([e,t,i,r])>1||s(e,t)})},t&&(r[e]=t(r[e])))}function s(e,t){try{(i=a[e](t)).value instanceof C?Promise.resolve(i.value.v).then(l,u):c(o[0][2],i)}catch(e){c(o[0][3],e)}var i}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function w(e){var t,i;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,a){t[r]=e[r]?function(t){return(i=!i)?{value:C(e[r](t)),done:!1}:a?a(t):t}:a}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=y(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise(function(r,a){!function(e,t,i,r){Promise.resolve(r).then(function(t){e({value:t,done:i})},t)}(r,a,(t=e[i](t)).done,t.value)})}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var _=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},A=function(e){return A=Object.getOwnPropertyNames||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[t.length]=i);return t},A(e)};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i=A(e),r=0;r<i.length;r++)"default"!==i[r]&&g(t,e,i[r]);return _(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function N(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)}function O(e,t,i,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,i):a?a.value=i:t.set(e,i),i}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function $(e,t,i){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,a;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],i&&(a=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");a&&(r=function(){try{a.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:i})}else i&&e.stack.push({async:!0});return t}var D="function"==typeof SuppressedError?SuppressedError:function(e,t,i){var r=new Error(i);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function V(e){function t(t){e.error=e.hasError?new D(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var i,r=0;return function a(){for(;i=e.stack.pop();)try{if(!i.async&&1===r)return r=0,e.stack.push(i),Promise.resolve().then(a);if(i.dispose){var o=i.dispose.call(i.value);if(i.async)return r|=2,Promise.resolve(o).then(a,function(e){return t(e),a()})}else r|=1}catch(e){t(e)}if(1===r)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function F(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,i,r,a,o){return i?t?".jsx":".js":!r||a&&o?r+a+"."+o.toLowerCase()+"js":e}):e}const B={__extends:a,__assign:o,__rest:n,__decorate:s,__param:l,__esDecorate:u,__runInitializers:c,__propKey:d,__setFunctionName:p,__metadata:m,__awaiter:b,__generator:f,__createBinding:g,__exportStar:h,__values:y,__read:S,__spread:v,__spreadArrays:P,__spreadArray:I,__await:C,__asyncGenerator:k,__asyncDelegator:w,__asyncValues:E,__makeTemplateObject:x,__importStar:T,__importDefault:M,__classPrivateFieldGet:N,__classPrivateFieldSet:O,__classPrivateFieldIn:R,__addDisposableResource:$,__disposeResources:V,__rewriteRelativeImportExtension:F}},1649:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const r=i(1635),a=i(360),o=r.__importDefault(i(3290)),n=i(2593),s=i(1706),l=i(8039),u=i(4044),c=i(4289),d=i(2365);t.InstanceBase=class{#p;#m;id;#b=new o.default({concurrency:1});#f=!1;#g=!1;#h={};#y={};#S;#v;#P=new Map;#I=new Map;#C=new Map;#k;#w;get instanceOptions(){return this.#k}get label(){return this.#w}constructor(e){if(!(0,n.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#k={disableVariableValidation:!1},this.#p=new u.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),upgradeActionsAndFeedbacks:this._handleUpgradeActionsAndFeedbacks.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:async()=>{},sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},e=>{process.send(e)},5e3),process.on("message",e=>{this.#p.receivedMessage(e)});const t=async e=>e.text.includes("$(")?this.#p.sendWithCb("parseVariablesInString",e):{text:e.text,variableIds:void 0};this.#S=new c.ActionManager(t,e=>this.#p.sendWithNoCb("setActionDefinitions",e),e=>this.#p.sendWithNoCb("setCustomVariable",e),this.log.bind(this)),this.#v=new l.FeedbackManager(t,e=>this.#p.sendWithNoCb("updateFeedbackValues",e),e=>this.#p.sendWithNoCb("setFeedbackDefinitions",e),this.log.bind(this)),this.#m=e.upgradeScripts,this.id=e.id,this.#w=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#b.add(async()=>{if(this.#f)throw new Error("Already initialized");if(this.#h=e.config,this.#y=e.secrets,this.#w=e.label,e.isFirstInit){const t={},i={},r=this.getConfigFields();for(const e of r)"default"in e&&(e.type.startsWith("secret")?i[e.id]=e.default:t[e.id]=e.default);this.#h=t,this.#y=i,this.saveConfig(this.#h,this.#y),e.lastUpgradeIndex=this.#m.length-1}const{updatedConfig:t,updatedSecrets:i}=(0,s.runThroughUpgradeScripts)([],[],e.lastUpgradeIndex,this.#m,this.#h,this.#y,!1);this.#h=t??this.#h,this.#y=i??this.#y;try{await this.init(this.#h,!!e.isFirstInit,this.#y),this.#f=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}return{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#m.length-1,updatedConfig:this.#h,updatedSecrets:this.#y}})}async _handleDestroy(){await this.#b.add(async()=>{if(!this.#f)throw new Error("Not initialized");await this.destroy(),this.#f=!1})}async _handleConfigUpdateAndLabel(e){await this.#b.add(async()=>{if(!this.#f)throw new Error("Not initialized");this.#w=e.label,this.#h=e.config,await this.configUpdated(this.#h,this.#y)})}async _handleExecuteAction(e){return this.#S.handleExecuteAction(e)}async _handleUpdateFeedbacks(e){this.#v.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e){this.#S.handleUpdateActions(e.actions)}async _handleUpgradeActionsAndFeedbacks(e){return(0,s.runThroughUpgradeScripts)(e.actions,e.feedbacks,null,this.#m,this.#h,this.#y,!0)}async _handleGetConfigFields(e){return{fields:(0,n.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#S.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#v.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#g)return}else if(!this.#g)return;if(!this.handleStartStopRecordActions)throw this.#g=!1,new Error("Recording actions is not supported by this module!");this.#g=e.recording,this.handleStartStopRecordActions(this.#g)}async _handleSharedUdpSocketMessage(e){for(const t of this.#P.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#P.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e,t){e&&(this.#h=e),t&&(this.#y=t),this.#p.sendWithNoCb("saveConfig",{config:e,secrets:t})}setActionDefinitions(e){this.#S.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#v.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[i,r]of Object.entries(e))r&&t.push({...r,id:i});this.#p.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],i=[];this.#I.clear();for(const r of e)t.push({id:r.variableId,name:r.name}),this.#I.set(r.variableId,r),this.#C.has(r.variableId)||(this.#C.set(r.variableId,""),i.push({id:r.variableId,value:""}));if(!this.#k.disableVariableValidation){const e=new Set(this.#I.keys());for(const t of this.#C.keys())e.has(t)||(this.#C.delete(t),i.push({id:t,value:void 0}))}this.#p.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:i})}setVariableValues(e){const t=[];for(const[i,r]of Object.entries(e))this.#k.disableVariableValidation?(void 0===r?this.#C.delete(i):this.#C.set(i,r),t.push({id:i,value:r})):this.#I.has(i)?(this.#C.set(i,r??""),t.push({id:i,value:r??""})):t.push({id:i,value:void 0});this.#p.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#C.get(e)}async parseVariablesInString(e){const t=this.#v.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),e.includes("$(")?(await this.#p.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text:e}checkFeedbacks(...e){this.#v.checkFeedbacks(e)}checkFeedbacksById(...e){this.#v.checkFeedbacksById(e)}subscribeActions(...e){this.#S.subscribeActions(e)}unsubscribeActions(...e){this.#S.unsubscribeActions(e)}subscribeFeedbacks(...e){this.#v.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#v.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#g)throw new Error("Not currently recording actions");this.#p.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}oscSend(e,t,i,r){this.#p.sendWithNoCb("send-osc",(0,a.literal)({host:e,port:t,path:i,args:r}))}updateStatus(e,t){this.#p.sendWithNoCb("set-status",(0,a.literal)({status:e,message:t??null}))}log(e,t){this.#p.sendWithNoCb("log-message",(0,a.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const i="string"==typeof e?{type:e}:e,r=new d.SharedUdpSocketImpl(this.#p,this.#P,i);return t&&r.on("message",t),r}}},1706:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=function(e,t,i,o,n,s,l){const u=new Map,c=e=>{let t=u.get(e);return t||(t={actions:[],feedbacks:[],config:!1},u.set(e,t)),t};for(const t of e){const e=t?.upgradeIndex??i;t&&"number"==typeof e&&c(e).actions.push(t.id)}for(const e of t){const t=e?.upgradeIndex??i;e&&"number"==typeof t&&c(t).feedbacks.push(e.id)}if(!l)for(let e=i??-1;e<o.length;e++)c(e).config=!0;const d=Object.fromEntries(e.map(e=>[e.id,e])),p=Object.fromEntries(t.map(e=>[e.id,e])),m={},b={};let f,g;if(u.size>0){const e=Array.from(u.keys()).sort(),t=Math.min(...e,i??-1)+1,l=[],c=[],h=o.length;for(let e=t;e<h;e++){const t=u.get(e-1);t&&(l.push(...t.actions),c.push(...t.feedbacks));const i=!!t?.config;if(!i&&0===l.length&&0===c.length)continue;const h=f??n,y=g??s,S=(0,o[e])({currentConfig:a(h)},{config:i?h:null,secrets:i?y:null,actions:l.map(e=>{const t=d[e];if(t)return(0,r.literal)({id:t.id,controlId:t.controlId,actionId:t.actionId,options:void 0!==t.options?a(t.options):{}})}).filter(e=>!!e),feedbacks:c.map(e=>{const t=p[e];if(t)return(0,r.literal)({id:t.id,controlId:t.controlId,feedbackId:t.feedbackId,options:void 0!==t.options?a(t.options):{},isInverted:t.isInverted})}).filter(e=>!!e)});i&&S.updatedConfig&&(f=S.updatedConfig),i&&S.updatedSecrets&&(g=S.updatedSecrets);for(const t of S.updatedActions)if(t){const i=d[t.id];i&&(i.actionId=t.actionId,i.options=t.options,i.upgradeIndex=e,b[t.id]=i)}for(const t of S.updatedFeedbacks)if(t){const i=p[t.id];i&&(i.feedbackId=t.feedbackId,i.options=t.options,i.upgradeIndex=e,m[t.id]={...i,style:m[t.id]?.style??t.style,isInverted:t.isInverted??!1})}}for(const[e,t]of Object.entries(d))b[e]||"number"!=typeof t?.upgradeIndex||(b[e]=t);for(const[e,t]of Object.entries(p))m[e]||"number"!=typeof t?.upgradeIndex||(m[e]=t)}return{updatedActions:Object.values(b),updatedFeedbacks:Object.values(m),updatedConfig:f,updatedSecrets:g,latestUpgradeIndex:o.length-1}};const r=i(360);function a(e){return JSON.parse(JSON.stringify(e))}},1943:e=>{"use strict";e.exports=require("fs/promises")},2017:e=>{"use strict";e.exports=function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;var r,a,o;if(Array.isArray(t)){if((r=t.length)!=i.length)return!1;for(a=r;0!==a--;)if(!e(t[a],i[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(a=r;0!==a--;)if(!Object.prototype.hasOwnProperty.call(i,o[a]))return!1;for(a=r;0!==a--;){var n=o[a];if(!e(t[n],i[n]))return!1}return!0}return t!=t&&i!=i}},2018:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(1635);r.__exportStar(i(3730),t),r.__exportStar(i(1649),t),r.__exportStar(i(7386),t),r.__exportStar(i(1400),t),r.__exportStar(i(8983),t),r.__exportStar(i(8104),t),r.__exportStar(i(3258),t),r.__exportStar(i(131),t),r.__exportStar(i(3371),t),r.__exportStar(i(9786),t),r.__exportStar(i(6132),t)},2077:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoSharpeningLevel=void 0,function(e){e[e.Off=0]="Off",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(i||(t.VideoSharpeningLevel=i={}))},2081:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadedClassManager=t.ThreadedClassManagerInternal=t.ThreadMode=t.ThreadedClassManagerClassInternal=t.childName=t.ThreadedClassManagerClass=t.RegisterExitHandlers=void 0;const r=i(9852),a=i(4468),o=i(3409),n=i(6156),s=i(2557),l=i(681),u=i(7963),c=i(9599);var d,p;!function(e){e[e.AUTO=-1]="AUTO",e[e.YES=1]="YES",e[e.NO=0]="NO"}(d=t.RegisterExitHandlers||(t.RegisterExitHandlers={}));class m{constructor(e){this._internal=e}set debug(e){this._internal.debug=e}get debug(){return this._internal.debug}set strict(e){this._internal.strict=e}get strict(){return this._internal.strict}set handleExit(e){this._internal.handleExit=e}get handleExit(){return this._internal.handleExit}destroy(e){return this._internal.killProxy(e)}destroyAll(){return this._internal.killAllChildren()}getThreadCount(){return this._internal.getChildrenCount()}getThreadsMemoryUsage(){return this._internal.getMemoryUsage()}onEvent(e,t,i){return this._internal.onProxyEvent(e,t,i)}restart(e,t){return this._internal.restart(e,t)}getThreadMode(){return(0,n.isBrowser)()?(0,n.browserSupportsWebWorkers)()?p.WEB_WORKER:p.NOT_SUPPORTED:(0,n.nodeSupportsWorkerThreads)()?p.WORKER_THREADS:p.CHILD_PROCESS}}function b(e){return`Child_ ${Object.keys(e.instances).join(",")}`}t.ThreadedClassManagerClass=m,t.childName=b;class f{constructor(){this.handleExit=d.AUTO,this.isInitialized=!1,this._threadId=0,this._instanceId=0,this._methodId=0,this._children={},this._pinging=!0,this.debug=!1,this.strict=!1,this.uniqueId=Date.now()%1e4,this._proxyEventListeners=new Map,this._childInitializedListeners=new n.ArrayMap}findNextAvailableChild(e,t){this._init();let i=null;if(e.threadId?i=this._children[e.threadId]||null:e.threadUsage&&(i=this._findFreeChild(e.threadUsage)),!i){const r={id:e.threadId||`process_${this.uniqueId}_${this._threadId++}`,isNamed:!!e.threadId,pathToWorker:t,process:this._createFork(e,t),usage:e.threadUsage||1,instances:{},methods:{},alive:!0,isClosing:!1,config:e,autoRestartFailCount:0,autoRestartRetryTimeout:void 0,cmdId:0,instanceMessageQueue:{},childMessageQueue:{},callbackId:0,callbacks:{}};this._setupChildProcess(r),this._children[r.id]=r,i=r,this.debug&&this.consoleLog(`New child: "${r.id}"`)}return i}attachInstanceToChild(e,t,i,r,a,o,n){const s={id:`instance_${this.uniqueId}_${this._instanceId++}`+(e.instanceName?`_${e.instanceName}`:""),child:t,proxy:i,usage:e.threadUsage,freezeLimit:e.freezeLimit,onMessageCallback:n,pathToModule:r,exportName:a,constructorArgs:o,initialized:!1,config:e};return t.instances[s.id]=s,this.debug&&this.consoleLog(`Add instance "${s.id}" to "${t.id}"`),s}killProxy(e){return new Promise((t,i)=>{let r=!1;for(const o of Object.keys(this._children)){const n=this._children[o],s=this.findProxyInstanceOfChild(n,e);if(s){let e=n.instances[s];if(r=!0,1===Object.keys(n.instances).length)this.killChild(o,"no instances left").then(t).catch(i);else{const r=()=>{delete n.instances[s]};this.sendMessageToInstance(e,{cmd:a.Message.To.Instance.CommandType.KILL},()=>{r(),t()}),setTimeout(()=>{r(),i("Timeout: Kill child instance")},1e3),e.usage&&(n.usage-=e.usage)}break}}r||i("killProxy: Proxy not found")})}sendMessageToInstance(e,t,i){try{if(!e.child)throw new Error(`Instance ${e.id} has been detached from child process`);if(!e.child.alive)throw new Error(`Child process of instance ${e.id} has been closed`);if(e.child.isClosing)throw new Error(`Child process of instance ${e.id} is closing`);const r=Object.assign(Object.assign({},t),{messageType:"instance",cmdId:e.child.cmdId++,instanceId:e.id});if(r.cmd!==a.Message.To.Instance.CommandType.INIT&&!e.initialized)throw Error(`Child instance ${e.id} is not initialized`);i&&(e.child.instanceMessageQueue[r.cmdId+""]=i);try{e.child.process.send(r)}catch(t){throw delete e.child.instanceMessageQueue[r.cmdId+""],(t.toString()||"").match(/circular structure/)?new Error(`Unsupported attribute (circular structure) in instance ${e.id}: `+t.toString()):t}}catch(t){if(!i)throw t;i(e,(t.stack||t).toString())}}sendMessageToChild(e,t,i){try{if(!e.alive)throw new Error(`Child process ${e.id} has been closed`);if(e.isClosing)throw new Error(`Child process  ${e.id} is closing`);const r=Object.assign(Object.assign({},t),{messageType:"child",cmdId:e.cmdId++});i&&(e.childMessageQueue[r.cmdId+""]=i);try{e.process.send(r)}catch(t){throw delete e.childMessageQueue[r.cmdId+""],(t.toString()||"").match(/circular structure/)?new Error(`Unsupported attribute (circular structure) in child ${e.id}: `+t.toString()):t}}catch(e){if(!i)throw e;i((e.stack||e).toString())}}getChildrenCount(){return Object.keys(this._children).length}getMemoryUsage(){return(0,r.__awaiter)(this,void 0,void 0,function*(){const e={};return yield Promise.all(Object.keys(this._children).map(t=>new Promise(i=>{const r=this._children[t];this.sendMessageToChild(r,{cmd:a.Message.To.Child.CommandType.GET_MEM_USAGE},(o,n)=>{const s=n&&(0,a.decodeArguments)(()=>null,[n],()=>()=>Promise.resolve())[0],l=Object.assign(Object.assign({},o?{error:o.toString()}:s||{error:"unknown"}),{description:this.getChildDescriptor(r)});e[t]=l,i()})}))),e})}killAllChildren(){return Promise.all(Object.keys(this._children).map(e=>{const t=this._children[e];return this.debug&&this.consoleLog(`Killing child "${this.getChildDescriptor(t)}"`),this.killChild(e,"killAllChildren")})).then(()=>{})}restart(e,t){return(0,r.__awaiter)(this,void 0,void 0,function*(){let i,r;for(const t of Object.values(this._children)){const a=this.findProxyInstanceOfChild(t,e);if(a){i=t.instances[a],r=t;break}}if(!r)throw Error("Child of proxy not found");if(!i)throw Error("Instance of proxy not found");yield this.restartChild(r,[i],t)})}restartChild(e,t,i){return(0,r.__awaiter)(this,void 0,void 0,function*(){e.alive&&i&&(yield this.killChild(e,"restart child",!1)),this.clearRestartTimeout(e),e.alive||(e.process.removeAllListeners(),Object.keys(e.instances).forEach(t=>{e.instances[t].initialized=!1}),e.alive=!0,e.isClosing=!1,e.process=this._createFork(e.config,e.pathToWorker),this._setupChildProcess(e));const r=[new Promise((t,i)=>{var r;let n;if(0!==e.config.restartTimeout){const t=null!==(r=e.config.restartTimeout)&&void 0!==r?r:a.DEFAULT_RESTART_TIMEOUT;n=setTimeout(()=>{i(new o.RestartTimeoutError(`Timeout when trying to restart after ${t}`)),this._childInitializedListeners.remove(e.id,s)},t)}const s=()=>{n&&clearTimeout(n),t(),this._childInitializedListeners.remove(e.id,s)};this._childInitializedListeners.push(e.id,s)})];(t||Object.keys(e.instances).map(t=>e.instances[t])).forEach(t=>{r.push(new Promise((i,r)=>{this.sendInit(e,t,t.config,(e,t)=>(t?r(t):i(),!0))}))}),yield Promise.all(r)})}canRetryRestart(e){var t;const i=null!==(t=e.config.autoRestartRetryCount)&&void 0!==t?t:a.DEFAULT_AUTO_RESTART_RETRY_COUNT;return 0===i||e.autoRestartFailCount<i}sendInit(e,i,r,o){let n=(0,a.encodeArguments)(i,i.child.callbacks,i.constructorArgs,!!r.disableMultithreading),s={cmd:a.Message.To.Instance.CommandType.INIT,modulePath:i.pathToModule,exportName:i.exportName,args:n,config:r,parentPid:process.pid};i.initialized=!0,t.ThreadedClassManagerInternal.sendMessageToInstance(i,s,(t,i,r)=>{if(!o||o(t,i,r)){const t=this._childInitializedListeners.get(e.id);if(t)for(const e of t)e()}})}startMonitoringChild(e){var t;const i=null!==(t=e.freezeLimit)&&void 0!==t?t:a.DEFAULT_CHILD_FREEZE_TIME;if(0===i)return;const r=()=>{e.child&&e.child.alive&&this._pinging&&this._pingChild(e,i).then(()=>{setTimeout(()=>{r()},i)}).catch(()=>{e.child&&e.child.alive&&!e.child.isClosing&&this._childHasCrashed(e.child,`Child process ("${this.getChildDescriptor(e.child)}") of instance ${e.id} ping timeout`)})};setTimeout(()=>{r()},i)}doMethod(e,t,i){const r="m"+this._methodId++;return new Promise((a,o)=>{e.methods[r]={methodName:t,resolve:a,reject:o},i(a,o)}).then(t=>(delete e.methods[r],t)).catch(t=>{throw delete e.methods[r],t})}getChildDescriptor(e){return`${e.id} (${Object.keys(e.instances).join(", ")})`}checkInstance(e,t){if(!this.strict)return;const i=()=>`${t.stack}`.split("\n").slice(2).join("\n");setTimeout(()=>{const t=this._proxyEventListeners.get(e.proxy);t&&0!==t.arraySize("error")||this.consoleLog(`Warning: No listener for the 'error' event was registered,\nSolve this by adding\nThreadedClassManager.onEvent(instance, 'error', (error) => {})\n${i()}`),t&&0!==t.arraySize("warning")||this.consoleLog(`Warning: No listener for the 'warning' event was registered,\nSolve this by adding\nThreadedClassManager.onEvent(instance, 'warning', (warning) => {})\n${i()}`),e.config.autoRestart?t&&0!==t.arraySize("restarted")||this.consoleLog(`Warning: No listener for the 'restarted' event was registered.\nIt is recommended to set up an event listener for this, so you are aware of that an instance has been restarted:\nuse ThreadedClassManager.onEvent(instance, 'restarted', () => {})\n${i()}`):t&&0!==t.arraySize("thread_closed")||this.consoleLog(`Warning: autoRestart is disabled and no listener for the 'thread_closed' event was registered.\nSolve this by either set {autoRestart: true} in threadedClass() options, or set up an event listener to handle a restart:\nuse ThreadedClassManager.onEvent(instance, 'thread_closed', () => {})\nat ${i()}`)},1)}onProxyEvent(e,t,i){let r=this._proxyEventListeners.get(e);return r||(r=new n.ArrayMap),r.push(t,i),this._proxyEventListeners.set(e,r),{stop:()=>{const r=this._proxyEventListeners.get(e);r&&(r.remove(t,i),r.size>0?this._proxyEventListeners.set(e,r):this._proxyEventListeners.delete(e))}}}_emitProxyEvent(e,t,...i){for(const r of Object.values(e.instances)){const e=this._proxyEventListeners.get(r.proxy);if(e){const r=e.get(t);if(r)for(const e of r)try{e(...i)}catch(e){this.consoleLog(`Error in event listener for "${t}":`,e)}}}}_init(){if(!this.isInitialized&&!(0,n.isBrowser)()){let e;switch(this.handleExit){case d.YES:e=!0;break;case d.AUTO:0===process.listenerCount("exit")||0===process.listenerCount("uncaughtException")||0===process.listenerCount("unhandledRejection")?(this.consoleLog("Skipping exit handler registration as no exit handler is registered"),e=!1):e=!0;break;default:e=!1}if(e){process.stdin.resume();const e=(e,t)=>{let i=`Signal "${e}" event`;t&&(i+=", "+t),1===process.listenerCount(e)?console.error(i):this.debug&&this.consoleLog(i),this.killAllChildren().catch(this.consoleError),process.exit()};process.on("exit",t=>e("exit",`exit code: ${t}`)),process.on("SIGINT",()=>e("SIGINT")),process.on("SIGHUP",()=>e("SIGHUP")),process.on("SIGTERM",()=>e("SIGTERM")),process.on("SIGUSR1",()=>e("SIGUSR1")),process.on("SIGUSR2",()=>e("SIGUSR2")),process.on("uncaughtException",t=>e("uncaughtException",t.toString())),process.on("unhandledRejection",t=>e("unhandledRejection",t?t.toString():void 0))}}this.isInitialized=!0}_pingChild(e,i){return new Promise((r,o)=>{let n={cmd:a.Message.To.Instance.CommandType.PING};const s=setTimeout(()=>{o()},i);t.ThreadedClassManagerInternal.sendMessageToInstance(e,n,(e,t)=>{clearTimeout(s),t?(this.consoleError(t),o(t)):r()})})}_childHasCrashed(e,t){if(this.rejectChildMethods(e,t),!e.isClosing){let i=!1;const r=[];Object.keys(e.instances).forEach(t=>{const a=e.instances[t];a.config.autoRestart&&(i=!0,r.push(a))}),i?this.restartChild(e,r,!0).then(()=>{e.autoRestartFailCount=0,this._emitProxyEvent(e,"restarted")}).catch(t=>{e.autoRestartFailCount++,this.canRetryRestart(e)?(this._emitProxyEvent(e,"warning",`Error when restarting child, trying again... Original error: ${t}`),this.killChild(e,"error when restarting",!1).catch(t=>{this.consoleError(`Could not kill child: "${e.id}"`,t)}).then(()=>{var t;const i=null!==(t=e.config.autoRestartRetryDelay)&&void 0!==t?t:a.DEFAULT_AUTO_RESTART_RETRY_DELAY;e.autoRestartRetryTimeout=setTimeout(()=>{this._childHasCrashed(e,"restart failed")},i)}).catch(t=>{this.consoleError(`Unknown error: "${e.id}"`,t)})):(this._emitProxyEvent(e,"error",t),this.debug&&this.consoleError("Error when running restartChild()",t),this.killChild(e,"timeout when restarting",!0).catch(t=>{this.consoleError(`Could not kill child: "${e.id}"`,t)}))}):e.alive&&this.killChild(e,`child has crashed (${t})`,!1).catch(t=>{this._emitProxyEvent(e,"error",t),this.debug&&this.consoleError("Error when running killChild()",t)})}}clearRestartTimeout(e){void 0!==e.autoRestartRetryTimeout&&(clearTimeout(e.autoRestartRetryTimeout),e.autoRestartRetryTimeout=void 0)}_createFork(e,t){return e.disableMultithreading?new c.FakeProcess:(0,n.isBrowser)()?(0,s.forkWebWorker)(t):(0,n.nodeSupportsWorkerThreads)()?(0,l.forkWorkerThread)(t):(0,u.forkChildProcess)(t)}_setupChildProcess(e){e.process.on("close",()=>{e.alive&&(e.alive=!1,this._emitProxyEvent(e,"thread_closed"),this._childHasCrashed(e,`Child process "${b(e)}" was closed`))}),e.process.on("error",t=>{this._emitProxyEvent(e,"error",t),this.debug&&this.consoleError("Error from child "+e.id,t)}),e.process.on("message",t=>{if("child"===t.messageType)try{this._onMessageFromChild(e,t)}catch(i){throw this.debug&&this.consoleError(`Error in onMessageCallback in child ${e.id}`,t,i),i}else if("instance"===t.messageType){const i=e.instances[t.instanceId];if(i)try{i.onMessageCallback(i,t)}catch(e){throw this.debug&&this.consoleError(`Error in onMessageCallback in instance ${i.id}`,t,i,e),e}else{const i=new Error(`Instance "${t.instanceId}" not found. Received message "${t.messageType}" from child "${e.id}", "${b(e)}"`);this._emitProxyEvent(e,"error",i),this.debug&&this.consoleError(i)}}else{const i=new Error(`Unknown messageType "${t.messageType}"!`);this._emitProxyEvent(e,"error",i),this.debug&&this.consoleError(i)}})}_onMessageFromChild(e,t){if(t.cmd===a.Message.From.Child.CommandType.LOG)console.log(e.id,...t.log);else if(t.cmd===a.Message.From.Child.CommandType.REPLY){let i=t,r=e.childMessageQueue[i.replyTo+""];if(!r)return;i.error?r(i.error):r(null,i.reply),delete e.instanceMessageQueue[i.replyTo+""]}else if(t.cmd===a.Message.From.Child.CommandType.CALLBACK){let i=t,r=e.callbacks[i.callbackId];if(!r)throw Error(`callback "${i.callbackId}" not found in child ${e.id}`);try{Promise.resolve(r(...i.args)).then(t=>{let r=(0,a.encodeArguments)({},e.callbacks,[t],!!e.process.isFakeProcess);this._sendReplyToChild(e,i.cmdId,void 0,r[0])}).catch(t=>{this._replyErrorToChild(e,i,t)})}catch(t){this._replyErrorToChild(e,i,t)}}}_replyErrorToChild(e,t,i){this._sendReplyToChild(e,t.cmdId,i)}_sendReplyToChild(e,t,i,r,o){let n={cmd:a.Message.To.Child.CommandType.REPLY,replyTo:t,reply:r,error:i?(i.stack||i).toString():i};this.sendMessageToChild(e,n,o)}_findFreeChild(e){let t=Object.keys(this._children).find(t=>{const i=this._children[t];return!i.isNamed&&i.usage+e<=1});if(t){const i=this._children[t];return i.usage+=e,i}return null}killChild(e,t,i=!0){return new Promise((r,n)=>{var s;let l;if("string"==typeof e){const t=e;if(l=this._children[t],!l)return void n(`killChild: Child ${t} not found`)}else l=e;if(this.debug&&this.consoleLog(`Killing child ${l.id} due to: ${t}`),l)if(i&&this.clearRestartTimeout(l),l.alive){let e;const t=null!==(s=l.config.killTimeout)&&void 0!==s?s:a.DEFAULT_KILL_TIMEOUT;0!==t&&(e=setTimeout(()=>{i&&delete this._children[l.id],n(new o.KillTimeoutError(`Timeout: Kill child process "${l.id}"`))},t)),l.process.once("close",()=>{i&&(Object.entries(l.instances).forEach(([e,t])=>{delete l.instances[e];const i=this._proxyEventListeners.get(t.proxy);null==i||i.clear(),this._proxyEventListeners.delete(t.proxy)}),delete this._children[l.id]),e&&clearTimeout(e),l.isClosing=!1,r()}),l.isClosing||(l.isClosing=!0,l.process.kill())}else i&&delete this._children[l.id],l.isClosing=!1,r()})}rejectChildMethods(e,t){Object.keys(e.methods).forEach(i=>{const r=e.methods[i];r.reject(Error(`Method "${r.methodName}()" aborted due to: ${t}`))}),e.methods={}}consoleError(...e){console.error(`ThreadedClass Error (${this.uniqueId})`,...e)}consoleLog(...e){console.log(`ThreadedClass (${this.uniqueId})`,...e)}findProxyInstanceOfChild(e,t){for(const i of Object.keys(e.instances))if(e.instances[i].proxy===t)return i}}t.ThreadedClassManagerClassInternal=f,function(e){e.WEB_WORKER="web_worker",e.NOT_SUPPORTED="not_supported",e.WORKER_THREADS="worker_threads",e.CHILD_PROCESS="child_process"}(p=t.ThreadMode||(t.ThreadMode={})),t.ThreadedClassManagerInternal=new f,t.ThreadedClassManager=new m(t.ThreadedClassManagerInternal)},2083:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyDisplayCommand=void 0;const r=i(2622),a=i(142),o=i(8430);t.applyDisplayCommand=function(e,t,i){const n=t.parameter;switch(n){case o.AtemCameraControlDisplayParameter.ColorBarEnable:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.SINT8,1))return;return i.display.colorBarEnable=t.properties.numberData[0]>1,void e.addChange(t.source,"lens.focus");case o.AtemCameraControlDisplayParameter.Brightness:case o.AtemCameraControlDisplayParameter.ExposureAndFocusTools:case o.AtemCameraControlDisplayParameter.ZebraLevel:case o.AtemCameraControlDisplayParameter.PeakingLevel:case o.AtemCameraControlDisplayParameter.FocusAssist:case o.AtemCameraControlDisplayParameter.ProgramReturnFeedEnable:case o.AtemCameraControlDisplayParameter.TimecodeSource:return void e.addUnhandledMessage(t);default:return(0,a.assertNever)(n),void e.addUnhandledMessage(t)}}},2203:e=>{"use strict";e.exports=require("stream")},2365:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const r=i(1635).__importDefault(i(3693)),a=i(360);class o extends r.default{#p;#E;#k;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#s&&"object"==typeof this.#s?this.#s:void 0}#s="pending";constructor(e,t,i){super(),this.#p=e,this.#E=t,this.#k={...i}}bind(e,t,i){if(this.#s&&"object"==typeof this.#s)throw new Error("Socket is already bound");switch(this.#s){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,a.assertNever)(this.#s),new Error("Invalid socket state")}this.#s="binding",i&&this.on("listening",i),this.#p.sendWithCb("sharedUdpSocketJoin",{family:this.#k.type,portNumber:e}).then(t=>{this.#s={portNumber:e,handleId:t},this.#E.set(t,this),this.emit("listening")},e=>{this.#s="closed",this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}close(e){if(this.#s&&"object"==typeof this.#s);else switch(this.#s){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,a.assertNever)(this.#s),new Error("Invalid socket state")}const t=this.#s.handleId;this.#s="closed",e&&this.on("close",e),this.#p.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then(()=>{this.#E.delete(t),this.emit("close")},e=>{this.#E.delete(t),this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}send(e,t,i,r,a,o){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof i){if("number"!=typeof r||"string"!=typeof a)throw new Error("Invalid arguments");if(void 0!==o&&"function"!=typeof o)throw new Error("Invalid arguments");const n=this.#x(e,t,i);this.#_(n,r,a,o)}else{if("string"!=typeof i)throw new Error("Invalid arguments");{if(void 0!==r&&"function"!=typeof r)throw new Error("Invalid arguments");const a=this.#x(e,0,void 0);this.#_(a,t,i,r)}}}#x(e,t,i){let r;if("string"==typeof e)r=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))r=e;else{if(Array.isArray(e))return Buffer.from(e);r=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return r.subarray(t,void 0!==i?i+t:void 0)}#_(e,t,i,r){if(!this.#s||"object"!=typeof this.#s)throw new Error("Socket is not open");this.#p.sendWithCb("sharedUdpSocketSend",{handleId:this.#s.handleId,message:e,address:i,port:t}).then(()=>{r?.()},e=>{this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#s="fatalError";const t=this.boundState;t&&this.#E.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=o},2557:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forkWebWorker=t.WebWorkerProcess=void 0;const r=i(550);class a extends r.WorkerPlatformBase{constructor(e){super();try{this.worker=new window.Worker(e),this.worker.onmessage=e=>{"message"===e.type?this.emit("message",e.data):console.log("unknown message type",e)},this.worker.onmessageerror=e=>{this.emit("error",e)},this.worker.onerror=e=>{this.emit("error",e)}}catch(e){let t=(e.stack||e).toString()+"";throw t.match(/cannot be accessed from origin/)&&t.match(/file:\/\//)?Error("Unable to create Web-Worker. Not allowed to run from local file system.\n"+t):e}}kill(){this.worker.terminate(),this.emit("close")}send(e){this.worker.postMessage(e)}}t.WebWorkerProcess=a,t.forkWebWorker=function(e){return new a(e)}},2558:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyVideoCommand=void 0;const r=i(2622),a=i(142),o=i(8430),n=i(2697);t.applyVideoCommand=function(e,t,i){const s=t.parameter;switch(s){case o.AtemCameraControlVideoParameter.GainCamera4_9:return;case o.AtemCameraControlVideoParameter.ManualWhiteBalance:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.SINT16,2))return;return i.video.whiteBalance=[t.properties.numberData[0],t.properties.numberData[1]],void e.addChange(t.source,"video.whiteBalance");case o.AtemCameraControlVideoParameter.SetAutoWhiteBalance:return void e.addEvent(t.source,n.AtemCameraControlEvents.VideoAutoWhiteBalance);case o.AtemCameraControlVideoParameter.ExposureUs:{if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.SINT32,1))return;const a=1e6/t.properties.numberData[0],o=a>1e3?10*Math.round(a/10):Math.round(a);return i.video.exposure=t.properties.numberData[0],i.video.shutterSpeed=o,e.addChange(t.source,"video.exposure"),void e.addChange(t.source,"video.shutterSpeed")}case o.AtemCameraControlVideoParameter.VideoSharpeningLevel:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.SINT8,1))return;return i.video.videoSharpeningLevel=t.properties.numberData[0],void e.addChange(t.source,"video.videoSharpeningLevel");case o.AtemCameraControlVideoParameter.Gain:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.SINT8,1))return;return i.video.gain=t.properties.numberData[0],void e.addChange(t.source,"video.gain");case o.AtemCameraControlVideoParameter.NDFilterStop:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,1))return;return i.video.ndFilterStop=t.properties.numberData[0],void e.addChange(t.source,"video.ndFilterStop");case o.AtemCameraControlVideoParameter.VideoMode:case o.AtemCameraControlVideoParameter.RestoreAutoWhiteBalance:case o.AtemCameraControlVideoParameter.ExposureOrdinal:case o.AtemCameraControlVideoParameter.DynamicRangeMode:case o.AtemCameraControlVideoParameter.RecordingFormat:case o.AtemCameraControlVideoParameter.SetAutoExpsureMode:case o.AtemCameraControlVideoParameter.ShutterAngle:case o.AtemCameraControlVideoParameter.ShutterSpeed:case o.AtemCameraControlVideoParameter.ISO:case o.AtemCameraControlVideoParameter.DisplayLUT:return void e.addUnhandledMessage(t);default:return(0,a.assertNever)(s),void e.addUnhandledMessage(t)}}},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeIsVisibleFn=function(e){return(e??[]).map(e=>"isVisibleExpression"in e&&"string"==typeof e.isVisibleExpression?{...e,isVisibleFnType:"expression",isVisibleFn:e.isVisibleExpression,isVisible:void 0,isVisibleExpression:void 0}:"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisibleFnType:"function",isVisible:void 0,isVisibleExpression:void 0}:{...e,isVisible:void 0,isVisibleFn:void 0,isVisibleFnType:void 0,isVisibleExpression:void 0})},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},2622:e=>{"use strict";e.exports=require("atem-connection")},2697:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlEvents=void 0,function(e){e.LensAutoIris="lens.autoIris",e.LensAutoFocus="lens.autoFocus",e.VideoAutoWhiteBalance="video.autoWhiteBalance",e.ColorResetToDefault="color.resetToDefault"}(i||(t.AtemCameraControlEvents=i={}))},2996:(e,t,i)=>{"use strict";t.zC=void 0;i(6982);const r=i(8730);i(8730);t.zC=function(e,t,i){return function(e,t,i){if(!r.Native)throw new Error("Library failed to initialise");const a=Buffer.alloc(e*t*4);return r.Native.convertYuva422ToRgba(e,t,i,a),a}(e,t,i)}},3080:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Worker=void 0;const isRunning=__webpack_require__(6067),lib_1=__webpack_require__(6156),sharedApi_1=__webpack_require__(4468);class Worker{constructor(){this.childHandler={cmdId:0,queue:{}},this.instanceHandles={},this.callbacks={},this.remoteFns={},this.disabledMultithreading=!1,this._parentPid=0,this.log=(...e)=>{this.sendLog(e)},this.logError=(...e)=>{this.sendLog(["Error",...e])}}onMessageFromParent(e){if("instance"===e.messageType){let t=this.instanceHandles[e.instanceId];if(!t&&e.cmd!==sharedApi_1.Message.To.Instance.CommandType.INIT)return void console.log(`Child process: Unknown instanceId: "${e.instanceId}"`);t||(t={id:e.instanceId,cmdId:0,queue:{},instance:{}});try{this.handleInstanceMessageFromParent(e,t)}catch(i){e.cmdId?this.replyInstanceError(t,e,`Error: ${i.toString()} ${i.stack} thrown in handleInstanceMessageFromParent on instance "${e.instanceId}"`):this.log("Error: "+i.toString(),i.stack)}}else if("child"===e.messageType){let t=this.childHandler;try{this.handleChildMessageFromParent(e,t)}catch(i){e.cmdId?this.replyChildError(t,e,`Error: ${i.toString()} ${i.stack} thrown in handleChildMessageFromParent on child`):this.log("Error: "+i.toString(),i.stack)}}}decodeArgumentsFromParent(e,t){return(0,sharedApi_1.decodeArguments)(()=>e.instance,t,t=>{const i=t.value;return this.remoteFns[i]||(this.remoteFns[i]=(...i)=>{const r=new Error;return new Promise((a,o)=>{const n=t.value;this.sendCallback(e,n,i,(t,i)=>{if(t){const e=(0,lib_1.stripStack)((0,lib_1.getErrorStack)(t),[/[\\/]parent-process[\\/]manager/,/[\\/]eventemitter3[\\/]index/]),i=(r.stack+"").split("\n").slice(2).join("\n");o((0,lib_1.combineErrorStacks)(e,i))}else{const t=i?this.decodeArgumentsFromParent(e,[i]):[i];a(t[0])}})})}),this.remoteFns[i]})}encodeArgumentsToParent(e,t){return(0,sharedApi_1.encodeArguments)(e,this.callbacks,t,this.disabledMultithreading)}replyToInstanceMessage(e,t,i){this.sendInstanceReplyToParent(e,t.cmdId,void 0,i)}replyToChildMessage(e,t,i){this.sendChildReplyToParent(e,t.cmdId,void 0,i)}replyInstanceError(e,t,i){this.sendInstanceReplyToParent(e,t.cmdId,i)}replyChildError(e,t,i){this.sendChildReplyToParent(e,t.cmdId,i)}sendInstanceReplyToParent(e,t,i,r){let a={cmd:sharedApi_1.Message.From.Instance.CommandType.REPLY,replyTo:t,error:i?(i.stack||i).toString():i,reply:r};this.sendInstanceMessageToParent(e,a)}sendChildReplyToParent(e,t,i,r){let a={cmd:sharedApi_1.Message.From.Child.CommandType.REPLY,replyTo:t,error:i?(i.stack||i).toString():i,reply:r};this.sendChildMessageToParent(e,a)}sendLog(e){let t={cmd:sharedApi_1.Message.From.Child.CommandType.LOG,log:e};this.sendChildMessageToParent(this.childHandler,t)}sendCallback(e,t,i,r){let a={cmd:sharedApi_1.Message.From.Instance.CommandType.CALLBACK,callbackId:t,args:i};this.sendInstanceMessageToParent(e,a,r)}getAllProperties(e){let t=[];do{t=t.concat(Object.getOwnPropertyNames(e)),e=Object.getPrototypeOf(e)}while(e);return t}handleInstanceMessageFromParent(m,handle){const instance=handle.instance;if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.INIT){const msg=m;let pModuleClass;this._config=m.config,this._parentPid=m.parentPid,pModuleClass=(0,lib_1.isBrowser)()?new Promise((e,t)=>{let i=new XMLHttpRequest;i.open("GET",msg.modulePath,!0),i.onload=()=>{i.response?e(i.response):t(Error(`Bad reply from ${msg.modulePath} in instance ${handle.id}`))},i.send()}).then(bodyString=>{var f=null;let fcn=`\n\t\t\t\t\t\tf = function() {\n\t\t\t\t\t\t\t${bodyString}\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\treturn ${msg.exportName}\n\t\t\t\t\t\t}\n\t\t\t\t\t`,moduleClass=eval(fcn)();if(!moduleClass)throw Error(`${msg.exportName} not found in ${msg.modulePath}`);return moduleClass}):Promise.resolve(__webpack_require__(1253)(msg.modulePath)).then(e=>e[msg.exportName]),pModuleClass.then(e=>{if(!e)return Promise.reject("Failed to find class");const t={id:msg.instanceId,cmdId:0,queue:{},instance:null},i=this.decodeArgumentsFromParent(t,msg.args);t.instance=((...t)=>new e(...t)).apply(null,i),this.instanceHandles[t.id]=t;const r=t.instance,a=this.getAllProperties(r),o=[];a.forEach(e=>{if(-1!==["constructor","__defineGetter__","__defineSetter__","hasOwnProperty","__lookupGetter__","__lookupSetter__","isPrototypeOf","propertyIsEnumerable","toString","valueOf","__proto__","toLocaleString"].indexOf(e))return;let t=Object.getOwnPropertyDescriptor(r,e),i=0,a=r.__proto__;for(;!t&&a;)t=Object.getOwnPropertyDescriptor(a,e),i++,a=a.__proto__;t||(t={});let n={inProto:i,enumerable:!!t.enumerable,writable:!!t.writable,get:!!t.get,set:!!t.set,readable:!(t.get||t.get)};"function"==typeof r[e]?o.push({key:e,type:sharedApi_1.InitPropType.FUNCTION,descriptor:n}):o.push({key:e,type:sharedApi_1.InitPropType.VALUE,descriptor:n})}),this.replyToInstanceMessage(t,msg,o)}).catch(e=>{let t=`${(0,lib_1.stripStack)(e.stack||e.toString(),[/onMessageFromParent/,/threadedclass-worker/])}\n executing constructor of instance "${m.instanceId}"`;this.replyInstanceError(handle,msg,t)}),m.config.disableMultithreading||(0,lib_1.nodeSupportsWorkerThreads)()||this.startOrphanMonitoring()}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.PING)this.replyToInstanceMessage(handle,m,null);else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.REPLY){const e=m;let t=handle.queue[e.replyTo+""];if(!t)throw Error(`cmdId "${e.cmdId}" not found in instance ${m.instanceId}!`);e.error?t.cb(e.error):t.cb(null,e.reply),delete handle.queue[e.replyTo+""]}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.FUNCTION){let e=m;const t=this.decodeArgumentsFromParent(handle,e.args);let i;try{i="function"==typeof instance[e.fcn]?instance[e.fcn](...t):instance[e.fcn]}catch(e){i=Promise.reject(e)}Promise.resolve(i).then(t=>{const i=this.encodeArgumentsToParent(instance,[t]);this.replyToInstanceMessage(handle,e,i[0])}).catch(t=>{let i=`${(0,lib_1.stripStack)(t.stack||t.toString(),[/onMessageFromParent/,/threadedclass-worker/])}\n executing function "${e.fcn}" of instance "${m.instanceId}"`;this.replyInstanceError(handle,e,i)})}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.SET){let e=m;const t=this.decodeArgumentsFromParent(handle,[e.value])[0];instance[e.property]=t;const i=this.encodeArgumentsToParent(instance,[t]);this.replyToInstanceMessage(handle,e,i[0])}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.KILL){let e=m;this.killInstance(handle),this.replyToInstanceMessage(handle,e,null)}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.CALLBACK){let e=m,t=this.callbacks[e.callbackId];if(t)try{Promise.resolve(t(...e.args)).then(t=>{const i=this.encodeArgumentsToParent(instance,[t]);this.replyToInstanceMessage(handle,e,i[0])}).catch(t=>{let i=(t.stack||t.toString())+`\n executing callback of instance "${m.instanceId}"`;this.replyInstanceError(handle,e,i)})}catch(t){let i=(t.stack||t.toString())+`\n executing (outer) callback of instance "${m.instanceId}"`;this.replyInstanceError(handle,e,i)}else this.replyInstanceError(handle,e,`Callback "${e.callbackId}" not found on instance "${m.instanceId}"`)}else(0,lib_1.assertNever)(m)}handleChildMessageFromParent(e,t){if(e.cmd===sharedApi_1.Message.To.Child.CommandType.GET_MEM_USAGE){let i=process?process.memoryUsage():window?window.performance.memory:{error:"N/A"};const r=this.encodeArgumentsToParent({},[i])[0];this.replyToChildMessage(t,e,r)}}startOrphanMonitoring(){this._config&&setInterval(()=>{this._parentPid&&!isRunning(this._parentPid)&&(console.log(`Parent pid ${this._parentPid} missing, exiting process!`),setTimeout(()=>{process.exit(27)},100))},5e3)}}exports.Worker=Worker},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3290:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(228),a=i(6641),o=i(4774),n=()=>{},s=new a.TimeoutError;t.default=class extends r{constructor(e){var t,i,r,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=n,this._resolveIdle=n,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(i=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==i?i:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(a=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==a?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=n,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=n,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,r)=>{this._queue.enqueue(async()=>{this._pendingCount++,this._intervalCount++;try{const o=void 0===this._timeout&&void 0===t.timeout?e():a.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&r(s)});i(await o)}catch(e){r(e)}this._next()},t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3409:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KillTimeoutError=t.RestartTimeoutError=void 0;class i extends Error{constructor(){super(...arguments),this.name="RestartTimeoutError"}}t.RestartTimeoutError=i;class r extends Error{constructor(){super(...arguments),this.name="KillTimeoutError"}}t.KillTimeoutError=r},3477:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyLensCommand=void 0;const r=i(2622),a=i(142),o=i(8430),n=i(2697);t.applyLensCommand=function(e,t,i){const s=t.parameter;switch(s){case o.AtemCameraControlLensParameter.Focus:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,1))return;return i.lens.focus=t.properties.numberData[0],void e.addChange(t.source,"lens.focus");case o.AtemCameraControlLensParameter.AutoFocus:return void e.addEvent(t.source,n.AtemCameraControlEvents.LensAutoFocus);case o.AtemCameraControlLensParameter.ApertureFStop:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,1))return;return i.lens.iris=t.properties.numberData[0],void e.addChange(t.source,"lens.iris");case o.AtemCameraControlLensParameter.AutoAperture:return void e.addEvent(t.source,n.AtemCameraControlEvents.LensAutoIris);case o.AtemCameraControlLensParameter.OpticalImageStabilisation:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.BOOL,1))return;return i.lens.opticalImageStabilisation=t.properties.boolData[0],void e.addChange(t.source,"lens.opticalImageStabilisation");case o.AtemCameraControlLensParameter.SetContinuousZoomSpeed:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,1))return;return i.lens.zoomSpeed=t.properties.numberData[0],void e.addChange(t.source,"lens.zoomSpeed");case o.AtemCameraControlLensParameter.ApertureNormalised:case o.AtemCameraControlLensParameter.ApertureOrdinal:case o.AtemCameraControlLensParameter.SetAbsoluteZoomMM:case o.AtemCameraControlLensParameter.SetAbsoluteZoomNormalised:return void e.addUnhandledMessage(t);default:return(0,a.assertNever)(s),void e.addUnhandledMessage(t)}}},3693:e=>{"use strict";var t=Object.prototype.hasOwnProperty,i="~";function r(){}function a(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function o(e,t,r,o,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new a(r,o||e,n),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function n(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),s.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,o=r.length,n=new Array(o);a<o;a++)n[a]=r[a].fn;return n},s.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,a,o,n){var s=i?i+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,a),!0;case 5:return c.fn.call(c.context,t,r,a,o),!0;case 6:return c.fn.call(c.context,t,r,a,o,n),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var p,m=c.length;for(u=0;u<m;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,a);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,i){return o(this,e,t,i,!1)},s.prototype.once=function(e,t,i){return o(this,e,t,i,!0)},s.prototype.removeListener=function(e,t,r,a){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return n(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||a&&!s.once||r&&s.context!==r||n(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||a&&!s[l].once||r&&s[l].context!==r)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:n(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&n(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=i,s.EventEmitter=s,e.exports=s},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3791:e=>{"use strict";const t=()=>{const e=Error.prepareStackTrace;Error.prepareStackTrace=(e,t)=>t;const t=(new Error).stack.slice(1);return Error.prepareStackTrace=e,t};e.exports=t,e.exports.default=t},3796:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEmptyState=void 0;const r=i(2077);t.createEmptyState=function(e){return{cameraId:e,lens:{focus:0,iris:0,opticalImageStabilisation:!1,zoomSpeed:0},video:{whiteBalance:[0,0],exposure:0,videoSharpeningLevel:r.VideoSharpeningLevel.Off,shutterSpeed:0,gain:0,ndFilterStop:0},display:{colorBarEnable:!1},colorCorrection:{liftAdjust:{red:0,green:0,blue:0,luma:0},gammaAdjust:{red:0,green:0,blue:0,luma:0},gainAdjust:{red:1,green:1,blue:1,luma:1},offsetAdjust:{red:0,green:0,blue:0,luma:0},contrastAdjust:{pivot:.5,adj:1},lumaMix:1,colorAdjust:{hue:0,saturation:1}}}}},4044:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const r=i(1635),a=i(360),o=r.__importDefault(i(6022));t.IpcWrapper=class{#A;#T;#M;#N=1;#O=new Map;constructor(e,t,i){this.#A=e,this.#T=t,this.#M=i}async sendWithCb(e,t,i,r=0){r<=0&&(r=this.#M);const a={timeout:void 0,resolve:()=>null,reject:()=>null},n=new Promise((e,t)=>{a.resolve=e,a.reject=t});this.#N>268435456&&(this.#N=1);const s=this.#N++;this.#O.set(s,a),this.#T({direction:"call",name:String(e),payload:o.default.stringify(t),callbackId:s});const l=new Error("Call timed out");return a.timeout=setTimeout(()=>{a.reject(i?i():l),this.#O.delete(s)},r),n}sendWithNoCb(e,t){this.#T({direction:"call",name:String(e),payload:o.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#A[e.name];if(!t)return void(e.callbackId&&this.#T({direction:"response",callbackId:e.callbackId,success:!1,payload:o.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?o.default.parse(e.payload):void 0).then(t=>{e.callbackId&&this.#T({direction:"response",callbackId:e.callbackId,success:!0,payload:o.default.stringify(t)})},t=>{e.callbackId&&this.#T({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):o.default.stringify(t)})});break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#O.get(e.callbackId);if(this.#O.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const i=e.payload?o.default.parse(e.payload):void 0;if(e.success)t.resolve(i);else{let e=i;i&&"object"==typeof i&&"message"in i&&(e=new Error(i.message),i.stack&&(e.stack=i.stack)),t.reject(e)}break}default:(0,a.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},4225:(e,t,i)=>{const{existsSync:r,readFileSync:a}=i(9896),{join:o}=i(6928),{platform:n,arch:s}=process;let l=null,u=null;const c=require;function d(e){const t=[o(__dirname,e),o(__dirname,"prebuilds",e)];for(const e of t)if(r(e))return c(e)}function p(){if(process.report&&"function"==typeof process.report.getReport){const{glibcVersionRuntime:e}=process.report.getReport().header;return!e}try{const e=i(5317).execSync("which ldd").toString().trim();return a(e,"utf8").includes("musl")}catch(e){return!0}}switch(n){case"android":switch(s){case"arm64":try{l=d("atem-connection-image-tools.android-arm64.node")}catch(e){u=e}break;case"arm":try{l=d("atem-connection-image-tools.android-arm-eabi.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Android ${s}`)}break;case"win32":switch(s){case"x64":try{l=d("atem-connection-image-tools.win32-x64-msvc.node")}catch(e){u=e}break;case"ia32":try{l=d("atem-connection-image-tools.win32-ia32-msvc.node")}catch(e){u=e}break;case"arm64":try{l=d("atem-connection-image-tools.win32-arm64-msvc.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Windows: ${s}`)}break;case"darwin":try{if(l=d("atem-connection-image-tools.darwin-universal.node"),l)break}catch{}switch(s){case"x64":try{l=d("atem-connection-image-tools.darwin-x64.node")}catch(e){u=e}break;case"arm64":try{l=d("atem-connection-image-tools.darwin-arm64.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on macOS: ${s}`)}break;case"freebsd":if("x64"!==s)throw new Error(`Unsupported architecture on FreeBSD: ${s}`);try{l=d("atem-connection-image-tools.freebsd-x64.node")}catch(e){u=e}break;case"linux":switch(s){case"x64":if(p())try{l=d("atem-connection-image-tools.linux-x64-musl.node")}catch(e){u=e}else try{l=d("atem-connection-image-tools.linux-x64-gnu.node")}catch(e){u=e}break;case"arm64":if(p())try{l=d("atem-connection-image-tools.linux-arm64-musl.node")}catch(e){u=e}else try{l=d("atem-connection-image-tools.linux-arm64-gnu.node")}catch(e){u=e}break;case"arm":try{l=d("atem-connection-image-tools.linux-arm-gnueabihf.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Linux: ${s}`)}break;default:throw new Error(`Unsupported OS: ${n}, architecture: ${s}`)}if(!l){if(u)throw u;throw new Error("Failed to load native binding")}e.exports=l},4275:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(1635);r.__exportStar(i(6921),t),r.__exportStar(i(6878),t),r.__exportStar(i(6131),t),r.__exportStar(i(1173),t),r.__exportStar(i(2697),t),r.__exportStar(i(3796),t),r.__exportStar(i(2077),t)},4289:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const r=i(2593);function a(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#R;#$;#D;#V;#F=new Map;#B=new Map;constructor(e,t,i,r){this.#R=e,this.#$=t,this.#D=i,this.#V=r}async handleExecuteAction(e){const t=this.#F.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const i={parseVariablesInString:async t=>(await this.#R({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:(t,i)=>{this.#D({customVariableId:t,value:i,controlId:e.action.controlId})}};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},i)}handleUpdateActions(e){for(const[t,i]of Object.entries(e)){const e=this.#B.get(t);if(e){const t=this.#F.get(e.actionId);if(t?.unsubscribe&&!t.skipUnsubscribeOnOptionsChange){const i={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(a(e),i)).catch(t=>{this.#V("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}if(!i||i.disabled)this.#B.delete(t);else{this.#B.set(t,i);const e=this.#F.get(i.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during subscribe")}};Promise.resolve(e.subscribe(a(i),t)).catch(e=>{this.#V("error",`Action subscribe failed: ${JSON.stringify(i)} - ${e?.message??e} ${e?.stack}`)})}}}}async handleLearnAction(e){const t=this.#F.get(e.action.actionId);if(t&&t.learn){const i={parseVariablesInString:async t=>(await this.#R({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during learn")}};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},i)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#F.clear();for(const[i,a]of Object.entries(e))a&&(t.push({id:i,name:a.name,description:a.description,options:(0,r.serializeIsVisibleFn)(a.options),optionsToIgnoreForSubscribe:a.optionsToIgnoreForSubscribe,hasLearn:!!a.learn,learnTimeout:a.learnTimeout,hasLifecycleFunctions:!!a.subscribe||!!a.unsubscribe}),this.#F.set(i,a));this.#$({actions:t})}subscribeActions(e){let t=Array.from(this.#B.values());const i=new Set(e);i.size&&(t=t.filter(e=>i.has(e.actionId)));for(const e of t){const t=this.#F.get(e.actionId);if(t?.subscribe){const i={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during subscribe")}};Promise.resolve(t.subscribe(a(e),i)).catch(t=>{this.#V("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}unsubscribeActions(e){let t=Array.from(this.#B.values());const i=new Set(e);i.size&&(t=t.filter(e=>i.has(e.actionId)));for(const e of t){const t=this.#F.get(e.actionId);if(t&&t.unsubscribe){const i={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(a(e),i)).catch(t=>{this.#V("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}}},4326:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=function(e,t){Promise.resolve().then(async()=>{if(c)throw new Error("runEntrypoint can only be called once");if(c=!0,t||(t=[]),!Array.isArray(t))throw new Error("upgradeScripts must be an array");for(const e of t)if("function"!=typeof e)throw new Error("upgradeScripts must be an array of functions");const i=process.env.MODULE_MANIFEST;if(!i)throw new Error("Module initialise is missing MODULE_MANIFEST");const r=await o.default.readFile(i),d=JSON.parse(r.toString());if(d.runtime?.api!==a.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!d.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let p=d.runtime.apiVersion;if("0.0.0"===p)try{const e=await o.default.readFile(l.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(p=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const m=process.env.CONNECTION_ID;if("string"!=typeof m||!m)throw new Error("Module initialise is missing CONNECTION_ID");const b=process.env.VERIFICATION_TOKEN;if("string"!=typeof b||!b)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const f=new s.IpcWrapper({},e=>{process.send(e)},5e3);process.once("message",e=>{f.receivedMessage(e)}),u=new e((0,n.literal)({id:m,upgradeScripts:t,_isInstanceBaseProps:!0})),f.sendWithCb("register",{apiVersion:p,connectionId:m,verificationToken:b}).then(()=>{console.log("Module-host accepted registration")},e=>{console.error("Module registration failed",e),process.exit(11)})}).catch(e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)})};const r=i(1635),a=i(9967),o=r.__importDefault(i(1943)),n=i(360),s=i(4044),l=r.__importDefault(i(6928));let u,c=!1},4468:(e,t)=>{"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.decodeArguments=t.encodeArguments=t.Message=t.InitPropType=t.DEFAULT_AUTO_RESTART_RETRY_DELAY=t.DEFAULT_AUTO_RESTART_RETRY_COUNT=t.DEFAULT_KILL_TIMEOUT=t.DEFAULT_RESTART_TIMEOUT=t.DEFAULT_CHILD_FREEZE_TIME=void 0,t.DEFAULT_CHILD_FREEZE_TIME=1e3,t.DEFAULT_RESTART_TIMEOUT=1e3,t.DEFAULT_KILL_TIMEOUT=1e3,t.DEFAULT_AUTO_RESTART_RETRY_COUNT=1,t.DEFAULT_AUTO_RESTART_RETRY_DELAY=1e3,(r=t.InitPropType||(t.InitPropType={})).FUNCTION="function",r.VALUE="value",function(e){let t,i;!function(e){let t,i;!function(e){let t;!function(e){e.INIT="init",e.PING="ping",e.FUNCTION="fcn",e.REPLY="reply",e.SET="set",e.KILL="kill",e.CALLBACK="callback"}(t=e.CommandType||(e.CommandType={}))}(t=e.Instance||(e.Instance={})),function(e){let t;!function(e){e.GET_MEM_USAGE="get_mem_usage",e.REPLY="reply"}(t=e.CommandType||(e.CommandType={}))}(i=e.Child||(e.Child={}))}(t=e.To||(e.To={})),function(e){let t,i;!function(e){let t;!function(e){e.CALLBACK="callback",e.REPLY="reply"}(t=e.CommandType||(e.CommandType={}))}(t=e.Instance||(e.Instance={})),function(e){let t;!function(e){e.LOG="log",e.REPLY="reply",e.CALLBACK="callback"}(t=e.CommandType||(e.CommandType={}))}(i=e.Child||(e.Child={}))}(i=e.From||(e.From={}))}(t.Message||(t.Message={})),function(e){e.STRING="string",e.NUMBER="number",e.UNDEFINED="undefined",e.NULL="null",e.OBJECT="object",e.FUNCTION="function",e.BUFFER="buffer",e.OTHER="other"}(i||(i={}));let a=0;t.encodeArguments=function(e,t,r,o){try{return r.map((r,n)=>{try{if("object"==typeof r&&r===e)return{type:i.OBJECT,value:"self"};if(o){if(r instanceof Buffer)return{type:i.BUFFER,original:r,value:null};if("object"==typeof r)return{type:i.OBJECT,original:r,value:null}}if(r instanceof Buffer)return{type:i.BUFFER,value:r.toString("hex")};if("string"==typeof r)return{type:i.STRING,value:r};if("number"==typeof r)return{type:i.NUMBER,value:r};if("function"==typeof r){for(const e in t)if(t[e]===r)return{type:i.FUNCTION,value:e+""};const e=a++;return t[e+""]=r,{type:i.FUNCTION,value:e+""}}return void 0===r?{type:i.UNDEFINED,value:r}:null===r?{type:i.NULL,value:r}:"object"==typeof r?{type:i.OBJECT,value:r}:{type:i.OTHER,value:r}}catch(e){throw e.stack&&(e.stack+="\nIn encodeArguments, argument "+n),e}})}catch(e){throw e.stack&&(e.stack+="\nThreadedClass, unsupported attribute"),e}},t.decodeArguments=function(e,t,r){return t.map(t=>void 0!==t.original?t.original:t.type===i.STRING||t.type===i.NUMBER?t.value:t.type===i.BUFFER?Buffer.from(t.value,"hex"):t.type===i.UNDEFINED||t.type===i.NULL?t.value:t.type===i.FUNCTION?r(t):t.type===i.OBJECT&&"self"===t.value?e():t.value)}},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then(e=>new Promise(e=>{e(t())}).then(()=>e),e=>new Promise(e=>{e(t())}).then(()=>{throw e})))},4774:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const i={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(i);const a=r.default(this._queue,i,(e,t)=>t.priority-e.priority);this._queue.splice(a,0,i)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(e=>e.run)}get size(){return this._queue.length}}},4865:e=>{"use strict";const t=(e,t,r,a)=>{if("length"===r||"prototype"===r)return;if("arguments"===r||"caller"===r)return;const o=Object.getOwnPropertyDescriptor(e,r),n=Object.getOwnPropertyDescriptor(t,r);!i(o,n)&&a||Object.defineProperty(e,r,n)},i=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},r=(e,t)=>`/* Wrapped ${e}*/\n${t}`,a=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),o=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,i,{ignoreNonConfigurable:n=!1}={})=>{const{name:s}=e;for(const r of Reflect.ownKeys(i))t(e,i,r,n);return((e,t)=>{const i=Object.getPrototypeOf(t);i!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,i)})(e,i),((e,t,i)=>{const n=""===i?"":`with ${i.trim()}() `,s=r.bind(null,n,t.toString());Object.defineProperty(s,"name",o),Object.defineProperty(e,"toString",{...a,value:s})})(e,i,s),e}},5158:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5317:e=>{"use strict";e.exports=require("child_process")},6022:e=>{!function(){"use strict";var t=[,function(e,t){function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===r(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var a=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=a,t.convertMapToObject=function(e){return Array.from(e).reduce(function(e,t){var r,a,o=(a=2,function(e){if(Array.isArray(e))return e}(r=t)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,a,o=[],n=!0,s=!1;try{for(i=i.call(e);!(n=(r=i.next()).done)&&(o.push(r.value),!t||o.length!==t);n=!0);}catch(e){s=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(s)throw a}}return o}}(r,a)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(r,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=o[0],s=o[1];return e[n]=s,e},{})},t.isArguments=function(e){return null!=e&&a(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var o={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=o,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(o.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var i=Object.create(null),r=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},a=function(e){return"="===e?-1:i[e]},o=0;o<64;o++)i[r(o)]=o;var n=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],i=0;i<e;i++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},s={encode:function(e){if("string"==typeof e){var t=e;e=n(t.length);for(var i=0;i<t.length;i++){var a=t.charCodeAt(i);if(a>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[i]=a}}for(var o=[],s=null,l=null,u=null,c=null,d=0;d<e.length;d++)switch(d%3){case 0:s=e[d]>>2&63,l=(3&e[d])<<4;break;case 1:l|=e[d]>>4&15,u=(15&e[d])<<2;break;case 2:u|=e[d]>>6&3,c=63&e[d],o.push(r(s)),o.push(r(l)),o.push(r(u)),o.push(r(c)),s=null,l=null,u=null,c=null}return null!=s&&(o.push(r(s)),o.push(r(l)),null==u?o.push("="):o.push(r(u)),null==c&&o.push("=")),o.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var i=n(t),r=null,o=null,s=null,l=0,u=0;u<e.length;u++){var c=e.charAt(u),d=a(c);switch(u%4){case 0:if(d<0)throw new Error("invalid base64 string");r=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");r|=d>>4,i[l++]=r,o=(15&d)<<4;break;case 2:d>=0&&(o|=d>>2,i[l++]=o,s=(3&d)<<6);break;case 3:d>=0&&(i[l++]=s|d)}}return i},newBinary:n};t.Base64=s},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function e(t,a,o,n,s){var l=a[t];switch(i(l)){case"string":return r(l);case"number":return isFinite(l)?String(l):"null";case"boolean":return String(l);case"object":if(!l)return"null";var u,c=n+o,d=[];if(Array.isArray(l)||{}.hasOwnProperty.call(l,"callee")){for(var p=l.length,m=0;m<p;m+=1)d[m]=e(m,l,o,c,s)||"null";return u=0===d.length?"[]":c?"[\n"+c+d.join(",\n"+c)+"\n"+n+"]":"["+d.join(",")+"]"}var b=Object.keys(l);return s&&(b=b.sort()),b.forEach(function(t){(u=e(t,l,o,c,s))&&d.push(r(t)+(c?": ":":")+u)}),u=0===d.length?"{}":c?"{\n"+c+d.join(",\n"+c)+"\n"+n+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var i=Object.assign({indent:"",canonical:!1},t);if(!0===i.indent)i.indent="  ";else if("number"==typeof i.indent){for(var r="",o=0;o<i.indent;o++)r+=" ";i.indent=r}return a("",{"":e},i.indent,"",i.canonical)},e.exports=t.default}],i={};function r(e){var a=i[e];if(void 0!==a)return a.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,r),o.exports}var a={};!function(){var e=a,t=r(2).Base64,i=r(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var o=r(1),n={};e.EJSON=n;var s=new Map;n.addType=function(e,t){if(s.has(e))throw new Error("Type ".concat(e," already present"));s.set(e,t)};var l=[{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$date")&&1===(0,o.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$regexp")&&(0,o.hasOwn)(e,"$flags")&&2===(0,o.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$InfNaN")&&1===(0,o.lengthOf)(e)},matchObject:o.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$binary")&&1===(0,o.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,o.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$escape")&&1===(0,o.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var i=(0,o.lengthOf)(e);1!==i&&2!==i||(t=l.some(function(t){return t.matchJSONValue(e)}))}return t},toJSONValue:function(e){var t={};return(0,o.keysOf)(e).forEach(function(i){t[i]=n.toJSONValue(e[i])}),{$escape:t}},fromJSONValue:function(e){var t={};return(0,o.keysOf)(e.$escape).forEach(function(i){t[i]=n.fromJSONValue(e.$escape[i])}),t}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$type")&&(0,o.hasOwn)(e,"$value")&&2===(0,o.lengthOf)(e)},matchObject:function(e){return n._isCustomType(e)},toJSONValue:function(e){var t=i._noYieldsAllowed(function(){return e.toJSONValue()});return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!s.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var r=s.get(t);return i._noYieldsAllowed(function(){return r(e.$value)})}}];n._isCustomType=function(e){return e&&(0,o.isFunction)(e.toJSONValue)&&(0,o.isFunction)(e.typeName)&&s.has(e.typeName())},n._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?s:(0,o.convertMapToObject)(s)},n._getConverters=function(){return l};var u=function(e){for(var t=0;t<l.length;t++){var i=l[t];if(i.matchObject(e))return i.toJSONValue(e)}},c=function e(t){if(null===t)return null;var i=u(t);return void 0!==i?i:(0,o.isObject)(t)?((0,o.keysOf)(t).forEach(function(i){var r=t[i];if((0,o.isObject)(r)||void 0===r||(0,o.isInfOrNaN)(r)){var a=u(r);a?t[i]=a:e(r)}}),t):t};n._adjustTypesToJSONValue=c,n.toJSONValue=function(e){var t=u(e);if(void 0!==t)return t;var i=e;return(0,o.isObject)(e)&&(i=n.clone(e),c(i)),i};var d=function(e){if((0,o.isObject)(e)&&null!==e){var t=(0,o.keysOf)(e);if(t.length<=2&&t.every(function(e){return"string"==typeof e&&"$"===e.substr(0,1)}))for(var i=0;i<l.length;i++){var r=l[i];if(r.matchJSONValue(e))return r.fromJSONValue(e)}}return e},p=function e(t){if(null===t)return null;var i=d(t);return i!==t?i:(0,o.isObject)(t)?((0,o.keysOf)(t).forEach(function(i){var r=t[i];if((0,o.isObject)(r)){var a=d(r);if(r!==a)return void(t[i]=a);e(r)}}),t):t};n._adjustTypesFromJSONValue=p,n.fromJSONValue=function(e){var t=d(e);return t===e&&(0,o.isObject)(e)&&(t=n.clone(e),p(t)),t},n.stringify=(0,o.handleError)(function(e,t){var i=n.toJSONValue(e);return t&&(t.canonical||t.indent)?r(4)(i,t):JSON.stringify(i)}),n.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return n.fromJSONValue(JSON.parse(e))},n.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},n.equals=function(e,t,i){var r,a=!(!i||!i.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,o.isObject)(e)||!(0,o.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(n.isBinary(e)&&n.isBinary(t)){if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}if((0,o.isFunction)(e.equals))return e.equals(t,i);if((0,o.isFunction)(t.equals))return t.equals(e,i);var s,l=Array.isArray(e),u=Array.isArray(t);if(l!==u)return!1;if(l&&u){if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(!n.equals(e[r],t[r],i))return!1;return!0}switch(n._isCustomType(e)+n._isCustomType(t)){case 1:return!1;case 2:return n.equals(n.toJSONValue(e),n.toJSONValue(t))}var c=(0,o.keysOf)(e),d=(0,o.keysOf)(t);return a?(r=0,s=c.every(function(a){return!(r>=d.length||a!==d[r]||!n.equals(e[a],t[d[r]],i)||(r++,0))})):(r=0,s=c.every(function(a){return!!(0,o.hasOwn)(t,a)&&!!n.equals(e[a],t[a],i)&&(r++,!0)})),s&&r===d.length},n.clone=function(e){var t;if(!(0,o.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(n.isBinary(e)){t=n.newBinary(e.length);for(var i=0;i<e.length;i++)t[i]=e[i];return t}return Array.isArray(e)?e.map(n.clone):(0,o.isArguments)(e)?Array.from(e).map(n.clone):(0,o.isFunction)(e.clone)?e.clone():n._isCustomType(e)?n.fromJSONValue(n.clone(n.toJSONValue(e)),!0):(t={},(0,o.keysOf)(e).forEach(function(i){t[i]=n.clone(e[i])}),t)},n.newBinary=t.newBinary}(),e.exports=a.EJSON}()},6067:e=>{e.exports=function(t){if(e.exports.stub!==e.exports)return e.exports.stub.apply(this,arguments);try{return process.kill(t,0)}catch(e){return"EPERM"===e.code}},e.exports.stub=e.exports},6131:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlDirectCommandSender=void 0;const r=i(6921);class a extends r.AtemCameraControlCommandGenerator{#L;constructor(e){super(),this.#L=e}async addCommand(e){await this.#L.sendCommand(e)}}t.AtemCameraControlDirectCommandSender=a},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6156:(e,t,i)=>{"use strict";function r(){return!(process&&process.hasOwnProperty("stdin"))}function a(){try{return i(8167)}catch(e){return null}}Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayMap=t.combineErrorStacks=t.stripStack=t.getErrorStack=t.assertNever=t.getWorkerThreads=t.nodeSupportsWorkerThreads=t.browserSupportsWebWorkers=t.isBrowser=void 0,t.isBrowser=r,t.browserSupportsWebWorkers=function(){return!(!r()||!window.Worker)},t.nodeSupportsWorkerThreads=function(){return!!a()},t.getWorkerThreads=a,t.assertNever=function(e){},t.getErrorStack=function(e){if("object"==typeof e){return e.stack||`${e}`}return`${e}`},t.stripStack=function(e,t){if(!e)return e;const i=e.split("\n");let r=-1;for(let e=0;e<i.length;e++){let a=!1;for(const o of t){if(!i[e]||!i[e].match(o)){a=!1;break}-1===r&&(r=e),a=!0,e+=1}if(a)return i.slice(0,r).join("\n")}return e},t.combineErrorStacks=function e(t,...i){if("object"==typeof t){const r=new Error(t.message);return r.stack=e(`${t.stack}`,...i),r}return t+"\n"+i.join("\n")};class o extends Map{constructor(){super()}push(e,t){const i=this.get(e);return i?(i.push(t),i.length):(this.set(e,[t]),1)}remove(e,t){let i=!1;const r=this.get(e);if(r){const a=r.indexOf(t);-1!==a&&(r.splice(a,1),i=!0),0===r.length&&this.delete(e)}return i}arraySize(e){var t,i;return null!==(i=null===(t=this.get(e))||void 0===t?void 0:t.length)&&void 0!==i?i:0}get totalSize(){let e=0;for(const t of this.values())e+=t.length;return e}}t.ArrayMap=o},6160:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var r=i(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return r.TCPHelper}});var a=i(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return a.TelnetHelper}});var o=i(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return o.UDPHelper}})},6250:(e,t,i)=>{"use strict";const r=i(2017);r.code='require("ajv/dist/runtime/equal").default',t.A=r},6259:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const r=i(1635).__importDefault(i(7194)),a=i(3693),o=i(1400);class n extends a.EventEmitter{#j;#K;#U;#k;#G=!1;#z;#a;get isDestroyed(){return this.#G}constructor(e,t,i){super(),this.#j=e,this.#K=t,this.#k={...i},this.#U=r.default.createSocket("udp4");try{this.#U.bind(this.#k.bind_port||0,this.#k.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#k.bind_ip||"0.0.0.0"}:${this.#k.bind_port||0}`)}void 0!==this.#k.ttl&&this.#U.setTTL(this.#k.ttl),void 0!==this.#k.multicast_ttl&&this.#U.setMulticastTTL(this.#k.multicast_ttl),this.#U.on("error",e=>{this.#W(o.InstanceStatus.UnknownError,e.message),this.emit("error",e)}),this.#U.on("listening",()=>{this.#k.broadcast&&this.#U.setBroadcast(!0),this.#k.multicast_interface&&this.#U.setMulticastInterface(this.#k.multicast_interface),this.#W(o.InstanceStatus.Ok),this.emit("listening")}),this.#U.on("message",(e,t)=>this.emit("data",e,t)),this.#a=setTimeout(()=>{this.#G||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#j}:${this.#K} is missing an error handler!`)},5e3)}async send(e){if(this.#G)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise((t,i)=>{this.#U.send(e,this.#K,this.#j,e=>{e?i(e):t()})})}destroy(){this.#G=!0,void 0!==this.#a&&(clearTimeout(this.#a),this.#a=void 0),this.#U.removeAllListeners(),this.#U.close(),this.removeAllListeners()}#W(e,t){this.#z!=e&&(this.#z=e,this.emit("status_change",e,t))}}t.UDPHelper=n},6278:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.substituteEscapeCharacters=t.parseEscapeCharacters=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const r=i(1635);r.__exportStar(i(9077),t),r.__exportStar(i(2018),t),r.__exportStar(i(4581),t),r.__exportStar(i(5158),t);var a=i(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return a.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return a.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return a.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return a.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return a.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return a.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return a.assertNever}}),Object.defineProperty(t,"parseEscapeCharacters",{enumerable:!0,get:function(){return a.parseEscapeCharacters}}),Object.defineProperty(t,"substituteEscapeCharacters",{enumerable:!0,get:function(){return a.substituteEscapeCharacters}}),r.__exportStar(i(6160),t);var o=i(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return o.runEntrypoint}})},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var i={grad:.9,turn:360,rad:360/(2*Math.PI)},r=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},a=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=Math.pow(10,t)),Math.round(i*e)/i+0},o=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=1),e>i?i:e>t?e:t},n=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},s=function(e){return{r:o(e.r,0,255),g:o(e.g,0,255),b:o(e.b,0,255),a:o(e.a)}},l=function(e){return{r:a(e.r),g:a(e.g),b:a(e.b),a:a(e.a,3)}},u=/^#([0-9a-f]{3,8})$/i,c=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,i=e.g,r=e.b,a=e.a,o=Math.max(t,i,r),n=o-Math.min(t,i,r),s=n?o===t?(i-r)/n:o===i?2+(r-t)/n:4+(t-i)/n:0;return{h:60*(s<0?s+6:s),s:o?n/o*100:0,v:o/255*100,a}},p=function(e){var t=e.h,i=e.s,r=e.v,a=e.a;t=t/360*6,i/=100,r/=100;var o=Math.floor(t),n=r*(1-i),s=r*(1-(t-o)*i),l=r*(1-(1-t+o)*i),u=o%6;return{r:255*[r,s,n,n,l,r][u],g:255*[l,r,r,s,n,n][u],b:255*[n,n,l,r,r,s][u],a}},m=function(e){return{h:n(e.h),s:o(e.s,0,100),l:o(e.l,0,100),a:o(e.a)}},b=function(e){return{h:a(e.h),s:a(e.s),l:a(e.l),a:a(e.a,3)}},f=function(e){return p((i=(t=e).s,{h:t.h,s:(i*=((r=t.l)<50?r:100-r)/100)>0?2*i/(r+i)*100:0,v:r+i,a:t.a}));var t,i,r},g=function(e){return{h:(t=d(e)).h,s:(a=(200-(i=t.s))*(r=t.v)/100)>0&&a<200?i*r/100/(a<=100?a:200-a)*100:0,l:a/2,a:t.a};var t,i,r,a},h=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,S=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,P={string:[[function(e){var t=u.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?a(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?a(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=S.exec(e)||v.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:s({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=h.exec(e)||y.exec(e);if(!t)return null;var r,a,o=m({h:(r=t[1],a=t[2],void 0===a&&(a="deg"),Number(r)*(i[a]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return f(o)},"hsl"]],object:[[function(e){var t=e.r,i=e.g,a=e.b,o=e.a,n=void 0===o?1:o;return r(t)&&r(i)&&r(a)?s({r:Number(t),g:Number(i),b:Number(a),a:Number(n)}):null},"rgb"],[function(e){var t=e.h,i=e.s,a=e.l,o=e.a,n=void 0===o?1:o;if(!r(t)||!r(i)||!r(a))return null;var s=m({h:Number(t),s:Number(i),l:Number(a),a:Number(n)});return f(s)},"hsl"],[function(e){var t=e.h,i=e.s,a=e.v,s=e.a,l=void 0===s?1:s;if(!r(t)||!r(i)||!r(a))return null;var u=function(e){return{h:n(e.h),s:o(e.s,0,100),v:o(e.v,0,100),a:o(e.a)}}({h:Number(t),s:Number(i),v:Number(a),a:Number(l)});return p(u)},"hsv"]]},I=function(e,t){for(var i=0;i<t.length;i++){var r=t[i][0](e);if(r)return[r,t[i][1]]}return[null,void 0]},C=function(e){return"string"==typeof e?I(e.trim(),P.string):"object"==typeof e&&null!==e?I(e,P.object):[null,void 0]},k=function(e,t){var i=g(e);return{h:i.h,s:o(i.s+100*t,0,100),l:i.l,a:i.a}},w=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},E=function(e,t){var i=g(e);return{h:i.h,s:i.s,l:o(i.l+100*t,0,100),a:i.a}},x=function(){function e(e){this.parsed=C(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return a(w(this.rgba),2)},e.prototype.isDark=function(){return w(this.rgba)<.5},e.prototype.isLight=function(){return w(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=l(this.rgba)).r,i=e.g,r=e.b,n=(o=e.a)<1?c(a(255*o)):"","#"+c(t)+c(i)+c(r)+n;var e,t,i,r,o,n},e.prototype.toRgb=function(){return l(this.rgba)},e.prototype.toRgbString=function(){return t=(e=l(this.rgba)).r,i=e.g,r=e.b,(a=e.a)<1?"rgba("+t+", "+i+", "+r+", "+a+")":"rgb("+t+", "+i+", "+r+")";var e,t,i,r,a},e.prototype.toHsl=function(){return b(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=b(g(this.rgba))).h,i=e.s,r=e.l,(a=e.a)<1?"hsla("+t+", "+i+"%, "+r+"%, "+a+")":"hsl("+t+", "+i+"%, "+r+"%)";var e,t,i,r,a},e.prototype.toHsv=function(){return e=d(this.rgba),{h:a(e.h),s:a(e.s),v:a(e.v),a:a(e.a,3)};var e},e.prototype.invert=function(){return _({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),_(k(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),_(k(this.rgba,-e))},e.prototype.grayscale=function(){return _(k(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),_(E(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),_(E(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?_({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):a(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?_({h:e,s:t.s,l:t.l,a:t.a}):a(t.h)},e.prototype.isEqual=function(e){return this.toHex()===_(e).toHex()},e}(),_=function(e){return e instanceof x?e:new x(e)},A=[];t.Colord=x,t.colord=_,t.extend=function(e){e.forEach(function(e){A.indexOf(e)<0&&(e(x,P),A.push(e))})},t.getFormat=function(e){return C(e)[1]},t.random=function(){return new x({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6341:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constructNumberProps=t.constructBooleanProps=void 0;const r=i(2622);t.constructBooleanProps=function(e){return{type:r.Commands.CameraControlDataType.BOOL,boolData:e,numberData:[],bigintData:[],stringData:"",relative:!1}},t.constructNumberProps=function(e,t,i=!1){return{type:e,boolData:[],numberData:t,bigintData:[],stringData:"",relative:i}}},6422:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyColorCorrectionCommand=void 0;const r=i(2622),a=i(142),o=i(8430),n=i(2697);t.applyColorCorrectionCommand=function(e,t,i){const s=t.parameter;switch(s){case o.AtemCameraControlColorCorrectionParameter.LiftAdjust:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,4))return;return i.colorCorrection.liftAdjust={red:t.properties.numberData[0],green:t.properties.numberData[1],blue:t.properties.numberData[2],luma:t.properties.numberData[3]},void e.addChange(t.source,"colorCorrection.liftAdjust");case o.AtemCameraControlColorCorrectionParameter.GammaAdjust:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,4))return;return i.colorCorrection.gammaAdjust={red:t.properties.numberData[0],green:t.properties.numberData[1],blue:t.properties.numberData[2],luma:t.properties.numberData[3]},void e.addChange(t.source,"colorCorrection.gammaAdjust");case o.AtemCameraControlColorCorrectionParameter.GainAdjust:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,4))return;return i.colorCorrection.gainAdjust={red:t.properties.numberData[0],green:t.properties.numberData[1],blue:t.properties.numberData[2],luma:t.properties.numberData[3]},void e.addChange(t.source,"colorCorrection.gainAdjust");case o.AtemCameraControlColorCorrectionParameter.OffsetAdjust:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,4))return;return i.colorCorrection.offsetAdjust={red:t.properties.numberData[0],green:t.properties.numberData[1],blue:t.properties.numberData[2],luma:t.properties.numberData[3]},void e.addChange(t.source,"colorCorrection.offsetAdjust");case o.AtemCameraControlColorCorrectionParameter.ContrastAdjust:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,2))return;return i.colorCorrection.contrastAdjust={pivot:t.properties.numberData[0],adj:t.properties.numberData[1]},void e.addChange(t.source,"colorCorrection.contrastAdjust");case o.AtemCameraControlColorCorrectionParameter.LumaMix:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,1))return;return i.colorCorrection.lumaMix=t.properties.numberData[0],void e.addChange(t.source,"colorCorrection.lumaMix");case o.AtemCameraControlColorCorrectionParameter.ColorAdjust:if(!e.checkMessageParameters(t,r.Commands.CameraControlDataType.FLOAT,2))return;return i.colorCorrection.colorAdjust={hue:t.properties.numberData[0],saturation:t.properties.numberData[1]},void e.addChange(t.source,"colorCorrection.colorAdjust");case o.AtemCameraControlColorCorrectionParameter.ResetToDefaults:return void e.addEvent(t.source,n.AtemCameraControlEvents.ColorResetToDefault);default:return(0,a.assertNever)(s),void e.addUnhandledMessage(t)}}},6641:(e,t,i)=>{"use strict";const r=i(4617);class a extends Error{constructor(e){super(e),this.name="TimeoutError"}}const o=(e,t,i)=>new Promise((o,n)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void o(e);const s=setTimeout(()=>{if("function"==typeof i){try{o(i())}catch(e){n(e)}return}const r=i instanceof Error?i:new a("string"==typeof i?i:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),n(r)},t);r(e.then(o,n),()=>{clearTimeout(s)})});e.exports=o,e.exports.default=o,e.exports.TimeoutError=a},6878:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlBatchCommandSender=void 0;const r=i(6921);class a extends r.AtemCameraControlCommandGenerator{#L;#H=[];constructor(e){super(),this.#L=e}get hasPendingCommands(){return this.#H.length>0}discardBatch(){this.#H.splice(0,this.#H.length)}async sendBatch(){const e=this.#H.splice(0,this.#H.length);return this.#L.sendCommands(e)}addCommand(e){this.#H.push(e)}}t.AtemCameraControlBatchCommandSender=a},6921:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlCommandGenerator=void 0;const r=i(2622),a=i(8430),o=i(6341);t.AtemCameraControlCommandGenerator=class{lensFocus(e,t,i=!1){const n=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.Focus,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t],i));return this.addCommand(n)}lensTriggerAutoFocus(e){const t=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.AutoFocus,(0,o.constructBooleanProps)([]));return this.addCommand(t)}lensIrisFStop(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.ApertureFStop,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(i)}lensIrisNormalised(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.ApertureNormalised,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(i)}lensTriggerAutoIris(e){const t=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.AutoAperture,(0,o.constructBooleanProps)([]));return this.addCommand(t)}lensEnableOpticalImageStabilisation(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.OpticalImageStabilisation,(0,o.constructBooleanProps)([t]));return this.addCommand(i)}lensSetContinuousZoomSpeed(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.SetContinuousZoomSpeed,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(i)}videoManualWhiteBalance(e,t,i){const n=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.ManualWhiteBalance,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.SINT16,[t,i]));return this.addCommand(n)}videoTriggerAutoWhiteBalance(e){const t=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.SetAutoWhiteBalance,(0,o.constructBooleanProps)([]));return this.addCommand(t)}videoExposureUs(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.ExposureUs,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.SINT32,[t]));return this.addCommand(i)}videoSharpeningLevel(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.VideoSharpeningLevel,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.SINT8,[t]));return this.addCommand(i)}videoGain(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.Gain,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.SINT8,[t]));return this.addCommand(i)}videoNdFilterStop(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.NDFilterStop,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(i)}displayColorBars(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Display,a.AtemCameraControlDisplayParameter.ColorBarEnable,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.SINT8,[t?30:0]));return this.addCommand(i)}colorLiftAdjust(e,t,i,n,s){const l=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.LiftAdjust,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t,i,n,s]));return this.addCommand(l)}colorGammaAdjust(e,t,i,n,s){const l=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.GammaAdjust,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t,i,n,s]));return this.addCommand(l)}colorGainAdjust(e,t,i,n,s){const l=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.GainAdjust,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t,i,n,s]));return this.addCommand(l)}colorOffsetAdjust(e,t,i,n,s){const l=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.OffsetAdjust,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t,i,n,s]));return this.addCommand(l)}colorContrastAdjust(e,t,i){const n=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.ContrastAdjust,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[i,t]));return this.addCommand(n)}colorLumaMix(e,t){const i=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.LumaMix,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(i)}colorHueSaturationAdjust(e,t,i){const n=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.ColorAdjust,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.FLOAT,[t,i]));return this.addCommand(n)}colorResetAllToDefault(e){const t=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.ResetToDefaults,(0,o.constructBooleanProps)([]));return this.addCommand(t)}mediaTriggerSetRecording(e){const t=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Media,a.AtemCameraControlMediaParameter.TransportMode,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.SINT8,[2,0,0,0,0],!1));return this.addCommand(t)}mediaTriggerSetStopped(e){const t=new r.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Media,a.AtemCameraControlMediaParameter.TransportMode,(0,o.constructNumberProps)(r.Commands.CameraControlDataType.SINT8,[0,0,0,0,0],!1));return this.addCommand(t)}}},6928:e=>{"use strict";e.exports=require("path")},6982:e=>{"use strict";e.exports=require("crypto")},7e3:(e,t,i)=>{"use strict";const r=i(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:i=0,maxWait:a=0,before:o=!1,after:n=!0}=t;if(!o&&!n)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let s,l,u;const c=function(...t){const r=this,c=o&&!s;return clearTimeout(s),s=setTimeout(()=>{s=void 0,l&&(clearTimeout(l),l=void 0),n&&(u=e.apply(r,t))},i),a>0&&!l&&n&&(l=setTimeout(()=>{l=void 0,s&&(clearTimeout(s),s=void 0),u=e.apply(r,t)},a)),c&&(u=e.apply(r,t)),u};return r(c,e),c.cancel=()=>{s&&(clearTimeout(s),s=void 0),l&&(clearTimeout(l),l=void 0)},c}},7194:e=>{"use strict";e.exports=require("dgram")},7281:(e,t,i)=>{"use strict";e.exports=s,e.exports.default=s;const r={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},isPrerelease:{type:"boolean",description:"Is this a pre-release version"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"},url:{type:"string"}},required:["name"],additionalProperties:!1}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18 or node22",enum:["node18","node22"]},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"},permissions:{type:"object",description:"Permissions required by the module. This is used to inform the user of the permissions required by the module.\nNote: this requires the node22 or newer runtime",properties:{"worker-threads":{type:"boolean",description:"Enable if the module uses worker threads"},"child-process":{type:"boolean",description:"Enable if the module uses child processes"},"native-addons":{type:"boolean",description:"Enable if the module uses native addons"},filesystem:{type:"boolean",description:"Enable if the module requires read/write access to the filesystem"}},additionalProperties:!1}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}}}},required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]}}},a={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]},o=i(6250).A,n=new RegExp("","u");function s(e,{instancePath:t="",parentData:i,parentDataProperty:l,rootData:u=e}={}){let c=null,d=0;if(0===d){if(!e||"object"!=typeof e||Array.isArray(e))return s.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let i;if(void 0===e.id&&(i="id")||void 0===e.name&&(i="name")||void 0===e.shortname&&(i="shortname")||void 0===e.description&&(i="description")||void 0===e.version&&(i="version")||void 0===e.license&&(i="license")||void 0===e.repository&&(i="repository")||void 0===e.bugs&&(i="bugs")||void 0===e.maintainers&&(i="maintainers")||void 0===e.legacyIds&&(i="legacyIds")||void 0===e.runtime&&(i="runtime")||void 0===e.manufacturer&&(i="manufacturer")||void 0===e.products&&(i="products")||void 0===e.keywords&&(i="keywords"))return s.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:i},message:"must have required property '"+i+"'"}],!1;if(void 0!==e.$schema){const i=d;if("string"!=typeof e.$schema)return s.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var p=i===d}else p=!0;if(p){if(void 0!==e.id){const i=d;if("string"!=typeof e.id)return s.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.name){const i=d;if("string"!=typeof e.name)return s.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.shortname){const i=d;if("string"!=typeof e.shortname)return s.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.description){const i=d;if("string"!=typeof e.description)return s.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.version){const i=d;if("string"!=typeof e.version)return s.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.isPrerelease){const i=d;if("boolean"!=typeof e.isPrerelease)return s.errors=[{instancePath:t+"/isPrerelease",schemaPath:"#/properties/isPrerelease/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.license){const i=d;if("string"!=typeof e.license)return s.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.repository){const i=d;if("string"!=typeof e.repository)return s.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.bugs){const i=d;if("string"!=typeof e.bugs)return s.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.maintainers){let i=e.maintainers;const r=d;if(d===r){if(!Array.isArray(i))return s.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var m=!0;const e=i.length;for(let r=0;r<e;r++){let e=i[r];const a=d;if(d===a){if(!e||"object"!=typeof e||Array.isArray(e))return s.errors=[{instancePath:t+"/maintainers/"+r,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let i;if(void 0===e.name&&(i="name"))return s.errors=[{instancePath:t+"/maintainers/"+r,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:i},message:"must have required property '"+i+"'"}],!1;{const i=d;for(const i in e)if("name"!==i&&"email"!==i&&"github"!==i&&"url"!==i)return s.errors=[{instancePath:t+"/maintainers/"+r,schemaPath:"#/properties/maintainers/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:i},message:"must NOT have additional properties"}],!1;if(i===d){if(void 0!==e.name){const i=d;if("string"!=typeof e.name)return s.errors=[{instancePath:t+"/maintainers/"+r+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var b=i===d}else b=!0;if(b){if(void 0!==e.email){const i=d;if("string"!=typeof e.email)return s.errors=[{instancePath:t+"/maintainers/"+r+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=i===d}else b=!0;if(b){if(void 0!==e.github){const i=d;if("string"!=typeof e.github)return s.errors=[{instancePath:t+"/maintainers/"+r+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=i===d}else b=!0;if(b)if(void 0!==e.url){const i=d;if("string"!=typeof e.url)return s.errors=[{instancePath:t+"/maintainers/"+r+"/url",schemaPath:"#/properties/maintainers/items/properties/url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=i===d}else b=!0}}}}}}if(!(m=a===d))break}if(m){let e,r=i.length;if(r>1)for(;r--;)for(e=r;e--;)if(o(i[r],i[e]))return s.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1}}}p=r===d}else p=!0;if(p){if(void 0!==e.legacyIds){let i=e.legacyIds;const r=d;if(d===r){if(!Array.isArray(i))return s.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var f=!0;const e=i.length;for(let r=0;r<e;r++){const e=d;if("string"!=typeof i[r])return s.errors=[{instancePath:t+"/legacyIds/"+r,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(f=e===d))break}if(f){let e,r=i.length;if(r>1){const a={};for(;r--;){let o=i[r];if("string"==typeof o){if("number"==typeof a[o])return e=a[o],s.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;a[o]=r}}}}}}p=r===d}else p=!0;if(p){if(void 0!==e.runtime){let i=e.runtime;const a=d;if(d===a){if(!i||"object"!=typeof i||Array.isArray(i))return s.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===i.type&&(e="type")||void 0===i.api&&(e="api")||void 0===i.apiVersion&&(e="apiVersion")||void 0===i.entrypoint&&(e="entrypoint"))return s.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==i.type){let e=i.type;const a=d;if("string"!=typeof e)return s.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("node18"!==e&&"node22"!==e)return s.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/enum",keyword:"enum",params:{allowedValues:r.properties.runtime.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var g=a===d}else g=!0;if(g){if(void 0!==i.api){let e=i.api;const a=d;if("string"!=typeof e)return s.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return s.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:r.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;g=a===d}else g=!0;if(g){if(void 0!==i.apiVersion){const e=d;if("string"!=typeof i.apiVersion)return s.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===d}else g=!0;if(g){if(void 0!==i.entrypoint){const e=d;if("string"!=typeof i.entrypoint)return s.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===d}else g=!0;if(g)if(void 0!==i.permissions){let e=i.permissions;const r=d;if(d===r){if(!e||"object"!=typeof e||Array.isArray(e))return s.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const i=d;for(const i in e)if("worker-threads"!==i&&"child-process"!==i&&"native-addons"!==i&&"filesystem"!==i)return s.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:i},message:"must NOT have additional properties"}],!1;if(i===d){if(void 0!==e["worker-threads"]){const i=d;if("boolean"!=typeof e["worker-threads"])return s.errors=[{instancePath:t+"/runtime/permissions/worker-threads",schemaPath:"#/properties/runtime/properties/permissions/properties/worker-threads/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var h=i===d}else h=!0;if(h){if(void 0!==e["child-process"]){const i=d;if("boolean"!=typeof e["child-process"])return s.errors=[{instancePath:t+"/runtime/permissions/child-process",schemaPath:"#/properties/runtime/properties/permissions/properties/child-process/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;h=i===d}else h=!0;if(h){if(void 0!==e["native-addons"]){const i=d;if("boolean"!=typeof e["native-addons"])return s.errors=[{instancePath:t+"/runtime/permissions/native-addons",schemaPath:"#/properties/runtime/properties/permissions/properties/native-addons/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;h=i===d}else h=!0;if(h)if(void 0!==e.filesystem){const i=d;if("boolean"!=typeof e.filesystem)return s.errors=[{instancePath:t+"/runtime/permissions/filesystem",schemaPath:"#/properties/runtime/properties/permissions/properties/filesystem/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;h=i===d}else h=!0}}}}}g=r===d}else g=!0}}}}}p=a===d}else p=!0;if(p){if(void 0!==e.manufacturer){const i=d;if("string"!=typeof e.manufacturer)return s.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.products){let i=e.products;const r=d;if(d===r){if(!Array.isArray(i))return s.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(i.length<1)return s.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var y=!0;const e=i.length;for(let r=0;r<e;r++){const e=d;if("string"!=typeof i[r])return s.errors=[{instancePath:t+"/products/"+r,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(y=e===d))break}if(y){let e,r=i.length;if(r>1){const a={};for(;r--;){let o=i[r];if("string"==typeof o){if("number"==typeof a[o])return e=a[o],s.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;a[o]=r}}}}}}p=r===d}else p=!0;if(p){if(void 0!==e.keywords){let i=e.keywords;const r=d;if(d===r){if(!Array.isArray(i))return s.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var S=!0;const e=i.length;for(let r=0;r<e;r++){const e=d;if("string"!=typeof i[r])return s.errors=[{instancePath:t+"/keywords/"+r,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(S=e===d))break}if(S){let e,r=i.length;if(r>1){const a={};for(;r--;){let o=i[r];if("string"==typeof o){if("number"==typeof a[o])return e=a[o],s.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;a[o]=r}}}}}}p=r===d}else p=!0;if(p)if(void 0!==e.bonjourQueries){let i=e.bonjourQueries;const r=d;if(d===r){if(!i||"object"!=typeof i||Array.isArray(i))return s.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(const e in i)if(n.test(e)){let r=i[e];const o=d,l=d;let u=!1,p=null;const m=d;if(d==d)if(r&&"object"==typeof r&&!Array.isArray(r)){let i;if(void 0===r.type&&(i="type")||void 0===r.protocol&&(i="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:i},message:"must have required property '"+i+"'"};null===c?c=[r]:c.push(r),d++}else{if(void 0!==r.type){const i=d;if("string"!=typeof r.type){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===c?c=[i]:c.push(i),d++}var v=i===d}else v=!0;if(v){if(void 0!==r.protocol){let i=r.protocol;const o=d;if("string"!=typeof i){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===c?c=[i]:c.push(i),d++}if("tcp"!==i&&"udp"!==i){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:a.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===c?c=[i]:c.push(i),d++}v=o===d}else v=!0;if(v){if(void 0!==r.port){let i=r.port;const a=d;if("number"!=typeof i||!isFinite(i)){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===c?c=[i]:c.push(i),d++}v=a===d}else v=!0;if(v)if(void 0!==r.txt){let i=r.txt;const a=d;if(d===a)if(i&&"object"==typeof i&&!Array.isArray(i)){for(const r in i)if(n.test(r)){const a=d;if("string"!=typeof i[r]){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===c?c=[i]:c.push(i),d++}if(a!==d)break}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===c?c=[i]:c.push(i),d++}v=a===d}else v=!0}}}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===c?c=[i]:c.push(i),d++}m===d&&(u=!0,p=0);const b=d;if(d===b)if(Array.isArray(r)){const i=r.length;for(let o=0;o<i;o++){let i=r[o];const s=d;if(d==d)if(i&&"object"==typeof i&&!Array.isArray(i)){let r;if(void 0===i.type&&(r="type")||void 0===i.protocol&&(r="protocol")){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===c?c=[i]:c.push(i),d++}else{if(void 0!==i.type){const r=d;if("string"!=typeof i.type){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===c?c=[i]:c.push(i),d++}var P=r===d}else P=!0;if(P){if(void 0!==i.protocol){let r=i.protocol;const n=d;if("string"!=typeof r){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===c?c=[i]:c.push(i),d++}if("tcp"!==r&&"udp"!==r){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:a.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===c?c=[i]:c.push(i),d++}P=n===d}else P=!0;if(P){if(void 0!==i.port){let r=i.port;const a=d;if("number"!=typeof r||!isFinite(r)){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===c?c=[i]:c.push(i),d++}P=a===d}else P=!0;if(P)if(void 0!==i.txt){let r=i.txt;const a=d;if(d===a)if(r&&"object"==typeof r&&!Array.isArray(r)){for(const i in r)if(n.test(i)){const a=d;if("string"!=typeof r[i]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt/"+i.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===c?c=[r]:c.push(r),d++}if(a!==d)break}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===c?c=[i]:c.push(i),d++}P=a===d}else P=!0}}}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===c?c=[i]:c.push(i),d++}if(s!==d)break}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===c?c=[i]:c.push(i),d++}var I;if((I=b===d)&&u?(u=!1,p=[p,1]):I&&(u=!0,p=1),!u){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:p},message:"must match exactly one schema in oneOf"};return null===c?c=[i]:c.push(i),d++,s.errors=c,!1}if(d=l,null!==c&&(l?c.length=l:c=null),o!==d)break}}p=r===d}else p=!0}}}}}}}}}}}}}}}}}return s.errors=c,0===d}},7369:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.threadedClass=void 0;const r=i(6928),a=i(3791),o=i(6156),n=i(4468),s=i(2081);t.threadedClass=function(e,t,l,u={}){let c=t;const d=new Error;if("string"!=typeof e)throw new Error("threadedClass parameter orgModule must be a string!");if("string"!=typeof t)throw new Error("threadedClass parameter orgExport must be a string!");const p=Object.assign(Object.assign({},u),{instanceName:u.instanceName||t});if((0,o.isBrowser)()){if(!p.pathToWorker)throw Error("config.pathToWorker is required in browser");(0,o.browserSupportsWebWorkers)()||(console.log("Web-workers not supported, disabling multi-threading"),p.disableMultithreading=!0)}let m=a()[1].getFileName(),b=a()[0].getFileName();return new Promise((t,a)=>{function u(e,t,i,r){let a={cmd:n.Message.To.Instance.CommandType.FUNCTION,fcn:t,args:i};s.ThreadedClassManagerInternal.sendMessageToInstance(e,a,r)}function f(e,t,i,r,a){let o={cmd:n.Message.To.Instance.CommandType.REPLY,replyTo:t,reply:r,error:i?(i.stack||i).toString():i};s.ThreadedClassManagerInternal.sendMessageToInstance(e,o,a)}function g(e,t,i){f(e,t.cmdId,i)}function h(e,t){return(0,n.decodeArguments)(()=>e.proxy,[t],t=>(...i)=>new Promise((r,a)=>{!function(e,t,i){let o={cmd:n.Message.To.Instance.CommandType.CALLBACK,callbackId:t,args:i};s.ThreadedClassManagerInternal.sendMessageToInstance(e,o,(e,t,i)=>{if(t)a(t);else{let t=h(e,i);r(t)}})}(e,t.value,i)}))[0]}try{let y="",S="";if((0,o.isBrowser)())S=p.pathToWorker,y=e;else{if(!m)throw new Error("Unable to resolve parent file path");if(!b)throw new Error("Unable to resolve own file path");let t=e.match(/^\./)?r.resolve(m,"../",e):e;y=i(9551).resolve(t),S=b.replace(/parent-process/,"child-process").replace(/threadedClass(\.[tj]s)$/,"threadedclass-worker.js").replace(/src([\\\/])child-process([\\\/])threadedclass-worker/,"dist$1child-process$2threadedclass-worker")}const v=s.ThreadedClassManagerInternal.findNextAvailableChild(p,S),P={};let I=s.ThreadedClassManagerInternal.attachInstanceToChild(p,v,P,y,c,l,function(e,t){if(t.cmd===n.Message.From.Instance.CommandType.REPLY){let i=t;const r=e.child;let a=r.instanceMessageQueue[i.replyTo+""];if(!a)return;i.error?a(e,i.error):a(e,null,i.reply),delete r.instanceMessageQueue[i.replyTo+""]}else if(t.cmd===n.Message.From.Instance.CommandType.CALLBACK){let i=t,r=e.child.callbacks[i.callbackId];if(!r)throw Error(`callback "${i.callbackId}" not found in instance ${t.instanceId}`);try{Promise.resolve(r(...i.args)).then(t=>{let r=(0,n.encodeArguments)(e,e.child.callbacks,[t],!!p.disableMultithreading);f(e,i.cmdId,void 0,r[0])}).catch(t=>{g(e,i,t)})}catch(t){g(e,i,t)}}});s.ThreadedClassManagerInternal.sendInit(v,I,p,(e,i,r)=>i?(a(i),!1):(r.forEach(t=>{if(!e.child.alive)throw Error(`Child process of instance ${e.id} has been closed`);if(!P.hasOwnProperty(t.key))if(t.type===n.InitPropType.FUNCTION){const i=(...i)=>{const r=new Error;return e.child?s.ThreadedClassManagerInternal.doMethod(e.child,t.key,(a,s)=>{if(!e.child)throw new Error(`Instance ${e.id} has been detached from child process`);let l=(0,n.encodeArguments)(e,e.child.callbacks,i,!!p.disableMultithreading);u(e,t.key,l,(e,t,i)=>{if(t)t=(0,o.combineErrorStacks)(t,"Original stack (on parent):",r.stack||""),s(t);else{let t=h(e,i);a(t)}})}):Promise.reject(new Error(`Instance ${e.id} has been detached from child process`))};P[t.key]=i}else if(t.type===n.InitPropType.VALUE){let i={configurable:!1,enumerable:t.descriptor.enumerable};(t.descriptor.get||t.descriptor.readable)&&(i.get=function(){return new Promise((i,r)=>{u(e,t.key,[],(e,t,a)=>{if(t)r(t);else{let t=h(e,a);i(t)}})})}),(t.descriptor.set||t.descriptor.writable)&&(i.set=function(i){let r=(0,n.encodeArguments)(e,e.child.callbacks,[i],!!p.disableMultithreading);!function(e,t,i){let r={cmd:n.Message.To.Instance.CommandType.SET,property:t,value:i};s.ThreadedClassManagerInternal.sendMessageToInstance(e,r,(e,t,i)=>{t&&(console.log("Error in setter",t),P.__uncaughtError=t)})}(e,t.key,r[0])}),Object.defineProperty(P,t.key,i)}}),s.ThreadedClassManagerInternal.startMonitoringChild(I),t(P),s.ThreadedClassManagerInternal.checkInstance(I,d),!0))}catch(e){a(e)}})}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7963:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forkChildProcess=t.ChildProcessWorker=void 0;const r=i(5317),a=i(550);class o extends a.WorkerPlatformBase{constructor(e){super(),this.worker=(0,r.fork)(e),this.worker.on("message",e=>this.emit("message",e)),this.worker.on("close",()=>this.emit("close")),this.worker.on("error",e=>this.emit("error",e))}kill(){this.worker.kill()}send(e){this.worker.send(e)}}t.ChildProcessWorker=o,t.forkChildProcess=function(e){return new o(e)}},8039:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const r=i(1635),a=i(2593),o=r.__importDefault(i(7e3)),n=i(360);function s(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#R;#q;#J;#V;#Y=new Map;#X=new Map;#Q=new Map;#Z=new Map;#ee;get parseVariablesContext(){return this.#ee}constructor(e,t,i,r){this.#R=e,this.#q=t,this.#J=i,this.#V=r}getDefinitionIds(){return Array.from(this.#Y.keys())}getInstanceIds(){return Array.from(this.#X.keys())}handleUpdateFeedbacks(e){for(const[t,i]of Object.entries(e)){const e=this.#X.get(t);if(e&&!i){const t=this.#Y.get(e.feedbackId);if(t?.unsubscribe){const i={parseVariablesInString:async e=>e};Promise.resolve(t.unsubscribe(s(t.type,e),i)).catch(t=>{this.#V("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}if(!i||i.disabled)this.#X.delete(t);else{if(this.#X.set(t,{...i}),!e){const e=this.#Y.get(i.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>e};Promise.resolve(e.subscribe(s(e.type,i),t)).catch(e=>{this.#V("error",`Feedback subscribe failed: ${JSON.stringify(i)} - ${e?.message??e} ${e?.stack}`)})}}this.#te(t)}}}async handleLearnFeedback(e){const t=this.#Y.get(e.feedback.feedbackId);if(t&&t.learn){const i={parseVariablesInString:async t=>(await this.#R({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},i)}}return{options:void 0}}#te(e){const t=this.#Z.get(e);if(t)return void(t.needsRecheck=!0);const i=this.#X.get(e);if(!i)return;const r=i,a={needsRecheck:!1};this.#Z.set(e,a),Promise.resolve().then(async()=>{const t=this.#Y.get(r.feedbackId);let i;if(t){this.#ee=`Feedback ${r.feedbackId} (${e})`;const a={parseVariablesInString:async t=>(await this.#R({text:t,controlId:r.controlId,actionInstanceId:void 0,feedbackInstanceId:e})).text};switch(t.type){case"boolean":i=t.callback({...s("boolean",r),type:"boolean"},a);break;case"value":i=t.callback({...s("value",r),type:"value"},a);break;case"advanced":i=t.callback({...s("advanced",r),type:"advanced",image:r.image},a);break;default:(0,n.assertNever)(t)}this.#ee=void 0}const a=await i;this.#Q.set(e,{id:e,controlId:r.controlId,value:a}),this.#ie()}).catch(e=>{console.error(`Feedback check failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}).finally(()=>{this.#ee=void 0,this.#Z.delete(e),a.needsRecheck&&setImmediate(()=>{this.#te(e)})})}#ie=(0,o.default)(()=>{const e=this.#Q;this.#Q=new Map,e.size>0&&this.#q({values:Array.from(e.values())})},{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#Y.clear();for(const[i,r]of Object.entries(e))r&&(t.push({id:i,name:r.name,description:r.description,options:(0,a.serializeIsVisibleFn)(r.options),type:r.type,defaultStyle:"boolean"===r.type?r.defaultStyle:void 0,hasLearn:!!r.learn,learnTimeout:r.learnTimeout,showInvert:"boolean"===r.type&&r.showInvert}),this.#Y.set(i,r));this.#J({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,i]of this.#X.entries())this.#Y.get(i.feedbackId)&&(0===t.size||t.has(i.feedbackId))&&this.#te(e)}checkFeedbacksById(e){for(const t of e)this.#te(t)}subscribeFeedbacks(e){let t=Array.from(this.#X.values());const i=new Set(e);i.size&&(t=t.filter(e=>i.has(e.feedbackId)));for(const e of t){const t=this.#Y.get(e.feedbackId);if(t?.subscribe){const i={parseVariablesInString:async e=>e};Promise.resolve(t.subscribe(s(t.type,e),i)).catch(t=>{this.#V("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}unsubscribeFeedbacks(e){let t=Array.from(this.#X.values());const i=new Set(e);i.size&&(t=t.filter(e=>i.has(e.feedbackId)));for(const e of t){const t=this.#Y.get(e.feedbackId);if(t&&t.unsubscribe){const i={parseVariablesInString:async e=>e};Promise.resolve(t.unsubscribe(s(t.type,e),i)).catch(t=>{this.#V("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}}},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8126:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FakeWorker=void 0;const r=i(3080);class a extends r.Worker{constructor(e){super(),this.disabledMultithreading=!0,this.mockProcessSend=e}killInstance(){}sendInstanceMessageToParent(e,t,i){const r=Object.assign(Object.assign({},t),{messageType:"instance",cmdId:e.cmdId++,instanceId:e.id});i&&(e.queue[r.cmdId+""]={cb:i}),this.mockProcessSend(r)}sendChildMessageToParent(e,t,i){const r=Object.assign(Object.assign({},t),{messageType:"child",cmdId:e.cmdId++});i&&(e.queue[r.cmdId+""]={cb:i}),this.mockProcessSend(r)}}t.FakeWorker=a},8167:e=>{"use strict";e.exports=require("worker_threads")},8430:(e,t)=>{"use strict";var i,r,a,o,n,s,l,u,c,d,p,m;Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlPTZControlParameter=t.AtemCameraControlMediaParameter=t.AtemCameraControlColorCorrectionParameter=t.AtemCameraControlConfigurationParameter=t.AtemCameraControlReferenceParameter=t.AtemCameraControlTallyParameter=t.AtemCameraControlDisplayParameter=t.AtemCameraControlOutputParameter=t.AtemCameraControlAudioParameter=t.AtemCameraControlVideoParameter=t.AtemCameraControlLensParameter=t.AtemCameraControlCategory=void 0,function(e){e[e.Lens=0]="Lens",e[e.Video=1]="Video",e[e.Audio=2]="Audio",e[e.Output=3]="Output",e[e.Display=4]="Display",e[e.Tally=5]="Tally",e[e.Reference=6]="Reference",e[e.Configuration=7]="Configuration",e[e.ColorCorrection=8]="ColorCorrection",e[e.Media=10]="Media",e[e.PTZControl=11]="PTZControl"}(i||(t.AtemCameraControlCategory=i={})),function(e){e[e.Focus=0]="Focus",e[e.AutoFocus=1]="AutoFocus",e[e.ApertureFStop=2]="ApertureFStop",e[e.ApertureNormalised=3]="ApertureNormalised",e[e.ApertureOrdinal=4]="ApertureOrdinal",e[e.AutoAperture=5]="AutoAperture",e[e.OpticalImageStabilisation=6]="OpticalImageStabilisation",e[e.SetAbsoluteZoomMM=7]="SetAbsoluteZoomMM",e[e.SetAbsoluteZoomNormalised=8]="SetAbsoluteZoomNormalised",e[e.SetContinuousZoomSpeed=9]="SetContinuousZoomSpeed"}(r||(t.AtemCameraControlLensParameter=r={})),function(e){e[e.VideoMode=0]="VideoMode",e[e.GainCamera4_9=1]="GainCamera4_9",e[e.ManualWhiteBalance=2]="ManualWhiteBalance",e[e.SetAutoWhiteBalance=3]="SetAutoWhiteBalance",e[e.RestoreAutoWhiteBalance=4]="RestoreAutoWhiteBalance",e[e.ExposureUs=5]="ExposureUs",e[e.ExposureOrdinal=6]="ExposureOrdinal",e[e.DynamicRangeMode=7]="DynamicRangeMode",e[e.VideoSharpeningLevel=8]="VideoSharpeningLevel",e[e.RecordingFormat=9]="RecordingFormat",e[e.SetAutoExpsureMode=10]="SetAutoExpsureMode",e[e.ShutterAngle=11]="ShutterAngle",e[e.ShutterSpeed=12]="ShutterSpeed",e[e.Gain=13]="Gain",e[e.ISO=14]="ISO",e[e.DisplayLUT=15]="DisplayLUT",e[e.NDFilterStop=16]="NDFilterStop"}(a||(t.AtemCameraControlVideoParameter=a={})),function(e){e[e.MicLevel=0]="MicLevel",e[e.HeadphoneLevel=1]="HeadphoneLevel",e[e.HeadphoneProgramMix=2]="HeadphoneProgramMix",e[e.SpeakerLevel=3]="SpeakerLevel",e[e.InputType=4]="InputType",e[e.InputLevels=5]="InputLevels",e[e.PhantomPower=6]="PhantomPower"}(o||(t.AtemCameraControlAudioParameter=o={})),function(e){e[e.OverlayEnables=0]="OverlayEnables",e[e.FrameGuidesStyleCamera3_x=1]="FrameGuidesStyleCamera3_x",e[e.FrameGuidesOpacityCamera3_x=2]="FrameGuidesOpacityCamera3_x",e[e.Overlays=3]="Overlays"}(n||(t.AtemCameraControlOutputParameter=n={})),function(e){e[e.Brightness=0]="Brightness",e[e.ExposureAndFocusTools=1]="ExposureAndFocusTools",e[e.ZebraLevel=2]="ZebraLevel",e[e.PeakingLevel=3]="PeakingLevel",e[e.ColorBarEnable=4]="ColorBarEnable",e[e.FocusAssist=5]="FocusAssist",e[e.ProgramReturnFeedEnable=6]="ProgramReturnFeedEnable",e[e.TimecodeSource=7]="TimecodeSource"}(s||(t.AtemCameraControlDisplayParameter=s={})),function(e){e[e.TallyBrightness=0]="TallyBrightness",e[e.FrontTallyBrightness=1]="FrontTallyBrightness",e[e.RearTallyBrightness=2]="RearTallyBrightness"}(l||(t.AtemCameraControlTallyParameter=l={})),function(e){e[e.Source=0]="Source",e[e.Offset=1]="Offset"}(u||(t.AtemCameraControlReferenceParameter=u={})),function(e){e[e.RealTimEClock=0]="RealTimEClock",e[e.SystemLanguage=1]="SystemLanguage",e[e.Timezone=2]="Timezone",e[e.Location=3]="Location"}(c||(t.AtemCameraControlConfigurationParameter=c={})),function(e){e[e.LiftAdjust=0]="LiftAdjust",e[e.GammaAdjust=1]="GammaAdjust",e[e.GainAdjust=2]="GainAdjust",e[e.OffsetAdjust=3]="OffsetAdjust",e[e.ContrastAdjust=4]="ContrastAdjust",e[e.LumaMix=5]="LumaMix",e[e.ColorAdjust=6]="ColorAdjust",e[e.ResetToDefaults=7]="ResetToDefaults"}(d||(t.AtemCameraControlColorCorrectionParameter=d={})),function(e){e[e.Codec=0]="Codec",e[e.TransportMode=1]="TransportMode",e[e.PlaybackControl=2]="PlaybackControl",e[e.Stream=5]="Stream",e[e.StreamInformation=6]="StreamInformation",e[e.StreamDsiplay3DLUT=7]="StreamDsiplay3DLUT"}(p||(t.AtemCameraControlMediaParameter=p={})),function(e){e[e.PanTiltVelocity=0]="PanTiltVelocity",e[e.MemoryPreset=1]="MemoryPreset"}(m||(t.AtemCameraControlPTZControlParameter=m={}))},8730:(e,t,i)=>{"use strict";let r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.NativeError=t.Native=void 0;try{t.Native=r=i(4225)}catch(e){t.NativeError=a=e}},8895:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const r=i(1635).__importDefault(i(9278)),a=i(3693),o=i(1400);class n extends a.EventEmitter{#j;#K;_socket;#k;#re=!1;#ae=!1;#G=!1;#z;#oe;#a;get isConnected(){return this.#re}get isConnecting(){return this.#ae}get isDestroyed(){return this.#G}constructor(e,t,i){super(),this.#j=e,this.#K=t,this.#k={reconnect_interval:2e3,reconnect:!0,...i},this._socket=new r.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",e=>{this.#ae=!1,this.#re=!1,this.#k.reconnect&&this.#ne(),this.#W(o.InstanceStatus.UnknownError,e.message),this.emit("error",e)}),this._socket.on("ready",()=>{this.#re=!0,this.#ae=!1,this.#W(o.InstanceStatus.Ok),this.emit("connect")}),this._socket.on("end",()=>{this.#re=!1,this.#W(o.InstanceStatus.Disconnected),!this.#ae&&this.#k.reconnect&&this.#ne(),this.emit("end")}),this._socket.on("data",e=>this.emit("data",e)),this._socket.on("drain",()=>this.emit("drain")),setImmediate(()=>{this.#G||this.connect()}),this.#a=setTimeout(()=>{this.#a=void 0,this.#G||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#j}:${this.#K} is missing an error handler!`)},5e3)}connect(){if(this.#G)throw new Error("Cannot connect destroyed socket");return!this.#ae&&(this.#ae=!0,this._socket.connect(this.#K,this.#j),!0)}async send(e){if(this.#G||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#re)return!1;try{return new Promise((t,i)=>{this._socket.write(e,e=>{e?i(e):t(!0)})})}catch(e){this.#re=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#W(o.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#G=!0,void 0!==this.#oe&&(clearTimeout(this.#oe),this.#oe=void 0),void 0!==this.#a&&(clearTimeout(this.#a),this.#a=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#ne(){void 0!==this.#oe&&clearTimeout(this.#oe),this.#oe=setTimeout(()=>{this.#oe=void 0,this.#W(o.InstanceStatus.Connecting),this.connect()},this.#k.reconnect_interval)}#W(e,t){this.#z!=e&&(this.#z=e,this.emit("status_change",e,t))}}t.TCPHelper=n},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9077:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=function(e,t){if(!t){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'")}if(e.legacyIds.includes(e.id))throw new Error(`Manifest contains itself '${e.id}' in legacyIds`);if(!(0,r.default)(e)){const e=r.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}};const r=i(1635).__importDefault(i(7281))},9115:(e,t)=>{"use strict";var i,r,a,o,n,s,l,u,c,d,p,m,b,f,g,h,y,S,v,P,I,C,k,w,E,x,_,A,T,M,N,O,R,$,D,V,F,B;Object.defineProperty(t,"__esModule",{value:!0}),t.TimeMode=t.AudioInternalPortType=t.AudioChannelPair=t.DisplayClockClockMode=t.DisplayClockClockState=t.MultiViewerLayout=t.FairlightInputType=t.FairlightAudioSourceType=t.FairlightAnalogInputLevel=t.FairlightInputConfiguration=t.FairlightAudioMixOption=t.RecordingDiskStatus=t.RecordingStatus=t.RecordingError=t.StreamingStatus=t.StreamingError=t.AudioSourceType=t.AudioMixOption=t.MediaSourceType=t.VideoMode=t.VideoFormat=t.SuperSourceArtOption=t.FlyKeyDirection=t.FlyKeyKeyFrame=t.MixEffectKeyType=t.Pattern=t.IsAtKeyFrame=t.BorderBevel=t.MeAvailability=t.SourceAvailability=t.InternalPortType=t.ExternalPortType=t.MacroAction=t.DVEEffect=t.TransitionSelection=t.TransitionStyle=t.ProtocolVersion=t.Model=void 0,(B=t.Model||(t.Model={}))[B.Unknown=0]="Unknown",B[B.TVS=1]="TVS",B[B.OneME=2]="OneME",B[B.TwoME=3]="TwoME",B[B.PS4K=4]="PS4K",B[B.OneME4K=5]="OneME4K",B[B.TwoME4K=6]="TwoME4K",B[B.TwoMEBS4K=7]="TwoMEBS4K",B[B.TVSHD=8]="TVSHD",B[B.TVSProHD=9]="TVSProHD",B[B.TVSPro4K=10]="TVSPro4K",B[B.Constellation=11]="Constellation",B[B.Constellation8K=12]="Constellation8K",B[B.Mini=13]="Mini",B[B.MiniPro=14]="MiniPro",B[B.MiniProISO=15]="MiniProISO",B[B.MiniExtreme=16]="MiniExtreme",B[B.MiniExtremeISO=17]="MiniExtremeISO",B[B.ConstellationHD1ME=18]="ConstellationHD1ME",B[B.ConstellationHD2ME=19]="ConstellationHD2ME",B[B.ConstellationHD4ME=20]="ConstellationHD4ME",B[B.SDI=21]="SDI",B[B.SDIProISO=22]="SDIProISO",B[B.SDIExtremeISO=23]="SDIExtremeISO",B[B.TelevisionStudioHD8=26]="TelevisionStudioHD8",B[B.TelevisionStudioHD8ISO=27]="TelevisionStudioHD8ISO",B[B.Constellation4K1ME=28]="Constellation4K1ME",B[B.Constellation4K2ME=29]="Constellation4K2ME",B[B.Constellation4K4ME=30]="Constellation4K4ME",B[B.TelevisionStudio4K8=32]="TelevisionStudio4K8",(F=t.ProtocolVersion||(t.ProtocolVersion={}))[F.V7_2=131094]="V7_2",F[F.V7_5_2=131099]="V7_5_2",F[F.V8_0=131100]="V8_0",F[F.V8_0_1=131101]="V8_0_1",F[F.V8_1_1=131102]="V8_1_1",F[F.V9_4=131103]="V9_4",F[F.V9_6=131104]="V9_6",(V=t.TransitionStyle||(t.TransitionStyle={}))[V.MIX=0]="MIX",V[V.DIP=1]="DIP",V[V.WIPE=2]="WIPE",V[V.DVE=3]="DVE",V[V.STING=4]="STING",(D=t.TransitionSelection||(t.TransitionSelection={}))[D.Background=1]="Background",D[D.Key1=2]="Key1",D[D.Key2=4]="Key2",D[D.Key3=8]="Key3",D[D.Key4=16]="Key4",($=t.DVEEffect||(t.DVEEffect={}))[$.SwooshTopLeft=0]="SwooshTopLeft",$[$.SwooshTop=1]="SwooshTop",$[$.SwooshTopRight=2]="SwooshTopRight",$[$.SwooshLeft=3]="SwooshLeft",$[$.SwooshRight=4]="SwooshRight",$[$.SwooshBottomLeft=5]="SwooshBottomLeft",$[$.SwooshBottom=6]="SwooshBottom",$[$.SwooshBottomRight=7]="SwooshBottomRight",$[$.SpinCCWTopRight=13]="SpinCCWTopRight",$[$.SpinCWTopLeft=8]="SpinCWTopLeft",$[$.SpinCCWBottomRight=15]="SpinCCWBottomRight",$[$.SpinCWBottomLeft=10]="SpinCWBottomLeft",$[$.SpinCWTopRight=9]="SpinCWTopRight",$[$.SpinCCWTopLeft=12]="SpinCCWTopLeft",$[$.SpinCWBottomRight=11]="SpinCWBottomRight",$[$.SpinCCWBottomLeft=14]="SpinCCWBottomLeft",$[$.SqueezeTopLeft=16]="SqueezeTopLeft",$[$.SqueezeTop=17]="SqueezeTop",$[$.SqueezeTopRight=18]="SqueezeTopRight",$[$.SqueezeLeft=19]="SqueezeLeft",$[$.SqueezeRight=20]="SqueezeRight",$[$.SqueezeBottomLeft=21]="SqueezeBottomLeft",$[$.SqueezeBottom=22]="SqueezeBottom",$[$.SqueezeBottomRight=23]="SqueezeBottomRight",$[$.PushTopLeft=24]="PushTopLeft",$[$.PushTop=25]="PushTop",$[$.PushTopRight=26]="PushTopRight",$[$.PushLeft=27]="PushLeft",$[$.PushRight=28]="PushRight",$[$.PushBottomLeft=29]="PushBottomLeft",$[$.PushBottom=30]="PushBottom",$[$.PushBottomRight=31]="PushBottomRight",$[$.GraphicCWSpin=32]="GraphicCWSpin",$[$.GraphicCCWSpin=33]="GraphicCCWSpin",$[$.GraphicLogoWipe=34]="GraphicLogoWipe",(R=t.MacroAction||(t.MacroAction={}))[R.Run=0]="Run",R[R.Stop=1]="Stop",R[R.StopRecord=2]="StopRecord",R[R.InsertUserWait=3]="InsertUserWait",R[R.Continue=4]="Continue",R[R.Delete=5]="Delete",(O=t.ExternalPortType||(t.ExternalPortType={}))[O.Unknown=0]="Unknown",O[O.SDI=1]="SDI",O[O.HDMI=2]="HDMI",O[O.Component=4]="Component",O[O.Composite=8]="Composite",O[O.SVideo=16]="SVideo",O[O.XLR=32]="XLR",O[O.AESEBU=64]="AESEBU",O[O.RCA=128]="RCA",O[O.Internal=256]="Internal",O[O.TSJack=512]="TSJack",O[O.MADI=1024]="MADI",O[O.TRSJack=2048]="TRSJack",O[O.RJ45=4096]="RJ45",(N=t.InternalPortType||(t.InternalPortType={}))[N.External=0]="External",N[N.Black=1]="Black",N[N.ColorBars=2]="ColorBars",N[N.ColorGenerator=3]="ColorGenerator",N[N.MediaPlayerFill=4]="MediaPlayerFill",N[N.MediaPlayerKey=5]="MediaPlayerKey",N[N.SuperSource=6]="SuperSource",N[N.ExternalDirect=7]="ExternalDirect",N[N.MEOutput=128]="MEOutput",N[N.Auxiliary=129]="Auxiliary",N[N.Mask=130]="Mask",N[N.MultiViewer=131]="MultiViewer",(M=t.SourceAvailability||(t.SourceAvailability={}))[M.None=0]="None",M[M.Auxiliary=1]="Auxiliary",M[M.Multiviewer=2]="Multiviewer",M[M.SuperSourceArt=4]="SuperSourceArt",M[M.SuperSourceBox=8]="SuperSourceBox",M[M.KeySource=16]="KeySource",M[M.Auxiliary1=32]="Auxiliary1",M[M.Auxiliary2=64]="Auxiliary2",M[M.All=127]="All",(T=t.MeAvailability||(t.MeAvailability={}))[T.None=0]="None",T[T.Me1=1]="Me1",T[T.Me2=2]="Me2",T[T.Me3=4]="Me3",T[T.Me4=8]="Me4",T[T.All=15]="All",(A=t.BorderBevel||(t.BorderBevel={}))[A.None=0]="None",A[A.InOut=1]="InOut",A[A.In=2]="In",A[A.Out=3]="Out",(_=t.IsAtKeyFrame||(t.IsAtKeyFrame={}))[_.None=0]="None",_[_.A=1]="A",_[_.B=2]="B",_[_.RunToInfinite=4]="RunToInfinite",(x=t.Pattern||(t.Pattern={}))[x.LeftToRightBar=0]="LeftToRightBar",x[x.TopToBottomBar=1]="TopToBottomBar",x[x.HorizontalBarnDoor=2]="HorizontalBarnDoor",x[x.VerticalBarnDoor=3]="VerticalBarnDoor",x[x.CornersInFourBox=4]="CornersInFourBox",x[x.RectangleIris=5]="RectangleIris",x[x.DiamondIris=6]="DiamondIris",x[x.CircleIris=7]="CircleIris",x[x.TopLeftBox=8]="TopLeftBox",x[x.TopRightBox=9]="TopRightBox",x[x.BottomRightBox=10]="BottomRightBox",x[x.BottomLeftBox=11]="BottomLeftBox",x[x.TopCentreBox=12]="TopCentreBox",x[x.RightCentreBox=13]="RightCentreBox",x[x.BottomCentreBox=14]="BottomCentreBox",x[x.LeftCentreBox=15]="LeftCentreBox",x[x.TopLeftDiagonal=16]="TopLeftDiagonal",x[x.TopRightDiagonal=17]="TopRightDiagonal",(E=t.MixEffectKeyType||(t.MixEffectKeyType={}))[E.Luma=0]="Luma",E[E.Chroma=1]="Chroma",E[E.Pattern=2]="Pattern",E[E.DVE=3]="DVE",(w=t.FlyKeyKeyFrame||(t.FlyKeyKeyFrame={}))[w.None=0]="None",w[w.A=1]="A",w[w.B=2]="B",w[w.Full=3]="Full",w[w.RunToInfinite=4]="RunToInfinite",(k=t.FlyKeyDirection||(t.FlyKeyDirection={}))[k.CentreOfKey=0]="CentreOfKey",k[k.TopLeft=1]="TopLeft",k[k.TopCentre=2]="TopCentre",k[k.TopRight=3]="TopRight",k[k.MiddleLeft=4]="MiddleLeft",k[k.MiddleCentre=5]="MiddleCentre",k[k.MiddleRight=6]="MiddleRight",k[k.BottomLeft=7]="BottomLeft",k[k.BottomCentre=8]="BottomCentre",k[k.BottomRight=9]="BottomRight",(C=t.SuperSourceArtOption||(t.SuperSourceArtOption={}))[C.Background=0]="Background",C[C.Foreground=1]="Foreground",(I=t.VideoFormat||(t.VideoFormat={}))[I.SD=0]="SD",I[I.HD720=1]="HD720",I[I.HD1080=2]="HD1080",I[I.UHD4K=3]="UHD4K",I[I.UDH8K=4]="UDH8K",(P=t.VideoMode||(t.VideoMode={}))[P.N525i5994NTSC=0]="N525i5994NTSC",P[P.P625i50PAL=1]="P625i50PAL",P[P.N525i5994169=2]="N525i5994169",P[P.P625i50169=3]="P625i50169",P[P.P720p50=4]="P720p50",P[P.N720p5994=5]="N720p5994",P[P.P1080i50=6]="P1080i50",P[P.N1080i5994=7]="N1080i5994",P[P.N1080p2398=8]="N1080p2398",P[P.N1080p24=9]="N1080p24",P[P.P1080p25=10]="P1080p25",P[P.N1080p2997=11]="N1080p2997",P[P.P1080p50=12]="P1080p50",P[P.N1080p5994=13]="N1080p5994",P[P.N4KHDp2398=14]="N4KHDp2398",P[P.N4KHDp24=15]="N4KHDp24",P[P.P4KHDp25=16]="P4KHDp25",P[P.N4KHDp2997=17]="N4KHDp2997",P[P.P4KHDp5000=18]="P4KHDp5000",P[P.N4KHDp5994=19]="N4KHDp5994",P[P.N8KHDp2398=20]="N8KHDp2398",P[P.N8KHDp24=21]="N8KHDp24",P[P.P8KHDp25=22]="P8KHDp25",P[P.N8KHDp2997=23]="N8KHDp2997",P[P.P8KHDp50=24]="P8KHDp50",P[P.N8KHDp5994=25]="N8KHDp5994",P[P.N1080p30=26]="N1080p30",P[P.N1080p60=27]="N1080p60",(v=t.MediaSourceType||(t.MediaSourceType={}))[v.Still=1]="Still",v[v.Clip=2]="Clip",(S=t.AudioMixOption||(t.AudioMixOption={}))[S.Off=0]="Off",S[S.On=1]="On",S[S.AudioFollowVideo=2]="AudioFollowVideo",(y=t.AudioSourceType||(t.AudioSourceType={}))[y.ExternalVideo=0]="ExternalVideo",y[y.MediaPlayer=1]="MediaPlayer",y[y.ExternalAudio=2]="ExternalAudio",(h=t.StreamingError||(t.StreamingError={}))[h.None=0]="None",h[h.InvalidState=16]="InvalidState",h[h.Unknown=32768]="Unknown",(g=t.StreamingStatus||(t.StreamingStatus={}))[g.Idle=1]="Idle",g[g.Connecting=2]="Connecting",g[g.Streaming=4]="Streaming",g[g.Stopping=32]="Stopping",(f=t.RecordingError||(t.RecordingError={}))[f.None=2]="None",f[f.NoMedia=0]="NoMedia",f[f.MediaFull=4]="MediaFull",f[f.MediaError=8]="MediaError",f[f.MediaUnformatted=16]="MediaUnformatted",f[f.DroppingFrames=32]="DroppingFrames",f[f.Unknown=32768]="Unknown",(b=t.RecordingStatus||(t.RecordingStatus={}))[b.Idle=0]="Idle",b[b.Recording=1]="Recording",b[b.Stopping=128]="Stopping",(m=t.RecordingDiskStatus||(t.RecordingDiskStatus={}))[m.Idle=1]="Idle",m[m.Unformatted=2]="Unformatted",m[m.Active=4]="Active",m[m.Recording=8]="Recording",m[m.Removed=32]="Removed",(p=t.FairlightAudioMixOption||(t.FairlightAudioMixOption={}))[p.Off=1]="Off",p[p.On=2]="On",p[p.AudioFollowVideo=4]="AudioFollowVideo",(d=t.FairlightInputConfiguration||(t.FairlightInputConfiguration={}))[d.Mono=1]="Mono",d[d.Stereo=2]="Stereo",d[d.DualMono=4]="DualMono",(c=t.FairlightAnalogInputLevel||(t.FairlightAnalogInputLevel={}))[c.Microphone=1]="Microphone",c[c.ConsumerLine=2]="ConsumerLine",c[c.ProLine=4]="ProLine",(u=t.FairlightAudioSourceType||(t.FairlightAudioSourceType={}))[u.Mono=0]="Mono",u[u.Stereo=1]="Stereo",(l=t.FairlightInputType||(t.FairlightInputType={}))[l.EmbeddedWithVideo=0]="EmbeddedWithVideo",l[l.MediaPlayer=1]="MediaPlayer",l[l.AudioIn=2]="AudioIn",l[l.MADI=4]="MADI",(s=t.MultiViewerLayout||(t.MultiViewerLayout={}))[s.Default=0]="Default",s[s.TopLeftSmall=1]="TopLeftSmall",s[s.TopRightSmall=2]="TopRightSmall",s[s.ProgramBottom=3]="ProgramBottom",s[s.BottomLeftSmall=4]="BottomLeftSmall",s[s.ProgramRight=5]="ProgramRight",s[s.BottomRightSmall=8]="BottomRightSmall",s[s.ProgramLeft=10]="ProgramLeft",s[s.ProgramTop=12]="ProgramTop",(n=t.DisplayClockClockState||(t.DisplayClockClockState={}))[n.Stopped=0]="Stopped",n[n.Running=1]="Running",n[n.Reset=2]="Reset",(o=t.DisplayClockClockMode||(t.DisplayClockClockMode={}))[o.Countdown=0]="Countdown",o[o.Countup=1]="Countup",o[o.TimeOfDay=2]="TimeOfDay",(a=t.AudioChannelPair||(t.AudioChannelPair={}))[a.Channel1_2=0]="Channel1_2",a[a.Channel3_4=1]="Channel3_4",a[a.Channel5_6=2]="Channel5_6",a[a.Channel7_8=3]="Channel7_8",a[a.Channel9_10=4]="Channel9_10",a[a.Channel11_12=5]="Channel11_12",a[a.Channel13_14=6]="Channel13_14",a[a.Channel15_16=7]="Channel15_16",(r=t.AudioInternalPortType||(t.AudioInternalPortType={}))[r.NotInternal=0]="NotInternal",r[r.NoAudio=1]="NoAudio",r[r.TalkbackMix=2]="TalkbackMix",r[r.EngineeringTalkbackMix=3]="EngineeringTalkbackMix",r[r.ProductionTalkbackMix=4]="ProductionTalkbackMix",r[r.MediaPlayer=5]="MediaPlayer",r[r.Program=6]="Program",r[r.Return=7]="Return",r[r.Monitor=8]="Monitor",r[r.Madi=9]="Madi",r[r.AuxOut=10]="AuxOut",r[r.AudioAuxOut=11]="AudioAuxOut",(i=t.TimeMode||(t.TimeMode={}))[i.FreeRun=0]="FreeRun",i[i.TimeOfDay=1]="TimeOfDay"},9278:e=>{"use strict";e.exports=require("net")},9551:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=9551,e.exports=t},9599:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FakeProcess=void 0;const r=i(550),a=i(8126);class o extends r.WorkerPlatformBase{constructor(){super(),this._isFakeProcess=!0,this.worker=new a.FakeWorker(e=>{this.emit("message",e)})}kill(){this.emit("close")}send(e){this.worker.onMessageFromParent(e)}}t.FakeProcess=o},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyUpgradeScript=void 0,t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,i)=>{const r=[];for(const t of i.feedbacks){let i=e[t.feedbackId];if(!0===i&&(i={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),i){t.style||(t.style={});for(const[e,a]of Object.entries(i))void 0!==t.options[e]&&(t.style[a]=t.options[e],delete t.options[e],r.push(t))}}return{updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:r}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,i)=>{const r=[];for(const t of i.feedbacks){const i=e[t.feedbackId];if("string"!=typeof i)continue;const a=t.options[i];void 0!==a&&(delete t.options[i],t.isInverted="true"===a||!0===Boolean(a)||Number(a)>0,r.push(t))}return{updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:r}}},t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:[]})},9852:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__assign:()=>o,__asyncDelegator:()=>v,__asyncGenerator:()=>S,__asyncValues:()=>P,__await:()=>y,__awaiter:()=>c,__classPrivateFieldGet:()=>w,__classPrivateFieldSet:()=>E,__createBinding:()=>p,__decorate:()=>s,__exportStar:()=>m,__extends:()=>a,__generator:()=>d,__importDefault:()=>k,__importStar:()=>C,__makeTemplateObject:()=>I,__metadata:()=>u,__param:()=>l,__read:()=>f,__rest:()=>n,__spread:()=>g,__spreadArrays:()=>h,__values:()=>b});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},r(e,t)};function a(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var o=function(){return o=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},o.apply(this,arguments)};function n(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(i[r[a]]=e[r[a]])}return i}function s(e,t,i,r){var a,o=arguments.length,n=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(n=(o<3?a(n):o>3?a(t,i,n):a(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n}function l(e,t){return function(i,r){t(i,r,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,i,r){return new(i||(i=Promise))(function(a,o){function n(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,s)}l((r=r.apply(e,t||[])).next())})}function d(e,t){var i,r,a,o,n={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return n.label++,{value:o[1],done:!1};case 5:n.label++,r=o[1],o=[0];continue;case 7:o=n.ops.pop(),n.trys.pop();continue;default:if(!((a=(a=n.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){n=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){n.label=o[1];break}if(6===o[0]&&n.label<a[1]){n.label=a[1],a=o;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(o);break}a[2]&&n.ops.pop(),n.trys.pop();continue}o=t.call(e,n)}catch(e){o=[6,e],r=0}finally{i=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function p(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}function m(e,t){for(var i in e)"default"===i||t.hasOwnProperty(i)||(t[i]=e[i])}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,a,o=i.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)n.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(a)throw a.error}}return n}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function h(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<i;t++)for(var o=arguments[t],n=0,s=o.length;n<s;n++,a++)r[a]=o[n];return r}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function S(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=i.apply(e,t||[]),o=[];return r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r;function n(e){a[e]&&(r[e]=function(t){return new Promise(function(i,r){o.push([e,t,i,r])>1||s(e,t)})})}function s(e,t){try{(i=a[e](t)).value instanceof y?Promise.resolve(i.value.v).then(l,u):c(o[0][2],i)}catch(e){c(o[0][3],e)}var i}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function v(e){var t,i;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,a){t[r]=e[r]?function(t){return(i=!i)?{value:y(e[r](t)),done:"return"===r}:a?a(t):t}:a}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=b(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise(function(r,a){!function(e,t,i,r){Promise.resolve(r).then(function(t){e({value:t,done:i})},t)}(r,a,(t=e[i](t)).done,t.value)})}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function k(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function E(e,t,i){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,i),i}},9896:e=>{"use strict";e.exports=require("fs")},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i){let r=0,a=e.length;for(;a>0;){const o=a/2|0;let n=r+o;i(e[n],t)<=0?(r=++n,a-=o+1):a=o}return r}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(2622),t=__webpack_require__(6278),i=__webpack_require__(9115);const r=[e.Enums.AudioChannelPair.Channel1_2,e.Enums.AudioChannelPair.Channel3_4,e.Enums.AudioChannelPair.Channel5_6,e.Enums.AudioChannelPair.Channel7_8,e.Enums.AudioChannelPair.Channel9_10,e.Enums.AudioChannelPair.Channel11_12,e.Enums.AudioChannelPair.Channel13_14,e.Enums.AudioChannelPair.Channel15_16],a={inputId:0,sourceName:"No Audio",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},o={inputId:1001,sourceName:"XLR",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},n={inputId:1201,sourceName:"RCA",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},s={inputId:1301,sourceName:"Microphone",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},l={inputId:1401,sourceName:"TRS",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},u={inputId:2301,sourceName:"Program",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},c={inputId:2201,sourceName:"Monitor",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},d={inputId:2501,sourceName:"Control",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},p={inputId:2601,sourceName:"Studio",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},m={inputId:2701,sourceName:"Headphones",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},b={outputId:3001,outputName:"MV",channelPairs:r},f={outputId:4001,outputName:"Program",channelPairs:r},g={outputId:5001,outputName:"Return",channelPairs:r};function h(t,i){const r=[];for(let a=1;a<=t;a++)r.push({inputId:a,sourceName:`Input ${a} 1/2`,channelPairs:i?[e.Enums.AudioChannelPair.Channel1_2,e.Enums.AudioChannelPair.Channel3_4,e.Enums.AudioChannelPair.Channel13_14,e.Enums.AudioChannelPair.Channel15_16]:[e.Enums.AudioChannelPair.Channel1_2,e.Enums.AudioChannelPair.Channel3_4]});return r}function y(t){const i=[];for(let r=1;r<=t;r++)i.push({inputId:1500+r,sourceName:`MADI ${r}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return i}function S(t){const i=[];for(let r=1;r<=t;r++)i.push({inputId:2e3+r,sourceName:`Media Player ${r}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return i}function v(t,i){const r=[{inputId:2101,sourceName:"Production Talkback",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},{inputId:2102,sourceName:"Engineering Talkback",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]}];return t&&r.push({inputId:2103,sourceName:"External Talkback",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]}),i&&r.push({inputId:2104,sourceName:"Talkback",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]}),r}function P(t){const i=[];for(let r=1;r<=t;r++)i.push({inputId:2800+r,sourceName:`Mix Minus ${r}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return i}function I(e,t){return(e<<16)+t}function C(t){const i=[];for(let r=1;r<=t;r++)i.push({outputId:1e3+r,outputName:`MADI ${r}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return i}function k(e){const t=[];for(let i=1;i<=e;i++)t.push({outputId:2e3+i,outputName:`Aux ${i}`,channelPairs:r});return t}const w=[{id:0,label:"Box 1"},{id:1,label:"Box 2"},{id:2,label:"Box 3"},{id:3,label:"Box 4"}],E=[{id:0,label:"None"},{id:1,label:"InOut"},{id:2,label:"In"},{id:3,label:"Out"}],x=[{id:"true",label:"On"},{id:"false",label:"Off"},{id:"toggle",label:"Toggle"}];var _;!function(e){e.NoChange="no-change",e.Include="include",e.Omit="omit",e.Toggle="toggle"}(_||(_={}));const A=[{id:_.NoChange,label:"No change"},{id:_.Include,label:"Include"},{id:_.Omit,label:"Omit"},{id:_.Toggle,label:"Toggle"}];var T;!function(e){e.NoChange="no-change",e.On="on",e.Off="off",e.Toggle="toggle",e.Include="include",e.Omit="omit"}(T||(T={}));const M=[{id:T.NoChange,label:"No change"},{id:T.On,label:"On"},{id:T.Off,label:"Off"},{id:T.Toggle,label:"Toggle"},{id:T.Include,label:"Include"},{id:T.Omit,label:"Omit"}],N=[{id:"true",label:"On Air"},{id:"false",label:"Off"},{id:"toggle",label:"Toggle"}],O=[{id:e.Enums.FlyKeyKeyFrame.A,label:"A"},{id:e.Enums.FlyKeyKeyFrame.B,label:"B"},{id:e.Enums.FlyKeyKeyFrame.Full,label:"Full"}],R=[{id:e.Enums.FlyKeyKeyFrame.A,label:"A"},{id:e.Enums.FlyKeyKeyFrame.B,label:"B"}],$=[{id:e.Enums.IsAtKeyFrame.A,label:"A"},{id:e.Enums.IsAtKeyFrame.B,label:"B"},{id:e.Enums.IsAtKeyFrame.RunToInfinite,label:"Full / Infinite"}],D=[{id:e.Enums.FlyKeyDirection.CentreOfKey,label:"Centre of key"},{id:e.Enums.FlyKeyDirection.TopLeft,label:"Top left"},{id:e.Enums.FlyKeyDirection.TopCentre,label:"Top centre"},{id:e.Enums.FlyKeyDirection.TopRight,label:"Top right"},{id:e.Enums.FlyKeyDirection.MiddleLeft,label:"Middle left"},{id:e.Enums.FlyKeyDirection.MiddleCentre,label:"Middle centre"},{id:e.Enums.FlyKeyDirection.MiddleRight,label:"Middle right"},{id:e.Enums.FlyKeyDirection.BottomLeft,label:"Bottom left"},{id:e.Enums.FlyKeyDirection.BottomCentre,label:"Bottom centre"},{id:e.Enums.FlyKeyDirection.BottomRight,label:"Bottom right"}],V=[{id:e.Enums.AudioMixOption.On,label:"On"},{id:e.Enums.AudioMixOption.Off,label:"Off"},{id:e.Enums.AudioMixOption.AudioFollowVideo,label:"AFV"}],F=[{id:e.Enums.FairlightAudioMixOption.On,label:"On"},{id:e.Enums.FairlightAudioMixOption.Off,label:"Off"},{id:e.Enums.FairlightAudioMixOption.AudioFollowVideo,label:"AFV"}];function B(t){const i=[{id:e.Enums.TransitionStyle.MIX,label:"Mix"},{id:e.Enums.TransitionStyle.DIP,label:"Dip"},{id:e.Enums.TransitionStyle.WIPE,label:"Wipe"},{id:e.Enums.TransitionStyle.DVE,label:"DVE"}];return t||i.push({id:e.Enums.TransitionStyle.STING,label:"Sting"}),i}function L(){return[{id:e.Enums.MixEffectKeyType.Luma,label:"Luma"},{id:e.Enums.MixEffectKeyType.Chroma,label:"Chroma"},{id:e.Enums.MixEffectKeyType.Pattern,label:"Pattern"},{id:e.Enums.MixEffectKeyType.DVE,label:"DVE"}]}function j(e){return re(e.MEs,e=>({id:e,label:`M/E ${e+1}`}))}function K(e){return e.outputs.map(e=>({id:e.id,label:e.name}))}function U(e){return re(e.USKs,e=>({id:e,label:`${e+1}`}))}function G(e){return re(e.DSKs,e=>({id:e,label:`${e+1}`}))}function z(e){return re(e.MVs,e=>({id:e,label:`MV ${e+1}`}))}function W(e,t){return re(e.macros,e=>{const i=t.macro.macroProperties[e];return{id:e+1,label:(i?.isUsed?`${i.name} (#${e+1})`:void 0)||`Macro ${e+1}`}})}function H(e){return re(e.media.players,e=>({id:e,label:`Media Player ${e+1}`}))}function q(t,i,r){const a=(e,t,r,a)=>{const o=i.inputs[e];return{id:e,shortName:o?.shortName||r,longName:o?.longName||a,portType:t}},o=[];for(const i of t.inputs){switch(r){case void 0:break;case"me":if(i.meAvailability===e.Enums.MeAvailability.None)continue;break;case"aux":if(0===(i.sourceAvailability&e.Enums.SourceAvailability.Auxiliary))continue;break;case"mv":if(0===(i.sourceAvailability&e.Enums.SourceAvailability.Multiviewer))continue;break;case"key":if(0===(i.sourceAvailability&e.Enums.SourceAvailability.KeySource))continue;break;case"ssrc-box":if(0===(i.sourceAvailability&e.Enums.SourceAvailability.SuperSourceBox))continue;break;case"ssrc-art":if(0===(i.sourceAvailability&e.Enums.SourceAvailability.SuperSourceArt))continue;break;case"tally":if(i.portType===e.Enums.InternalPortType.MEOutput&&i.id>8e3)break;continue;default:ee()}switch(i.portType){case e.Enums.InternalPortType.External:o.push(a(i.id,i.portType,`In ${i.id}`,`Input ${i.id}`));break;case e.Enums.InternalPortType.ColorBars:o.push(a(i.id,i.portType,"Bars","Bars"));break;case e.Enums.InternalPortType.ColorGenerator:{const e=i.id-2e3;o.push(a(i.id,i.portType,`Col${e}`,`Color ${e}`));break}case e.Enums.InternalPortType.MediaPlayerFill:{const e=(i.id-3e3)/10;o.push(a(i.id,i.portType,`MP ${e}`,`Media Player ${e}`));break}case e.Enums.InternalPortType.MediaPlayerKey:{const e=(i.id-3e3-1)/10;o.push(a(i.id,i.portType,`MP${e}K`,`Media Player ${e} Key`));break}case e.Enums.InternalPortType.SuperSource:{const e=i.id-6e3+1;o.push(a(i.id,i.portType,`SSc${e}`,`Super Source ${e}`));break}case e.Enums.InternalPortType.ExternalDirect:{const e=i.id-11e3;o.push(a(i.id,i.portType,`In${e}D`,`Input ${e} - Direct`));break}case e.Enums.InternalPortType.MEOutput:if(i.id<8e3){const e=i.id-7e3;o.push(a(i.id,i.portType,`Cln${e}`,`Clean Feed ${e}`))}else if(i.id%2==1){const e=(i.id-1e4-1)/10;o.push(a(i.id,i.portType,`M${e}PV`,`ME ${e} Preview`))}else{const e=(i.id-1e4)/10;o.push(a(i.id,i.portType,`M${e}PG`,`ME ${e} Program`))}break;case e.Enums.InternalPortType.Auxiliary:{const e=i.id-8e3;o.push(a(i.id,i.portType,`Aux${e}`,`Auxiliary ${e}`));break}case e.Enums.InternalPortType.Mask:break;case e.Enums.InternalPortType.MultiViewer:{const e=i.id-9e3;o.push(a(i.id,i.portType,`MV ${e}`,`MultiView ${e}`));break}case e.Enums.InternalPortType.Black:o.push(a(i.id,i.portType,"Blk","Black"));break;default:ee(i.portType)}}return o.sort((e,t)=>e.id-t.id),o}function J(e){return e.map(e=>({id:e.id,label:e.longName}))}const Y={[i.AudioChannelPair.Channel1_2]:"1/2",[i.AudioChannelPair.Channel3_4]:"3/4",[i.AudioChannelPair.Channel5_6]:"5/6",[i.AudioChannelPair.Channel7_8]:"7/8",[i.AudioChannelPair.Channel9_10]:"9/10",[i.AudioChannelPair.Channel11_12]:"11/12",[i.AudioChannelPair.Channel13_14]:"13/14",[i.AudioChannelPair.Channel15_16]:"15/16"};function X(e,t){const i=[],r=t.fairlight?.audioRouting?.outputs??{};for(const t of e.fairlightAudio?.audioRouting?.outputs??[])for(const e of t.channelPairs){const a=I(t.outputId,e);i.push({id:a,label:Q(t.outputName,r[a]?.name,e,t.channelPairs)})}return i}function Q(t,i,r,a){let o=i??t;return 1===a.length&&r===e.Enums.AudioChannelPair.Channel1_2||(o=`${o} ${Y[r]}`),i&&t&&(o=`${i} (${t})`),o}const Z=1e3;function ee(e){}function te(e,t,i){for(;e.length<i;)e=t+e;return e}function ie(e){return e.filter(e=>void 0!==e)}function re(e,t){const i=[];for(let r=0;r<e;r++)i.push(t(r));return i}function ae(e,t,i){return Math.min(Math.max(i,e),t)}function oe(t,i){if(!i||!Array.isArray(i))return[];const r=[];i.includes("background")&&r.push(e.Enums.TransitionSelection.Background);for(let e=0;e<t;e++)i.includes(`key${e}`)&&r.push(1<<e+1);return r}var ne;function se(e,t,i){const r=Number(e);if(isNaN(r))return!1;switch(t){case ne.GreaterThan:return i>r;case ne.GreaterThanEqual:return i>=r;case ne.LessThan:return i<r;case ne.LessThanEqual:return i<=r;case ne.NotEqual:return i!=r;default:return i===r}}function le(t,i){if(i<1e4||i>11e3)return[];const r=(i-i%10-1e4)/10-1,a=(i-1e4)%10==0?"program":"preview";return t.video.mixEffects[r]?(0,e.listVisibleInputs)(a,t,r):[]}function ue(e){const t=Math.floor(e>>16),i=255&e,r=Y[i]?.replace("/","_");return`${t}-${r}`}!function(e){e.Equal="eq",e.NotEqual="ne",e.LessThan="lt",e.LessThanEqual="lte",e.GreaterThan="gt",e.GreaterThanEqual="gte"}(ne||(ne={}));const ce=/(\d+)-([\d]+_[\d]+)/i;function de(t){if(!(t=t.trim()))return null;const i=ce.exec(t);if(i){const e=Number(i[1]),t=i[2]?.replace("_","/"),r=Object.entries(Y).find(([,e])=>e===t);if(!r)return null;const a=Number(r[0]);return isNaN(e)||isNaN(a)?null:I(e,a)}const r=Number(t);return isNaN(r)?null:I(r,e.Enums.AudioChannelPair.Channel1_2)}class pe{meTransitionSelection=new Map}class me{executeFunction;maxBatch;delayStep;inflight;constructor(e,t){this.executeFunction=e,this.maxBatch=t.maxBatch,this.delayStep=t.delayStep,this.inflight={completion:void 0,timer:void 0,batched:0,nextValue:void 0}}queueChange(e,t){this.inflight.batched++,!this.inflight.completion&&this.inflight.batched<=this.maxBatch&&this.updateBatchDelayedTimer(),this.inflight.nextValue=t(this.inflight.nextValue??e)}updateBatchDelayedTimer(){this.inflight.timer&&clearTimeout(this.inflight.timer),this.inflight.timer=setTimeout(()=>{this.inflight.timer=void 0,!this.inflight.completion&&void 0!==this.inflight.nextValue&&this.inflight.batched>0&&(this.inflight.timer=void 0,this.inflight.batched=0,this.inflight.completion=this.executeFunction(this.inflight.nextValue).then(()=>this.inflightCompleted()))},this.delayStep)}inflightCompleted(){this.inflight.completion=void 0,this.inflight.timer&&(clearTimeout(this.inflight.timer),this.inflight.timer=void 0),0===this.inflight.batched||void 0===this.inflight.nextValue?(this.inflight.batched=0,this.inflight.nextValue=void 0):this.inflight.batched>=this.maxBatch?(this.inflight.batched=0,this.inflight.completion=this.executeFunction(this.inflight.nextValue).then(()=>this.inflightCompleted())):this.updateBatchDelayedTimer()}}function be(e,t){const i=[];for(let r=0;r<t;r++)i.push({id:r,name:`${e} ${r+1}`});return i}const fe={id:0,label:"Auto Detect",outputs:be("Aux/Output",3),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:0,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:[{id:0,portType:e.Enums.InternalPortType.Black,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:1,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:2,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:4,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:5,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:6,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:1e3,portType:e.Enums.InternalPortType.ColorBars,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:2001,portType:e.Enums.InternalPortType.ColorGenerator,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:2002,portType:e.Enums.InternalPortType.ColorGenerator,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3010,portType:e.Enums.InternalPortType.MediaPlayerFill,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3011,portType:e.Enums.InternalPortType.MediaPlayerKey,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3020,portType:e.Enums.InternalPortType.MediaPlayerFill,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3021,portType:e.Enums.InternalPortType.MediaPlayerKey,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:7001,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:7002,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:10010,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:10011,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None}]};class ge{#k;#se=[];#le;#ue;constructor(t){this.#k=t,this.#le=he(this.#k.meCount),this.#ue=e.Enums.SourceAvailability.KeySource|this.#k.baseSourceAvailability}static begin(e){return new ge(e)}addInternalColorsAndBlack(t=!1){let i=this.#ue;return t&&(i&=~e.Enums.SourceAvailability.Auxiliary),this.#se.push({id:0,portType:e.Enums.InternalPortType.Black,sourceAvailability:i,meAvailability:this.#le},{id:1e3,portType:e.Enums.InternalPortType.ColorBars,sourceAvailability:i,meAvailability:this.#le},{id:2001,portType:e.Enums.InternalPortType.ColorGenerator,sourceAvailability:i&~e.Enums.SourceAvailability.KeySource,meAvailability:this.#le},{id:2002,portType:e.Enums.InternalPortType.ColorGenerator,sourceAvailability:i&~e.Enums.SourceAvailability.KeySource,meAvailability:this.#le}),this}addExternalInputs(t,i=0){return this.addInputs(1,t,e.Enums.InternalPortType.External,i|this.#ue,this.#le)}addMediaPlayers(t,i=!1){let r=this.#ue;i&&(r&=~e.Enums.SourceAvailability.Auxiliary);for(let i=1;i<=t;i++)this.#se.push({id:3e3+10*i,portType:e.Enums.InternalPortType.MediaPlayerFill,sourceAvailability:r,meAvailability:this.#le},{id:3001+10*i,portType:e.Enums.InternalPortType.MediaPlayerKey,sourceAvailability:r,meAvailability:this.#le});return this}addUpstreamKeyMasks(t){for(let i=1;i<=t;i++)this.#se.push({id:4e3+10*i,portType:e.Enums.InternalPortType.Mask,sourceAvailability:e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.Auxiliary,meAvailability:e.Enums.MeAvailability.None});return this}addDownstreamKeyMasks(t){for(let i=1;i<=t;i++)this.#se.push({id:5e3+10*i,portType:e.Enums.InternalPortType.Mask,sourceAvailability:e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.Auxiliary,meAvailability:e.Enums.MeAvailability.None});return this}addCleanFeeds(t){for(let i=1;i<=t;i++)this.#se.push({id:7e3+i,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:this.#ue&~e.Enums.SourceAvailability.KeySource&~e.Enums.SourceAvailability.SuperSourceArt&~e.Enums.SourceAvailability.SuperSourceBox,meAvailability:e.Enums.MeAvailability.None});return this}addDownstreamKeyMasksAndClean(e){return this.addDownstreamKeyMasks(e).addCleanFeeds(e)}addAuxiliaryOutputs(t){return this.addInputs(8001,t,e.Enums.InternalPortType.Auxiliary,this.#ue&e.Enums.SourceAvailability.Multiviewer,e.Enums.MeAvailability.None)}addSuperSource(t=1){return this.addInputs(6e3,t,e.Enums.InternalPortType.SuperSource,this.#ue&~e.Enums.SourceAvailability.SuperSourceArt,this.#le)}addProgramPreview(){for(let t=1;t<=this.#k.meCount;t++){let i=this.#ue&~e.Enums.SourceAvailability.SuperSourceArt&~e.Enums.SourceAvailability.KeySource;1===t&&(i&=~e.Enums.SourceAvailability.SuperSourceBox);const r=t>1?he(t-1):0;this.#se.push({id:1e4+10*t,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:i,meAvailability:r},{id:10001+10*t,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:i,meAvailability:r})}return this}addMultiviewers(t){return this.addInputs(9001,t,e.Enums.InternalPortType.MultiViewer,this.#ue&(e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Auxiliary1|e.Enums.SourceAvailability.Auxiliary2),e.Enums.MeAvailability.None)}addMultiviewerStatusSources(){return this.#se.push({id:9101,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:9102,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:9103,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None}),this}addDirectInputForAux(t){for(let i=1;i<=t;i++){let t=e.Enums.SourceAvailability.Auxiliary;1===i&&this.#k.baseSourceAvailability&e.Enums.SourceAvailability.Auxiliary1&&(t|=e.Enums.SourceAvailability.Auxiliary1),2===i&&this.#k.baseSourceAvailability&e.Enums.SourceAvailability.Auxiliary2&&(t|=e.Enums.SourceAvailability.Auxiliary2),this.#se.push({id:11e3+i,portType:e.Enums.InternalPortType.ExternalDirect,sourceAvailability:t,meAvailability:e.Enums.MeAvailability.None})}return this}addInputs(e,t,i,r,a){for(let o=e;o<e+t;o++)this.#se.push({id:o,portType:i,sourceAvailability:r,meAvailability:a});return this}generate(){return this.#se.sort((e,t)=>e.id-t.id)}}function he(t){let i=e.Enums.MeAvailability.Me1;return t>1&&(i|=e.Enums.MeAvailability.Me2),t>2&&(i|=e.Enums.MeAvailability.Me3),t>3&&(i|=e.Enums.MeAvailability.Me4),i}const ye={id:e.Enums.Model.TVS,label:"TV Studio",outputs:be("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:0,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(6).addMediaPlayers(2).addCleanFeeds(2).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:1101,portType:e.Enums.ExternalPortType.AESEBU}]}},Se={id:e.Enums.Model.OneME,label:"1 ME Production",outputs:be("Aux",3),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:32,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addCleanFeeds(2).addAuxiliaryOutputs(3).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal}]}},ve={id:e.Enums.Model.TwoME,label:"2 ME Production",outputs:be("Aux",6),MEs:2,USKs:2,DSKs:2,MVs:2,multiviewerFullGrid:!1,DVEs:1,SSrc:1,macros:100,displayClock:0,media:{players:2,stills:32,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:2,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(16).addMediaPlayers(2).addCleanFeeds(2).addAuxiliaryOutputs(6).addSuperSource().addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.SDI},{id:2,portType:e.Enums.ExternalPortType.SDI},{id:3,portType:e.Enums.ExternalPortType.SDI},{id:4,portType:e.Enums.ExternalPortType.SDI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:9,portType:e.Enums.ExternalPortType.SDI},{id:10,portType:e.Enums.ExternalPortType.SDI},{id:11,portType:e.Enums.ExternalPortType.SDI},{id:12,portType:e.Enums.ExternalPortType.SDI},{id:13,portType:e.Enums.ExternalPortType.SDI},{id:14,portType:e.Enums.ExternalPortType.SDI},{id:15,portType:e.Enums.ExternalPortType.SDI},{id:16,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal}]}},Pe={id:e.Enums.Model.PS4K,label:"Production Studio 4K",outputs:be("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:0,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addUpstreamKeyMasks(1).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(1).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1201,portType:e.Enums.ExternalPortType.RCA}]}},Ie={id:e.Enums.Model.TwoME4K,label:"2 ME Production 4K",outputs:be("Aux",6),MEs:2,USKs:2,DSKs:2,MVs:2,multiviewerFullGrid:!1,DVEs:1,SSrc:1,macros:100,displayClock:0,media:{players:2,stills:32,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:2,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(20).addMediaPlayers(2).addUpstreamKeyMasks(4).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(6).addSuperSource().addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.SDI},{id:2,portType:e.Enums.ExternalPortType.SDI},{id:3,portType:e.Enums.ExternalPortType.SDI},{id:4,portType:e.Enums.ExternalPortType.SDI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:9,portType:e.Enums.ExternalPortType.SDI},{id:10,portType:e.Enums.ExternalPortType.SDI},{id:11,portType:e.Enums.ExternalPortType.SDI},{id:12,portType:e.Enums.ExternalPortType.SDI},{id:13,portType:e.Enums.ExternalPortType.SDI},{id:14,portType:e.Enums.ExternalPortType.SDI},{id:15,portType:e.Enums.ExternalPortType.SDI},{id:16,portType:e.Enums.ExternalPortType.SDI},{id:17,portType:e.Enums.ExternalPortType.SDI},{id:18,portType:e.Enums.ExternalPortType.SDI},{id:19,portType:e.Enums.ExternalPortType.SDI},{id:20,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1201,portType:e.Enums.ExternalPortType.RCA},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal}]}},Ce={id:e.Enums.Model.OneME4K,label:"1 ME Production 4K",outputs:be("Aux",3),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:32,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(10).addMediaPlayers(2).addUpstreamKeyMasks(4).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(3).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.SDI},{id:2,portType:e.Enums.ExternalPortType.SDI},{id:3,portType:e.Enums.ExternalPortType.SDI},{id:4,portType:e.Enums.ExternalPortType.SDI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:9,portType:e.Enums.ExternalPortType.SDI},{id:10,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1201,portType:e.Enums.ExternalPortType.RCA},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal}]}},ke={id:e.Enums.Model.TwoMEBS4K,label:"4 ME Broadcast 4K",outputs:be("Aux",6),MEs:4,USKs:4,DSKs:2,MVs:2,multiviewerFullGrid:!1,DVEs:1,SSrc:1,macros:100,displayClock:0,media:{players:4,stills:64,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:4,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(20).addMediaPlayers(4).addUpstreamKeyMasks(16).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(6).addSuperSource().addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.SDI},{id:2,portType:e.Enums.ExternalPortType.SDI},{id:3,portType:e.Enums.ExternalPortType.SDI},{id:4,portType:e.Enums.ExternalPortType.SDI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:9,portType:e.Enums.ExternalPortType.SDI},{id:10,portType:e.Enums.ExternalPortType.SDI},{id:11,portType:e.Enums.ExternalPortType.SDI},{id:12,portType:e.Enums.ExternalPortType.SDI},{id:13,portType:e.Enums.ExternalPortType.SDI},{id:14,portType:e.Enums.ExternalPortType.SDI},{id:15,portType:e.Enums.ExternalPortType.SDI},{id:16,portType:e.Enums.ExternalPortType.SDI},{id:17,portType:e.Enums.ExternalPortType.SDI},{id:18,portType:e.Enums.ExternalPortType.SDI},{id:19,portType:e.Enums.ExternalPortType.SDI},{id:20,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1201,portType:e.Enums.ExternalPortType.RCA},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal},{id:2003,portType:e.Enums.ExternalPortType.Internal},{id:2004,portType:e.Enums.ExternalPortType.Internal}]}},we={id:e.Enums.Model.TVSHD,label:"TV Studio HD",outputs:be("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addUpstreamKeyMasks(1).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(1).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1301,portType:e.Enums.ExternalPortType.TSJack}]}},Ee={id:e.Enums.Model.TVSProHD,label:"TV Studio Pro HD",outputs:be("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addUpstreamKeyMasks(1).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(1).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1301,portType:e.Enums.ExternalPortType.TSJack}]}},xe={id:1001,portType:e.Enums.ExternalPortType.XLR},_e={id:1201,portType:e.Enums.ExternalPortType.RCA},Ae={id:1301,portType:e.Enums.ExternalPortType.TSJack},Te={id:1401,portType:e.Enums.ExternalPortType.TRSJack},Me=[{id:1301,portType:e.Enums.ExternalPortType.TSJack,maxDelay:8},{id:1302,portType:e.Enums.ExternalPortType.TSJack,maxDelay:8}];function Ne(t){return Re(1501,t,e.Enums.ExternalPortType.MADI)}function Oe(t){return Re(2001,t,e.Enums.ExternalPortType.Internal)}function Re(e,t,i){const r=[];for(let a=e;a<e+t;a++)r.push({id:a,portType:i});return r}const $e={id:e.Enums.Model.TVSPro4K,label:"TV Studio Pro 4K",outputs:be("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addUpstreamKeyMasks(1).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(1).addProgramPreview().generate(),fairlightAudio:{monitor:"combined",inputs:[...Re(1,8,e.Enums.ExternalPortType.SDI),xe,Ae,...Oe(2)]}},De={id:e.Enums.Model.Constellation,label:"Constellation 8K (HD/4K Mode)",outputs:be("Output",24),MEs:4,USKs:4,DSKs:4,MVs:4,multiviewerFullGrid:!0,DVEs:4,SSrc:2,macros:100,displayClock:0,media:{players:4,stills:64,clips:4,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:4,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(40).addMediaPlayers(4).addUpstreamKeyMasks(16).addDownstreamKeyMasksAndClean(4).addAuxiliaryOutputs(24).addSuperSource(2).addProgramPreview().generate(),fairlightAudio:{monitor:"split",audioRouting:{sources:[a,...h(40,!0),s,l,...y(32),...S(4),...v(!0,!1),u,...P(24)],outputs:[...C(32),...k(24)]},inputs:[...Re(1,40,e.Enums.ExternalPortType.SDI),Ae,Te,...Ne(32),...Oe(4)]}},Ve={id:e.Enums.Model.Constellation8K,label:"Constellation 8K (8K Mode)",outputs:be("Output",6),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:1,SSrc:1,macros:100,displayClock:0,media:{players:1,stills:24,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(10).addMediaPlayers(1).addUpstreamKeyMasks(4).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(6).addSuperSource().addProgramPreview().generate(),fairlightAudio:{monitor:"split",audioRouting:{sources:[a,...h(10,!0),s,l,...y(32),...S(1),...v(!0,!1),u,...P(6)],outputs:[...C(8),...k(6)]},inputs:[...Re(1,10,e.Enums.ExternalPortType.SDI),Ae,Te,...Ne(32),...Oe(4)]}},Fe={id:e.Enums.Model.Mini,label:"Mini",outputs:[...be("Output",1),{id:1,name:"Webcam (2)"}],MEs:1,USKs:1,DSKs:1,MVs:0,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:1,stills:20,clips:0,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary}).addInternalColorsAndBlack(!0).addExternalInputs(4).addMediaPlayers(1,!0).addAuxiliaryOutputs(1).addProgramPreview().addDirectInputForAux(1).generate(),fairlightAudio:{monitor:null,inputs:[...Re(1,4,e.Enums.ExternalPortType.HDMI),...Me]}},Be={...Fe,id:e.Enums.Model.MiniPro,label:"Mini Pro",MVs:1,streaming:!0,recording:!0,inputs:[...Fe.inputs,{id:9001,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Auxiliary,meAvailability:e.Enums.MeAvailability.None}]},Le={...Be,id:e.Enums.Model.MiniProISO,label:"Mini Pro ISO",recordISO:!0},je={id:e.Enums.Model.MiniExtreme,label:"Mini Extreme",inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt|e.Enums.SourceAvailability.Auxiliary1|e.Enums.SourceAvailability.Auxiliary2}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addSuperSource().addCleanFeeds(1).addAuxiliaryOutputs(2).addProgramPreview().addDirectInputForAux(2).addMultiviewers(1).addMultiviewerStatusSources().generate(),outputs:[...be("Output",2),{id:2,name:"Webcam (3)"}],MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:2,SSrc:1,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!0},streaming:!0,recording:!0,recordISO:!1,fairlightAudio:{monitor:"split",inputs:[...Re(1,8,e.Enums.ExternalPortType.HDMI),...Me]}},Ke={...je,id:e.Enums.Model.MiniExtremeISO,label:"Mini Extreme ISO",recordISO:!0},Ue={id:e.Enums.Model.ConstellationHD1ME,label:"1 M/E Constellation HD",outputs:be("Output",6),MEs:1,USKs:4,DSKs:1,MVs:1,multiviewerFullGrid:!0,DVEs:1,SSrc:0,macros:100,displayClock:1,media:{players:2,stills:20,clips:2,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(10).addMediaPlayers(2).addUpstreamKeyMasks(4).addDownstreamKeyMasks(2).addCleanFeeds(1).addAuxiliaryOutputs(6).addProgramPreview().generate(),fairlightAudio:{monitor:"split",inputs:[...Re(1,10,e.Enums.ExternalPortType.SDI),Ae,Te,...Oe(2)],audioRouting:{sources:[a,...h(10,!1),s,l,...S(2),...v(!1,!1),u,...P(6)],outputs:[...k(6)]}}},Ge={id:e.Enums.Model.ConstellationHD2ME,label:"2 M/E Constellation HD",outputs:be("Output",12),MEs:2,USKs:4,DSKs:2,MVs:2,multiviewerFullGrid:!0,DVEs:1,SSrc:1,macros:100,displayClock:1,media:{players:2,stills:40,clips:2,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:2,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(20).addMediaPlayers(2).addUpstreamKeyMasks(8).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(12).addSuperSource().addProgramPreview().generate(),fairlightAudio:{monitor:"split",inputs:[...Re(1,20,e.Enums.ExternalPortType.SDI),Ae,Te,...Oe(2)],audioRouting:{sources:[a,...h(20,!1),s,l,...S(2),...v(!1,!1),u,...P(12)],outputs:[...k(12)]}}},ze={id:e.Enums.Model.ConstellationHD4ME,label:"4 M/E Constellation HD",outputs:be("Output",24),MEs:4,USKs:4,DSKs:4,MVs:4,multiviewerFullGrid:!0,DVEs:4,SSrc:2,macros:100,displayClock:1,media:{players:4,stills:60,clips:4,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:4,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(40).addMediaPlayers(4).addUpstreamKeyMasks(16).addDownstreamKeyMasksAndClean(4).addAuxiliaryOutputs(24).addSuperSource(2).addProgramPreview().generate(),fairlightAudio:{monitor:"split",inputs:[...Re(1,40,e.Enums.ExternalPortType.SDI),Ae,Te,...Ne(32),...Oe(4)],audioRouting:{sources:[a,...h(40,!1),s,l,...y(32),...S(4),...v(!1,!1),u,...P(24)],outputs:[...C(32),...k(24)]}}},We={id:e.Enums.Model.SDI,label:"SDI",outputs:[...be("Output",2),{id:2,name:"Webcam (3)"}],MEs:1,USKs:1,DSKs:1,MVs:0,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:1,stills:20,clips:0,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary}).addInternalColorsAndBlack(!0).addExternalInputs(4).addMediaPlayers(1,!0).addAuxiliaryOutputs(2).addProgramPreview().addDirectInputForAux(1).generate(),fairlightAudio:{monitor:null,inputs:[...Re(1,4,e.Enums.ExternalPortType.SDI),...Me]}},He={...We,id:e.Enums.Model.SDIProISO,label:"SDI Pro ISO",MVs:1,streaming:!0,recording:!0,recordISO:!0,inputs:[...We.inputs,{id:9001,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Auxiliary,meAvailability:e.Enums.MeAvailability.None}]},qe={id:e.Enums.Model.SDIExtremeISO,label:"SDI Extreme ISO",inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt|e.Enums.SourceAvailability.Auxiliary1|e.Enums.SourceAvailability.Auxiliary2}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addSuperSource().addCleanFeeds(1).addAuxiliaryOutputs(4).addProgramPreview().addDirectInputForAux(2).addMultiviewers(1).addMultiviewerStatusSources().generate(),outputs:[...be("Output",4),{id:4,name:"Webcam (5)"}],MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:2,SSrc:1,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!0},streaming:!0,recording:!0,recordISO:!0,fairlightAudio:{monitor:"split",inputs:[...Re(1,8,e.Enums.ExternalPortType.SDI),...Me]}},Je={id:e.Enums.Model.TelevisionStudioHD8,label:"Television Studio HD8",inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addCleanFeeds(1).addAuxiliaryOutputs(2).addProgramPreview().addSuperSource().addMultiviewers(1).addMultiviewerStatusSources().generate(),outputs:be("Aux",2),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:1,SSrc:1,macros:100,displayClock:1,media:{players:2,stills:20,clips:2,captureStills:!0},streaming:!0,recording:!0,recordISO:!1,fairlightAudio:{monitor:"split",audioRouting:{sources:[a,...h(8,!0),o,n,s,...y(16),...S(2),...v(!0,!0),c,u,d,p,m,...function(){const t=[];for(let i=1;i<=2;i++)t.push({inputId:3e3+i,sourceName:`Aux ${i}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return t}()],outputs:[...C(32),...k(2),f,g]},inputs:[...Re(1,8,e.Enums.ExternalPortType.SDI),xe,_e,Ae,...Ne(16),...Oe(2)]}},Ye={...Je,id:e.Enums.Model.TelevisionStudioHD8ISO,label:"Television Studio HD8 ISO",recordISO:!0},Xe={...Ue,id:28,label:"1 M/E Constellation 4K"},Qe={...Ge,id:29,label:"2 M/E Constellation 4K"},Ze={...ze,id:e.Enums.Model.Constellation4K4ME,label:"4 M/E Constellation 4K",media:{players:4,stills:64,clips:4,captureStills:!0}},et={id:e.Enums.Model.TelevisionStudio4K8,label:"Television Studio 4K8",inputs:ge.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addCleanFeeds(2).addAuxiliaryOutputs(10).addProgramPreview().addSuperSource().addMultiviewers(1).addMultiviewerStatusSources().generate(),outputs:be("Output",10),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:1,SSrc:1,macros:100,displayClock:1,media:{players:2,stills:20,clips:2,captureStills:!0},streaming:!0,recording:!0,recordISO:!1,fairlightAudio:{monitor:"split",audioRouting:{sources:[a,...h(8,!0),o,n,s,...y(16),...S(2),...v(!0,!0),c,u,d,p,m,...P(8)],outputs:[...C(32),...k(10),b,f]},inputs:[...Re(1,8,e.Enums.ExternalPortType.SDI),xe,_e,Ae,...Ne(16),...Oe(2)]}},tt={id:31,label:"4 M/E Constellation 4K Plus",outputs:be("Output",48),MEs:4,USKs:4,DSKs:4,MVs:4,multiviewerFullGrid:!0,DVEs:4,SSrc:2,macros:100,displayClock:1,media:{players:4,stills:64,clips:4,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:ge.begin({meCount:4,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(80).addMediaPlayers(4).addUpstreamKeyMasks(16).addDownstreamKeyMasksAndClean(4).addAuxiliaryOutputs(24).addSuperSource(2).addProgramPreview().generate(),fairlightAudio:{monitor:"split",inputs:[...Re(1,80,e.Enums.ExternalPortType.SDI),Ae,Te,...Ne(64),...Oe(4)],audioRouting:{sources:[a,...h(80,!1),s,l,...y(64),...S(4),...v(!1,!1),u,...P(48)],outputs:[...C(64),...k(48)]}}},it=[fe,ye,Se,ve,Pe,Ce,Ie,ke,we,Ee,$e,De,Ve,Fe,Be,Le,je,Ke,Ue,Ge,ze,We,He,qe,Je,Ye,Xe,Qe,Ze,et,tt],rt=it.map(({id:e,label:t})=>({id:e,label:t}));function at(e){return it.find(t=>t.id===e)}function ot(){return fe}function nt(e){const t=new Map,i=new Map;for(const i of Object.values(e.sources)){const e=t.get(i.audioSourceId);e?e.channelPairs.push(i.audioChannelPair):t.set(i.audioSourceId,{sourceName:"",inputId:i.audioSourceId,channelPairs:[i.audioChannelPair]})}for(const t of Object.values(e.outputs)){const e=i.get(t.audioOutputId);e?e.channelPairs.push(t.audioChannelPair):i.set(t.audioOutputId,{outputName:"",outputId:t.audioOutputId,channelPairs:[t.audioChannelPair]})}return{sources:Array.from(t.values()),outputs:Array.from(i.values())}}var st;rt.sort((e,t)=>0===e.id?-1:0===t.id?1:t.id-e.id),function(e){e[e.Short=0]="Short",e[e.Long=1]="Long"}(st||(st={}));class lt{static None(e){return e}}class ut{static In(e){return e*e}static Out(e){return e*(2-e)}static InOut(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}class ct{static In(e){return e*e*e}static Out(e){return--e*e*e+1}static InOut(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}class dt{static In(e){return e*e*e*e}static Out(e){return 1- --e*e*e*e}static InOut(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}class pt{static In(e){return e*e*e*e*e}static Out(e){return--e*e*e*e*e+1}static InOut(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}class mt{static In(e){return 1-Math.cos(e*Math.PI/2)}static Out(e){return Math.sin(e*Math.PI/2)}static InOut(e){return.5*(1-Math.cos(Math.PI*e))}}class bt{static In(e){return 0===e?0:Math.pow(1024,e-1)}static Out(e){return 1===e?1:1-Math.pow(2,-10*e)}static InOut(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}class ft{static In(e){return 1-Math.sqrt(1-e*e)}static Out(e){return Math.sqrt(1- --e*e)}static InOut(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}class gt{static In(e){let t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))}static Out(e){let t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)}static InOut(e){let t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}}class ht{static In(e){const t=1.70158;return e*e*((t+1)*e-t)}static Out(e){const t=1.70158;return--e*e*((t+1)*e+t)+1}static InOut(e){const t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}class yt{static In(e){return 1-yt.Out(1-e)}static Out(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}static InOut(e){return e<.5?.5*yt.In(2*e):.5*yt.Out(2*e-1)+.5}}class St{transitions;fps;tickInterval;constructor(e){this.transitions=new Map,this.fps=e.fadeFps??10}stopAll(){this.transitions.clear(),this.tickInterval&&(clearInterval(this.tickInterval),delete this.tickInterval)}runTick(){const e=[];for(const[t,i]of this.transitions.entries()){const r=i.steps.shift();void 0!==r&&i.sendFcn(r).catch(e=>{}),0===i.steps.length&&e.push(t)}for(const t of e)this.transitions.delete(t);0===this.transitions.size&&this.stopAll()}async runForFadeOptions(e,t,i,r,a){const o=a.getPlainNumber("fadeDuration"),n=a.getPlainString("fadeAlgorithm"),s=a.getPlainString("fadeCurve");return this.run(e,async([e])=>t(e),[i],[r],o,n,s)}async runForProperties(e,t,i,r,a,o){const n=i.getRaw("transitionRate");if(n&&o){const s=Object.keys(a).filter(e=>r.includes(e)),l=s.map(e=>o[e]),u=s.map(e=>a[e]),c=e=>!e.find(e=>"number"!=typeof e);if(l.length===u.length&&c(l)&&c(u))return this.run(e,async e=>t({...a,...Object.fromEntries(e.map((e,t)=>[s[t],e]))}),l,u,n,i.getRaw("transitionEasing"),i.getRaw("transitionCurve"))}return t(a)}async run(e,t,i,r,a,o,n){const s=1e3/this.fps,l=Math.ceil(a/s);if(l<=1||void 0===i.reduce((e,t)=>void 0===e?e:t))this.transitions.delete(e),await t(r);else{const a=r.map((e,t)=>e-(i[t]??0)),s=[],u=function(e,t){return"linear"==e||null==e||null==t?lt.None:"quadratic"==e&&"ease-in"==t?ut.In:"quadratic"==e&&"ease-out"==t?ut.Out:"quadratic"==e&&"ease-in-out"==t?ut.InOut:"cubic"==e&&"ease-in"==t?ct.In:"cubic"==e&&"ease-out"==t?ct.Out:"cubic"==e&&"ease-in-out"==t?ct.InOut:"quartic"==e&&"ease-in"==t?dt.In:"quartic"==e&&"ease-out"==t?dt.Out:"quartic"==e&&"ease-in-out"==t?dt.InOut:"quintic"==e&&"ease-in"==t?pt.In:"quintic"==e&&"ease-out"==t?pt.Out:"quintic"==e&&"ease-in-out"==t?pt.InOut:"sinusoidal"==e&&"ease-in"==t?mt.In:"sinusoidal"==e&&"ease-out"==t?mt.Out:"sinusoidal"==e&&"ease-in-out"==t?mt.InOut:"exponential"==e&&"ease-in"==t?bt.In:"exponential"==e&&"ease-out"==t?bt.Out:"exponential"==e&&"ease-in-out"==t?bt.InOut:"circular"==e&&"ease-in"==t?ft.In:"circular"==e&&"ease-out"==t?ft.Out:"circular"==e&&"ease-in-out"==t?ft.InOut:"elastic"==e&&"ease-in"==t?gt.In:"elastic"==e&&"ease-out"==t?gt.Out:"elastic"==e&&"ease-in-out"==t?gt.InOut:"back"==e&&"ease-in"==t?ht.In:"back"==e&&"ease-out"==t?ht.Out:"back"==e&&"ease-in-out"==t?ht.InOut:"bounce"==e&&"ease-in"==t?yt.In:"bounce"==e&&"ease-out"==t?yt.Out:"bounce"==e&&"ease-in-out"==t?yt.InOut:lt.None}(o,n);for(let e=1;e<=l;e++){const t=u(e/l);s.push(i.map((e,i)=>void 0===e?r[i]:e+a[i]*t))}this.transitions.set(e,{steps:s,sendFcn:t}),this.tickInterval||(this.tickInterval=setInterval(()=>this.runTick(),1e3/this.fps))}}}var vt=__webpack_require__(994);function Pt(e,t,i){return{id:`input${i||""}`,label:"Input"+(i?` Option ${i}`:""),type:"dropdown",default:1,choices:J(q(e,t,"me"))}}function It(t){return{type:"dropdown",id:"style",label:"Transition Style",default:e.Enums.TransitionStyle.MIX,choices:B(t)}}function Ct(){return{type:"dropdown",id:"style",label:"Key Type",default:e.Enums.MixEffectKeyType.Luma,choices:L()}}function kt(e){return{type:"number",id:"rate",label:e,min:1,max:250,range:!0,default:25}}function wt(e){const t={background:{type:"dropdown",id:"background",label:"Background",choices:A,default:_.NoChange}};for(let i=0;i<e.USKs;i++)t[`key${i}`]={label:`Key ${i+1}`,type:"dropdown",id:`key${i}`,choices:M,default:T.NoChange};return t}function Et(e){const t=[{id:"background",label:"Background"}];for(let i=0;i<e.USKs;i++)t.push({id:`key${i}`,label:`Key ${i+1}`});return{type:"multidropdown",id:"selection",label:"Selection",default:["background"],minSelection:1,choices:t}}function xt(e){const t=[{id:0,label:"Background"}];for(let i=0;i<e.USKs;i++)t.push({id:i+1,label:`Key ${i+1}`});return{label:"Component",type:"dropdown",id:"component",choices:t,default:0}}function _t(e,t){return{id:`mixeffect${t||""}`,label:"M/E"+(t?` Option ${t}`:""),type:"dropdown",default:t>0?t-1:0,choices:j(e)}}function At(e){return{type:"dropdown",label:"Key",id:"key",default:0,choices:G(e)}}function Tt(){const e={maskEnabled:{type:"checkbox",label:"Enabled",id:"maskEnabled",default:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'maskEnabled')"},maskTop:{type:"number",label:"Top",id:"maskTop",default:9,min:-9,step:.01,max:9,isVisibleExpression:"arrayIncludes($(options:properties), 'maskTop')"},maskBottom:{type:"number",label:"Bottom",id:"maskBottom",default:-9,min:-9,step:.01,max:9,isVisibleExpression:"arrayIncludes($(options:properties), 'maskBottom')"},maskLeft:{type:"number",label:"Left",id:"maskLeft",default:-16,min:-16,step:.01,max:16,isVisibleExpression:"arrayIncludes($(options:properties), 'maskLeft')"},maskRight:{type:"number",label:"Right",id:"maskRight",default:16,min:-16,step:.01,max:16,isVisibleExpression:"arrayIncludes($(options:properties), 'maskRight')"}};return{properties:Jt(e),...e}}function Mt(){const e={preMultiply:{type:"checkbox",label:"Enabled",id:"preMultiply",default:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'preMultiply')"},clip:{type:"number",label:"Clip",id:"clip",range:!0,default:100,min:0,step:.1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'clip')"},gain:{type:"number",label:"Gain",id:"gain",range:!0,default:0,min:0,step:.1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'gain')"},invert:{type:"checkbox",label:"Invert key",id:"invert",default:!1,isVisibleExpression:"arrayIncludes($(options:properties), 'invert')"}};return{properties:Jt(e),...e}}function Nt(e){return{type:"dropdown",label:"Key",id:"key",default:0,choices:U(e)}}function Ot(){const e={maskEnabled:{type:"checkbox",label:"Enabled",id:"maskEnabled",default:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'maskEnabled')"},maskTop:{type:"number",label:"Top",id:"maskTop",default:9,min:-9,step:.01,max:9,isVisibleExpression:"arrayIncludes($(options:properties), 'maskTop')"},maskBottom:{type:"number",label:"Bottom",id:"maskBottom",default:-9,min:-9,step:.01,max:9,isVisibleExpression:"arrayIncludes($(options:properties), 'maskBottom')"},maskLeft:{type:"number",label:"Left",id:"maskLeft",default:-16,min:-16,step:.01,max:16,isVisibleExpression:"arrayIncludes($(options:properties), 'maskLeft')"},maskRight:{type:"number",label:"Right",id:"maskRight",default:16,min:-16,step:.01,max:16,isVisibleExpression:"arrayIncludes($(options:properties), 'maskRight')"}};return{properties:Jt(e),...e}}function Rt(){const e={positionX:{type:"number",label:"Position: X",id:"positionX",default:0,min:-1e3,range:!0,step:.01,max:1e3,isVisibleExpression:"arrayIncludes($(options:properties), 'positionX')"},positionY:{type:"number",label:"Position: Y",id:"positionY",default:0,range:!0,min:-1e3,step:.01,max:1e3,isVisibleExpression:"arrayIncludes($(options:properties), 'positionY')"},sizeX:{type:"number",label:"Size: X",id:"sizeX",default:.5,range:!0,min:0,step:.01,max:99.99,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeX')"},sizeY:{type:"number",label:"Size: Y",id:"sizeY",default:.5,range:!0,min:0,step:.01,max:99.99,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeY')"},rotation:{type:"number",label:"Rotation",id:"rotation",range:!0,default:0,min:0,max:360,isVisibleExpression:"arrayIncludes($(options:properties), 'rotation')"},maskEnabled:{type:"checkbox",label:"Mask: Enabled",id:"maskEnabled",default:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'maskEnabled')"},maskTop:{type:"number",label:"Mask: Top",id:"maskTop",default:0,range:!0,min:0,step:.01,max:38,isVisibleExpression:"arrayIncludes($(options:properties), 'maskTop')"},maskBottom:{type:"number",label:"Mask: Bottom",id:"maskBottom",default:0,range:!0,min:0,step:.01,max:38,isVisibleExpression:"arrayIncludes($(options:properties), 'maskBottom')"},maskLeft:{type:"number",label:"Mask: Left",id:"maskLeft",default:0,range:!0,min:0,step:.01,max:52,isVisibleExpression:"arrayIncludes($(options:properties), 'maskLeft')"},maskRight:{type:"number",label:"Mask: Right",id:"maskRight",default:0,range:!0,min:0,step:.01,max:52,isVisibleExpression:"arrayIncludes($(options:properties), 'maskRight')"},shadowEnabled:{type:"checkbox",label:"Shadow: Enabled",id:"shadowEnabled",default:!1,isVisibleExpression:"arrayIncludes($(options:properties), 'shadowEnabled')"},lightSourceDirection:{type:"number",label:"Shadow: Angle",id:"lightSourceDirection",default:36,min:0,range:!0,step:1,max:359,isVisibleExpression:"arrayIncludes($(options:properties), 'lightSourceDirection')"},lightSourceAltitude:{type:"number",label:"Shadow: Altitude",id:"lightSourceAltitude",default:25,min:10,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'lightSourceAltitude')"},borderEnabled:{type:"checkbox",label:"Border: Enabled",id:"borderEnabled",default:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderEnabled')"},borderHue:{type:"number",label:"Border: Hue",id:"borderHue",default:0,min:0,range:!0,step:.1,max:360,isVisibleExpression:"arrayIncludes($(options:properties), 'borderHue')"},borderSaturation:{type:"number",label:"Border: Sat",id:"borderSaturation",default:0,min:0,range:!0,step:.1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderSaturation')"},borderLuma:{type:"number",label:"Border: Lum",id:"borderLuma",default:0,min:0,range:!0,step:.1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderLuma')"},borderBevel:{type:"dropdown",label:"Border: Style",id:"borderBevel",default:0,choices:E},borderOuterWidth:{type:"number",label:"Border: Outer Width",id:"borderOuterWidth",default:0,min:0,range:!0,step:.01,max:16,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOuterWidth')"},borderInnerWidth:{type:"number",label:"Border: Inner Width",id:"borderInnerWidth",default:.2,min:0,range:!0,step:.01,max:16,isVisibleExpression:"arrayIncludes($(options:properties), 'borderInnerWidth')"},borderOuterSoftness:{type:"number",label:"Border: Outer Soften",id:"borderOuterSoftness",default:0,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOuterSoftness')"},borderInnerSoftness:{type:"number",label:"Border: Inner Soften",id:"borderInnerSoftness",default:0,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderInnerSoftness')"},borderOpacity:{type:"number",label:"Border: Opacity",id:"borderOpacity",default:100,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOpacity')"},borderBevelPosition:{type:"number",label:"Border: Bevel Position",id:"borderBevelPosition",default:0,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderBevelPosition')"},borderBevelSoftness:{type:"number",label:"Border: Bevel Soften",id:"borderBevelSoftness",default:0,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderBevelSoftness')"},rate:kt("Rate")};return{properties:Jt(e),...e}}function $t(){const e={positionX:{type:"textinput",label:"Position: X",id:"positionX",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'positionX')"},positionY:{type:"textinput",label:"Position: Y",id:"positionY",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'positionY')"},sizeX:{type:"textinput",label:"Size: X",id:"sizeX",default:"0.5",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeX')"},sizeY:{type:"textinput",label:"Size: Y",id:"sizeY",default:"0.5",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeY')"},rotation:{type:"textinput",label:"Rotation",id:"rotation",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'rotation')"},maskEnabled:{type:"textinput",label:"Mask: Enabled",id:"maskEnabled",default:"true",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'maskEnabled')"},maskTop:{type:"textinput",label:"Mask: Top",id:"maskTop",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'maskTop')"},maskBottom:{type:"textinput",label:"Mask: Bottom",id:"maskBottom",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'maskBottom')"},maskLeft:{type:"textinput",label:"Mask: Left",id:"maskLeft",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'maskLeft')"},maskRight:{type:"textinput",label:"Mask: Right",id:"maskRight",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'maskRight')"},shadowEnabled:{type:"textinput",label:"Shadow: Enabled",id:"shadowEnabled",default:"false",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'shadowEnabled')"},lightSourceDirection:{type:"textinput",label:"Shadow: Angle",id:"lightSourceDirection",default:"36",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'lightSourceDirection')"},lightSourceAltitude:{type:"textinput",label:"Shadow: Altitude",id:"lightSourceAltitude",default:"25",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'lightSourceAltitude')"},borderEnabled:{type:"textinput",label:"Border: Enabled",id:"borderEnabled",default:"true",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderEnabled')"},borderHue:{type:"textinput",label:"Border: Hue",id:"borderHue",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderHue')"},borderSaturation:{type:"textinput",label:"Border: Sat",id:"borderSaturation",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderSaturation')"},borderLuma:{type:"textinput",label:"Border: Lum",id:"borderLuma",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderLuma')"},borderBevel:{type:"textinput",label:"Border: Style",id:"borderBevel",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderStyle')"},borderOuterWidth:{type:"textinput",label:"Border: Outer Width",id:"borderOuterWidth",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOuterWidth')"},borderInnerWidth:{type:"textinput",label:"Border: Inner Width",id:"borderInnerWidth",default:"0.2",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderInnerWidth')"},borderOuterSoftness:{type:"textinput",label:"Border: Outer Soften",id:"borderOuterSoftness",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOuterSoftness')"},borderInnerSoftness:{type:"textinput",label:"Border: Inner Soften",id:"borderInnerSoftness",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderInnerSoftness')"},borderOpacity:{type:"textinput",label:"Border: Opacity",id:"borderOpacity",default:"100",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOpacity')"},borderBevelPosition:{type:"textinput",label:"Border: Bevel Position",id:"borderBevelPosition",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderBevelPosition')"},borderBevelSoftness:{type:"textinput",label:"Border: Bevel Soften",id:"borderBevelSoftness",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'borderBevelSoftness')"},rate:{type:"textinput",id:"rate",label:"Rate",default:"25",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'rate')"}};return{properties:Jt(e),...e}}function Dt(){const e={positionX:{type:"number",label:"Position: X",id:"positionX",default:0,min:-1e3,range:!0,step:.01,max:1e3,isVisibleExpression:"arrayIncludes($(options:properties), 'positionX')"},positionY:{type:"number",label:"Position: Y",id:"positionY",default:0,range:!0,min:-1e3,step:.01,max:1e3,isVisibleExpression:"arrayIncludes($(options:properties), 'positionY')"},sizeX:{type:"number",label:"Size: X",id:"sizeX",default:.5,range:!0,min:0,step:.01,max:99.99,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeX')"},sizeY:{type:"number",label:"Size: Y",id:"sizeY",default:.5,range:!0,min:0,step:.01,max:99.99,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeY')"},rotation:{type:"number",label:"Rotation",id:"rotation",range:!0,default:0,min:0,max:360,isVisibleExpression:"arrayIncludes($(options:properties), 'rotation')"},maskTop:{type:"number",label:"Mask: Top",id:"maskTop",default:0,range:!0,min:0,step:.01,max:38,isVisibleExpression:"arrayIncludes($(options:properties), 'maskTop')"},maskBottom:{type:"number",label:"Mask: Bottom",id:"maskBottom",default:0,range:!0,min:0,step:.01,max:38,isVisibleExpression:"arrayIncludes($(options:properties), 'maskBottom')"},maskLeft:{type:"number",label:"Mask: Left",id:"maskLeft",default:0,range:!0,min:0,step:.01,max:52,isVisibleExpression:"arrayIncludes($(options:properties), 'maskLeft')"},maskRight:{type:"number",label:"Mask: Right",id:"maskRight",default:0,range:!0,min:0,step:.01,max:52,isVisibleExpression:"arrayIncludes($(options:properties), 'maskRight')"},lightSourceDirection:{type:"number",label:"Shadow: Angle",id:"lightSourceDirection",default:36,min:0,range:!0,step:1,max:359,isVisibleExpression:"arrayIncludes($(options:properties), 'lightSourceDirection')"},lightSourceAltitude:{type:"number",label:"Shadow: Altitude",id:"lightSourceAltitude",default:25,min:10,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'lightSourceAltitude')"},borderHue:{type:"number",label:"Border: Hue",id:"borderHue",default:0,min:0,range:!0,step:.1,max:360,isVisibleExpression:"arrayIncludes($(options:properties), 'borderHue')"},borderSaturation:{type:"number",label:"Border: Sat",id:"borderSaturation",default:0,min:0,range:!0,step:.1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderSaturation')"},borderLuma:{type:"number",label:"Border: Lum",id:"borderLuma",default:0,min:0,range:!0,step:.1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderLuma')"},borderOuterWidth:{type:"number",label:"Border: Outer Width",id:"borderOuterWidth",default:0,min:0,range:!0,step:.01,max:16,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOuterWidth')"},borderInnerWidth:{type:"number",label:"Border: Inner Width",id:"borderInnerWidth",default:.2,min:0,range:!0,step:.01,max:16,isVisibleExpression:"arrayIncludes($(options:properties), 'borderInnerWidth')"},borderOuterSoftness:{type:"number",label:"Border: Outer Soften",id:"borderOuterSoftness",default:0,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOuterSoftness')"},borderInnerSoftness:{type:"number",label:"Border: Inner Soften",id:"borderInnerSoftness",default:0,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderInnerSoftness')"},borderOpacity:{type:"number",label:"Border: Opacity",id:"borderOpacity",default:100,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderOpacity')"},borderBevelPosition:{type:"number",label:"Border: Bevel Position",id:"borderBevelPosition",default:0,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderBevelPosition')"},borderBevelSoftness:{type:"number",label:"Border: Bevel Soften",id:"borderBevelSoftness",default:0,min:0,range:!0,step:1,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'borderBevelSoftness')"}};return{properties:Jt(e),...e}}function Vt(e){return{type:"dropdown",id:"aux",label:"Aux/Output",default:0,choices:K(e)}}function Ft(e){return{type:"dropdown",id:"multiViewerId",label:"MV",default:0,choices:z(e)}}function Bt(e,t){return{type:"dropdown",label:"Fill Source",id:"fill",default:1,choices:J(q(e,t,"me"))}}function Lt(e,t){return{type:"dropdown",label:"Key Source",id:"cut",default:0,choices:J(q(e,t,"key"))}}function jt(e,t){return{type:"dropdown",label:"Input",id:"input",default:1,choices:J(q(e,t,"aux"))}}function Kt(){return{type:"dropdown",id:"boxIndex",label:"Box #",default:0,choices:w}}function Ut(e){const t=function(e){return re(e.SSrc,e=>({id:e,label:`Super Source ${e+1}`}))}(e);return t.length>1?{type:"dropdown",id:"ssrcId",label:"Super Source",default:0,choices:t}:void 0}function Gt(t){const i=ie([t?{id:"unchanged",label:"Unchanged"}:void 0,{id:e.Enums.SuperSourceArtOption.Foreground,label:"Foreground"},{id:e.Enums.SuperSourceArtOption.Background,label:"Background"},t?{id:"toggle",label:"Toggle"}:void 0]);return{type:"dropdown",id:"artOption",label:"Place in",default:i[0].id,choices:i}}function zt(e,t){const i={size:{type:"number",id:"size",label:"Size",min:0,max:1,range:!0,default:.5,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'size')"},onair:{id:"onair",type:"dropdown",label:"On Air",default:"true",choices:N,isVisibleExpression:"arrayIncludes($(options:properties), 'onair')"},source:{type:"dropdown",id:"source",label:"Source",default:0,choices:J(q(e,t,"ssrc-box")),isVisibleExpression:"arrayIncludes($(options:properties), 'source')"},x:{type:"number",id:"x",label:"X",min:-48,max:48,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'x')"},y:{type:"number",id:"y",label:"Y",min:-27,max:27,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'y')"},cropEnable:{type:"checkbox",id:"cropEnable",label:"Crop Enable",default:!1,isVisibleExpression:"arrayIncludes($(options:properties), 'cropEnable')"},cropTop:{type:"number",id:"cropTop",label:"Crop Top",min:0,max:18,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'cropTop')"},cropBottom:{type:"number",id:"cropBottom",label:"Crop Bottom",min:0,max:18,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'cropBottom')"},cropLeft:{type:"number",id:"cropLeft",label:"Crop Left",min:0,max:32,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'cropLeft')"},cropRight:{type:"number",id:"cropRight",label:"Crop Right",min:0,max:32,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'cropRight')"}};return{properties:Jt(i),...i}}function Wt(){const e={size:{type:"number",id:"size",label:"Size",min:-1,max:1,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'size')"},x:{type:"number",id:"x",label:"X",min:-48,max:48,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'x')"},y:{type:"number",id:"y",label:"Y",min:-27,max:27,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'y')"},cropTop:{type:"number",id:"cropTop",label:"Crop Top",min:-18,max:18,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'cropTop')"},cropBottom:{type:"number",id:"cropBottom",label:"Crop Bottom",min:-18,max:18,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'cropBottom')"},cropLeft:{type:"number",id:"cropLeft",label:"Crop Left",min:-32,max:32,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'cropLeft')"},cropRight:{type:"number",id:"cropRight",label:"Crop Right",min:-32,max:32,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'cropRight')"}};return{properties:Jt(e),...e}}function Ht(e,t,i){const r=J(q(e,t,"ssrc-art")),a={fill:{type:"dropdown",id:"fill",label:"Fill Source",default:0,choices:r,isVisibleExpression:"arrayIncludes($(options:properties), 'fill')"},key:{type:"dropdown",id:"key",label:"Key Source",default:0,choices:r,isVisibleExpression:"arrayIncludes($(options:properties), 'key')"},artOption:{...Gt(i),isVisibleExpression:"arrayIncludes($(options:properties), 'artOption')"},artPreMultiplied:{type:"checkbox",id:"artPreMultiplied",label:"Pre-multiplied",default:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'artPreMultiplied')"},artClip:{type:"number",id:"artClip",label:"Clip",min:0,max:100,range:!0,default:50,step:1,isVisibleExpression:"arrayIncludes($(options:properties), 'artClip')"},artGain:{type:"number",id:"artGain",label:"Gain",min:0,max:100,range:!0,default:50,step:1,isVisibleExpression:"arrayIncludes($(options:properties), 'artGain')"},artInvertKey:{type:"checkbox",id:"artInvertKey",label:"Invert Key",default:!1,isVisibleExpression:"arrayIncludes($(options:properties), 'artInvertKey')"}};return{properties:Jt(a),...a}}function qt(){const e={fill:{type:"textinput",id:"fill",label:"Fill Source",default:"1",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'fill')"},key:{type:"textinput",id:"key",label:"Key Source",default:"1",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'key')"}};return{properties:Jt(e),...e}}function Jt(e){return{type:"multidropdown",id:"properties",label:"Properties",minSelection:1,default:Object.values(e).map(e=>e.id),choices:Object.values(e).map(e=>({id:e.id,label:e.label}))}}function Yt(e,t,i,r){return{type:"dropdown",id:i,label:r,default:0,choices:J(q(e,t,"ssrc-art"))}}function Xt(e,t){return{type:"dropdown",id:"source",label:"Source",default:0,choices:J(q(e,t,"ssrc-box"))}}function Qt(e,t){return{type:"dropdown",id:"source",label:"Source",default:0,choices:J(q(e,t,"mv"))}}function Zt(e){return{type:"dropdown",id:"windowIndex",label:"Window #",default:2,choices:e.multiviewerFullGrid?re(16,e=>({id:e,label:`Window ${e+1}`})):re(8,e=>({id:e+2,label:`Window ${e+3}`}))}}function ei(e){return{type:"dropdown",id:"mediaplayer",label:"Media Player",default:0,choices:H(e)}}function ti(e,t,i=!0){return{type:"dropdown",id:"source",label:"Source",default:0,choices:[...i?re(e.media.clips,e=>{const i=t.media.clipPool[e];return{id:e+Z,label:i?.name?`Clip #${e+1}: ${i.name}`:`Clip #${e+1}`}}):[],...re(e.media.stills,e=>{const i=t.media.stillPool[e];return{id:e,label:i?.fileName?`Still #${e+1}: ${i.fileName}`:`Still #${e+1}`}})]}}function ii(t,i,r){const a=J(function(t,i,r){const a=(e,t,r)=>{const a=void 0!==t?i.inputs[t]:void 0;return{id:e,longName:a?.longName||r}},o=[];for(const i of t.classicAudio?.inputs??t.fairlightAudio?.inputs??[])if(("delay"!==r||"maxDelay"in i&&i.maxDelay)&&("routing"===r||!("routingOnly"in i)||!i.routingOnly))switch(i.portType){case e.Enums.ExternalPortType.Unknown:case e.Enums.ExternalPortType.Component:case e.Enums.ExternalPortType.Composite:case e.Enums.ExternalPortType.SVideo:break;case e.Enums.ExternalPortType.SDI:case e.Enums.ExternalPortType.HDMI:o.push(a(i.id,i.id,`Input ${i.id}`));break;case e.Enums.ExternalPortType.XLR:o.push(a(i.id,void 0,"XLR"));break;case e.Enums.ExternalPortType.AESEBU:o.push(a(i.id,void 0,"AES/EBU"));break;case e.Enums.ExternalPortType.RCA:o.push(a(i.id,void 0,"RCA"));break;case e.Enums.ExternalPortType.Internal:{const e=i.id-2e3;o.push(a(i.id,3e3+10*e,`Media Player ${e}`));break}case e.Enums.ExternalPortType.TSJack:{const e=i.id-1300;o.push(a(i.id,void 0,`Mic ${e}`));break}case e.Enums.ExternalPortType.MADI:{const e=i.id-1500;o.push(a(i.id,void 0,`MADI ${e}`));break}case e.Enums.ExternalPortType.TRSJack:o.push(a(i.id,void 0,"TRS"));break;case e.Enums.ExternalPortType.RJ45:o.push(a(i.id,void 0,"RJ45"));break;default:ee(i.portType)}return o.sort((e,t)=>e.id-t.id),o}(t,i,r));return{type:"dropdown",id:"input",label:"Input",default:a[0]?.id,choices:a}}function ri(){const e=[{id:"-65280",label:"Stereo"},{id:"-256",label:"Mono (Ch1)"},{id:"-255",label:"Mono (Ch2)"}];return{type:"dropdown",id:"source",label:"Source",default:e[0].id,choices:e}}function ai(){const e=[{id:ne.Equal,label:"Equal"},{id:ne.NotEqual,label:"Not Equal"},{id:ne.GreaterThan,label:"Greater than"},{id:ne.GreaterThanEqual,label:"Greater than or equal"},{id:ne.LessThan,label:"Less than"},{id:ne.LessThanEqual,label:"Less than or equal"}];return{type:"dropdown",label:"Comparitor",id:"comparitor",default:ne.Equal,choices:e}}const oi={fadeDuration:{type:"number",label:"Fade Duration (ms)",id:"fadeDuration",default:0,min:0,step:10,max:6e4},fadeAlgorithm:{type:"dropdown",label:"Algorithm",id:"fadeAlgorithm",default:"linear",choices:[{id:"linear",label:"Linear"},{id:"quadratic",label:"Quadratic"},{id:"cubic",label:"Cubic"},{id:"quartic",label:"Quartic"},{id:"quintic",label:"Quintic"},{id:"sinusoidal",label:"Sinusoidal"},{id:"exponential",label:"Exponential"},{id:"circular",label:"Circular"},{id:"elastic",label:"Elastic"},{id:"back",label:"Back"},{id:"bounce",label:"Bounce"}],isVisibleExpression:"$(options:fadeDuration) != null && $(options:fadeDuration) > 0"},fadeCurve:{type:"dropdown",label:"Fade curve",id:"fadeCurve",default:"ease-in",choices:[{id:"ease-in",label:"Ease-in"},{id:"ease-out",label:"Ease-out"},{id:"ease-in-out",label:"Ease-in-out"}],isVisibleExpression:"$(options:fadeDuration) != null && $(options:fadeAlgorithm) != null && $(options:fadeDuration) > 0 && $(options:fadeAlgorithm) != 'linear'"}},ni={type:"number",label:"Delta",id:"delta",default:1,max:100,min:-100};function si(e,t){return{type:"dropdown",id:"source",label:"Source",default:0,choices:J(q(e,t))}}function li(){const t={enabled:{type:"checkbox",id:"enabled",label:"Display",default:!1,isVisibleExpression:"arrayIncludes($(options:properties), 'enabled')"},size:{type:"number",id:"size",label:"Size",min:0,max:1,range:!0,default:.5,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'size')"},opacity:{type:"number",id:"opacity",label:"Opacity",min:0,max:1,range:!0,default:1,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'opacity')"},x:{type:"number",id:"x",label:"X",min:-16,max:16,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'x')"},y:{type:"number",id:"y",label:"Y",min:-9,max:9,range:!0,default:0,step:.01,isVisibleExpression:"arrayIncludes($(options:properties), 'y')"},autoHide:{type:"checkbox",id:"autoHide",label:"Auto Hide",default:!1,isVisibleExpression:"arrayIncludes($(options:properties), 'autoHide')"},clockMode:{id:"clockMode",label:"Mode",type:"dropdown",default:e.Enums.DisplayClockClockMode.Countdown,choices:[{id:e.Enums.DisplayClockClockMode.Countdown,label:"Count down"},{id:e.Enums.DisplayClockClockMode.Countup,label:"Count up"},{id:e.Enums.DisplayClockClockMode.TimeOfDay,label:"Time of Day"}],isVisibleExpression:"arrayIncludes($(options:properties), 'clockMode')"}};return{properties:Jt(t),...t}}function ui(e,t){const i=function(e,t){const i=[],r=t.fairlight?.audioRouting?.sources??{};for(const t of e.fairlightAudio?.audioRouting?.sources??[])for(const e of t.channelPairs){const a=I(t.inputId,e);i.push({id:a,label:Q(t.sourceName,r[a]?.name,e,t.channelPairs)})}return i}(e,t);return{type:"dropdown",id:"source",label:"Source",default:i[0].id,choices:i}}function ci(e,t){const i=X(e,t);return{type:"multidropdown",id:"destinations",label:"Destinations",default:[i[0].id],choices:i}}function di(e,t){const i=X(e,t);return{type:"dropdown",id:"destination",label:"Destination",default:i[0].id,choices:i}}function pi(){const t={style:{type:"dropdown",label:"Style: ",id:"style",default:e.Enums.Pattern.LeftToRightBar,choices:[{id:e.Enums.Pattern.LeftToRightBar,label:"Left To Right Bar"},{id:e.Enums.Pattern.TopToBottomBar,label:"Top To Bottom Bar"},{id:e.Enums.Pattern.HorizontalBarnDoor,label:"Horizontal Barn Door"},{id:e.Enums.Pattern.VerticalBarnDoor,label:"Vertical Barn Door"},{id:e.Enums.Pattern.CornersInFourBox,label:"Corners In Four Box"},{id:e.Enums.Pattern.RectangleIris,label:"Rectangle Iris"},{id:e.Enums.Pattern.DiamondIris,label:"Diamond Iris"},{id:e.Enums.Pattern.CircleIris,label:"Circle Iris"},{id:e.Enums.Pattern.TopLeftBox,label:"Top Left Box"},{id:e.Enums.Pattern.TopRightBox,label:"Top Right Box"},{id:e.Enums.Pattern.BottomRightBox,label:"Bottom Right Box"},{id:e.Enums.Pattern.BottomLeftBox,label:"Bottom Left Box"},{id:e.Enums.Pattern.TopCentreBox,label:"Top Centre Box"},{id:e.Enums.Pattern.RightCentreBox,label:"Right Centre Box"},{id:e.Enums.Pattern.BottomCentreBox,label:"Bottom Centre Box"},{id:e.Enums.Pattern.LeftCentreBox,label:"Left Centre Box"},{id:e.Enums.Pattern.TopLeftDiagonal,label:"Top Left Diagonal"},{id:e.Enums.Pattern.TopRightDiagonal,label:"Top Right Diagonal"}],isVisibleExpression:"arrayIncludes($(options:properties), 'style')"},invert:{type:"checkbox",label:"Invert Pattern",id:"invert",default:!1,isVisibleExpression:"arrayIncludes($(options:properties), 'invert')"},size:{type:"number",label:"Size",id:"size",default:50,range:!0,min:0,step:.01,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'size')"},symmetry:{type:"number",label:"Symmetry",id:"symmetry",default:81.6,range:!0,min:0,step:.01,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'symmetry')"},softness:{type:"number",label:"Softness",id:"softness",default:50,range:!0,min:0,step:.01,max:100,isVisibleExpression:"arrayIncludes($(options:properties), 'softness')"},positionX:{type:"number",label:"Position: X",id:"positionX",default:.5,min:0,range:!0,step:.01,max:1,isVisibleExpression:"arrayIncludes($(options:properties), 'positionX')"},positionY:{type:"number",label:"Position: Y",id:"positionY",default:.5,range:!0,min:0,step:.01,max:1,isVisibleExpression:"arrayIncludes($(options:properties), 'positionY')"}};return{properties:Jt(t),...t}}function mi(){const e={style:{type:"textinput",label:"Style: ",id:"style",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'style')"},invert:{type:"textinput",label:"Invert Pattern",id:"invert",default:"false",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'invert')"},size:{type:"textinput",label:"Size",id:"size",default:"50",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'size')"},symmetry:{type:"textinput",label:"Symmetry",id:"symmetry",default:"81.6",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'symmetry')"},softness:{type:"textinput",label:"Softness",id:"softness",default:"50",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'softness')"},positionX:{type:"textinput",label:"Position: X",id:"positionX",default:"0.5",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'positionX')"},positionY:{type:"textinput",label:"Position: Y",id:"positionY",default:"0.5",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'positionY')"}};return{properties:Jt(e),...e}}function bi(){const e={flyEnabled:{type:"checkbox",label:"Enabled",id:"flyEnabled",default:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'flyEnabled')"},positionX:{type:"number",label:"Position X",id:"positionX",default:0,min:-32,step:.01,max:32,isVisibleExpression:"arrayIncludes($(options:properties), 'positionX')"},positionY:{type:"number",label:"Position Y",id:"positionY",default:0,min:-18,step:.01,max:18,isVisibleExpression:"arrayIncludes($(options:properties), 'positionY')"},sizeX:{type:"number",label:"Size X",id:"sizeX",default:1,min:0,step:.01,max:99.99,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeX')"},sizeY:{type:"number",label:"Size Y",id:"sizeY",default:1,min:0,step:.01,max:99.99,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeY')"}};return{properties:Jt(e),...e}}function fi(){const e={flyEnabled:{type:"textinput",label:"Enabled",id:"flyEnabled",default:"true",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'flyEnabled')"},positionX:{type:"textinput",label:"Position X",id:"positionX",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'positionX')"},positionY:{type:"textinput",label:"Position Y",id:"positionY",default:"0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'positionY')"},sizeX:{type:"textinput",label:"Size X",id:"sizeX",default:"1.0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeX')"},sizeY:{type:"textinput",label:"Size Y",id:"sizeY",default:"1.0",useVariables:!0,isVisibleExpression:"arrayIncludes($(options:properties), 'sizeY')"}};return{properties:Jt(e),...e}}var gi;function hi(e,t,i,r){return{[gi.Program]:{name:"ME: Set Program input",options:{mixeffect:_t(t,0),input:Pt(t,r.state,0)},callback:async({options:t})=>{await(e?.changeProgramInput(t.getPlainNumber("input"),t.getPlainNumber("mixeffect")))},learn:({options:e})=>{const t=(0,vt.YM)(r.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),input:t.programInput}:void 0}},[gi.ProgramVariables]:{name:"ME: Set Program input from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},callback:async({options:t})=>{const i=await t.getParsedNumber("mixeffect"),r=await t.getParsedNumber("input");isNaN(i)||isNaN(r)||await(e?.changeProgramInput(r,i-1))}},[gi.Preview]:{name:"ME: Set Preview input",options:{mixeffect:_t(t,0),input:Pt(t,r.state,0)},callback:async({options:t})=>{await(e?.changePreviewInput(t.getPlainNumber("input"),t.getPlainNumber("mixeffect")))},learn:({options:e})=>{const t=(0,vt.YM)(r.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),input:t.previewInput}:void 0}},[gi.PreviewVariables]:{name:"ME: Set Preview input from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},callback:async({options:t})=>{const i=await t.getParsedNumber("mixeffect"),r=await t.getParsedNumber("input");isNaN(i)||isNaN(r)||await(e?.changePreviewInput(r,i-1))}},[gi.Cut]:{name:"ME: Perform CUT transition",options:{mixeffect:_t(t,0)},callback:async({options:t})=>{await(e?.cut(t.getPlainNumber("mixeffect")))}},[gi.Auto]:{name:"ME: Perform AUTO transition",options:{mixeffect:_t(t,0)},callback:async({options:t})=>{await(e?.autoTransition(t.getPlainNumber("mixeffect")))}},[gi.TBar]:{name:"ME: Set TBar position",options:{mixeffect:_t(t,0),position:{type:"textinput",id:"position",label:"Position (0 - 100)",default:"0",useVariables:!0},...oi},callback:async({options:t})=>{const a=await t.getParsedNumber("position");if(isNaN(a))return;const o=t.getPlainNumber("mixeffect"),n=(0,vt.YM)(r.state,o);await i.runForFadeOptions(`me.${o}.tbar`,async t=>{await(e?.setTransitionPosition(t,o))},n?.transitionPosition.handlePosition,100*a,t)}}}}!function(e){e.Program="program",e.ProgramVariables="programVariables",e.Preview="preview",e.PreviewVariables="previewVariables",e.Cut="cut",e.Auto="auto",e.TBar="tBar",e.Aux="aux",e.AuxVariables="auxVariables",e.USKType="uskType",e.USKSource="uskSource",e.USKSourceVariables="uskSourceVariables",e.USKOnAir="usk",e.USKFly="uskFly",e.USKMaskLumaChromaPattern="uskMaskLumaChromaPattern",e.USKFlyKeyLumaChromaPattern="uskFlyKeyLumaChromaPattern",e.USKFlyKeyLumaChromaPatternVariables="uskFlyKeyLumaChromaPatternVariables",e.USKDVEProperties="uskDveProperties",e.USKDVEPropertiesVariables="uskDvePropertiesVariables",e.USKPatternProperties="uskPatternProperties",e.USKPatternPropertiesVariables="uskPatternPropertiesVariables",e.USKSetKeyframe="uskSetKeyframe",e.USKStoreKeyframe="uskStoreKeyframe",e.USKFlyInfinite="uskFlyInfinite",e.DSKSource="dskSource",e.DSKSourceVariables="dskSourceVariables",e.DSKRate="dskRate",e.DSKMask="dskMask",e.DSKPreMultipliedKey="dskPreMultipliedKey",e.DSKOnAir="dsk",e.DSKTie="dskTie",e.DSKAuto="dskAuto",e.MacroRun="macrorun",e.MacroContinue="macrocontinue",e.MacroStop="macrostop",e.MacroLoop="macroloop",e.MultiviewerWindowSource="setMvSource",e.MultiviewerWindowSourceVariables="setMvSourceVariables",e.MultiviewerLayout="multiviewerLayout",e.SuperSourceArt="ssrcArt",e.SuperSourceArtVariables="ssrcArtVariables",e.SuperSourceBoxSource="setSsrcBoxSource",e.SuperSourceBoxSourceVaraibles="setSsrcBoxSourceVariables",e.SuperSourceBoxOnAir="setSsrcBoxEnable",e.SuperSourceBoxProperties="setSsrcBoxProperties",e.SuperSourceBoxPropertiesDelta="setSsrcBoxPropertiesDelta",e.PreviewTransition="previewTransition",e.TransitionStyle="transitionStyle",e.TransitionSelection="transitionSelection",e.TransitionSelectionComponent="transitionSelectionComponent",e.TransitionSelectComponents="transitionSelectComponents",e.TransitionRate="transitionRate",e.MediaPlayerSource="mediaPlayerSource",e.MediaPlayerSourceVariables="mediaPlayerSourceVariables2",e.MediaPlayerCycle="mediaPlayerCycle",e.MediaCaptureStill="mediaCaptureStill",e.MediaDeleteStill="mediaDeleteStill",e.FadeToBlackAuto="fadeToBlackAuto",e.FadeToBlackRate="fadeToBlackRate",e.StreamStartStop="streamStartStop",e.StreamService="streamService",e.RecordStartStop="recordStartStop",e.RecordSwitchDisk="recordSwitchDisk",e.RecordFilename="recordFilename",e.RecordISO="recordISO",e.ClassicAudioGain="classicAudioGain",e.ClassicAudioGainDelta="classicAudioGainDelta",e.ClassicAudioMixOption="classicAudioMixOption",e.ClassicAudioResetPeaks="classicAudioResetPeaks",e.ClassicAudioMasterGain="classicAudioMasterGain",e.ClassicAudioMasterGainDelta="classicAudioMasterGainDelta",e.ClassicAudioMasterPan="classicAudioMasterPan",e.ClassicAudioMasterPanDelta="classicAudioMasterPanDelta",e.FairlightAudioFaderGain="fairlightAudioFaderGain",e.FairlightAudioFaderGainDelta="fairlightAudioFaderGainDelta",e.FairlightAudioInputGain="fairlightAudioInputGain",e.FairlightAudioInputGainDelta="fairlightAudioInputGainDelta",e.FairlightAudioInputDelay="fairlightAudioInputDelay",e.FairlightAudioInputDelayDelta="fairlightAudioInputDelayDelta",e.FairlightAudioMixOption="fairlightAudioMixOption",e.FairlightAudioResetPeaks="fairlightAudioResetPeaks",e.FairlightAudioResetSourcePeaks="fairlightAudioResetSourcePeaks",e.FairlightAudioMasterGain="fairlightAudioMasterGain",e.FairlightAudioMasterGainDelta="fairlightAudioMasterGainDelta",e.FairlightAudioMonitorSolo="fairlightAudioMonitorSolo",e.FairlightAudioMonitorOutputGain="fairlightAudioMonitorGain",e.FairlightAudioMonitorOutputGainDelta="fairlightAudioMonitorGainDelta",e.FairlightAudioMonitorMasterMuted="fairlightAudioMonitorMasterMuted",e.FairlightAudioMonitorMasterGain="fairlightAudioMonitorMasterGain",e.FairlightAudioMonitorMasterGainDelta="fairlightAudioMonitorMasterGainDelta",e.FairlightAudioMonitorTalkbackMuted="fairlightAudioMonitorTalkbackMuted",e.FairlightAudioMonitorTalkbackGain="fairlightAudioMonitorTalkbackGain",e.FairlightAudioMonitorTalkbackGainDelta="fairlightAudioMonitorTalkbackGainDelta",e.FairlightAudioMonitorSidetoneGain="fairlightAudioMonitorSidetoneGain",e.FairlightAudioMonitorSidetoneGainDelta="fairlightAudioMonitorSidetoneGainDelta",e.FairlightAudioRouting="fairlightAudioRouting",e.FairlightAudioRoutingVariables="fairlightAudioRoutingVariables",e.SaveStartupState="saveStartupState",e.ClearStartupState="clearStartupState",e.InputName="inputName",e.DisplayClockState="displayClockState",e.DisplayClockConfigure="displayClockConfigure",e.DisplayClockStartTime="displayClockStartTime",e.DisplayClockOffsetStartTime="displayClockOffsetStartTime",e.Timecode="timecode",e.TimecodeMode="timecodeMode",e.CameraControlLensFocus="cameraControlLensFocus",e.CameraControlLensAutoFocus="cameraControlLensAutoFocus",e.CameraControlLensIris="cameraControlLensIris",e.CameraControlIncrementLensIris="cameraControlIncrementLensIris",e.CameraControlLensAutoIris="cameraControlLensAutoIris",e.CameraControlLensOpticalImageStabilisation="cameraControlLensOpticalImageStabilisation",e.CameraControlLensZoom="cameraControlLensZoom",e.CameraControlVideoManualWhiteBalance="cameraControlVideoManualWhiteBalance",e.CameraControlVideoIncrementManualWhiteBalance="cameraControlVideoIncrementManualWhiteBalance",e.CameraControlVideoAutoWhiteBalance="cameraControlVideoAutoWhiteBalance",e.CameraControlVideoExposure="cameraControlVideoExposure",e.CameraControlIncrementVideoExposure="cameraControlIncrementVideoExposure",e.CameraControlVideoSharpeningLevel="cameraControlVideoSharpeningLevel",e.CameraControlVideoGain="cameraControlVideoGain",e.CameraControlIncrementVideoGain="cameraControlIncrementVideoGain",e.CameraControlVideoNdFilterStop="cameraControlVideoNdFilterStop",e.CameraControlDisplayColorBars="cameraControlDisplayColorBars",e.CameraControlMediaRecordSingle="cameraControlMediaRecordSingle",e.CameraControlMediaRecordMultiple="cameraControlMediaRecordMultiple",e.CameraControlColorLiftAdjust="cameraControlColorLiftAdjust",e.CameraControlColorGammaAdjust="cameraControlColorGammaAdjust",e.CameraControlColorGainAdjust="cameraControlColorGainAdjust",e.CameraControlColorOffsetAdjust="cameraControlColorOffsetAdjust",e.CameraControlColorContrastAdjust="cameraControlColorContrastAdjust",e.CameraControlColorLumaMix="cameraControlColorLumaMix",e.CameraControlColorHueSaturationAdjust="cameraControlColorHueSaturationAdjust"}(gi||(gi={}));class yi{#k;#ce;#de;constructor(e,t,i){this.#k=e,this.#ce=t,this.#de=i}getJson(){return{...this.#k}}getRaw(e){return this.#k[e]}getPlainString(e){const t=this.#de[e],i=t&&"default"in t?t.default:void 0,r=this.#k[e];return String(void 0!==i&&void 0===r?i:r)}getPlainNumber(e){const t=this.#de[e],i=t&&"default"in t?t.default:void 0,r=this.#k[e];if(void 0!==i&&void 0===r)return Number(i);const a=Number(r);if(isNaN(a))throw new Error(`Invalid option '${String(e)}'`);return a}getPlainBoolean(e){const t=this.#de[e],i=t&&"default"in t?t.default:void 0,r=this.#k[e];return void 0!==i&&void 0===r?Boolean(i):Boolean(r)}async getParsedString(e){const t=this.#k[e];return this.#ce.parseVariablesInString(t)}async getParsedNumber(e){const t=await this.getParsedString(e);return Number(t)}async getParsedBoolean(e){const t=await this.getParsedString(e);return"false"!=t.toLowerCase()&&0!=Number(t)}}function Si(e,t,i){return{id:e.id,controlId:e.controlId,actionId:e.actionId,options:new yi(e.options,t,i)}}function vi(e){const{subscribe:t,unsubscribe:i,learn:r}=e;return{name:e.name,description:e.description,options:Object.entries(e.options).filter(e=>!!e[1]).map(([e,t])=>({...t,id:e})),optionsToIgnoreForSubscribe:e.optionsToIgnoreForSubscribe,skipUnsubscribeOnOptionsChange:e.skipUnsubscribeOnOptionsChange,callback:async(t,i)=>e.callback({...Si(t,i,e.options),surfaceId:t.surfaceId},i),subscribe:t?async(i,r)=>t(Si(i,r,e.options),r):void 0,unsubscribe:i?async(t,r)=>i(Si(t,r,e.options),r):void 0,learn:r?async(t,i)=>r({...Si(t,i,e.options),surfaceId:t.surfaceId},i):void 0,learnTimeout:void 0}}require("node:module");const Pi=require("node:path"),Ii=require("node:fs"),Ci=require("node:child_process"),ki=require,wi=__dirname;function Ei(e){const t=[(0,Pi.join)(wi,e),(0,Pi.join)(wi,"prebuilds",e)];for(const e of t)if((0,Ii.existsSync)(e))return ki(e);throw new Error(`No candidate found. Tried: \n${t.join("\n")}`)}const xi=()=>{let e=!1;return"linux"===process.platform&&(e=Ai(),null===e&&(e=Ti()),null===e&&(e=Mi())),e},_i=e=>e.includes("libc.musl-")||e.includes("ld-musl-"),Ai=()=>{try{return(0,Ii.readFileSync)("/usr/bin/ldd","utf-8").includes("musl")}catch{return null}},Ti=()=>{let e=null;return"function"==typeof process.report?.getReport&&(process.report.excludeNetwork=!0,e=process.report.getReport()),e?!(e.header&&e.header.glibcVersionRuntime||!Array.isArray(e.sharedObjects)||!e.sharedObjects.some(_i)):null},Mi=()=>{try{return(0,Ci.execSync)("ldd --version",{encoding:"utf8"}).includes("musl")}catch(e){return!1}};let Ni=null;const Oi=[];if(Ni=function(){if(process.env.NAPI_RS_NATIVE_LIBRARY_PATH)try{Ni=ki(process.env.NAPI_RS_NATIVE_LIBRARY_PATH)}catch(e){Oi.push(e)}else if("android"===process.platform)if("arm64"===process.arch)try{return Ei("julusian-image-rs.android-arm64.node")}catch(e){Oi.push(e)}else if("arm"===process.arch)try{return Ei("julusian-image-rs.android-arm-eabi.node")}catch(e){Oi.push(e)}else Oi.push(new Error(`Unsupported architecture on Android ${process.arch}`));else if("win32"===process.platform)if("x64"===process.arch)try{return Ei("julusian-image-rs.win32-x64-msvc.node")}catch(e){Oi.push(e)}else if("ia32"===process.arch)try{return Ei("julusian-image-rs.win32-ia32-msvc.node")}catch(e){Oi.push(e)}else if("arm64"===process.arch)try{return Ei("julusian-image-rs.win32-arm64-msvc.node")}catch(e){Oi.push(e)}else Oi.push(new Error(`Unsupported architecture on Windows: ${process.arch}`));else if("darwin"===process.platform)if("x64"===process.arch)try{return Ei("julusian-image-rs.darwin-x64.node")}catch(e){Oi.push(e)}else if("arm64"===process.arch)try{return Ei("julusian-image-rs.darwin-arm64.node")}catch(e){Oi.push(e)}else Oi.push(new Error(`Unsupported architecture on macOS: ${process.arch}`));else if("freebsd"===process.platform)if("x64"===process.arch)try{return Ei("julusian-image-rs.freebsd-x64.node")}catch(e){Oi.push(e)}else if("arm64"===process.arch)try{return Ei("julusian-image-rs.freebsd-arm64.node")}catch(e){Oi.push(e)}else Oi.push(new Error(`Unsupported architecture on FreeBSD: ${process.arch}`));else if("linux"===process.platform)if("x64"===process.arch)if(xi())try{return Ei("julusian-image-rs.linux-x64-musl.node")}catch(e){Oi.push(e)}else try{return Ei("julusian-image-rs.linux-x64-gnu.node")}catch(e){Oi.push(e)}else if("arm64"===process.arch)if(xi())try{return Ei("julusian-image-rs.linux-arm64-musl.node")}catch(e){Oi.push(e)}else try{return Ei("julusian-image-rs.linux-arm64-gnu.node")}catch(e){Oi.push(e)}else if("arm"===process.arch)if(xi())try{return Ei("julusian-image-rs.linux-arm-musleabihf.node")}catch(e){Oi.push(e)}else try{return Ei("julusian-image-rs.linux-arm-gnueabihf.node")}catch(e){Oi.push(e)}else if("riscv64"===process.arch)if(xi())try{return Ei("julusian-image-rs.linux-riscv64-musl.node")}catch(e){Oi.push(e)}else try{return Ei("julusian-image-rs.linux-riscv64-gnu.node")}catch(e){Oi.push(e)}else if("ppc64"===process.arch)try{return Ei("julusian-image-rs.linux-ppc64-gnu.node")}catch(e){Oi.push(e)}else if("s390x"===process.arch)try{return Ei("julusian-image-rs.linux-s390x-gnu.node")}catch(e){Oi.push(e)}else Oi.push(new Error(`Unsupported architecture on Linux: ${process.arch}`));else Oi.push(new Error(`Unsupported OS: ${process.platform}, architecture: ${process.arch}`))}(),!Ni){if(Oi.length>0)throw new Error("Cannot find native binding.",{cause:Oi});throw new Error("Failed to load native binding")}const{ImageTransformer:Ri,ImageFormat:$i,PixelFormat:Di,ResizeMode:Vi,RotationMode:Fi}=Ni,Bi=Ri;class Li{#pe=new Map;#me=new Map;#be;#fe;#ge;constructor(e,t,i){this.#ge=e.media,this.#be=t,this.#fe=i}subscribe(e,t){const i=this.#he(e);let r=this.#me.get(i);r||(r={source:e,subs:new Set},this.#me.set(i,r)),r.subs.add(t),this.ensureLoaded(e)}unsubscribe(e){for(const t of this.#me.values())t.subs.delete(e)}checkUpdatedState(e){this.#ge=e.media;for(const e of this.#me.values())e.subs.size>0&&this.ensureLoaded(e.source,!0);for(const[e,t]of this.#pe)(this.#me.get(e)?.subs?.size??0)>0||this.#ye(t)&&this.#pe.delete(e)}isSlotOccupied(e){const t=this.#Se(e);return!!t?.isUsed}ensureLoaded(e,t=!1){const i=this.#he(e),r=this.#pe.get(i),a=this.#Se(e);if(r&&!this.#ye(r)||!a?.isUsed){if(r&&this.#ye(r)&&(this.#pe.delete(i),t)){const e=this.#me.get(i);e&&e.subs.size>0&&this.#fe(Array.from(e.subs))}}else this.#ve(e,r,a)}async getPreviewImage(e,i){const r=this.#he(e),a=this.#pe.get(r);if(!a||a.isLoading||!a.rawImage)return null;const o=function(e){let t=`${e.buttonWidth}-${e.buttonHeight}-${e.crop}`;return"none"!==e.crop&&(t+=`-${e.position}`),t}(i);let n=a.scaledImages.get(o);if(!n){let e=Bi.fromBuffer(a.rawImage.buffer,a.rawImage.width,a.rawImage.height,"rgba");const r=a.rawImage.height/i.buttonHeight*i.buttonWidth;switch(i.crop){case"none":break;case"center":e=e.cropCenter(r,a.rawImage.height);break;case"left":e=e.crop(0,0,r,a.rawImage.height);break;case"right":e=e.crop(a.rawImage.width-r,0,r,a.rawImage.height);break;default:(0,t.assertNever)(i.crop)}n=e.scale(4*i.buttonWidth,4*i.buttonHeight,"Fit").toBuffer("rgba"),a.scaledImages.set(o,n)}const s=await n,l=s.height/4;let u=Math.floor((i.buttonHeight-l)/2);if("none"===i.crop)switch(i.position){case"top":u=0;break;case"bottom":u=i.buttonHeight-l;break;case"center":break;default:(0,t.assertNever)(i.position)}return{imageBuffer:s.buffer,imageBufferEncoding:{pixelFormat:"RGBA"},imageBufferPosition:{x:0,y:u,width:s.width,height:s.height,drawScale:1/4}}}#ve(e,t,i){if(t&&t.isLoading)return;t={source:e,loadedHash:i.hash,loadedFilename:i.fileName,isLoading:!0,isStale:!1,rawImage:void 0,scaledImages:new Map};const r=this.#he(e);this.#pe.set(r,t),this.#be(e).then(async e=>{console.log("got image",e.buffer.length);const i=this.#pe.get(r);i&&i===t&&(i.rawImage=e,i.isLoading=!1)}).catch(e=>{const i=this.#pe.get(r);i&&i===t&&(this.#pe.delete(r),console.log("failed image",e))}).finally(()=>{const e=this.#me.get(r);e&&e.subs.size>0&&this.#fe(Array.from(e.subs.keys()))})}#Se(e){if(e.isClip){const t=this.#ge.clipPool[e.slot];if(!t||t.frameCount<1||e.frameIndex<0||e.frameIndex>=t.frameCount)return;const i=t.frames?.[e.frameIndex];return i||{fileName:`${t.name}-${e.frameIndex}`,hash:`fake-${e.frameIndex}`,isUsed:!0}}return this.#ge.stillPool[e.slot]}#ye(e){if(e.isStale)return!0;const t=this.#Se(e.source);return!t||t.fileName!==e.loadedFilename||t.hash!==e.loadedHash}#he(e){return e.isClip?`clip-${e.slot}-${e.frameIndex}`:`still-${e.slot}`}}function ji(e,t){return e.video.mixEffects[Number(t)]}function Ki(e,t){const i=ji(e,t);return i?i.transitionProperties:void 0}function Ui(e,t,i){const r=ji(e,t);return r?r.upstreamKeyers[Number(i)]:void 0}function Gi(e,t){return e.video.downstreamKeyers[Number(t)]}function zi(e,t,i){const r=e.video.superSources[Number(i??0)];return r?r.boxes[Number(t)]:void 0}function Wi(e,t){return e.settings.multiViewers[Number(t)]}function Hi(e,t,i){const r=Wi(e,t);return r?r.windows[Number(i)]:void 0}function qi(t,i,r,a,o){return{[gi.PreviewTransition]:{name:"Transition: Preview",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:x}},callback:async({options:e})=>{const t=await e.getParsedNumber("mixeffect");let r;r="toggle"===e.getPlainString("state")?!(0,vt.YM)(o.state,t-1).transitionPreview:"true"===e.getPlainString("state"),console.log("previewTransition",r,t),isNaN(t)||await(i?.previewTransition(r,t-1))}},[gi.TransitionStyle]:{name:"Transition: Set style/pattern",options:{mixeffect:_t(r,0),style:It(0===r.media.clips)},callback:async({options:e})=>{await(i?.setTransitionStyle({nextStyle:e.getPlainNumber("style")},e.getPlainNumber("mixeffect")))},learn:({options:e})=>{const t=(0,vt.YM)(o.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),style:t.transitionProperties.nextStyle}:void 0}},[gi.TransitionRate]:{name:"Transition: Change rate",options:{mixeffect:_t(r,0),style:It(!0),rate:kt("Transition Rate")},callback:async({options:r})=>{const a=r.getPlainNumber("style");switch(a){case e.Enums.TransitionStyle.MIX:await(i?.setMixTransitionSettings({rate:r.getPlainNumber("rate")},r.getPlainNumber("mixeffect")));break;case e.Enums.TransitionStyle.DIP:await(i?.setDipTransitionSettings({rate:r.getPlainNumber("rate")},r.getPlainNumber("mixeffect")));break;case e.Enums.TransitionStyle.WIPE:await(i?.setWipeTransitionSettings({rate:r.getPlainNumber("rate")},r.getPlainNumber("mixeffect")));break;case e.Enums.TransitionStyle.DVE:await(i?.setDVETransitionSettings({rate:r.getPlainNumber("rate")},r.getPlainNumber("mixeffect")));break;case e.Enums.TransitionStyle.STING:break;default:t.log("debug","Unknown transition style: "+a)}},learn:({options:t})=>{const i=(0,vt.YM)(o.state,t.getPlainNumber("mixeffect"));if(i?.transitionSettings){switch(t.getPlainNumber("style")){case e.Enums.TransitionStyle.MIX:if(!i.transitionSettings.mix)return;return{...t.getJson(),rate:i.transitionSettings.mix.rate};case e.Enums.TransitionStyle.DIP:if(!i.transitionSettings.dip)return;return{...t.getJson(),rate:i.transitionSettings.dip.rate};case e.Enums.TransitionStyle.WIPE:if(!i.transitionSettings.wipe)return;return{...t.getJson(),rate:i.transitionSettings.wipe.rate};case e.Enums.TransitionStyle.DVE:if(!i.transitionSettings.DVE)return;return{...t.getJson(),rate:i.transitionSettings.DVE.rate};case e.Enums.TransitionStyle.STING:default:return}}}},[gi.TransitionSelection]:{name:"Transition: Change selection",options:{mixeffect:_t(r,0),selection:Et(r)},callback:async({options:e})=>{await(i?.setTransitionStyle({nextSelection:oe(r.USKs,e.getRaw("selection"))},e.getPlainNumber("mixeffect")))}},[gi.TransitionSelectComponents]:{name:"Transition: Select components in transition",options:{mixeffect:_t(r,0),...wt(r)},callback:async({options:a})=>{const n=a.getPlainNumber("mixeffect"),s=Ki(o.state,n);if(!i||!s)return;const l=s.nextSelection,u=[];{const i=l.includes(e.Enums.TransitionSelection.Background);let r;const o=a.getPlainString("background");switch(o){case _.NoChange:r=i;break;case _.Include:r=!0;break;case _.Omit:r=!1;break;case _.Toggle:r=!i;break;default:t.log("debug","Unknown background mode: "+o),r=i}r&&u.push(e.Enums.TransitionSelection.Background)}for(let e=0;e<r.USKs;e++){const i=Ui(o.state,n,e);if(i){const r=1<<e+1,o=l.includes(r),n=a.getPlainString(`key${e}`);let s;switch(n){case T.NoChange:s=o;break;case T.On:case T.Off:s=i.onAir===(n===T.Off);break;case T.Toggle:s=!o;break;case T.Include:s=!0;break;case T.Omit:s=!1;break;default:ee(),t.log("debug","Unknown mode: "+n),s=o}s&&u.push(r)}}u.length>0&&await i.setTransitionStyle({nextSelection:u},n)},learn:({options:t})=>{const i=t.getPlainNumber("mixeffect"),a=(0,vt.YM)(o.state,i),n=Ki(o.state,i);if(a&&n){const a=n.nextSelection,s=a.includes(e.Enums.TransitionSelection.Background)?_.Include:_.Omit,l={};for(let e=0;e<r.USKs;e++){const t=Ui(o.state,i,e);let r;if(t){const i=1<<e+1,o=a.includes(i);r=t.onAir!=o?T.On:T.Off}else r=T.Omit;l[`key${e}`]=r}return{...t.getJson(),background:s,...l}}}},[gi.TransitionSelectionComponent]:{name:"Transition: Change selection component",options:{mixeffect:_t(r,0),component:xt(r),mode:{type:"dropdown",id:"mode",label:"State",choices:N,default:N[0].id}},callback:async({options:e})=>{const t=e.getPlainNumber("mixeffect"),r=Ki(o.state,t);if(r&&i){let o=a.meTransitionSelection.get(t);o||(o=new me(async e=>i.setTransitionStyle({nextSelection:e},t),{delayStep:100,maxBatch:5}),a.meTransitionSelection.set(t,o));const n=e.getPlainString("mode"),s=1<<e.getPlainNumber("component");o.queueChange(r.nextSelection,e=>{let t=n;return"toggle"===n&&(t=e.includes(s)?"false":"true"),"true"===t?[...e,s]:e.filter(e=>e!==s)})}}}}}function Ji(t,i,r){return i.displayClock?{[gi.DisplayClockState]:{name:"Display Clock: Start/Stop",options:{state:{id:"state",label:"State",type:"dropdown",default:"toggle",choices:[{id:"toggle",label:"Toggle"},{id:e.Enums.DisplayClockClockState.Running,label:"Start"},{id:e.Enums.DisplayClockClockState.Stopped,label:"Stop"},{id:e.Enums.DisplayClockClockState.Reset,label:"Reset"}]}},callback:async({options:i})=>{let a;const o=i.getRaw("state");switch(o){case"toggle":a=r.state.displayClock?.properties?.clockState===e.Enums.DisplayClockClockState.Running?e.Enums.DisplayClockClockState.Stopped:e.Enums.DisplayClockClockState.Running;break;case e.Enums.DisplayClockClockState.Running:case e.Enums.DisplayClockClockState.Stopped:case e.Enums.DisplayClockClockState.Reset:a=o}void 0!==a&&await(t?.setDisplayClockState(a))}},[gi.DisplayClockConfigure]:{name:"Display Clock: Configure",options:{...li()},callback:async({options:e})=>{const i={},r=e.getRaw("properties");r&&Array.isArray(r)&&(r.includes("enabled")&&(i.enabled=e.getPlainBoolean("enabled")),r.includes("size")&&(i.size=100*e.getPlainNumber("size")),r.includes("opacity")&&(i.opacity=100*e.getPlainNumber("opacity")),r.includes("x")&&(i.positionX=1e3*e.getPlainNumber("x")),r.includes("y")&&(i.positionY=1e3*e.getPlainNumber("y")),r.includes("autoHide")&&(i.autoHide=e.getPlainBoolean("autoHide")),r.includes("clockMode")&&(i.clockMode=e.getPlainNumber("clockMode"))),0!==Object.keys(i).length&&await(t?.setDisplayClockProperties(i))},learn:({options:e})=>{const t=r.state.displayClock?.properties;return t?{...e.getJson(),enabled:t.enabled,size:t.size/100,opacity:t.opacity/100,x:t.positionX/1e3,y:t.positionY/1e3,autoHide:t.autoHide,clockMode:t.clockMode}:void 0}},[gi.DisplayClockStartTime]:{name:"Display Clock: Set Start Time",options:{hours:{type:"number",id:"hours",label:"Hours",min:0,max:23,range:!0,default:0,step:1},minutes:{type:"number",id:"minutes",label:"Minutes",min:0,max:59,range:!0,default:0,step:1},seconds:{type:"number",id:"seconds",label:"Seconds",min:0,max:59,range:!0,default:0,step:1}},callback:async({options:e})=>{const i={hours:e.getPlainNumber("hours"),minutes:e.getPlainNumber("minutes"),seconds:e.getPlainNumber("seconds"),frames:0};await(t?.setDisplayClockProperties({startFrom:i}))},learn:({options:e})=>{const t=r.state.displayClock?.properties;return t?{...e.getJson(),hours:t.startFrom.hours,minutes:t.startFrom.minutes,seconds:t.startFrom.seconds}:void 0}},[gi.DisplayClockOffsetStartTime]:{name:"Display Clock: Offset Start Time",options:{hours:{type:"number",id:"hours",label:"Hours",min:-23,max:23,range:!0,default:0,step:1},minutes:{type:"number",id:"minutes",label:"Minutes",min:-59,max:59,range:!0,default:0,step:1},seconds:{type:"number",id:"seconds",label:"Seconds",min:-59,max:59,range:!0,default:0,step:1}},callback:async({options:e})=>{const i=r.state.displayClock?.properties?.startFrom;let a=(i?3600*i.hours+60*i.minutes+i.seconds:0)+(3600*e.getPlainNumber("hours")+60*e.getPlainNumber("minutes")+e.getPlainNumber("seconds"));a%=86400,a<0&&(a+=86400);const o={hours:Math.floor(a/3600),minutes:Math.floor(a%3600/60),seconds:a%60,frames:0};await(t?.setDisplayClockProperties({startFrom:o}))}}}:{[gi.DisplayClockState]:void 0,[gi.DisplayClockConfigure]:void 0,[gi.DisplayClockStartTime]:void 0,[gi.DisplayClockOffsetStartTime]:void 0}}function Yi(e,t,i){return t.macros?{[gi.MacroRun]:{name:"Macro: Run",options:{macro:{type:"dropdown",id:"macro",label:"Macro",default:1,choices:W(t,i.state)},action:{type:"dropdown",id:"action",label:"Action",default:"run",choices:[{id:"run",label:"Run"},{id:"runContinue",label:"Run/Continue"}]}},callback:async({options:t})=>{const r=t.getPlainNumber("macro")-1,{macroPlayer:a,macroRecorder:o}=i.state.macro;"runContinue"===t.getPlainString("action")&&a.isWaiting&&a.macroIndex===r?await(e?.macroContinue()):o.isRecording&&o.macroIndex===r?await(e?.macroStopRecord()):await(e?.macroRun(r))}},[gi.MacroContinue]:{name:"Macro: Continue",options:{},callback:async()=>{await(e?.macroContinue())}},[gi.MacroStop]:{name:"Macro: Stop",options:{},callback:async()=>{await(e?.macroStop())}},[gi.MacroLoop]:{name:"Macro: Loop",options:{loop:{id:"loop",type:"dropdown",label:"Loop",default:"toggle",choices:x}},callback:async({options:t})=>{let r="true"===t.getPlainString("loop");"toggle"===t.getPlainString("loop")&&(r=!i.state.macro.macroPlayer.loop),await(e?.macroSetLoop(r))}}}:{[gi.MacroRun]:void 0,[gi.MacroContinue]:void 0,[gi.MacroStop]:void 0,[gi.MacroLoop]:void 0}}function Xi(t,i,r){return i.streaming?{[gi.StreamStartStop]:{name:"Stream: Start or Stop",options:{stream:{id:"stream",type:"dropdown",label:"Stream",default:"toggle",choices:x}},callback:async({options:i})=>{let a="true"===i.getPlainString("stream");"toggle"===i.getPlainString("stream")&&(a=r.state.streaming?.status?.state===e.Enums.StreamingStatus.Idle),a?await(t?.startStreaming()):await(t?.stopStreaming())},learn:({options:e})=>r.state.streaming?.status?{...e.getJson(),state:r.state.streaming.status.state}:void 0},[gi.StreamService]:{name:"Stream: Set service",options:{service:{id:"service",label:"Service",type:"textinput",default:"",useVariables:!0},url:{id:"url",label:"URL",type:"textinput",default:"",useVariables:!0},key:{id:"key",label:"Key",type:"textinput",default:"",useVariables:!0}},callback:async({options:e})=>{const[i,r,a]=await Promise.all([e.getParsedString("service"),e.getParsedString("url"),e.getParsedString("key")]);await(t?.setStreamingService({serviceName:i,url:r,key:a}))},learn:({options:e})=>r.state.streaming?.service?{...e.getJson(),service:r.state.streaming.service.serviceName,url:r.state.streaming.service.url,key:r.state.streaming.service.key}:void 0}}:{[gi.StreamStartStop]:void 0,[gi.StreamService]:void 0}}function Qi(t,i,r){return i.recording?{[gi.RecordStartStop]:{name:"Recording: Start or Stop",options:{record:{id:"record",type:"dropdown",label:"Record",default:"toggle",choices:x}},callback:async({options:i})=>{let a="true"===i.getPlainString("record");"toggle"===i.getPlainString("record")&&(a=r.state.recording?.status?.state===e.Enums.RecordingStatus.Idle),a?await(t?.startRecording()):await(t?.stopRecording())},learn:({options:e})=>r.state.recording?.status?{...e.getJson(),state:r.state.recording.status.state}:void 0},[gi.RecordSwitchDisk]:{name:"Recording: Switch disk",options:{},callback:async()=>{await(t?.switchRecordingDisk())}},[gi.RecordFilename]:{name:"Recording: Set filename",options:{filename:{id:"filename",label:"Filename",type:"textinput",default:"",useVariables:!0}},callback:async({options:e})=>{const i=await e.getParsedString("filename");await(t?.setRecordingSettings({filename:i}))},learn:({options:e})=>r.state.recording?.properties?{...e.getJson(),filename:r.state.recording?.properties.filename}:void 0},[gi.RecordISO]:{name:"Recording: Enable/Disable ISO",options:{recordISO:{id:"recordISO",type:"dropdown",label:"Record ISO",default:"toggle",choices:x}},callback:async({options:e})=>{let i="true"===e.getPlainString("recordISO");"toggle"===e.getPlainString("recordISO")&&(i=!r.state.recording?.recordAllInputs),await(t?.setEnableISORecording(i))},learn:({options:e})=>null!=r.state.recording?.recordAllInputs?{...e.getJson(),state:r.state.recording.recordAllInputs}:void 0}}:{[gi.RecordStartStop]:void 0,[gi.RecordSwitchDisk]:void 0,[gi.RecordFilename]:void 0,[gi.RecordISO]:void 0}}function Zi(e,t,i){return t.DSKs?{[gi.DSKSource]:{name:"Downstream key: Set inputs",options:{key:At(t),fill:Bt(t,i.state),cut:Lt(t,i.state)},callback:async({options:t})=>{await Promise.all([e?.setDownstreamKeyFillSource(t.getPlainNumber("fill"),t.getPlainNumber("key")),e?.setDownstreamKeyCutSource(t.getPlainNumber("cut"),t.getPlainNumber("key"))])},learn:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return t?.sources?{...e.getJson(),fill:t.sources.fillSource,cut:t.sources.cutSource}:void 0}},[gi.DSKSourceVariables]:{name:"Downstream key: Set inputs from variables",options:{key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},fill:{type:"textinput",id:"fill",label:"Fill Source",default:"0",useVariables:!0},cut:{type:"textinput",id:"cut",label:"Key Source",default:"0",useVariables:!0}},callback:async({options:t})=>{const i=await t.getParsedNumber("key")-1,r=await t.getParsedNumber("fill"),a=await t.getParsedNumber("cut");isNaN(i)||isNaN(r)||isNaN(a)||await Promise.all([e?.setDownstreamKeyFillSource(r,i),e?.setDownstreamKeyCutSource(a,i)])},learn:async({options:e})=>{const t=await e.getParsedNumber("key")-1,r=Gi(i.state,t);return r?.sources?{...e.getJson(),fill:r.sources.fillSource+"",cut:r.sources.cutSource+""}:void 0}},[gi.DSKRate]:{name:"Downstream key: Set Rate",options:{key:At(t),rate:kt("Rate")},callback:async({options:t})=>{await(e?.setDownstreamKeyRate(t.getPlainNumber("rate"),t.getPlainNumber("key")))},learn:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return t?.properties?{...e.getJson(),rate:t.properties.rate}:void 0}},[gi.DSKMask]:{name:"Downstream key: Set Mask",options:{key:At(t),...Tt()},callback:async({options:t})=>{const i=t.getPlainNumber("key"),r={},a=t.getRaw("properties");a&&Array.isArray(a)&&(a.includes("maskEnabled")&&(r.enabled=t.getPlainBoolean("maskEnabled")),a.includes("maskTop")&&(r.top=1e3*t.getPlainNumber("maskTop")),a.includes("maskBottom")&&(r.bottom=1e3*t.getPlainNumber("maskBottom")),a.includes("maskLeft")&&(r.left=1e3*t.getPlainNumber("maskLeft")),a.includes("maskRight")&&(r.right=1e3*t.getPlainNumber("maskRight"))),0!==Object.keys(r).length&&await(e?.setDownstreamKeyMaskSettings(r,i))},learn:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return t?.properties?.mask?{...e.getJson(),maskEnabled:t.properties.mask.enabled,maskTop:t.properties.mask.top/1e3,maskBottom:t.properties.mask.bottom/1e3,maskLeft:t.properties.mask.left/1e3,maskRight:t.properties.mask.right/1e3}:void 0}},[gi.DSKPreMultipliedKey]:{name:"Downstream key: Set Pre Multiplied Key",options:{key:At(t),...Mt()},callback:async({options:t})=>{const i=t.getPlainNumber("key"),r={},a=t.getRaw("properties");a&&Array.isArray(a)&&(a.includes("preMultiply")&&(r.preMultiply=t.getPlainBoolean("preMultiply")),a.includes("clip")&&(r.clip=10*t.getPlainNumber("clip")),a.includes("gain")&&(r.gain=10*t.getPlainNumber("gain")),a.includes("invert")&&(r.invert=t.getPlainBoolean("invert"))),0!==Object.keys(r).length&&await(e?.setDownstreamKeyGeneralProperties(r,i))},learn:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return t?.properties?{...e.getJson(),preMultiply:t.properties.preMultiply,clip:t.properties.clip/10,gain:t.properties.gain/10,invert:t.properties.invert}:void 0}},[gi.DSKAuto]:{name:"Downstream key: Run AUTO Transition",options:{downstreamKeyerId:{type:"dropdown",id:"downstreamKeyerId",label:"DSK",default:0,choices:G(t)}},callback:async({options:t})=>{await(e?.autoDownstreamKey(t.getPlainNumber("downstreamKeyerId")))}},[gi.DSKOnAir]:{name:"Downstream key: Set OnAir",options:{onair:{id:"onair",type:"dropdown",label:"On Air",default:"true",choices:N},key:At(t)},callback:async({options:t})=>{const r=t.getPlainNumber("key");if("toggle"===t.getPlainString("onair")){const t=Gi(i.state,r);await(e?.setDownstreamKeyOnAir(!t?.onAir,r))}else await(e?.setDownstreamKeyOnAir("true"===t.getPlainString("onair"),r))},learn:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return t?{...e.getJson(),onair:t.onAir?"true":"false"}:void 0}},[gi.DSKTie]:{name:"Downstream key: Set Tied",options:{state:{id:"state",type:"dropdown",label:"State",default:"true",choices:x},key:At(t)},callback:async({options:t})=>{const r=t.getPlainNumber("key");if("toggle"===t.getPlainString("state")){const t=Gi(i.state,r);await(e?.setDownstreamKeyTie(!t?.properties?.tie,r))}else await(e?.setDownstreamKeyTie("true"===t.getPlainString("state"),r))},learn:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return t?.properties?{...e.getJson(),state:t.properties.tie?"true":"false"}:void 0}}}:{[gi.DSKSource]:void 0,[gi.DSKSourceVariables]:void 0,[gi.DSKRate]:void 0,[gi.DSKMask]:void 0,[gi.DSKPreMultipliedKey]:void 0,[gi.DSKAuto]:void 0,[gi.DSKOnAir]:void 0,[gi.DSKTie]:void 0}}function er(e,t,i){return 0===t.outputs.length?{[gi.Aux]:void 0,[gi.AuxVariables]:void 0}:{[gi.Aux]:{name:"Aux/Output: Set source",options:{aux:Vt(t),input:jt(t,i.state)},callback:async({options:t})=>{await(e?.setAuxSource(t.getPlainNumber("input"),t.getPlainNumber("aux")))},learn:({options:e})=>{const t=i.state.video.auxilliaries[e.getPlainNumber("aux")];return void 0!==t?{...e.getJson(),input:t}:void 0}},[gi.AuxVariables]:{name:"Aux/Output: Set source from variables",options:{aux:{type:"textinput",id:"aux",label:"AUX",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},callback:async({options:t})=>{const i=await t.getParsedNumber("aux"),r=await t.getParsedNumber("input");isNaN(i)||isNaN(r)||await(e?.setAuxSource(r,i-1))}}}}const tr=[{id:"ignore",label:"Unchanged"},{id:"toggle",label:"Toggle"},{id:"single",label:"Single"},{id:"quad",label:"Quad"}];function ir(i,r,a){return r.MVs?{[gi.MultiviewerWindowSource]:{name:"Multiviewer: Change window source",options:{multiViewerId:Ft(r),windowIndex:Zt(r),source:Qt(r,a.state)},callback:async({options:e})=>{await(i?.setMultiViewerWindowSource(e.getPlainNumber("source"),e.getPlainNumber("multiViewerId"),e.getPlainNumber("windowIndex")))},learn:({options:e})=>{const t=Hi(a.state,e.getPlainNumber("multiViewerId"),e.getPlainNumber("windowIndex"));return t?{...e.getJson(),source:t.source}:void 0}},[gi.MultiviewerWindowSourceVariables]:{name:"Multiviewer: Change window source from variables",options:{multiViewerId:{type:"textinput",id:"multiViewerId",label:"MV",default:"1",useVariables:!0},windowIndex:{type:"textinput",id:"windowIndex",label:"Window #",default:"1",useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"1",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("multiViewerId")-1,r=await e.getParsedNumber("windowIndex")-1,a=await e.getParsedNumber("source");isNaN(t)||isNaN(r)||isNaN(a)||await(i?.setMultiViewerWindowSource(a,t,r))},learn:async({options:e})=>{const t=await e.getParsedNumber("multiViewerId")-1,i=await e.getParsedNumber("windowIndex")-1,r=Hi(a.state,t,i);return r?{...e.getJson(),source:r.source+""}:void 0}},[gi.MultiviewerLayout]:{name:"Multiviewer: Change layout",options:{multiViewerId:{type:"textinput",id:"multiViewerId",label:"MV",default:"1",useVariables:!0},topLeft:{id:"topLeft",type:"dropdown",label:"Top left",choices:tr,default:"ignore"},topRight:{id:"topRight",type:"dropdown",label:"Top right",choices:tr,default:"ignore"},bottomLeft:{id:"bottomLeft",type:"dropdown",label:"Bottom left",choices:tr,default:"ignore"},bottomRight:{id:"bottomRight",type:"dropdown",label:"Bottom right",choices:tr,default:"ignore"}},callback:async({options:r})=>{const o=await r.getParsedNumber("multiViewerId")-1,n=Wi(a.state,o);let s=n?.properties?.layout??e.Enums.MultiViewerLayout.Default;const l=(e,i)=>{switch("toggle"===e&&(e=s&i?"single":"quad"),e){case"ignore":break;case"single":s=~(~s|i);break;case"quad":s|=i;break;default:(0,t.assertNever)(e)}};l(r.getPlainString("topLeft"),e.Enums.MultiViewerLayout.TopLeftSmall),l(r.getPlainString("topRight"),e.Enums.MultiViewerLayout.TopRightSmall),l(r.getPlainString("bottomLeft"),e.Enums.MultiViewerLayout.BottomLeftSmall),l(r.getPlainString("bottomRight"),e.Enums.MultiViewerLayout.BottomRightSmall),isNaN(o)||isNaN(s)||await(i?.setMultiViewerProperties({layout:s},o))},learn:async({options:t})=>{const i=await t.getParsedNumber("multiViewerId")-1,r=Wi(a.state,i);if(r?.properties){const i=r.properties.layout,a=e=>i&e?"quad":"single";return{...t.getJson(),topLeft:a(e.Enums.MultiViewerLayout.TopLeftSmall),topRight:a(e.Enums.MultiViewerLayout.TopRightSmall),bottomLeft:a(e.Enums.MultiViewerLayout.BottomLeftSmall),bottomRight:a(e.Enums.MultiViewerLayout.BottomRightSmall)}}}}}:{[gi.MultiviewerWindowSource]:void 0,[gi.MultiviewerWindowSourceVariables]:void 0,[gi.MultiviewerLayout]:void 0}}function rr(t,i,r){return i.media.players?{[gi.MediaPlayerSource]:{name:"Media player: Set source",options:{mediaplayer:ei(i),source:ti(i,r.state)},callback:async({options:i})=>{const r=i.getPlainNumber("source");r>=Z?await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Clip,clipIndex:r-Z},i.getPlainNumber("mediaplayer"))):await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Still,stillIndex:r},i.getPlainNumber("mediaplayer")))},learn:({options:e})=>{const t=r.state.media.players[e.getPlainNumber("mediaplayer")];return t?{...e.getJson(),source:t.sourceType?t.stillIndex:t.clipIndex+Z}:void 0}},[gi.MediaPlayerSourceVariables]:{name:"Media player: Set source from variables",options:{mediaplayer:{id:"mediaplayer",type:"textinput",label:"Media Player",default:"1",useVariables:!0},isClip:i.media.clips>0?{type:"checkbox",id:"isClip",label:"Is clip",default:!1}:void 0,slot:{id:"slot",type:"textinput",label:"Slot number or item name",default:"1",useVariables:!0}},callback:async({options:a})=>{const[o,n]=await Promise.all([a.getParsedNumber("mediaplayer"),a.getParsedString("slot")]);if(i.media.clips>0&&a.getPlainBoolean("isClip")){let i=Number(n)-1;if(isNaN(i)&&(i=r.state.media.clipPool.findIndex(e=>e?.name==n)),-1==i)return void console.warn(`Media player: Clip "${n}" not found`);await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Clip,clipIndex:i},o-1))}else{let i=Number(n)-1;if(isNaN(i)&&(i=r.state.media.stillPool.findIndex(e=>e?.fileName==n)),-1==i)return void console.warn(`Media player: Still "${n}" not found`);await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Still,stillIndex:i},o-1))}},learn:async({options:t})=>{const i=await t.getParsedNumber("mediaplayer"),a=r.state.media.players[i-1];if(a){const i=a.sourceType===e.Enums.MediaSourceType.Clip;return{...t.getJson(),isClip:i,source:i?a.clipIndex:a.stillIndex}}}},[gi.MediaPlayerCycle]:{name:"Media player: Cycle source",options:{mediaplayer:ei(i),direction:{type:"dropdown",id:"direction",label:"Direction",default:"next",choices:[{id:"next",label:"Next"},{id:"previous",label:"Previous"}]}},callback:async({options:i})=>{const a=i.getPlainNumber("mediaplayer"),o="next"===i.getPlainString("direction")?1:-1,n=(0,vt.O2)(r.state,a);if(n?.sourceType==e.Enums.MediaSourceType.Still){const i=r.state.media.stillPool.length;let s=n.stillIndex+o;s>=i&&(s=0),s<0&&(s=i-1),await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Still,stillIndex:s},a))}}},[gi.MediaCaptureStill]:{name:"Media player: Capture still",options:{},callback:async()=>{await(t?.captureMediaPoolStill())}},[gi.MediaDeleteStill]:{name:"Media player: Delete still",options:{slot:{id:"slot",type:"textinput",label:"Slot",default:"1",useVariables:!0}},callback:async({options:e})=>{const i=await e.getParsedNumber("slot");await(t?.clearMediaPoolStill(i-1))}}}:{[gi.MediaPlayerSource]:void 0,[gi.MediaPlayerSourceVariables]:void 0,[gi.MediaPlayerCycle]:void 0,[gi.MediaCaptureStill]:void 0,[gi.MediaDeleteStill]:void 0}}function ar(e,t,i){return t.media.players?{[gi.SaveStartupState]:{name:"Startup State: Save",options:{},callback:async()=>{await(e?.saveStartupState())}},[gi.ClearStartupState]:{name:"Startup State: Clear",options:{},callback:async()=>{await(e?.clearStartupState())}},[gi.InputName]:{name:"Input: Set name",options:{source:si(t,i.state),short_enable:{id:"short_enable",label:"Set short name",type:"checkbox",default:!0},short_value:{id:"short_value",label:"Short name",type:"textinput",default:"",tooltip:"Max 4 characters. Supports variables",useVariables:!0},long_enable:{id:"long_enable",label:"Set long name",type:"checkbox",default:!0},long_value:{id:"long_value",label:"Long name",type:"textinput",default:"",tooltip:"Max 24 characters. Supports variables",useVariables:!0}},callback:async({options:t})=>{const i=t.getPlainNumber("source"),r=t.getPlainBoolean("short_enable"),a=t.getPlainBoolean("long_enable"),o={};r&&(o.shortName=await t.getParsedString("short_value")),a&&(o.longName=await t.getParsedString("long_value")),await Promise.all(["string"!=typeof o.longName||e?.hasInternalMultiviewerLabelGeneration()?void 0:e?.drawMultiviewerLabel(i,o.longName),Object.keys(o).length?e?.setInputSettings(o,i):void 0])},learn:({options:e})=>{const t=e.getPlainNumber("source"),r=i.state.inputs[t];return r?{...e.getJson(),long_value:r.longName,short_value:r.shortName}:void 0}}}:{[gi.SaveStartupState]:void 0,[gi.ClearStartupState]:void 0,[gi.InputName]:void 0}}function or(t,i,r,a){return i.SSrc?{[gi.SuperSourceArt]:{name:"SuperSource: Set art properties",options:{ssrcId:Ut(i),...Ht(i,a.state,!0)},callback:async({options:r})=>{const o=r.getRaw("ssrcId")&&i.SSrc>1?Number(r.getRaw("ssrcId")):0,n={},s=r.getRaw("properties");if(s&&Array.isArray(s)){if(s.includes("fill")&&(n.artFillSource=r.getPlainNumber("fill")),s.includes("key")&&(n.artCutSource=r.getPlainNumber("key")),s.includes("artOption")){const t=r.getRaw("artOption");if("toggle"===t){const t=a.state.video.superSources[o];n.artOption=t?.properties?.artOption===e.Enums.SuperSourceArtOption.Background?e.Enums.SuperSourceArtOption.Foreground:e.Enums.SuperSourceArtOption.Background}else"unchanged"!==t&&(n.artOption=Number(r.getRaw("artOption")))}s.includes("artPreMultiplied")&&(n.artPreMultiplied=r.getPlainBoolean("artPreMultiplied")),s.includes("artClip")&&(n.artClip=10*r.getPlainNumber("artClip")),s.includes("artGain")&&(n.artGain=10*r.getPlainNumber("artGain")),s.includes("artInvertKey")&&(n.artInvertKey=r.getPlainBoolean("artInvertKey"))}0!==Object.keys(n).length&&await(t?.setSuperSourceProperties(n,o))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,r=a.state.video.superSources?.[t]?.properties;return r?{...e.getJson(),fill:r.artFillSource,key:r.artCutSource,artOption:r.artOption,artPreMultiplied:r.artPreMultiplied,artClip:r.artClip/10,artGain:r.artGain/10,artInvertKey:r.artInvertKey}:void 0}},[gi.SuperSourceArtVariables]:{name:"SuperSource: Set art sources from variables",options:{ssrcId:Ut(i),...qt()},callback:async({options:e})=>{const r=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,a={},o=[],n=(e,t)=>o.push(t.then(t=>{a[e]=t})),s=e.getRaw("properties");s&&Array.isArray(s)&&(s.includes("fill")&&n("artFillSource",e.getParsedNumber("fill")),s.includes("key")&&n("artCutSource",e.getParsedNumber("key"))),await Promise.all(o),0!==Object.keys(a).length&&await(t?.setSuperSourceProperties(a,r))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,r=a.state.video.superSources?.[t]?.properties;return r?{...e.getJson(),fill:r.artFillSource+"",key:r.artCutSource+""}:void 0}},[gi.SuperSourceBoxSource]:{name:"SuperSource: Set box source",options:{ssrcId:Ut(i),boxIndex:Kt(),source:Xt(i,a.state)},callback:async({options:e})=>{await(t?.setSuperSourceBoxSettings({source:e.getPlainNumber("source")},e.getPlainNumber("boxIndex"),e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,r=e.getPlainNumber("boxIndex"),o=a.state.video.superSources?.[t]?.boxes[r];return o?{...e.getJson(),source:o.source}:void 0}},[gi.SuperSourceBoxSourceVaraibles]:{name:"SuperSource: Set box source from variables",options:{ssrcId:i.SSrc>1?{type:"textinput",id:"ssrcId",label:"Super Source",default:"1",useVariables:!0}:void 0,boxIndex:{type:"textinput",id:"boxIndex",label:"Box #",default:"1",useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"1",useVariables:!0}},callback:async({options:e})=>{const r=e.getRaw("ssrcId")&&i.SSrc>1?Number(await e.getParsedNumber("ssrcId"))-1:0,a=await e.getParsedNumber("boxIndex")-1,o=await e.getParsedNumber("source");isNaN(r)||isNaN(a)||isNaN(o)||await(t?.setSuperSourceBoxSettings({source:o},a,r))},learn:async({options:e})=>{const t=e.getRaw("ssrcId")&&i.SSrc>1?Number(await e.getParsedNumber("ssrcId"))-1:0,r=await e.getParsedNumber("boxIndex")-1,o=a.state.video.superSources?.[t]?.boxes[r];return o?{...e.getJson(),source:o.source+""}:void 0}},[gi.SuperSourceBoxOnAir]:{name:"SuperSource: Set box enabled",options:{ssrcId:Ut(i),boxIndex:Kt(),onair:{id:"onair",type:"dropdown",label:"On Air",default:"true",choices:N}},callback:async({options:e})=>{const r=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,o=e.getPlainNumber("boxIndex");if("toggle"===e.getRaw("onair")){const e=zi(a.state,o,r);await(t?.setSuperSourceBoxSettings({enabled:!e?.enabled},o,r))}else await(t?.setSuperSourceBoxSettings({enabled:"true"===e.getRaw("onair")},o,r))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,r=e.getPlainNumber("boxIndex"),o=a.state.video.superSources?.[t]?.boxes[r];return o?{...e.getJson(),onair:o.enabled?"true":"false"}:void 0}},[gi.SuperSourceBoxProperties]:{name:"SuperSource: Change box properties",options:{ssrcId:Ut(i),boxIndex:Kt(),transitionRate:{type:"number",id:"transitionRate",label:"Transition Rate",default:0,min:0,max:99999,step:1,required:!1},transitionEasing:{type:"dropdown",label:"Transition Easing",id:"transitionEasing",default:"linear",choices:[{id:"linear",label:"Linear"},{id:"quadratic",label:"Quadratic"},{id:"cubic",label:"Cubic"},{id:"quartic",label:"Quartic"},{id:"quintic",label:"Quintic"},{id:"sinusoidal",label:"Sinusoidal"},{id:"exponential",label:"Exponential"},{id:"circular",label:"Circular"},{id:"elastic",label:"Elastic"},{id:"back",label:"Back"},{id:"bounce",label:"Bounce"}],isVisibleExpression:"$(options:transitionRate) != null && $(options:transitionRate) > 0"},transitionCurve:{type:"dropdown",label:"Transition curve",id:"transitionCurve",default:"ease-in",choices:[{id:"ease-in",label:"Ease-in"},{id:"ease-out",label:"Ease-out"},{id:"ease-in-out",label:"Ease-in-out"}],isVisibleExpression:"$(options:transitionRate) != null && $(options:transitionEasing) != null && $(options:transitionRate) > 0 && $(options:transitionEasing) != 'linear'"},...zt(i,a.state)},callback:async({options:e})=>{const o=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,n=e.getPlainNumber("boxIndex"),s={},l=e.getRaw("properties");if(l&&Array.isArray(l)){if(l.includes("onair"))if("toggle"===e.getPlainString("onair")){const e=zi(a.state,n,o);s.enabled=!e?.enabled}else s.enabled="true"===e.getPlainString("onair");l.includes("source")&&(s.source=e.getPlainNumber("source")),l.includes("size")&&(s.size=1e3*e.getPlainNumber("size")),l.includes("x")&&(s.x=100*e.getPlainNumber("x")),l.includes("y")&&(s.y=100*e.getPlainNumber("y")),l.includes("cropEnable")&&(s.cropped=e.getPlainBoolean("cropEnable")),l.includes("cropTop")&&(s.cropTop=1e3*e.getPlainNumber("cropTop")),l.includes("cropBottom")&&(s.cropBottom=1e3*e.getPlainNumber("cropBottom")),l.includes("cropLeft")&&(s.cropLeft=1e3*e.getPlainNumber("cropLeft")),l.includes("cropRight")&&(s.cropRight=1e3*e.getPlainNumber("cropRight"))}0!==Object.keys(s).length&&await r.runForProperties(`superSource.${o}.box.${n}`,async e=>{await(t?.setSuperSourceBoxSettings(e,n,o))},e,["size","x","y","cropTop","cropBottom","cropLeft","cropRight"],s,a.state.video.superSources[o]?.boxes[n])},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,r=e.getPlainNumber("boxIndex"),o=a.state.video.superSources?.[t]?.boxes[r];return o?{...e.getJson(),onair:o.enabled?"true":"false",source:o.source,size:o.size/1e3,x:o.x/100,y:o.y/100,cropEnable:o.cropped,cropTop:o.cropTop/1e3,cropBottom:o.cropBottom/1e3,cropLeft:o.cropLeft/1e3,cropRight:o.cropRight/1e3}:void 0}},[gi.SuperSourceBoxPropertiesDelta]:{name:"SuperSource: Offset box properties",options:{ssrcId:Ut(i),boxIndex:Kt(),...Wt()},callback:async({options:e})=>{const r=e.getRaw("ssrcId")&&i.SSrc>1?Number(e.getRaw("ssrcId")):0,o=e.getPlainNumber("boxIndex"),n={},s=zi(a.state,o,r),l=e.getRaw("properties");s&&l&&Array.isArray(l)&&(l.includes("size")&&(n.size=ae(0,1e3,s.size+1e3*e.getPlainNumber("size"))),l.includes("x")&&(n.x=ae(-4800,4800,s.x+100*e.getPlainNumber("x"))),l.includes("y")&&(n.y=ae(-2700,2700,s.y+100*e.getPlainNumber("y"))),l.includes("cropTop")&&(n.cropTop=ae(0,18e3,s.cropTop+1e3*e.getPlainNumber("cropTop"))),l.includes("cropBottom")&&(n.cropBottom=ae(0,18e3,s.cropBottom+1e3*e.getPlainNumber("cropBottom"))),l.includes("cropLeft")&&(n.cropLeft=ae(0,32e3,s.cropLeft+1e3*e.getPlainNumber("cropLeft"))),l.includes("cropRight")&&(n.cropRight=ae(0,32e3,s.cropRight+1e3*e.getPlainNumber("cropRight")))),0!==Object.keys(n).length&&await(t?.setSuperSourceBoxSettings(n,o,r))}}}:{[gi.SuperSourceArt]:void 0,[gi.SuperSourceArtVariables]:void 0,[gi.SuperSourceBoxSource]:void 0,[gi.SuperSourceBoxSourceVaraibles]:void 0,[gi.SuperSourceBoxOnAir]:void 0,[gi.SuperSourceBoxProperties]:void 0,[gi.SuperSourceBoxPropertiesDelta]:void 0}}function nr(e,t,i){return t.USKs?{[gi.USKSource]:{name:"Upstream key: Set inputs",options:{mixeffect:_t(t,0),key:Nt(t),fill:Bt(t,i.state),cut:Lt(t,i.state)},callback:async({options:t})=>{await Promise.all([e?.setUpstreamKeyerFillSource(t.getPlainNumber("fill"),t.getPlainNumber("mixeffect"),t.getPlainNumber("key")),e?.setUpstreamKeyerCutSource(t.getPlainNumber("cut"),t.getPlainNumber("mixeffect"),t.getPlainNumber("key"))])},learn:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?{...e.getJson(),cut:t.cutSource,fill:t.fillSource}:void 0}},[gi.USKType]:{name:"Upstream key: Set type",options:{mixeffect:_t(t,0),key:Nt(t),type:Ct()},callback:async({options:t})=>{await(e?.setUpstreamKeyerType({mixEffectKeyType:t.getPlainNumber("type")},t.getPlainNumber("mixeffect"),t.getPlainNumber("key")))},learn:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?{...e.getJson(),type:t.mixEffectKeyType}:void 0}},[gi.USKSourceVariables]:{name:"Upstream key: Set inputs from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},fill:{type:"textinput",id:"fill",label:"Fill Source",default:"0",useVariables:!0},cut:{type:"textinput",id:"cut",label:"Key Source",default:"0",useVariables:!0}},callback:async({options:t})=>{const i=await t.getParsedNumber("mixeffect")-1,r=await t.getParsedNumber("key")-1,a=await t.getParsedNumber("fill"),o=await t.getParsedNumber("cut");isNaN(i)||isNaN(r)||isNaN(a)||isNaN(o)||await Promise.all([e?.setUpstreamKeyerFillSource(a,i,r),e?.setUpstreamKeyerCutSource(o,i,r)])},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=await e.getParsedNumber("key")-1,a=Ui(i.state,t,r);return a?{...e.getJson(),cut:a.cutSource+"",fill:a.fillSource+""}:void 0}},[gi.USKOnAir]:{name:"Upstream key: Set OnAir",options:{onair:{id:"onair",type:"dropdown",label:"On Air",default:"true",choices:N},mixeffect:_t(t,0),key:Nt(t)},callback:async({options:t})=>{const r=t.getPlainNumber("mixeffect"),a=t.getPlainNumber("key");if("toggle"===t.getPlainString("onair")){const t=Ui(i.state,r,a);await(e?.setUpstreamKeyerOnAir(!t?.onAir,r,a))}else await(e?.setUpstreamKeyerOnAir("true"===t.getPlainString("onair"),r,a))},learn:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?{...e.getJson(),onair:t.onAir?"true":"false"}:void 0}},[gi.USKMaskLumaChromaPattern]:{name:"Upstream key: Set Mask (Luma, Chroma, Pattern)",options:{mixeffect:_t(t,0),key:Nt(t),...Ot()},callback:async({options:t})=>{const i=t.getPlainNumber("key"),r=t.getPlainNumber("mixeffect"),a={},o=t.getRaw("properties");o&&Array.isArray(o)&&(o.includes("maskEnabled")&&(a.maskEnabled=t.getPlainBoolean("maskEnabled")),o.includes("maskTop")&&(a.maskTop=1e3*t.getPlainNumber("maskTop")),o.includes("maskBottom")&&(a.maskBottom=1e3*t.getPlainNumber("maskBottom")),o.includes("maskLeft")&&(a.maskLeft=1e3*t.getPlainNumber("maskLeft")),o.includes("maskRight")&&(a.maskRight=1e3*t.getPlainNumber("maskRight"))),0!==Object.keys(a).length&&await(e?.setUpstreamKeyerMaskSettings(a,r,i))},learn:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.maskSettings?{...e.getJson(),maskEnabled:t.maskSettings.maskEnabled,maskTop:t.maskSettings.maskTop/1e3,maskBottom:t.maskSettings.maskBottom/1e3,maskLeft:t.maskSettings.maskLeft/1e3,maskRight:t.maskSettings.maskRight/1e3}:void 0}},[gi.USKFlyKeyLumaChromaPattern]:{name:"Upstream key: Set Flying Key (Luma, Chroma, Pattern)",options:{mixeffect:_t(t,0),key:Nt(t),...bi()},callback:async({options:t})=>{const i=t.getPlainNumber("key"),r=t.getPlainNumber("mixeffect"),a={},o={},n=t.getRaw("properties");n&&Array.isArray(n)&&(n.includes("flyEnabled")&&(a.flyEnabled=t.getPlainBoolean("flyEnabled")),n.includes("positionX")&&(o.positionX=1e3*t.getPlainNumber("positionX")),n.includes("positionY")&&(o.positionY=1e3*t.getPlainNumber("positionY")),n.includes("sizeX")&&(o.sizeX=1e3*t.getPlainNumber("sizeX")),n.includes("sizeY")&&(o.sizeY=1e3*t.getPlainNumber("sizeY"))),0!==Object.keys(o).length&&0!==Object.keys(a).length&&(await(e?.setUpstreamKeyerDVESettings(o,r,i)),await(e?.setUpstreamKeyerType(a,r,i)))},learn:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.dveSettings?{...e.getJson(),flyEnabled:t.flyEnabled,positionX:t.dveSettings.positionX/1e3,positionY:t.dveSettings.positionY/1e3,sizeX:t.dveSettings.sizeX/1e3,sizeY:t.dveSettings.sizeY/1e3}:void 0}},[gi.USKFlyKeyLumaChromaPatternVariables]:{name:"Upstream key: Set Flying Key (Luma, Chroma, Pattern) from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},...fi()},callback:async({options:t})=>{const i=await t.getParsedNumber("mixeffect")-1,r=await t.getParsedNumber("key")-1,a={},o={},n=t.getRaw("properties");n&&Array.isArray(n)&&(n.includes("flyEnabled")&&(a.flyEnabled=await t.getParsedBoolean("flyEnabled")),n.includes("positionX")&&(o.positionX=1e3*await t.getParsedNumber("positionX")),n.includes("positionY")&&(o.positionY=1e3*await t.getParsedNumber("positionY")),n.includes("sizeX")&&(o.sizeX=1e3*await t.getParsedNumber("sizeX")),n.includes("sizeY")&&(o.sizeY=1e3*await t.getParsedNumber("sizeY"))),isNaN(i)||isNaN(r)||0!==Object.keys(o).length&&(await(e?.setUpstreamKeyerDVESettings(o,i,r)),0!==Object.keys(a).length&&await(e?.setUpstreamKeyerType(a,i,r)))},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=await e.getParsedNumber("key")-1,a=Ui(i.state,t,r);return a?.dveSettings?{...e.getJson(),flyEnabled:a.flyEnabled+"",positionX:a.dveSettings.positionX/1e3+"",positionY:a.dveSettings.positionY/1e3+"",sizeX:a.dveSettings.sizeX/1e3+"",sizeY:a.dveSettings.sizeY/1e3+""}:void 0}}}:{[gi.USKSource]:void 0,[gi.USKType]:void 0,[gi.USKSourceVariables]:void 0,[gi.USKOnAir]:void 0,[gi.USKMaskLumaChromaPattern]:void 0,[gi.USKFlyKeyLumaChromaPattern]:void 0,[gi.USKFlyKeyLumaChromaPatternVariables]:void 0}}function sr(e,t,i){return{[gi.FadeToBlackAuto]:{name:"Fade to black: Run AUTO Transition",options:{mixeffect:_t(t,0)},callback:async({options:t})=>{await(e?.fadeToBlack(t.getPlainNumber("mixeffect")))}},[gi.FadeToBlackRate]:{name:"Fade to black: Change rate",options:{mixeffect:_t(t,0),rate:kt("Rate")},callback:async({options:t})=>{await(e?.setFadeToBlackRate(t.getPlainNumber("rate"),t.getPlainNumber("mixeffect")))},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect"));return t?.fadeToBlack?{...e.getJson(),rate:t.fadeToBlack.rate}:void 0}}}}function lr(e,t,i,r){return t.USKs&&t.DVEs?{[gi.USKDVEProperties]:{name:"Upstream key: Change DVE properties",options:{mixeffect:_t(t,0),key:Nt(t),transitionRate:{type:"number",id:"transitionRate",label:"Transition Rate",default:0,min:0,max:99999,step:1,required:!1},transitionEasing:{type:"dropdown",label:"Transition Easing",id:"transitionEasing",default:"linear",choices:[{id:"linear",label:"Linear"},{id:"quadratic",label:"Quadratic"},{id:"cubic",label:"Cubic"},{id:"quartic",label:"Quartic"},{id:"quintic",label:"Quintic"},{id:"sinusoidal",label:"Sinusoidal"},{id:"exponential",label:"Exponential"},{id:"circular",label:"Circular"},{id:"elastic",label:"Elastic"},{id:"back",label:"Back"},{id:"bounce",label:"Bounce"}],isVisibleExpression:"$(options:transitionRate) != null && $(options:transitionRate) > 0"},transitionCurve:{type:"dropdown",label:"Transition curve",id:"transitionCurve",default:"ease-in",choices:[{id:"ease-in",label:"Ease-in"},{id:"ease-out",label:"Ease-out"},{id:"ease-in-out",label:"Ease-in-out"}],isVisibleExpression:"$(options:transitionRate) != null && $(options:transitionEasing) != null && $(options:transitionRate) > 0 && $(options:transitionEasing) != 'linear'"},...Rt()},callback:async({options:t})=>{const a=t.getPlainNumber("key"),o=t.getPlainNumber("mixeffect"),n={},s=t.getRaw("properties");s&&Array.isArray(s)&&(s.includes("maskEnabled")&&(n.maskEnabled=t.getPlainBoolean("maskEnabled")),s.includes("maskTop")&&(n.maskTop=1e3*t.getPlainNumber("maskTop")),s.includes("maskBottom")&&(n.maskBottom=1e3*t.getPlainNumber("maskBottom")),s.includes("maskLeft")&&(n.maskLeft=1e3*t.getPlainNumber("maskLeft")),s.includes("maskRight")&&(n.maskRight=1e3*t.getPlainNumber("maskRight")),s.includes("sizeX")&&(n.sizeX=1e3*t.getPlainNumber("sizeX")),s.includes("sizeY")&&(n.sizeY=1e3*t.getPlainNumber("sizeY")),s.includes("positionX")&&(n.positionX=1e3*t.getPlainNumber("positionX")),s.includes("positionY")&&(n.positionY=1e3*t.getPlainNumber("positionY")),s.includes("rotation")&&(n.rotation=t.getPlainNumber("rotation")),s.includes("borderOuterWidth")&&(n.borderOuterWidth=100*t.getPlainNumber("borderOuterWidth")),s.includes("borderInnerWidth")&&(n.borderInnerWidth=100*t.getPlainNumber("borderInnerWidth")),s.includes("borderOuterSoftness")&&(n.borderOuterSoftness=t.getPlainNumber("borderOuterSoftness")),s.includes("borderInnerSoftness")&&(n.borderInnerSoftness=t.getPlainNumber("borderInnerSoftness")),s.includes("borderBevelSoftness")&&(n.borderBevelSoftness=t.getPlainNumber("borderBevelSoftness")),s.includes("borderBevelPosition")&&(n.borderBevelPosition=t.getPlainNumber("borderBevelPosition")),s.includes("borderOpacity")&&(n.borderOpacity=t.getPlainNumber("borderOpacity")),s.includes("borderHue")&&(n.borderHue=10*t.getPlainNumber("borderHue")),s.includes("borderSaturation")&&(n.borderSaturation=10*t.getPlainNumber("borderSaturation")),s.includes("borderLuma")&&(n.borderLuma=10*t.getPlainNumber("borderLuma")),s.includes("lightSourceDirection")&&(n.lightSourceDirection=10*t.getPlainNumber("lightSourceDirection")),s.includes("lightSourceAltitude")&&(n.lightSourceAltitude=t.getPlainNumber("lightSourceAltitude")),s.includes("borderEnabled")&&(n.borderEnabled=t.getPlainBoolean("borderEnabled")),s.includes("shadowEnabled")&&(n.shadowEnabled=t.getPlainBoolean("shadowEnabled")),s.includes("borderBevel")&&(n.borderBevel=t.getPlainNumber("borderBevel")),s.includes("rate")&&(n.rate=t.getPlainNumber("rate"))),0!==Object.keys(n).length&&await i.runForProperties(`me.${o}.keyer.${a}.dveSettings`,async t=>{await(e?.setUpstreamKeyerDVESettings(t,o,a))},t,["positionX","positionY","sizeX","sizeY","rotation","maskTop","maskBottom","maskLeft","maskRight","lightSourceDirection","lightSourceAltitude","borderHue","borderSaturation","borderLuma","borderBevel","borderOuterWidth","borderInnerWidth","borderOuterSoftness","borderInnerSoftness","borderOpacity","borderBevelPosition","borderBevelSoftness"],n,r.state.video.mixEffects[o]?.upstreamKeyers[a]?.dveSettings)},learn:({options:e})=>{const t=Ui(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.dveSettings?{...e.getJson(),maskEnabled:t.dveSettings.maskEnabled,maskTop:t.dveSettings.maskTop/1e3,maskBottom:t.dveSettings.maskBottom/1e3,maskLeft:t.dveSettings.maskLeft/1e3,maskRight:t.dveSettings.maskRight/1e3,sizeX:t.dveSettings.sizeX/1e3,sizeY:t.dveSettings.sizeY/1e3,positionX:t.dveSettings.positionX/1e3,positionY:t.dveSettings.positionY/1e3,rotation:t.dveSettings.rotation,borderOuterWidth:t.dveSettings.borderOuterWidth/100,borderInnerWidth:t.dveSettings.borderInnerWidth/100,borderOuterSoftness:t.dveSettings.borderOuterSoftness,borderInnerSoftness:t.dveSettings.borderInnerSoftness,borderBevelSoftness:t.dveSettings.borderBevelSoftness,borderBevelPosition:t.dveSettings.borderBevelPosition,borderOpacity:t.dveSettings.borderOpacity,borderHue:t.dveSettings.borderHue/10,borderSaturation:t.dveSettings.borderSaturation/10,borderLuma:t.dveSettings.borderLuma/10,lightSourceDirection:t.dveSettings.lightSourceDirection/10,lightSourceAltitude:t.dveSettings.lightSourceAltitude,borderEnabled:t.dveSettings.borderEnabled,shadowEnabled:t.dveSettings.shadowEnabled,borderBevel:t.dveSettings.borderBevel,rate:t.dveSettings.rate}:void 0}},[gi.USKDVEPropertiesVariables]:{name:"Upstream key: Change DVE properties from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},transitionRate:{type:"number",id:"transitionRate",label:"Transition Rate",default:0,min:0,max:99999,step:1,required:!1},transitionEasing:{type:"dropdown",label:"Transition Easing",id:"transitionEasing",default:"linear",choices:[{id:"linear",label:"Linear"},{id:"quadratic",label:"Quadratic"},{id:"cubic",label:"Cubic"},{id:"quartic",label:"Quartic"},{id:"quintic",label:"Quintic"},{id:"sinusoidal",label:"Sinusoidal"},{id:"exponential",label:"Exponential"},{id:"circular",label:"Circular"},{id:"elastic",label:"Elastic"},{id:"back",label:"Back"},{id:"bounce",label:"Bounce"}],isVisibleExpression:"$(options:transitionRate) != null && $(options:transitionRate) > 0"},transitionCurve:{type:"dropdown",label:"Transition curve",id:"transitionCurve",default:"ease-in",choices:[{id:"ease-in",label:"Ease-in"},{id:"ease-out",label:"Ease-out"},{id:"ease-in-out",label:"Ease-in-out"}],isVisibleExpression:"$(options:transitionRate) != null && $(options:transitionEasing) != null && $(options:transitionRate) > 0 && $(options:transitionEasing) != 'linear'"},...$t()},callback:async({options:t})=>{const a=await t.getParsedNumber("mixeffect")-1,o=await t.getParsedNumber("key")-1,n={},s=t.getRaw("properties");s&&Array.isArray(s)&&(s.includes("maskEnabled")&&(n.maskEnabled=await t.getParsedBoolean("maskEnabled")),s.includes("maskTop")&&(n.maskTop=1e3*await t.getParsedNumber("maskTop")),s.includes("maskBottom")&&(n.maskBottom=1e3*await t.getParsedNumber("maskBottom")),s.includes("maskLeft")&&(n.maskLeft=1e3*await t.getParsedNumber("maskLeft")),s.includes("maskRight")&&(n.maskRight=1e3*await t.getParsedNumber("maskRight")),s.includes("sizeX")&&(n.sizeX=1e3*await t.getParsedNumber("sizeX")),s.includes("sizeY")&&(n.sizeY=1e3*await t.getParsedNumber("sizeY")),s.includes("positionX")&&(n.positionX=1e3*await t.getParsedNumber("positionX")),s.includes("positionY")&&(n.positionY=1e3*await t.getParsedNumber("positionY")),s.includes("rotation")&&(n.rotation=await t.getParsedNumber("rotation")),s.includes("borderOuterWidth")&&(n.borderOuterWidth=100*await t.getParsedNumber("borderOuterWidth")),s.includes("borderInnerWidth")&&(n.borderInnerWidth=100*await t.getParsedNumber("borderInnerWidth")),s.includes("borderOuterSoftness")&&(n.borderOuterSoftness=await t.getParsedNumber("borderOuterSoftness")),s.includes("borderInnerSoftness")&&(n.borderInnerSoftness=await t.getParsedNumber("borderInnerSoftness")),s.includes("borderBevelSoftness")&&(n.borderBevelSoftness=await t.getParsedNumber("borderBevelSoftness")),s.includes("borderBevelPosition")&&(n.borderBevelPosition=await t.getParsedNumber("borderBevelPosition")),s.includes("borderOpacity")&&(n.borderOpacity=await t.getParsedNumber("borderOpacity")),s.includes("borderHue")&&(n.borderHue=10*await t.getParsedNumber("borderHue")),s.includes("borderSaturation")&&(n.borderSaturation=10*await t.getParsedNumber("borderSaturation")),s.includes("borderLuma")&&(n.borderLuma=10*await t.getParsedNumber("borderLuma")),s.includes("lightSourceDirection")&&(n.lightSourceDirection=10*await t.getParsedNumber("lightSourceDirection")),s.includes("lightSourceAltitude")&&(n.lightSourceAltitude=await t.getParsedNumber("lightSourceAltitude")),s.includes("borderEnabled")&&(n.borderEnabled=await t.getParsedBoolean("borderEnabled")),s.includes("shadowEnabled")&&(n.shadowEnabled=await t.getParsedBoolean("shadowEnabled")),s.includes("borderBevel")&&(n.borderBevel=await t.getParsedNumber("borderBevel")),s.includes("rate")&&(n.rate=await t.getParsedNumber("rate"))),isNaN(a)||isNaN(o)||0!==Object.keys(n).length&&await i.runForProperties(`me.${a}.keyer.${o}.dveSettings`,async t=>{await(e?.setUpstreamKeyerDVESettings(t,a,o))},t,["positionX","positionY","sizeX","sizeY","rotation","maskTop","maskBottom","maskLeft","maskRight","lightSourceDirection","lightSourceAltitude","borderHue","borderSaturation","borderLuma","borderBevel","borderOuterWidth","borderInnerWidth","borderOuterSoftness","borderInnerSoftness","borderOpacity","borderBevelPosition","borderBevelSoftness"],n,r.state.video.mixEffects[a]?.upstreamKeyers[o]?.dveSettings)},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("key")-1,a=Ui(r.state,t,i);return a?.dveSettings?{...e.getJson(),maskEnabled:a.dveSettings.maskEnabled+"",maskTop:a.dveSettings.maskTop/1e3+"",maskBottom:a.dveSettings.maskBottom/1e3+"",maskLeft:a.dveSettings.maskLeft/1e3+"",maskRight:a.dveSettings.maskRight/1e3+"",sizeX:a.dveSettings.sizeX/1e3+"",sizeY:a.dveSettings.sizeY/1e3+"",positionX:a.dveSettings.positionX/1e3+"",positionY:a.dveSettings.positionY/1e3+"",rotation:a.dveSettings.rotation+"",borderOuterWidth:a.dveSettings.borderOuterWidth/100+"",borderInnerWidth:a.dveSettings.borderInnerWidth/100+"",borderOuterSoftness:a.dveSettings.borderOuterSoftness+"",borderInnerSoftness:a.dveSettings.borderInnerSoftness+"",borderBevelSoftness:a.dveSettings.borderBevelSoftness+"",borderBevelPosition:a.dveSettings.borderBevelPosition+"",borderOpacity:a.dveSettings.borderOpacity+"",borderHue:a.dveSettings.borderHue/10+"",borderSaturation:a.dveSettings.borderSaturation/10+"",borderLuma:a.dveSettings.borderLuma/10+"",lightSourceDirection:a.dveSettings.lightSourceDirection/10+"",lightSourceAltitude:a.dveSettings.lightSourceAltitude+"",borderEnabled:a.dveSettings.borderEnabled+"",shadowEnabled:a.dveSettings.shadowEnabled+"",borderBevel:a.dveSettings.borderBevel+"",rate:a.dveSettings.rate+""}:void 0}},[gi.USKSetKeyframe]:{name:"Upstream key: Set Keyframe from values",options:{mixeffect:_t(t,0),key:Nt(t),keyframe:{type:"dropdown",id:"keyframe",label:"Key Frame",choices:R,default:R[0].id},...Dt()},callback:async({options:t})=>{const i=t.getPlainNumber("mixeffect"),r=t.getPlainNumber("key"),a=t.getPlainNumber("keyframe"),o={},n=t.getRaw("properties");n&&Array.isArray(n)&&(n.includes("maskTop")&&(o.maskTop=1e3*t.getPlainNumber("maskTop")),n.includes("maskBottom")&&(o.maskBottom=1e3*t.getPlainNumber("maskBottom")),n.includes("maskLeft")&&(o.maskLeft=1e3*t.getPlainNumber("maskLeft")),n.includes("maskRight")&&(o.maskRight=1e3*t.getPlainNumber("maskRight")),n.includes("sizeX")&&(o.sizeX=1e3*t.getPlainNumber("sizeX")),n.includes("sizeY")&&(o.sizeY=1e3*t.getPlainNumber("sizeY")),n.includes("positionX")&&(o.positionX=1e3*t.getPlainNumber("positionX")),n.includes("positionY")&&(o.positionY=1e3*t.getPlainNumber("positionY")),n.includes("rotation")&&(o.rotation=t.getPlainNumber("rotation")),n.includes("borderOuterWidth")&&(o.borderOuterWidth=100*t.getPlainNumber("borderOuterWidth")),n.includes("borderInnerWidth")&&(o.borderInnerWidth=100*t.getPlainNumber("borderInnerWidth")),n.includes("borderOuterSoftness")&&(o.borderOuterSoftness=t.getPlainNumber("borderOuterSoftness")),n.includes("borderInnerSoftness")&&(o.borderInnerSoftness=t.getPlainNumber("borderInnerSoftness")),n.includes("borderBevelSoftness")&&(o.borderBevelSoftness=t.getPlainNumber("borderBevelSoftness")),n.includes("borderBevelPosition")&&(o.borderBevelPosition=t.getPlainNumber("borderBevelPosition")),n.includes("borderOpacity")&&(o.borderOpacity=t.getPlainNumber("borderOpacity")),n.includes("borderHue")&&(o.borderHue=10*t.getPlainNumber("borderHue")),n.includes("borderSaturation")&&(o.borderSaturation=10*t.getPlainNumber("borderSaturation")),n.includes("borderLuma")&&(o.borderLuma=10*t.getPlainNumber("borderLuma")),n.includes("lightSourceDirection")&&(o.lightSourceDirection=10*t.getPlainNumber("lightSourceDirection")),n.includes("lightSourceAltitude")&&(o.lightSourceAltitude=t.getPlainNumber("lightSourceAltitude"))),0!==Object.keys(o).length&&await(e?.setUpstreamKeyerFlyKeyKeyframe(i,r,a,o))},learn:({options:e})=>{const t=Ui(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.dveSettings?{...e.getJson(),maskTop:t.dveSettings.maskTop/1e3,maskBottom:t.dveSettings.maskBottom/1e3,maskLeft:t.dveSettings.maskLeft/1e3,maskRight:t.dveSettings.maskRight/1e3,sizeX:t.dveSettings.sizeX/1e3,sizeY:t.dveSettings.sizeY/1e3,positionX:t.dveSettings.positionX/1e3,positionY:t.dveSettings.positionY/1e3,rotation:t.dveSettings.rotation,borderOuterWidth:t.dveSettings.borderOuterWidth/100,borderInnerWidth:t.dveSettings.borderInnerWidth/100,borderOuterSoftness:t.dveSettings.borderOuterSoftness,borderInnerSoftness:t.dveSettings.borderInnerSoftness,borderBevelSoftness:t.dveSettings.borderBevelSoftness,borderBevelPosition:t.dveSettings.borderBevelPosition,borderOpacity:t.dveSettings.borderOpacity,borderHue:t.dveSettings.borderHue/10,borderSaturation:t.dveSettings.borderSaturation/10,borderLuma:t.dveSettings.borderLuma/10,lightSourceDirection:t.dveSettings.lightSourceDirection/10,lightSourceAltitude:t.dveSettings.lightSourceAltitude}:void 0}},[gi.USKStoreKeyframe]:{name:"Upstream key: Set keyframe from current key state",options:{mixeffect:_t(t,0),key:Nt(t),keyframe:{type:"dropdown",id:"keyframe",label:"Key Frame",choices:R,default:R[0].id}},callback:async({options:t})=>{await(e?.storeUpstreamKeyerFlyKeyKeyframe(t.getPlainNumber("mixeffect"),t.getPlainNumber("key"),t.getPlainNumber("keyframe")))}},[gi.USKFly]:{name:"Upstream key: fly to keyframe",options:{mixeffect:_t(t,0),key:Nt(t),keyframe:{type:"dropdown",id:"keyframe",label:"Key Frame",choices:O,default:O[0].id}},callback:async({options:t})=>{await(e?.runUpstreamKeyerFlyKeyTo(t.getPlainNumber("mixeffect"),t.getPlainNumber("key"),t.getPlainNumber("keyframe")))},learn:({options:e})=>{const t=Ui(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.flyProperties?{...e.getJson(),keyframe:t.flyProperties.isAtKeyFrame}:void 0}},[gi.USKFlyInfinite]:{name:"Upstream key: fly to infinite",options:{mixeffect:_t(t,0),key:Nt(t),flydirection:{type:"dropdown",id:"flydirection",label:"Fly direction",choices:D,default:D[0].id}},callback:async({options:t})=>{await(e?.runUpstreamKeyerFlyKeyToInfinite(t.getPlainNumber("mixeffect"),t.getPlainNumber("key"),t.getPlainNumber("flydirection")))},learn:({options:e})=>{const t=Ui(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.flyProperties?{...e.getJson(),flydirection:t.flyProperties.runToInfiniteIndex}:void 0}}}:{[gi.USKDVEProperties]:void 0,[gi.USKDVEPropertiesVariables]:void 0,[gi.USKSetKeyframe]:void 0,[gi.USKStoreKeyframe]:void 0,[gi.USKFly]:void 0,[gi.USKFlyInfinite]:void 0}}function ur(e,t,i){return t.USKs&&t.DVEs?{[gi.USKPatternProperties]:{name:"Upstream key: Change Pattern properties",options:{mixeffect:_t(t,0),key:Nt(t),...pi()},callback:async({options:t})=>{const i=t.getPlainNumber("key"),r=t.getPlainNumber("mixeffect"),a={},o=t.getRaw("properties");o&&Array.isArray(o)&&(o.includes("style")&&(a.style=t.getPlainNumber("style")),o.includes("size")&&(a.size=100*t.getPlainNumber("size")),o.includes("symmetry")&&(a.symmetry=100*t.getPlainNumber("symmetry")),o.includes("softness")&&(a.softness=100*t.getPlainNumber("softness")),o.includes("positionX")&&(a.positionX=1e4*t.getPlainNumber("positionX")),o.includes("positionY")&&(a.positionY=1e4*t.getPlainNumber("positionY")),o.includes("invert")&&(a.invert=t.getPlainBoolean("invert"))),0!==Object.keys(a).length&&await(e?.setUpstreamKeyerPatternSettings(a,r,i))},learn:async({options:e})=>{const t=e.getPlainNumber("key"),r=e.getPlainNumber("mixeffect"),a=Ui(i.state,r,t);return a?.patternSettings?{...e.getJson(),style:a.patternSettings.style,size:a.patternSettings.size/100,symmetry:a.patternSettings.symmetry/100,softness:a.patternSettings.softness/100,positionX:a.patternSettings.positionX/1e4,positionY:a.patternSettings.positionY/1e4,invert:a.patternSettings.invert}:void 0}},[gi.USKPatternPropertiesVariables]:{name:"Upstream key: Change Pattern properties from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},...mi()},callback:async({options:t})=>{const i=await t.getParsedNumber("mixeffect")-1,r=await t.getParsedNumber("key")-1,a={},o=t.getRaw("properties");o&&Array.isArray(o)&&(o.includes("style")&&(a.style=await t.getParsedNumber("style")),o.includes("size")&&(a.size=100*await t.getParsedNumber("size")),o.includes("symmetry")&&(a.symmetry=100*await t.getParsedNumber("symmetry")),o.includes("softness")&&(a.softness=100*await t.getParsedNumber("softness")),o.includes("positionX")&&(a.positionX=1e4*await t.getParsedNumber("positionX")),o.includes("positionY")&&(a.positionY=1e4*await t.getParsedNumber("positionY")),o.includes("invert")&&(a.invert=await t.getParsedBoolean("invert"))),isNaN(i)||isNaN(r)||0!==Object.keys(a).length&&await(e?.setUpstreamKeyerPatternSettings(a,i,r))},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=await e.getParsedNumber("key")-1,a=Ui(i.state,t,r);return a?.patternSettings?{...e.getJson(),style:a.patternSettings.style+"",size:a.patternSettings.size/100+"",symmetry:a.patternSettings.symmetry/100+"",softness:a.patternSettings.softness/100+"",positionX:a.patternSettings.positionX/1e4+"",positionY:a.patternSettings.positionY/1e4+"",invert:a.patternSettings.invert+""}:void 0}}}:{[gi.USKPatternProperties]:void 0,[gi.USKPatternPropertiesVariables]:void 0}}function cr(t,i,r,a){if(!i.classicAudio)return{[gi.ClassicAudioGain]:void 0,[gi.ClassicAudioGainDelta]:void 0,[gi.ClassicAudioMixOption]:void 0,[gi.ClassicAudioResetPeaks]:void 0,[gi.ClassicAudioMasterGain]:void 0,[gi.ClassicAudioMasterGainDelta]:void 0,[gi.ClassicAudioMasterPan]:void 0,[gi.ClassicAudioMasterPanDelta]:void 0};const o=ii(i,a.state);return{[gi.ClassicAudioGain]:{name:"Classic Audio: Set input gain",options:{input:o,gain:{type:"number",label:"Fader Level (-60 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:6},...oi},callback:async({options:e})=>{const i=e.getPlainNumber("input"),o=(a.state.audio?.channels??{})[i];await r.runForFadeOptions(`audio.${i}.gain`,async e=>{await(t?.setClassicAudioMixerInputProps(i,{gain:e}))},o?.gain,e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=(a.state.audio?.channels??{})[e.getPlainNumber("input")];return t?{...e.getJson(),gain:t.gain}:void 0}},[gi.ClassicAudioGainDelta]:{name:"Classic Audio: Adjust input gain",options:{input:o,delta:ni,...oi},callback:async({options:e})=>{const i=e.getPlainNumber("input"),o=(a.state.audio?.channels??{})[i];if("number"==typeof o?.gain){const a=Math.max(-60,o.gain);await r.runForFadeOptions(`audio.${i}.gain`,async e=>{await(t?.setClassicAudioMixerInputProps(i,{gain:e}))},a,a+e.getPlainNumber("delta"),e)}}},[gi.ClassicAudioMixOption]:{name:"Classic Audio: Set input mix option",options:{input:o,option:{id:"option",label:"Mix option",type:"dropdown",default:"toggle",choices:[{id:"toggle",label:"Toggle (On/Off)"},...V]}},callback:async({options:i})=>{const r=i.getPlainNumber("input"),o=a.state.audio?.channels??{},n=o[r]?.mixOption===e.Enums.AudioMixOption.On?e.Enums.AudioMixOption.Off:e.Enums.AudioMixOption.On,s=i.getRaw("option"),l="toggle"===s?n:s;await(t?.setClassicAudioMixerInputProps(r,{mixOption:l}))},learn:({options:e})=>{const t=(a.state.audio?.channels??{})[e.getPlainNumber("input")];return t?{...e.getJson(),option:t.mixOption}:void 0}},[gi.ClassicAudioResetPeaks]:{name:"Classic Audio: Reset peaks",options:{reset:{type:"dropdown",id:"reset",label:"Reset",default:"all",choices:[{id:"all",label:"All"},{id:"master",label:"Master"},{id:"monitor",label:"Monitor"},...o.choices]}},callback:async({options:e})=>{const i=e.getRaw("reset");if("all"===i)await(t?.setClassicAudioResetPeaks({all:!0}));else if("master"===i)await(t?.setClassicAudioResetPeaks({master:!0}));else if("monitor"===i)await(t?.setClassicAudioResetPeaks({monitor:!0}));else{const e=Number(i);await(t?.setClassicAudioResetPeaks({input:e}))}}},[gi.ClassicAudioMasterGain]:{name:"Classic Audio: Set master gain",options:{gain:{type:"number",label:"Fader Level (-60 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:6},...oi},callback:async({options:e})=>{await r.runForFadeOptions("audio.master.gain",async e=>{await(t?.setClassicAudioMixerMasterProps({gain:e}))},a.state.audio?.master?.gain,e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.audio?.master;return t?{...e.getJson(),gain:t.gain}:void 0}},[gi.ClassicAudioMasterGainDelta]:{name:"Classic Audio: Adjust master gain",options:{delta:ni,...oi},callback:async({options:e})=>{const i=Math.max(-60,a.state.audio?.master?.gain??-1/0);"number"==typeof i&&await r.runForFadeOptions("audio.master.gain",async e=>{await(t?.setClassicAudioMixerMasterProps({gain:e}))},i,i+e.getPlainNumber("delta"),e)}},[gi.ClassicAudioMasterPan]:{name:"Classic Audio: Set master pan",options:{balance:{type:"number",label:"Pan",id:"balance",range:!0,required:!0,default:0,step:1,min:-50,max:50},...oi},callback:async({options:e})=>{await r.runForFadeOptions("audio.master.pan",async e=>{await(t?.setClassicAudioMixerMasterProps({balance:e}))},a.state.audio?.master?.balance,e.getPlainNumber("balance"),e)},learn:({options:e})=>{const t=a.state.audio?.master;return t?{...e.getJson(),balance:t.balance}:void 0}},[gi.ClassicAudioMasterPanDelta]:{name:"Classic Audio: Adjust master pan",options:{delta:{type:"number",label:"Delta",id:"delta",default:1,max:50,min:-50},...oi},callback:async({options:e})=>{const i=a.state.audio?.master?.balance;"number"==typeof i&&await r.runForFadeOptions("audio.master.gain",async e=>{await(t?.setClassicAudioMixerMasterProps({balance:e}))},i,i+e.getPlainNumber("delta"),e)}}}}function dr(t,i,r,a){if(!i.fairlightAudio)return{[gi.FairlightAudioInputGain]:void 0,[gi.FairlightAudioInputGainDelta]:void 0,[gi.FairlightAudioInputDelay]:void 0,[gi.FairlightAudioInputDelayDelta]:void 0,[gi.FairlightAudioFaderGain]:void 0,[gi.FairlightAudioFaderGainDelta]:void 0,[gi.FairlightAudioMixOption]:void 0,[gi.FairlightAudioResetPeaks]:void 0,[gi.FairlightAudioResetSourcePeaks]:void 0,[gi.FairlightAudioMasterGain]:void 0,[gi.FairlightAudioMasterGainDelta]:void 0,[gi.FairlightAudioMonitorSolo]:void 0,[gi.FairlightAudioMonitorOutputGain]:void 0,[gi.FairlightAudioMonitorOutputGainDelta]:void 0,[gi.FairlightAudioMonitorMasterMuted]:void 0,[gi.FairlightAudioMonitorMasterGain]:void 0,[gi.FairlightAudioMonitorMasterGainDelta]:void 0,[gi.FairlightAudioMonitorTalkbackMuted]:void 0,[gi.FairlightAudioMonitorTalkbackGain]:void 0,[gi.FairlightAudioMonitorTalkbackGainDelta]:void 0,[gi.FairlightAudioMonitorSidetoneGain]:void 0,[gi.FairlightAudioMonitorSidetoneGainDelta]:void 0,[gi.FairlightAudioRouting]:void 0,[gi.FairlightAudioRoutingVariables]:void 0};const o=ii(i,a.state),n=ri(),s=ii(i,a.state,"delay");return{[gi.FairlightAudioInputGain]:{name:"Fairlight Audio: Set input gain",options:{input:o,source:n,gain:{type:"number",label:"Input Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:6},...oi},callback:async({options:e})=>{const i=e.getPlainNumber("input"),o=e.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=(n[i]?.sources??{})[o];await r.runForFadeOptions(`audio.${i}.${o}.gain`,async e=>{await(t?.setFairlightAudioMixerSourceProps(i,o,{gain:e}))},s?.properties?.gain,100*e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?{...e.getJson(),gain:i.properties.gain/100}:void 0}},[gi.FairlightAudioInputGainDelta]:{name:"Fairlight Audio: Adjust input gain",options:{input:o,source:n,delta:ni,...oi},callback:async({options:e})=>{const i=e.getPlainNumber("input"),o=e.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=(n[i]?.sources??{})[o];"number"==typeof s?.properties?.gain&&await r.runForFadeOptions(`audio.${i}.${o}.gain`,async e=>{await(t?.setFairlightAudioMixerSourceProps(i,o,{gain:e}))},s.properties.gain,s.properties.gain+100*e.getPlainNumber("delta"),e)}},[gi.FairlightAudioInputDelay]:s?{name:"Fairlight Audio: Set delay",options:{input:s,source:n,delay:{type:"number",label:"Delay (frames)",id:"gain",range:!0,required:!0,default:0,step:1,min:0,max:8}},callback:async({options:e})=>{const i=e.getPlainNumber("input"),r=e.getPlainString("source");await(t?.setFairlightAudioMixerSourceProps(i,r,{framesDelay:e.getPlainNumber("delay")}))},learn:({options:e})=>{const t=a.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?{...e.getJson(),delay:i.properties.framesDelay}:void 0}}:void 0,[gi.FairlightAudioInputDelayDelta]:s?{name:"Fairlight Audio: Adjust delay",options:{input:s,source:n,delay:{type:"number",label:"Adjustment (frames)",id:"gain",range:!0,required:!0,default:0,step:1,min:-8,max:8}},callback:async({options:e})=>{const i=e.getPlainNumber("input"),r=e.getPlainString("source"),o=e.getPlainNumber("delay"),n=a.state.fairlight?.inputs??{},s=(n[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")],l=s?.properties?.framesDelay;void 0!==l&&await(t?.setFairlightAudioMixerSourceProps(i,r,{framesDelay:l+o}))}}:void 0,[gi.FairlightAudioFaderGain]:{name:"Fairlight Audio: Set fader gain",options:{input:o,source:n,gain:{type:"number",label:"Fader Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:10},...oi},callback:async({options:e})=>{const i=e.getPlainNumber("input"),o=e.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=(n[i]?.sources??{})[o];await r.runForFadeOptions(`audio.${i}.${o}.faderGain`,async e=>{await(t?.setFairlightAudioMixerSourceProps(i,o,{faderGain:e}))},s?.properties?.faderGain,100*e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?{...e.getJson(),gain:i.properties.faderGain/100}:void 0}},[gi.FairlightAudioFaderGainDelta]:{name:"Fairlight Audio: Adjust fader gain",options:{input:o,source:n,delta:ni,...oi},callback:async({options:e})=>{const i=e.getPlainNumber("input"),o=e.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=(n[i]?.sources??{})[o];"number"==typeof s?.properties?.faderGain&&await r.runForFadeOptions(`audio.${i}.${o}.faderGain`,async e=>{await(t?.setFairlightAudioMixerSourceProps(i,o,{faderGain:e}))},s.properties.faderGain,s.properties.faderGain+100*e.getPlainNumber("delta"),e)}},[gi.FairlightAudioMixOption]:{name:"Fairlight Audio: Set input mix option",options:{input:o,source:n,option:{id:"option",label:"Mix option",type:"dropdown",default:"toggle",choices:[{id:"toggle",label:"Toggle (On/Off)"},...F]}},callback:async({options:i})=>{const r=i.getPlainNumber("input"),o=i.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=n[r]?.sources??{},l=s[o]?.properties?.mixOption===e.Enums.FairlightAudioMixOption.On?e.Enums.FairlightAudioMixOption.Off:e.Enums.FairlightAudioMixOption.On,u=i.getRaw("option"),c="toggle"===u?l:u;await(t?.setFairlightAudioMixerSourceProps(r,o,{mixOption:c}))},learn:({options:e})=>{const t=a.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?{...e.getJson(),option:i.properties.mixOption}:void 0}},[gi.FairlightAudioResetPeaks]:{name:"Fairlight Audio: Reset peaks",options:{reset:{type:"dropdown",id:"reset",label:"Reset",default:"all",choices:[{id:"all",label:"All"},{id:"master",label:"Master"}]}},callback:async({options:e})=>{const i=e.getPlainString("reset");"all"===i?await(t?.setFairlightAudioMixerResetPeaks({all:!0,master:!1})):"master"===i&&await(t?.setFairlightAudioMixerResetPeaks({master:!0,all:!1}))}},[gi.FairlightAudioResetSourcePeaks]:{name:"Fairlight Audio: Reset Source peaks",options:{input:o,source:n},callback:async({options:e})=>{const i=e.getPlainNumber("input"),r=e.getPlainString("source");await(t?.setFairlightAudioMixerSourceResetPeaks(i,r,{output:!0,dynamicsInput:!1,dynamicsOutput:!1}))}},[gi.FairlightAudioMasterGain]:{name:"Fairlight Audio: Set master gain",options:{gain:{type:"number",label:"Input Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:6},...oi},callback:async({options:e})=>{await r.runForFadeOptions("audio.master.gain",async e=>{await(t?.setFairlightAudioMixerMasterProps({faderGain:e}))},a.state.fairlight?.master?.properties?.faderGain,100*e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.fairlight?.master?.properties;return t?{...e.getJson(),gain:t.faderGain/100}:void 0}},[gi.FairlightAudioMasterGainDelta]:{name:"Fairlight Audio: Adjust master gain",options:{delta:ni,...oi},callback:async({options:e})=>{const i=a.state.fairlight?.master?.properties?.faderGain;"number"==typeof i&&await r.runForFadeOptions("audio.master.gain",async e=>{await(t?.setFairlightAudioMixerMasterProps({faderGain:e}))},i,i+100*e.getPlainNumber("delta"),e)}},[gi.FairlightAudioMonitorSolo]:i.fairlightAudio.monitor?{name:"Fairlight Audio: Solo source",options:{solo:{id:"solo",type:"dropdown",label:"State",default:"true",choices:x},input:o,source:n},callback:async({options:e})=>{const i=e.getPlainNumber("input"),r=e.getPlainString("source");let o;if("toggle"===e.getPlainString("solo")){const e=a.state.fairlight?.solo;if(e){const t=e.index===i&&e.source===r;o=!e.solo||!t}else o=!0}else o="true"===e.getPlainString("solo");await(t?.setFairlightAudioMixerMonitorSolo({solo:o,index:i,source:r}))}}:void 0,[gi.FairlightAudioMonitorOutputGain]:i.fairlightAudio.monitor?{name:"Fairlight Audio: Set Monitor/Headphone fader gain",options:{gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10},...oi},callback:async({options:e})=>{await r.runForFadeOptions("audio.monitor.faderGain",async e=>{await(t?.setFairlightAudioMixerMonitorProps({gain:e}))},a.state.fairlight?.monitor?.gain,100*e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.gain/100}:void 0}}:void 0,[gi.FairlightAudioMonitorOutputGainDelta]:i.fairlightAudio.monitor?{name:"Fairlight Audio: Adjust Monitor/Headphone fader gain",options:{delta:ni,...oi},callback:async({options:e})=>{const i=a.state.fairlight?.monitor?.gain;"number"==typeof i&&await r.runForFadeOptions("audio.monitor.faderGain",async e=>{await(t?.setFairlightAudioMixerMonitorProps({gain:e}))},i,i+100*e.getPlainNumber("delta"),e)}}:void 0,...pr(t,i,r,a),...mr(t,i,r,a),...br(t,i,r,a),...fr(t,i,0,a)}}function pr(e,t,i,r){return{[gi.FairlightAudioMonitorMasterMuted]:t.fairlightAudio?.monitor?{name:"Fairlight Audio: Monitor/Headphone master muted",options:{state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:x}},callback:async({options:t})=>{let i;i="toggle"===t.getPlainString("state")?!r.state.fairlight?.monitor?.inputMasterMuted:"true"===t.getPlainString("state"),await(e?.setFairlightAudioMixerMonitorProps({inputMasterMuted:i}))},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),state:t.inputMasterMuted?"true":"false"}:void 0}}:void 0,[gi.FairlightAudioMonitorMasterGain]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Set Monitor/Headphone master gain",options:{gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10},...oi},callback:async({options:t})=>{await i.runForFadeOptions("audio.monitor.inputMasterGain",async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputMasterGain:t}))},r.state.fairlight?.monitor?.inputMasterGain,100*t.getPlainNumber("gain"),t)},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputMasterGain/100}:void 0}}:void 0,[gi.FairlightAudioMonitorMasterGainDelta]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Adjust Monitor/Headphone master gain",options:{delta:ni,...oi},callback:async({options:t})=>{const a=r.state.fairlight?.monitor?.inputMasterGain;"number"==typeof a&&await i.runForFadeOptions("audio.monitor.inputMasterGain",async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputMasterGain:t}))},a,a+100*t.getPlainNumber("delta"),t)}}:void 0}}function mr(e,t,i,r){return{[gi.FairlightAudioMonitorTalkbackMuted]:t.fairlightAudio?.monitor?{name:"Fairlight Audio: Monitor/Headphone talkback muted",options:{state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:x}},callback:async({options:t})=>{let i;i="toggle"===t.getPlainString("state")?!r.state.fairlight?.monitor?.inputTalkbackMuted:"true"===t.getPlainString("state"),await(e?.setFairlightAudioMixerMonitorProps({inputTalkbackMuted:i}))},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),state:t.inputTalkbackMuted?"true":"false"}:void 0}}:void 0,[gi.FairlightAudioMonitorTalkbackGain]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Set Monitor/Headphone talkback gain",options:{gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10},...oi},callback:async({options:t})=>{await i.runForFadeOptions("audio.monitor.inputTalkbackGain",async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputTalkbackGain:t}))},r.state.fairlight?.monitor?.inputTalkbackGain,100*t.getPlainNumber("gain"),t)},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputTalkbackGain/100}:void 0}}:void 0,[gi.FairlightAudioMonitorTalkbackGainDelta]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Adjust Monitor/Headphone talkback gain",options:{delta:ni,...oi},callback:async({options:t})=>{const a=r.state.fairlight?.monitor?.inputTalkbackGain;"number"==typeof a&&await i.runForFadeOptions("audio.monitor.inputTalkbackGain",async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputTalkbackGain:t}))},a,a+100*t.getPlainNumber("delta"),t)}}:void 0}}function br(e,t,i,r){return{[gi.FairlightAudioMonitorSidetoneGain]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Set Monitor/Headphone sidetone gain",options:{gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10},...oi},callback:async({options:t})=>{await i.runForFadeOptions("audio.monitor.inputSidetoneGain",async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputSidetoneGain:t}))},r.state.fairlight?.monitor?.inputSidetoneGain,100*t.getPlainNumber("gain"),t)},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputSidetoneGain/100}:void 0}}:void 0,[gi.FairlightAudioMonitorSidetoneGainDelta]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Adjust Monitor/Headphone sidetone gain",options:{delta:ni,...oi},callback:async({options:t})=>{const a=r.state.fairlight?.monitor?.inputSidetoneGain;"number"==typeof a&&await i.runForFadeOptions("audio.monitor.inputSidetoneGain",async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputSidetoneGain:t}))},a,a+100*t.getPlainNumber("delta"),t)}}:void 0}}function fr(t,i,r,a){return i.fairlightAudio?.audioRouting?{[gi.FairlightAudioRouting]:{name:"Fairlight Audio: Audio Routing",description:"Requires firmware 9.4+",options:{destinations:ci(i,a.state),source:ui(i,a.state)},callback:async({options:i})=>{const r=i.getPlainNumber("source"),a=i.getRaw("destinations");if(!a||0===a.length)return;const o=[];for(const t of a){const i=new e.Commands.AudioRoutingOutputCommand(t);i.updateProps({sourceId:r}),o.push(i)}await(t?.sendCommands(o))}},[gi.FairlightAudioRoutingVariables]:{name:"Fairlight Audio: Audio Routing from variables",description:"Requires firmware 9.4+",options:{destinations:{type:"textinput",id:"destinations",label:"Destinations",default:"1-1",tooltip:'Comma/space separated list of destination IDs. IDs are formed as "output-channel". channel can be omitted when wanting "1/2" eg 1503-3_4 for "MADI 3 3/4"',useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"0",tooltip:'IDs are formed as "output-channel". channel can be omitted when wanting "1/2" eg 1503-3_4 for "MADI 3 3/4"',useVariables:!0}},callback:async({options:i})=>{const[r,a]=await Promise.all([i.getParsedString("source"),i.getParsedString("destinations")]);if(!a||!r)return;const o=de(r)??0,n=a.split(/[,| ]/).map(e=>de(e)).filter(e=>null!==e);if(0===n.length)return;const s=[];for(const t of n){const i=new e.Commands.AudioRoutingOutputCommand(t);i.updateProps({sourceId:o}),s.push(i)}await(t?.sendCommands(s))}}}:{[gi.FairlightAudioRouting]:void 0,[gi.FairlightAudioRoutingVariables]:void 0}}var gr,hr=__webpack_require__(4275);function yr(e,t,i){if(!e.enableCameraControl)return{[gi.CameraControlLensFocus]:void 0,[gi.CameraControlLensAutoFocus]:void 0,[gi.CameraControlLensIris]:void 0,[gi.CameraControlIncrementLensIris]:void 0,[gi.CameraControlLensAutoIris]:void 0,[gi.CameraControlLensOpticalImageStabilisation]:void 0,[gi.CameraControlLensZoom]:void 0};const r=t&&new hr.AtemCameraControlDirectCommandSender(t);return{[gi.CameraControlLensFocus]:{name:"Camera Control: Focus adjust",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},delta:{id:"delta",type:"textinput",label:"Delta",default:"0.1",tooltip:"Max range -1.0 - 1.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("delta");await(r?.lensFocus(t,i,!0))}},[gi.CameraControlLensAutoFocus]:{name:"Camera Control: Trigger Auto Focus",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");await(r?.lensTriggerAutoFocus(t))}},[gi.CameraControlLensIris]:{name:"Camera Control: Iris",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},isNormalised:{id:"isNormalised",type:"checkbox",label:"Normalised",default:!0},fStop:{id:"fStop",type:"textinput",label:"Value",default:"4",tooltip:"Max range -1.0 - 16.0",useVariables:!0,isVisibleExpression:"!$(options:isNormalised)"},normalised:{id:"normalised",type:"textinput",label:"Value",default:"0.5",tooltip:"Range 0.0 - 1.0",useVariables:!0,isVisibleExpression:"!$(options:isNormalised)"}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");if(e.getPlainBoolean("isNormalised")){const i=await e.getParsedNumber("normalised");await(r?.lensIrisNormalised(t,i))}else{const i=await e.getParsedNumber("fStop");await(r?.lensIrisFStop(t,i))}}},[gi.CameraControlIncrementLensIris]:{name:"Camera Control: Increment Iris",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},fStopIncrement:{id:"fStopIncrement",type:"textinput",label:"Value",default:"1",tooltip:"e.g. 1 or -1",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),a=await e.getParsedNumber("fStopIncrement");let o=(i.atemCameraState.get(t)?.lens.iris??0)+a;o>16?o=1:o<-1&&(o=0),await(r?.lensIrisFStop(t,o))}},[gi.CameraControlLensAutoIris]:{name:"Camera Control: Trigger Auto Iris",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");await(r?.lensTriggerAutoIris(t))}},[gi.CameraControlLensOpticalImageStabilisation]:{name:"Camera Control: Set Optical Image Stabilisation enabled",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:x}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");let a;if("toggle"===e.getPlainString("state")){const e=i.atemCameraState.get(t);a=!e?.lens?.opticalImageStabilisation}else a="true"===e.getPlainString("state");await(r?.lensEnableOpticalImageStabilisation(t,a))}},[gi.CameraControlLensZoom]:{name:"Camera Control: Zoom (Continuous)",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},zoom:{id:"zoom",type:"textinput",label:"Zoom speed",default:"0.0",tooltip:"Max range -1.0 - 1.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("zoom");await(r?.lensSetContinuousZoomSpeed(t,i))}}}}function Sr(e,t,i){if(!e.enableCameraControl)return{[gi.CameraControlDisplayColorBars]:void 0};const r=t&&new hr.AtemCameraControlDirectCommandSender(t);return{[gi.CameraControlDisplayColorBars]:{name:"Camera Control: Show Color Bars",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:x}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");let a;if("toggle"===e.getPlainString("state")){const e=i.atemCameraState.get(t);a=!e?.display?.colorBarEnable,console.log("camera",e,a)}else a="true"===e.getPlainString("state");await(r?.displayColorBars(t,a))}}}}function vr(e,t,i){if(!e.enableCameraControl)return{[gi.CameraControlVideoManualWhiteBalance]:void 0,[gi.CameraControlVideoIncrementManualWhiteBalance]:void 0,[gi.CameraControlVideoAutoWhiteBalance]:void 0,[gi.CameraControlVideoExposure]:void 0,[gi.CameraControlIncrementVideoExposure]:void 0,[gi.CameraControlVideoSharpeningLevel]:void 0,[gi.CameraControlVideoGain]:void 0,[gi.CameraControlIncrementVideoGain]:void 0,[gi.CameraControlVideoNdFilterStop]:void 0};const r=t&&new hr.AtemCameraControlDirectCommandSender(t);return{[gi.CameraControlVideoManualWhiteBalance]:{name:"Camera Control: White Balance",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},colorTemperature:{id:"colorTemperature",type:"textinput",label:"Color Temperature",default:"5600",useVariables:!0},tint:{id:"tint",type:"textinput",label:"Tint",default:"0",tooltip:"Range -50 to 50",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("colorTemperature"),a=await e.getParsedNumber("tint");await(r?.videoManualWhiteBalance(t,i,a))}},[gi.CameraControlVideoIncrementManualWhiteBalance]:{name:"Camera Control: Increment White Balance",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},colorTemperatureIncrement:{id:"colorTemperatureIncrement",type:"textinput",label:"Color Temperature Increment",default:"100",tooltip:"e.g. 100 or -100",useVariables:!0},tintIncrement:{id:"tintIncrement",type:"textinput",label:"Tint Increment",default:"0",tooltip:"e.g 10 or -10",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),a=await e.getParsedNumber("colorTemperatureIncrement"),o=await e.getParsedNumber("tintIncrement"),n=(i.atemCameraState.get(t)?.video.whiteBalance[0]??0)+a;let s=(i.atemCameraState.get(t)?.video.whiteBalance[1]??0)+o;s>50?s=50:s<-50&&(s=-50),await(r?.videoManualWhiteBalance(t,n,s))}},[gi.CameraControlVideoAutoWhiteBalance]:{name:"Camera Control: Trigger Auto White Balance",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");await(r?.videoTriggerAutoWhiteBalance(t))}},[gi.CameraControlVideoExposure]:{name:"Camera Control: Video Exposure",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},framerate:{id:"framerate",type:"textinput",label:"Framerate",default:"60",tooltip:"eg for 1/60 use 50",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("framerate");await(r?.videoExposureUs(t,Math.round(1e6/i)))}},[gi.CameraControlIncrementVideoExposure]:{name:"Camera Control: Increment Video Exposure",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},direction:{id:"direction",type:"dropdown",label:"Direction",choices:[{id:"up",label:"Up +"},{id:"down",label:"Down -"}],default:"up",tooltip:"Up for faster shutter speeds, down for slower."}},callback:async({options:e})=>{const t=[41667,4e4,33333,20833,2e4,16667,13333,11111,1e4,8333,6667,5556,4e3,2778,2e3,1379,1e3,690,500],a=await e.getParsedNumber("cameraId"),o="up"==e.getPlainString("direction")?1:-1,n=t.indexOf(i.atemCameraState.get(a)?.video.exposure??41667);let s=n+o;(s<0||s>t.length-1)&&(s=n),await(r?.videoExposureUs(a,t[s]))}},[gi.CameraControlVideoSharpeningLevel]:{name:"Camera Control: Video Sharpening Level",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},level:{id:"level",type:"dropdown",label:"Level",default:hr.VideoSharpeningLevel.Low,choices:[{id:hr.VideoSharpeningLevel.Off,label:"Off"},{id:hr.VideoSharpeningLevel.Low,label:"Low"},{id:hr.VideoSharpeningLevel.Medium,label:"Medium"},{id:hr.VideoSharpeningLevel.High,label:"High"}]}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=e.getPlainNumber("level");await(r?.videoSharpeningLevel(t,i))}},[gi.CameraControlVideoGain]:{name:"Camera Control: Video Gain",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},gain:{id:"gain",type:"textinput",label:"Value",default:"0",tooltip:"Range 0 - 128",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("gain");await(r?.videoGain(t,i))}},[gi.CameraControlIncrementVideoGain]:{name:"Camera Control: Increment Video Gain",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},increment:{id:"increment",type:"textinput",label:"Value",default:"10",tooltip:"e.g 10 or -10",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),a=await e.getParsedNumber("increment");let o=(i.atemCameraState.get(t)?.video.gain??0)+a;o>127?o=127:o<0&&(o=0),await(r?.videoGain(t,o))}},[gi.CameraControlVideoNdFilterStop]:{name:"Camera Control: ND Filter Stop",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},stop:{id:"stop",type:"textinput",label:"Value",default:"4",tooltip:"Range 0.0 - 15.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("stop");await(r?.videoNdFilterStop(t,i))}}}}function Pr(e,t,i){if(!e.enableCameraControl)return{[gi.CameraControlColorLiftAdjust]:void 0,[gi.CameraControlColorGammaAdjust]:void 0,[gi.CameraControlColorGainAdjust]:void 0,[gi.CameraControlColorOffsetAdjust]:void 0,[gi.CameraControlColorContrastAdjust]:void 0,[gi.CameraControlColorLumaMix]:void 0,[gi.CameraControlColorHueSaturationAdjust]:void 0};const r=t&&new hr.AtemCameraControlDirectCommandSender(t),a=(e,t)=>({name:e,options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},red:{id:"red",type:"textinput",label:"Red",default:"0.0",tooltip:"eg for -2.0 to 2.0",useVariables:!0},green:{id:"green",type:"textinput",label:"Green",default:"0.0",tooltip:"eg for -2.0 to 2.0",useVariables:!0},blue:{id:"blue",type:"textinput",label:"Blue",default:"0.0",tooltip:"eg for -2.0 to 2.0",useVariables:!0},luma:{id:"luma",type:"textinput",label:"Luma",default:"0.0",tooltip:"eg for -2.0 to 2.0",useVariables:!0}},callback:async({options:e})=>{const i=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("red"),a=await e.getParsedNumber("green"),o=await e.getParsedNumber("blue"),n=await e.getParsedNumber("luma");await t(i,r,a,o,n)}});return{[gi.CameraControlColorLiftAdjust]:a("Camera Control: Color Lift Adjust",async(e,t,i,a,o)=>r?.colorLiftAdjust(e,t,i,a,o)),[gi.CameraControlColorGammaAdjust]:a("Camera Control: Color Gamma Adjust",async(e,t,i,a,o)=>r?.colorGammaAdjust(e,t,i,a,o)),[gi.CameraControlColorGainAdjust]:a("Camera Control: Color Gain Adjust",async(e,t,i,a,o)=>r?.colorGainAdjust(e,t,i,a,o)),[gi.CameraControlColorOffsetAdjust]:a("Camera Control: Color Offset Adjust",async(e,t,i,a,o)=>r?.colorOffsetAdjust(e,t,i,a,o)),[gi.CameraControlColorContrastAdjust]:{name:"Camera Control: Contrast Adjust",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},contrast:{id:"contrast",type:"textinput",label:"Value",default:"1.0",tooltip:"eg for 0.0 to 1.0",useVariables:!0},pivot:{id:"pivot",type:"textinput",label:"Value",default:"1.0",tooltip:"eg for 0.0 to 1.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("contrast"),a=await e.getParsedNumber("pivot");await(r?.colorContrastAdjust(t,i,a))}},[gi.CameraControlColorLumaMix]:{name:"Camera Control: Color LumaMix",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},lumaMix:{id:"lumaMix",type:"textinput",label:"Value",default:"1.0",tooltip:"eg for 0.0 to 1.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("lumaMix");await(r?.colorLumaMix(t,i))}},[gi.CameraControlColorHueSaturationAdjust]:{name:"Camera Control: Color Hue & Saturation",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},hue:{id:"hue",type:"textinput",label:"Hue",default:"0.0",tooltip:"eg for -1.0 to 1.0",useVariables:!0},saturation:{id:"saturation",type:"textinput",label:"Saturation",default:"1.0",tooltip:"eg for 0.0 to 2.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("hue"),a=await e.getParsedNumber("saturation");await(r?.colorHueSaturationAdjust(t,i,a))}}}}function Ir(e){let t="00:00:00",i="00:00",r="00:00";return e&&(i=`${te(`${e.hours}`,"0",2)}:${te(`${e.minutes}`,"0",2)}`,t=`${i}:${te(`${e.seconds}`,"0",2)}`,r=`${60*e.hours+e.minutes}:${te(`${e.seconds}`,"0",2)}`),{hm:i,hms:t,ms:r}}function Cr(e){let t;return e&&(t={hours:0,minutes:0,seconds:0,frames:0,isDropFrame:!1},t.seconds=e%60,e=Math.floor(e/60),t.minutes=e%60,e=Math.floor(e/60),t.hours=e),Ir(t)}function kr(t,i,r){return t.config.pollTimecode?{[gi.Timecode]:{name:"Timecode: Set time",options:{time:{id:"time",type:"textinput",label:"Timecode",default:"00:00:00",tooltip:"HH:MM:SS",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedString("time"),[r,a,o,n]=t.split(/:|;/).map(e=>parseInt(e,10));if(isNaN(r)||isNaN(a)||isNaN(o))throw new Error("Invalid timecode");await(i?.setTime(r,a,o,isNaN(n)?0:n))},learn:({options:e})=>{const i=Cr(t.timecodeSeconds).hms;return{...e.getJson(),time:i}}},[gi.TimecodeMode]:{name:"Timecode: Set mode",options:{mode:{id:"mode",type:"dropdown",label:"Mode",choices:[{id:e.Enums.TimeMode.FreeRun,label:"Free run"},{id:e.Enums.TimeMode.TimeOfDay,label:"Time of Day"}],default:e.Enums.TimeMode.FreeRun}},callback:async({options:e})=>{const t=e.getPlainNumber("mode");await(i?.setTimeMode(t))},learn:({options:t})=>({...t.getJson(),mode:r.state.settings.timeMode??e.Enums.TimeMode.FreeRun})}}:{[gi.Timecode]:void 0,[gi.TimecodeMode]:void 0}}function wr(e,t,r,a){if(!e.enableCameraControl)return{[gi.CameraControlMediaRecordSingle]:void 0,[gi.CameraControlMediaRecordMultiple]:void 0};const o=r&&new hr.AtemCameraControlDirectCommandSender(r);return{[gi.CameraControlMediaRecordSingle]:{name:"Camera Control: Set Camera Recording",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:[{id:"true",label:"Recording"},{id:"false",label:"Stopped"},{id:"toggle",label:"Toggle"}]}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");let i;if("toggle"===e.getPlainString("state")){const e=a.atemCameraState.get(t);i=!e?.display?.colorBarEnable}else i="true"===e.getPlainString("state");i?await(o?.mediaTriggerSetRecording(t)):await(o?.mediaTriggerSetStopped(t))}},[gi.CameraControlMediaRecordMultiple]:{name:"Camera Control: Set Multiple Camera Recording",options:{cameraIds:{id:"cameraIds",type:"multidropdown",label:"Camera Id",choices:t.inputs.filter(e=>e.portType===i.InternalPortType.External).map(e=>{const t=a.state.inputs[e.id];return{label:t?.longName?`${t.longName} (${e.id})`:`Camera ${e.id}`,id:e.id}}),default:[1]},state:{id:"state",type:"dropdown",label:"State",default:"true",choices:[{id:"true",label:"Recording"},{id:"false",label:"Stopped"}]}},callback:async({options:e})=>{const t=e.getRaw("cameraIds");if(!t||!Array.isArray(t)||0===t.length)return;const i="true"===e.getPlainString("state");if(!r)return;const a=new hr.AtemCameraControlBatchCommandSender(r);for(const e of t)i?a.mediaTriggerSetRecording(e):a.mediaTriggerSetStopped(e);await a.sendBatch()}}}}function Er(e,i){return{[gr.ProgramTally]:{type:"boolean",name:"Tally: Program",description:"If the input specified has an active progam tally light, change style of the bank",options:{input:Pt(e,i.state,0)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=i.tally[e.getPlainNumber("input")];return!!t?.program}},[gr.PreviewTally]:{type:"boolean",name:"Tally: Preview",description:"If the input specified has an active preview tally light, change style of the bank",options:{input:Pt(e,i.state,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.tally[e.getPlainNumber("input")];return!!t?.preview}},[gr.AdvancedTally]:{type:"boolean",name:"Tally: Advanced",description:"Check if the input specified is active in one of the selected outputs/mixes",options:{inputIds:{id:"inputIds",label:"Mixes",type:"multidropdown",default:[10010],choices:J(q(e,i.state,"tally"))},input:Pt(e,i.state,0)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=e.getRaw("inputIds")??[];if(!Array.isArray(t))return!1;const r=e.getPlainNumber("input");for(const e of t){const t=i.tallyCache.get(Number(e));if(t&&t.lastVisibleInputs.includes(r))return!0}return!1},subscribe:({id:e,options:t})=>{const r=t.getRaw("inputIds")??[];if(Array.isArray(r))for(const t of r){if("number"!=typeof t)continue;const r=i.tallyCache.get(t);r?r.referencedFeedbackIds.add(e):i.tallyCache.set(t,{referencedFeedbackIds:new Set([e]),lastVisibleInputs:le(i.state,t)})}},unsubscribe:({id:e})=>{for(const t of i.tallyCache.values())t.referencedFeedbackIds.delete(e)}}}}!function(e){e.PreviewBG="preview_bg",e.PreviewVariables="previewVariables",e.PreviewBG2="preview_bg_2",e.PreviewBG3="preview_bg_3",e.PreviewBG4="preview_bg_4",e.ProgramBG="program_bg",e.ProgramVariables="programVariables",e.ProgramBG2="program_bg_2",e.ProgramBG3="program_bg_3",e.ProgramBG4="program_bg_4",e.AuxBG="aux_bg",e.AuxVariables="auxVariables",e.USKOnAir="usk_bg",e.USKType="usk_type",e.USKSource="usk_source",e.USKSourceVariables="usk_source_variables",e.USKKeyFrame="usk_keyframe",e.DSKOnAir="dsk_bg",e.DSKTie="dskTie",e.DSKSource="dsk_source",e.DSKSourceVariables="dsk_source_variables",e.Macro="macro",e.MacroLoop="macroloop",e.MVSource="mv_source",e.MVSourceVariables="mv_source_variables",e.MultiviewerLayout="multiviewerLayout",e.SSrcArtProperties="ssrc_art_properties",e.SSrcArtPropertiesVariables="ssrcArtPropertiesVariables",e.SSrcArtSource="ssrc_art_source",e.SSrcArtOption="ssrc_art_option",e.SSrcBoxOnAir="ssrc_box_enable",e.SSrcBoxSource="ssrc_box_source",e.SSrcBoxSourceVariables="ssrc_box_source_variables",e.SSrcBoxProperties="ssrc_box_properties",e.PreviewTransition="previewTransition",e.TransitionStyle="transitionStyle",e.TransitionSelection="transitionSelection",e.TransitionRate="transitionRate",e.InTransition="inTransition",e.MediaPlayerSource="mediaPlayerSource",e.MediaPlayerSourceVariables="mediaPlayerSourceVariables",e.MediaPoolPreview="mediaPoolPreview",e.MediaPoolPreviewVariables="mediaPoolPreviewVariables",e.FadeToBlackIsBlack="fadeToBlackIsBlack",e.FadeToBlackRate="fadeToBlackRate",e.ProgramTally="program_tally",e.PreviewTally="preview_tally",e.AdvancedTally="advanced_tally",e.StreamStatus="streamStatus",e.RecordStatus="recordStatus",e.RecordISO="recordISO",e.ClassicAudioGain="classicAudioGain",e.ClassicAudioMixOption="classicAudioMixOption",e.ClassicAudioMasterGain="classicAudioMasterGain",e.FairlightAudioFaderGain="fairlightAudioFaderGain",e.FairlightAudioInputGain="fairlightAudioInputGain",e.FairlightAudioMixOption="fairlightAudioMixOption",e.FairlightAudioMasterGain="fairlightAudioMasterGain",e.FairlightAudioMonitorSolo="fairlightAudioMonitorSolo",e.FairlightAudioMonitorOutputFaderGain="fairlightAudioMonitorFaderGain",e.FairlightAudioMonitorMasterMuted="fairlightAudioMonitorMasterMuted",e.FairlightAudioMonitorMasterGain="fairlightAudioMonitorMasterGain",e.FairlightAudioMonitorTalkbackMuted="fairlightAudioMonitorTalkbackMuted",e.FairlightAudioMonitorTalkbackGain="fairlightAudioMonitorTalkbackGain",e.FairlightAudioMonitorSidetoneGain="fairlightAudioMonitorSidetoneGain",e.FairlightAudioRouting="fairlightAudioRouting",e.FairlightAudioRoutingVariables="fairlightAudioRoutingVariables",e.TimecodeMode="timecodeMode"}(gr||(gr={}));var xr=__webpack_require__(360);function _r(e,t,i){return{type:e.type,id:e.id,controlId:e.controlId,feedbackId:e.feedbackId,options:new yi(e.options,t,i)}}function Ar(e){const{subscribe:t,unsubscribe:i,learn:r}=e;return{name:e.name,description:e.description,options:Object.entries(e.options).filter(e=>!!e[1]).map(([e,t])=>({...t,id:e})),subscribe:t?async(i,r)=>t(_r(i,r,e.options),r):void 0,unsubscribe:i?async(t,r)=>i(_r(t,r,e.options),r):void 0,learn:r?async(t,i)=>r(_r(t,i,e.options),i):void 0,learnTimeout:void 0}}function Tr(e,i){return{[gr.PreviewBG]:{type:"boolean",name:"ME: One ME preview source",description:"If the input specified is selected in preview on the M/E stage specified, change style of the bank",options:{mixeffect:_t(e,0),input:Pt(e,i.state,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect"));return t?.previewInput===e.getPlainNumber("input")},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),input:t.previewInput}:void 0}},[gr.PreviewVariables]:{type:"boolean",name:"ME: One ME preview source from variables",description:"If the input specified is selected in preview on the M/E stage specified, change style of the bank",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=await e.getParsedNumber("input"),a=ji(i.state,t);return a?.previewInput===r},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=ji(i.state,t);return r?{...e.getJson(),input:r.previewInput+""}:void 0}},[gr.PreviewBG2]:e.MEs>=2?{type:"boolean",name:"ME: Two ME preview sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:_t(e,1),input1:Pt(e,i.state,1),mixeffect2:_t(e,2),input2:Pt(e,i.state,2)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2"));return t?.previewInput===e.getPlainNumber("input1")&&r?.previewInput===e.getPlainNumber("input2")},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2"));return t&&r?{...e.getJson(),input1:t.previewInput,input2:r.previewInput}:void 0}}:void 0,[gr.PreviewBG3]:e.MEs>=3?{type:"boolean",name:"ME: Three ME preview sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:_t(e,1),input1:Pt(e,i.state,1),mixeffect2:_t(e,2),input2:Pt(e,i.state,2),mixeffect3:_t(e,3),input3:Pt(e,i.state,3)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2")),a=ji(i.state,e.getPlainNumber("mixeffect3"));return t?.previewInput===e.getPlainNumber("input1")&&r?.previewInput===e.getPlainNumber("input2")&&a?.previewInput===e.getPlainNumber("input3")},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2")),a=ji(i.state,e.getPlainNumber("mixeffect3"));return t&&r&&a?{...e.getJson(),input1:t.previewInput,input2:r.previewInput,input3:a.previewInput}:void 0}}:void 0,[gr.PreviewBG4]:e.MEs>=4?{type:"boolean",name:"ME: Four ME preview sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:_t(e,1),input1:Pt(e,i.state,1),mixeffect2:_t(e,2),input2:Pt(e,i.state,2),mixeffect3:_t(e,3),input3:Pt(e,i.state,3),mixeffect4:_t(e,4),input4:Pt(e,i.state,4)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2")),a=ji(i.state,e.getPlainNumber("mixeffect3")),o=ji(i.state,e.getPlainNumber("mixeffect4"));return t?.previewInput===e.getPlainNumber("input1")&&r?.previewInput===e.getPlainNumber("input2")&&a?.previewInput===e.getPlainNumber("input3")&&o?.previewInput===e.getPlainNumber("input4")},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2")),a=ji(i.state,e.getPlainNumber("mixeffect3")),o=ji(i.state,e.getPlainNumber("mixeffect4"));return t&&r&&a&&o?{...e.getJson(),input1:t.previewInput,input2:r.previewInput,input3:a.previewInput,input4:o.previewInput}:void 0}}:void 0}}function Mr(e,i){return{[gr.ProgramBG]:{type:"boolean",name:"ME: One ME program source",description:"If the input specified is selected in program on the M/E stage specified, change style of the bank",options:{mixeffect:_t(e,0),input:Pt(e,i.state,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect"));return t?.programInput===e.getPlainNumber("input")},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),input:t.programInput}:void 0}},[gr.ProgramVariables]:{type:"boolean",name:"ME: One ME program source from variables",description:"If the input specified is selected in program on the M/E stage specified, change style of the bank",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=await e.getParsedNumber("input"),a=ji(i.state,t);return a?.programInput===r},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=ji(i.state,t);return r?{...e.getJson(),input:r.programInput+""}:void 0}},[gr.ProgramBG2]:e.MEs>=2?{type:"boolean",name:"ME: Two ME program sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:_t(e,1),input1:Pt(e,i.state,1),mixeffect2:_t(e,2),input2:Pt(e,i.state,2)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2"));return t?.programInput===e.getPlainNumber("input1")&&r?.programInput===e.getPlainNumber("input2")},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2"));return t&&r?{...e.getJson(),input1:t.programInput,input2:r.programInput}:void 0}}:void 0,[gr.ProgramBG3]:e.MEs>=3?{type:"boolean",name:"ME: Three ME program sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:_t(e,1),input1:Pt(e,i.state,1),mixeffect2:_t(e,2),input2:Pt(e,i.state,2),mixeffect3:_t(e,3),input3:Pt(e,i.state,3)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2")),a=ji(i.state,e.getPlainNumber("mixeffect3"));return t?.programInput===e.getPlainNumber("input1")&&r?.programInput===e.getPlainNumber("input2")&&a?.programInput===e.getPlainNumber("input3")},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2")),a=ji(i.state,e.getPlainNumber("mixeffect3"));return t&&r&&a?{...e.getJson(),input1:t.programInput,input2:r.programInput,input3:a.programInput}:void 0}}:void 0,[gr.ProgramBG4]:e.MEs>=4?{type:"boolean",name:"ME: Four ME program sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:_t(e,1),input1:Pt(e,i.state,1),mixeffect2:_t(e,2),input2:Pt(e,i.state,2),mixeffect3:_t(e,3),input3:Pt(e,i.state,3),mixeffect4:_t(e,4),input4:Pt(e,i.state,4)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2")),a=ji(i.state,e.getPlainNumber("mixeffect3")),o=ji(i.state,e.getPlainNumber("mixeffect4"));return t?.programInput===e.getPlainNumber("input1")&&r?.programInput===e.getPlainNumber("input2")&&a?.programInput===e.getPlainNumber("input3")&&o?.programInput===e.getPlainNumber("input4")},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect1")),r=ji(i.state,e.getPlainNumber("mixeffect2")),a=ji(i.state,e.getPlainNumber("mixeffect3")),o=ji(i.state,e.getPlainNumber("mixeffect4"));return t&&r&&a&&o?{...e.getJson(),input1:t.programInput,input2:r.programInput,input3:a.programInput,input4:o.programInput}:void 0}}:void 0}}function Nr(e,i){return{[gr.FadeToBlackIsBlack]:{type:"boolean",name:"Fade to black: Active",description:"If the specified fade to black is active, change style of the bank",options:{mixeffect:_t(e,0),state:{type:"dropdown",label:"State",id:"state",default:"on",choices:[{id:"on",label:"On"},{id:"off",label:"Off"},{id:"fading",label:"Fading"}]}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect"));if(t&&t.fadeToBlack)switch(e.getPlainString("state")){case"off":return!t.fadeToBlack.isFullyBlack&&!t.fadeToBlack.inTransition;case"fading":return t.fadeToBlack.inTransition;default:return!t.fadeToBlack.inTransition&&t.fadeToBlack.isFullyBlack}return!1}},[gr.FadeToBlackRate]:{type:"boolean",name:"Fade to black: Rate",description:"If the specified fade to black rate matches, change style of the bank",options:{mixeffect:_t(e,0),rate:kt("Rate")},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect")),r=e.getPlainNumber("rate");return t?.fadeToBlack?.rate===r},learn:({options:e})=>{const t=ji(i.state,e.getPlainNumber("mixeffect"));return t?.fadeToBlack?{...e.getJson(),rate:t.fadeToBlack.rate}:void 0}}}}function Or(i,r){return i.media.players?{[gr.MediaPlayerSource]:{type:"boolean",name:"Media player: Source",description:"If the specified media player has the specified source, change style of the bank",options:{mediaplayer:ei(i),source:ti(i,r.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const i=r.state.media.players[t.getPlainNumber("mediaplayer")];return i?.sourceType===e.Enums.MediaSourceType.Still&&i?.stillIndex===t.getPlainNumber("source")||i?.sourceType===e.Enums.MediaSourceType.Clip&&i?.clipIndex===t.getPlainNumber("source")-Z},learn:({options:e})=>{const t=r.state.media.players[e.getPlainNumber("mediaplayer")];return t?{...e.getJson(),source:t.sourceType?t.stillIndex:t.clipIndex+Z}:void 0}},[gr.MediaPlayerSourceVariables]:{type:"boolean",name:"Media player: Source from variables",description:"If the specified media player has the specified source, change style of the bank",options:{mediaplayer:{id:"mediaplayer",type:"textinput",label:"Media Player",default:"1",useVariables:!0},isClip:i.media.clips>0?{type:"checkbox",id:"isClip",label:"Is clip",default:!1}:void 0,slot:{id:"slot",type:"textinput",label:"Slot",default:"1",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:t})=>{const[i,a]=await Promise.all([t.getParsedNumber("mediaplayer"),t.getParsedNumber("slot")]),o=t.getPlainBoolean("isClip"),n=r.state.media.players[i-1];return!o&&n?.sourceType===e.Enums.MediaSourceType.Still&&n?.stillIndex===a-1||!(!o||n?.sourceType!==e.Enums.MediaSourceType.Clip||n?.clipIndex!==a-1)},learn:async({options:e})=>{const t=await e.getParsedNumber("mediaplayer"),i=r.state.media.players[t-1];return i?{...e.getJson(),source:i.sourceType?i.stillIndex:i.clipIndex+Z}:void 0}}}:{[gr.MediaPlayerSource]:void 0,[gr.MediaPlayerSourceVariables]:void 0}}const Rr=[{id:"ignore",label:"Ignored"},{id:"single",label:"Single"},{id:"quad",label:"Quad"}];function $r(i,r){return i.MVs?{[gr.MVSource]:{type:"boolean",name:"Multiviewer: Window source",description:"If the specified MV window is set to the specified source, change style of the bank",options:{multiViewerId:Ft(i),windowIndex:Zt(i),source:Qt(i,r.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=Hi(r.state,e.getPlainNumber("multiViewerId"),e.getPlainNumber("windowIndex"));return t?.source===e.getPlainNumber("source")},learn:({options:e})=>{const t=Hi(r.state,e.getPlainNumber("multiViewerId"),e.getPlainNumber("windowIndex"));return t?{...e.getJson(),source:t.source}:void 0}},[gr.MVSourceVariables]:{type:"boolean",name:"Multiviewer: Window source from variables",description:"If the specified MV window is set to the specified source, change style of the bank",options:{multiViewerId:{type:"textinput",id:"multiViewerId",label:"MV",default:"1",useVariables:!0},windowIndex:{type:"textinput",id:"windowIndex",label:"Window #",default:"1",useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"1",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("multiViewerId")-1,i=await e.getParsedNumber("windowIndex")-1,a=await e.getParsedNumber("source"),o=Hi(r.state,t,i);return o?.source===a},learn:async({options:e})=>{const t=await e.getParsedNumber("multiViewerId")-1,i=await e.getParsedNumber("windowIndex")-1,a=Hi(r.state,t,i);return a?{...e.getJson(),source:a.source+""}:void 0}},[gr.MultiviewerLayout]:{type:"boolean",name:"Multiviewer: Layout",options:{multiViewerId:{type:"textinput",id:"multiViewerId",label:"MV",default:"1",useVariables:!0},topLeft:{id:"topLeft",type:"dropdown",label:"Top left",choices:Rr,default:"ignore"},topRight:{id:"topRight",type:"dropdown",label:"Top right",choices:Rr,default:"ignore"},bottomLeft:{id:"bottomLeft",type:"dropdown",label:"Bottom left",choices:Rr,default:"ignore"},bottomRight:{id:"bottomRight",type:"dropdown",label:"Bottom right",choices:Rr,default:"ignore"}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:i})=>{const a=await i.getParsedNumber("multiViewerId")-1,o=Wi(r.state,a),n=o?.properties?.layout??e.Enums.MultiViewerLayout.Default,s=(e,i)=>{switch(e){case"ignore":return!0;case"single":return 0==(n&i);case"quad":return(n&i)>0;default:return(0,t.assertNever)(e),!1}};return s(i.getPlainString("topLeft"),e.Enums.MultiViewerLayout.TopLeftSmall)&&s(i.getPlainString("topRight"),e.Enums.MultiViewerLayout.TopRightSmall)&&s(i.getPlainString("bottomLeft"),e.Enums.MultiViewerLayout.BottomLeftSmall)&&s(i.getPlainString("bottomRight"),e.Enums.MultiViewerLayout.BottomRightSmall)},learn:async({options:t})=>{const i=await t.getParsedNumber("multiViewerId")-1,a=Wi(r.state,i);if(a?.properties){const i=a.properties.layout,r=e=>i&e?"quad":"single";return{...t.getJson(),topLeft:r(e.Enums.MultiViewerLayout.TopLeftSmall),topRight:r(e.Enums.MultiViewerLayout.TopRightSmall),bottomLeft:r(e.Enums.MultiViewerLayout.BottomLeftSmall),bottomRight:r(e.Enums.MultiViewerLayout.BottomRightSmall)}}}}}:{[gr.MVSource]:void 0,[gr.MVSourceVariables]:void 0,[gr.MultiviewerLayout]:void 0}}var Dr;function Vr(e,i){return e.macros?{[gr.Macro]:{type:"boolean",name:"Macro: State",description:"If the specified macro is running or waiting, change style of the bank",options:{macroIndex:{type:"dropdown",label:"Macro Number (1-100)",id:"macroIndex",default:1,choices:W(e,i.state)},state:{type:"dropdown",label:"State",id:"state",default:Dr.IsWaiting,choices:[{id:Dr.IsRunning,label:"Is Running"},{id:Dr.IsWaiting,label:"Is Waiting"},{id:Dr.IsRecording,label:"Is Recording"},{id:Dr.IsUsed,label:"Is Used"}]}},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>{let t=e.getPlainNumber("macroIndex");if(!isNaN(t)){t-=1;const{macroPlayer:r,macroRecorder:a}=i.state.macro;switch(e.getPlainString("state")){case Dr.IsUsed:{const e=i.state.macro.macroProperties[t];return!!e?.isUsed}case Dr.IsRecording:return a.isRecording&&a.macroIndex===t;case Dr.IsRunning:return r.isRunning&&r.macroIndex===t;case Dr.IsWaiting:return r.isWaiting&&r.macroIndex===t}}return!1}},[gr.MacroLoop]:{type:"boolean",name:"Macro: Looping",description:"If the specified macro is looping, change style of the bank",options:{loop:{type:"checkbox",label:"Looping",id:"loop",default:!0}},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>e.getPlainBoolean("loop")===!!i.state.macro.macroPlayer.loop}}:{[gr.Macro]:void 0,[gr.MacroLoop]:void 0}}function Fr(e,i){return 0===e.outputs.length?{[gr.AuxBG]:void 0,[gr.AuxVariables]:void 0}:{[gr.AuxBG]:{type:"boolean",name:"Aux/Output: Source",description:"If the input specified is selected in the aux bus specified, change style of the bank",options:{aux:Vt(e),input:jt(e,i.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>i.state.video.auxilliaries[e.getPlainNumber("aux")]===e.getPlainNumber("input"),learn:({options:e})=>{const t=i.state.video.auxilliaries[e.getPlainNumber("aux")];return void 0!==t?{...e.getJson(),input:t}:void 0}},[gr.AuxVariables]:{type:"boolean",name:"Aux/Output: Source from variables",description:"If the input specified is selected in the aux bus specified, change style of the bank",options:{aux:{type:"textinput",id:"aux",label:"AUX",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("aux")-1,r=await e.getParsedNumber("input");return i.state.video.auxilliaries[t]===r},learn:async({options:e})=>{const t=await e.getParsedNumber("aux")-1,r=i.state.video.auxilliaries[t];return void 0!==r?{...e.getJson(),input:r+""}:void 0}}}}function Br(i,r){return i.recording?{[gr.RecordStatus]:{type:"boolean",name:"Recording: Active/Running",description:"If the record has the specified status, change style of the bank",options:{state:{id:"state",label:"State",type:"dropdown",choices:Object.entries(e.Enums.RecordingStatus).filter(([e,t])=>"number"==typeof t).map(([e,t])=>({id:t,label:e})),default:e.Enums.RecordingStatus.Recording}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.recording?.status?.state;return t===e.getPlainNumber("state")},learn:({options:e})=>r.state.recording?.status?{...e.getJson(),state:r.state.recording.status.state}:void 0},[gr.RecordISO]:{type:"boolean",name:"Recording: ISO enabled",description:"If ISO recording is enabled",options:{},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:()=>!!r.state.recording?.recordAllInputs}}:{[gr.RecordStatus]:void 0,[gr.RecordISO]:void 0}}function Lr(i,r){return i.streaming?{[gr.StreamStatus]:{type:"boolean",name:"Streaming: Active/Running",description:"If the stream has the specified status, change style of the bank",options:{state:{id:"state",label:"State",type:"dropdown",choices:Object.entries(e.Enums.StreamingStatus).filter(([e,t])=>"number"==typeof t).map(([e,t])=>({id:t,label:e})),default:e.Enums.StreamingStatus.Streaming}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.streaming?.status?.state;return t===e.getPlainNumber("state")},learn:({options:e})=>r.state.streaming?.status?{...e.getJson(),state:r.state.streaming.status.state}:void 0}}:{[gr.StreamStatus]:void 0}}function jr(e,i){return e.DSKs?{[gr.DSKOnAir]:{type:"boolean",name:"Downstream key: OnAir",description:"If the specified downstream keyer is onair, change style of the bank",options:{key:At(e)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return!!t?.onAir}},[gr.DSKTie]:{type:"boolean",name:"Downstream key: Tied",description:"If the specified downstream keyer is tied, change style of the bank",options:{key:At(e)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return!!t?.properties?.tie}},[gr.DSKSource]:{type:"boolean",name:"Downstream key: Fill source",description:"If the input specified is selected in the DSK specified, change style of the bank",options:{key:At(e),fill:Bt(e,i.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return t?.sources?.fillSource===e.getPlainNumber("fill")},learn:({options:e})=>{const t=Gi(i.state,e.getPlainNumber("key"));return t?.sources?{...e.getJson(),fill:t.sources.fillSource}:void 0}},[gr.DSKSourceVariables]:{type:"boolean",name:"Downstream key: Fill source from variables",description:"If the input specified is selected in the DSK specified, change style of the bank",options:{key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},fill:{type:"textinput",id:"fill",label:"Fill Source",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("key")-1,r=await e.getParsedNumber("fill"),a=Gi(i.state,t);return a?.sources?.fillSource===r},learn:async({options:e})=>{const t=await e.getParsedNumber("key")-1,r=Gi(i.state,t);return r?.sources?{...e.getJson(),fill:r.sources.fillSource+""}:void 0}}}:{[gr.DSKOnAir]:void 0,[gr.DSKTie]:void 0,[gr.DSKSource]:void 0,[gr.DSKSourceVariables]:void 0}}function Kr(e,i){return e.USKs?{[gr.USKOnAir]:{type:"boolean",name:"Upstream key: OnAir state",description:"If the specified upstream keyer is active, change style of the bank",options:{mixeffect:_t(e,0),key:Nt(e)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return!!t?.onAir}},[gr.USKType]:{type:"boolean",name:"Upstream key: Key type",description:"If the specified upstream keyer has the specified type, change style of the bank",options:{mixeffect:_t(e,0),key:Nt(e),type:Ct()},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.mixEffectKeyType===e.getPlainNumber("type")}},[gr.USKSource]:{type:"boolean",name:"Upstream key: Fill source",description:"If the input specified is selected in the USK specified, change style of the bank",options:{mixeffect:_t(e,0),key:Nt(e),fill:Bt(e,i.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.fillSource===e.getPlainNumber("fill")},learn:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?{...e.getJson(),fill:t.fillSource}:void 0}},[gr.USKSourceVariables]:{type:"boolean",name:"Upstream key: Fill source from variables",description:"If the input specified is selected in the USK specified, change style of the bank",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},fill:{type:"textinput",id:"fill",label:"Fill Source",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=await e.getParsedNumber("key")-1,a=await e.getParsedNumber("fill"),o=Ui(i.state,t,r);return o?.fillSource===a},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,r=await e.getParsedNumber("key")-1,a=Ui(i.state,t,r);return a?{...e.getJson(),fill:a.fillSource+""}:void 0}},[gr.USKKeyFrame]:e.DVEs?{type:"boolean",name:"Upstream key: Key frame",description:"If the USK specified is at the Key Frame specified, change style of the bank",options:{mixeffect:_t(e,0),key:Nt(e),keyframe:{type:"dropdown",id:"keyframe",label:"Key Frame",choices:$,default:$[0].id}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.flyProperties?.isAtKeyFrame===Number(e.getPlainNumber("keyframe"))},learn:({options:e})=>{const t=Ui(i.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.flyProperties?{...e.getJson(),keyframe:t.flyProperties.isAtKeyFrame}:void 0}}:void 0}:{[gr.USKOnAir]:void 0,[gr.USKType]:void 0,[gr.USKSource]:void 0,[gr.USKSourceVariables]:void 0,[gr.USKKeyFrame]:void 0}}function Ur(i,r){return{[gr.PreviewTransition]:{type:"boolean",name:"Transition: Preview",description:"If the specified transition is being previewed, change style of the bank",options:{mixeffect:_t(i,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=ji(r.state,e.getPlainNumber("mixeffect"));return!!t?.transitionPreview},learn:({options:e})=>{const t=ji(r.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),state:t.transitionPreview+""}:void 0}},[gr.TransitionStyle]:{type:"boolean",name:"Transition: Style",description:"If the specified transition style is active, change style of the bank",options:{mixeffect:_t(i,0),style:It(0===i.media.clips)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=ji(r.state,e.getPlainNumber("mixeffect"));return t?.transitionProperties.nextStyle===e.getPlainNumber("style")},learn:({options:e})=>{const t=ji(r.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),style:t.transitionProperties.nextStyle}:void 0}},[gr.TransitionSelection]:{type:"boolean",name:"Transition: Selection",description:"If the specified transition selection is active, change style of the bank",options:{mixeffect:_t(i,0),matchmethod:{id:"matchmethod",label:"Match method",type:"dropdown",default:"exact",choices:[{id:"exact",label:"Exact"},{id:"contains",label:"Contains"},{id:"not-contain",label:"Not Contain"}]},selection:Et(i)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=ji(r.state,e.getPlainNumber("mixeffect")),a=oe(i.USKs,e.getRaw("selection"));if(t)switch(e.getPlainString("matchmethod")){case"exact":return t.transitionProperties.nextSelection.join(",")===a.join(",");case"contains":return a.every(e=>t.transitionProperties.nextSelection.includes(e));case"not-contain":return!a.find(e=>t.transitionProperties.nextSelection.includes(e))}return!1}},[gr.TransitionRate]:{type:"boolean",name:"Transition: Rate",description:"If the specified transition rate is active, change style of the bank",options:{mixeffect:_t(i,0),style:It(!0),rate:kt("Transition Rate")},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const i=ji(r.state,t.getPlainNumber("mixeffect"));if(i?.transitionSettings){const r=t.getPlainNumber("style"),a=t.getPlainNumber("rate");switch(r){case e.Enums.TransitionStyle.MIX:return i.transitionSettings.mix?.rate===a;case e.Enums.TransitionStyle.DIP:return i.transitionSettings.dip?.rate===a;case e.Enums.TransitionStyle.WIPE:return i.transitionSettings.wipe?.rate===a;case e.Enums.TransitionStyle.DVE:return i.transitionSettings.DVE?.rate===a;case e.Enums.TransitionStyle.STING:}}return!1},learn:({options:t})=>{const i=ji(r.state,t.getPlainNumber("mixeffect"));if(i?.transitionSettings){switch(t.getPlainNumber("style")){case e.Enums.TransitionStyle.MIX:return{...t.getJson(),rate:i.transitionSettings.mix?.rate??1};case e.Enums.TransitionStyle.DIP:return{...t.getJson(),rate:i.transitionSettings.dip?.rate??1};case e.Enums.TransitionStyle.WIPE:return{...t.getJson(),rate:i.transitionSettings.wipe?.rate??1};case e.Enums.TransitionStyle.DVE:return{...t.getJson(),rate:i.transitionSettings.DVE?.rate??1};case e.Enums.TransitionStyle.STING:default:return}}}},[gr.InTransition]:{type:"boolean",name:"Transition: Active/Running",description:"If the specified transition is active, change style of the bank",options:{mixeffect:_t(i,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=ji(r.state,e.getPlainNumber("mixeffect"));return!!t?.transitionPosition?.inTransition}}}}function Gr(e,t,i,r=1){const a=e*i;return r&&(t=r*Math.round(t/r)),a===t}function zr(e,i){return e.SSrc?{[gr.SSrcArtProperties]:{type:"boolean",name:"Supersource: Art properties",description:"If the specified SuperSource art properties match, change style of the bank",options:{ssrcId:Ut(e),...Ht(e,i.state,!1)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,vt.hn)(i.state,r).properties,o=t.getRaw("properties");return!(!(a&&o&&Array.isArray(o))||o.includes("fill")&&a.artFillSource!==t.getPlainNumber("fill")||o.includes("key")&&a.artCutSource!==t.getPlainNumber("key")||o.includes("artOption")&&a.artOption!==t.getRaw("artOption")||o.includes("artPreMultiplied")&&a.artPreMultiplied!==t.getPlainBoolean("artPreMultiplied")||o.includes("artClip")&&!Gr(t.getPlainNumber("artClip"),a.artClip,10)||o.includes("artGain")&&!Gr(t.getPlainNumber("artGain"),a.artGain,10)||o.includes("artInvertKey")&&a.artInvertKey!==t.getPlainBoolean("artInvertKey"))},learn:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=i.state.video.superSources?.[r]?.properties;return a?{...t.getJson(),fill:a.artFillSource,key:a.artCutSource,artOption:a.artOption,artPreMultiplied:a.artPreMultiplied,artClip:a.artClip/10,artGain:a.artGain/10,artInvertKey:a.artInvertKey}:void 0}},[gr.SSrcArtPropertiesVariables]:{type:"boolean",name:"Supersource: Art sources from variables",description:"If the specified SuperSource art properties match, change style of the bank",options:{ssrcId:Ut(e),...qt()},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,vt.hn)(i.state,r).properties,o=t.getRaw("properties");if(!a||!o||!Array.isArray(o))return!1;const n=[],s=(e,t)=>n.push(t.then(t=>a[e]==t));o.includes("fill")&&s("artFillSource",t.getParsedNumber("fill")),o.includes("key")&&s("artCutSource",t.getParsedNumber("key"));const l=await Promise.all(n);for(const e of l)if(!e)return!1;return!0},learn:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=i.state.video.superSources?.[r]?.properties;return a?{...t.getJson(),fill:a.artFillSource+"",key:a.artCutSource+""}:void 0}},[gr.SSrcArtSource]:{type:"boolean",name:"Supersource: Art fill source",description:"If the specified SuperSource art fill is set to the specified source, change style of the bank",options:{ssrcId:Ut(e),source:Yt(e,i.state,"source","Fill Source")},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,vt.hn)(i.state,r);return a.properties?.artFillSource===t.getPlainNumber("source")},learn:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,vt.hn)(i.state,r);return a.properties?{...t.getJson(),source:a.properties.artFillSource}:void 0}},[gr.SSrcArtOption]:{type:"boolean",name:"Supersource: Art placement",description:"If the specified SuperSource art is placed in the foreground/background, change style of the bank",options:{ssrcId:Ut(e),artOption:Gt(!1)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,vt.hn)(i.state,r);return a.properties?.artOption===t.getRaw("artOption")},learn:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,vt.hn)(i.state,r);return a.properties?{...t.getJson(),artOption:a.properties.artOption}:void 0}},[gr.SSrcBoxSource]:{type:"boolean",name:"Supersource: Box source",description:"If the specified SuperSource box is set to the specified source, change style of the bank",options:{ssrcId:Ut(e),boxIndex:Kt(),source:Xt(e,i.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=zi(i.state,t.getPlainNumber("boxIndex"),r);return a?.source===t.getPlainNumber("source")},learn:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=zi(i.state,t.getPlainNumber("boxIndex"),r);return a?{...t.getJson(),source:a.source}:void 0}},[gr.SSrcBoxSourceVariables]:{type:"boolean",name:"Supersource: Box source from variables",description:"If the specified SuperSource box is set to the specified source, change style of the bank",options:{ssrcId:e.SSrc>1?{type:"textinput",id:"ssrcId",label:"Super Source",default:"1",useVariables:!0}:void 0,boxIndex:{type:"textinput",id:"boxIndex",label:"Box #",default:"1",useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"1",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(await t.getParsedNumber("ssrcId"))-1:0,a=await t.getParsedNumber("boxIndex")-1,o=await t.getParsedNumber("source"),n=zi(i.state,a,r);return n?.source===o},learn:async({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(await t.getParsedNumber("ssrcId"))-1:0,a=await t.getParsedNumber("boxIndex")-1,o=zi(i.state,a,r);return o?{...t.getJson(),source:o.source+""}:void 0}},[gr.SSrcBoxOnAir]:{type:"boolean",name:"Supersource: Box state",description:"If the specified SuperSource box is enabled, change style of the bank",options:{ssrcId:Ut(e),boxIndex:Kt()},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=zi(i.state,t.getPlainNumber("boxIndex"),r);return!(!a||!a.enabled)}},[gr.SSrcBoxProperties]:{type:"boolean",name:"Supersource: Box properties",description:"If the specified SuperSource box properties match, change style of the bank",options:{ssrcId:Ut(e),boxIndex:Kt(),...zt(e,i.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=zi(i.state,t.getPlainNumber("boxIndex"),r),o=t.getRaw("properties");if(!a||!o||!Array.isArray(o))return!1;if(o.includes("source")&&a.source!==t.getPlainNumber("source"))return!1;if(o.includes("size")&&!Gr(t.getPlainNumber("size"),a.size,1e3,10))return!1;if(o.includes("x")&&!Gr(t.getPlainNumber("x"),a.x,100))return!1;if(o.includes("y")&&!Gr(t.getPlainNumber("y"),a.y,100))return!1;if(o.includes("cropEnable")&&a.cropped!==t.getPlainBoolean("cropEnable"))return!1;if(a.cropped){if(o.includes("cropTop")&&!Gr(t.getPlainNumber("cropTop"),a.cropTop,1e3,10))return!1;if(o.includes("cropBottom")&&!Gr(t.getPlainNumber("cropBottom"),a.cropBottom,1e3,10))return!1;if(o.includes("cropLeft")&&!Gr(t.getPlainNumber("cropLeft"),a.cropLeft,1e3,10))return!1;if(o.includes("cropRight")&&!Gr(t.getPlainNumber("cropRight"),a.cropRight,1e3,10))return!1}return!0},learn:({options:t})=>{const r=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=t.getPlainNumber("boxIndex"),o=i.state.video.superSources?.[r]?.boxes[a];return o?{...t.getJson(),source:o.source,size:o.size/1e3,x:o.x/100,y:o.y/100,cropEnable:o.cropped,cropTop:o.cropTop/1e3,cropBottom:o.cropBottom/1e3,cropLeft:o.cropLeft/1e3,cropRight:o.cropRight/1e3}:void 0}}}:{[gr.SSrcArtProperties]:void 0,[gr.SSrcArtPropertiesVariables]:void 0,[gr.SSrcArtSource]:void 0,[gr.SSrcArtOption]:void 0,[gr.SSrcBoxSource]:void 0,[gr.SSrcBoxSourceVariables]:void 0,[gr.SSrcBoxOnAir]:void 0,[gr.SSrcBoxProperties]:void 0}}function Wr(e,i){if(!e.classicAudio)return{[gr.ClassicAudioGain]:void 0,[gr.ClassicAudioMixOption]:void 0,[gr.ClassicAudioMasterGain]:void 0};const r=ii(e,i.state);return{[gr.ClassicAudioGain]:{type:"boolean",name:"Classic Audio: Audio gain",description:"If the audio input has the specified gain, change style of the bank",options:{input:r,comparitor:ai(),gain:{type:"number",label:"Fader Level (-60 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:6}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=(i.state.audio?.channels??{})[e.getPlainNumber("input")];return!(!t||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t.gain))},learn:({options:e})=>{const t=(i.state.audio?.channels??{})[e.getPlainNumber("input")];return t?{...e.getJson(),gain:t.gain}:void 0}},[gr.ClassicAudioMixOption]:{type:"boolean",name:"Classic Audio: Mix option",description:"If the audio input has the specified mix option, change style of the bank",options:{input:r,option:{id:"option",label:"Mix option",type:"dropdown",default:V[0].id,choices:V}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=(i.state.audio?.channels??{})[e.getPlainNumber("input")];return t?.mixOption===e.getPlainNumber("option")},learn:({options:e})=>{const t=(i.state.audio?.channels??{})[e.getPlainNumber("input")];return t?{...e.getJson(),option:t.mixOption}:void 0}},[gr.ClassicAudioMasterGain]:{type:"boolean",name:"Classic Audio: Master gain",description:"If the audio master has the specified gain, change style of the bank",options:{comparitor:ai(),gain:{type:"number",label:"Fader Level (-60 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:6}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.audio?.master;return!(!t||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t.gain))},learn:({options:e})=>{const t=i.state.audio?.master;return t?{...e.getJson(),gain:t.gain}:void 0}}}}function Hr(e,i){if(!e.fairlightAudio)return{[gr.FairlightAudioInputGain]:void 0,[gr.FairlightAudioFaderGain]:void 0,[gr.FairlightAudioMixOption]:void 0,[gr.FairlightAudioMasterGain]:void 0,[gr.FairlightAudioMonitorSolo]:void 0,[gr.FairlightAudioMonitorOutputFaderGain]:void 0,[gr.FairlightAudioMonitorMasterMuted]:void 0,[gr.FairlightAudioMonitorMasterGain]:void 0,[gr.FairlightAudioMonitorTalkbackMuted]:void 0,[gr.FairlightAudioMonitorTalkbackGain]:void 0,[gr.FairlightAudioMonitorSidetoneGain]:void 0,[gr.FairlightAudioRouting]:void 0,[gr.FairlightAudioRoutingVariables]:void 0};const r=ii(e,i.state),a=ri();return{[gr.FairlightAudioInputGain]:{type:"boolean",name:"Fairlight Audio: Audio input gain",description:"If the audio input has the specified input gain, change style of the bank",options:{input:r,source:a,comparitor:ai(),gain:{type:"number",label:"Input Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:6}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return!(!r?.properties||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),r.properties.gain/100))},learn:({options:e})=>{const t=i.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?{...e.getJson(),gain:r.properties.gain/100}:void 0}},[gr.FairlightAudioFaderGain]:{type:"boolean",name:"Fairlight Audio: Audio fader gain",description:"If the audio input has the specified fader gain, change style of the bank",options:{input:r,source:a,comparitor:ai(),gain:{type:"number",label:"Fader Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return!(!r?.properties||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),r.properties.faderGain/100))},learn:({options:e})=>{const t=i.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?{...e.getJson(),gain:r.properties.faderGain/100}:void 0}},[gr.FairlightAudioMixOption]:{type:"boolean",name:"Fairlight Audio: Audio mix option",description:"If the audio input has the specified mix option, change style of the bank",options:{input:r,source:a,option:{id:"option",label:"Mix option",type:"dropdown",default:F[0].id,choices:F}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?.mixOption===e.getPlainNumber("option")},learn:({options:e})=>{const t=i.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?{...e.getJson(),option:r.properties.mixOption}:void 0}},[gr.FairlightAudioMasterGain]:{type:"boolean",name:"Fairlight Audio: Master fader gain",description:"If the master has the specified fader gain, change style of the bank",options:{comparitor:ai(),gain:{type:"number",label:"Fader Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.master?.properties;return!(!t||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t.faderGain/100))},learn:({options:e})=>{const t=i.state.fairlight?.master?.properties;return t?{...e.getJson(),gain:t.faderGain/100}:void 0}},[gr.FairlightAudioMonitorSolo]:e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Solo source",description:"If the specified source is soloed, change style of the bank",options:{nothing:{id:"nothing",type:"checkbox",label:"No solo",default:!1},input:{...r,isVisibleExpression:"!$(options:nothing)"},source:{...a,isVisibleExpression:"!$(options:nothing)"}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.solo;return e.getPlainBoolean("nothing")?!t?.solo:!!t?.solo&&t?.index===e.getPlainNumber("input")&&t?.source===e.getPlainString("source")},learn:({options:e})=>{const t=i.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?{...e.getJson(),gain:r.properties.faderGain/100}:void 0}}:void 0,[gr.FairlightAudioMonitorOutputFaderGain]:e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone Gain",description:"If the headphone/monitor has the specified fader gain, change style of the bank",options:{comparitor:ai(),gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.monitor?.gain;return!("number"!=typeof t||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t/100))},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.gain/100}:void 0}}:void 0,[gr.FairlightAudioMonitorMasterMuted]:e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone Master muted",description:"If the headphone master is muted, change style of the bank",options:{},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:()=>!!i.state.fairlight?.monitor?.inputMasterMuted}:void 0,[gr.FairlightAudioMonitorMasterGain]:"split"===e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone master Gain",description:"If the headphone/monitor has the specified master gain, change style of the bank",options:{comparitor:ai(),gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.monitor?.inputMasterGain;return!("number"!=typeof t||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t/100))},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputMasterGain/100}:void 0}}:void 0,[gr.FairlightAudioMonitorTalkbackMuted]:e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone Talkback muted",description:"If the headphone talkback is muted, change style of the bank",options:{},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:()=>!!i.state.fairlight?.monitor?.inputTalkbackMuted}:void 0,[gr.FairlightAudioMonitorTalkbackGain]:"split"===e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone talkback Gain",description:"If the headphone/monitor has the specified talkback gain, change style of the bank",options:{comparitor:ai(),gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.monitor?.inputTalkbackGain;return!("number"!=typeof t||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t/100))},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputTalkbackGain/100}:void 0}}:void 0,[gr.FairlightAudioMonitorSidetoneGain]:"split"===e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone sidetone Gain",description:"If the headphone/monitor has the specified sidetone gain, change style of the bank",options:{comparitor:ai(),gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.fairlight?.monitor?.inputSidetoneGain;return!("number"!=typeof t||!se(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t/100))},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputSidetoneGain/100}:void 0}}:void 0,...qr(e,i)}}function qr(e,t){return e.fairlightAudio?.audioRouting?{[gr.FairlightAudioRouting]:{type:"boolean",name:"Fairlight Audio: Audio Routing",description:"Requires firmware 9.4+",options:{destination:di(e,t.state),source:ui(e,t.state)},defaultStyle:{color:0,bgcolor:65280},callback:async({options:e})=>{const i=t.state.fairlight?.audioRouting?.outputs;if(!i)return!1;const r=e.getPlainNumber("source"),a=i[e.getPlainNumber("destination")];return a&&a.sourceId===r}},[gr.FairlightAudioRoutingVariables]:{type:"boolean",name:"Fairlight Audio: Audio Routing from variables",description:"Requires firmware 9.4+",options:{destination:{type:"textinput",id:"destination",label:"Destination",default:"1-1",tooltip:'IDs are formed as "output-channel". channel can be omitted when wanting "1/2" eg 1503-3_4 for "MADI 3 3/4"',useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"0",tooltip:'IDs are formed as "output-channel". channel can be omitted when wanting "1/2" eg 1503-3_4 for "MADI 3 3/4"',useVariables:!0}},defaultStyle:{color:0,bgcolor:65280},callback:async({options:e})=>{const i=t.state.fairlight?.audioRouting?.outputs;if(!i)return!1;const[r,a]=await Promise.all([e.getParsedString("source"),e.getParsedString("destination")]);if(!a||!r)return!1;const o=de(r)??0,n=de(a);if(!n)return!1;const s=i[n];return s&&s.sourceId===o}}}:{[gr.FairlightAudioRouting]:void 0,[gr.FairlightAudioRoutingVariables]:void 0}}function Jr(i,r,a){return i.pollTimecode?{[gr.TimecodeMode]:{type:"boolean",name:"Timecode: Mode",description:"If the timecode mode is as specified",options:{mode:{id:"mode",type:"dropdown",label:"Mode",choices:[{id:e.Enums.TimeMode.FreeRun,label:"Free run"},{id:e.Enums.TimeMode.TimeOfDay,label:"Time of Day"}],default:e.Enums.TimeMode.FreeRun}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>a.state.settings.timeMode===e.getPlainNumber("mode"),learn:({options:t})=>({...t.getJson(),mode:a.state.settings.timeMode??e.Enums.TimeMode.FreeRun})}}:{[gr.TimecodeMode]:void 0}}!function(e){e.IsRunning="isRunning",e.IsWaiting="isWaiting",e.IsRecording="isRecording",e.IsUsed="isUsed"}(Dr||(Dr={}));const Yr={crop:{id:"crop",type:"dropdown",label:"Crop",default:"none",choices:[{id:"none",label:"None"},{id:"left",label:"Left"},{id:"center",label:"Center"},{id:"right",label:"Right"}]},position:{id:"position",type:"dropdown",label:"Position",default:"center",choices:[{id:"top",label:"Top"},{id:"center",label:"Center"},{id:"bottom",label:"Bottom"}],isVisibleExpression:"$(options:crop) === 'none'"}};function Xr(e,t){return e.media.players?{[gr.MediaPoolPreview]:{type:"advanced",name:"Media pool: Preview image",description:"Preview of the specified media pool slot",options:{source:ti(e,t.state),...Yr},callback:async({options:e,image:i})=>{const r=Zr(e.getPlainNumber("source"));if(!i)return{};const a={crop:e.getPlainString("crop"),position:e.getPlainString("position"),buttonHeight:i.height,buttonWidth:i.width};return Qr(t,a,r)},subscribe:({id:e,options:i})=>{const r=Zr(i.getPlainNumber("source"));t.mediaPoolCache.subscribe(r,e)},unsubscribe:({id:e})=>{t.mediaPoolCache.unsubscribe(e)}},[gr.MediaPoolPreviewVariables]:{type:"advanced",name:"Media pool: Preview image from variables",description:"Preview of the specified media pool slot",options:{isClip:e.media.clips>0?{type:"checkbox",id:"isClip",label:"Is clip",default:!1,tooltip:"If slot includes a S or C prefix, that will override this setting"}:void 0,slot:{id:"slot",type:"textinput",label:"Slot",default:"1",useVariables:{local:!0}},...Yr},callback:async({options:i,image:r})=>{if(!r)return{};let a=e.media.clips>0&&i.getPlainBoolean("isClip"),o=await i.getParsedString("slot");if(o.startsWith("S"))a=!1,o=o.substring(1);else if(o.startsWith("C")){if(e.media.clips>0)return{};a=!0,o=o.substring(1)}const n={slot:Number(o)-1,isClip:a,frameIndex:0},s={crop:i.getPlainString("crop"),position:i.getPlainString("position"),buttonHeight:r.height,buttonWidth:r.width};return Qr(t,s,n)},subscribe:async({id:i,options:r})=>{t.mediaPoolCache.subscribe({slot:await r.getParsedNumber("slot")-1,isClip:e.media.clips>0&&r.getPlainBoolean("isClip"),frameIndex:0},i)},unsubscribe:async({id:e})=>{t.mediaPoolCache.unsubscribe(e)}}}:{[gr.MediaPoolPreview]:void 0,[gr.MediaPoolPreviewVariables]:void 0}}async function Qr(e,t,i){const r=await e.mediaPoolCache.getPreviewImage(i,t);return r||(e.mediaPoolCache.ensureLoaded(i),e.mediaPoolCache.isSlotOccupied(i)?{text:"Loading...",size:"auto",bgcolor:0,color:16777215}:{text:"Empty",size:"auto",bgcolor:0,color:16777215})}function Zr(e){const t=e>=Z;return{slot:t?e-Z:e,isClip:t,frameIndex:0}}function ea(i){return i.streaming?[{name:"Streaming & Recording",presets:{streaming_toggle:{name:"Stream",type:"button",style:{text:"Stream\\n$(atem:stream_duration_hm)",size:"18",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.StreamStatus,options:{state:e.Enums.StreamingStatus.Streaming},style:{bgcolor:(0,t.combineRgb)(0,255,0),color:(0,t.combineRgb)(0,0,0)}},{feedbackId:gr.StreamStatus,options:{state:e.Enums.StreamingStatus.Stopping},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}},{feedbackId:gr.StreamStatus,options:{state:e.Enums.StreamingStatus.Connecting},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.StreamStartStop,options:{stream:"toggle"}}],up:[]}]}}}]:[]}function ta(i){return i.recording?[{name:"Streaming & Recording",presets:{recording_toggle:{name:"Record",type:"button",style:{text:"Record\\n$(atem:record_duration_hm)",size:"18",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.RecordStatus,options:{state:e.Enums.RecordingStatus.Recording},style:{bgcolor:(0,t.combineRgb)(0,255,0),color:(0,t.combineRgb)(0,0,0)}},{feedbackId:gr.RecordStatus,options:{state:e.Enums.RecordingStatus.Stopping},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.RecordStartStop,options:{record:"toggle"}}],up:[]}]}}}]:[]}function ia(e){return{actionId:String(e.actionId),headline:void 0,options:e.options,delay:e.delay}}function ra(e){const t={name:void 0,up:e.up.map(ia),down:e.down.map(ia),rotate_left:e.rotate_left?.map(ia),rotate_right:e.rotate_right?.map(ia)},i=Object.keys(e).map(e=>Number(e)).filter(e=>!isNaN(e));for(const r of i){const i=e[r];i&&(t[r]=Array.isArray(i)?i.map(ia):{options:i.options,actions:i.actions.map(ia)})}return t}function aa(e,t){return{type:e.type,name:e.name,category:t.name,style:e.style,previewStyle:e.previewStyle,options:e.options,feedbacks:e.feedbacks.map(e=>({feedbackId:String(e.feedbackId),headline:void 0,options:e.options,style:e.style,isInverted:e.isInverted})),steps:e.steps.map(ra)}}function oa(e,i,r){const a=[];for(let o=0;o<e.MEs;++o){const e={name:`Fade to black (M/E ${o+1})`,presets:{[`ftb_auto_${o}`]:{name:"Auto fade",type:"button",style:{text:"FTB Auto",size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.FadeToBlackIsBlack,options:{mixeffect:o,state:"off"},style:{bgcolor:(0,t.combineRgb)(0,255,0),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:gr.FadeToBlackIsBlack,options:{mixeffect:o,state:"on"},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:gr.FadeToBlackIsBlack,options:{mixeffect:o,state:"fading"},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.FadeToBlackAuto,options:{mixeffect:o}}],up:[]}]}}};for(const a of r)e.presets[`ftb_rate_${o}_${a}`]={name:`Rate ${a}`,type:"button",style:{text:`Rate ${a}`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.FadeToBlackRate,options:{mixeffect:o,rate:a},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.FadeToBlackRate,options:{mixeffect:o,rate:a}}],up:[]}]};a.push(e)}return a}function na(e,i){const r=[];for(let a=0;a<e.media.players;a++){const o={name:`Mediaplayer ${a+1}`,presets:{}};for(let r=0;r<e.media.clips;r++)o.presets[`mediaplayer_clip_${a}_${r}`]={name:`Set Mediaplayer ${a+1} source to clip ${r+1}`,type:"button",style:{text:`MP ${a+1} Clip ${r+1}`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.MediaPlayerSource,options:{mediaplayer:a,source:r+Z},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.MediaPlayerSource,options:{mediaplayer:a,source:r+Z}}],up:[]}]};for(let r=0;r<e.media.stills;r++)o.presets[`mediaplayer_still_${a}_${r}`]={name:`Set Mediaplayer ${a+1} source to still ${r+1}`,type:"button",style:{text:`MP ${a+1} Still ${r+1}`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.MediaPlayerSource,options:{mediaplayer:a,source:r},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.MediaPlayerSource,options:{mediaplayer:a,source:r}}],up:[]}]};r.push(o)}return r}function sa(e,i,r,a){const o=[];for(let n=0;n<e.SSrc;n++){const e={name:`SSrc ${n+1} Boxes`,presets:{}};o.push(e);for(let s=0;s<4;s++){e.presets[`ssrc_box_onair_${n}_${s}`]={name:`Toggle SuperSource ${n+1} Box ${s+1} visibility`,type:"button",style:{text:`Box ${s+1}`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.SSrcBoxOnAir,options:{ssrcId:n,boxIndex:s},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.SuperSourceBoxOnAir,options:{ssrcId:n,onair:"toggle",boxIndex:s}}],up:[]}]};const l={name:`SSrc ${n+1} Box ${s+1}`,presets:{}};o.push(l);for(const e of a)l.presets[`ssrc_box_src_${n}_${s}_${e.id}`]={name:`Set SuperSource ${n+1} Box ${s+1} to source ${e.shortName}`,type:"button",style:{text:`$(atem:${r}${e.id})`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.SSrcBoxSource,options:{ssrcId:n,source:e.id,boxIndex:s},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.SuperSourceBoxSource,options:{ssrcId:n,source:e.id,boxIndex:s}}],up:[]}]}}}return o}function la(e,i,r,a){const o=[];for(let n=0;n<e.MVs;n++){const s=e.multiviewerFullGrid?0:2,l=e.multiviewerFullGrid?16:10;for(let u=s;u<l;u++){const s={name:`MV ${n+1} Window ${u+1}`,presets:{}};o.push(s);for(const o of q(e,i,"mv"))s.presets[`mv_win_src_${n}_${u}_${o.id}`]={name:`Set MV ${n+1} Window ${u+1} to source ${o.shortName}`,type:"button",style:{text:`$(atem:${a}${o.id})`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.MVSource,options:{multiViewerId:n,source:o.id,windowIndex:u},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.MultiviewerWindowSource,options:{multiViewerId:n,source:o.id,windowIndex:u}}],up:[]}]}}}return o}function ua(e){const i=[],r={name:"MACROS",presets:{}};i.push(r);for(let i=0;i<e.macros;i++)r.presets[`macro_run_${i}`]={name:`Run button for macro ${i+1}`,type:"button",style:{text:`$(atem:macro_${i+1})`,size:"auto",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.Macro,options:{macroIndex:i+1,state:Dr.IsUsed},style:{bgcolor:(0,t.combineRgb)(0,0,238),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:gr.Macro,options:{macroIndex:i+1,state:Dr.IsRunning},style:{bgcolor:(0,t.combineRgb)(0,238,0),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:gr.Macro,options:{macroIndex:i+1,state:Dr.IsWaiting},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:gr.Macro,options:{macroIndex:i+1,state:Dr.IsRecording},style:{bgcolor:(0,t.combineRgb)(238,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:gi.MacroRun,options:{macro:i+1,action:"runContinue"}}],up:[]}]};return i}function ca(e,i,r,a){const o=[];for(let n=0;n<e.MEs;++n){const e={name:`Preview (M/E ${n+1})`,presets:{}},s={name:`Program (M/E ${n+1})`,presets:{}};o.push(e,s);for(const o of a)e.presets[`preview_me_${n}_${o.id}`]={name:`Preview button for ${o.shortName}`,type:"button",style:{text:`$(atem:${r}${o.id})`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.PreviewBG,options:{input:o.id,mixeffect:n},style:{bgcolor:(0,t.combineRgb)(0,255,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:gi.Preview,options:{mixeffect:n,input:o.id}}],up:[]}]},s.presets[`program_me_${n}_${o.id}`]={name:`Program button for ${o.shortName}`,type:"button",style:{text:`$(atem:${r}${o.id})`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.ProgramBG,style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)},options:{input:o.id,mixeffect:n}}],steps:[{down:[{actionId:gi.Program,options:{mixeffect:n,input:o.id}}],up:[]}]}}return o}function da(e){let t=[];t.push([!0]),t.push([!1]);for(let i=0;i<e;i++){const e=[];for(const i of t)e.push([...i,!1]),e.push([...i,!0]);t=e}return t}function pa(e,i,r){const a=[];for(let o=0;o<e.MEs;++o){const n={name:`Transitions (M/E ${o+1})`,presets:{}};a.push(n),n.presets[`transition_preview_me_${o}`]={name:"PREVIEW",type:"button",style:{text:"PREV TRANS",size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.PreviewTransition,options:{mixeffect:o},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:gi.PreviewTransition,options:{mixeffect:o+1+"",state:"toggle"}}],up:[]}]},n.presets[`transition_cut_me_${o}`]={name:"CUT",type:"button",style:{text:"CUT",size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.InTransition,options:{mixeffect:o},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:gi.Cut,options:{mixeffect:o}}],up:[]}]},n.presets[`transition_auto_me_${o}`]={name:"AUTO",type:"button",style:{text:"AUTO",size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.InTransition,options:{mixeffect:o},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:gi.Auto,options:{mixeffect:o}}],up:[]}]};for(const e of B())n.presets[`transition_style_me_${o}_${e.id}`]={name:`Transition style ${e.label}`,type:"button",style:{text:e.label,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.TransitionStyle,options:{mixeffect:o,style:e.id},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.TransitionStyle,options:{mixeffect:o,style:e.id}}],up:[]}]};for(const e of B(!0))for(const a of r)n.presets[`transition_rate_${o}_${e.id}_${a}`]={name:`Transition ${e.label} rate ${a}`,type:"button",style:{text:`${e.label} ${a}`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.TransitionRate,options:{mixeffect:o,style:e.id,rate:a},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.TransitionRate,options:{mixeffect:o,style:e.id,rate:a}}],up:[]}]};for(const r of da(e.USKs)){const a=r[0]?["BG"]:[],s=r[0]?["background"]:[];for(let t=0;t<e.USKs;t++)r[t+1]&&(a.push(`K${t+1}`),s.push(`key${t}`));if(0===oe(e.USKs,s).length)continue;const l=a.join(" & ");n.presets[`transition_selection_${o}_${l.trim()}`]={name:`Transition Selection ${l.trim()}`,type:"button",style:{text:l.trim(),size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.TransitionSelection,options:{mixeffect:o,matchmethod:"contains",selection:s},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.TransitionSelection,options:{mixeffect:o,selection:s}}],up:[]}]}}}return a}function ma(e,i,r,a){const o=[];for(const n of e.outputs){const s={name:n.name,presets:{}};o.push(s);for(const o of q(e,i,"aux"))s.presets[`aux_${n.id}_${o.id}`]={name:`${n.name} button for ${o.shortName}`,type:"button",style:{text:`$(atem:${a}${o.id})`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.AuxBG,options:{input:o.id,aux:n.id},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.Aux,options:{aux:n.id,input:o.id}}],up:[]}]}}return o}function ba(i,r,a,o){const n=[],s={name:"KEYs OnAir",presets:{}},l={name:"KEYs Next",presets:{}},u={name:"KEYs Fly",presets:{}},c={name:"KEYs Type",presets:{}};n.push(s,l,u,c);for(let d=0;d<i.MEs;++d)for(let p=0;p<i.USKs;++p){s.presets[`keys_onair_me_${d}_${p}`]={name:`Toggle upstream M/E ${d+1} KEY ${p+1} OnAir`,type:"button",style:{text:"KEY "+(p+1),size:"24",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.USKOnAir,options:{key:p,mixeffect:d},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:gi.USKOnAir,options:{onair:"toggle",key:p,mixeffect:d}}],up:[]}]},l.presets[`keys_next_me_${d}_${p}`]={name:`Toggle upstream M/E ${d+1} KEY ${p+1} Next`,type:"button",style:{text:"KEY "+(p+1),size:"24",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.TransitionSelection,options:{mixeffect:d,matchmethod:"contains",selection:["key"+p]},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.TransitionSelectionComponent,options:{mixeffect:d,component:p+1,mode:"toggle"}}],up:[]}]};const i={name:`M/E ${d+1} Key ${p+1}`,presets:{}};n.push(i);for(const e of o)i.presets[`key_src_${d}_${p}_${e.id}`]={name:`M/E ${d+1} KEY ${p+1} source ${e.shortName}`,type:"button",style:{text:`$(atem:${a}${e.id})`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.USKSource,options:{fill:e.id,key:p,mixeffect:d},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.USKSource,options:{fill:e.id,cut:e.id+1,key:p,mixeffect:d}}],up:[]}]};for(const i of O){let a;switch(i.id){case e.Enums.FlyKeyKeyFrame.A:a=e.Enums.IsAtKeyFrame.A;break;case e.Enums.FlyKeyKeyFrame.B:a=e.Enums.IsAtKeyFrame.B;break;case e.Enums.FlyKeyKeyFrame.Full:a=e.Enums.IsAtKeyFrame.RunToInfinite;break;default:(0,t.assertNever)(i.id);continue}u.presets[`key_fly_me_${d}_${p}_${i.id}`]={name:`Fly M/E ${d+1} KEY ${p+1} to ${i.label}`,type:"button",style:{text:`Fly to ${i.label}`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.USKKeyFrame,options:{mixeffect:d,key:p,keyframe:a},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.USKFly,options:{mixeffect:d,key:p,keyframe:i.id}}],up:[]}]}}const m=L();for(const e of m)c.presets[`key_fly_me_${d}_${p}_type_${e.id}`]={name:`M/E ${d+1} KEY ${p+1} to ${e.label}`,type:"button",style:{text:`${e.label}`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.USKType,options:{mixeffect:d,key:p,type:e.id},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.USKType,options:{mixeffect:d,key:p,type:e.id}}],up:[]}]}}return n}function fa(e,i,r,a){const o=[],n={name:"DSK KEYs OnAir",presets:{}},s={name:"DSK KEYs Next",presets:{}};o.push(n,s);for(let l=0;l<e.DSKs;++l){n.presets[`dsk_onair_${l}`]={name:`Toggle downstream KEY ${l+1} OnAir`,type:"button",style:{text:`DSK ${l+1}`,size:"24",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.DSKOnAir,options:{key:l},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:gi.DSKOnAir,options:{onair:"toggle",key:l}}],up:[]}]},s.presets[`dsk_next_${l}`]={name:`Toggle downstream KEY ${l+1} Next`,type:"button",style:{text:`DSK ${l+1}`,size:"24",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.DSKTie,options:{key:l},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.DSKTie,options:{state:"toggle",key:l}}],up:[]}]};const e={name:`DSK ${l+1}`,presets:{}};o.push(e);for(const o of a)e.presets[`dsk_src_${l}_${o.id}`]={name:`DSK ${l+1} source ${o.shortName}`,type:"button",style:{text:`$(atem:${r}${o.id})`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:gr.DSKSource,options:{fill:o.id,key:l},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:gi.DSKSource,options:{fill:o.id,cut:o.id+1,key:l}}],up:[]}]}}return o}const ga=[12,15,25,30,37,45,50,60];function ha(e,t){return Math.round(e*t)/t}function ya(e,t,i){i[`camera_${t.cameraId}_focus`]=ha(t.lens.focus,1e3),i[`camera_${t.cameraId}_iris`]=ha(t.lens.iris,1e3),i[`camera_${t.cameraId}_ois`]=t.lens.opticalImageStabilisation?1:0,i[`camera_${t.cameraId}_wb_temp`]=t.video.whiteBalance[0],i[`camera_${t.cameraId}_wb_tint`]=t.video.whiteBalance[1],i[`camera_${t.cameraId}_exposure_us`]=t.video.exposure,i[`camera_${t.cameraId}_sharpening`]=t.video.videoSharpeningLevel,i[`camera_${t.cameraId}_shutter_speed`]=t.video.shutterSpeed,i[`camera_${t.cameraId}_gain`]=t.video.gain,i[`camera_${t.cameraId}_nd_filter`]=t.video.ndFilterStop,i[`camera_${t.cameraId}_show_color_bars`]=t.display.colorBarEnable?1:0;const r=(e,r)=>{i[`camera_${t.cameraId}_color_${e}_red`]=ha(r.red,1e3),i[`camera_${t.cameraId}_color_${e}_green`]=ha(r.green,1e3),i[`camera_${t.cameraId}_color_${e}_blue`]=ha(r.blue,1e3),i[`camera_${t.cameraId}_color_${e}_luma`]=ha(r.luma,1e3)};r("lift",t.colorCorrection.liftAdjust),r("gamma",t.colorCorrection.gammaAdjust),r("gain",t.colorCorrection.gainAdjust),r("offset",t.colorCorrection.offsetAdjust),i[`camera_${t.cameraId}_contrast_pivot`]=ha(t.colorCorrection.contrastAdjust.pivot,1e3),i[`camera_${t.cameraId}_contrast_adjust`]=ha(t.colorCorrection.contrastAdjust.adj,1e3),i[`camera_${t.cameraId}_lumamix`]=ha(t.colorCorrection.lumaMix,1e3),i[`camera_${t.cameraId}_hue_adjust`]=ha(t.colorCorrection.colorAdjust.hue,1e3),i[`camera_${t.cameraId}_saturation_adjust`]=ha(t.colorCorrection.colorAdjust.saturation,1e3)}function Sa(e,t,i){i.push({variableId:`camera_${t}_focus`,name:`Camera ${t}: Focus`}),i.push({variableId:`camera_${t}_iris`,name:`Camera ${t}: Iris`}),i.push({variableId:`camera_${t}_ois`,name:`Camera ${t}: Optical Image Stabilisation`}),i.push({variableId:`camera_${t}_wb_temp`,name:`Camera ${t}: White balance temperature`}),i.push({variableId:`camera_${t}_wb_tint`,name:`Camera ${t}: White balance tint`}),i.push({variableId:`camera_${t}_exposure_us`,name:`Camera ${t}: Exposure microseconds (us)`}),i.push({variableId:`camera_${t}_sharpening`,name:`Camera ${t}: Sharpening level`}),i.push({variableId:`camera_${t}_shutter_speed`,name:`Camera ${t}: Shutter speed (1/x)`}),i.push({variableId:`camera_${t}_gain`,name:`Camera ${t}: Gain (dB)`}),i.push({variableId:`camera_${t}_nd_filter`,name:`Camera ${t}: ND Filter`}),i.push({variableId:`camera_${t}_show_color_bars`,name:`Camera ${t}: Show Color Bars`});const r=(e,r)=>{i.push({variableId:`camera_${t}_color_${e}_red`,name:`Camera ${t}: Color ${r} Adjust - Red`}),i.push({variableId:`camera_${t}_color_${e}_green`,name:`Camera ${t}: Color ${r} Adjust - Green`}),i.push({variableId:`camera_${t}_color_${e}_blue`,name:`Camera ${t}: Color ${r} Adjust - Blue`}),i.push({variableId:`camera_${t}_color_${e}_Luma`,name:`Camera ${t}: Color ${r} Adjust - Luma`})};r("lift","Lift"),r("gamma","Gamma"),r("gain","Gain"),r("offset","Offset"),i.push({variableId:`camera_${t}_contrast_pivot`,name:`Camera ${t}: Contrast Pivot`}),i.push({variableId:`camera_${t}_contrast_adjust`,name:`Camera ${t}: Contrast Adjust`}),i.push({variableId:`camera_${t}_lumamix`,name:`Camera ${t}: Luma mix`}),i.push({variableId:`camera_${t}_hue_adjust`,name:`Camera ${t}: Hue Adjust`}),i.push({variableId:`camera_${t}_saturation_adjust`,name:`Camera ${t}: Saturation Adjust`})}function va(e,t,i){i.timecode=Cr(e.timecodeSeconds).hms,i.display_clock=Cr(e.displayClockSeconds).hms}function Pa(e,t,i){const r=ue(t),a=e.fairlight?.audioRouting?.sources?.[t];i[`audio_routing_source_${r}_name`]=a?.name}function Ia(e,t,i){const r=ue(t),a=e.fairlight?.audioRouting?.outputs?.[t];i[`audio_routing_destinations_${r}_name`]=a?.name;const o=a&&e.fairlight?.audioRouting?.sources?.[a?.sourceId];i[`audio_routing_destinations_${r}_source`]=a?.sourceId,i[`audio_routing_destinations_${r}_source_name`]=o?.name}function Ca(e,t,i){const r=t.inputs[i];if(r){const t=r.longName||r.shortName||`Input ${i}`;return(Number(e.config.presets)===st.Long?r.longName:r.shortName)||t}return 0===i?"Black":void 0===i?"Unknown":`Unknown input (${i})`}function ka(e,t,i,r){const a=ji(t,i)?.programInput??0;r[`pgm${i+1}_input`]=Ca(e,t,a),r[`pgm${i+1}_input_id`]=a}function wa(e,t,i,r){const a=ji(t,i)?.previewInput??0;r[`pvw${i+1}_input`]=Ca(e,t,a),r[`pvw${i+1}_input_id`]=a}function Ea(e,t,i){const r=e.video.mixEffects[t]?.transitionPosition?.handlePosition??0;i[`tbar_${t+1}`]=Math.round(r/100)}function xa(e,t,i,r,a){const o=Ui(t,i,r)?.fillSource??0;a[`usk_${i+1}_${r+1}_input`]=Ca(e,t,o),a[`usk_${i+1}_${r+1}_input_id`]=o;const n=t.video.mixEffects[i]?.upstreamKeyers[r]?.dveSettings;n&&(a[`usk_${i+1}_${r+1}_maskEnabled`]=n.maskEnabled,a[`usk_${i+1}_${r+1}_maskTop`]=n.maskTop/1e3,a[`usk_${i+1}_${r+1}_maskBottom`]=n.maskBottom/1e3,a[`usk_${i+1}_${r+1}_maskLeft`]=n.maskLeft/1e3,a[`usk_${i+1}_${r+1}_maskRight`]=n.maskRight/1e3,a[`usk_${i+1}_${r+1}_positionX`]=n.positionX/1e3,a[`usk_${i+1}_${r+1}_positionY`]=n.positionY/1e3,a[`usk_${i+1}_${r+1}_sizeX`]=n.sizeX/1e3,a[`usk_${i+1}_${r+1}_sizeY`]=n.sizeY/1e3,a[`usk_${i+1}_${r+1}_rotation`]=n.rotation,a[`usk_${i+1}_${r+1}_bordOutWidth`]=n.borderOuterWidth/100,a[`usk_${i+1}_${r+1}_bordInWidth`]=n.borderInnerWidth/100,a[`usk_${i+1}_${r+1}_bordOutSoft`]=n.borderOuterSoftness,a[`usk_${i+1}_${r+1}_bordInSoft`]=n.borderInnerSoftness,a[`usk_${i+1}_${r+1}_bevelSoft`]=n.borderBevelSoftness,a[`usk_${i+1}_${r+1}_bevelPos`]=n.borderBevelPosition,a[`usk_${i+1}_${r+1}_bordOpacity`]=n.borderOpacity,a[`usk_${i+1}_${r+1}_bordHue`]=n.borderHue/10,a[`usk_${i+1}_${r+1}_bordLum`]=n.borderLuma/10,a[`usk_${i+1}_${r+1}_lightDirection`]=n.lightSourceDirection/10,a[`usk_${i+1}_${r+1}_lightAltitude`]=n.lightSourceAltitude,a[`usk_${i+1}_${r+1}_bordEnabled`]=n.borderEnabled,a[`usk_${i+1}_${r+1}_shadowEnabled`]=n.shadowEnabled,a[`usk_${i+1}_${r+1}_rate`]=n.rate);const s=t.video.mixEffects[i]?.upstreamKeyers[r]?.patternSettings;s&&(a[`usk_${i+1}_${r+1}_pattern_style`]=s.style,a[`usk_${i+1}_${r+1}_pattern_size`]=s.size/100,a[`usk_${i+1}_${r+1}_pattern_symmetry`]=s.symmetry/100,a[`usk_${i+1}_${r+1}_pattern_softness`]=s.softness/100,a[`usk_${i+1}_${r+1}_pattern_positionX`]=s.positionX/1e4,a[`usk_${i+1}_${r+1}_pattern_positionY`]=s.positionY/1e4,a[`usk_${i+1}_${r+1}_pattern_invert`]=s.invert),t.video.mixEffects[i]?.upstreamKeyers[r]&&(a[`usk_${i+1}_${r+1}_canFlyKey`]=t.video.mixEffects[i]?.upstreamKeyers[r]?.canFlyKey,a[`usk_${i+1}_${r+1}_flyEnabled`]=t.video.mixEffects[i]?.upstreamKeyers[r]?.flyEnabled)}function _a(e,t,i,r){const a=Gi(t,i)?.sources?.fillSource??0;r[`dsk_${i+1}_input`]=Ca(e,t,a),r[`dsk_${i+1}_input_id`]=a}function Aa(e,t,i,r){const a=t.video.auxilliaries[i]??0;r[`aux${i+1}_input`]=Ca(e,t,a),r[`aux${i+1}_input_id`]=a}function Ta(e,t,i){const r=e.macro.macroProperties[t];i[`macro_${t+1}`]=r?.name||`Macro ${t+1}`}function Ma(e,t,i){const r=e.media.stillPool[t];i[`still_${t+1}`]=r?.fileName||`Still ${t+1}`}function Na(e,t,i){const r=e.media.clipPool[t];i[`clip_${t+1}`]=r?.name||`Clip ${t+1}`}function Oa(t,i,r){const a=t.media.players[i];let o="-1",n="Unknown";if(a)if(a.sourceType===e.Enums.MediaSourceType.Clip){const e=t.media.clipPool[a.clipIndex];o=`C${a.clipIndex+1}`,n=e?.name||`Clip ${a.clipIndex+1}`}else if(a.sourceType===e.Enums.MediaSourceType.Still){const e=t.media.stillPool[a.stillIndex];o=`S${a.stillIndex+1}`,n=e?.fileName||`Still ${a.stillIndex+1}`}r[`mp_index_${i+1}`]=o,r[`mp_source_${i+1}`]=n}function Ra(e,t){t[`long_${e.id}`]=e.longName,t[`short_${e.id}`]=e.shortName}function $a(e,t){const i=(e.streaming?.stats?.encodingBitrate??0)/1048576,r=Ir(e.streaming?.duration),a=e.streaming?.stats?.cacheUsed;t.stream_bitrate=i.toFixed(2),t.stream_duration_hm=r.hm,t.stream_duration_hms=r.hms,t.stream_duration_ms=r.ms,t.stream_cache_used=a}function Da(e,t){const i=Ir(e.recording?.duration),r=Cr(e.recording?.status?.recordingTimeAvailable);t.record_duration_hm=i.hm,t.record_duration_hms=i.hms,t.record_duration_ms=i.ms,t.record_remaining_hm=r.hm,t.record_remaining_hms=r.hms,t.record_remaining_ms=r.ms,t.record_filename=e.recording?.properties.filename||""}function Va(e,t=100){if(void 0!==e)return(e/t).toString()}function Fa(t){let i;switch(t){case e.Enums.FairlightAudioMixOption.Off:i="OFF";break;case e.Enums.FairlightAudioMixOption.On:i="ON";break;case e.Enums.FairlightAudioMixOption.AudioFollowVideo:i="AFV"}return i}function Ba(e,t,i){const r=function(e,t){return e.fairlight?.inputs[t]}(e,t)?.sources;if(void 0!==r&&r[-65280]){const e=r[-65280]?.properties;i[`audio_input_${t}_balance`]=Va(e?.balance),i[`audio_input_${t}_faderGain`]=Va(e?.faderGain),i[`audio_input_${t}_framesDelay`]=e?.framesDelay.toString(),i[`audio_input_${t}_gain`]=Va(e?.gain),i[`audio_input_${t}_mixOption`]=Fa(e?.mixOption)}if(void 0!==r&&r[-256]){const e=r[-256]?.properties;i[`audio_input_${t}_left_balance`]=Va(e?.balance),i[`audio_input_${t}_left_faderGain`]=Va(e?.faderGain),i[`audio_input_${t}_left_framesDelay`]=e?.framesDelay.toString(),i[`audio_input_${t}_left_gain`]=Va(e?.gain),i[`audio_input_${t}_left_mixOption`]=Fa(e?.mixOption)}if(void 0!==r&&r[-255]){const e=r[-255]?.properties;i[`audio_input_${t}_right_balance`]=Va(e?.balance),i[`audio_input_${t}_right_faderGain`]=Va(e?.faderGain),i[`audio_input_${t}_right_framesDelay`]=e?.framesDelay.toString(),i[`audio_input_${t}_right_gain`]=Va(e?.gain),i[`audio_input_${t}_right_mixOption`]=Fa(e?.mixOption)}}function La(t,i,r){const a=function(e,t){return e.audio?.channels[t]}(t,i),o=a&&a.gain<=-60?-1/0:a?.gain;r[`audio_input_${i}_balance`]=Va(a?.balance,1),r[`audio_input_${i}_gain`]=Va(o,1),r[`audio_input_${i}_mixOption`]=function(t){let i;switch(t){case e.Enums.AudioMixOption.Off:i="OFF";break;case e.Enums.AudioMixOption.On:i="ON";break;case e.Enums.AudioMixOption.AudioFollowVideo:i="AFV"}return i}(a?.mixOption)}function ja(e,t){const i=function(e){return e.fairlight?.master}(e);t.audio_master_faderGain=Va(i?.properties?.faderGain)}function Ka(e,t){const i=function(e){return e.fairlight?.monitor}(e);t.audio_monitor_gain=Va(i?.gain),t.audio_monitor_master_gain=Va(i?.inputMasterGain),t.audio_monitor_talkback_gain=Va(i?.inputTalkbackGain),t.audio_monitor_sidetone_gain=Va(i?.inputSidetoneGain)}function Ua(e,t,i,r){for(let a=0;a<4;a++){const o=zi(t,a,i)?.source??0;r[`ssrc${i+1}_box${a+1}_source`]=Ca(e,t,o),r[`ssrc${i+1}_box${a+1}_source_id`]=o}}function Ga(e,t,i,r,a){const o=t.settings.multiViewers[i-1]?.windows?.[r-1]?.source??0;a[`mv_${i}_window_${r}_input_id`]=o,a[`mv_${i}_window_${r}_input`]=Ca(e,t,o)}function za(e,t){t.device_ip=e.parseIpAndPort()?.ip||""}const Wa=function(e,t){return e===t||e!=e&&t!=t},Ha=function(e,t){for(var i=e.length;i--;)if(Wa(e[i][0],t))return i;return-1};var qa=Array.prototype.splice;function Ja(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}Ja.prototype.clear=function(){this.__data__=[],this.size=0},Ja.prototype.delete=function(e){var t=this.__data__,i=Ha(t,e);return!(i<0||(i==t.length-1?t.pop():qa.call(t,i,1),--this.size,0))},Ja.prototype.get=function(e){var t=this.__data__,i=Ha(t,e);return i<0?void 0:t[i][1]},Ja.prototype.has=function(e){return Ha(this.__data__,e)>-1},Ja.prototype.set=function(e,t){var i=this.__data__,r=Ha(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this};const Ya=Ja,Xa="object"==typeof global&&global&&global.Object===Object&&global;var Qa="object"==typeof self&&self&&self.Object===Object&&self;const Za=Xa||Qa||Function("return this")(),eo=Za.Symbol;var to=Object.prototype,io=to.hasOwnProperty,ro=to.toString,ao=eo?eo.toStringTag:void 0;var oo=Object.prototype.toString;var no=eo?eo.toStringTag:void 0;const so=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":no&&no in Object(e)?function(e){var t=io.call(e,ao),i=e[ao];try{e[ao]=void 0;var r=!0}catch(e){}var a=ro.call(e);return r&&(t?e[ao]=i:delete e[ao]),a}(e):function(e){return oo.call(e)}(e)},lo=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},uo=function(e){if(!lo(e))return!1;var t=so(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},co=Za["__core-js_shared__"];var po,mo=(po=/[^.]+$/.exec(co&&co.keys&&co.keys.IE_PROTO||""))?"Symbol(src)_1."+po:"";var bo=Function.prototype.toString;const fo=function(e){if(null!=e){try{return bo.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var go=/^\[object .+?Constructor\]$/,ho=Function.prototype,yo=Object.prototype,So=ho.toString,vo=yo.hasOwnProperty,Po=RegExp("^"+So.call(vo).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Io=function(e){return!(!lo(e)||(t=e,mo&&mo in t))&&(uo(e)?Po:go).test(fo(e));var t},Co=function(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return Io(i)?i:void 0},ko=Co(Za,"Map"),wo=Co(Object,"create");var Eo=Object.prototype.hasOwnProperty;var xo=Object.prototype.hasOwnProperty;function _o(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}_o.prototype.clear=function(){this.__data__=wo?wo(null):{},this.size=0},_o.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},_o.prototype.get=function(e){var t=this.__data__;if(wo){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return Eo.call(t,e)?t[e]:void 0},_o.prototype.has=function(e){var t=this.__data__;return wo?void 0!==t[e]:xo.call(t,e)},_o.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=wo&&void 0===t?"__lodash_hash_undefined__":t,this};const Ao=_o,To=function(e,t){var i,r,a=e.__data__;return("string"==(r=typeof(i=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i)?a["string"==typeof t?"string":"hash"]:a.map};function Mo(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}Mo.prototype.clear=function(){this.size=0,this.__data__={hash:new Ao,map:new(ko||Ya),string:new Ao}},Mo.prototype.delete=function(e){var t=To(this,e).delete(e);return this.size-=t?1:0,t},Mo.prototype.get=function(e){return To(this,e).get(e)},Mo.prototype.has=function(e){return To(this,e).has(e)},Mo.prototype.set=function(e,t){var i=To(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this};const No=Mo;function Oo(e){var t=this.__data__=new Ya(e);this.size=t.size}Oo.prototype.clear=function(){this.__data__=new Ya,this.size=0},Oo.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},Oo.prototype.get=function(e){return this.__data__.get(e)},Oo.prototype.has=function(e){return this.__data__.has(e)},Oo.prototype.set=function(e,t){var i=this.__data__;if(i instanceof Ya){var r=i.__data__;if(!ko||r.length<199)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new No(r)}return i.set(e,t),this.size=i.size,this};const Ro=Oo;function $o(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new No;++t<i;)this.add(e[t])}$o.prototype.add=$o.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},$o.prototype.has=function(e){return this.__data__.has(e)};const Do=$o,Vo=function(e,t){for(var i=-1,r=null==e?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1},Fo=function(e,t,i,r,a,o){var n=1&i,s=e.length,l=t.length;if(s!=l&&!(n&&l>s))return!1;var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;var d=-1,p=!0,m=2&i?new Do:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var b=e[d],f=t[d];if(r)var g=n?r(f,b,d,t,e,o):r(b,f,d,e,t,o);if(void 0!==g){if(g)continue;p=!1;break}if(m){if(!Vo(t,function(e,t){if(n=t,!m.has(n)&&(b===e||a(b,e,i,r,o)))return m.push(t);var n})){p=!1;break}}else if(b!==f&&!a(b,f,i,r,o)){p=!1;break}}return o.delete(e),o.delete(t),p},Bo=Za.Uint8Array,Lo=function(e){var t=-1,i=Array(e.size);return e.forEach(function(e,r){i[++t]=[r,e]}),i},jo=function(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i};var Ko=eo?eo.prototype:void 0,Uo=Ko?Ko.valueOf:void 0;const Go=Array.isArray;var zo=Object.prototype.propertyIsEnumerable,Wo=Object.getOwnPropertySymbols;const Ho=Wo?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var i=-1,r=null==e?0:e.length,a=0,o=[];++i<r;){var n=e[i];t(n,i,e)&&(o[a++]=n)}return o}(Wo(e),function(t){return zo.call(e,t)}))}:function(){return[]},qo=function(e){return null!=e&&"object"==typeof e},Jo=function(e){return qo(e)&&"[object Arguments]"==so(e)};var Yo=Object.prototype,Xo=Yo.hasOwnProperty,Qo=Yo.propertyIsEnumerable;const Zo=Jo(function(){return arguments}())?Jo:function(e){return qo(e)&&Xo.call(e,"callee")&&!Qo.call(e,"callee")};var en="object"==typeof exports&&exports&&!exports.nodeType&&exports,tn=en&&"object"==typeof module&&module&&!module.nodeType&&module,rn=tn&&tn.exports===en?Za.Buffer:void 0;const an=(rn?rn.isBuffer:void 0)||function(){return!1};var on=/^(?:0|[1-9]\d*)$/;const nn=function(e,t){var i=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&on.test(e))&&e>-1&&e%1==0&&e<t},sn=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var ln={};ln["[object Float32Array]"]=ln["[object Float64Array]"]=ln["[object Int8Array]"]=ln["[object Int16Array]"]=ln["[object Int32Array]"]=ln["[object Uint8Array]"]=ln["[object Uint8ClampedArray]"]=ln["[object Uint16Array]"]=ln["[object Uint32Array]"]=!0,ln["[object Arguments]"]=ln["[object Array]"]=ln["[object ArrayBuffer]"]=ln["[object Boolean]"]=ln["[object DataView]"]=ln["[object Date]"]=ln["[object Error]"]=ln["[object Function]"]=ln["[object Map]"]=ln["[object Number]"]=ln["[object Object]"]=ln["[object RegExp]"]=ln["[object Set]"]=ln["[object String]"]=ln["[object WeakMap]"]=!1;var un="object"==typeof exports&&exports&&!exports.nodeType&&exports,cn=un&&"object"==typeof module&&module&&!module.nodeType&&module,dn=cn&&cn.exports===un&&Xa.process,pn=function(){try{return cn&&cn.require&&cn.require("util").types||dn&&dn.binding&&dn.binding("util")}catch(e){}}(),mn=pn&&pn.isTypedArray;const bn=mn?(fn=mn,function(e){return fn(e)}):function(e){return qo(e)&&sn(e.length)&&!!ln[so(e)]};var fn,gn=Object.prototype.hasOwnProperty;const hn=function(e,t){var i=Go(e),r=!i&&Zo(e),a=!i&&!r&&an(e),o=!i&&!r&&!a&&bn(e),n=i||r||a||o,s=n?function(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}(e.length,String):[],l=s.length;for(var u in e)!t&&!gn.call(e,u)||n&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||nn(u,l))||s.push(u);return s};var yn=Object.prototype;const Sn=function(e,t){return function(i){return e(t(i))}}(Object.keys,Object);var vn=Object.prototype.hasOwnProperty;const Pn=function(e){if(i=(t=e)&&t.constructor,t!==("function"==typeof i&&i.prototype||yn))return Sn(e);var t,i,r=[];for(var a in Object(e))vn.call(e,a)&&"constructor"!=a&&r.push(a);return r},In=function(e){return null!=(t=e)&&sn(t.length)&&!uo(t)?hn(e):Pn(e);var t},Cn=function(e){return function(e,t,i){var r=t(e);return Go(e)?r:function(e,t){for(var i=-1,r=t.length,a=e.length;++i<r;)e[a+i]=t[i];return e}(r,i(e))}(e,In,Ho)};var kn=Object.prototype.hasOwnProperty;const wn=Co(Za,"DataView"),En=Co(Za,"Promise"),xn=Co(Za,"Set"),_n=Co(Za,"WeakMap");var An="[object Map]",Tn="[object Promise]",Mn="[object Set]",Nn="[object WeakMap]",On="[object DataView]",Rn=fo(wn),$n=fo(ko),Dn=fo(En),Vn=fo(xn),Fn=fo(_n),Bn=so;(wn&&Bn(new wn(new ArrayBuffer(1)))!=On||ko&&Bn(new ko)!=An||En&&Bn(En.resolve())!=Tn||xn&&Bn(new xn)!=Mn||_n&&Bn(new _n)!=Nn)&&(Bn=function(e){var t=so(e),i="[object Object]"==t?e.constructor:void 0,r=i?fo(i):"";if(r)switch(r){case Rn:return On;case $n:return An;case Dn:return Tn;case Vn:return Mn;case Fn:return Nn}return t});const Ln=Bn;var jn="[object Arguments]",Kn="[object Array]",Un="[object Object]",Gn=Object.prototype.hasOwnProperty;const zn=function(e,t,i,r,a,o){var n=Go(e),s=Go(t),l=n?Kn:Ln(e),u=s?Kn:Ln(t),c=(l=l==jn?Un:l)==Un,d=(u=u==jn?Un:u)==Un,p=l==u;if(p&&an(e)){if(!an(t))return!1;n=!0,c=!1}if(p&&!c)return o||(o=new Ro),n||bn(e)?Fo(e,t,i,r,a,o):function(e,t,i,r,a,o,n){switch(i){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new Bo(e),new Bo(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Wa(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=Lo;case"[object Set]":var l=1&r;if(s||(s=jo),e.size!=t.size&&!l)return!1;var u=n.get(e);if(u)return u==t;r|=2,n.set(e,t);var c=Fo(s(e),s(t),r,a,o,n);return n.delete(e),c;case"[object Symbol]":if(Uo)return Uo.call(e)==Uo.call(t)}return!1}(e,t,l,i,r,a,o);if(!(1&i)){var m=c&&Gn.call(e,"__wrapped__"),b=d&&Gn.call(t,"__wrapped__");if(m||b){var f=m?e.value():e,g=b?t.value():t;return o||(o=new Ro),a(f,g,i,r,o)}}return!!p&&(o||(o=new Ro),function(e,t,i,r,a,o){var n=1&i,s=Cn(e),l=s.length;if(l!=Cn(t).length&&!n)return!1;for(var u=l;u--;){var c=s[u];if(!(n?c in t:kn.call(t,c)))return!1}var d=o.get(e),p=o.get(t);if(d&&p)return d==t&&p==e;var m=!0;o.set(e,t),o.set(t,e);for(var b=n;++u<l;){var f=e[c=s[u]],g=t[c];if(r)var h=n?r(g,f,c,t,e,o):r(f,g,c,e,t,o);if(!(void 0===h?f===g||a(f,g,i,r,o):h)){m=!1;break}b||(b="constructor"==c)}if(m&&!b){var y=e.constructor,S=t.constructor;y==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S||(m=!1)}return o.delete(e),o.delete(t),m}(e,t,i,r,a,o))},Wn=function e(t,i,r,a,o){return t===i||(null==t||null==i||!qo(t)&&!qo(i)?t!=t&&i!=i:zn(t,i,r,a,e,o))},Hn=function(e,t){return Wn(e,t)};function qn(e,t,i){void 0!==e[t]&&(e[t]=parseFloat(e[t])*i)}const Jn={[gr.PreviewBG]:!0,[gr.PreviewBG2]:!0,[gr.PreviewBG3]:!0,[gr.PreviewBG4]:!0,[gr.ProgramBG]:!0,[gr.ProgramBG2]:!0,[gr.ProgramBG3]:!0,[gr.ProgramBG4]:!0,[gr.AuxBG]:!0,[gr.USKOnAir]:!0,[gr.USKSource]:!0,[gr.DSKOnAir]:!0,[gr.DSKTie]:!0,[gr.DSKSource]:!0,[gr.Macro]:!0,[gr.MVSource]:!0,[gr.SSrcBoxOnAir]:!0,[gr.SSrcBoxSource]:!0,[gr.SSrcBoxProperties]:!0,[gr.TransitionStyle]:!0,[gr.TransitionSelection]:!0,[gr.TransitionRate]:!0,[gr.InTransition]:!0,[gr.MediaPlayerSource]:!0,[gr.FadeToBlackIsBlack]:!0,[gr.FadeToBlackRate]:!0,[gr.ProgramTally]:!0,[gr.PreviewTally]:!0,[gr.StreamStatus]:!0,[gr.RecordStatus]:!0,[gr.ClassicAudioGain]:!0,[gr.ClassicAudioMixOption]:!0,[gr.FairlightAudioFaderGain]:!0,[gr.FairlightAudioInputGain]:!0,[gr.FairlightAudioMixOption]:!0},Yn={[gr.ProgramTally]:"invert",[gr.PreviewTally]:"invert",[gr.DSKOnAir]:"invert",[gr.DSKTie]:"invert",[gr.USKOnAir]:"invert"},Xn=[function(e,t){const i={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]};for(const e of t.actions)e.actionId===gi.SuperSourceBoxProperties&&(qn(e.options,"size",.001),qn(e.options,"x",.01),qn(e.options,"y",.01),qn(e.options,"cropTop",.001),qn(e.options,"cropBottom",.001),qn(e.options,"cropLeft",.001),qn(e.options,"cropRight",.001),i.updatedActions.push(e));for(const e of t.feedbacks)e.feedbackId===gr.SSrcBoxProperties&&(qn(e.options,"size",.001),qn(e.options,"x",.01),qn(e.options,"y",.01),qn(e.options,"cropTop",.001),qn(e.options,"cropBottom",.001),qn(e.options,"cropLeft",.001),qn(e.options,"cropRight",.001),i.updatedFeedbacks.push(e));return i},(0,t.CreateConvertToBooleanFeedbackUpgradeScript)(Jn),function(e,t){const i={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]};for(const e of t.actions)e.actionId!==gi.SuperSourceBoxProperties||e.options.properties?e.actionId!==gi.SuperSourceArt||e.options.properties||(e.options.properties=["fill","key","artOption"],i.updatedActions.push(e)):(e.options.properties=["size","x","y","cropEnable","cropTop","cropLeft","cropRight","cropBottom"],i.updatedActions.push(e));for(const e of t.feedbacks)e.feedbackId!==gr.SSrcBoxProperties||e.options.properties||(e.options.properties=["size","x","y","cropEnable","cropTop","cropLeft","cropRight","cropBottom"],i.updatedFeedbacks.push(e));return i},function(e,t){const i={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]};for(const e of t.feedbacks)e.feedbackId===gr.FairlightAudioFaderGain&&void 0===e.options.input&&(e.feedbackId=gr.FairlightAudioMonitorOutputFaderGain,i.updatedFeedbacks.push(e));return i},(0,t.CreateUseBuiltinInvertForFeedbacksUpgradeScript)(Yn),function(e,t){const i={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]},r=e=>{e.selection=[],e.background&&e.selection.push("background"),delete e.background;for(const t of Object.keys(e))t.startsWith("key")&&(e[t]&&e.selection.push(t),delete e[t])};for(const e of t.actions)e.actionId===gi.TransitionSelection&&void 0===e.options.selection&&(r(e.options),i.updatedActions.push(e));for(const e of t.feedbacks)e.feedbackId===gr.TransitionSelection&&void 0===e.options.selection&&(r(e.options),i.updatedFeedbacks.push(e));return i},function(e,t){const i={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]};for(const e of t.actions)"mediaPlayerSourceVariables"===e.actionId&&(e.actionId=gi.MediaPlayerSourceVariables,e.options.mediaplayer=Number(e.options.mediaplayer)+1,i.updatedActions.push(e));return i}];var Qn=__webpack_require__(2996),Zn=__webpack_require__(409);const{Atem:es,AtemConnectionStatus:ts,AtemStateUtil:is}=e;Zn.ThreadedClassManager.handleExit=Zn.RegisterExitHandlers.NO;class rs extends t.InstanceBase{model;atem;wrappedState;commandBatching;isActive;durationInterval;atemTransitions;config={};timecodeSeconds=0;displayClockSeconds=0;constructor(e){super(e),this.commandBatching=new pe;const t=is.Create();this.wrappedState={state:t,tally:{},tallyCache:new Map,atemCameraState:new hr.AtemCameraControlStateBuilder(0),mediaPoolCache:new Li(t,async e=>{if(!this.atem)throw new Error("Atem not initialised");const t=this.atem.videoMode;if(!t)throw new Error("No video mode");const i=e.isClip?await this.atem.downloadClipFrame(e.slot,e.frameIndex,"raw"):await this.atem.downloadStill(e.slot,"raw");return{buffer:(0,Qn.zC)(t.width,t.height,i),width:t.width,height:t.height}},e=>this.checkFeedbacksById(...e))},this.atemTransitions=new St(this.config),"undefined"===this.config.modelID&&(this.config.modelID="0",setImmediate(()=>{this.saveConfig(this.config)})),this.model=at(this.getBestModelId()||0)||ot(),this.isActive=!1}async init(e){this.isActive=!0,this.updateStatus(t.InstanceStatus.Disconnected),this.setupAtemConnection(),await this.configUpdated(e),await new Promise(e=>setTimeout(e,1e3))}async configUpdated(e){this.config=e;const i={};if(za(this,i),this.setVariableValues(i),this.wrappedState.state=is.Create(),this.wrappedState.atemCameraState.reset(0),this.model=at(this.getBestModelId()||0)||ot(),this.log("debug","ATEM changed model: "+this.model.id),this.atemTransitions.stopAll(),this.atemTransitions=new St(this.config),this.updateCompanionBits(),this.atem){this.atem.status!==ts.CLOSED&&this.atem.disconnect().catch(()=>null);const e=this.parseIpAndPort();this.log("info",`Connecting to ${e?.ip}:${e?.port}`),e?(this.updateStatus(t.InstanceStatus.Connecting),this.atem.connect(e.ip,e.port).catch(e=>{this.updateStatus(t.InstanceStatus.ConnectionFailure),this.log("error",`Connecting failed: ${e}`)})):this.updateStatus(t.InstanceStatus.Disconnected)}}getConfigFields(){return[{type:"static-text",id:"info",width:12,label:"Information",value:"This works with all models of Blackmagic Design ATEM mixers. <br />Firmware versions 7.5.2 and later are known to work, other versions may experience problems. <br />Firmware versions after 9.7 are not verified to be working at the time of writing, but they likely will work fine. <br />In general the model can be left in 'Auto Detect', however a specific model can be selected below for offline programming. <br />Devices must be controlled over a network, USB control is NOT supported."},{type:"bonjour-device",id:"bonjourHost",label:"Device",width:6},{type:"textinput",id:"host",label:"Target IP2",width:6,isVisibleExpression:"!$(options:bonjourHost)",default:"",regex:t.Regex.IP},{type:"static-text",id:"host-filler",width:6,label:"",isVisibleExpression:"!!$(options:bonjourHost)",value:""},{type:"dropdown",id:"modelID",label:"Model",width:6,choices:rt,default:0},{type:"static-text",id:"autoModelName",label:"Detected Model",width:6,isVisibleExpression:"$(options:modelID) == 0",value:this.config.autoModelName??"Pending"},{type:"static-text",id:"autoModelName-filler",width:6,label:"",isVisibleExpression:"$(options:modelID) != 0",value:""},{type:"dropdown",id:"presets",label:"Preset Style",width:6,choices:[{id:st.Short,label:"Short Names"},{id:st.Long,label:"Long Names"}],default:st.Short},{type:"number",id:"fadeFps",label:"Framerate for fades",tooltip:"Higher is smoother, but has higher impact on system performance",width:6,min:5,max:60,step:1,default:10},{type:"checkbox",id:"enableCameraControl",label:"Enable Camera Control",width:6,default:!1},{type:"checkbox",id:"pollTimecode",label:"Enable Timecode variable",width:6,default:!1}]}async destroy(){this.isActive=!1,this.atemTransitions.stopAll(),this.atem&&(this.atem.disconnect().catch(()=>null),delete this.atem),this.log("debug","destroy: "+this.id)}getBestModelId(){const e=Number(this.config.modelID);if(!isNaN(e)&&e>0)return e;const t=this.wrappedState.state.info;if(t&&t.model)return t.model;const i=this.config.modelID+""=="0"?Number(this.config.autoModelID):0;return!isNaN(i)&&i>0?i:void 0}updateCompanionBits(){var t,i,r;!function(t,i,r){const a=[],o={};a.push({name:"IP address of ATEM",variableId:"device_ip"}),za(t,o);for(let e=0;e<i.MEs;++e){a.push({name:`Label of input active on program bus (M/E ${e+1})`,variableId:`pgm${e+1}_input`}),a.push({name:`Id of input active on program bus (M/E ${e+1})`,variableId:`pgm${e+1}_input_id`}),ka(t,r.state,e,o),a.push({name:`Label of input active on preview bus (M/E ${e+1})`,variableId:`pvw${e+1}_input`}),a.push({name:`Id of input active on preview bus (M/E ${e+1})`,variableId:`pvw${e+1}_input_id`}),wa(t,r.state,e,o),a.push({name:`Position of T-bar (M/E ${e+1})`,variableId:`tbar_${e+1}`}),Ea(r.state,e,o);for(let n=0;n<i.USKs;++n)a.push({name:`Label of input active on M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_input`}),a.push({name:`Id of input active on M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_input_id`}),i.USKs&&i.DVEs&&(a.push({name:`Mask Enabled for M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskEnabled`}),a.push({name:`Mask cutoff from the top of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskTop`}),a.push({name:`Mask cutoff from the bottom of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskBottom`}),a.push({name:`Mask cutoff from the left of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskLeft`}),a.push({name:`Mask cutoff from the right of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskRight`}),a.push({name:`X position of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_positionX`}),a.push({name:`Y position of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_positionY`}),a.push({name:`X scale of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_sizeX`}),a.push({name:`Y scale of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_sizeY`}),a.push({name:`Rotation of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_rotation`}),a.push({name:`Border Width (Outer) of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordOutWidth`}),a.push({name:`Border Width (Inner) of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordInWidth`}),a.push({name:`Border Softness (Outer) of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordOutSoft`}),a.push({name:`Border Softnesss (Inner) of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordInSoft`}),a.push({name:`Border Bevel Softnesss of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bevelSoft`}),a.push({name:`Border Bevel Position of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bevelPos`}),a.push({name:`Border Opacity of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordOpacity`}),a.push({name:`Border Hue of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordHue`}),a.push({name:`Border Luma of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordLum`}),a.push({name:`Light source Angle of shadow of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_lightDirection`}),a.push({name:`Light source Altitude of shadow of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_lightAltitude`}),a.push({name:`Border Enabled for M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordEnabled`}),a.push({name:`Shadow Enabled for M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_shadowEnabled`}),a.push({name:`Keyframe transformation Rate of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_rate`}),a.push({name:`Pattern Style of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_style`}),a.push({name:`Pattern Size of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_size`}),a.push({name:`Pattern Symmetry of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_symmetry`}),a.push({name:`Pattern Softness of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_softness`}),a.push({name:`Pattern Position X of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_positionX`}),a.push({name:`Pattern Position Y of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_positionY`}),a.push({name:`Pattern Invert of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_invert`}),a.push({name:`(read only) Ability to Enable Fly Key or DVE of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_canFlyKey`}),a.push({name:`Fly Key Enable Status of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_flyEnabled`})),xa(t,r.state,e,n,o)}for(const e of i.outputs)a.push({name:`Label of input active on ${e.name}`,variableId:`aux${e.id+1}_input`}),a.push({name:`Id of input active on ${e.name}`,variableId:`aux${e.id+1}_input_id`}),Aa(t,r.state,e.id,o);for(let e=0;e<i.DSKs;++e)a.push({name:`Label of input active on DSK ${e+1}`,variableId:`dsk_${e+1}_input`}),a.push({name:`Id of input active on DSK ${e+1}`,variableId:`dsk_${e+1}_input_id`}),_a(t,r.state,e,o);for(const e of q(i,r.state))a.push({name:`Long name of source id ${e.id}`,variableId:`long_${e.id}`}),a.push({name:`Short name of source id ${e.id}`,variableId:`short_${e.id}`}),Ra(e,o);for(let e=0;e<i.macros;e++)a.push({name:`Name of macro #${e+1}`,variableId:`macro_${e+1}`}),Ta(r.state,e,o);for(let e=0;e<i.media.stills;e++)a.push({name:`Name of still #${e+1}`,variableId:`still_${e+1}`}),Ma(r.state,e,o);for(let e=0;e<i.media.clips;e++)a.push({name:`Name of clip #${e+1}`,variableId:`clip_${e+1}`}),Na(r.state,e,o);for(let e=0;e<i.media.players;e++)a.push({name:`Name of media player source #${e+1}`,variableId:`mp_source_${e+1}`}),a.push({name:`Name of media player index #${e+1}`,variableId:`mp_index_${e+1}`}),Oa(r.state,e,o);i.streaming&&(a.push({name:"Streaming bitrate in MB/s",variableId:"stream_bitrate"}),a.push({name:"Streaming duration (hh:mm)",variableId:"stream_duration_hm"}),a.push({name:"Streaming duration (hh:mm:ss)",variableId:"stream_duration_hms"}),a.push({name:"Streaming duration (mm:ss)",variableId:"stream_duration_ms"}),a.push({name:"Streaming Cache Used",variableId:"stream_cache_used"}),$a(r.state,o)),i.recording&&(a.push({name:"Recording duration (hh:mm)",variableId:"record_duration_hm"}),a.push({name:"Recording duration (hh:mm:ss)",variableId:"record_duration_hms"}),a.push({name:"Recording duration (mm:ss)",variableId:"record_duration_ms"}),a.push({name:"Recording time remaining (hh:mm)",variableId:"record_remaining_hm"}),a.push({name:"Recording time remaining (hh:mm:ss)",variableId:"record_remaining_hms"}),a.push({name:"Recording time remaining (mm:ss)",variableId:"record_remaining_ms"}),a.push({name:"Recording filename",variableId:"record_filename"}),Da(r.state,o));for(let e=0;e<i.SSrc;e++){for(let t=0;t<4;t++)a.push({name:`Supersource ${e+1} Box ${t+1} source`,variableId:`ssrc${e+1}_box${t+1}_source`}),a.push({name:`Supersource ${e+1} Box ${t+1} source id`,variableId:`ssrc${e+1}_box${t+1}_source_id`});Ua(t,r.state,e,o)}if(r.state.fairlight){for(const[e,t]of Object.entries(r.state.fairlight.inputs))void 0!==t?.sources&&t.sources[-65280]&&(a.push({name:`Pan for input ${e}`,variableId:`audio_input_${e}_balance`}),a.push({name:`Fader gain for input ${e}`,variableId:`audio_input_${e}_faderGain`}),a.push({name:`Frames delay for input ${e}`,variableId:`audio_input_${e}_framesDelay`}),a.push({name:`Gain for input ${e}`,variableId:`audio_input_${e}_gain`}),a.push({name:`Mix option for input ${e}`,variableId:`audio_input_${e}_mixOption`})),void 0!==t?.sources&&t.sources[-256]&&(a.push({name:`Pan for input ${e} - left`,variableId:`audio_input_${e}_left_balance`}),a.push({name:`Fader gain for input ${e} - left`,variableId:`audio_input_${e}_left_faderGain`}),a.push({name:`Frames delay for input ${e} - left`,variableId:`audio_input_${e}_left_framesDelay`}),a.push({name:`Gain for input ${e} - left`,variableId:`audio_input_${e}_left_gain`}),a.push({name:`Mix option for input ${e} - left`,variableId:`audio_input_${e}_left_mixOption`})),void 0!==t?.sources&&t.sources[-255]&&(a.push({name:`Pan for input ${e} - right`,variableId:`audio_input_${e}_right_balance`}),a.push({name:`Fader gain for input ${e} - right`,variableId:`audio_input_${e}_right_faderGain`}),a.push({name:`Frames delay for input ${e} - right`,variableId:`audio_input_${e}_right_framesDelay`}),a.push({name:`Gain for input ${e} - right`,variableId:`audio_input_${e}_right_gain`}),a.push({name:`Mix option for input ${e} - right`,variableId:`audio_input_${e}_right_mixOption`})),Ba(r.state,Number(e),o);a.push({name:"Fader gain for master",variableId:"audio_master_faderGain"}),ja(r.state,o),a.push({name:"Gain for Monitor/Headphone",variableId:"audio_monitor_gain"}),a.push({name:"Gain for Monitor/Headphone Master",variableId:"audio_monitor_master_gain"}),a.push({name:"Gain for Monitor/Headphone Talkback",variableId:"audio_monitor_talkback_gain"}),a.push({name:"Gain for Monitor/Headphone Sidetone",variableId:"audio_monitor_sidetone_gain"}),Ka(r.state,o)}if(i.fairlightAudio?.audioRouting){for(const e of i.fairlightAudio.audioRouting.outputs)for(const t of e.channelPairs){const i=I(e.outputId,t),n=ue(i);a.push({name:`Name of audio routing destination ${n}`,variableId:`audio_routing_destinations_${n}_name`},{name:`Source of audio routing destination ${n}`,variableId:`audio_routing_destinations_${n}_source`},{name:`Name of source of audio routing destination ${n}`,variableId:`audio_routing_destinations_${n}_source_name`}),Ia(r.state,i,o)}for(const e of i.fairlightAudio.audioRouting.sources)for(const t of e.channelPairs){const i=I(e.inputId,t),n=ue(i);a.push({name:`Name of audio routing source ${n}`,variableId:`audio_routing_source_${n}_name`}),Pa(r.state,i,o)}}if(i.classicAudio)for(const e of i.classicAudio.inputs)a.push({name:`Pan for input ${e.id}`,variableId:`audio_input_${e.id}_balance`}),a.push({name:`Gain for input ${e.id}`,variableId:`audio_input_${e.id}_gain`}),a.push({name:`Mix option for input ${e.id}`,variableId:`audio_input_${e.id}_mixOption`}),La(r.state,e.id,o);const n=i.multiviewerFullGrid?16:10;for(let e=1;e<=i.MVs;e++)for(let i=1;i<=n;i++)a.push({name:`Label of input in multiviewer ${e} window ${i}`,variableId:`mv_${e}_window_${i}_input`}),a.push({name:`Id of input in multiviewer ${e} window ${i}`,variableId:`mv_${e}_window_${i}_input_id`}),Ga(t,r.state,e,i,o);if(t.config.enableCameraControl)for(const t of i.inputs)t.portType===e.Enums.InternalPortType.External&&(Sa(0,t.id,a),ya(0,r.atemCameraState.get(t.id)??(0,hr.createEmptyState)(t.id),o));t.config.pollTimecode&&(a.push({name:"Timecode",variableId:"timecode"}),a.push({name:"Display Clock",variableId:"display_clock"}),va(t,r.state,o)),t.setVariableDefinitions(a),t.setVariableValues(o)}(this,this.model,this.wrappedState),this.setPresetDefinitions(function(e,t,i){const r=Number(e.config.presets)===st.Long?"long_":"short_",a=Number(e.config.presets)===st.Long?"auto":"18",o=q(t,i,"me");return function(e){const t={};for(const i of e)if(i)for(const[e,r]of Object.entries(i.presets))r&&(t[e]=aa(r,i));return t}([...ca(t,a,r,o),...pa(t,a,ga),...ma(t,i,a,r),...ba(t,a,r,o),...fa(t,a,r,o),...ua(t),...la(t,i,a,r),...sa(t,a,r,o),...na(t,a),...oa(t,a,ga),...ea(t),...ta(t)])}(this,this.model,this.wrappedState.state)),this.setFeedbackDefinitions((t=this.config,i=this.model,r=this.wrappedState,function(e){const t={};for(const[i,r]of Object.entries(e)){let e;switch(r?.type){case void 0:e=void 0;break;case"boolean":e={...Ar(r),type:"boolean",defaultStyle:r.defaultStyle,showInvert:r.showInvert,callback:async(e,t)=>r.callback({..._r(e,t,r.options)},t)};break;case"advanced":e={...Ar(r),type:"advanced",callback:async(e,t)=>r.callback({..._r(e,t,r.options),image:e.image},t)};break;default:(0,xr.assertNever)(r)}t[i]=e}return t}({...Er(i,r),...Tr(i,r),...Mr(i,r),...Kr(i,r),...jr(i,r),...zr(i,r),...Nr(i,r),...Ur(i,r),...Lr(i,r),...Br(i,r),...Wr(i,r),...Hr(i,r),...Fr(i,r),...Vr(i,r),...$r(i,r),...Or(i,r),...Xr(i,r),...Jr(t,0,r)}))),this.setActionDefinitions(function(e,t,i,r,a,o){return function(e){const t={};for(const[i,r]of Object.entries(e))t[i]=r?vi(r):void 0;return t}({...hi(t,i,a,o),...qi(e,t,i,r,o),...nr(t,i,o),...lr(t,i,a,o),...ur(t,i,o),...sr(t,i,o),...Zi(t,i,o),...Yi(t,i,o),...or(t,i,a,o),...Xi(t,i,o),...Qi(t,i,o),...cr(t,i,a,o),...dr(t,i,a,o),...er(t,i,o),...ir(t,i,o),...rr(t,i,o),...ar(t,i,o),...Ji(t,i,o),...yr(e.config,t,o),...Sr(e.config,t,o),...wr(e.config,i,t,o),...vr(e.config,t,o),...Pr(e.config,t),...kr(e,t,o)})}(this,this.atem,this.model,this.commandBatching,this.atemTransitions,this.wrappedState)),this.checkFeedbacks()}checkFeedbacks(...e){super.checkFeedbacks(...e)}processReceivedCommands(t){const i=[],r={};for(const a of t)a instanceof e.Commands.TallyBySourceCommand?(this.wrappedState.tally=a.properties,this.checkFeedbacks(gr.ProgramTally,gr.PreviewTally)):this.config.enableCameraControl&&a instanceof e.Commands.CameraControlUpdateCommand?i.push(a):this.config.pollTimecode&&a instanceof e.Commands.TimeCommand?(this.timecodeSeconds=3600*a.properties.hour+60*a.properties.minute+a.properties.second,va(this,this.wrappedState.state,r)):this.config.pollTimecode&&a instanceof e.Commands.DisplayClockCurrentTimeCommand&&(this.displayClockSeconds=3600*a.properties.time.hours+60*a.properties.time.minutes+a.properties.time.seconds,va(this,this.wrappedState.state,r));if(this.config.enableCameraControl&&i.length>0){const e=this.wrappedState.atemCameraState.applyCommands(i),t=new Set;for(const i of e)t.add(i.cameraId);for(const e of t)ya(0,this.wrappedState.atemCameraState.get(e)??(0,hr.createEmptyState)(e),r)}Object.keys(r).length>0&&this.setVariableValues(r)}processStateChange(e,t){this.wrappedState.state=e,this.wrappedState.mediaPoolCache.checkUpdatedState(e);let i=!1;const r=new Set,a={meProgram:new Set,mePreview:new Set,transitionPosition:new Set,auxes:new Set,dsk:new Set,usk:new Set,macros:new Set,ssrc:new Set,mediaPlayer:new Set,streaming:!1,recording:!1,fairlightAudio:new Set,fairlightAudioMaster:!1,fairlightAudioMonitor:!1,fairlightRoutingSources:new Set,fairlightRoutingOutputs:new Set,classicAudio:new Set,mvWindow:new Set};for(const e of t){if(i)break;const t=e.match(/video.auxilliaries.(\d+)/);if(t){r.add(gr.AuxBG),r.add(gr.AuxVariables),a.auxes.add(parseInt(t[1],10));continue}const o=e.match(/video.downstreamKeyers.(\d+)/);if(o){a.dsk.add(parseInt(o[1],10)),r.add(gr.DSKOnAir),r.add(gr.DSKTie),r.add(gr.DSKSource),r.add(gr.DSKSourceVariables);continue}const n=e.match(/fairlight.inputs.(\d+)/);if(n){a.fairlightAudio.add(parseInt(n[1],10)),r.add(gr.FairlightAudioInputGain),r.add(gr.FairlightAudioFaderGain),r.add(gr.FairlightAudioMixOption);continue}const s=e.match(/audio.channels.(\d+)/);if(s){a.classicAudio.add(parseInt(s[1],10)),r.add(gr.ClassicAudioGain),r.add(gr.ClassicAudioMixOption);continue}if(e.match(/fairlight.master/)){a.fairlightAudioMaster=!0,r.add(gr.FairlightAudioMasterGain);continue}if(e.match(/fairlight.monitor/)){a.fairlightAudioMonitor=!0,r.add(gr.FairlightAudioMonitorOutputFaderGain),r.add(gr.FairlightAudioMonitorMasterGain),r.add(gr.FairlightAudioMonitorMasterMuted),r.add(gr.FairlightAudioMonitorSidetoneGain),r.add(gr.FairlightAudioMonitorTalkbackGain),r.add(gr.FairlightAudioMonitorTalkbackMuted);continue}if(e.match(/fairlight.solo/)){r.add(gr.FairlightAudioMonitorSolo);continue}if(e.match(/^inputs/)){i=!0;break}if(e.match(/video.mixEffects.(\d+).upstreamKeyers.(\d+).flyProperties/)){r.add(gr.USKKeyFrame);continue}if(e.match(/video.mixEffects.(\d+).upstreamKeyers.(\d+).onAir/)){r.add(gr.USKOnAir);continue}const l=e.match(/video.mixEffects.(\d+).upstreamKeyers.(\d+)/);if(l){const e=parseInt(l[1],10),t=parseInt(l[2],10);a.usk.add([e,t]),r.add(gr.USKType),r.add(gr.USKSource),r.add(gr.USKSourceVariables);continue}const u=e.match(/macro.macroProperties.(\d+)/);if(u){const e=parseInt(u[1],10);a.macros.add(e),r.add(gr.Macro);continue}if(e.match(/macro.macroRecorder/)||e.match(/macro.macroPlayer/)){r.add(gr.Macro),r.add(gr.MacroLoop);continue}const c=e.match(/settings.multiViewers.(\d+).windows.(\d+)/);if(c){const e=parseInt(c[1],10),t=parseInt(c[2],10);a.mvWindow.add([e+1,t+1]),r.add(gr.MVSource),r.add(gr.MVSourceVariables);continue}if(e.match(/settings.multiViewers.(\d+).properties/)){r.add(gr.MultiviewerLayout);continue}const d=e.match(/video.mixEffects.(\d+).programInput/);if(d){const e=parseInt(d[1],10);a.meProgram.add(e),r.add(gr.ProgramBG),r.add(gr.ProgramVariables),r.add(gr.ProgramBG2),r.add(gr.ProgramBG3),r.add(gr.ProgramBG4);continue}const p=e.match(/video.mixEffects.(\d+).previewInput/);if(p){const e=parseInt(p[1],10);a.mePreview.add(e),r.add(gr.PreviewBG),r.add(gr.PreviewVariables),r.add(gr.PreviewBG2),r.add(gr.PreviewBG3),r.add(gr.PreviewBG4);continue}const m=e.match(/video.superSources.(\d+).boxes.(\d+)/);if(m){r.add(gr.SSrcBoxSource),r.add(gr.SSrcBoxSourceVariables),r.add(gr.SSrcBoxOnAir),r.add(gr.SSrcBoxProperties),a.ssrc.add(parseInt(m[1],10));continue}if(e.match(/video.superSources.(\d+).properties/)){r.add(gr.SSrcArtOption),r.add(gr.SSrcArtSource),r.add(gr.SSrcArtProperties),r.add(gr.SSrcArtPropertiesVariables);continue}if(e.match(/video.mixEffects.(\d+).transitionProperties/)){r.add(gr.TransitionStyle),r.add(gr.TransitionSelection);continue}if(e.match(/video.mixEffects.(\d+).transitionSettings/)){r.add(gr.TransitionRate);continue}if(e.match(/video.mixEffects.(\d+).transitionPreview/)){r.add(gr.PreviewTransition);continue}const b=e.match(/video.mixEffects.(\d+).transitionPosition/);if(b){const e=parseInt(b[1],10);a.transitionPosition.add(e),r.add(gr.InTransition);continue}if(e.match(/video.mixEffects.(\d+).fadeToBlack/)){r.add(gr.FadeToBlackRate),r.add(gr.FadeToBlackIsBlack);continue}const f=e.match(/media.players.(\d+)/);if(f){const e=parseInt(f[1],10);a.mediaPlayer.add(e),r.add(gr.MediaPlayerSource),r.add(gr.MediaPlayerSourceVariables);continue}if(e.match(/media.clipPool/)||e.match(/media.stillPool/)){i=!0;break}if(e.match(/streaming.status/))r.add(gr.StreamStatus);else if(e.match(/recording.status/))r.add(gr.RecordStatus);else if(e.match(/recording.recordAllInputs/))r.add(gr.RecordISO);else if(e.match(/streaming.duration/)||e.match(/streaming.stats/))a.streaming=!0;else if(e.match(/recording.duration/))a.recording=!0;else if(e.match(/fairlight.monitor/))r.add(gr.FairlightAudioMonitorMasterMuted);else{if(e.match(/fairlight.audioRouting/)){r.add(gr.FairlightAudioRouting),r.add(gr.FairlightAudioRoutingVariables);const t=e.match(/fairlight.audioRouting.sources.(\d+)/);if(t){a.fairlightRoutingSources.add(Number(t[1]));continue}const i=e.match(/fairlight.audioRouting.outputs.(\d+)/);if(i){a.fairlightRoutingOutputs.add(Number(i[1]));continue}continue}e.match(/settings.timeMode/)&&r.add(gr.TimecodeMode)}}const o=this.invalidateCachedTallyState();i?this.updateCompanionBits():(function(e,t,i){const r={};for(const a of i.meProgram)ka(e,t,a,r);for(const a of i.mePreview)wa(e,t,a,r);for(const e of i.transitionPosition)Ea(t,e,r);for(const a of i.auxes)Aa(e,t,a,r);for(const a of i.dsk)_a(e,t,a,r);for(const[a,o]of i.usk)xa(e,t,a,o,r);for(const e of i.macros)Ta(t,e,r);for(const a of i.ssrc)Ua(e,t,a,r);for(const e of i.mediaPlayer)Oa(t,e,r);i.recording&&Da(t,r),i.streaming&&$a(t,r);for(const e of i.fairlightAudio)Ba(t,e,r);for(const e of i.classicAudio)La(t,e,r);i.fairlightAudioMaster&&ja(t,r),i.fairlightAudioMonitor&&Ka(t,r);for(const e of i.fairlightRoutingSources)Pa(t,e,r);for(const e of i.fairlightRoutingOutputs)Ia(t,e,r);for(const[a,o]of i.mvWindow)Ga(e,t,a,o,r);Object.keys(r).length>0&&e.setVariableValues(r)}(this,this.wrappedState.state,a),r.size>0&&this.checkFeedbacks(...Array.from(r)),o.size>0&&this.checkFeedbacksById(...Array.from(o)))}invalidateCachedTallyState(){const e=new Set;for(const[t,i]of this.wrappedState.tallyCache.entries())if(i.referencedFeedbackIds.size){const r=le(this.wrappedState.state,t);i.lastVisibleInputs.length===r.length&&Hn(r,i.lastVisibleInputs)||(i.referencedFeedbackIds.forEach(t=>e.add(t)),i.lastVisibleInputs=r)}else i.lastVisibleInputs=[];return e}setupAtemConnection(){this.atem=new es,this.atem.on("connected",()=>{if(this.atem?.state){this.wrappedState.state=this.atem.state,this.wrappedState.mediaPoolCache.checkUpdatedState(this.atem.state),this.invalidateCachedTallyState();const e=this.wrappedState.state.info;this.log("info","Connected to a "+e.productIdentifier),this.updateStatus(t.InstanceStatus.Ok);const r=this.getBestModelId(),a=r?at(r):void 0;a?this.model=a:(this.model=function({info:e,inputs:t,settings:r,streaming:a,recording:o,audio:n,fairlight:s,displayClock:l}){const u=ot(),c=ie(Object.values(t)).map(e=>({id:e.inputId,portType:e.internalPortType,sourceAvailability:e.sourceAvailability,meAvailability:e.meAvailability}));return{id:e.model,label:e.productIdentifier??"Blackmagic ATEM",inputs:c,outputs:e.capabilities?be("Aux/Output",e.capabilities.auxilliaries):u.outputs,MEs:e.capabilities?.mixEffects??u.MEs,USKs:e.mixEffects[0]?.keyCount??u.USKs,DSKs:e.capabilities?.downstreamKeyers??u.DSKs,MVs:r.multiViewers.length,multiviewerFullGrid:(r.multiViewers?.[0]?.windows.length||0)>10,DVEs:e.capabilities?.DVEs??u.DVEs,SSrc:e.capabilities?.superSources??u.SSrc,macros:e.macroPool?.macroCount??u.macros,displayClock:l?1:0,media:{players:e.capabilities?.mediaPlayers??u.media.players,stills:e.mediaPool?.stillCount??u.media.stills,clips:e.mediaPool?.clipCount??u.media.clips,captureStills:!!e.mediaPool?.stillCount&&e.model>=i.Model.Mini},streaming:null!=a,recording:null!=o,recordISO:null!=o?.recordAllInputs,classicAudio:n?{inputs:ie(Object.entries(n.channels).map(([e,t])=>{if(t?.portType)return{id:Number(e),portType:t.portType}}))}:void 0,fairlightAudio:s?{monitor:s.monitor?"split":null,audioRouting:s.audioRouting?nt(s.audioRouting):void 0,inputs:ie(Object.entries(s.inputs).map(([e,t])=>{if(t?.properties)return{id:Number(e),portType:t.properties.externalPortType,maxDelay:Math.max(...Object.values(t.sources).map(e=>e?.properties?.maxFramesDelay??0))}}))}:void 0}}(this.wrappedState.state),this.updateStatus(t.InstanceStatus.UnknownWarning,`Unknown model: ${e.productIdentifier}. Some bits may be missing`)),this.config.modelID+""=="0"?(this.config.autoModelID=this.model.id,this.config.autoModelName=this.model.label):(delete this.config.autoModelID,delete this.config.autoModelName),setImmediate(()=>{console.log("save",this.config),this.saveConfig(this.config)});const o=this.config.modelID?parseInt(this.config.modelID,10):void 0;0!==o&&void 0!==o&&o!==this.model.id&&this.log("warn","Connected to a "+e.productIdentifier+", but instance is configured for "+this.model.label+".  Change instance to 'Auto Detect' or the appropriate model to ensure stability."),this.updateCompanionBits(),!this.durationInterval&&(this.wrappedState.state.streaming||this.wrappedState.state.recording||this.config.pollTimecode)&&(this.durationInterval=setInterval(()=>{this.atem&&this.wrappedState.state.streaming&&this.atem.requestStreamingDuration().catch(e=>{this.log("debug","Request streaming duration error: "+e)}),this.atem&&this.wrappedState.state.recording&&this.atem.requestRecordingDuration().catch(e=>{this.log("debug","Request recording duration error: "+e)}),this.atem&&this.config.pollTimecode&&(this.atem.requestTime().catch(e=>{this.log("debug","Request time error: "+e)}),this.atem.requestDisplayClockTime().catch(e=>{this.log("debug","Request display clock time error: "+e)}))},500))}}),this.atem.on("info",e=>this.log("debug",e)),this.atem.on("error",e=>{this.log("error",e.message),this.updateStatus(t.InstanceStatus.UnknownError,e.message)}),this.atem.on("disconnected",()=>{this.isActive&&this.updateStatus(t.InstanceStatus.Connecting),this.log("info","Lost connection"),this.durationInterval&&(clearInterval(this.durationInterval),delete this.durationInterval)}),this.atem.on("stateChanged",this.processStateChange.bind(this)),this.atem.on("receivedCommands",this.processReceivedCommands.bind(this));const e=this.parseIpAndPort();e&&(this.updateStatus(t.InstanceStatus.Connecting),this.atem.connect(e.ip,e.port).catch(e=>{this.updateStatus(t.InstanceStatus.ConnectionFailure),this.log("error",`Connecting failed: ${e}`)}))}parseIpAndPort(){const e=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;if(this.config.bonjourHost){const[t,i]=this.config.bonjourHost.split(":"),r=Number(i);if(t.match(e)&&!isNaN(r))return{ip:t,port:r}}else if(this.config.host&&this.config.host.match(e))return{ip:this.config.host,port:void 0};return null}}(0,t.runEntrypoint)(rs,Xn)})()})();