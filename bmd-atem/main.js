/*! For license information please see main.js.LICENSE.txt */
(()=>{var __webpack_modules__={2697:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlEvents=void 0,function(e){e.LensAutoIris="lens.autoIris",e.LensAutoFocus="lens.autoFocus",e.VideoAutoWhiteBalance="video.autoWhiteBalance",e.ColorResetToDefault="color.resetToDefault"}(r||(t.AtemCameraControlEvents=r={}))},6921:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlCommandGenerator=void 0;const i=r(2622),a=r(8430),o=r(6341);t.AtemCameraControlCommandGenerator=class{lensFocus(e,t,r=!1){const n=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.Focus,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t],r));return this.addCommand(n)}lensTriggerAutoFocus(e){const t=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.AutoFocus,(0,o.constructBooleanProps)([]));return this.addCommand(t)}lensIrisFStop(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.ApertureFStop,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(r)}lensIrisNormalised(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.ApertureNormalised,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(r)}lensTriggerAutoIris(e){const t=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.AutoAperture,(0,o.constructBooleanProps)([]));return this.addCommand(t)}lensEnableOpticalImageStabilisation(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.OpticalImageStabilisation,(0,o.constructBooleanProps)([t]));return this.addCommand(r)}lensSetContinuousZoomSpeed(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Lens,a.AtemCameraControlLensParameter.SetContinuousZoomSpeed,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(r)}videoManualWhiteBalance(e,t,r){const n=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.ManualWhiteBalance,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.SINT16,[t,r]));return this.addCommand(n)}videoTriggerAutoWhiteBalance(e){const t=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.SetAutoWhiteBalance,(0,o.constructBooleanProps)([]));return this.addCommand(t)}videoExposureUs(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.ExposureUs,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.SINT32,[t]));return this.addCommand(r)}videoSharpeningLevel(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.VideoSharpeningLevel,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.SINT8,[t]));return this.addCommand(r)}videoGain(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.Gain,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.SINT8,[t]));return this.addCommand(r)}videoNdFilterStop(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Video,a.AtemCameraControlVideoParameter.NDFilterStop,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(r)}displayColorBars(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Display,a.AtemCameraControlDisplayParameter.ColorBarEnable,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.SINT8,[t?30:0]));return this.addCommand(r)}colorLiftAdjust(e,t,r,n,s){const l=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.LiftAdjust,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t,r,n,s]));return this.addCommand(l)}colorGammaAdjust(e,t,r,n,s){const l=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.GammaAdjust,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t,r,n,s]));return this.addCommand(l)}colorGainAdjust(e,t,r,n,s){const l=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.GainAdjust,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t,r,n,s]));return this.addCommand(l)}colorOffsetAdjust(e,t,r,n,s){const l=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.OffsetAdjust,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t,r,n,s]));return this.addCommand(l)}colorContrastAdjust(e,t,r){const n=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.ContrastAdjust,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[r,t]));return this.addCommand(n)}colorLumaMix(e,t){const r=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.LumaMix,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t]));return this.addCommand(r)}colorHueSaturationAdjust(e,t,r){const n=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.ColorAdjust,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.FLOAT,[t,r]));return this.addCommand(n)}colorResetAllToDefault(e){const t=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.ColorCorrection,a.AtemCameraControlColorCorrectionParameter.ResetToDefaults,(0,o.constructBooleanProps)([]));return this.addCommand(t)}mediaTriggerSetRecording(e){const t=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Media,a.AtemCameraControlMediaParameter.TransportMode,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.SINT8,[2,0,0,0,0],!1));return this.addCommand(t)}mediaTriggerSetStopped(e){const t=new i.Commands.CameraControlCommand(e,a.AtemCameraControlCategory.Media,a.AtemCameraControlMediaParameter.TransportMode,(0,o.constructNumberProps)(i.Commands.CameraControlDataType.SINT8,[0,0,0,0,0],!1));return this.addCommand(t)}}},6878:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlBatchCommandSender=void 0;const i=r(6921);class a extends i.AtemCameraControlCommandGenerator{#e;#t=[];constructor(e){super(),this.#e=e}get hasPendingCommands(){return this.#t.length>0}discardBatch(){this.#t.splice(0,this.#t.length)}async sendBatch(){const e=this.#t.splice(0,this.#t.length);return this.#e.sendCommands(e)}addCommand(e){this.#t.push(e)}}t.AtemCameraControlBatchCommandSender=a},6131:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlDirectCommandSender=void 0;const i=r(6921);class a extends i.AtemCameraControlCommandGenerator{#e;constructor(e){super(),this.#e=e}async addCommand(e){await this.#e.sendCommand(e)}}t.AtemCameraControlDirectCommandSender=a},6341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constructNumberProps=t.constructBooleanProps=void 0;const i=r(2622);t.constructBooleanProps=function(e){return{type:i.Commands.CameraControlDataType.BOOL,boolData:e,numberData:[],bigintData:[],stringData:"",relative:!1}},t.constructNumberProps=function(e,t,r=!1){return{type:e,boolData:[],numberData:t,bigintData:[],stringData:"",relative:r}}},3796:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEmptyState=void 0;const i=r(2077);t.createEmptyState=function(e){return{cameraId:e,lens:{focus:0,iris:0,opticalImageStabilisation:!1,zoomSpeed:0},video:{whiteBalance:[0,0],exposure:0,videoSharpeningLevel:i.VideoSharpeningLevel.Off,shutterSpeed:0,gain:0,ndFilterStop:0},display:{colorBarEnable:!1},colorCorrection:{liftAdjust:{red:0,green:0,blue:0,luma:0},gammaAdjust:{red:0,green:0,blue:0,luma:0},gainAdjust:{red:1,green:1,blue:1,luma:1},offsetAdjust:{red:0,green:0,blue:0,luma:0},contrastAdjust:{pivot:.5,adj:1},lumaMix:1,colorAdjust:{hue:0,saturation:1}}}}},8430:(e,t)=>{"use strict";var r,i,a,o,n,s,l,u,c,d,p,m;Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlPTZControlParameter=t.AtemCameraControlMediaParameter=t.AtemCameraControlColorCorrectionParameter=t.AtemCameraControlConfigurationParameter=t.AtemCameraControlReferenceParameter=t.AtemCameraControlTallyParameter=t.AtemCameraControlDisplayParameter=t.AtemCameraControlOutputParameter=t.AtemCameraControlAudioParameter=t.AtemCameraControlVideoParameter=t.AtemCameraControlLensParameter=t.AtemCameraControlCategory=void 0,function(e){e[e.Lens=0]="Lens",e[e.Video=1]="Video",e[e.Audio=2]="Audio",e[e.Output=3]="Output",e[e.Display=4]="Display",e[e.Tally=5]="Tally",e[e.Reference=6]="Reference",e[e.Configuration=7]="Configuration",e[e.ColorCorrection=8]="ColorCorrection",e[e.Media=10]="Media",e[e.PTZControl=11]="PTZControl"}(r||(t.AtemCameraControlCategory=r={})),function(e){e[e.Focus=0]="Focus",e[e.AutoFocus=1]="AutoFocus",e[e.ApertureFStop=2]="ApertureFStop",e[e.ApertureNormalised=3]="ApertureNormalised",e[e.ApertureOrdinal=4]="ApertureOrdinal",e[e.AutoAperture=5]="AutoAperture",e[e.OpticalImageStabilisation=6]="OpticalImageStabilisation",e[e.SetAbsoluteZoomMM=7]="SetAbsoluteZoomMM",e[e.SetAbsoluteZoomNormalised=8]="SetAbsoluteZoomNormalised",e[e.SetContinuousZoomSpeed=9]="SetContinuousZoomSpeed"}(i||(t.AtemCameraControlLensParameter=i={})),function(e){e[e.VideoMode=0]="VideoMode",e[e.GainCamera4_9=1]="GainCamera4_9",e[e.ManualWhiteBalance=2]="ManualWhiteBalance",e[e.SetAutoWhiteBalance=3]="SetAutoWhiteBalance",e[e.RestoreAutoWhiteBalance=4]="RestoreAutoWhiteBalance",e[e.ExposureUs=5]="ExposureUs",e[e.ExposureOrdinal=6]="ExposureOrdinal",e[e.DynamicRangeMode=7]="DynamicRangeMode",e[e.VideoSharpeningLevel=8]="VideoSharpeningLevel",e[e.RecordingFormat=9]="RecordingFormat",e[e.SetAutoExpsureMode=10]="SetAutoExpsureMode",e[e.ShutterAngle=11]="ShutterAngle",e[e.ShutterSpeed=12]="ShutterSpeed",e[e.Gain=13]="Gain",e[e.ISO=14]="ISO",e[e.DisplayLUT=15]="DisplayLUT",e[e.NDFilterStop=16]="NDFilterStop"}(a||(t.AtemCameraControlVideoParameter=a={})),function(e){e[e.MicLevel=0]="MicLevel",e[e.HeadphoneLevel=1]="HeadphoneLevel",e[e.HeadphoneProgramMix=2]="HeadphoneProgramMix",e[e.SpeakerLevel=3]="SpeakerLevel",e[e.InputType=4]="InputType",e[e.InputLevels=5]="InputLevels",e[e.PhantomPower=6]="PhantomPower"}(o||(t.AtemCameraControlAudioParameter=o={})),function(e){e[e.OverlayEnables=0]="OverlayEnables",e[e.FrameGuidesStyleCamera3_x=1]="FrameGuidesStyleCamera3_x",e[e.FrameGuidesOpacityCamera3_x=2]="FrameGuidesOpacityCamera3_x",e[e.Overlays=3]="Overlays"}(n||(t.AtemCameraControlOutputParameter=n={})),function(e){e[e.Brightness=0]="Brightness",e[e.ExposureAndFocusTools=1]="ExposureAndFocusTools",e[e.ZebraLevel=2]="ZebraLevel",e[e.PeakingLevel=3]="PeakingLevel",e[e.ColorBarEnable=4]="ColorBarEnable",e[e.FocusAssist=5]="FocusAssist",e[e.ProgramReturnFeedEnable=6]="ProgramReturnFeedEnable",e[e.TimecodeSource=7]="TimecodeSource"}(s||(t.AtemCameraControlDisplayParameter=s={})),function(e){e[e.TallyBrightness=0]="TallyBrightness",e[e.FrontTallyBrightness=1]="FrontTallyBrightness",e[e.RearTallyBrightness=2]="RearTallyBrightness"}(l||(t.AtemCameraControlTallyParameter=l={})),function(e){e[e.Source=0]="Source",e[e.Offset=1]="Offset"}(u||(t.AtemCameraControlReferenceParameter=u={})),function(e){e[e.RealTimEClock=0]="RealTimEClock",e[e.SystemLanguage=1]="SystemLanguage",e[e.Timezone=2]="Timezone",e[e.Location=3]="Location"}(c||(t.AtemCameraControlConfigurationParameter=c={})),function(e){e[e.LiftAdjust=0]="LiftAdjust",e[e.GammaAdjust=1]="GammaAdjust",e[e.GainAdjust=2]="GainAdjust",e[e.OffsetAdjust=3]="OffsetAdjust",e[e.ContrastAdjust=4]="ContrastAdjust",e[e.LumaMix=5]="LumaMix",e[e.ColorAdjust=6]="ColorAdjust",e[e.ResetToDefaults=7]="ResetToDefaults"}(d||(t.AtemCameraControlColorCorrectionParameter=d={})),function(e){e[e.Codec=0]="Codec",e[e.TransportMode=1]="TransportMode",e[e.PlaybackControl=2]="PlaybackControl",e[e.Stream=5]="Stream",e[e.StreamInformation=6]="StreamInformation",e[e.StreamDsiplay3DLUT=7]="StreamDsiplay3DLUT"}(p||(t.AtemCameraControlMediaParameter=p={})),function(e){e[e.PanTiltVelocity=0]="PanTiltVelocity",e[e.MemoryPreset=1]="MemoryPreset"}(m||(t.AtemCameraControlPTZControlParameter=m={}))},4275:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1635);i.__exportStar(r(6921),t),i.__exportStar(r(6878),t),i.__exportStar(r(6131),t),i.__exportStar(r(1173),t),i.__exportStar(r(2697),t),i.__exportStar(r(3796),t),i.__exportStar(r(2077),t)},2077:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoSharpeningLevel=void 0,function(e){e[e.Off=0]="Off",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(r||(t.VideoSharpeningLevel=r={}))},142:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertNever=t.ChangesTracker=void 0;const i=r(2622);t.ChangesTracker=class{#r=new Map;getResult(){return Array.from(this.#r.values())}#i(e){let t=this.#r.get(e);return t||(t={cameraId:e,changes:[],events:[],unhandledMessages:[],invalidMessages:[]},this.#r.set(e,t)),t}addChange(e,t){const r=this.#i(e);r.changes.includes(t)||r.changes.push(t)}addEvent(e,t){const r=this.#i(e);r.events.includes(t)||r.events.push(t)}addUnhandledMessage(e){this.#i(e.source).unhandledMessages.push({categoryId:e.category,parameterId:e.parameter})}checkMessageParameters(e,t,r){let a=e.properties.type===t;if(a)switch(t){case i.Commands.CameraControlDataType.BOOL:a=e.properties.boolData.length>=r;break;case i.Commands.CameraControlDataType.SINT8:case i.Commands.CameraControlDataType.SINT16:case i.Commands.CameraControlDataType.SINT32:case i.Commands.CameraControlDataType.FLOAT:a=e.properties.numberData.length>=r;break;case i.Commands.CameraControlDataType.SINT64:a=e.properties.bigintData.length>=r;break;case i.Commands.CameraControlDataType.STRING:a=e.properties.stringData.length>=r;break;default:a=!1}return a||this.#i(e.source).invalidMessages.push({categoryId:e.category,parameterId:e.parameter}),a}},t.assertNever=function(e){}},6422:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyColorCorrectionCommand=void 0;const i=r(2622),a=r(142),o=r(8430),n=r(2697);t.applyColorCorrectionCommand=function(e,t,r){const s=t.parameter;switch(s){case o.AtemCameraControlColorCorrectionParameter.LiftAdjust:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,4))return;return r.colorCorrection.liftAdjust={red:t.properties.numberData[0],green:t.properties.numberData[1],blue:t.properties.numberData[2],luma:t.properties.numberData[3]},void e.addChange(t.source,"colorCorrection.liftAdjust");case o.AtemCameraControlColorCorrectionParameter.GammaAdjust:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,4))return;return r.colorCorrection.gammaAdjust={red:t.properties.numberData[0],green:t.properties.numberData[1],blue:t.properties.numberData[2],luma:t.properties.numberData[3]},void e.addChange(t.source,"colorCorrection.gammaAdjust");case o.AtemCameraControlColorCorrectionParameter.GainAdjust:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,4))return;return r.colorCorrection.gainAdjust={red:t.properties.numberData[0],green:t.properties.numberData[1],blue:t.properties.numberData[2],luma:t.properties.numberData[3]},void e.addChange(t.source,"colorCorrection.gainAdjust");case o.AtemCameraControlColorCorrectionParameter.OffsetAdjust:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,4))return;return r.colorCorrection.offsetAdjust={red:t.properties.numberData[0],green:t.properties.numberData[1],blue:t.properties.numberData[2],luma:t.properties.numberData[3]},void e.addChange(t.source,"colorCorrection.offsetAdjust");case o.AtemCameraControlColorCorrectionParameter.ContrastAdjust:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,2))return;return r.colorCorrection.contrastAdjust={pivot:t.properties.numberData[0],adj:t.properties.numberData[1]},void e.addChange(t.source,"colorCorrection.contrastAdjust");case o.AtemCameraControlColorCorrectionParameter.LumaMix:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,1))return;return r.colorCorrection.lumaMix=t.properties.numberData[0],void e.addChange(t.source,"colorCorrection.lumaMix");case o.AtemCameraControlColorCorrectionParameter.ColorAdjust:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,2))return;return r.colorCorrection.colorAdjust={hue:t.properties.numberData[0],saturation:t.properties.numberData[1]},void e.addChange(t.source,"colorCorrection.colorAdjust");case o.AtemCameraControlColorCorrectionParameter.ResetToDefaults:return void e.addEvent(t.source,n.AtemCameraControlEvents.ColorResetToDefault);default:return(0,a.assertNever)(s),void e.addUnhandledMessage(t)}}},2083:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyDisplayCommand=void 0;const i=r(2622),a=r(142),o=r(8430);t.applyDisplayCommand=function(e,t,r){const n=t.parameter;switch(n){case o.AtemCameraControlDisplayParameter.ColorBarEnable:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.SINT8,1))return;return r.display.colorBarEnable=t.properties.numberData[0]>1,void e.addChange(t.source,"lens.focus");case o.AtemCameraControlDisplayParameter.Brightness:case o.AtemCameraControlDisplayParameter.ExposureAndFocusTools:case o.AtemCameraControlDisplayParameter.ZebraLevel:case o.AtemCameraControlDisplayParameter.PeakingLevel:case o.AtemCameraControlDisplayParameter.FocusAssist:case o.AtemCameraControlDisplayParameter.ProgramReturnFeedEnable:case o.AtemCameraControlDisplayParameter.TimecodeSource:return void e.addUnhandledMessage(t);default:return(0,a.assertNever)(n),void e.addUnhandledMessage(t)}}},3477:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyLensCommand=void 0;const i=r(2622),a=r(142),o=r(8430),n=r(2697);t.applyLensCommand=function(e,t,r){const s=t.parameter;switch(s){case o.AtemCameraControlLensParameter.Focus:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,1))return;return r.lens.focus=t.properties.numberData[0],void e.addChange(t.source,"lens.focus");case o.AtemCameraControlLensParameter.AutoFocus:return void e.addEvent(t.source,n.AtemCameraControlEvents.LensAutoFocus);case o.AtemCameraControlLensParameter.ApertureFStop:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,1))return;return r.lens.iris=t.properties.numberData[0],void e.addChange(t.source,"lens.iris");case o.AtemCameraControlLensParameter.AutoAperture:return void e.addEvent(t.source,n.AtemCameraControlEvents.LensAutoIris);case o.AtemCameraControlLensParameter.OpticalImageStabilisation:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.BOOL,1))return;return r.lens.opticalImageStabilisation=t.properties.boolData[0],void e.addChange(t.source,"lens.opticalImageStabilisation");case o.AtemCameraControlLensParameter.SetContinuousZoomSpeed:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,1))return;return r.lens.zoomSpeed=t.properties.numberData[0],void e.addChange(t.source,"lens.zoomSpeed");case o.AtemCameraControlLensParameter.ApertureNormalised:case o.AtemCameraControlLensParameter.ApertureOrdinal:case o.AtemCameraControlLensParameter.SetAbsoluteZoomMM:case o.AtemCameraControlLensParameter.SetAbsoluteZoomNormalised:return void e.addUnhandledMessage(t);default:return(0,a.assertNever)(s),void e.addUnhandledMessage(t)}}},1173:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtemCameraControlStateBuilder=void 0;const i=r(142),a=r(2558),o=r(3477),n=r(2083),s=r(6422),l=r(3796),u=r(8430);t.AtemCameraControlStateBuilder=class{#a=new Map;constructor(e){this.reset(e)}reset(e){this.#a.clear();for(let t=1;t<=e;t++)this.#a.set(t,(0,l.createEmptyState)(t))}get(e){return this.#a.get(e)}getAll(){return Array.from(this.#a.values())}#o(e){let t=this.#a.get(e);return t||(t=(0,l.createEmptyState)(e),this.#a.set(e,t)),t}applyCommands(e){if(0===e.length)return[];const t=new i.ChangesTracker;for(const r of e){const e=this.#o(r.source),l=r.category;switch(l){case u.AtemCameraControlCategory.Lens:(0,o.applyLensCommand)(t,r,e);break;case u.AtemCameraControlCategory.Video:(0,a.applyVideoCommand)(t,r,e);break;case u.AtemCameraControlCategory.Display:(0,n.applyDisplayCommand)(t,r,e);break;case u.AtemCameraControlCategory.ColorCorrection:(0,s.applyColorCorrectionCommand)(t,r,e);break;case u.AtemCameraControlCategory.Audio:case u.AtemCameraControlCategory.Output:case u.AtemCameraControlCategory.Tally:case u.AtemCameraControlCategory.Reference:case u.AtemCameraControlCategory.Configuration:case u.AtemCameraControlCategory.Media:case u.AtemCameraControlCategory.PTZControl:t.addUnhandledMessage(r);break;default:(0,i.assertNever)(l),t.addUnhandledMessage(r)}}return t.getResult()}}},2558:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyVideoCommand=void 0;const i=r(2622),a=r(142),o=r(8430),n=r(2697);t.applyVideoCommand=function(e,t,r){const s=t.parameter;switch(s){case o.AtemCameraControlVideoParameter.GainCamera4_9:return;case o.AtemCameraControlVideoParameter.ManualWhiteBalance:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.SINT16,2))return;return r.video.whiteBalance=[t.properties.numberData[0],t.properties.numberData[1]],void e.addChange(t.source,"video.whiteBalance");case o.AtemCameraControlVideoParameter.SetAutoWhiteBalance:return void e.addEvent(t.source,n.AtemCameraControlEvents.VideoAutoWhiteBalance);case o.AtemCameraControlVideoParameter.ExposureUs:{if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.SINT32,1))return;const a=1e6/t.properties.numberData[0],o=a>1e3?10*Math.round(a/10):Math.round(a);return r.video.exposure=t.properties.numberData[0],r.video.shutterSpeed=o,e.addChange(t.source,"video.exposure"),void e.addChange(t.source,"video.shutterSpeed")}case o.AtemCameraControlVideoParameter.VideoSharpeningLevel:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.SINT8,1))return;return r.video.videoSharpeningLevel=t.properties.numberData[0],void e.addChange(t.source,"video.videoSharpeningLevel");case o.AtemCameraControlVideoParameter.Gain:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.SINT8,1))return;return r.video.gain=t.properties.numberData[0],void e.addChange(t.source,"video.gain");case o.AtemCameraControlVideoParameter.NDFilterStop:if(!e.checkMessageParameters(t,i.Commands.CameraControlDataType.FLOAT,1))return;return r.video.ndFilterStop=t.properties.numberData[0],void e.addChange(t.source,"video.ndFilterStop");case o.AtemCameraControlVideoParameter.VideoMode:case o.AtemCameraControlVideoParameter.RestoreAutoWhiteBalance:case o.AtemCameraControlVideoParameter.ExposureOrdinal:case o.AtemCameraControlVideoParameter.DynamicRangeMode:case o.AtemCameraControlVideoParameter.RecordingFormat:case o.AtemCameraControlVideoParameter.SetAutoExpsureMode:case o.AtemCameraControlVideoParameter.ShutterAngle:case o.AtemCameraControlVideoParameter.ShutterSpeed:case o.AtemCameraControlVideoParameter.ISO:case o.AtemCameraControlVideoParameter.DisplayLUT:return void e.addUnhandledMessage(t);default:return(0,a.assertNever)(s),void e.addUnhandledMessage(t)}}},2996:(e,t,r)=>{"use strict";t.zC=void 0;r(6982);const i=r(8730);r(8730);t.zC=function(e,t,r){return function(e,t,r){if(!i.Native)throw new Error("Library failed to initialise");const a=Buffer.alloc(e*t*4);return i.Native.convertYuva422ToRgba(e,t,r,a),a}(e,t,r)}},8730:(e,t,r)=>{"use strict";let i,a;Object.defineProperty(t,"__esModule",{value:!0}),t.NativeError=t.Native=void 0;try{t.Native=i=r(4225)}catch(e){t.NativeError=a=e}},4225:(e,t,r)=>{const{existsSync:i,readFileSync:a}=r(9896),{join:o}=r(6928),{platform:n,arch:s}=process;let l=null,u=null;const c=require;function d(e){const t=[o(__dirname,e),o(__dirname,"prebuilds",e)];for(const e of t)if(i(e))return c(e)}function p(){if(process.report&&"function"==typeof process.report.getReport){const{glibcVersionRuntime:e}=process.report.getReport().header;return!e}try{const e=r(5317).execSync("which ldd").toString().trim();return a(e,"utf8").includes("musl")}catch(e){return!0}}switch(n){case"android":switch(s){case"arm64":try{l=d("atem-connection-image-tools.android-arm64.node")}catch(e){u=e}break;case"arm":try{l=d("atem-connection-image-tools.android-arm-eabi.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Android ${s}`)}break;case"win32":switch(s){case"x64":try{l=d("atem-connection-image-tools.win32-x64-msvc.node")}catch(e){u=e}break;case"ia32":try{l=d("atem-connection-image-tools.win32-ia32-msvc.node")}catch(e){u=e}break;case"arm64":try{l=d("atem-connection-image-tools.win32-arm64-msvc.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Windows: ${s}`)}break;case"darwin":try{if(l=d("atem-connection-image-tools.darwin-universal.node"),l)break}catch{}switch(s){case"x64":try{l=d("atem-connection-image-tools.darwin-x64.node")}catch(e){u=e}break;case"arm64":try{l=d("atem-connection-image-tools.darwin-arm64.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on macOS: ${s}`)}break;case"freebsd":if("x64"!==s)throw new Error(`Unsupported architecture on FreeBSD: ${s}`);try{l=d("atem-connection-image-tools.freebsd-x64.node")}catch(e){u=e}break;case"linux":switch(s){case"x64":if(p())try{l=d("atem-connection-image-tools.linux-x64-musl.node")}catch(e){u=e}else try{l=d("atem-connection-image-tools.linux-x64-gnu.node")}catch(e){u=e}break;case"arm64":if(p())try{l=d("atem-connection-image-tools.linux-arm64-musl.node")}catch(e){u=e}else try{l=d("atem-connection-image-tools.linux-arm64-gnu.node")}catch(e){u=e}break;case"arm":try{l=d("atem-connection-image-tools.linux-arm-gnueabihf.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Linux: ${s}`)}break;default:throw new Error(`Unsupported OS: ${n}, architecture: ${s}`)}if(!l){if(u)throw u;throw new Error("Failed to load native binding")}e.exports=l},7169:(e,t,r)=>{"use strict";const i=r(2017);i.code='require("ajv/dist/runtime/equal").default',t.A=i},3693:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function i(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,i,o,n){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new a(i,o||e,n),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function n(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,i,a=[];if(0===this._eventsCount)return a;for(i in e=this._events)t.call(e,i)&&a.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,o=i.length,n=new Array(o);a<o;a++)n[a]=i[a].fn;return n},s.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},s.prototype.emit=function(e,t,i,a,o,n){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,a),!0;case 5:return c.fn.call(c.context,t,i,a,o),!0;case 6:return c.fn.call(c.context,t,i,a,o,n),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var p,m=c.length;for(u=0;u<m;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,i);break;case 4:c[u].fn.call(c[u].context,t,i,a);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,i,a){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return n(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||a&&!s.once||i&&s.context!==i||n(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||a&&!s[l].once||i&&s[l].context!==i)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:n(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&n(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},6444:(e,t,r)=>{const{existsSync:i,readFileSync:a}=r(9896),{join:o}=r(6928),{platform:n,arch:s}=process;let l=null,u=null;const c=require;function d(e){const t=[o(__dirname,e),o(__dirname,"prebuilds",e)];for(const e of t)if(i(e))return c(e)}function p(){if(process.report&&"function"==typeof process.report.getReport){const{glibcVersionRuntime:e}=process.report.getReport().header;return!e}try{const e=r(5317).execSync("which ldd").toString().trim();return a(e,"utf8").includes("musl")}catch(e){return!0}}switch(n){case"android":switch(s){case"arm64":try{l=d("julusian-image-rs.android-arm64.node")}catch(e){u=e}break;case"arm":try{l=d("julusian-image-rs.android-arm-eabi.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Android ${s}`)}break;case"win32":switch(s){case"x64":try{l=d("julusian-image-rs.win32-x64-msvc.node")}catch(e){u=e}break;case"ia32":try{l=d("julusian-image-rs.win32-ia32-msvc.node")}catch(e){u=e}break;case"arm64":try{l=d("julusian-image-rs.win32-arm64-msvc.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Windows: ${s}`)}break;case"darwin":try{if(l=d("julusian-image-rs.darwin-universal.node"),l)break}catch{}switch(s){case"x64":try{l=d("julusian-image-rs.darwin-x64.node")}catch(e){u=e}break;case"arm64":try{l=d("julusian-image-rs.darwin-arm64.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on macOS: ${s}`)}break;case"freebsd":if("x64"!==s)throw new Error(`Unsupported architecture on FreeBSD: ${s}`);try{l=d("julusian-image-rs.freebsd-x64.node")}catch(e){u=e}break;case"linux":switch(s){case"x64":if(p())try{l=d("julusian-image-rs.linux-x64-musl.node")}catch(e){u=e}else try{l=d("julusian-image-rs.linux-x64-gnu.node")}catch(e){u=e}break;case"arm64":if(p())try{l=d("julusian-image-rs.linux-arm64-musl.node")}catch(e){u=e}else try{l=d("julusian-image-rs.linux-arm64-gnu.node")}catch(e){u=e}break;case"arm":try{l=d("julusian-image-rs.linux-arm-gnueabihf.node")}catch(e){u=e}break;default:throw new Error(`Unsupported architecture on Linux: ${s}`)}break;default:throw new Error(`Unsupported OS: ${n}, architecture: ${s}`)}if(!l){if(u)throw u;throw new Error("Failed to load native binding")}e.exports=l},3764:(e,t,r)=>{const i=r(6444);e.exports.Ab=i.PixelFormat,e.exports.OJ=i.ResizeMode,i.RotationMode,e.exports.tc=i.ImageTransformer},9115:(e,t)=>{"use strict";var r,i,a,o,n,s,l,u,c,d,p,m,b,f,g,h,y,S,v,P,C,k,A,I,w,_,x,E,M,T,N,O,R,D,F,V,$,B;Object.defineProperty(t,"__esModule",{value:!0}),t.TimeMode=t.AudioInternalPortType=t.AudioChannelPair=t.DisplayClockClockMode=t.DisplayClockClockState=t.MultiViewerLayout=t.FairlightInputType=t.FairlightAudioSourceType=t.FairlightAnalogInputLevel=t.FairlightInputConfiguration=t.FairlightAudioMixOption=t.RecordingDiskStatus=t.RecordingStatus=t.RecordingError=t.StreamingStatus=t.StreamingError=t.AudioSourceType=t.AudioMixOption=t.MediaSourceType=t.VideoMode=t.VideoFormat=t.SuperSourceArtOption=t.FlyKeyDirection=t.FlyKeyKeyFrame=t.MixEffectKeyType=t.Pattern=t.IsAtKeyFrame=t.BorderBevel=t.MeAvailability=t.SourceAvailability=t.InternalPortType=t.ExternalPortType=t.MacroAction=t.DVEEffect=t.TransitionSelection=t.TransitionStyle=t.ProtocolVersion=t.Model=void 0,(B=t.Model||(t.Model={}))[B.Unknown=0]="Unknown",B[B.TVS=1]="TVS",B[B.OneME=2]="OneME",B[B.TwoME=3]="TwoME",B[B.PS4K=4]="PS4K",B[B.OneME4K=5]="OneME4K",B[B.TwoME4K=6]="TwoME4K",B[B.TwoMEBS4K=7]="TwoMEBS4K",B[B.TVSHD=8]="TVSHD",B[B.TVSProHD=9]="TVSProHD",B[B.TVSPro4K=10]="TVSPro4K",B[B.Constellation=11]="Constellation",B[B.Constellation8K=12]="Constellation8K",B[B.Mini=13]="Mini",B[B.MiniPro=14]="MiniPro",B[B.MiniProISO=15]="MiniProISO",B[B.MiniExtreme=16]="MiniExtreme",B[B.MiniExtremeISO=17]="MiniExtremeISO",B[B.ConstellationHD1ME=18]="ConstellationHD1ME",B[B.ConstellationHD2ME=19]="ConstellationHD2ME",B[B.ConstellationHD4ME=20]="ConstellationHD4ME",B[B.SDI=21]="SDI",B[B.SDIProISO=22]="SDIProISO",B[B.SDIExtremeISO=23]="SDIExtremeISO",B[B.TelevisionStudioHD8=26]="TelevisionStudioHD8",B[B.TelevisionStudioHD8ISO=27]="TelevisionStudioHD8ISO",B[B.Constellation4K1ME=28]="Constellation4K1ME",B[B.Constellation4K2ME=29]="Constellation4K2ME",B[B.Constellation4K4ME=30]="Constellation4K4ME",B[B.TelevisionStudio4K8=32]="TelevisionStudio4K8",($=t.ProtocolVersion||(t.ProtocolVersion={}))[$.V7_2=131094]="V7_2",$[$.V7_5_2=131099]="V7_5_2",$[$.V8_0=131100]="V8_0",$[$.V8_0_1=131101]="V8_0_1",$[$.V8_1_1=131102]="V8_1_1",$[$.V9_4=131103]="V9_4",$[$.V9_6=131104]="V9_6",(V=t.TransitionStyle||(t.TransitionStyle={}))[V.MIX=0]="MIX",V[V.DIP=1]="DIP",V[V.WIPE=2]="WIPE",V[V.DVE=3]="DVE",V[V.STING=4]="STING",(F=t.TransitionSelection||(t.TransitionSelection={}))[F.Background=1]="Background",F[F.Key1=2]="Key1",F[F.Key2=4]="Key2",F[F.Key3=8]="Key3",F[F.Key4=16]="Key4",(D=t.DVEEffect||(t.DVEEffect={}))[D.SwooshTopLeft=0]="SwooshTopLeft",D[D.SwooshTop=1]="SwooshTop",D[D.SwooshTopRight=2]="SwooshTopRight",D[D.SwooshLeft=3]="SwooshLeft",D[D.SwooshRight=4]="SwooshRight",D[D.SwooshBottomLeft=5]="SwooshBottomLeft",D[D.SwooshBottom=6]="SwooshBottom",D[D.SwooshBottomRight=7]="SwooshBottomRight",D[D.SpinCCWTopRight=13]="SpinCCWTopRight",D[D.SpinCWTopLeft=8]="SpinCWTopLeft",D[D.SpinCCWBottomRight=15]="SpinCCWBottomRight",D[D.SpinCWBottomLeft=10]="SpinCWBottomLeft",D[D.SpinCWTopRight=9]="SpinCWTopRight",D[D.SpinCCWTopLeft=12]="SpinCCWTopLeft",D[D.SpinCWBottomRight=11]="SpinCWBottomRight",D[D.SpinCCWBottomLeft=14]="SpinCCWBottomLeft",D[D.SqueezeTopLeft=16]="SqueezeTopLeft",D[D.SqueezeTop=17]="SqueezeTop",D[D.SqueezeTopRight=18]="SqueezeTopRight",D[D.SqueezeLeft=19]="SqueezeLeft",D[D.SqueezeRight=20]="SqueezeRight",D[D.SqueezeBottomLeft=21]="SqueezeBottomLeft",D[D.SqueezeBottom=22]="SqueezeBottom",D[D.SqueezeBottomRight=23]="SqueezeBottomRight",D[D.PushTopLeft=24]="PushTopLeft",D[D.PushTop=25]="PushTop",D[D.PushTopRight=26]="PushTopRight",D[D.PushLeft=27]="PushLeft",D[D.PushRight=28]="PushRight",D[D.PushBottomLeft=29]="PushBottomLeft",D[D.PushBottom=30]="PushBottom",D[D.PushBottomRight=31]="PushBottomRight",D[D.GraphicCWSpin=32]="GraphicCWSpin",D[D.GraphicCCWSpin=33]="GraphicCCWSpin",D[D.GraphicLogoWipe=34]="GraphicLogoWipe",(R=t.MacroAction||(t.MacroAction={}))[R.Run=0]="Run",R[R.Stop=1]="Stop",R[R.StopRecord=2]="StopRecord",R[R.InsertUserWait=3]="InsertUserWait",R[R.Continue=4]="Continue",R[R.Delete=5]="Delete",(O=t.ExternalPortType||(t.ExternalPortType={}))[O.Unknown=0]="Unknown",O[O.SDI=1]="SDI",O[O.HDMI=2]="HDMI",O[O.Component=4]="Component",O[O.Composite=8]="Composite",O[O.SVideo=16]="SVideo",O[O.XLR=32]="XLR",O[O.AESEBU=64]="AESEBU",O[O.RCA=128]="RCA",O[O.Internal=256]="Internal",O[O.TSJack=512]="TSJack",O[O.MADI=1024]="MADI",O[O.TRSJack=2048]="TRSJack",O[O.RJ45=4096]="RJ45",(N=t.InternalPortType||(t.InternalPortType={}))[N.External=0]="External",N[N.Black=1]="Black",N[N.ColorBars=2]="ColorBars",N[N.ColorGenerator=3]="ColorGenerator",N[N.MediaPlayerFill=4]="MediaPlayerFill",N[N.MediaPlayerKey=5]="MediaPlayerKey",N[N.SuperSource=6]="SuperSource",N[N.ExternalDirect=7]="ExternalDirect",N[N.MEOutput=128]="MEOutput",N[N.Auxiliary=129]="Auxiliary",N[N.Mask=130]="Mask",N[N.MultiViewer=131]="MultiViewer",(T=t.SourceAvailability||(t.SourceAvailability={}))[T.None=0]="None",T[T.Auxiliary=1]="Auxiliary",T[T.Multiviewer=2]="Multiviewer",T[T.SuperSourceArt=4]="SuperSourceArt",T[T.SuperSourceBox=8]="SuperSourceBox",T[T.KeySource=16]="KeySource",T[T.Auxiliary1=32]="Auxiliary1",T[T.Auxiliary2=64]="Auxiliary2",T[T.All=127]="All",(M=t.MeAvailability||(t.MeAvailability={}))[M.None=0]="None",M[M.Me1=1]="Me1",M[M.Me2=2]="Me2",M[M.Me3=4]="Me3",M[M.Me4=8]="Me4",M[M.All=15]="All",(E=t.BorderBevel||(t.BorderBevel={}))[E.None=0]="None",E[E.InOut=1]="InOut",E[E.In=2]="In",E[E.Out=3]="Out",(x=t.IsAtKeyFrame||(t.IsAtKeyFrame={}))[x.None=0]="None",x[x.A=1]="A",x[x.B=2]="B",x[x.RunToInfinite=4]="RunToInfinite",(_=t.Pattern||(t.Pattern={}))[_.LeftToRightBar=0]="LeftToRightBar",_[_.TopToBottomBar=1]="TopToBottomBar",_[_.HorizontalBarnDoor=2]="HorizontalBarnDoor",_[_.VerticalBarnDoor=3]="VerticalBarnDoor",_[_.CornersInFourBox=4]="CornersInFourBox",_[_.RectangleIris=5]="RectangleIris",_[_.DiamondIris=6]="DiamondIris",_[_.CircleIris=7]="CircleIris",_[_.TopLeftBox=8]="TopLeftBox",_[_.TopRightBox=9]="TopRightBox",_[_.BottomRightBox=10]="BottomRightBox",_[_.BottomLeftBox=11]="BottomLeftBox",_[_.TopCentreBox=12]="TopCentreBox",_[_.RightCentreBox=13]="RightCentreBox",_[_.BottomCentreBox=14]="BottomCentreBox",_[_.LeftCentreBox=15]="LeftCentreBox",_[_.TopLeftDiagonal=16]="TopLeftDiagonal",_[_.TopRightDiagonal=17]="TopRightDiagonal",(w=t.MixEffectKeyType||(t.MixEffectKeyType={}))[w.Luma=0]="Luma",w[w.Chroma=1]="Chroma",w[w.Pattern=2]="Pattern",w[w.DVE=3]="DVE",(I=t.FlyKeyKeyFrame||(t.FlyKeyKeyFrame={}))[I.None=0]="None",I[I.A=1]="A",I[I.B=2]="B",I[I.Full=3]="Full",I[I.RunToInfinite=4]="RunToInfinite",(A=t.FlyKeyDirection||(t.FlyKeyDirection={}))[A.CentreOfKey=0]="CentreOfKey",A[A.TopLeft=1]="TopLeft",A[A.TopCentre=2]="TopCentre",A[A.TopRight=3]="TopRight",A[A.MiddleLeft=4]="MiddleLeft",A[A.MiddleCentre=5]="MiddleCentre",A[A.MiddleRight=6]="MiddleRight",A[A.BottomLeft=7]="BottomLeft",A[A.BottomCentre=8]="BottomCentre",A[A.BottomRight=9]="BottomRight",(k=t.SuperSourceArtOption||(t.SuperSourceArtOption={}))[k.Background=0]="Background",k[k.Foreground=1]="Foreground",(C=t.VideoFormat||(t.VideoFormat={}))[C.SD=0]="SD",C[C.HD720=1]="HD720",C[C.HD1080=2]="HD1080",C[C.UHD4K=3]="UHD4K",C[C.UDH8K=4]="UDH8K",(P=t.VideoMode||(t.VideoMode={}))[P.N525i5994NTSC=0]="N525i5994NTSC",P[P.P625i50PAL=1]="P625i50PAL",P[P.N525i5994169=2]="N525i5994169",P[P.P625i50169=3]="P625i50169",P[P.P720p50=4]="P720p50",P[P.N720p5994=5]="N720p5994",P[P.P1080i50=6]="P1080i50",P[P.N1080i5994=7]="N1080i5994",P[P.N1080p2398=8]="N1080p2398",P[P.N1080p24=9]="N1080p24",P[P.P1080p25=10]="P1080p25",P[P.N1080p2997=11]="N1080p2997",P[P.P1080p50=12]="P1080p50",P[P.N1080p5994=13]="N1080p5994",P[P.N4KHDp2398=14]="N4KHDp2398",P[P.N4KHDp24=15]="N4KHDp24",P[P.P4KHDp25=16]="P4KHDp25",P[P.N4KHDp2997=17]="N4KHDp2997",P[P.P4KHDp5000=18]="P4KHDp5000",P[P.N4KHDp5994=19]="N4KHDp5994",P[P.N8KHDp2398=20]="N8KHDp2398",P[P.N8KHDp24=21]="N8KHDp24",P[P.P8KHDp25=22]="P8KHDp25",P[P.N8KHDp2997=23]="N8KHDp2997",P[P.P8KHDp50=24]="P8KHDp50",P[P.N8KHDp5994=25]="N8KHDp5994",P[P.N1080p30=26]="N1080p30",P[P.N1080p60=27]="N1080p60",(v=t.MediaSourceType||(t.MediaSourceType={}))[v.Still=1]="Still",v[v.Clip=2]="Clip",(S=t.AudioMixOption||(t.AudioMixOption={}))[S.Off=0]="Off",S[S.On=1]="On",S[S.AudioFollowVideo=2]="AudioFollowVideo",(y=t.AudioSourceType||(t.AudioSourceType={}))[y.ExternalVideo=0]="ExternalVideo",y[y.MediaPlayer=1]="MediaPlayer",y[y.ExternalAudio=2]="ExternalAudio",(h=t.StreamingError||(t.StreamingError={}))[h.None=0]="None",h[h.InvalidState=16]="InvalidState",h[h.Unknown=32768]="Unknown",(g=t.StreamingStatus||(t.StreamingStatus={}))[g.Idle=1]="Idle",g[g.Connecting=2]="Connecting",g[g.Streaming=4]="Streaming",g[g.Stopping=32]="Stopping",(f=t.RecordingError||(t.RecordingError={}))[f.None=2]="None",f[f.NoMedia=0]="NoMedia",f[f.MediaFull=4]="MediaFull",f[f.MediaError=8]="MediaError",f[f.MediaUnformatted=16]="MediaUnformatted",f[f.DroppingFrames=32]="DroppingFrames",f[f.Unknown=32768]="Unknown",(b=t.RecordingStatus||(t.RecordingStatus={}))[b.Idle=0]="Idle",b[b.Recording=1]="Recording",b[b.Stopping=128]="Stopping",(m=t.RecordingDiskStatus||(t.RecordingDiskStatus={}))[m.Idle=1]="Idle",m[m.Unformatted=2]="Unformatted",m[m.Active=4]="Active",m[m.Recording=8]="Recording",m[m.Removed=32]="Removed",(p=t.FairlightAudioMixOption||(t.FairlightAudioMixOption={}))[p.Off=1]="Off",p[p.On=2]="On",p[p.AudioFollowVideo=4]="AudioFollowVideo",(d=t.FairlightInputConfiguration||(t.FairlightInputConfiguration={}))[d.Mono=1]="Mono",d[d.Stereo=2]="Stereo",d[d.DualMono=4]="DualMono",(c=t.FairlightAnalogInputLevel||(t.FairlightAnalogInputLevel={}))[c.Microphone=1]="Microphone",c[c.ConsumerLine=2]="ConsumerLine",c[c.ProLine=4]="ProLine",(u=t.FairlightAudioSourceType||(t.FairlightAudioSourceType={}))[u.Mono=0]="Mono",u[u.Stereo=1]="Stereo",(l=t.FairlightInputType||(t.FairlightInputType={}))[l.EmbeddedWithVideo=0]="EmbeddedWithVideo",l[l.MediaPlayer=1]="MediaPlayer",l[l.AudioIn=2]="AudioIn",l[l.MADI=4]="MADI",(s=t.MultiViewerLayout||(t.MultiViewerLayout={}))[s.Default=0]="Default",s[s.TopLeftSmall=1]="TopLeftSmall",s[s.TopRightSmall=2]="TopRightSmall",s[s.ProgramBottom=3]="ProgramBottom",s[s.BottomLeftSmall=4]="BottomLeftSmall",s[s.ProgramRight=5]="ProgramRight",s[s.BottomRightSmall=8]="BottomRightSmall",s[s.ProgramLeft=10]="ProgramLeft",s[s.ProgramTop=12]="ProgramTop",(n=t.DisplayClockClockState||(t.DisplayClockClockState={}))[n.Stopped=0]="Stopped",n[n.Running=1]="Running",n[n.Reset=2]="Reset",(o=t.DisplayClockClockMode||(t.DisplayClockClockMode={}))[o.Countdown=0]="Countdown",o[o.Countup=1]="Countup",o[o.TimeOfDay=2]="TimeOfDay",(a=t.AudioChannelPair||(t.AudioChannelPair={}))[a.Channel1_2=0]="Channel1_2",a[a.Channel3_4=1]="Channel3_4",a[a.Channel5_6=2]="Channel5_6",a[a.Channel7_8=3]="Channel7_8",a[a.Channel9_10=4]="Channel9_10",a[a.Channel11_12=5]="Channel11_12",a[a.Channel13_14=6]="Channel13_14",a[a.Channel15_16=7]="Channel15_16",(i=t.AudioInternalPortType||(t.AudioInternalPortType={}))[i.NotInternal=0]="NotInternal",i[i.NoAudio=1]="NoAudio",i[i.TalkbackMix=2]="TalkbackMix",i[i.EngineeringTalkbackMix=3]="EngineeringTalkbackMix",i[i.ProductionTalkbackMix=4]="ProductionTalkbackMix",i[i.MediaPlayer=5]="MediaPlayer",i[i.Program=6]="Program",i[i.Return=7]="Return",i[i.Monitor=8]="Monitor",i[i.Madi=9]="Madi",i[i.AuxOut=10]="AuxOut",i[i.AudioAuxOut=11]="AudioAuxOut",(r=t.TimeMode||(t.TimeMode={}))[r.FreeRun=0]="FreeRun",r[r.TimeOfDay=1]="TimeOfDay"},994:(e,t,r)=>{"use strict";t.hn=t.YM=t.O2=void 0;const i=r(9115);t.O2=function(e,t,r){let a=e.media.players[t];return a||(a={playing:!1,loop:!1,atBeginning:!0,clipFrame:0,sourceType:i.MediaSourceType.Still,clipIndex:0,stillIndex:0},r||(e.media.players[t]=a)),a},t.YM=function(e,t,r){let a=e.video.mixEffects[t];return a||(a={index:t,programInput:0,previewInput:0,transitionPreview:!1,transitionPosition:{inTransition:!1,handlePosition:0,remainingFrames:0},transitionProperties:{style:i.TransitionStyle.MIX,selection:[i.TransitionSelection.Background],nextStyle:i.TransitionStyle.MIX,nextSelection:[i.TransitionSelection.Background]},transitionSettings:{},upstreamKeyers:[]},r||(e.video.mixEffects[t]=a)),a},t.hn=function(e,t,r){let i=e.video.superSources[t];return i||(i={index:t,boxes:[void 0,void 0,void 0,void 0]},r||(e.video.superSources[t]=i)),i}},3791:e=>{"use strict";const t=()=>{const e=Error.prepareStackTrace;Error.prepareStackTrace=(e,t)=>t;const t=(new Error).stack.slice(1);return Error.prepareStackTrace=e,t};e.exports=t,e.exports.default=t},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r={grad:.9,turn:360,rad:360/(2*Math.PI)},i=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},a=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},o=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},n=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},s=function(e){return{r:o(e.r,0,255),g:o(e.g,0,255),b:o(e.b,0,255),a:o(e.a)}},l=function(e){return{r:a(e.r),g:a(e.g),b:a(e.b),a:a(e.a,3)}},u=/^#([0-9a-f]{3,8})$/i,c=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,r=e.g,i=e.b,a=e.a,o=Math.max(t,r,i),n=o-Math.min(t,r,i),s=n?o===t?(r-i)/n:o===r?2+(i-t)/n:4+(t-r)/n:0;return{h:60*(s<0?s+6:s),s:o?n/o*100:0,v:o/255*100,a}},p=function(e){var t=e.h,r=e.s,i=e.v,a=e.a;t=t/360*6,r/=100,i/=100;var o=Math.floor(t),n=i*(1-r),s=i*(1-(t-o)*r),l=i*(1-(1-t+o)*r),u=o%6;return{r:255*[i,s,n,n,l,i][u],g:255*[l,i,i,s,n,n][u],b:255*[n,n,l,i,i,s][u],a}},m=function(e){return{h:n(e.h),s:o(e.s,0,100),l:o(e.l,0,100),a:o(e.a)}},b=function(e){return{h:a(e.h),s:a(e.s),l:a(e.l),a:a(e.a,3)}},f=function(e){return p((r=(t=e).s,{h:t.h,s:(r*=((i=t.l)<50?i:100-i)/100)>0?2*r/(i+r)*100:0,v:i+r,a:t.a}));var t,r,i},g=function(e){return{h:(t=d(e)).h,s:(a=(200-(r=t.s))*(i=t.v)/100)>0&&a<200?r*i/100/(a<=100?a:200-a)*100:0,l:a/2,a:t.a};var t,r,i,a},h=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,S=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,P={string:[[function(e){var t=u.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?a(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?a(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=S.exec(e)||v.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:s({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=h.exec(e)||y.exec(e);if(!t)return null;var i,a,o=m({h:(i=t[1],a=t[2],void 0===a&&(a="deg"),Number(i)*(r[a]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return f(o)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,a=e.b,o=e.a,n=void 0===o?1:o;return i(t)&&i(r)&&i(a)?s({r:Number(t),g:Number(r),b:Number(a),a:Number(n)}):null},"rgb"],[function(e){var t=e.h,r=e.s,a=e.l,o=e.a,n=void 0===o?1:o;if(!i(t)||!i(r)||!i(a))return null;var s=m({h:Number(t),s:Number(r),l:Number(a),a:Number(n)});return f(s)},"hsl"],[function(e){var t=e.h,r=e.s,a=e.v,s=e.a,l=void 0===s?1:s;if(!i(t)||!i(r)||!i(a))return null;var u=function(e){return{h:n(e.h),s:o(e.s,0,100),v:o(e.v,0,100),a:o(e.a)}}({h:Number(t),s:Number(r),v:Number(a),a:Number(l)});return p(u)},"hsv"]]},C=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0](e);if(i)return[i,t[r][1]]}return[null,void 0]},k=function(e){return"string"==typeof e?C(e.trim(),P.string):"object"==typeof e&&null!==e?C(e,P.object):[null,void 0]},A=function(e,t){var r=g(e);return{h:r.h,s:o(r.s+100*t,0,100),l:r.l,a:r.a}},I=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},w=function(e,t){var r=g(e);return{h:r.h,s:r.s,l:o(r.l+100*t,0,100),a:r.a}},_=function(){function e(e){this.parsed=k(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return a(I(this.rgba),2)},e.prototype.isDark=function(){return I(this.rgba)<.5},e.prototype.isLight=function(){return I(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=l(this.rgba)).r,r=e.g,i=e.b,n=(o=e.a)<1?c(a(255*o)):"","#"+c(t)+c(r)+c(i)+n;var e,t,r,i,o,n},e.prototype.toRgb=function(){return l(this.rgba)},e.prototype.toRgbString=function(){return t=(e=l(this.rgba)).r,r=e.g,i=e.b,(a=e.a)<1?"rgba("+t+", "+r+", "+i+", "+a+")":"rgb("+t+", "+r+", "+i+")";var e,t,r,i,a},e.prototype.toHsl=function(){return b(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=b(g(this.rgba))).h,r=e.s,i=e.l,(a=e.a)<1?"hsla("+t+", "+r+"%, "+i+"%, "+a+")":"hsl("+t+", "+r+"%, "+i+"%)";var e,t,r,i,a},e.prototype.toHsv=function(){return e=d(this.rgba),{h:a(e.h),s:a(e.s),v:a(e.v),a:a(e.a,3)};var e},e.prototype.invert=function(){return x({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),x(A(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),x(A(this.rgba,-e))},e.prototype.grayscale=function(){return x(A(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),x(w(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),x(w(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?x({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):a(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?x({h:e,s:t.s,l:t.l,a:t.a}):a(t.h)},e.prototype.isEqual=function(e){return this.toHex()===x(e).toHex()},e}(),x=function(e){return e instanceof _?e:new _(e)},E=[];t.Colord=_,t.colord=x,t.extend=function(e){e.forEach((function(e){E.indexOf(e)<0&&(e(_,P),E.push(e))}))},t.getFormat=function(e){return k(e)[1]},t.random=function(){return new _({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===i(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var a=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=a,t.convertMapToObject=function(e){return Array.from(e).reduce((function(e,t){var i,a,o=(a=2,function(e){if(Array.isArray(e))return e}(i=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,a,o=[],n=!0,s=!1;try{for(r=r.call(e);!(n=(i=r.next()).done)&&(o.push(i.value),!t||o.length!==t);n=!0);}catch(e){s=!0,a=e}finally{try{n||null==r.return||r.return()}finally{if(s)throw a}}return o}}(i,a)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(e,t):void 0}}(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=o[0],s=o[1];return e[n]=s,e}),{})},t.isArguments=function(e){return null!=e&&a(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var o={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=o,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(o.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var r=Object.create(null),i=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},a=0;a<64;a++)r[i(a)]=a;var o=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],r=0;r<e;r++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},n={encode:function(e){if("string"==typeof e){var t=e;e=o(t.length);for(var r=0;r<t.length;r++){var a=t.charCodeAt(r);if(a>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[r]=a}}for(var n=[],s=null,l=null,u=null,c=null,d=0;d<e.length;d++)switch(d%3){case 0:s=e[d]>>2&63,l=(3&e[d])<<4;break;case 1:l|=e[d]>>4&15,u=(15&e[d])<<2;break;case 2:u|=e[d]>>6&3,c=63&e[d],n.push(i(s)),n.push(i(l)),n.push(i(u)),n.push(i(c)),s=null,l=null,u=null,c=null}return null!=s&&(n.push(i(s)),n.push(i(l)),null==u?n.push("="):n.push(i(u)),null==c&&n.push("=")),n.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var i,a=o(t),n=null,s=null,l=null,u=0,c=0;c<e.length;c++){var d="="===(i=e.charAt(c))?-1:r[i];switch(c%4){case 0:if(d<0)throw new Error("invalid base64 string");n=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");n|=d>>4,a[u++]=n,s=(15&d)<<4;break;case 2:d>=0&&(s|=d>>2,a[u++]=s,l=(3&d)<<6);break;case 3:d>=0&&(a[u++]=l|d)}}return a},newBinary:o};t.Base64=n},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function e(t,a,o,n,s){var l=a[t];switch(r(l)){case"string":return i(l);case"number":return isFinite(l)?String(l):"null";case"boolean":return String(l);case"object":if(!l)return"null";var u,c=n+o,d=[];if(Array.isArray(l)||{}.hasOwnProperty.call(l,"callee")){for(var p=l.length,m=0;m<p;m+=1)d[m]=e(m,l,o,c,s)||"null";return u=0===d.length?"[]":c?"[\n"+c+d.join(",\n"+c)+"\n"+n+"]":"["+d.join(",")+"]"}var b=Object.keys(l);return s&&(b=b.sort()),b.forEach((function(t){(u=e(t,l,o,c,s))&&d.push(i(t)+(c?": ":":")+u)})),u=0===d.length?"{}":c?"{\n"+c+d.join(",\n"+c)+"\n"+n+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var r=Object.assign({indent:"",canonical:!1},t);if(!0===r.indent)r.indent="  ";else if("number"==typeof r.indent){for(var i="",o=0;o<r.indent;o++)i+=" ";r.indent=i}return a("",{"":e},r.indent,"",r.canonical)},e.exports=t.default}],r={};function i(e){var a=r[e];if(void 0!==a)return a.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,i),o.exports}var a={};!function(){var e=a,t=i(2).Base64,r=i(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var o=i(1),n={};e.EJSON=n;var s=new Map;n.addType=function(e,t){if(s.has(e))throw new Error("Type ".concat(e," already present"));s.set(e,t)};var l=[{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$date")&&1===(0,o.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$regexp")&&(0,o.hasOwn)(e,"$flags")&&2===(0,o.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$InfNaN")&&1===(0,o.lengthOf)(e)},matchObject:o.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$binary")&&1===(0,o.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,o.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$escape")&&1===(0,o.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var r=(0,o.lengthOf)(e);1!==r&&2!==r||(t=l.some((function(t){return t.matchJSONValue(e)})))}return t},toJSONValue:function(e){var t={};return(0,o.keysOf)(e).forEach((function(r){t[r]=n.toJSONValue(e[r])})),{$escape:t}},fromJSONValue:function(e){var t={};return(0,o.keysOf)(e.$escape).forEach((function(r){t[r]=n.fromJSONValue(e.$escape[r])})),t}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$type")&&(0,o.hasOwn)(e,"$value")&&2===(0,o.lengthOf)(e)},matchObject:function(e){return n._isCustomType(e)},toJSONValue:function(e){var t=r._noYieldsAllowed((function(){return e.toJSONValue()}));return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!s.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var i=s.get(t);return r._noYieldsAllowed((function(){return i(e.$value)}))}}];n._isCustomType=function(e){return e&&(0,o.isFunction)(e.toJSONValue)&&(0,o.isFunction)(e.typeName)&&s.has(e.typeName())},n._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?s:(0,o.convertMapToObject)(s)},n._getConverters=function(){return l};var u=function(e){for(var t=0;t<l.length;t++){var r=l[t];if(r.matchObject(e))return r.toJSONValue(e)}},c=function e(t){if(null===t)return null;var r=u(t);return void 0!==r?r:(0,o.isObject)(t)?((0,o.keysOf)(t).forEach((function(r){var i=t[r];if((0,o.isObject)(i)||void 0===i||(0,o.isInfOrNaN)(i)){var a=u(i);a?t[r]=a:e(i)}})),t):t};n._adjustTypesToJSONValue=c,n.toJSONValue=function(e){var t=u(e);if(void 0!==t)return t;var r=e;return(0,o.isObject)(e)&&(r=n.clone(e),c(r)),r};var d=function(e){if((0,o.isObject)(e)&&null!==e){var t=(0,o.keysOf)(e);if(t.length<=2&&t.every((function(e){return"string"==typeof e&&"$"===e.substr(0,1)})))for(var r=0;r<l.length;r++){var i=l[r];if(i.matchJSONValue(e))return i.fromJSONValue(e)}}return e},p=function e(t){if(null===t)return null;var r=d(t);return r!==t?r:(0,o.isObject)(t)?((0,o.keysOf)(t).forEach((function(r){var i=t[r];if((0,o.isObject)(i)){var a=d(i);if(i!==a)return void(t[r]=a);e(i)}})),t):t};n._adjustTypesFromJSONValue=p,n.fromJSONValue=function(e){var t=d(e);return t===e&&(0,o.isObject)(e)&&(t=n.clone(e),p(t)),t},n.stringify=(0,o.handleError)((function(e,t){var r=n.toJSONValue(e);return t&&(t.canonical||t.indent)?i(4)(r,t):JSON.stringify(r)})),n.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return n.fromJSONValue(JSON.parse(e))},n.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},n.equals=function(e,t,r){var i,a=!(!r||!r.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,o.isObject)(e)||!(0,o.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(n.isBinary(e)&&n.isBinary(t)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}if((0,o.isFunction)(e.equals))return e.equals(t,r);if((0,o.isFunction)(t.equals))return t.equals(e,r);var s,l=Array.isArray(e),u=Array.isArray(t);if(l!==u)return!1;if(l&&u){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!n.equals(e[i],t[i],r))return!1;return!0}switch(n._isCustomType(e)+n._isCustomType(t)){case 1:return!1;case 2:return n.equals(n.toJSONValue(e),n.toJSONValue(t))}var c=(0,o.keysOf)(e),d=(0,o.keysOf)(t);return a?(i=0,s=c.every((function(a){return!(i>=d.length||a!==d[i]||!n.equals(e[a],t[d[i]],r)||(i++,0))}))):(i=0,s=c.every((function(a){return!!(0,o.hasOwn)(t,a)&&!!n.equals(e[a],t[a],r)&&(i++,!0)}))),s&&i===d.length},n.clone=function(e){var t;if(!(0,o.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(n.isBinary(e)){t=n.newBinary(e.length);for(var r=0;r<e.length;r++)t[r]=e[r];return t}return Array.isArray(e)?e.map(n.clone):(0,o.isArguments)(e)?Array.from(e).map(n.clone):(0,o.isFunction)(e.clone)?e.clone():n._isCustomType(e)?n.fromJSONValue(n.clone(n.toJSONValue(e)),!0):(t={},(0,o.keysOf)(e).forEach((function(r){t[r]=n.clone(e[r])})),t)},n.newBinary=t.newBinary}(),e.exports=a.EJSON}()},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function i(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,i,o,n){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new a(i,o||e,n),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function n(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,i,a=[];if(0===this._eventsCount)return a;for(i in e=this._events)t.call(e,i)&&a.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,o=i.length,n=new Array(o);a<o;a++)n[a]=i[a].fn;return n},s.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},s.prototype.emit=function(e,t,i,a,o,n){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,a),!0;case 5:return c.fn.call(c.context,t,i,a,o),!0;case 6:return c.fn.call(c.context,t,i,a,o,n),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var p,m=c.length;for(u=0;u<m;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,i);break;case 4:c[u].fn.call(c[u].context,t,i,a);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,i,a){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return n(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||a&&!s.once||i&&s.context!==i||n(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||a&&!s[l].once||i&&s[l].context!==i)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:n(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&n(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},2017:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var i,a,o;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(a=i;0!=a--;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(a=i;0!=a--;)if(!Object.prototype.hasOwnProperty.call(r,o[a]))return!1;for(a=i;0!=a--;){var n=o[a];if(!e(t[n],r[n]))return!1}return!0}return t!=t&&r!=r}},6067:e=>{e.exports=function(t){if(e.exports.stub!==e.exports)return e.exports.stub.apply(this,arguments);try{return process.kill(t,0)}catch(e){return"EPERM"===e.code}},e.exports.stub=e.exports},4865:e=>{"use strict";const t=(e,t,i,a)=>{if("length"===i||"prototype"===i)return;if("arguments"===i||"caller"===i)return;const o=Object.getOwnPropertyDescriptor(e,i),n=Object.getOwnPropertyDescriptor(t,i);!r(o,n)&&a||Object.defineProperty(e,i,n)},r=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},i=(e,t)=>`/* Wrapped ${e}*/\n${t}`,a=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),o=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,r,{ignoreNonConfigurable:n=!1}={})=>{const{name:s}=e;for(const i of Reflect.ownKeys(r))t(e,r,i,n);return((e,t)=>{const r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)})(e,r),((e,t,r)=>{const n=""===r?"":`with ${r.trim()}() `,s=i.bind(null,n,t.toString());Object.defineProperty(s,"name",o),Object.defineProperty(e,"toString",{...a,value:s})})(e,r,s),e}},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},3290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(228),a=r(6641),o=r(4774),n=()=>{},s=new a.TimeoutError;t.default=class extends i{constructor(e){var t,r,i,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=n,this._resolveIdle=n,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(a=null===(i=e.interval)||void 0===i?void 0:i.toString())&&void 0!==a?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=n,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=n,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((r,i)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const o=void 0===this._timeout&&void 0===t.timeout?e():a.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&i(s)}));r(await o)}catch(e){i(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let i=0,a=e.length;for(;a>0;){const o=a/2|0;let n=i+o;r(e[n],t)<=0?(i=++n,a-=o+1):a=o}return i}},4774:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const a=i.default(this._queue,r,((e,t)=>t.priority-e.priority));this._queue.splice(a,0,r)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},6641:(e,t,r)=>{"use strict";const i=r(4617);class a extends Error{constructor(e){super(e),this.name="TimeoutError"}}const o=(e,t,r)=>new Promise(((o,n)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void o(e);const s=setTimeout((()=>{if("function"==typeof r){try{o(r())}catch(e){n(e)}return}const i=r instanceof Error?r:new a("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),n(i)}),t);i(e.then(o,n),(()=>{clearTimeout(s)}))}));e.exports=o,e.exports.default=o,e.exports.TimeoutError=a},3409:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KillTimeoutError=t.RestartTimeoutError=void 0;class r extends Error{constructor(){super(...arguments),this.name="RestartTimeoutError"}}t.RestartTimeoutError=r;class i extends Error{constructor(){super(...arguments),this.name="KillTimeoutError"}}t.KillTimeoutError=i},8126:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FakeWorker=void 0;const i=r(3080);class a extends i.Worker{constructor(e){super(),this.disabledMultithreading=!0,this.mockProcessSend=e}killInstance(){}sendInstanceMessageToParent(e,t,r){const i=Object.assign(Object.assign({},t),{messageType:"instance",cmdId:e.cmdId++,instanceId:e.id});r&&(e.queue[i.cmdId+""]={cb:r}),this.mockProcessSend(i)}sendChildMessageToParent(e,t,r){const i=Object.assign(Object.assign({},t),{messageType:"child",cmdId:e.cmdId++});r&&(e.queue[i.cmdId+""]={cb:r}),this.mockProcessSend(i)}}t.FakeWorker=a},3080:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Worker=void 0;const isRunning=__webpack_require__(6067),lib_1=__webpack_require__(6156),sharedApi_1=__webpack_require__(4468);class Worker{constructor(){this.childHandler={cmdId:0,queue:{}},this.instanceHandles={},this.callbacks={},this.remoteFns={},this.disabledMultithreading=!1,this._parentPid=0,this.log=(...e)=>{this.sendLog(e)},this.logError=(...e)=>{this.sendLog(["Error",...e])}}onMessageFromParent(e){if("instance"===e.messageType){let t=this.instanceHandles[e.instanceId];if(!t&&e.cmd!==sharedApi_1.Message.To.Instance.CommandType.INIT)return void console.log(`Child process: Unknown instanceId: "${e.instanceId}"`);t||(t={id:e.instanceId,cmdId:0,queue:{},instance:{}});try{this.handleInstanceMessageFromParent(e,t)}catch(r){e.cmdId?this.replyInstanceError(t,e,`Error: ${r.toString()} ${r.stack} thrown in handleInstanceMessageFromParent on instance "${e.instanceId}"`):this.log("Error: "+r.toString(),r.stack)}}else if("child"===e.messageType){let t=this.childHandler;try{this.handleChildMessageFromParent(e,t)}catch(r){e.cmdId?this.replyChildError(t,e,`Error: ${r.toString()} ${r.stack} thrown in handleChildMessageFromParent on child`):this.log("Error: "+r.toString(),r.stack)}}}decodeArgumentsFromParent(e,t){return(0,sharedApi_1.decodeArguments)((()=>e.instance),t,(t=>{const r=t.value;return this.remoteFns[r]||(this.remoteFns[r]=(...r)=>{const i=new Error;return new Promise(((a,o)=>{const n=t.value;this.sendCallback(e,n,r,((t,r)=>{if(t){const e=(0,lib_1.stripStack)((0,lib_1.getErrorStack)(t),[/[\\/]parent-process[\\/]manager/,/[\\/]eventemitter3[\\/]index/]),r=(i.stack+"").split("\n").slice(2).join("\n");o((0,lib_1.combineErrorStacks)(e,r))}else{const t=r?this.decodeArgumentsFromParent(e,[r]):[r];a(t[0])}}))}))}),this.remoteFns[r]}))}encodeArgumentsToParent(e,t){return(0,sharedApi_1.encodeArguments)(e,this.callbacks,t,this.disabledMultithreading)}replyToInstanceMessage(e,t,r){this.sendInstanceReplyToParent(e,t.cmdId,void 0,r)}replyToChildMessage(e,t,r){this.sendChildReplyToParent(e,t.cmdId,void 0,r)}replyInstanceError(e,t,r){this.sendInstanceReplyToParent(e,t.cmdId,r)}replyChildError(e,t,r){this.sendChildReplyToParent(e,t.cmdId,r)}sendInstanceReplyToParent(e,t,r,i){let a={cmd:sharedApi_1.Message.From.Instance.CommandType.REPLY,replyTo:t,error:r?(r.stack||r).toString():r,reply:i};this.sendInstanceMessageToParent(e,a)}sendChildReplyToParent(e,t,r,i){let a={cmd:sharedApi_1.Message.From.Child.CommandType.REPLY,replyTo:t,error:r?(r.stack||r).toString():r,reply:i};this.sendChildMessageToParent(e,a)}sendLog(e){let t={cmd:sharedApi_1.Message.From.Child.CommandType.LOG,log:e};this.sendChildMessageToParent(this.childHandler,t)}sendCallback(e,t,r,i){let a={cmd:sharedApi_1.Message.From.Instance.CommandType.CALLBACK,callbackId:t,args:r};this.sendInstanceMessageToParent(e,a,i)}getAllProperties(e){let t=[];do{t=t.concat(Object.getOwnPropertyNames(e)),e=Object.getPrototypeOf(e)}while(e);return t}handleInstanceMessageFromParent(m,handle){const instance=handle.instance;if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.INIT){const msg=m;let pModuleClass;this._config=m.config,this._parentPid=m.parentPid,pModuleClass=(0,lib_1.isBrowser)()?new Promise(((e,t)=>{let r=new XMLHttpRequest;r.open("GET",msg.modulePath,!0),r.onload=()=>{r.response?e(r.response):t(Error(`Bad reply from ${msg.modulePath} in instance ${handle.id}`))},r.send()})).then((bodyString=>{var f=null;let fcn=`\n\t\t\t\t\t\tf = function() {\n\t\t\t\t\t\t\t${bodyString}\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\treturn ${msg.exportName}\n\t\t\t\t\t\t}\n\t\t\t\t\t`,moduleClass=eval(fcn)();if(!moduleClass)throw Error(`${msg.exportName} not found in ${msg.modulePath}`);return moduleClass})):Promise.resolve(__webpack_require__(1253)(msg.modulePath)).then((e=>e[msg.exportName])),pModuleClass.then((e=>{if(!e)return Promise.reject("Failed to find class");const t={id:msg.instanceId,cmdId:0,queue:{},instance:null},r=this.decodeArgumentsFromParent(t,msg.args);t.instance=((...t)=>new e(...t)).apply(null,r),this.instanceHandles[t.id]=t;const i=t.instance,a=this.getAllProperties(i),o=[];a.forEach((e=>{if(-1!==["constructor","__defineGetter__","__defineSetter__","hasOwnProperty","__lookupGetter__","__lookupSetter__","isPrototypeOf","propertyIsEnumerable","toString","valueOf","__proto__","toLocaleString"].indexOf(e))return;let t=Object.getOwnPropertyDescriptor(i,e),r=0,a=i.__proto__;for(;!t&&a;)t=Object.getOwnPropertyDescriptor(a,e),r++,a=a.__proto__;t||(t={});let n={inProto:r,enumerable:!!t.enumerable,writable:!!t.writable,get:!!t.get,set:!!t.set,readable:!(t.get||t.get)};"function"==typeof i[e]?o.push({key:e,type:sharedApi_1.InitPropType.FUNCTION,descriptor:n}):o.push({key:e,type:sharedApi_1.InitPropType.VALUE,descriptor:n})})),this.replyToInstanceMessage(t,msg,o)})).catch((e=>{let t=`${(0,lib_1.stripStack)(e.stack||e.toString(),[/onMessageFromParent/,/threadedclass-worker/])}\n executing constructor of instance "${m.instanceId}"`;this.replyInstanceError(handle,msg,t)})),m.config.disableMultithreading||(0,lib_1.nodeSupportsWorkerThreads)()||this.startOrphanMonitoring()}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.PING)this.replyToInstanceMessage(handle,m,null);else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.REPLY){const e=m;let t=handle.queue[e.replyTo+""];if(!t)throw Error(`cmdId "${e.cmdId}" not found in instance ${m.instanceId}!`);e.error?t.cb(e.error):t.cb(null,e.reply),delete handle.queue[e.replyTo+""]}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.FUNCTION){let e=m;const t=this.decodeArgumentsFromParent(handle,e.args);let r;try{r="function"==typeof instance[e.fcn]?instance[e.fcn](...t):instance[e.fcn]}catch(e){r=Promise.reject(e)}Promise.resolve(r).then((t=>{const r=this.encodeArgumentsToParent(instance,[t]);this.replyToInstanceMessage(handle,e,r[0])})).catch((t=>{let r=`${(0,lib_1.stripStack)(t.stack||t.toString(),[/onMessageFromParent/,/threadedclass-worker/])}\n executing function "${e.fcn}" of instance "${m.instanceId}"`;this.replyInstanceError(handle,e,r)}))}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.SET){let e=m;const t=this.decodeArgumentsFromParent(handle,[e.value])[0];instance[e.property]=t;const r=this.encodeArgumentsToParent(instance,[t]);this.replyToInstanceMessage(handle,e,r[0])}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.KILL){let e=m;this.killInstance(handle),this.replyToInstanceMessage(handle,e,null)}else if(m.cmd===sharedApi_1.Message.To.Instance.CommandType.CALLBACK){let e=m,t=this.callbacks[e.callbackId];if(t)try{Promise.resolve(t(...e.args)).then((t=>{const r=this.encodeArgumentsToParent(instance,[t]);this.replyToInstanceMessage(handle,e,r[0])})).catch((t=>{let r=(t.stack||t.toString())+`\n executing callback of instance "${m.instanceId}"`;this.replyInstanceError(handle,e,r)}))}catch(t){let r=(t.stack||t.toString())+`\n executing (outer) callback of instance "${m.instanceId}"`;this.replyInstanceError(handle,e,r)}else this.replyInstanceError(handle,e,`Callback "${e.callbackId}" not found on instance "${m.instanceId}"`)}else(0,lib_1.assertNever)(m)}handleChildMessageFromParent(e,t){if(e.cmd===sharedApi_1.Message.To.Child.CommandType.GET_MEM_USAGE){let r=process?process.memoryUsage():window?window.performance.memory:{error:"N/A"};const i=this.encodeArgumentsToParent({},[r])[0];this.replyToChildMessage(t,e,i)}}startOrphanMonitoring(){this._config&&setInterval((()=>{this._parentPid&&!isRunning(this._parentPid)&&(console.log(`Parent pid ${this._parentPid} missing, exiting process!`),setTimeout((()=>{process.exit(27)}),100))}),5e3)}}exports.Worker=Worker},1253:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=1253,e.exports=t},409:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterExitHandlers=t.ThreadedClassManager=void 0;const i=r(9852),a=r(2081);Object.defineProperty(t,"ThreadedClassManager",{enumerable:!0,get:function(){return a.ThreadedClassManager}}),Object.defineProperty(t,"RegisterExitHandlers",{enumerable:!0,get:function(){return a.RegisterExitHandlers}}),(0,i.__exportStar)(r(3409),t),(0,i.__exportStar)(r(7369),t)},2081:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadedClassManager=t.ThreadedClassManagerInternal=t.ThreadMode=t.ThreadedClassManagerClassInternal=t.childName=t.ThreadedClassManagerClass=t.RegisterExitHandlers=void 0;const i=r(9852),a=r(4468),o=r(3409),n=r(6156),s=r(2557),l=r(681),u=r(7963),c=r(9599);var d,p;!function(e){e[e.AUTO=-1]="AUTO",e[e.YES=1]="YES",e[e.NO=0]="NO"}(d=t.RegisterExitHandlers||(t.RegisterExitHandlers={}));class m{constructor(e){this._internal=e}set debug(e){this._internal.debug=e}get debug(){return this._internal.debug}set strict(e){this._internal.strict=e}get strict(){return this._internal.strict}set handleExit(e){this._internal.handleExit=e}get handleExit(){return this._internal.handleExit}destroy(e){return this._internal.killProxy(e)}destroyAll(){return this._internal.killAllChildren()}getThreadCount(){return this._internal.getChildrenCount()}getThreadsMemoryUsage(){return this._internal.getMemoryUsage()}onEvent(e,t,r){return this._internal.onProxyEvent(e,t,r)}restart(e,t){return this._internal.restart(e,t)}getThreadMode(){return(0,n.isBrowser)()?(0,n.browserSupportsWebWorkers)()?p.WEB_WORKER:p.NOT_SUPPORTED:(0,n.nodeSupportsWorkerThreads)()?p.WORKER_THREADS:p.CHILD_PROCESS}}function b(e){return`Child_ ${Object.keys(e.instances).join(",")}`}t.ThreadedClassManagerClass=m,t.childName=b;class f{constructor(){this.handleExit=d.AUTO,this.isInitialized=!1,this._threadId=0,this._instanceId=0,this._methodId=0,this._children={},this._pinging=!0,this.debug=!1,this.strict=!1,this.uniqueId=Date.now()%1e4,this._proxyEventListeners=new Map,this._childInitializedListeners=new n.ArrayMap}findNextAvailableChild(e,t){this._init();let r=null;if(e.threadId?r=this._children[e.threadId]||null:e.threadUsage&&(r=this._findFreeChild(e.threadUsage)),!r){const i={id:e.threadId||`process_${this.uniqueId}_${this._threadId++}`,isNamed:!!e.threadId,pathToWorker:t,process:this._createFork(e,t),usage:e.threadUsage||1,instances:{},methods:{},alive:!0,isClosing:!1,config:e,autoRestartFailCount:0,autoRestartRetryTimeout:void 0,cmdId:0,instanceMessageQueue:{},childMessageQueue:{},callbackId:0,callbacks:{}};this._setupChildProcess(i),this._children[i.id]=i,r=i,this.debug&&this.consoleLog(`New child: "${i.id}"`)}return r}attachInstanceToChild(e,t,r,i,a,o,n){const s={id:`instance_${this.uniqueId}_${this._instanceId++}`+(e.instanceName?`_${e.instanceName}`:""),child:t,proxy:r,usage:e.threadUsage,freezeLimit:e.freezeLimit,onMessageCallback:n,pathToModule:i,exportName:a,constructorArgs:o,initialized:!1,config:e};return t.instances[s.id]=s,this.debug&&this.consoleLog(`Add instance "${s.id}" to "${t.id}"`),s}killProxy(e){return new Promise(((t,r)=>{let i=!1;for(const o of Object.keys(this._children)){const n=this._children[o],s=this.findProxyInstanceOfChild(n,e);if(s){let e=n.instances[s];if(i=!0,1===Object.keys(n.instances).length)this.killChild(o,"no instances left").then(t).catch(r);else{const i=()=>{delete n.instances[s]};this.sendMessageToInstance(e,{cmd:a.Message.To.Instance.CommandType.KILL},(()=>{i(),t()})),setTimeout((()=>{i(),r("Timeout: Kill child instance")}),1e3),e.usage&&(n.usage-=e.usage)}break}}i||r("killProxy: Proxy not found")}))}sendMessageToInstance(e,t,r){try{if(!e.child)throw new Error(`Instance ${e.id} has been detached from child process`);if(!e.child.alive)throw new Error(`Child process of instance ${e.id} has been closed`);if(e.child.isClosing)throw new Error(`Child process of instance ${e.id} is closing`);const i=Object.assign(Object.assign({},t),{messageType:"instance",cmdId:e.child.cmdId++,instanceId:e.id});if(i.cmd!==a.Message.To.Instance.CommandType.INIT&&!e.initialized)throw Error(`Child instance ${e.id} is not initialized`);r&&(e.child.instanceMessageQueue[i.cmdId+""]=r);try{e.child.process.send(i)}catch(t){throw delete e.child.instanceMessageQueue[i.cmdId+""],(t.toString()||"").match(/circular structure/)?new Error(`Unsupported attribute (circular structure) in instance ${e.id}: `+t.toString()):t}}catch(t){if(!r)throw t;r(e,(t.stack||t).toString())}}sendMessageToChild(e,t,r){try{if(!e.alive)throw new Error(`Child process ${e.id} has been closed`);if(e.isClosing)throw new Error(`Child process  ${e.id} is closing`);const i=Object.assign(Object.assign({},t),{messageType:"child",cmdId:e.cmdId++});r&&(e.childMessageQueue[i.cmdId+""]=r);try{e.process.send(i)}catch(t){throw delete e.childMessageQueue[i.cmdId+""],(t.toString()||"").match(/circular structure/)?new Error(`Unsupported attribute (circular structure) in child ${e.id}: `+t.toString()):t}}catch(e){if(!r)throw e;r((e.stack||e).toString())}}getChildrenCount(){return Object.keys(this._children).length}getMemoryUsage(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={};return yield Promise.all(Object.keys(this._children).map((t=>new Promise((r=>{const i=this._children[t];this.sendMessageToChild(i,{cmd:a.Message.To.Child.CommandType.GET_MEM_USAGE},((o,n)=>{const s=n&&(0,a.decodeArguments)((()=>null),[n],(()=>()=>Promise.resolve()))[0],l=Object.assign(Object.assign({},o?{error:o.toString()}:s||{error:"unknown"}),{description:this.getChildDescriptor(i)});e[t]=l,r()}))}))))),e}))}killAllChildren(){return Promise.all(Object.keys(this._children).map((e=>{const t=this._children[e];return this.debug&&this.consoleLog(`Killing child "${this.getChildDescriptor(t)}"`),this.killChild(e,"killAllChildren")}))).then((()=>{}))}restart(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let r,i;for(const t of Object.values(this._children)){const a=this.findProxyInstanceOfChild(t,e);if(a){r=t.instances[a],i=t;break}}if(!i)throw Error("Child of proxy not found");if(!r)throw Error("Instance of proxy not found");yield this.restartChild(i,[r],t)}))}restartChild(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.alive&&r&&(yield this.killChild(e,"restart child",!1)),this.clearRestartTimeout(e),e.alive||(e.process.removeAllListeners(),Object.keys(e.instances).forEach((t=>{e.instances[t].initialized=!1})),e.alive=!0,e.isClosing=!1,e.process=this._createFork(e.config,e.pathToWorker),this._setupChildProcess(e));const i=[new Promise(((t,r)=>{var i;let n;if(0!==e.config.restartTimeout){const t=null!==(i=e.config.restartTimeout)&&void 0!==i?i:a.DEFAULT_RESTART_TIMEOUT;n=setTimeout((()=>{r(new o.RestartTimeoutError(`Timeout when trying to restart after ${t}`)),this._childInitializedListeners.remove(e.id,s)}),t)}const s=()=>{n&&clearTimeout(n),t(),this._childInitializedListeners.remove(e.id,s)};this._childInitializedListeners.push(e.id,s)}))];(t||Object.keys(e.instances).map((t=>e.instances[t]))).forEach((t=>{i.push(new Promise(((r,i)=>{this.sendInit(e,t,t.config,((e,t)=>(t?i(t):r(),!0)))})))})),yield Promise.all(i)}))}canRetryRestart(e){var t;const r=null!==(t=e.config.autoRestartRetryCount)&&void 0!==t?t:a.DEFAULT_AUTO_RESTART_RETRY_COUNT;return 0===r||e.autoRestartFailCount<r}sendInit(e,r,i,o){let n=(0,a.encodeArguments)(r,r.child.callbacks,r.constructorArgs,!!i.disableMultithreading),s={cmd:a.Message.To.Instance.CommandType.INIT,modulePath:r.pathToModule,exportName:r.exportName,args:n,config:i,parentPid:process.pid};r.initialized=!0,t.ThreadedClassManagerInternal.sendMessageToInstance(r,s,((t,r,i)=>{if(!o||o(t,r,i)){const t=this._childInitializedListeners.get(e.id);if(t)for(const e of t)e()}}))}startMonitoringChild(e){var t;const r=null!==(t=e.freezeLimit)&&void 0!==t?t:a.DEFAULT_CHILD_FREEZE_TIME;if(0===r)return;const i=()=>{e.child&&e.child.alive&&this._pinging&&this._pingChild(e,r).then((()=>{setTimeout((()=>{i()}),r)})).catch((()=>{e.child&&e.child.alive&&!e.child.isClosing&&this._childHasCrashed(e.child,`Child process ("${this.getChildDescriptor(e.child)}") of instance ${e.id} ping timeout`)}))};setTimeout((()=>{i()}),r)}doMethod(e,t,r){const i="m"+this._methodId++;return new Promise(((a,o)=>{e.methods[i]={methodName:t,resolve:a,reject:o},r(a,o)})).then((t=>(delete e.methods[i],t))).catch((t=>{throw delete e.methods[i],t}))}getChildDescriptor(e){return`${e.id} (${Object.keys(e.instances).join(", ")})`}checkInstance(e,t){if(!this.strict)return;const r=()=>`${t.stack}`.split("\n").slice(2).join("\n");setTimeout((()=>{const t=this._proxyEventListeners.get(e.proxy);t&&0!==t.arraySize("error")||this.consoleLog(`Warning: No listener for the 'error' event was registered,\nSolve this by adding\nThreadedClassManager.onEvent(instance, 'error', (error) => {})\n${r()}`),t&&0!==t.arraySize("warning")||this.consoleLog(`Warning: No listener for the 'warning' event was registered,\nSolve this by adding\nThreadedClassManager.onEvent(instance, 'warning', (warning) => {})\n${r()}`),e.config.autoRestart?t&&0!==t.arraySize("restarted")||this.consoleLog(`Warning: No listener for the 'restarted' event was registered.\nIt is recommended to set up an event listener for this, so you are aware of that an instance has been restarted:\nuse ThreadedClassManager.onEvent(instance, 'restarted', () => {})\n${r()}`):t&&0!==t.arraySize("thread_closed")||this.consoleLog(`Warning: autoRestart is disabled and no listener for the 'thread_closed' event was registered.\nSolve this by either set {autoRestart: true} in threadedClass() options, or set up an event listener to handle a restart:\nuse ThreadedClassManager.onEvent(instance, 'thread_closed', () => {})\nat ${r()}`)}),1)}onProxyEvent(e,t,r){let i=this._proxyEventListeners.get(e);return i||(i=new n.ArrayMap),i.push(t,r),this._proxyEventListeners.set(e,i),{stop:()=>{const i=this._proxyEventListeners.get(e);i&&(i.remove(t,r),i.size>0?this._proxyEventListeners.set(e,i):this._proxyEventListeners.delete(e))}}}_emitProxyEvent(e,t,...r){for(const i of Object.values(e.instances)){const e=this._proxyEventListeners.get(i.proxy);if(e){const i=e.get(t);if(i)for(const e of i)try{e(...r)}catch(e){this.consoleLog(`Error in event listener for "${t}":`,e)}}}}_init(){if(!this.isInitialized&&!(0,n.isBrowser)()){let e;switch(this.handleExit){case d.YES:e=!0;break;case d.AUTO:0===process.listenerCount("exit")||0===process.listenerCount("uncaughtException")||0===process.listenerCount("unhandledRejection")?(this.consoleLog("Skipping exit handler registration as no exit handler is registered"),e=!1):e=!0;break;default:e=!1}if(e){process.stdin.resume();const e=(e,t)=>{let r=`Signal "${e}" event`;t&&(r+=", "+t),1===process.listenerCount(e)?console.error(r):this.debug&&this.consoleLog(r),this.killAllChildren().catch(this.consoleError),process.exit()};process.on("exit",(t=>e("exit",`exit code: ${t}`))),process.on("SIGINT",(()=>e("SIGINT"))),process.on("SIGHUP",(()=>e("SIGHUP"))),process.on("SIGTERM",(()=>e("SIGTERM"))),process.on("SIGUSR1",(()=>e("SIGUSR1"))),process.on("SIGUSR2",(()=>e("SIGUSR2"))),process.on("uncaughtException",(t=>e("uncaughtException",t.toString()))),process.on("unhandledRejection",(t=>e("unhandledRejection",t?t.toString():void 0)))}}this.isInitialized=!0}_pingChild(e,r){return new Promise(((i,o)=>{let n={cmd:a.Message.To.Instance.CommandType.PING};const s=setTimeout((()=>{o()}),r);t.ThreadedClassManagerInternal.sendMessageToInstance(e,n,((e,t)=>{clearTimeout(s),t?(this.consoleError(t),o(t)):i()}))}))}_childHasCrashed(e,t){if(this.rejectChildMethods(e,t),!e.isClosing){let r=!1;const i=[];Object.keys(e.instances).forEach((t=>{const a=e.instances[t];a.config.autoRestart&&(r=!0,i.push(a))})),r?this.restartChild(e,i,!0).then((()=>{e.autoRestartFailCount=0,this._emitProxyEvent(e,"restarted")})).catch((t=>{e.autoRestartFailCount++,this.canRetryRestart(e)?(this._emitProxyEvent(e,"warning",`Error when restarting child, trying again... Original error: ${t}`),this.killChild(e,"error when restarting",!1).catch((t=>{this.consoleError(`Could not kill child: "${e.id}"`,t)})).then((()=>{var t;const r=null!==(t=e.config.autoRestartRetryDelay)&&void 0!==t?t:a.DEFAULT_AUTO_RESTART_RETRY_DELAY;e.autoRestartRetryTimeout=setTimeout((()=>{this._childHasCrashed(e,"restart failed")}),r)})).catch((t=>{this.consoleError(`Unknown error: "${e.id}"`,t)}))):(this._emitProxyEvent(e,"error",t),this.debug&&this.consoleError("Error when running restartChild()",t),this.killChild(e,"timeout when restarting",!0).catch((t=>{this.consoleError(`Could not kill child: "${e.id}"`,t)})))})):e.alive&&this.killChild(e,`child has crashed (${t})`,!1).catch((t=>{this._emitProxyEvent(e,"error",t),this.debug&&this.consoleError("Error when running killChild()",t)}))}}clearRestartTimeout(e){void 0!==e.autoRestartRetryTimeout&&(clearTimeout(e.autoRestartRetryTimeout),e.autoRestartRetryTimeout=void 0)}_createFork(e,t){return e.disableMultithreading?new c.FakeProcess:(0,n.isBrowser)()?(0,s.forkWebWorker)(t):(0,n.nodeSupportsWorkerThreads)()?(0,l.forkWorkerThread)(t):(0,u.forkChildProcess)(t)}_setupChildProcess(e){e.process.on("close",(()=>{e.alive&&(e.alive=!1,this._emitProxyEvent(e,"thread_closed"),this._childHasCrashed(e,`Child process "${b(e)}" was closed`))})),e.process.on("error",(t=>{this._emitProxyEvent(e,"error",t),this.debug&&this.consoleError("Error from child "+e.id,t)})),e.process.on("message",(t=>{if("child"===t.messageType)try{this._onMessageFromChild(e,t)}catch(r){throw this.debug&&this.consoleError(`Error in onMessageCallback in child ${e.id}`,t,r),r}else if("instance"===t.messageType){const r=e.instances[t.instanceId];if(r)try{r.onMessageCallback(r,t)}catch(e){throw this.debug&&this.consoleError(`Error in onMessageCallback in instance ${r.id}`,t,r,e),e}else{const r=new Error(`Instance "${t.instanceId}" not found. Received message "${t.messageType}" from child "${e.id}", "${b(e)}"`);this._emitProxyEvent(e,"error",r),this.debug&&this.consoleError(r)}}else{const r=new Error(`Unknown messageType "${t.messageType}"!`);this._emitProxyEvent(e,"error",r),this.debug&&this.consoleError(r)}}))}_onMessageFromChild(e,t){if(t.cmd===a.Message.From.Child.CommandType.LOG)console.log(e.id,...t.log);else if(t.cmd===a.Message.From.Child.CommandType.REPLY){let r=t,i=e.childMessageQueue[r.replyTo+""];if(!i)return;r.error?i(r.error):i(null,r.reply),delete e.instanceMessageQueue[r.replyTo+""]}else if(t.cmd===a.Message.From.Child.CommandType.CALLBACK){let r=t,i=e.callbacks[r.callbackId];if(!i)throw Error(`callback "${r.callbackId}" not found in child ${e.id}`);try{Promise.resolve(i(...r.args)).then((t=>{let i=(0,a.encodeArguments)({},e.callbacks,[t],!!e.process.isFakeProcess);this._sendReplyToChild(e,r.cmdId,void 0,i[0])})).catch((t=>{this._replyErrorToChild(e,r,t)}))}catch(t){this._replyErrorToChild(e,r,t)}}}_replyErrorToChild(e,t,r){this._sendReplyToChild(e,t.cmdId,r)}_sendReplyToChild(e,t,r,i,o){let n={cmd:a.Message.To.Child.CommandType.REPLY,replyTo:t,reply:i,error:r?(r.stack||r).toString():r};this.sendMessageToChild(e,n,o)}_findFreeChild(e){let t=Object.keys(this._children).find((t=>{const r=this._children[t];return!r.isNamed&&r.usage+e<=1}));if(t){const r=this._children[t];return r.usage+=e,r}return null}killChild(e,t,r=!0){return new Promise(((i,n)=>{var s;let l;if("string"==typeof e){const t=e;if(l=this._children[t],!l)return void n(`killChild: Child ${t} not found`)}else l=e;if(this.debug&&this.consoleLog(`Killing child ${l.id} due to: ${t}`),l)if(r&&this.clearRestartTimeout(l),l.alive){let e;const t=null!==(s=l.config.killTimeout)&&void 0!==s?s:a.DEFAULT_KILL_TIMEOUT;0!==t&&(e=setTimeout((()=>{r&&delete this._children[l.id],n(new o.KillTimeoutError(`Timeout: Kill child process "${l.id}"`))}),t)),l.process.once("close",(()=>{r&&(Object.entries(l.instances).forEach((([e,t])=>{delete l.instances[e];const r=this._proxyEventListeners.get(t.proxy);null==r||r.clear(),this._proxyEventListeners.delete(t.proxy)})),delete this._children[l.id]),e&&clearTimeout(e),l.isClosing=!1,i()})),l.isClosing||(l.isClosing=!0,l.process.kill())}else r&&delete this._children[l.id],l.isClosing=!1,i()}))}rejectChildMethods(e,t){Object.keys(e.methods).forEach((r=>{const i=e.methods[r];i.reject(Error(`Method "${i.methodName}()" aborted due to: ${t}`))})),e.methods={}}consoleError(...e){console.error(`ThreadedClass Error (${this.uniqueId})`,...e)}consoleLog(...e){console.log(`ThreadedClass (${this.uniqueId})`,...e)}findProxyInstanceOfChild(e,t){for(const r of Object.keys(e.instances))if(e.instances[r].proxy===t)return r}}t.ThreadedClassManagerClassInternal=f,function(e){e.WEB_WORKER="web_worker",e.NOT_SUPPORTED="not_supported",e.WORKER_THREADS="worker_threads",e.CHILD_PROCESS="child_process"}(p=t.ThreadMode||(t.ThreadMode={})),t.ThreadedClassManagerInternal=new f,t.ThreadedClassManager=new m(t.ThreadedClassManagerInternal)},7369:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.threadedClass=void 0;const i=r(6928),a=r(3791),o=r(6156),n=r(4468),s=r(2081);t.threadedClass=function(e,t,l,u={}){let c=t;const d=new Error;if("string"!=typeof e)throw new Error("threadedClass parameter orgModule must be a string!");if("string"!=typeof t)throw new Error("threadedClass parameter orgExport must be a string!");const p=Object.assign(Object.assign({},u),{instanceName:u.instanceName||t});if((0,o.isBrowser)()){if(!p.pathToWorker)throw Error("config.pathToWorker is required in browser");(0,o.browserSupportsWebWorkers)()||(console.log("Web-workers not supported, disabling multi-threading"),p.disableMultithreading=!0)}let m=a()[1].getFileName(),b=a()[0].getFileName();return new Promise(((t,a)=>{function u(e,t,r,i){let a={cmd:n.Message.To.Instance.CommandType.FUNCTION,fcn:t,args:r};s.ThreadedClassManagerInternal.sendMessageToInstance(e,a,i)}function f(e,t,r,i,a){let o={cmd:n.Message.To.Instance.CommandType.REPLY,replyTo:t,reply:i,error:r?(r.stack||r).toString():r};s.ThreadedClassManagerInternal.sendMessageToInstance(e,o,a)}function g(e,t,r){f(e,t.cmdId,r)}function h(e,t){return(0,n.decodeArguments)((()=>e.proxy),[t],(t=>(...r)=>new Promise(((i,a)=>{!function(e,t,r,o){let l={cmd:n.Message.To.Instance.CommandType.CALLBACK,callbackId:t,args:r};s.ThreadedClassManagerInternal.sendMessageToInstance(e,l,((e,t,r)=>{if(t)a(t);else{let t=h(e,r);i(t)}}))}(e,t.value,r)}))))[0]}try{let y="",S="";if((0,o.isBrowser)())S=p.pathToWorker,y=e;else{if(!m)throw new Error("Unable to resolve parent file path");if(!b)throw new Error("Unable to resolve own file path");let t=e.match(/^\./)?i.resolve(m,"../",e):e;y=r(9551).resolve(t),S=b.replace(/parent-process/,"child-process").replace(/threadedClass(\.[tj]s)$/,"threadedclass-worker.js").replace(/src([\\\/])child-process([\\\/])threadedclass-worker/,"dist$1child-process$2threadedclass-worker")}const v=s.ThreadedClassManagerInternal.findNextAvailableChild(p,S),P={};let C=s.ThreadedClassManagerInternal.attachInstanceToChild(p,v,P,y,c,l,(function(e,t){if(t.cmd===n.Message.From.Instance.CommandType.REPLY){let r=t;const i=e.child;let a=i.instanceMessageQueue[r.replyTo+""];if(!a)return;r.error?a(e,r.error):a(e,null,r.reply),delete i.instanceMessageQueue[r.replyTo+""]}else if(t.cmd===n.Message.From.Instance.CommandType.CALLBACK){let r=t,i=e.child.callbacks[r.callbackId];if(!i)throw Error(`callback "${r.callbackId}" not found in instance ${t.instanceId}`);try{Promise.resolve(i(...r.args)).then((t=>{let i=(0,n.encodeArguments)(e,e.child.callbacks,[t],!!p.disableMultithreading);f(e,r.cmdId,void 0,i[0])})).catch((t=>{g(e,r,t)}))}catch(t){g(e,r,t)}}}));s.ThreadedClassManagerInternal.sendInit(v,C,p,((e,r,i)=>r?(a(r),!1):(i.forEach((t=>{if(!e.child.alive)throw Error(`Child process of instance ${e.id} has been closed`);if(!P.hasOwnProperty(t.key))if(t.type===n.InitPropType.FUNCTION){const r=(...r)=>{const i=new Error;return e.child?s.ThreadedClassManagerInternal.doMethod(e.child,t.key,((a,s)=>{if(!e.child)throw new Error(`Instance ${e.id} has been detached from child process`);let l=(0,n.encodeArguments)(e,e.child.callbacks,r,!!p.disableMultithreading);u(e,t.key,l,((e,t,r)=>{if(t)t=(0,o.combineErrorStacks)(t,"Original stack (on parent):",i.stack||""),s(t);else{let t=h(e,r);a(t)}}))})):Promise.reject(new Error(`Instance ${e.id} has been detached from child process`))};P[t.key]=r}else if(t.type===n.InitPropType.VALUE){let r={configurable:!1,enumerable:t.descriptor.enumerable};(t.descriptor.get||t.descriptor.readable)&&(r.get=function(){return new Promise(((r,i)=>{u(e,t.key,[],((e,t,a)=>{if(t)i(t);else{let t=h(e,a);r(t)}}))}))}),(t.descriptor.set||t.descriptor.writable)&&(r.set=function(r){let i=(0,n.encodeArguments)(e,e.child.callbacks,[r],!!p.disableMultithreading);!function(e,t,r,i){let a={cmd:n.Message.To.Instance.CommandType.SET,property:t,value:r};s.ThreadedClassManagerInternal.sendMessageToInstance(e,a,((e,t,r)=>{t&&(console.log("Error in setter",t),P.__uncaughtError=t)}))}(e,t.key,i[0])}),Object.defineProperty(P,t.key,r)}})),s.ThreadedClassManagerInternal.startMonitoringChild(C),t(P),s.ThreadedClassManagerInternal.checkInstance(C,d),!0)))}catch(e){a(e)}}))}},550:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerPlatformBase=void 0;const i=r(228);class a extends i.EventEmitter{constructor(){super(...arguments),this._isFakeProcess=!1}get isFakeProcess(){return this._isFakeProcess}}t.WorkerPlatformBase=a},7963:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forkChildProcess=t.ChildProcessWorker=void 0;const i=r(5317),a=r(550);class o extends a.WorkerPlatformBase{constructor(e){super(),this.worker=(0,i.fork)(e),this.worker.on("message",(e=>this.emit("message",e))),this.worker.on("close",(()=>this.emit("close"))),this.worker.on("error",(e=>this.emit("error",e)))}kill(){this.worker.kill()}send(e){this.worker.send(e)}}t.ChildProcessWorker=o,t.forkChildProcess=function(e){return new o(e)}},9599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FakeProcess=void 0;const i=r(550),a=r(8126);class o extends i.WorkerPlatformBase{constructor(){super(),this._isFakeProcess=!0,this.worker=new a.FakeWorker((e=>{this.emit("message",e)}))}kill(){this.emit("close")}send(e){this.worker.onMessageFromParent(e)}}t.FakeProcess=o},2557:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forkWebWorker=t.WebWorkerProcess=void 0;const i=r(550);class a extends i.WorkerPlatformBase{constructor(e){super();try{this.worker=new window.Worker(e),this.worker.onmessage=e=>{"message"===e.type?this.emit("message",e.data):console.log("unknown message type",e)},this.worker.onmessageerror=e=>{this.emit("error",e)},this.worker.onerror=e=>{this.emit("error",e)}}catch(e){let t=(e.stack||e).toString()+"";throw t.match(/cannot be accessed from origin/)&&t.match(/file:\/\//)?Error("Unable to create Web-Worker. Not allowed to run from local file system.\n"+t):e}}kill(){this.worker.terminate(),this.emit("close")}send(e){this.worker.postMessage(e)}}t.WebWorkerProcess=a,t.forkWebWorker=function(e){return new a(e)}},681:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forkWorkerThread=t.WorkerThread=void 0;const i=r(6156),a=r(550),o=r(9896),n=r(6928),s=(0,i.getWorkerThreads)(),l=n.join(__dirname,"../../js/asar-loader.js");let u=!1;const c=process.versions.electron;if(c&&l.match(/.asar(\/|\\)/)){const[e,t]=c.split(".").map((e=>parseInt(e,10)));(e<17||17===e&&t<3)&&(u=!0)}class d extends a.WorkerPlatformBase{constructor(e){if(super(),!s)throw new Error("Unable to create Worker thread! Not supported!");let t=process.env.THREADEDCLASS_WORKERTHREAD_LOADER;if(!t&&u&&(t=l),t){const r=(0,o.readFileSync)(t);this.worker=new s.Worker(r.toString(),{workerData:e,eval:!0})}else this.worker=new s.Worker(e,{workerData:""});this.worker.on("message",(e=>{this.emit("message",e)})),this.worker.on("messageerror",(e=>{this.emit("error",e)})),this.worker.on("error",(e=>{this.emit("error",e)})),this.worker.on("exit",(e=>{this.emit("close")})),this.worker.on("close",(()=>{this.emit("close")}))}kill(){const e=this.worker.terminate();e?e.then((()=>{this.emit("close")})).catch((e=>{console.error("Worker Thread terminate failed",e)})):this.emit("close")}send(e){this.worker.postMessage(e)}}t.WorkerThread=d,t.forkWorkerThread=function(e){return new d(e)}},9551:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=9551,e.exports=t},6156:(e,t,r)=>{"use strict";function i(){return!(process&&process.hasOwnProperty("stdin"))}function a(){try{return r(8167)}catch(e){return null}}Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayMap=t.combineErrorStacks=t.stripStack=t.getErrorStack=t.assertNever=t.getWorkerThreads=t.nodeSupportsWorkerThreads=t.browserSupportsWebWorkers=t.isBrowser=void 0,t.isBrowser=i,t.browserSupportsWebWorkers=function(){return!(!i()||!window.Worker)},t.nodeSupportsWorkerThreads=function(){return!!a()},t.getWorkerThreads=a,t.assertNever=function(e){},t.getErrorStack=function(e){if("object"==typeof e){return e.stack||`${e}`}return`${e}`},t.stripStack=function(e,t){if(!e)return e;const r=e.split("\n");let i=-1;for(let e=0;e<r.length;e++){let a=!1;for(const o of t){if(!r[e]||!r[e].match(o)){a=!1;break}-1===i&&(i=e),a=!0,e+=1}if(a)return r.slice(0,i).join("\n")}return e},t.combineErrorStacks=function e(t,...r){if("object"==typeof t){const i=new Error(t.message);return i.stack=e(`${t.stack}`,...r),i}return t+"\n"+r.join("\n")};class o extends Map{constructor(){super()}push(e,t){const r=this.get(e);return r?(r.push(t),r.length):(this.set(e,[t]),1)}remove(e,t){let r=!1;const i=this.get(e);if(i){const a=i.indexOf(t);-1!==a&&(i.splice(a,1),r=!0),0===i.length&&this.delete(e)}return r}arraySize(e){var t,r;return null!==(r=null===(t=this.get(e))||void 0===t?void 0:t.length)&&void 0!==r?r:0}get totalSize(){let e=0;for(const t of this.values())e+=t.length;return e}}t.ArrayMap=o},4468:(e,t)=>{"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.decodeArguments=t.encodeArguments=t.Message=t.InitPropType=t.DEFAULT_AUTO_RESTART_RETRY_DELAY=t.DEFAULT_AUTO_RESTART_RETRY_COUNT=t.DEFAULT_KILL_TIMEOUT=t.DEFAULT_RESTART_TIMEOUT=t.DEFAULT_CHILD_FREEZE_TIME=void 0,t.DEFAULT_CHILD_FREEZE_TIME=1e3,t.DEFAULT_RESTART_TIMEOUT=1e3,t.DEFAULT_KILL_TIMEOUT=1e3,t.DEFAULT_AUTO_RESTART_RETRY_COUNT=1,t.DEFAULT_AUTO_RESTART_RETRY_DELAY=1e3,(i=t.InitPropType||(t.InitPropType={})).FUNCTION="function",i.VALUE="value",function(e){let t,r;!function(e){let t,r;!function(e){let t;!function(e){e.INIT="init",e.PING="ping",e.FUNCTION="fcn",e.REPLY="reply",e.SET="set",e.KILL="kill",e.CALLBACK="callback"}(t=e.CommandType||(e.CommandType={}))}(t=e.Instance||(e.Instance={})),function(e){let t;!function(e){e.GET_MEM_USAGE="get_mem_usage",e.REPLY="reply"}(t=e.CommandType||(e.CommandType={}))}(r=e.Child||(e.Child={}))}(t=e.To||(e.To={})),function(e){let t,r;!function(e){let t;!function(e){e.CALLBACK="callback",e.REPLY="reply"}(t=e.CommandType||(e.CommandType={}))}(t=e.Instance||(e.Instance={})),function(e){let t;!function(e){e.LOG="log",e.REPLY="reply",e.CALLBACK="callback"}(t=e.CommandType||(e.CommandType={}))}(r=e.Child||(e.Child={}))}(r=e.From||(e.From={}))}(t.Message||(t.Message={})),function(e){e.STRING="string",e.NUMBER="number",e.UNDEFINED="undefined",e.NULL="null",e.OBJECT="object",e.FUNCTION="function",e.BUFFER="buffer",e.OTHER="other"}(r||(r={}));let a=0;t.encodeArguments=function(e,t,i,o){try{return i.map(((i,n)=>{try{if("object"==typeof i&&i===e)return{type:r.OBJECT,value:"self"};if(o){if(i instanceof Buffer)return{type:r.BUFFER,original:i,value:null};if("object"==typeof i)return{type:r.OBJECT,original:i,value:null}}if(i instanceof Buffer)return{type:r.BUFFER,value:i.toString("hex")};if("string"==typeof i)return{type:r.STRING,value:i};if("number"==typeof i)return{type:r.NUMBER,value:i};if("function"==typeof i){for(const e in t)if(t[e]===i)return{type:r.FUNCTION,value:e+""};const e=a++;return t[e+""]=i,{type:r.FUNCTION,value:e+""}}return void 0===i?{type:r.UNDEFINED,value:i}:null===i?{type:r.NULL,value:i}:"object"==typeof i?{type:r.OBJECT,value:i}:{type:r.OTHER,value:i}}catch(e){throw e.stack&&(e.stack+="\nIn encodeArguments, argument "+n),e}}))}catch(e){throw e.stack&&(e.stack+="\nThreadedClass, unsupported attribute"),e}},t.decodeArguments=function(e,t,i){return t.map((t=>void 0!==t.original?t.original:t.type===r.STRING||t.type===r.NUMBER?t.value:t.type===r.BUFFER?Buffer.from(t.value,"hex"):t.type===r.UNDEFINED||t.type===r.NULL?t.value:t.type===r.FUNCTION?i(t):t.type===r.OBJECT&&"self"===t.value?e():t.value))}},9852:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__assign:()=>o,__asyncDelegator:()=>v,__asyncGenerator:()=>S,__asyncValues:()=>P,__await:()=>y,__awaiter:()=>c,__classPrivateFieldGet:()=>I,__classPrivateFieldSet:()=>w,__createBinding:()=>p,__decorate:()=>s,__exportStar:()=>m,__extends:()=>a,__generator:()=>d,__importDefault:()=>A,__importStar:()=>k,__makeTemplateObject:()=>C,__metadata:()=>u,__param:()=>l,__read:()=>f,__rest:()=>n,__spread:()=>g,__spreadArrays:()=>h,__values:()=>b});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},i(e,t)};function a(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},o.apply(this,arguments)};function n(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]])}return r}function s(e,t,r,i){var a,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(n=(o<3?a(n):o>3?a(t,r,n):a(t,r))||n);return o>3&&n&&Object.defineProperty(t,r,n),n}function l(e,t){return function(r,i){t(r,i,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,r,i){return new(r||(r=Promise))((function(a,o){function n(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,s)}l((i=i.apply(e,t||[])).next())}))}function d(e,t){var r,i,a,o,n={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=2&o[0]?i.return:o[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;switch(i=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return n.label++,{value:o[1],done:!1};case 5:n.label++,i=o[1],o=[0];continue;case 7:o=n.ops.pop(),n.trys.pop();continue;default:if(!((a=(a=n.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){n=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){n.label=o[1];break}if(6===o[0]&&n.label<a[1]){n.label=a[1],a=o;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(o);break}a[2]&&n.ops.pop(),n.trys.pop();continue}o=t.call(e,n)}catch(e){o=[6,e],i=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function p(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}function m(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,a,o=r.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return n}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function h(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<r;t++)for(var o=arguments[t],n=0,s=o.length;n<s;n++,a++)i[a]=o[n];return i}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function S(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,a=r.apply(e,t||[]),o=[];return i={},n("next"),n("throw"),n("return"),i[Symbol.asyncIterator]=function(){return this},i;function n(e){a[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||s(e,t)}))})}function s(e,t){try{(r=a[e](t)).value instanceof y?Promise.resolve(r.value.v).then(l,u):c(o[0][2],r)}catch(e){c(o[0][3],e)}var r}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function v(e){var t,r;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,a){t[i]=e[i]?function(t){return(r=!r)?{value:y(e[i](t)),done:"return"===i}:a?a(t):t}:a}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,a){!function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}(i,a,(t=e[r](t)).done,t.value)}))}}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function A(e){return e&&e.__esModule?e:{default:e}}function I(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function w(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},2622:e=>{"use strict";e.exports=require("atem-connection")},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},7194:e=>{"use strict";e.exports=require("dgram")},9896:e=>{"use strict";e.exports=require("fs")},1943:e=>{"use strict";e.exports=require("fs/promises")},9278:e=>{"use strict";e.exports=require("net")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},8167:e=>{"use strict";e.exports=require("worker_threads")},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=function(e,t){Promise.resolve().then((async()=>{if(c)throw new Error("runEntrypoint can only be called once");if(c=!0,t||(t=[]),!Array.isArray(t))throw new Error("upgradeScripts must be an array");for(const e of t)if("function"!=typeof e)throw new Error("upgradeScripts must be an array of functions");const r=process.env.MODULE_MANIFEST;if(!r)throw new Error("Module initialise is missing MODULE_MANIFEST");const i=await o.default.readFile(r),d=JSON.parse(i.toString());if(d.runtime?.api!==a.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!d.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let p=d.runtime.apiVersion;if("0.0.0"===p)try{const e=await o.default.readFile(l.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(p=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const m=process.env.CONNECTION_ID;if("string"!=typeof m||!m)throw new Error("Module initialise is missing CONNECTION_ID");const b=process.env.VERIFICATION_TOKEN;if("string"!=typeof b||!b)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const f=new s.IpcWrapper({},(e=>{process.send(e)}),5e3);process.once("message",(e=>{f.receivedMessage(e)})),u=new e((0,n.literal)({id:m,upgradeScripts:t,_isInstanceBaseProps:!0})),f.sendWithCb("register",{apiVersion:p,connectionId:m,verificationToken:b}).then((()=>{console.log("Module-host accepted registration")}),(e=>{console.error("Module registration failed",e),process.exit(11)}))})).catch((e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)}))};const i=r(1635),a=r(9967),o=i.__importDefault(r(1943)),n=r(360),s=r(4044),l=i.__importDefault(r(6928));let u,c=!1},6160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var i=r(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return i.TCPHelper}});var a=r(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return a.TelnetHelper}});var o=r(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return o.UDPHelper}})},8895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const i=r(1635).__importDefault(r(9278)),a=r(3693),o=r(1400);class n extends a.EventEmitter{#n;#s;_socket;#l;#u=!1;#c=!1;#d=!1;#p;#m;#b;get isConnected(){return this.#u}get isConnecting(){return this.#c}get isDestroyed(){return this.#d}constructor(e,t,r){super(),this.#n=e,this.#s=t,this.#l={reconnect_interval:2e3,reconnect:!0,...r},this._socket=new i.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",(e=>{this.#c=!1,this.#u=!1,this.#l.reconnect&&this.#f(),this.#g(o.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this._socket.on("ready",(()=>{this.#u=!0,this.#c=!1,this.#g(o.InstanceStatus.Ok),this.emit("connect")})),this._socket.on("end",(()=>{this.#u=!1,this.#g(o.InstanceStatus.Disconnected),!this.#c&&this.#l.reconnect&&this.#f(),this.emit("end")})),this._socket.on("data",(e=>this.emit("data",e))),this._socket.on("drain",(()=>this.emit("drain"))),setImmediate((()=>{this.#d||this.connect()})),this.#b=setTimeout((()=>{this.#b=void 0,this.#d||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#n}:${this.#s} is missing an error handler!`)}),5e3)}connect(){if(this.#d)throw new Error("Cannot connect destroyed socket");return!this.#c&&(this.#c=!0,this._socket.connect(this.#s,this.#n),!0)}async send(e){if(this.#d||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#u)return!1;try{return new Promise(((t,r)=>{this._socket.write(e,(e=>{e?r(e):t(!0)}))}))}catch(e){this.#u=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#g(o.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#d=!0,void 0!==this.#m&&(clearTimeout(this.#m),this.#m=void 0),void 0!==this.#b&&(clearTimeout(this.#b),this.#b=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#f(){void 0!==this.#m&&clearTimeout(this.#m),this.#m=setTimeout((()=>{this.#m=void 0,this.#g(o.InstanceStatus.Connecting),this.connect()}),this.#l.reconnect_interval)}#g(e,t){this.#p!=e&&(this.#p=e,this.emit("status_change",e,t))}}t.TCPHelper=n},1118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const i=r(1635).__importDefault(r(3693)),a=r(2203),o=r(8895);class n extends i.default{#h;#y;#b;get isConnected(){return this.#h.isConnected}get isConnecting(){return this.#h.isConnecting}get isDestroyed(){return this.#h.isDestroyed}constructor(e,t,r){super(),this.#h=new o.TCPHelper(e,t,r),this.#y=new s,this.#h._socket.pipe(this.#y),this.#h.on("connect",(()=>this.emit("connect"))),this.#h.on("end",(()=>this.emit("end"))),this.#h.on("error",(e=>this.emit("error",e))),this.#h.on("status_change",((e,t)=>this.emit("status_change",e,t))),this.#y.on("iac",((e,t)=>this.emit("iac",e,t))),this.#y.on("sb",(e=>this.emit("sb",e))),this.#y.on("data",(e=>this.emit("data",e))),this.#y.on("drain",(()=>this.emit("drain"))),this.#b=setTimeout((()=>{this.#b=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)}),5e3)}connect(){return this.#h.connect()}async send(e){return this.#h.send(e)}destroy(){this.#h.destroy(),void 0!==this.#b&&(clearTimeout(this.#b),this.#b=void 0),this.#y.removeAllListeners(),this.#y.destroy()}}t.TelnetHelper=n;class s extends a.Transform{#S;#v;#P;constructor(e){super(e),this.#S=Buffer.alloc(0),this.#v=Buffer.alloc(0),this.#P=0}_transform(e,t,r){for(let t=0;t<e.length;++t)this.#C(e[t]);const i=this.#k();i.length&&this.push(i),r()}#C(e){if(0===this.#P){if(255===e)return void(this.#P=255);this.#S=Buffer.concat([this.#S,Buffer.from([e])])}else if(255===this.#P)switch(e){case 250:case 251:case 252:case 253:case 254:this.#P=e;break;default:this.#P=0}else{if(this.#P>=251&&this.#P<=254){let t;switch(this.#P){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#P=0)}if(250===this.#P){if(240===e)return this.emit("sb",this.#v),this.#P=0,void(this.#v=Buffer.alloc(0));this.#v=Buffer.concat([this.#v,Buffer.from([e])])}}}#k(){const e=this.#S;return this.#S=Buffer.alloc(0),e}}},6259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const i=r(1635).__importDefault(r(7194)),a=r(3693),o=r(1400);class n extends a.EventEmitter{#n;#s;#A;#l;#d=!1;#p;#b;get isDestroyed(){return this.#d}constructor(e,t,r){super(),this.#n=e,this.#s=t,this.#l={...r},this.#A=i.default.createSocket("udp4");try{this.#A.bind(this.#l.bind_port||0,this.#l.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#l.bind_ip||"0.0.0.0"}:${this.#l.bind_port||0}`)}void 0!==this.#l.ttl&&this.#A.setTTL(this.#l.ttl),void 0!==this.#l.multicast_ttl&&this.#A.setMulticastTTL(this.#l.multicast_ttl),this.#A.on("error",(e=>{this.#g(o.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this.#A.on("listening",(()=>{this.#l.broadcast&&this.#A.setBroadcast(!0),this.#l.multicast_interface&&this.#A.setMulticastInterface(this.#l.multicast_interface),this.#g(o.InstanceStatus.Ok),this.emit("listening")})),this.#A.on("message",((e,t)=>this.emit("data",e,t))),this.#b=setTimeout((()=>{this.#d||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#n}:${this.#s} is missing an error handler!`)}),5e3)}async send(e){if(this.#d)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise(((t,r)=>{this.#A.send(e,this.#s,this.#n,(e=>{e?r(e):t()}))}))}destroy(){this.#d=!0,void 0!==this.#b&&(clearTimeout(this.#b),this.#b=void 0),this.#A.removeAllListeners(),this.#A.close(),this.removeAllListeners()}#g(e,t){this.#p!=e&&(this.#p=e,this.emit("status_change",e,t))}}t.UDPHelper=n},4044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const i=r(1635),a=r(360),o=i.__importDefault(r(6022));t.IpcWrapper=class{#I;#w;#_;#x=1;#E=new Map;constructor(e,t,r){this.#I=e,this.#w=t,this.#_=r}async sendWithCb(e,t,r,i=0){i<=0&&(i=this.#_);const a={timeout:void 0,resolve:()=>null,reject:()=>null},n=new Promise(((e,t)=>{a.resolve=e,a.reject=t}));this.#x>268435456&&(this.#x=1);const s=this.#x++;this.#E.set(s,a),this.#w({direction:"call",name:String(e),payload:o.default.stringify(t),callbackId:s});const l=new Error("Call timed out");return a.timeout=setTimeout((()=>{a.reject(r?r():l),this.#E.delete(s)}),i),n}sendWithNoCb(e,t){this.#w({direction:"call",name:String(e),payload:o.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#I[e.name];if(!t)return void(e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!1,payload:o.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?o.default.parse(e.payload):void 0).then((t=>{e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!0,payload:o.default.stringify(t)})}),(t=>{e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):o.default.stringify(t)})}));break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#E.get(e.callbackId);if(this.#E.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const r=e.payload?o.default.parse(e.payload):void 0;if(e.success)t.resolve(r);else{let e=r;r&&"object"==typeof r&&"message"in r&&(e=new Error(r.message),r.stack&&(e.stack=r.stack)),t.reject(e)}break}default:(0,a.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},6278:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const i=r(1635);i.__exportStar(r(9077),t),i.__exportStar(r(2018),t),i.__exportStar(r(4581),t);var a=r(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return a.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return a.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return a.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return a.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return a.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return a.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return a.assertNever}}),i.__exportStar(r(6160),t);var o=r(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return o.runEntrypoint}})},4289:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const i=r(2593);function a(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#M;#T;#N;#O=new Map;#R=new Map;constructor(e,t,r){this.#M=e,this.#T=t,this.#N=r}async handleExecuteAction(e){const t=this.#O.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},r)}handleUpdateActions(e){for(const[t,r]of Object.entries(e)){const e=this.#R.get(t);if(e){const t=this.#O.get(e.actionId);if(t?.unsubscribe){const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(a(e),r)).catch((t=>{this.#N("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!r||r.disabled)this.#R.delete(t);else{this.#R.set(t,r);const e=this.#O.get(r.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#M({text:e,controlId:r.controlId,actionInstanceId:r.id,feedbackInstanceId:void 0})).text};Promise.resolve(e.subscribe(a(r),t)).catch((e=>{this.#N("error",`Action subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}))}}}}async handleLearnAction(e){const t=this.#O.get(e.action.actionId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},r)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#O.clear();for(const[r,a]of Object.entries(e))a&&(t.push({id:r,name:a.name,description:a.description,options:(0,i.serializeIsVisibleFn)(a.options),hasLearn:!!a.learn,learnTimeout:a.learnTimeout}),this.#O.set(r,a));this.#T({actions:t})}_getAllActions(){return Array.from(this.#R.values()).map((e=>({id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options})))}subscribeActions(e){let t=Array.from(this.#R.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.actionId))));for(const e of t){const t=this.#O.get(e.actionId);if(t?.subscribe){const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.subscribe(a(e),r)).catch((t=>{this.#N("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeActions(e){let t=Array.from(this.#R.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.actionId))));for(const e of t){const t=this.#O.get(e.actionId);if(t&&t.unsubscribe){const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(a(e),r)).catch((t=>{this.#N("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeIsVisibleFn=function(e){return(e??[]).map((e=>"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisible:void 0}:{...e,isVisibleFn:void 0}))},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},8039:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const i=r(1635),a=r(2593),o=i.__importDefault(r(7e3));function n(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#M;#D;#F;#N;#V=new Map;#$=new Map;#B=new Map;#L=new Map;#j;get parseVariablesContext(){return this.#j}constructor(e,t,r,i){this.#M=e,this.#D=t,this.#F=r,this.#N=i}getDefinitionIds(){return Array.from(this.#V.keys())}getInstanceIds(){return Array.from(this.#$.keys())}handleUpdateFeedbacks(e){for(const[t,r]of Object.entries(e)){const e=this.#$.get(t);if(e){const t=this.#V.get(e.feedbackId);if(t?.unsubscribe){const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(n(t.type,e),r)).catch((t=>{this.#N("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!r||r.disabled)this.#$.delete(t);else{this.#$.set(t,{...r,referencedVariables:null});const e=this.#V.get(r.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#M({text:e,controlId:r.controlId,actionInstanceId:void 0,feedbackInstanceId:r.id})).text};Promise.resolve(e.subscribe(n(e.type,r),t)).catch((e=>{this.#N("error",`Feedback subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}))}this.#K(t)}}}async handleLearnFeedback(e){const t=this.#V.get(e.feedback.feedbackId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},r)}}return{options:void 0}}handleVariablesChanged(e){if(!e.variablesIds.length)return;const t=new Set(e.variablesIds);for(const t of this.#L.values())for(const r of e.variablesIds)t.changedVariables.add(r);const r=new Set;for(const e of this.#$.values())if(!this.#L.has(e.id)&&e.referencedVariables)for(const i of e.referencedVariables)if(t.has(i)){r.add(e.id);break}for(const e of r)setImmediate((()=>{this.#K(e)}))}#K(e){const t=this.#L.get(e);if(t)return void(t.needsRecheck=!0);const r=this.#$.get(e);if(!r)return;const i=r,a={needsRecheck:!1,changedVariables:new Set};this.#L.set(e,a),Promise.resolve().then((async()=>{const t=this.#V.get(i.feedbackId);let r;const a=new Set;if(t){this.#j=`Feedback ${i.feedbackId} (${e})`;const o={parseVariablesInString:async t=>{const r=await this.#M({text:t,controlId:i.controlId,actionInstanceId:void 0,feedbackInstanceId:e});if(r.variableIds&&r.variableIds.length)for(const e of r.variableIds)a.add(e);return r.text}};r="boolean"===t.type?t.callback({...n("boolean",i),type:"boolean"},o):t.callback({...n("advanced",i),type:"advanced",image:i.image},o),this.#j=void 0}const o=await r;this.#B.set(e,{id:e,controlId:i.controlId,value:o}),this.#U(),i.referencedVariables=a.size>0?Array.from(a):null})).catch((e=>{console.error(`Feedback check failed: ${JSON.stringify(i)} - ${e?.message??e} ${e?.stack}`)})).finally((()=>{this.#j=void 0,this.#L.delete(e);let t=!1;if(i.referencedVariables)for(const e of i.referencedVariables)if(a.changedVariables.has(e)){t=!0;break}(t||a.needsRecheck)&&setImmediate((()=>{this.#K(e)}))}))}#U=(0,o.default)((()=>{const e=this.#B;this.#B=new Map,e.size>0&&this.#D({values:Array.from(e.values())})}),{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#V.clear();for(const[r,i]of Object.entries(e))i&&(t.push({id:r,name:i.name,description:i.description,options:(0,a.serializeIsVisibleFn)(i.options),type:i.type,defaultStyle:"boolean"===i.type?i.defaultStyle:void 0,hasLearn:!!i.learn,learnTimeout:i.learnTimeout,showInvert:"boolean"===i.type&&i.showInvert}),this.#V.set(r,i));this.#F({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,r]of this.#$.entries())this.#V.get(r.feedbackId)&&(0===t.size||t.has(r.feedbackId))&&this.#K(e)}checkFeedbacksById(e){for(const t of e)this.#K(t)}_getAllFeedbacks(){return Array.from(this.#$.values()).map((e=>({id:e.id,feedbackId:e.feedbackId,controlId:e.controlId,options:e.options})))}subscribeFeedbacks(e){let t=Array.from(this.#$.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.feedbackId))));for(const e of t){const t=this.#V.get(e.feedbackId);if(t?.subscribe){const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.subscribe(n(t.type,e),r)).catch((t=>{this.#N("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeFeedbacks(e){let t=Array.from(this.#$.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.feedbackId))));for(const e of t){const t=this.#V.get(e.feedbackId);if(t&&t.unsubscribe){const r={parseVariablesInString:async t=>(await this.#M({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(n(t.type,e),r)).catch((t=>{this.#N("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},1706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=function(e,t,r,o,n,s){const l=new Map,u=e=>{let t=l.get(e);return t||(t={actions:[],feedbacks:[],config:!1},l.set(e,t)),t};for(const t of Object.values(e)){const e=t?.upgradeIndex??r;t&&"number"==typeof e&&u(e).actions.push(t.id)}for(const e of Object.values(t)){const t=e?.upgradeIndex??r;e&&"number"==typeof t&&u(t).feedbacks.push(e.id)}if(!s)for(let e=r??-1;e<o.length;e++)u(e).config=!0;const c={},d={};let p;if(l.size>0){const s=Array.from(l.keys()).sort(),u=Math.min(...s,r??-1)+1,m=[],b=[],f=o.length;for(let r=u;r<f;r++){const s=l.get(r-1);s&&(m.push(...s.actions),b.push(...s.feedbacks));const u=!!s?.config;if(!u&&0===m.length&&0===b.length)continue;const f=p??n,g=(0,o[r])({currentConfig:a(f)},{config:u?f:null,actions:m.map((t=>{const r=e[t];if(r)return(0,i.literal)({id:r.id,controlId:r.controlId,actionId:r.actionId,options:void 0!==r.options?a(r.options):{}})})).filter((e=>!!e)),feedbacks:b.map((e=>{const r=t[e];if(r)return(0,i.literal)({id:r.id,controlId:r.controlId,feedbackId:r.feedbackId,options:void 0!==r.options?a(r.options):{},isInverted:r.isInverted})})).filter((e=>!!e))});u&&g.updatedConfig&&(p=g.updatedConfig);for(const t of g.updatedActions)if(t){const r=e[t.id];r&&(r.actionId=t.actionId,r.options=t.options,d[t.id]=r)}for(const e of g.updatedFeedbacks)if(e){const r=t[e.id];r&&(r.feedbackId=e.feedbackId,r.options=e.options,c[e.id]={...r,style:c[e.id]?.style??e.style,isInverted:e.isInverted??!1})}}for(const[t,r]of Object.entries(e))d[t]||"number"!=typeof r?.upgradeIndex||(d[t]=r);for(const[e,r]of Object.entries(t))c[e]||"number"!=typeof r?.upgradeIndex||(c[e]=r)}return{updatedActions:d,updatedFeedbacks:c,updatedConfig:p}};const i=r(360);function a(e){return JSON.parse(JSON.stringify(e))}},9077:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=function(e){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'");if(!(0,i.default)(e)){const e=i.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}};const i=r(1635).__importDefault(r(7281))},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1649:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const i=r(1635),a=r(360),o=i.__importDefault(r(3290)),n=r(2593),s=r(1706),l=r(8039),u=r(4044),c=r(4289),d=r(2365);t.InstanceBase=class{#G;#z;id;#W=new o.default({concurrency:1});#H=!1;#q=!1;#J={};#Y;#X;#Q=new Map;#Z=new Map;#ee=new Map;#l;#te;get instanceOptions(){return this.#l}get label(){return this.#te}constructor(e){if(!(0,n.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#l={disableVariableValidation:!1},this.#G=new u.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:this._handleVariablesChanged.bind(this),sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},(e=>{process.send(e)}),5e3),process.on("message",(e=>{this.#G.receivedMessage(e)})),this.#Y=new c.ActionManager((async e=>this.#G.sendWithCb("parseVariablesInString",e)),(e=>this.#G.sendWithNoCb("setActionDefinitions",e)),this.log.bind(this)),this.#X=new l.FeedbackManager((async e=>this.#G.sendWithCb("parseVariablesInString",e)),(e=>this.#G.sendWithNoCb("updateFeedbackValues",e)),(e=>this.#G.sendWithNoCb("setFeedbackDefinitions",e)),this.log.bind(this)),this.#z=e.upgradeScripts,this.id=e.id,this.#te=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#W.add((async()=>{if(this.#H)throw new Error("Already initialized");const t=e.actions,r=e.feedbacks;if(this.#J=e.config,this.#te=e.label,e.isFirstInit){const t={},r=this.getConfigFields();for(const e of r)"default"in e&&(t[e.id]=e.default);this.#J=t,this.saveConfig(this.#J),e.lastUpgradeIndex=this.#z.length-1}const{updatedActions:i,updatedFeedbacks:a,updatedConfig:o}=(0,s.runThroughUpgradeScripts)(t,r,e.lastUpgradeIndex,this.#z,this.#J,!1);this.#J=o??this.#J;const n=this.#G.sendWithCb("upgradedItems",{updatedActions:i,updatedFeedbacks:a});try{await this.init(this.#J,!!e.isFirstInit),this.#H=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}finally{await n}return setImmediate((()=>{this._handleUpdateActions({actions:t},!0).catch((e=>{this.log("error",`Receive actions failed: ${e}`)})),this._handleUpdateFeedbacks({feedbacks:r},!0).catch((e=>{this.log("error",`Receive feedbacks failed: ${e}`)}))})),{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#z.length-1,updatedConfig:this.#J}}))}async _handleDestroy(){await this.#W.add((async()=>{if(!this.#H)throw new Error("Not initialized");await this.destroy(),this.#H=!1}))}async _handleConfigUpdateAndLabel(e){await this.#W.add((async()=>{if(!this.#H)throw new Error("Not initialized");this.#te=e.label,this.#J=e.config,await this.configUpdated(this.#J)}))}async _handleExecuteAction(e){return this.#Y.handleExecuteAction(e)}async _handleUpdateFeedbacks(e,t){if(!t){const t=(0,s.runThroughUpgradeScripts)({},e.feedbacks,null,this.#z,this.#J,!0);this.#G.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded feedbacks: ${e}`)}))}this.#X.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e,t){if(!t){const t=(0,s.runThroughUpgradeScripts)(e.actions,{},null,this.#z,this.#J,!0);this.#G.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded actions: ${e}`)}))}this.#Y.handleUpdateActions(e.actions)}async _handleGetConfigFields(e){return{fields:(0,n.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#Y.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#X.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#q)return}else if(!this.#q)return;if(!this.handleStartStopRecordActions)throw this.#q=!1,new Error("Recording actions is not supported by this module!");this.#q=e.recording,this.handleStartStopRecordActions(this.#q)}async _handleVariablesChanged(e){this.#X.handleVariablesChanged(e)}async _handleSharedUdpSocketMessage(e){for(const t of this.#Q.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#Q.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e){this.#J=e,this.#G.sendWithNoCb("saveConfig",{config:e})}setActionDefinitions(e){this.#Y.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#X.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[r,i]of Object.entries(e))i&&t.push({...i,id:r});this.#G.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],r=[];this.#Z.clear();for(const i of e)t.push({id:i.variableId,name:i.name}),this.#Z.set(i.variableId,i),this.#ee.has(i.variableId)||(this.#ee.set(i.variableId,""),r.push({id:i.variableId,value:""}));if(!this.#l.disableVariableValidation){const e=new Set(this.#Z.keys());for(const t of this.#ee.keys())e.has(t)||(this.#ee.delete(t),r.push({id:t,value:void 0}))}this.#G.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:r})}setVariableValues(e){const t=[];for(const[r,i]of Object.entries(e))this.#l.disableVariableValidation?(void 0===i?this.#ee.delete(r):this.#ee.set(r,i),t.push({id:r,value:i})):this.#Z.has(r)?(this.#ee.set(r,i??""),t.push({id:r,value:i??""})):t.push({id:r,value:void 0});this.#G.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#ee.get(e)}async parseVariablesInString(e){const t=this.#X.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),(await this.#G.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text}checkFeedbacks(...e){this.#X.checkFeedbacks(e)}checkFeedbacksById(...e){this.#X.checkFeedbacksById(e)}_getAllActions(){return this.#Y._getAllActions()}subscribeActions(...e){this.#Y.subscribeActions(e)}unsubscribeActions(...e){this.#Y.unsubscribeActions(e)}_getAllFeedbacks(){return this.#X._getAllFeedbacks()}subscribeFeedbacks(...e){this.#X.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#X.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#q)throw new Error("Not currently recording actions");this.#G.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}setCustomVariableValue(e,t){this.#G.sendWithNoCb("setCustomVariable",{customVariableId:e,value:t})}oscSend(e,t,r,i){this.#G.sendWithNoCb("send-osc",(0,a.literal)({host:e,port:t,path:r,args:i}))}updateStatus(e,t){this.#G.sendWithNoCb("set-status",(0,a.literal)({status:e,message:t??null}))}log(e,t){this.#G.sendWithNoCb("log-message",(0,a.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const r="string"==typeof e?{type:e}:e,i=new d.SharedUdpSocketImpl(this.#G,this.#Q,r);return t&&i.on("message",t),i}}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1400:(e,t)=>{"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(r||(t.InstanceStatus=r={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(i||(t.Regex=i={}))},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1635);i.__exportStar(r(3730),t),i.__exportStar(r(1649),t),i.__exportStar(r(7386),t),i.__exportStar(r(1400),t),i.__exportStar(r(8983),t),i.__exportStar(r(8104),t),i.__exportStar(r(3258),t),i.__exportStar(r(131),t),i.__exportStar(r(3371),t),i.__exportStar(r(9786),t),i.__exportStar(r(6132),t)},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2365:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const i=r(1635).__importDefault(r(3693)),a=r(360);class o extends i.default{#G;#re;#l;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#P&&"object"==typeof this.#P?this.#P:void 0}#P="pending";constructor(e,t,r){super(),this.#G=e,this.#re=t,this.#l={...r}}bind(e,t,r){if(this.#P&&"object"==typeof this.#P)throw new Error("Socket is already bound");switch(this.#P){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,a.assertNever)(this.#P),new Error("Invalid socket state")}this.#P="binding",r&&this.on("listening",r),this.#G.sendWithCb("sharedUdpSocketJoin",{family:this.#l.type,portNumber:e}).then((t=>{this.#P={portNumber:e,handleId:t},this.#re.set(t,this),this.emit("listening")}),(e=>{this.#P="closed",this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}close(e){if(this.#P&&"object"==typeof this.#P);else switch(this.#P){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,a.assertNever)(this.#P),new Error("Invalid socket state")}const t=this.#P.handleId;this.#P="closed",e&&this.on("close",e),this.#G.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then((()=>{this.#re.delete(t),this.emit("close")}),(e=>{this.#re.delete(t),this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}send(e,t,r,i,a,o){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof r){if("number"!=typeof i||"string"!=typeof a)throw new Error("Invalid arguments");if(void 0!==o&&"number"!=typeof o)throw new Error("Invalid arguments");const n=this.#ie(e,t,r);this.#ae(n,i,a,o)}else{if("string"!=typeof r)throw new Error("Invalid arguments");{if(void 0!==i&&"function"!=typeof i)throw new Error("Invalid arguments");const a=this.#ie(e,0,void 0);this.#ae(a,t,r,i)}}}#ie(e,t,r){let i;if("string"==typeof e)i=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))i=e;else{if(Array.isArray(e))return Buffer.from(e);i=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return i.subarray(t,void 0!==r?r+t:void 0)}#ae(e,t,r,i){if(!this.#P||"object"!=typeof this.#P)throw new Error("Socket is not open");this.#G.sendWithCb("sharedUdpSocketSend",{handleId:this.#P.handleId,message:e,address:r,port:t}).then((()=>{i?.()}),(e=>{this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#P="fatalError";const t=this.boundState;t&&this.#re.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=o},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyUpgradeScript=void 0,t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,r)=>{const i=[];for(const t of r.feedbacks){let r=e[t.feedbackId];if(!0===r&&(r={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),r){t.style||(t.style={});for(const[e,a]of Object.entries(r))void 0!==t.options[e]&&(t.style[a]=t.options[e],delete t.options[e],i.push(t))}}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:i}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,r)=>{const i=[];for(const t of r.feedbacks){const r=e[t.feedbackId];if("string"!=typeof r)continue;const a=t.options[r];void 0!==a&&(delete t.options[r],t.isInverted="true"===a||!0===a||Number(a)>0,i.push(t))}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:i}}},t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedActions:[],updatedFeedbacks:[]})},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,r,i){let a=(255&e)<<16|(255&t)<<8|255&r;return i&&i>=0&&i<1&&(a+=16777216*Math.round(255*(1-i))),a},t.splitRgb=a,t.splitHsl=function(e){const t=a(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=a(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=a(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()};const i=r(6284);function a(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,i.colord)(e).isValid()){const t=(0,i.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}},7281:(e,t,r)=>{"use strict";e.exports=l,e.exports.default=l;const i={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"}},required:["name"]}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18 or node22",enum:["node18","node22"]},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}},additionalProperties:!1}},additionalProperties:!1,required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1}}},a={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1},o=Object.prototype.hasOwnProperty,n=r(7169).A,s=new RegExp("","u");function l(e,{instancePath:t="",parentData:r,parentDataProperty:u,rootData:c=e}={}){let d=null,p=0;if(0===p){if(!e||"object"!=typeof e||Array.isArray(e))return l.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.id&&(r="id")||void 0===e.name&&(r="name")||void 0===e.shortname&&(r="shortname")||void 0===e.description&&(r="description")||void 0===e.version&&(r="version")||void 0===e.license&&(r="license")||void 0===e.repository&&(r="repository")||void 0===e.bugs&&(r="bugs")||void 0===e.maintainers&&(r="maintainers")||void 0===e.legacyIds&&(r="legacyIds")||void 0===e.runtime&&(r="runtime")||void 0===e.manufacturer&&(r="manufacturer")||void 0===e.products&&(r="products")||void 0===e.keywords&&(r="keywords"))return l.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;{const r=p;for(const r in e)if(!o.call(i.properties,r))return l.errors=[{instancePath:t,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===p){if(void 0!==e.$schema){const r=p;if("string"!=typeof e.$schema)return l.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var m=r===p}else m=!0;if(m){if(void 0!==e.id){const r=p;if("string"!=typeof e.id)return l.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.name){const r=p;if("string"!=typeof e.name)return l.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.shortname){const r=p;if("string"!=typeof e.shortname)return l.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.description){const r=p;if("string"!=typeof e.description)return l.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.version){const r=p;if("string"!=typeof e.version)return l.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.license){const r=p;if("string"!=typeof e.license)return l.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.repository){const r=p;if("string"!=typeof e.repository)return l.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.bugs){const r=p;if("string"!=typeof e.bugs)return l.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.maintainers){let r=e.maintainers;const i=p;if(p===i){if(!Array.isArray(r))return l.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var b=!0;const e=r.length;for(let i=0;i<e;i++){let e=r[i];const a=p;if(p===a){if(!e||"object"!=typeof e||Array.isArray(e))return l.errors=[{instancePath:t+"/maintainers/"+i,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.name&&(r="name"))return l.errors=[{instancePath:t+"/maintainers/"+i,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;if(void 0!==e.name){const r=p;if("string"!=typeof e.name)return l.errors=[{instancePath:t+"/maintainers/"+i+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=r===p}else f=!0;if(f){if(void 0!==e.email){const r=p;if("string"!=typeof e.email)return l.errors=[{instancePath:t+"/maintainers/"+i+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===p}else f=!0;if(f)if(void 0!==e.github){const r=p;if("string"!=typeof e.github)return l.errors=[{instancePath:t+"/maintainers/"+i+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===p}else f=!0}}}if(!(b=a===p))break}if(b){let e,i=r.length;if(i>1)for(;i--;)for(e=i;e--;)if(n(r[i],r[e]))return l.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1}}}m=i===p}else m=!0;if(m){if(void 0!==e.legacyIds){let r=e.legacyIds;const i=p;if(p===i){if(!Array.isArray(r))return l.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var g=!0;const e=r.length;for(let i=0;i<e;i++){const e=p;if("string"!=typeof r[i])return l.errors=[{instancePath:t+"/legacyIds/"+i,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(g=e===p))break}if(g){let e,i=r.length;if(i>1){const a={};for(;i--;){let o=r[i];if("string"==typeof o){if("number"==typeof a[o])return e=a[o],l.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;a[o]=i}}}}}}m=i===p}else m=!0;if(m){if(void 0!==e.runtime){let r=e.runtime;const a=p;if(p===a){if(!r||"object"!=typeof r||Array.isArray(r))return l.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===r.type&&(e="type")||void 0===r.api&&(e="api")||void 0===r.apiVersion&&(e="apiVersion")||void 0===r.entrypoint&&(e="entrypoint"))return l.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==r.type){let e=r.type;const a=p;if("string"!=typeof e)return l.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("node18"!==e&&"node22"!==e)return l.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/enum",keyword:"enum",params:{allowedValues:i.properties.runtime.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var h=a===p}else h=!0;if(h){if(void 0!==r.api){let e=r.api;const a=p;if("string"!=typeof e)return l.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return l.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:i.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;h=a===p}else h=!0;if(h){if(void 0!==r.apiVersion){const e=p;if("string"!=typeof r.apiVersion)return l.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=e===p}else h=!0;if(h)if(void 0!==r.entrypoint){const e=p;if("string"!=typeof r.entrypoint)return l.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=e===p}else h=!0}}}}m=a===p}else m=!0;if(m){if(void 0!==e.manufacturer){const r=p;if("string"!=typeof e.manufacturer)return l.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===p}else m=!0;if(m){if(void 0!==e.products){let r=e.products;const i=p;if(p===i){if(!Array.isArray(r))return l.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(r.length<1)return l.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var y=!0;const e=r.length;for(let i=0;i<e;i++){const e=p;if("string"!=typeof r[i])return l.errors=[{instancePath:t+"/products/"+i,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(y=e===p))break}if(y){let e,i=r.length;if(i>1){const a={};for(;i--;){let o=r[i];if("string"==typeof o){if("number"==typeof a[o])return e=a[o],l.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;a[o]=i}}}}}}m=i===p}else m=!0;if(m){if(void 0!==e.keywords){let r=e.keywords;const i=p;if(p===i){if(!Array.isArray(r))return l.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var S=!0;const e=r.length;for(let i=0;i<e;i++){const e=p;if("string"!=typeof r[i])return l.errors=[{instancePath:t+"/keywords/"+i,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(S=e===p))break}if(S){let e,i=r.length;if(i>1){const a={};for(;i--;){let o=r[i];if("string"==typeof o){if("number"==typeof a[o])return e=a[o],l.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;a[o]=i}}}}}}m=i===p}else m=!0;if(m)if(void 0!==e.bonjourQueries){let r=e.bonjourQueries;const i=p;if(p===i){if(!r||"object"!=typeof r||Array.isArray(r))return l.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const e=p;for(const e in r)if(!s.test(e))return l.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"}],!1;if(e===p)for(const e in r)if(s.test(e)){let i=r[e];const o=p,n=p;let u=!1,c=null;const m=p;if(p==p)if(i&&"object"==typeof i&&!Array.isArray(i)){let r;if(void 0===i.type&&(r="type")||void 0===i.protocol&&(r="protocol")){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===d?d=[i]:d.push(i),p++}else{const r=p;for(const r in i)if("type"!==r&&"protocol"!==r&&"txt"!==r){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===d?d=[i]:d.push(i),p++;break}if(r===p){if(void 0!==i.type){const r=p;if("string"!=typeof i.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),p++}var v=r===p}else v=!0;if(v){if(void 0!==i.protocol){let r=i.protocol;const o=p;if("string"!=typeof r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),p++}if("tcp"!==r&&"udp"!==r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:a.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===d?d=[r]:d.push(r),p++}v=o===p}else v=!0;if(v)if(void 0!==i.txt){let r=i.txt;const a=p;if(p===a)if(r&&"object"==typeof r&&!Array.isArray(r)){const i=p;for(const i in r)if(!s.test(i)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:i},message:"must NOT have additional properties"};null===d?d=[r]:d.push(r),p++;break}if(i===p)for(const i in r)if(s.test(i)){const a=p;if("string"!=typeof r[i]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+i.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),p++}if(a!==p)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[r]:d.push(r),p++}v=a===p}else v=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[r]:d.push(r),p++}m===p&&(u=!0,c=0);const b=p;if(p===b)if(Array.isArray(i)){const r=i.length;for(let o=0;o<r;o++){let r=i[o];const n=p;if(p==p)if(r&&"object"==typeof r&&!Array.isArray(r)){let i;if(void 0===r.type&&(i="type")||void 0===r.protocol&&(i="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:i},message:"must have required property '"+i+"'"};null===d?d=[r]:d.push(r),p++}else{const i=p;for(const i in r)if("type"!==i&&"protocol"!==i&&"txt"!==i){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:i},message:"must NOT have additional properties"};null===d?d=[r]:d.push(r),p++;break}if(i===p){if(void 0!==r.type){const i=p;if("string"!=typeof r.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),p++}var P=i===p}else P=!0;if(P){if(void 0!==r.protocol){let i=r.protocol;const n=p;if("string"!=typeof i){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),p++}if("tcp"!==i&&"udp"!==i){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:a.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===d?d=[r]:d.push(r),p++}P=n===p}else P=!0;if(P)if(void 0!==r.txt){let i=r.txt;const a=p;if(p===a)if(i&&"object"==typeof i&&!Array.isArray(i)){const r=p;for(const r in i)if(!s.test(r)){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===d?d=[i]:d.push(i),p++;break}if(r===p)for(const r in i)if(s.test(r)){const a=p;if("string"!=typeof i[r]){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[i]:d.push(i),p++}if(a!==p)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[r]:d.push(r),p++}P=a===p}else P=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[r]:d.push(r),p++}if(n!==p)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===d?d=[r]:d.push(r),p++}var C;if((C=b===p)&&u?(u=!1,c=[c,1]):C&&(u=!0,c=1),!u){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:c},message:"must match exactly one schema in oneOf"};return null===d?d=[r]:d.push(r),p++,l.errors=d,!1}if(p=n,null!==d&&(n?d.length=n:d=null),o!==p)break}}}m=i===p}else m=!0}}}}}}}}}}}}}}}}}}return l.errors=d,0===p}},7e3:(e,t,r)=>{"use strict";const i=r(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:r=0,maxWait:a=0,before:o=!1,after:n=!0}=t;if(!o&&!n)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let s,l,u;const c=function(...t){const i=this,c=o&&!s;return clearTimeout(s),s=setTimeout((()=>{s=void 0,l&&(clearTimeout(l),l=void 0),n&&(u=e.apply(i,t))}),r),a>0&&!l&&n&&(l=setTimeout((()=>{l=void 0,s&&(clearTimeout(s),s=void 0),u=e.apply(i,t)}),a)),c&&(u=e.apply(i,t)),u};return i(c,e),c.cancel=()=>{s&&(clearTimeout(s),s=void 0),l&&(clearTimeout(l),l=void 0)},c}},1635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>D,__assign:()=>o,__asyncDelegator:()=>I,__asyncGenerator:()=>A,__asyncValues:()=>w,__await:()=>k,__awaiter:()=>b,__classPrivateFieldGet:()=>N,__classPrivateFieldIn:()=>R,__classPrivateFieldSet:()=>O,__createBinding:()=>g,__decorate:()=>s,__disposeResources:()=>V,__esDecorate:()=>u,__exportStar:()=>h,__extends:()=>a,__generator:()=>f,__importDefault:()=>T,__importStar:()=>M,__makeTemplateObject:()=>_,__metadata:()=>m,__param:()=>l,__propKey:()=>d,__read:()=>S,__rest:()=>n,__rewriteRelativeImportExtension:()=>$,__runInitializers:()=>c,__setFunctionName:()=>p,__spread:()=>v,__spreadArray:()=>C,__spreadArrays:()=>P,__values:()=>y,default:()=>B});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},o.apply(this,arguments)};function n(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]])}return r}function s(e,t,r,i){var a,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(n=(o<3?a(n):o>3?a(t,r,n):a(t,r))||n);return o>3&&n&&Object.defineProperty(t,r,n),n}function l(e,t){return function(r,i){t(r,i,e)}}function u(e,t,r,i,a,o){function n(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=i.kind,u="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?i.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,i.name):{}),p=!1,m=r.length-1;m>=0;m--){var b={};for(var f in i)b[f]="access"===f?{}:i[f];for(var f in i.access)b.access[f]=i.access[f];b.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");o.push(n(e||null))};var g=(0,r[m])("accessor"===l?{get:d.get,set:d.set}:d[u],b);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=n(g.get))&&(d.get=s),(s=n(g.set))&&(d.set=s),(s=n(g.init))&&a.unshift(s)}else(s=n(g))&&("field"===l?a.unshift(s):d[u]=s)}c&&Object.defineProperty(c,i.name,d),p=!0}function c(e,t,r){for(var i=arguments.length>2,a=0;a<t.length;a++)r=i?t[a].call(e,r):t[a].call(e);return i?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function b(e,t,r,i){return new(r||(r=Promise))((function(a,o){function n(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,s)}l((i=i.apply(e,t||[])).next())}))}function f(e,t){var r,i,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},n=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return n.next=s(0),n.throw=s(1),n.return=s(2),"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;n&&(n=0,s[0]&&(o=0)),o;)try{if(r=1,i&&(a=2&s[0]?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var g=Object.create?function(e,t,r,i){void 0===i&&(i=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,a)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,a,o=r.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return n}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function P(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<r;t++)for(var o=arguments[t],n=0,s=o.length;n<s;n++,a++)i[a]=o[n];return i}function C(e,t,r){if(r||2===arguments.length)for(var i,a=0,o=t.length;a<o;a++)!i&&a in t||(i||(i=Array.prototype.slice.call(t,0,a)),i[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}function k(e){return this instanceof k?(this.v=e,this):new k(e)}function A(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,a=r.apply(e,t||[]),o=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),n("next"),n("throw"),n("return",(function(e){return function(t){return Promise.resolve(t).then(e,u)}})),i[Symbol.asyncIterator]=function(){return this},i;function n(e,t){a[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||s(e,t)}))},t&&(i[e]=t(i[e])))}function s(e,t){try{(r=a[e](t)).value instanceof k?Promise.resolve(r.value.v).then(l,u):c(o[0][2],r)}catch(e){c(o[0][3],e)}var r}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function I(e){var t,r;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,a){t[i]=e[i]?function(t){return(r=!r)?{value:k(e[i](t)),done:!1}:a?a(t):t}:a}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,a){!function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}(i,a,(t=e[r](t)).done,t.value)}))}}}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},E=function(e){return E=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},E(e)};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=E(e),i=0;i<r.length;i++)"default"!==r[i]&&g(t,e,r[i]);return x(t,e),t}function T(e){return e&&e.__esModule?e:{default:e}}function N(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function O(e,t,r,i,a){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?a.call(e,r):a?a.value=r:t.set(e,r),r}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function D(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i,a;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],r&&(a=i)}if("function"!=typeof i)throw new TypeError("Object not disposable.");a&&(i=function(){try{a.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t}var F="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function V(e){function t(t){e.error=e.hasError?new F(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,i=0;return function a(){for(;r=e.stack.pop();)try{if(!r.async&&1===i)return i=0,e.stack.push(r),Promise.resolve().then(a);if(r.dispose){var o=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(o).then(a,(function(e){return t(e),a()}))}else i|=1}catch(e){t(e)}if(1===i)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function $(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(e,r,i,a,o){return r?t?".jsx":".js":!i||a&&o?i+a+"."+o.toLowerCase()+"js":e})):e}const B={__extends:a,__assign:o,__rest:n,__decorate:s,__param:l,__esDecorate:u,__runInitializers:c,__propKey:d,__setFunctionName:p,__metadata:m,__awaiter:b,__generator:f,__createBinding:g,__exportStar:h,__values:y,__read:S,__spread:v,__spreadArrays:P,__spreadArray:C,__await:k,__asyncGenerator:A,__asyncDelegator:I,__asyncValues:w,__makeTemplateObject:_,__importStar:M,__importDefault:T,__classPrivateFieldGet:N,__classPrivateFieldSet:O,__classPrivateFieldIn:R,__addDisposableResource:D,__disposeResources:V,__rewriteRelativeImportExtension:$}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(2622),t=__webpack_require__(6278),r=__webpack_require__(9115);const i=[e.Enums.AudioChannelPair.Channel1_2,e.Enums.AudioChannelPair.Channel3_4,e.Enums.AudioChannelPair.Channel5_6,e.Enums.AudioChannelPair.Channel7_8,e.Enums.AudioChannelPair.Channel9_10,e.Enums.AudioChannelPair.Channel11_12,e.Enums.AudioChannelPair.Channel13_14,e.Enums.AudioChannelPair.Channel15_16],a={inputId:0,sourceName:"No Audio",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},o={inputId:1001,sourceName:"XLR",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},n={inputId:1201,sourceName:"RCA",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},s={inputId:1301,sourceName:"Microphone",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},l={inputId:1401,sourceName:"TRS",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},u={inputId:2301,sourceName:"Program",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},c={inputId:2201,sourceName:"Monitor",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},d={inputId:2501,sourceName:"Control",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},p={inputId:2601,sourceName:"Studio",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},m={inputId:2701,sourceName:"Headphones",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},b={outputId:3001,outputName:"MV",channelPairs:i},f={outputId:4001,outputName:"Program",channelPairs:i},g={outputId:5001,outputName:"Return",channelPairs:i};function h(t,r){const i=[];for(let a=1;a<=t;a++)i.push({inputId:a,sourceName:`Input ${a} 1/2`,channelPairs:r?[e.Enums.AudioChannelPair.Channel1_2,e.Enums.AudioChannelPair.Channel3_4,e.Enums.AudioChannelPair.Channel13_14,e.Enums.AudioChannelPair.Channel15_16]:[e.Enums.AudioChannelPair.Channel1_2,e.Enums.AudioChannelPair.Channel3_4]});return i}function y(t){const r=[];for(let i=1;i<=t;i++)r.push({inputId:1500+i,sourceName:`MADI ${i}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return r}function S(t){const r=[];for(let i=1;i<=t;i++)r.push({inputId:2e3+i,sourceName:`Media Player ${i}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return r}function v(t,r){const i=[{inputId:2101,sourceName:"Production Talkback",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]},{inputId:2102,sourceName:"Engineering Talkback",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]}];return t&&i.push({inputId:2103,sourceName:"External Talkback",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]}),r&&i.push({inputId:2104,sourceName:"Talkback",channelPairs:[e.Enums.AudioChannelPair.Channel1_2]}),i}function P(t){const r=[];for(let i=1;i<=t;i++)r.push({inputId:2800+i,sourceName:`Mix Minus ${i}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return r}function C(e,t){return(e<<16)+t}function k(t){const r=[];for(let i=1;i<=t;i++)r.push({outputId:1e3+i,outputName:`MADI ${i}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return r}function A(e){const t=[];for(let r=1;r<=e;r++)t.push({outputId:2e3+r,outputName:`Aux ${r}`,channelPairs:i});return t}const I=[{id:0,label:"Box 1"},{id:1,label:"Box 2"},{id:2,label:"Box 3"},{id:3,label:"Box 4"}],w=[{id:0,label:"None"},{id:1,label:"InOut"},{id:2,label:"In"},{id:3,label:"Out"}],_=[{id:"true",label:"On"},{id:"false",label:"Off"},{id:"toggle",label:"Toggle"}];var x,E;(E=x||(x={})).NoChange="no-change",E.Include="include",E.Omit="omit",E.Toggle="toggle";const M=[{id:x.NoChange,label:"No change"},{id:x.Include,label:"Include"},{id:x.Omit,label:"Omit"},{id:x.Toggle,label:"Toggle"}];var T,N;(N=T||(T={})).NoChange="no-change",N.On="on",N.Off="off",N.Toggle="toggle",N.Include="include",N.Omit="omit";const O=[{id:T.NoChange,label:"No change"},{id:T.On,label:"On"},{id:T.Off,label:"Off"},{id:T.Toggle,label:"Toggle"},{id:T.Include,label:"Include"},{id:T.Omit,label:"Omit"}],R=[{id:"true",label:"On Air"},{id:"false",label:"Off"},{id:"toggle",label:"Toggle"}],D=[{id:e.Enums.FlyKeyKeyFrame.A,label:"A"},{id:e.Enums.FlyKeyKeyFrame.B,label:"B"},{id:e.Enums.FlyKeyKeyFrame.Full,label:"Full"}],F=[{id:e.Enums.FlyKeyKeyFrame.A,label:"A"},{id:e.Enums.FlyKeyKeyFrame.B,label:"B"}],V=[{id:e.Enums.IsAtKeyFrame.A,label:"A"},{id:e.Enums.IsAtKeyFrame.B,label:"B"},{id:e.Enums.IsAtKeyFrame.RunToInfinite,label:"Full / Infinite"}],$=[{id:e.Enums.FlyKeyDirection.CentreOfKey,label:"Centre of key"},{id:e.Enums.FlyKeyDirection.TopLeft,label:"Top left"},{id:e.Enums.FlyKeyDirection.TopCentre,label:"Top centre"},{id:e.Enums.FlyKeyDirection.TopRight,label:"Top right"},{id:e.Enums.FlyKeyDirection.MiddleLeft,label:"Middle left"},{id:e.Enums.FlyKeyDirection.MiddleCentre,label:"Middle centre"},{id:e.Enums.FlyKeyDirection.MiddleRight,label:"Middle right"},{id:e.Enums.FlyKeyDirection.BottomLeft,label:"Bottom left"},{id:e.Enums.FlyKeyDirection.BottomCentre,label:"Bottom centre"},{id:e.Enums.FlyKeyDirection.BottomRight,label:"Bottom right"}],B=[{id:e.Enums.AudioMixOption.On,label:"On"},{id:e.Enums.AudioMixOption.Off,label:"Off"},{id:e.Enums.AudioMixOption.AudioFollowVideo,label:"AFV"}],L=[{id:e.Enums.FairlightAudioMixOption.On,label:"On"},{id:e.Enums.FairlightAudioMixOption.Off,label:"Off"},{id:e.Enums.FairlightAudioMixOption.AudioFollowVideo,label:"AFV"}];function j(t){const r=[{id:e.Enums.TransitionStyle.MIX,label:"Mix"},{id:e.Enums.TransitionStyle.DIP,label:"Dip"},{id:e.Enums.TransitionStyle.WIPE,label:"Wipe"},{id:e.Enums.TransitionStyle.DVE,label:"DVE"}];return t||r.push({id:e.Enums.TransitionStyle.STING,label:"Sting"}),r}function K(){return[{id:e.Enums.MixEffectKeyType.Luma,label:"Luma"},{id:e.Enums.MixEffectKeyType.Chroma,label:"Chroma"},{id:e.Enums.MixEffectKeyType.Pattern,label:"Pattern"},{id:e.Enums.MixEffectKeyType.DVE,label:"DVE"}]}function U(e){return oe(e.MEs,(e=>({id:e,label:`M/E ${e+1}`})))}function G(e){return e.outputs.map((e=>({id:e.id,label:e.name})))}function z(e){return oe(e.USKs,(e=>({id:e,label:`${e+1}`})))}function W(e){return oe(e.DSKs,(e=>({id:e,label:`${e+1}`})))}function H(e){return oe(e.MVs,(e=>({id:e,label:`MV ${e+1}`})))}function q(e,t){return oe(e.macros,(e=>{const r=t.macro.macroProperties[e];return{id:e+1,label:(r?.isUsed?`${r.name} (#${e+1})`:void 0)||`Macro ${e+1}`}}))}function J(e){return oe(e.media.players,(e=>({id:e,label:`Media Player ${e+1}`})))}function Y(t,r,i){const a=(e,t,i,a)=>{const o=r.inputs[e];return{id:e,shortName:o?.shortName||i,longName:o?.longName||a,portType:t}},o=[];for(const r of t.inputs){switch(i){case void 0:break;case"me":if(r.meAvailability===e.Enums.MeAvailability.None)continue;break;case"aux":if(0==(r.sourceAvailability&e.Enums.SourceAvailability.Auxiliary))continue;break;case"mv":if(0==(r.sourceAvailability&e.Enums.SourceAvailability.Multiviewer))continue;break;case"key":if(0==(r.sourceAvailability&e.Enums.SourceAvailability.KeySource))continue;break;case"ssrc-box":if(0==(r.sourceAvailability&e.Enums.SourceAvailability.SuperSourceBox))continue;break;case"ssrc-art":if(0==(r.sourceAvailability&e.Enums.SourceAvailability.SuperSourceArt))continue;break;case"tally":if(r.portType===e.Enums.InternalPortType.MEOutput&&r.id>8e3)break;continue}switch(r.portType){case e.Enums.InternalPortType.External:o.push(a(r.id,r.portType,`In ${r.id}`,`Input ${r.id}`));break;case e.Enums.InternalPortType.ColorBars:o.push(a(r.id,r.portType,"Bars","Bars"));break;case e.Enums.InternalPortType.ColorGenerator:{const e=r.id-2e3;o.push(a(r.id,r.portType,`Col${e}`,`Color ${e}`));break}case e.Enums.InternalPortType.MediaPlayerFill:{const e=(r.id-3e3)/10;o.push(a(r.id,r.portType,`MP ${e}`,`Media Player ${e}`));break}case e.Enums.InternalPortType.MediaPlayerKey:{const e=(r.id-3e3-1)/10;o.push(a(r.id,r.portType,`MP${e}K`,`Media Player ${e} Key`));break}case e.Enums.InternalPortType.SuperSource:{const e=r.id-6e3+1;o.push(a(r.id,r.portType,`SSc${e}`,`Super Source ${e}`));break}case e.Enums.InternalPortType.ExternalDirect:{const e=r.id-11e3;o.push(a(r.id,r.portType,`In${e}D`,`Input ${e} - Direct`));break}case e.Enums.InternalPortType.MEOutput:if(r.id<8e3){const e=r.id-7e3;o.push(a(r.id,r.portType,`Cln${e}`,`Clean Feed ${e}`))}else if(r.id%2==1){const e=(r.id-1e4-1)/10;o.push(a(r.id,r.portType,`M${e}PV`,`ME ${e} Preview`))}else{const e=(r.id-1e4)/10;o.push(a(r.id,r.portType,`M${e}PG`,`ME ${e} Program`))}break;case e.Enums.InternalPortType.Auxiliary:{const e=r.id-8e3;o.push(a(r.id,r.portType,`Aux${e}`,`Auxiliary ${e}`));break}case e.Enums.InternalPortType.Mask:break;case e.Enums.InternalPortType.MultiViewer:{const e=r.id-9e3;o.push(a(r.id,r.portType,`MV ${e}`,`MultiView ${e}`));break}case e.Enums.InternalPortType.Black:o.push(a(r.id,r.portType,"Blk","Black"));break;default:r.portType}}return o.sort(((e,t)=>e.id-t.id)),o}function X(e){return e.map((e=>({id:e.id,label:e.longName})))}const Q={[r.AudioChannelPair.Channel1_2]:"1/2",[r.AudioChannelPair.Channel3_4]:"3/4",[r.AudioChannelPair.Channel5_6]:"5/6",[r.AudioChannelPair.Channel7_8]:"7/8",[r.AudioChannelPair.Channel9_10]:"9/10",[r.AudioChannelPair.Channel11_12]:"11/12",[r.AudioChannelPair.Channel13_14]:"13/14",[r.AudioChannelPair.Channel15_16]:"15/16"};function Z(e,t){const r=[],i=t.fairlight?.audioRouting?.outputs??{};for(const t of e.fairlightAudio?.audioRouting?.outputs??[])for(const e of t.channelPairs){const a=C(t.outputId,e);r.push({id:a,label:ee(t.outputName,i[a]?.name,e,t.channelPairs)})}return r}function ee(t,r,i,a){let o=r??t;return 1===a.length&&i===e.Enums.AudioChannelPair.Channel1_2||(o=`${o} ${Q[i]}`),r&&t&&(o=`${r} (${t})`),o}const te=-60,re=1e3;function ie(e,t,r){for(;e.length<r;)e=t+e;return e}function ae(e){return e.filter((e=>void 0!==e))}function oe(e,t){const r=[];for(let i=0;i<e;i++)r.push(t(i));return r}function ne(e,t,r){return Math.min(Math.max(r,e),t)}function se(t,r){if(!r||!Array.isArray(r))return[];const i=[];r.includes("background")&&i.push(e.Enums.TransitionSelection.Background);for(let e=0;e<t;e++)r.includes(`key${e}`)&&i.push(1<<e+1);return i}var le,ue;function ce(e,t,r){const i=Number(e);if(isNaN(i))return!1;switch(t){case le.GreaterThan:return r>i;case le.GreaterThanEqual:return r>=i;case le.LessThan:return r<i;case le.LessThanEqual:return r<=i;case le.NotEqual:return r!=i;default:return r===i}}function de(t,r){if(r<1e4||r>11e3)return[];const i=(r-r%10-1e4)/10-1,a=(r-1e4)%10==0?"program":"preview";return t.video.mixEffects[i]?(0,e.listVisibleInputs)(a,t,i):[]}function pe(e){const t=Math.floor(e>>16),r=255&e,i=Q[r]?.replace("/","_");return`${t}-${i}`}(ue=le||(le={})).Equal="eq",ue.NotEqual="ne",ue.LessThan="lt",ue.LessThanEqual="lte",ue.GreaterThan="gt",ue.GreaterThanEqual="gte";const me=/(\d+)-([\d]+_[\d]+)/i;function be(t){if(!(t=t.trim()))return null;const r=me.exec(t);if(r){const e=Number(r[1]),t=r[2]?.replace("_","/"),i=Object.entries(Q).find((([,e])=>e===t));if(!i)return null;const a=Number(i[0]);return isNaN(e)||isNaN(a)?null:C(e,a)}const i=Number(t);return isNaN(i)?null:C(i,e.Enums.AudioChannelPair.Channel1_2)}class fe{meTransitionSelection=new Map}class ge{executeFunction;maxBatch;delayStep;inflight;constructor(e,t){this.executeFunction=e,this.maxBatch=t.maxBatch,this.delayStep=t.delayStep,this.inflight={completion:void 0,timer:void 0,batched:0,nextValue:void 0}}queueChange(e,t){this.inflight.batched++,!this.inflight.completion&&this.inflight.batched<=this.maxBatch&&this.updateBatchDelayedTimer(),this.inflight.nextValue=t(this.inflight.nextValue??e)}updateBatchDelayedTimer(){this.inflight.timer&&clearTimeout(this.inflight.timer),this.inflight.timer=setTimeout((()=>{this.inflight.timer=void 0,!this.inflight.completion&&void 0!==this.inflight.nextValue&&this.inflight.batched>0&&(this.inflight.timer=void 0,this.inflight.batched=0,this.inflight.completion=this.executeFunction(this.inflight.nextValue).then((()=>this.inflightCompleted())))}),this.delayStep)}inflightCompleted(){this.inflight.completion=void 0,this.inflight.timer&&(clearTimeout(this.inflight.timer),this.inflight.timer=void 0),0===this.inflight.batched||void 0===this.inflight.nextValue?(this.inflight.batched=0,this.inflight.nextValue=void 0):this.inflight.batched>=this.maxBatch?(this.inflight.batched=0,this.inflight.completion=this.executeFunction(this.inflight.nextValue).then((()=>this.inflightCompleted()))):this.updateBatchDelayedTimer()}}function he(e,t){const r=[];for(let i=0;i<t;i++)r.push({id:i,name:`${e} ${i+1}`});return r}const ye={id:0,label:"Auto Detect",outputs:he("Aux/Output",3),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:0,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:[{id:0,portType:e.Enums.InternalPortType.Black,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:1,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:2,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:4,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:5,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:6,portType:e.Enums.InternalPortType.External,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:1e3,portType:e.Enums.InternalPortType.ColorBars,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:2001,portType:e.Enums.InternalPortType.ColorGenerator,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:2002,portType:e.Enums.InternalPortType.ColorGenerator,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3010,portType:e.Enums.InternalPortType.MediaPlayerFill,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3011,portType:e.Enums.InternalPortType.MediaPlayerKey,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3020,portType:e.Enums.InternalPortType.MediaPlayerFill,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:3021,portType:e.Enums.InternalPortType.MediaPlayerKey,sourceAvailability:e.Enums.SourceAvailability.KeySource|e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.Me1},{id:7001,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:7002,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:10010,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:10011,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None}]};class Se{#l;#oe=[];#ne;#se;constructor(t){this.#l=t,this.#ne=ve(this.#l.meCount),this.#se=e.Enums.SourceAvailability.KeySource|this.#l.baseSourceAvailability}static begin(e){return new Se(e)}addInternalColorsAndBlack(t=!1){let r=this.#se;return t&&(r&=~e.Enums.SourceAvailability.Auxiliary),this.#oe.push({id:0,portType:e.Enums.InternalPortType.Black,sourceAvailability:r,meAvailability:this.#ne},{id:1e3,portType:e.Enums.InternalPortType.ColorBars,sourceAvailability:r,meAvailability:this.#ne},{id:2001,portType:e.Enums.InternalPortType.ColorGenerator,sourceAvailability:r&~e.Enums.SourceAvailability.KeySource,meAvailability:this.#ne},{id:2002,portType:e.Enums.InternalPortType.ColorGenerator,sourceAvailability:r&~e.Enums.SourceAvailability.KeySource,meAvailability:this.#ne}),this}addExternalInputs(t,r=0){return this.addInputs(1,t,e.Enums.InternalPortType.External,r|this.#se,this.#ne)}addMediaPlayers(t,r=!1){let i=this.#se;r&&(i&=~e.Enums.SourceAvailability.Auxiliary);for(let r=1;r<=t;r++)this.#oe.push({id:3e3+10*r,portType:e.Enums.InternalPortType.MediaPlayerFill,sourceAvailability:i,meAvailability:this.#ne},{id:3001+10*r,portType:e.Enums.InternalPortType.MediaPlayerKey,sourceAvailability:i,meAvailability:this.#ne});return this}addUpstreamKeyMasks(t){for(let r=1;r<=t;r++)this.#oe.push({id:4e3+10*r,portType:e.Enums.InternalPortType.Mask,sourceAvailability:e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.Auxiliary,meAvailability:e.Enums.MeAvailability.None});return this}addDownstreamKeyMasks(t){for(let r=1;r<=t;r++)this.#oe.push({id:5e3+10*r,portType:e.Enums.InternalPortType.Mask,sourceAvailability:e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.Auxiliary,meAvailability:e.Enums.MeAvailability.None});return this}addCleanFeeds(t){for(let r=1;r<=t;r++)this.#oe.push({id:7e3+r,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:this.#se&~e.Enums.SourceAvailability.KeySource&~e.Enums.SourceAvailability.SuperSourceArt&~e.Enums.SourceAvailability.SuperSourceBox,meAvailability:e.Enums.MeAvailability.None});return this}addDownstreamKeyMasksAndClean(e){return this.addDownstreamKeyMasks(e).addCleanFeeds(e)}addAuxiliaryOutputs(t){return this.addInputs(8001,t,e.Enums.InternalPortType.Auxiliary,this.#se&e.Enums.SourceAvailability.Multiviewer,e.Enums.MeAvailability.None)}addSuperSource(t=1){return this.addInputs(6e3,t,e.Enums.InternalPortType.SuperSource,this.#se&~e.Enums.SourceAvailability.SuperSourceArt,this.#ne)}addProgramPreview(){for(let t=1;t<=this.#l.meCount;t++){let r=this.#se&~e.Enums.SourceAvailability.SuperSourceArt&~e.Enums.SourceAvailability.KeySource;1===t&&(r&=~e.Enums.SourceAvailability.SuperSourceBox);const i=t>1?ve(t-1):0;this.#oe.push({id:1e4+10*t,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:r,meAvailability:i},{id:10001+10*t,portType:e.Enums.InternalPortType.MEOutput,sourceAvailability:r,meAvailability:i})}return this}addMultiviewers(t){return this.addInputs(9001,t,e.Enums.InternalPortType.MultiViewer,this.#se&(e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Auxiliary1|e.Enums.SourceAvailability.Auxiliary2),e.Enums.MeAvailability.None)}addMultiviewerStatusSources(){return this.#oe.push({id:9101,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:9102,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None},{id:9103,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Multiviewer,meAvailability:e.Enums.MeAvailability.None}),this}addDirectInputForAux(t){for(let r=1;r<=t;r++){let t=e.Enums.SourceAvailability.Auxiliary;1===r&&this.#l.baseSourceAvailability&e.Enums.SourceAvailability.Auxiliary1&&(t|=e.Enums.SourceAvailability.Auxiliary1),2===r&&this.#l.baseSourceAvailability&e.Enums.SourceAvailability.Auxiliary2&&(t|=e.Enums.SourceAvailability.Auxiliary2),this.#oe.push({id:11e3+r,portType:e.Enums.InternalPortType.ExternalDirect,sourceAvailability:t,meAvailability:e.Enums.MeAvailability.None})}return this}addInputs(e,t,r,i,a){for(let o=e;o<e+t;o++)this.#oe.push({id:o,portType:r,sourceAvailability:i,meAvailability:a});return this}generate(){return this.#oe.sort(((e,t)=>e.id-t.id))}}function ve(t){let r=e.Enums.MeAvailability.Me1;return t>1&&(r|=e.Enums.MeAvailability.Me2),t>2&&(r|=e.Enums.MeAvailability.Me3),t>3&&(r|=e.Enums.MeAvailability.Me4),r}const Pe={id:e.Enums.Model.TVS,label:"TV Studio",outputs:he("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:0,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(6).addMediaPlayers(2).addCleanFeeds(2).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:1101,portType:e.Enums.ExternalPortType.AESEBU}]}},Ce={id:e.Enums.Model.OneME,label:"1 ME Production",outputs:he("Aux",3),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:32,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addCleanFeeds(2).addAuxiliaryOutputs(3).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal}]}},ke={id:e.Enums.Model.TwoME,label:"2 ME Production",outputs:he("Aux",6),MEs:2,USKs:2,DSKs:2,MVs:2,multiviewerFullGrid:!1,DVEs:1,SSrc:1,macros:100,displayClock:0,media:{players:2,stills:32,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:2,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(16).addMediaPlayers(2).addCleanFeeds(2).addAuxiliaryOutputs(6).addSuperSource().addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.SDI},{id:2,portType:e.Enums.ExternalPortType.SDI},{id:3,portType:e.Enums.ExternalPortType.SDI},{id:4,portType:e.Enums.ExternalPortType.SDI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:9,portType:e.Enums.ExternalPortType.SDI},{id:10,portType:e.Enums.ExternalPortType.SDI},{id:11,portType:e.Enums.ExternalPortType.SDI},{id:12,portType:e.Enums.ExternalPortType.SDI},{id:13,portType:e.Enums.ExternalPortType.SDI},{id:14,portType:e.Enums.ExternalPortType.SDI},{id:15,portType:e.Enums.ExternalPortType.SDI},{id:16,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal}]}},Ae={id:e.Enums.Model.PS4K,label:"Production Studio 4K",outputs:he("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:0,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addUpstreamKeyMasks(1).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(1).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1201,portType:e.Enums.ExternalPortType.RCA}]}},Ie={id:e.Enums.Model.TwoME4K,label:"2 ME Production 4K",outputs:he("Aux",6),MEs:2,USKs:2,DSKs:2,MVs:2,multiviewerFullGrid:!1,DVEs:1,SSrc:1,macros:100,displayClock:0,media:{players:2,stills:32,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:2,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(20).addMediaPlayers(2).addUpstreamKeyMasks(4).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(6).addSuperSource().addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.SDI},{id:2,portType:e.Enums.ExternalPortType.SDI},{id:3,portType:e.Enums.ExternalPortType.SDI},{id:4,portType:e.Enums.ExternalPortType.SDI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:9,portType:e.Enums.ExternalPortType.SDI},{id:10,portType:e.Enums.ExternalPortType.SDI},{id:11,portType:e.Enums.ExternalPortType.SDI},{id:12,portType:e.Enums.ExternalPortType.SDI},{id:13,portType:e.Enums.ExternalPortType.SDI},{id:14,portType:e.Enums.ExternalPortType.SDI},{id:15,portType:e.Enums.ExternalPortType.SDI},{id:16,portType:e.Enums.ExternalPortType.SDI},{id:17,portType:e.Enums.ExternalPortType.SDI},{id:18,portType:e.Enums.ExternalPortType.SDI},{id:19,portType:e.Enums.ExternalPortType.SDI},{id:20,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1201,portType:e.Enums.ExternalPortType.RCA},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal}]}},we={id:e.Enums.Model.OneME4K,label:"1 ME Production 4K",outputs:he("Aux",3),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:32,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(10).addMediaPlayers(2).addUpstreamKeyMasks(4).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(3).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.SDI},{id:2,portType:e.Enums.ExternalPortType.SDI},{id:3,portType:e.Enums.ExternalPortType.SDI},{id:4,portType:e.Enums.ExternalPortType.SDI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:9,portType:e.Enums.ExternalPortType.SDI},{id:10,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1201,portType:e.Enums.ExternalPortType.RCA},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal}]}},_e={id:e.Enums.Model.TwoMEBS4K,label:"4 ME Broadcast 4K",outputs:he("Aux",6),MEs:4,USKs:4,DSKs:2,MVs:2,multiviewerFullGrid:!1,DVEs:1,SSrc:1,macros:100,displayClock:0,media:{players:4,stills:64,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:4,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(20).addMediaPlayers(4).addUpstreamKeyMasks(16).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(6).addSuperSource().addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.SDI},{id:2,portType:e.Enums.ExternalPortType.SDI},{id:3,portType:e.Enums.ExternalPortType.SDI},{id:4,portType:e.Enums.ExternalPortType.SDI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:9,portType:e.Enums.ExternalPortType.SDI},{id:10,portType:e.Enums.ExternalPortType.SDI},{id:11,portType:e.Enums.ExternalPortType.SDI},{id:12,portType:e.Enums.ExternalPortType.SDI},{id:13,portType:e.Enums.ExternalPortType.SDI},{id:14,portType:e.Enums.ExternalPortType.SDI},{id:15,portType:e.Enums.ExternalPortType.SDI},{id:16,portType:e.Enums.ExternalPortType.SDI},{id:17,portType:e.Enums.ExternalPortType.SDI},{id:18,portType:e.Enums.ExternalPortType.SDI},{id:19,portType:e.Enums.ExternalPortType.SDI},{id:20,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1201,portType:e.Enums.ExternalPortType.RCA},{id:2001,portType:e.Enums.ExternalPortType.Internal},{id:2002,portType:e.Enums.ExternalPortType.Internal},{id:2003,portType:e.Enums.ExternalPortType.Internal},{id:2004,portType:e.Enums.ExternalPortType.Internal}]}},xe={id:e.Enums.Model.TVSHD,label:"TV Studio HD",outputs:he("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addUpstreamKeyMasks(1).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(1).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1301,portType:e.Enums.ExternalPortType.TSJack}]}},Ee={id:e.Enums.Model.TVSProHD,label:"TV Studio Pro HD",outputs:he("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addUpstreamKeyMasks(1).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(1).addProgramPreview().generate(),classicAudio:{inputs:[{id:1,portType:e.Enums.ExternalPortType.HDMI},{id:2,portType:e.Enums.ExternalPortType.HDMI},{id:3,portType:e.Enums.ExternalPortType.HDMI},{id:4,portType:e.Enums.ExternalPortType.HDMI},{id:5,portType:e.Enums.ExternalPortType.SDI},{id:6,portType:e.Enums.ExternalPortType.SDI},{id:7,portType:e.Enums.ExternalPortType.SDI},{id:8,portType:e.Enums.ExternalPortType.SDI},{id:1001,portType:e.Enums.ExternalPortType.XLR},{id:1301,portType:e.Enums.ExternalPortType.TSJack}]}},Me={id:1001,portType:e.Enums.ExternalPortType.XLR},Te={id:1201,portType:e.Enums.ExternalPortType.RCA},Ne={id:1301,portType:e.Enums.ExternalPortType.TSJack},Oe={id:1401,portType:e.Enums.ExternalPortType.TRSJack},Re=[{id:1301,portType:e.Enums.ExternalPortType.TSJack,maxDelay:8},{id:1302,portType:e.Enums.ExternalPortType.TSJack,maxDelay:8}];function De(t){return Ve(1501,t,e.Enums.ExternalPortType.MADI)}function Fe(t){return Ve(2001,t,e.Enums.ExternalPortType.Internal)}function Ve(e,t,r){const i=[];for(let a=e;a<e+t;a++)i.push({id:a,portType:r});return i}const $e={id:e.Enums.Model.TVSPro4K,label:"TV Studio Pro 4K",outputs:he("Aux",1),MEs:1,USKs:1,DSKs:2,MVs:1,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:2,stills:20,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addUpstreamKeyMasks(1).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(1).addProgramPreview().generate(),fairlightAudio:{monitor:"combined",inputs:[...Ve(1,8,e.Enums.ExternalPortType.SDI),Me,Ne,...Fe(2)]}},Be={id:e.Enums.Model.Constellation,label:"Constellation 8K (HD/4K Mode)",outputs:he("Output",24),MEs:4,USKs:4,DSKs:4,MVs:4,multiviewerFullGrid:!0,DVEs:4,SSrc:2,macros:100,displayClock:0,media:{players:4,stills:64,clips:4,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:4,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(40).addMediaPlayers(4).addUpstreamKeyMasks(16).addDownstreamKeyMasksAndClean(4).addAuxiliaryOutputs(24).addSuperSource(2).addProgramPreview().generate(),fairlightAudio:{monitor:"split",audioRouting:{sources:[a,...h(40,!0),s,l,...y(32),...S(4),...v(!0,!1),u,...P(24)],outputs:[...k(32),...A(24)]},inputs:[...Ve(1,40,e.Enums.ExternalPortType.SDI),Ne,Oe,...De(32),...Fe(4)]}},Le={id:e.Enums.Model.Constellation8K,label:"Constellation 8K (8K Mode)",outputs:he("Output",6),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:1,SSrc:1,macros:100,displayClock:0,media:{players:1,stills:24,clips:2,captureStills:!1},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(10).addMediaPlayers(1).addUpstreamKeyMasks(4).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(6).addSuperSource().addProgramPreview().generate(),fairlightAudio:{monitor:"split",audioRouting:{sources:[a,...h(10,!0),s,l,...y(32),...S(1),...v(!0,!1),u,...P(6)],outputs:[...k(8),...A(6)]},inputs:[...Ve(1,10,e.Enums.ExternalPortType.SDI),Ne,Oe,...De(32),...Fe(4)]}},je={id:e.Enums.Model.Mini,label:"Mini",outputs:[...he("Output",1),{id:1,name:"Webcam (2)"}],MEs:1,USKs:1,DSKs:1,MVs:0,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:1,stills:20,clips:0,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary}).addInternalColorsAndBlack(!0).addExternalInputs(4).addMediaPlayers(1,!0).addAuxiliaryOutputs(1).addProgramPreview().addDirectInputForAux(1).generate(),fairlightAudio:{monitor:null,inputs:[...Ve(1,4,e.Enums.ExternalPortType.HDMI),...Re]}},Ke={...je,id:e.Enums.Model.MiniPro,label:"Mini Pro",MVs:1,streaming:!0,recording:!0,inputs:[...je.inputs,{id:9001,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Auxiliary,meAvailability:e.Enums.MeAvailability.None}]},Ue={...Ke,id:e.Enums.Model.MiniProISO,label:"Mini Pro ISO",recordISO:!0},Ge={id:e.Enums.Model.MiniExtreme,label:"Mini Extreme",inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt|e.Enums.SourceAvailability.Auxiliary1|e.Enums.SourceAvailability.Auxiliary2}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addSuperSource().addCleanFeeds(1).addAuxiliaryOutputs(2).addProgramPreview().addDirectInputForAux(2).addMultiviewers(1).addMultiviewerStatusSources().generate(),outputs:[...he("Output",2),{id:2,name:"Webcam (3)"}],MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:2,SSrc:1,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!0},streaming:!0,recording:!0,recordISO:!1,fairlightAudio:{monitor:"split",inputs:[...Ve(1,8,e.Enums.ExternalPortType.HDMI),...Re]}},ze={...Ge,id:e.Enums.Model.MiniExtremeISO,label:"Mini Extreme ISO",recordISO:!0},We={id:e.Enums.Model.ConstellationHD1ME,label:"1 M/E Constellation HD",outputs:he("Output",6),MEs:1,USKs:4,DSKs:1,MVs:1,multiviewerFullGrid:!0,DVEs:1,SSrc:0,macros:100,displayClock:1,media:{players:2,stills:20,clips:2,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(10).addMediaPlayers(2).addUpstreamKeyMasks(4).addDownstreamKeyMasks(2).addCleanFeeds(1).addAuxiliaryOutputs(6).addProgramPreview().generate(),fairlightAudio:{monitor:"split",inputs:[...Ve(1,10,e.Enums.ExternalPortType.SDI),Ne,Oe,...Fe(2)],audioRouting:{sources:[a,...h(10,!1),s,l,...S(2),...v(!1,!1),u,...P(6)],outputs:[...A(6)]}}},He={id:e.Enums.Model.ConstellationHD2ME,label:"2 M/E Constellation HD",outputs:he("Output",12),MEs:2,USKs:4,DSKs:2,MVs:2,multiviewerFullGrid:!0,DVEs:1,SSrc:1,macros:100,displayClock:1,media:{players:2,stills:40,clips:2,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:2,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(20).addMediaPlayers(2).addUpstreamKeyMasks(8).addDownstreamKeyMasksAndClean(2).addAuxiliaryOutputs(12).addSuperSource().addProgramPreview().generate(),fairlightAudio:{monitor:"split",inputs:[...Ve(1,20,e.Enums.ExternalPortType.SDI),Ne,Oe,...Fe(2)],audioRouting:{sources:[a,...h(20,!1),s,l,...S(2),...v(!1,!1),u,...P(12)],outputs:[...A(12)]}}},qe={id:e.Enums.Model.ConstellationHD4ME,label:"4 M/E Constellation HD",outputs:he("Output",24),MEs:4,USKs:4,DSKs:4,MVs:4,multiviewerFullGrid:!0,DVEs:4,SSrc:2,macros:100,displayClock:1,media:{players:4,stills:60,clips:4,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:4,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(40).addMediaPlayers(4).addUpstreamKeyMasks(16).addDownstreamKeyMasksAndClean(4).addAuxiliaryOutputs(24).addSuperSource(2).addProgramPreview().generate(),fairlightAudio:{monitor:"split",inputs:[...Ve(1,40,e.Enums.ExternalPortType.SDI),Ne,Oe,...De(32),...Fe(4)],audioRouting:{sources:[a,...h(40,!1),s,l,...y(32),...S(4),...v(!1,!1),u,...P(24)],outputs:[...k(32),...A(24)]}}},Je={id:e.Enums.Model.SDI,label:"SDI",outputs:[...he("Output",2),{id:2,name:"Webcam (3)"}],MEs:1,USKs:1,DSKs:1,MVs:0,multiviewerFullGrid:!1,DVEs:1,SSrc:0,macros:100,displayClock:0,media:{players:1,stills:20,clips:0,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary}).addInternalColorsAndBlack(!0).addExternalInputs(4).addMediaPlayers(1,!0).addAuxiliaryOutputs(2).addProgramPreview().addDirectInputForAux(1).generate(),fairlightAudio:{monitor:null,inputs:[...Ve(1,4,e.Enums.ExternalPortType.SDI),...Re]}},Ye={...Je,id:e.Enums.Model.SDIProISO,label:"SDI Pro ISO",MVs:1,streaming:!0,recording:!0,recordISO:!0,inputs:[...Je.inputs,{id:9001,portType:e.Enums.InternalPortType.MultiViewer,sourceAvailability:e.Enums.SourceAvailability.Auxiliary,meAvailability:e.Enums.MeAvailability.None}]},Xe={id:e.Enums.Model.SDIExtremeISO,label:"SDI Extreme ISO",inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt|e.Enums.SourceAvailability.Auxiliary1|e.Enums.SourceAvailability.Auxiliary2}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addSuperSource().addCleanFeeds(1).addAuxiliaryOutputs(4).addProgramPreview().addDirectInputForAux(2).addMultiviewers(1).addMultiviewerStatusSources().generate(),outputs:[...he("Output",4),{id:4,name:"Webcam (5)"}],MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:2,SSrc:1,macros:100,displayClock:0,media:{players:2,stills:20,clips:0,captureStills:!0},streaming:!0,recording:!0,recordISO:!0,fairlightAudio:{monitor:"split",inputs:[...Ve(1,8,e.Enums.ExternalPortType.SDI),...Re]}},Qe={id:e.Enums.Model.TelevisionStudioHD8,label:"Television Studio HD8",inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addCleanFeeds(1).addAuxiliaryOutputs(2).addProgramPreview().addSuperSource().addMultiviewers(1).addMultiviewerStatusSources().generate(),outputs:he("Aux",2),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:1,SSrc:1,macros:100,displayClock:1,media:{players:2,stills:20,clips:2,captureStills:!0},streaming:!0,recording:!0,recordISO:!1,fairlightAudio:{monitor:"split",audioRouting:{sources:[a,...h(8,!0),o,n,s,...y(16),...S(2),...v(!0,!0),c,u,d,p,m,...function(t){const r=[];for(let t=1;t<=2;t++)r.push({inputId:3e3+t,sourceName:`Aux ${t}`,channelPairs:[e.Enums.AudioChannelPair.Channel1_2]});return r}()],outputs:[...k(32),...A(2),f,g]},inputs:[...Ve(1,8,e.Enums.ExternalPortType.SDI),Me,Te,Ne,...De(16),...Fe(2)]}},Ze={...Qe,id:e.Enums.Model.TelevisionStudioHD8ISO,label:"Television Studio HD8 ISO",recordISO:!0},et={...We,id:28,label:"1 M/E Constellation 4K"},tt={...He,id:29,label:"2 M/E Constellation 4K"},rt={...qe,id:e.Enums.Model.Constellation4K4ME,label:"4 M/E Constellation 4K",media:{players:4,stills:64,clips:4,captureStills:!0}},it={id:e.Enums.Model.TelevisionStudio4K8,label:"Television Studio 4K8",inputs:Se.begin({meCount:1,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(8).addMediaPlayers(2).addCleanFeeds(2).addAuxiliaryOutputs(10).addProgramPreview().addSuperSource().addMultiviewers(1).addMultiviewerStatusSources().generate(),outputs:he("Output",10),MEs:1,USKs:4,DSKs:2,MVs:1,multiviewerFullGrid:!0,DVEs:1,SSrc:1,macros:100,displayClock:1,media:{players:2,stills:20,clips:2,captureStills:!0},streaming:!0,recording:!0,recordISO:!1,fairlightAudio:{monitor:"split",audioRouting:{sources:[a,...h(8,!0),o,n,s,...y(16),...S(2),...v(!0,!0),c,u,d,p,m,...P(8)],outputs:[...k(32),...A(10),b,f]},inputs:[...Ve(1,8,e.Enums.ExternalPortType.SDI),Me,Te,Ne,...De(16),...Fe(2)]}},at={id:31,label:"4 M/E Constellation 4K Plus",outputs:he("Output",48),MEs:4,USKs:4,DSKs:4,MVs:4,multiviewerFullGrid:!0,DVEs:4,SSrc:2,macros:100,displayClock:1,media:{players:4,stills:64,clips:4,captureStills:!0},streaming:!1,recording:!1,recordISO:!1,inputs:Se.begin({meCount:4,baseSourceAvailability:e.Enums.SourceAvailability.Auxiliary|e.Enums.SourceAvailability.Multiviewer|e.Enums.SourceAvailability.SuperSourceBox|e.Enums.SourceAvailability.SuperSourceArt}).addInternalColorsAndBlack().addExternalInputs(80).addMediaPlayers(4).addUpstreamKeyMasks(16).addDownstreamKeyMasksAndClean(4).addAuxiliaryOutputs(24).addSuperSource(2).addProgramPreview().generate(),fairlightAudio:{monitor:"split",inputs:[...Ve(1,80,e.Enums.ExternalPortType.SDI),Ne,Oe,...De(64),...Fe(4)],audioRouting:{sources:[a,...h(80,!1),s,l,...y(64),...S(4),...v(!1,!1),u,...P(48)],outputs:[...k(64),...A(48)]}}},ot=[ye,Pe,Ce,ke,Ae,we,Ie,_e,xe,Ee,$e,Be,Le,je,Ke,Ue,Ge,ze,We,He,qe,Je,Ye,Xe,Qe,Ze,et,tt,rt,it,at],nt=ot.map((({id:e,label:t})=>({id:e,label:t})));function st(e){return ot.find((t=>t.id===e))}function lt(){return ye}function ut(e){const t=new Map,r=new Map;for(const r of Object.values(e.sources)){const e=t.get(r.audioSourceId);e?e.channelPairs.push(r.audioChannelPair):t.set(r.audioSourceId,{sourceName:"",inputId:r.audioSourceId,channelPairs:[r.audioChannelPair]})}for(const t of Object.values(e.outputs)){const e=r.get(t.audioOutputId);e?e.channelPairs.push(t.audioChannelPair):r.set(t.audioOutputId,{outputName:"",outputId:t.audioOutputId,channelPairs:[t.audioChannelPair]})}return{sources:Array.from(t.values()),outputs:Array.from(r.values())}}var ct,dt;nt.sort(((e,t)=>0===e.id?-1:0===t.id?1:t.id-e.id)),(dt=ct||(ct={}))[dt.Short=0]="Short",dt[dt.Long=1]="Long";class pt{static None(e){return e}}class mt{static In(e){return e*e}static Out(e){return e*(2-e)}static InOut(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}class bt{static In(e){return e*e*e}static Out(e){return--e*e*e+1}static InOut(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}class ft{static In(e){return e*e*e*e}static Out(e){return 1- --e*e*e*e}static InOut(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}class gt{static In(e){return e*e*e*e*e}static Out(e){return--e*e*e*e*e+1}static InOut(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}class ht{static In(e){return 1-Math.cos(e*Math.PI/2)}static Out(e){return Math.sin(e*Math.PI/2)}static InOut(e){return.5*(1-Math.cos(Math.PI*e))}}class yt{static In(e){return 0===e?0:Math.pow(1024,e-1)}static Out(e){return 1===e?1:1-Math.pow(2,-10*e)}static InOut(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}class St{static In(e){return 1-Math.sqrt(1-e*e)}static Out(e){return Math.sqrt(1- --e*e)}static InOut(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}class vt{static In(e){let t,r=.1;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=.4*Math.asin(1/r)/(2*Math.PI),-r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))}static Out(e){let t,r=.1;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=.4*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)}static InOut(e){let t,r=.1;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=.4*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}}class Pt{static In(e){const t=1.70158;return e*e*((t+1)*e-t)}static Out(e){const t=1.70158;return--e*e*((t+1)*e+t)+1}static InOut(e){const t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}class Ct{static In(e){return 1-Ct.Out(1-e)}static Out(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}static InOut(e){return e<.5?.5*Ct.In(2*e):.5*Ct.Out(2*e-1)+.5}}class kt{transitions;fps;tickInterval;constructor(e){this.transitions=new Map,this.fps=e.fadeFps??10}stopAll(){this.transitions.clear(),this.tickInterval&&(clearInterval(this.tickInterval),delete this.tickInterval)}runTick(){const e=[];for(const[t,r]of this.transitions.entries()){const i=r.steps.shift();void 0!==i&&r.sendFcn(i).catch((e=>{})),0===r.steps.length&&e.push(t)}for(const t of e)this.transitions.delete(t);0===this.transitions.size&&this.stopAll()}async runForFadeOptions(e,t,r,i,a){const o=a.getPlainNumber("fadeDuration"),n=a.getPlainString("fadeAlgorithm"),s=a.getPlainString("fadeCurve");return this.run(e,t,r,i,o,n,s)}async run(e,t,r,i,a,o,n){const s=1e3/this.fps,l=Math.ceil(a/s);if(l<=1||"number"!=typeof r)this.transitions.delete(e),await t(i);else{const a=i-r,s=[],u=function(e,t){return"linear"==e||null==e||null==t?pt.None:"quadratic"==e&&"ease-in"==t?mt.In:"quadratic"==e&&"ease-out"==t?mt.Out:"quadratic"==e&&"ease-in-out"==t?mt.InOut:"cubic"==e&&"ease-in"==t?bt.In:"cubic"==e&&"ease-out"==t?bt.Out:"cubic"==e&&"ease-in-out"==t?bt.InOut:"quartic"==e&&"ease-in"==t?ft.In:"quartic"==e&&"ease-out"==t?ft.Out:"quartic"==e&&"ease-in-out"==t?ft.InOut:"quintic"==e&&"ease-in"==t?gt.In:"quintic"==e&&"ease-out"==t?gt.Out:"quintic"==e&&"ease-in-out"==t?gt.InOut:"sinusoidal"==e&&"ease-in"==t?ht.In:"sinusoidal"==e&&"ease-out"==t?ht.Out:"sinusoidal"==e&&"ease-in-out"==t?ht.InOut:"exponential"==e&&"ease-in"==t?yt.In:"exponential"==e&&"ease-out"==t?yt.Out:"exponential"==e&&"ease-in-out"==t?yt.InOut:"circular"==e&&"ease-in"==t?St.In:"circular"==e&&"ease-out"==t?St.Out:"circular"==e&&"ease-in-out"==t?St.InOut:"elastic"==e&&"ease-in"==t?vt.In:"elastic"==e&&"ease-out"==t?vt.Out:"elastic"==e&&"ease-in-out"==t?vt.InOut:"back"==e&&"ease-in"==t?Pt.In:"back"==e&&"ease-out"==t?Pt.Out:"back"==e&&"ease-in-out"==t?Pt.InOut:"bounce"==e&&"ease-in"==t?Ct.In:"bounce"==e&&"ease-out"==t?Ct.Out:"bounce"==e&&"ease-in-out"==t?Ct.InOut:pt.None}(o,n);for(let e=1;e<=l;e++){const t=u(e/l);s.push(r+a*t)}this.transitions.set(e,{steps:s,sendFcn:t}),this.tickInterval||(this.tickInterval=setInterval((()=>this.runTick()),1e3/this.fps))}}}var At=__webpack_require__(994);function It(e,t,r){return{id:`input${r||""}`,label:"Input"+(r?` Option ${r}`:""),type:"dropdown",default:1,choices:X(Y(e,t,"me"))}}function wt(t){return{type:"dropdown",id:"style",label:"Transition Style",default:e.Enums.TransitionStyle.MIX,choices:j(t)}}function _t(){return{type:"dropdown",id:"style",label:"Key Type",default:e.Enums.MixEffectKeyType.Luma,choices:K()}}function xt(e){return{type:"number",id:"rate",label:e,min:1,max:250,range:!0,default:25}}function Et(e){const t={background:{type:"dropdown",id:"background",label:"Background",choices:M,default:x.NoChange}};for(let r=0;r<e.USKs;r++)t[`key${r}`]={label:`Key ${r+1}`,type:"dropdown",id:`key${r}`,choices:O,default:T.NoChange};return t}function Mt(e){const t=[{id:"background",label:"Background"}];for(let r=0;r<e.USKs;r++)t.push({id:`key${r}`,label:`Key ${r+1}`});return{type:"multidropdown",id:"selection",label:"Selection",default:["background"],minSelection:1,choices:t}}function Tt(e){const t=[{id:0,label:"Background"}];for(let r=0;r<e.USKs;r++)t.push({id:r+1,label:`Key ${r+1}`});return{label:"Component",type:"dropdown",id:"component",choices:t,default:0}}function Nt(e,t){return{id:`mixeffect${t||""}`,label:"M/E"+(t?` Option ${t}`:""),type:"dropdown",default:t>0?t-1:0,choices:U(e)}}function Ot(e){return{type:"dropdown",label:"Key",id:"key",default:0,choices:W(e)}}function Rt(){const e={maskEnabled:{type:"checkbox",label:"Enabled",id:"maskEnabled",default:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskEnabled")},maskTop:{type:"number",label:"Top",id:"maskTop",default:9,min:-9,step:.01,max:9,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskTop")},maskBottom:{type:"number",label:"Bottom",id:"maskBottom",default:-9,min:-9,step:.01,max:9,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskBottom")},maskLeft:{type:"number",label:"Left",id:"maskLeft",default:-16,min:-16,step:.01,max:16,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskLeft")},maskRight:{type:"number",label:"Right",id:"maskRight",default:16,min:-16,step:.01,max:16,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskRight")}};return{properties:Zt(e),...e}}function Dt(){const e={preMultiply:{type:"checkbox",label:"Enabled",id:"preMultiply",default:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("preMultiply")},clip:{type:"number",label:"Clip",id:"clip",range:!0,default:100,min:0,step:.1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("clip")},gain:{type:"number",label:"Gain",id:"gain",range:!0,default:0,min:0,step:.1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("gain")},invert:{type:"checkbox",label:"Invert key",id:"invert",default:!1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("invert")}};return{properties:Zt(e),...e}}function Ft(e){return{type:"dropdown",label:"Key",id:"key",default:0,choices:z(e)}}function Vt(){const e={maskEnabled:{type:"checkbox",label:"Enabled",id:"maskEnabled",default:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskEnabled")},maskTop:{type:"number",label:"Top",id:"maskTop",default:9,min:-9,step:.01,max:9,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskTop")},maskBottom:{type:"number",label:"Bottom",id:"maskBottom",default:-9,min:-9,step:.01,max:9,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskBottom")},maskLeft:{type:"number",label:"Left",id:"maskLeft",default:-16,min:-16,step:.01,max:16,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskLeft")},maskRight:{type:"number",label:"Right",id:"maskRight",default:16,min:-16,step:.01,max:16,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskRight")}};return{properties:Zt(e),...e}}function $t(){const e={positionX:{type:"number",label:"Position: X",id:"positionX",default:0,min:-1e3,range:!0,step:.01,max:1e3,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionX")},positionY:{type:"number",label:"Position: Y",id:"positionY",default:0,range:!0,min:-1e3,step:.01,max:1e3,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionY")},sizeX:{type:"number",label:"Size: X",id:"sizeX",default:.5,range:!0,min:0,step:.01,max:99.99,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeX")},sizeY:{type:"number",label:"Size: Y",id:"sizeY",default:.5,range:!0,min:0,step:.01,max:99.99,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeY")},rotation:{type:"number",label:"Rotation",id:"rotation",range:!0,default:0,min:0,max:360,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("rotation")},maskEnabled:{type:"checkbox",label:"Mask: Enabled",id:"maskEnabled",default:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskEnabled")},maskTop:{type:"number",label:"Mask: Top",id:"maskTop",default:0,range:!0,min:0,step:.01,max:38,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskTop")},maskBottom:{type:"number",label:"Mask: Bottom",id:"maskBottom",default:0,range:!0,min:0,step:.01,max:38,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskBottom")},maskLeft:{type:"number",label:"Mask: Left",id:"maskLeft",default:0,range:!0,min:0,step:.01,max:52,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskLeft")},maskRight:{type:"number",label:"Mask: Right",id:"maskRight",default:0,range:!0,min:0,step:.01,max:52,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskRight")},shadowEnabled:{type:"checkbox",label:"Shadow: Enabled",id:"shadowEnabled",default:!1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("shadowEnabled")},lightSourceDirection:{type:"number",label:"Shadow: Angle",id:"lightSourceDirection",default:36,min:0,range:!0,step:1,max:359,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("lightSourceDirection")},lightSourceAltitude:{type:"number",label:"Shadow: Altitude",id:"lightSourceAltitude",default:25,min:10,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("lightSourceAltitude")},borderEnabled:{type:"checkbox",label:"Border: Enabled",id:"borderEnabled",default:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderEnabled")},borderHue:{type:"number",label:"Border: Hue",id:"borderHue",default:0,min:0,range:!0,step:.1,max:360,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderHue")},borderSaturation:{type:"number",label:"Border: Sat",id:"borderSaturation",default:0,min:0,range:!0,step:.1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderSaturation")},borderLuma:{type:"number",label:"Border: Lum",id:"borderLuma",default:0,min:0,range:!0,step:.1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderLuma")},borderBevel:{type:"dropdown",label:"Border: Style",id:"borderBevel",default:0,choices:w},borderOuterWidth:{type:"number",label:"Border: Outer Width",id:"borderOuterWidth",default:0,min:0,range:!0,step:.01,max:16,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOuterWidth")},borderInnerWidth:{type:"number",label:"Border: Inner Width",id:"borderInnerWidth",default:.2,min:0,range:!0,step:.01,max:16,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderInnerWidth")},borderOuterSoftness:{type:"number",label:"Border: Outer Soften",id:"borderOuterSoftness",default:0,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOuterSoftness")},borderInnerSoftness:{type:"number",label:"Border: Inner Soften",id:"borderInnerSoftness",default:0,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderInnerSoftness")},borderOpacity:{type:"number",label:"Border: Opacity",id:"borderOpacity",default:100,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOpacity")},borderBevelPosition:{type:"number",label:"Border: Bevel Position",id:"borderBevelPosition",default:0,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderBevelPosition")},borderBevelSoftness:{type:"number",label:"Border: Bevel Soften",id:"borderBevelSoftness",default:0,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderBevelSoftness")},rate:xt("Rate")};return{properties:Zt(e),...e}}function Bt(){const e={positionX:{type:"textinput",label:"Position: X",id:"positionX",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionX")},positionY:{type:"textinput",label:"Position: Y",id:"positionY",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionY")},sizeX:{type:"textinput",label:"Size: X",id:"sizeX",default:"0.5",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeX")},sizeY:{type:"textinput",label:"Size: Y",id:"sizeY",default:"0.5",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeY")},rotation:{type:"textinput",label:"Rotation",id:"rotation",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("rotation")},maskEnabled:{type:"textinput",label:"Mask: Enabled",id:"maskEnabled",default:"true",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskEnabled")},maskTop:{type:"textinput",label:"Mask: Top",id:"maskTop",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskTop")},maskBottom:{type:"textinput",label:"Mask: Bottom",id:"maskBottom",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskBottom")},maskLeft:{type:"textinput",label:"Mask: Left",id:"maskLeft",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskLeft")},maskRight:{type:"textinput",label:"Mask: Right",id:"maskRight",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskRight")},shadowEnabled:{type:"textinput",label:"Shadow: Enabled",id:"shadowEnabled",default:"false",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("shadowEnabled")},lightSourceDirection:{type:"textinput",label:"Shadow: Angle",id:"lightSourceDirection",default:"36",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("lightSourceDirection")},lightSourceAltitude:{type:"textinput",label:"Shadow: Altitude",id:"lightSourceAltitude",default:"25",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("lightSourceAltitude")},borderEnabled:{type:"textinput",label:"Border: Enabled",id:"borderEnabled",default:"true",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderEnabled")},borderHue:{type:"textinput",label:"Border: Hue",id:"borderHue",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderHue")},borderSaturation:{type:"textinput",label:"Border: Sat",id:"borderSaturation",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderSaturation")},borderLuma:{type:"textinput",label:"Border: Lum",id:"borderLuma",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderLuma")},borderBevel:{type:"textinput",label:"Border: Style",id:"borderBevel",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderStyle")},borderOuterWidth:{type:"textinput",label:"Border: Outer Width",id:"borderOuterWidth",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOuterWidth")},borderInnerWidth:{type:"textinput",label:"Border: Inner Width",id:"borderInnerWidth",default:"0.2",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderInnerWidth")},borderOuterSoftness:{type:"textinput",label:"Border: Outer Soften",id:"borderOuterSoftness",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOuterSoftness")},borderInnerSoftness:{type:"textinput",label:"Border: Inner Soften",id:"borderInnerSoftness",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderInnerSoftness")},borderOpacity:{type:"textinput",label:"Border: Opacity",id:"borderOpacity",default:"100",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOpacity")},borderBevelPosition:{type:"textinput",label:"Border: Bevel Position",id:"borderBevelPosition",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderBevelPosition")},borderBevelSoftness:{type:"textinput",label:"Border: Bevel Soften",id:"borderBevelSoftness",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderBevelSoftness")},rate:{type:"textinput",id:"rate",label:"Rate",default:"25",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("rate")}};return{properties:Zt(e),...e}}function Lt(){const e={positionX:{type:"number",label:"Position: X",id:"positionX",default:0,min:-1e3,range:!0,step:.01,max:1e3,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionX")},positionY:{type:"number",label:"Position: Y",id:"positionY",default:0,range:!0,min:-1e3,step:.01,max:1e3,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionY")},sizeX:{type:"number",label:"Size: X",id:"sizeX",default:.5,range:!0,min:0,step:.01,max:99.99,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeX")},sizeY:{type:"number",label:"Size: Y",id:"sizeY",default:.5,range:!0,min:0,step:.01,max:99.99,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeY")},rotation:{type:"number",label:"Rotation",id:"rotation",range:!0,default:0,min:0,max:360,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("rotation")},maskTop:{type:"number",label:"Mask: Top",id:"maskTop",default:0,range:!0,min:0,step:.01,max:38,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskTop")},maskBottom:{type:"number",label:"Mask: Bottom",id:"maskBottom",default:0,range:!0,min:0,step:.01,max:38,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskBottom")},maskLeft:{type:"number",label:"Mask: Left",id:"maskLeft",default:0,range:!0,min:0,step:.01,max:52,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskLeft")},maskRight:{type:"number",label:"Mask: Right",id:"maskRight",default:0,range:!0,min:0,step:.01,max:52,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("maskRight")},lightSourceDirection:{type:"number",label:"Shadow: Angle",id:"lightSourceDirection",default:36,min:0,range:!0,step:1,max:359,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("lightSourceDirection")},lightSourceAltitude:{type:"number",label:"Shadow: Altitude",id:"lightSourceAltitude",default:25,min:10,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("lightSourceAltitude")},borderHue:{type:"number",label:"Border: Hue",id:"borderHue",default:0,min:0,range:!0,step:.1,max:360,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderHue")},borderSaturation:{type:"number",label:"Border: Sat",id:"borderSaturation",default:0,min:0,range:!0,step:.1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderSaturation")},borderLuma:{type:"number",label:"Border: Lum",id:"borderLuma",default:0,min:0,range:!0,step:.1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderLuma")},borderOuterWidth:{type:"number",label:"Border: Outer Width",id:"borderOuterWidth",default:0,min:0,range:!0,step:.01,max:16,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOuterWidth")},borderInnerWidth:{type:"number",label:"Border: Inner Width",id:"borderInnerWidth",default:.2,min:0,range:!0,step:.01,max:16,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderInnerWidth")},borderOuterSoftness:{type:"number",label:"Border: Outer Soften",id:"borderOuterSoftness",default:0,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOuterSoftness")},borderInnerSoftness:{type:"number",label:"Border: Inner Soften",id:"borderInnerSoftness",default:0,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderInnerSoftness")},borderOpacity:{type:"number",label:"Border: Opacity",id:"borderOpacity",default:100,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderOpacity")},borderBevelPosition:{type:"number",label:"Border: Bevel Position",id:"borderBevelPosition",default:0,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderBevelPosition")},borderBevelSoftness:{type:"number",label:"Border: Bevel Soften",id:"borderBevelSoftness",default:0,min:0,range:!0,step:1,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("borderBevelSoftness")}};return{properties:Zt(e),...e}}function jt(e){return{type:"dropdown",id:"aux",label:"Aux/Output",default:0,choices:G(e)}}function Kt(e){return{type:"dropdown",id:"multiViewerId",label:"MV",default:0,choices:H(e)}}function Ut(e,t){return{type:"dropdown",label:"Fill Source",id:"fill",default:1,choices:X(Y(e,t,"me"))}}function Gt(e,t){return{type:"dropdown",label:"Key Source",id:"cut",default:0,choices:X(Y(e,t,"key"))}}function zt(e,t){return{type:"dropdown",label:"Input",id:"input",default:1,choices:X(Y(e,t,"aux"))}}function Wt(){return{type:"dropdown",id:"boxIndex",label:"Box #",default:0,choices:I}}function Ht(e){const t=function(e){return oe(e.SSrc,(e=>({id:e,label:`Super Source ${e+1}`})))}(e);return t.length>1?{type:"dropdown",id:"ssrcId",label:"Super Source",default:0,choices:t}:void 0}function qt(t){const r=ae([t?{id:"unchanged",label:"Unchanged"}:void 0,{id:e.Enums.SuperSourceArtOption.Foreground,label:"Foreground"},{id:e.Enums.SuperSourceArtOption.Background,label:"Background"},t?{id:"toggle",label:"Toggle"}:void 0]);return{type:"dropdown",id:"artOption",label:"Place in",default:r[0].id,choices:r}}function Jt(e,t){const r={size:{type:"number",id:"size",label:"Size",min:0,max:1,range:!0,default:.5,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("size")},onair:{id:"onair",type:"dropdown",label:"On Air",default:"true",choices:R,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("onair")},source:{type:"dropdown",id:"source",label:"Source",default:0,choices:X(Y(e,t,"ssrc-box")),isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("source")},x:{type:"number",id:"x",label:"X",min:-48,max:48,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("x")},y:{type:"number",id:"y",label:"Y",min:-27,max:27,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("y")},cropEnable:{type:"checkbox",id:"cropEnable",label:"Crop Enable",default:!1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropEnable")},cropTop:{type:"number",id:"cropTop",label:"Crop Top",min:0,max:18,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropTop")},cropBottom:{type:"number",id:"cropBottom",label:"Crop Bottom",min:0,max:18,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropBottom")},cropLeft:{type:"number",id:"cropLeft",label:"Crop Left",min:0,max:32,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropLeft")},cropRight:{type:"number",id:"cropRight",label:"Crop Right",min:0,max:32,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropRight")}};return{properties:Zt(r),...r}}function Yt(){const e={size:{type:"number",id:"size",label:"Size",min:-1,max:1,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("size")},x:{type:"number",id:"x",label:"X",min:-48,max:48,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("x")},y:{type:"number",id:"y",label:"Y",min:-27,max:27,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("y")},cropTop:{type:"number",id:"cropTop",label:"Crop Top",min:-18,max:18,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropTop")},cropBottom:{type:"number",id:"cropBottom",label:"Crop Bottom",min:-18,max:18,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropBottom")},cropLeft:{type:"number",id:"cropLeft",label:"Crop Left",min:-32,max:32,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropLeft")},cropRight:{type:"number",id:"cropRight",label:"Crop Right",min:-32,max:32,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("cropRight")}};return{properties:Zt(e),...e}}function Xt(e,t,r){const i=X(Y(e,t,"ssrc-art")),a={fill:{type:"dropdown",id:"fill",label:"Fill Source",default:0,choices:i,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("fill")},key:{type:"dropdown",id:"key",label:"Key Source",default:0,choices:i,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("key")},artOption:{...qt(r),isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("artOption")},artPreMultiplied:{type:"checkbox",id:"artPreMultiplied",label:"Pre-multiplied",default:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("artPreMultiplied")},artClip:{type:"number",id:"artClip",label:"Clip",min:0,max:100,range:!0,default:50,step:1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("artClip")},artGain:{type:"number",id:"artGain",label:"Gain",min:0,max:100,range:!0,default:50,step:1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("artGain")},artInvertKey:{type:"checkbox",id:"artInvertKey",label:"Invert Key",default:!1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("artInvertKey")}};return{properties:Zt(a),...a}}function Qt(){const e={fill:{type:"textinput",id:"fill",label:"Fill Source",default:"1",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("fill")},key:{type:"textinput",id:"key",label:"Key Source",default:"1",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("key")}};return{properties:Zt(e),...e}}function Zt(e){return{type:"multidropdown",id:"properties",label:"Properties",minSelection:1,default:Object.values(e).map((e=>e.id)),choices:Object.values(e).map((e=>({id:e.id,label:e.label})))}}function er(e,t,r,i){return{type:"dropdown",id:r,label:i,default:0,choices:X(Y(e,t,"ssrc-art"))}}function tr(e,t){return{type:"dropdown",id:"source",label:"Source",default:0,choices:X(Y(e,t,"ssrc-box"))}}function rr(e,t){return{type:"dropdown",id:"source",label:"Source",default:0,choices:X(Y(e,t,"mv"))}}function ir(e){return{type:"dropdown",id:"windowIndex",label:"Window #",default:2,choices:e.multiviewerFullGrid?oe(16,(e=>({id:e,label:`Window ${e+1}`}))):oe(8,(e=>({id:e+2,label:`Window ${e+3}`})))}}function ar(e){return{type:"dropdown",id:"mediaplayer",label:"Media Player",default:0,choices:J(e)}}function or(e,t,r=!0){return{type:"dropdown",id:"source",label:"Source",default:0,choices:[...r?oe(e.media.clips,(e=>{const r=t.media.clipPool[e];return{id:e+re,label:r?.name?`Clip #${e+1}: ${r.name}`:`Clip #${e+1}`}})):[],...oe(e.media.stills,(e=>{const r=t.media.stillPool[e];return{id:e,label:r?.fileName?`Still #${e+1}: ${r.fileName}`:`Still #${e+1}`}}))]}}function nr(t,r,i){const a=X(function(t,r,i){const a=(e,t,i)=>{const a=void 0!==t?r.inputs[t]:void 0;return{id:e,longName:a?.longName||i}},o=[];for(const r of t.classicAudio?.inputs??t.fairlightAudio?.inputs??[])if(("delay"!==i||"maxDelay"in r&&r.maxDelay)&&("routing"===i||!("routingOnly"in r)||!r.routingOnly))switch(r.portType){case e.Enums.ExternalPortType.Unknown:case e.Enums.ExternalPortType.Component:case e.Enums.ExternalPortType.Composite:case e.Enums.ExternalPortType.SVideo:break;case e.Enums.ExternalPortType.SDI:case e.Enums.ExternalPortType.HDMI:o.push(a(r.id,r.id,`Input ${r.id}`));break;case e.Enums.ExternalPortType.XLR:o.push(a(r.id,void 0,"XLR"));break;case e.Enums.ExternalPortType.AESEBU:o.push(a(r.id,void 0,"AES/EBU"));break;case e.Enums.ExternalPortType.RCA:o.push(a(r.id,void 0,"RCA"));break;case e.Enums.ExternalPortType.Internal:{const e=r.id-2e3;o.push(a(r.id,3e3+10*e,`Media Player ${e}`));break}case e.Enums.ExternalPortType.TSJack:{const e=r.id-1300;o.push(a(r.id,void 0,`Mic ${e}`));break}case e.Enums.ExternalPortType.MADI:{const e=r.id-1500;o.push(a(r.id,void 0,`MADI ${e}`));break}case e.Enums.ExternalPortType.TRSJack:o.push(a(r.id,void 0,"TRS"));break;case e.Enums.ExternalPortType.RJ45:o.push(a(r.id,void 0,"RJ45"));break;default:r.portType}return o.sort(((e,t)=>e.id-t.id)),o}(t,r,i));return{type:"dropdown",id:"input",label:"Input",default:a[0]?.id,choices:a}}function sr(){const e=[{id:"-65280",label:"Stereo"},{id:"-256",label:"Mono (Ch1)"},{id:"-255",label:"Mono (Ch2)"}];return{type:"dropdown",id:"source",label:"Source",default:e[0].id,choices:e}}function lr(){const e=[{id:le.Equal,label:"Equal"},{id:le.NotEqual,label:"Not Equal"},{id:le.GreaterThan,label:"Greater than"},{id:le.GreaterThanEqual,label:"Greater than or equal"},{id:le.LessThan,label:"Less than"},{id:le.LessThanEqual,label:"Less than or equal"}];return{type:"dropdown",label:"Comparitor",id:"comparitor",default:le.Equal,choices:e}}const ur={fadeDuration:{type:"number",label:"Fade Duration (ms)",id:"fadeDuration",default:0,min:0,step:10,max:6e4},fadeAlgorithm:{type:"dropdown",label:"Algorithm",id:"fadeAlgorithm",default:"linear",choices:[{id:"linear",label:"Linear"},{id:"quadratic",label:"Quadratic"},{id:"cubic",label:"Cubic"},{id:"quartic",label:"Quartic"},{id:"quintic",label:"Quintic"},{id:"sinusoidal",label:"Sinusoidal"},{id:"exponential",label:"Exponential"},{id:"circular",label:"Circular"},{id:"elastic",label:"Elastic"},{id:"back",label:"Back"},{id:"bounce",label:"Bounce"}],isVisible:e=>null!=e.fadeDuration&&e.fadeDuration>0},fadeCurve:{type:"dropdown",label:"Fade curve",id:"fadeCurve",default:"ease-in",choices:[{id:"ease-in",label:"Ease-in"},{id:"ease-out",label:"Ease-out"},{id:"ease-in-out",label:"Ease-in-out"}],isVisible:e=>null!=e.fadeDuration&&null!=e.fadeAlgorithm&&e.fadeDuration>0&&"linear"!==e.fadeAlgorithm}},cr={type:"number",label:"Delta",id:"delta",default:1,max:100,min:-100};function dr(e,t){return{type:"dropdown",id:"source",label:"Source",default:0,choices:X(Y(e,t))}}function pr(){const t={enabled:{type:"checkbox",id:"enabled",label:"Display",default:!1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("enabled")},size:{type:"number",id:"size",label:"Size",min:0,max:1,range:!0,default:.5,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("size")},opacity:{type:"number",id:"opacity",label:"Opacity",min:0,max:1,range:!0,default:1,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("opacity")},x:{type:"number",id:"x",label:"X",min:-16,max:16,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("x")},y:{type:"number",id:"y",label:"Y",min:-9,max:9,range:!0,default:0,step:.01,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("y")},autoHide:{type:"checkbox",id:"autoHide",label:"Auto Hide",default:!1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("autoHide")},clockMode:{id:"clockMode",label:"Mode",type:"dropdown",default:e.Enums.DisplayClockClockMode.Countdown,choices:[{id:e.Enums.DisplayClockClockMode.Countdown,label:"Count down"},{id:e.Enums.DisplayClockClockMode.Countup,label:"Count up"},{id:e.Enums.DisplayClockClockMode.TimeOfDay,label:"Time of Day"}],isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("clockMode")}};return{properties:Zt(t),...t}}function mr(e,t){const r=function(e,t){const r=[],i=t.fairlight?.audioRouting?.sources??{};for(const t of e.fairlightAudio?.audioRouting?.sources??[])for(const e of t.channelPairs){const a=C(t.inputId,e);r.push({id:a,label:ee(t.sourceName,i[a]?.name,e,t.channelPairs)})}return r}(e,t);return{type:"dropdown",id:"source",label:"Source",default:r[0].id,choices:r}}function br(e,t){const r=Z(e,t);return{type:"multidropdown",id:"destinations",label:"Destinations",default:[r[0].id],choices:r}}function fr(e,t){const r=Z(e,t);return{type:"dropdown",id:"destination",label:"Destination",default:r[0].id,choices:r}}function gr(){const t={style:{type:"dropdown",label:"Style: ",id:"style",default:e.Enums.Pattern.LeftToRightBar,choices:[{id:e.Enums.Pattern.LeftToRightBar,label:"Left To Right Bar"},{id:e.Enums.Pattern.TopToBottomBar,label:"Top To Bottom Bar"},{id:e.Enums.Pattern.HorizontalBarnDoor,label:"Horizontal Barn Door"},{id:e.Enums.Pattern.VerticalBarnDoor,label:"Vertical Barn Door"},{id:e.Enums.Pattern.CornersInFourBox,label:"Corners In Four Box"},{id:e.Enums.Pattern.RectangleIris,label:"Rectangle Iris"},{id:e.Enums.Pattern.DiamondIris,label:"Diamond Iris"},{id:e.Enums.Pattern.CircleIris,label:"Circle Iris"},{id:e.Enums.Pattern.TopLeftBox,label:"Top Left Box"},{id:e.Enums.Pattern.TopRightBox,label:"Top Right Box"},{id:e.Enums.Pattern.BottomRightBox,label:"Bottom Right Box"},{id:e.Enums.Pattern.BottomLeftBox,label:"Bottom Left Box"},{id:e.Enums.Pattern.TopCentreBox,label:"Top Centre Box"},{id:e.Enums.Pattern.RightCentreBox,label:"Right Centre Box"},{id:e.Enums.Pattern.BottomCentreBox,label:"Bottom Centre Box"},{id:e.Enums.Pattern.LeftCentreBox,label:"Left Centre Box"},{id:e.Enums.Pattern.TopLeftDiagonal,label:"Top Left Diagonal"},{id:e.Enums.Pattern.TopRightDiagonal,label:"Top Right Diagonal"}],isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("style")},invert:{type:"checkbox",label:"Invert Pattern",id:"invert",default:!1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("invert")},size:{type:"number",label:"Size",id:"size",default:50,range:!0,min:0,step:.01,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("size")},symmetry:{type:"number",label:"Symmetry",id:"symmetry",default:81.6,range:!0,min:0,step:.01,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("symmetry")},softness:{type:"number",label:"Softness",id:"softness",default:50,range:!0,min:0,step:.01,max:100,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("softness")},positionX:{type:"number",label:"Position: X",id:"positionX",default:.5,min:0,range:!0,step:.01,max:1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionX")},positionY:{type:"number",label:"Position: Y",id:"positionY",default:.5,range:!0,min:0,step:.01,max:1,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionY")}};return{properties:Zt(t),...t}}function hr(){const e={style:{type:"textinput",label:"Style: ",id:"style",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("style")},invert:{type:"textinput",label:"Invert Pattern",id:"invert",default:"false",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("invert")},size:{type:"textinput",label:"Size",id:"size",default:"50",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("size")},symmetry:{type:"textinput",label:"Symmetry",id:"symmetry",default:"81.6",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("symmetry")},softness:{type:"textinput",label:"Softness",id:"softness",default:"50",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("softness")},positionX:{type:"textinput",label:"Position: X",id:"positionX",default:"0.5",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionX")},positionY:{type:"textinput",label:"Position: Y",id:"positionY",default:"0.5",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionY")}};return{properties:Zt(e),...e}}function yr(){const e={flyEnabled:{type:"checkbox",label:"Enabled",id:"flyEnabled",default:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("flyEnabled")},positionX:{type:"number",label:"Position X",id:"positionX",default:0,min:-32,step:.01,max:32,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionX")},positionY:{type:"number",label:"Position Y",id:"positionY",default:0,min:-18,step:.01,max:18,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionY")},sizeX:{type:"number",label:"Size X",id:"sizeX",default:1,min:0,step:.01,max:99.99,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeX")},sizeY:{type:"number",label:"Size Y",id:"sizeY",default:1,min:0,step:.01,max:99.99,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeY")}};return{properties:Zt(e),...e}}function Sr(){const e={flyEnabled:{type:"textinput",label:"Enabled",id:"flyEnabled",default:"true",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("flyEnabled")},positionX:{type:"textinput",label:"Position X",id:"positionX",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionX")},positionY:{type:"textinput",label:"Position Y",id:"positionY",default:"0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("positionY")},sizeX:{type:"textinput",label:"Size X",id:"sizeX",default:"1.0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeX")},sizeY:{type:"textinput",label:"Size Y",id:"sizeY",default:"1.0",useVariables:!0,isVisible:e=>Array.isArray(e.properties)&&e.properties.includes("sizeY")}};return{properties:Zt(e),...e}}var vr,Pr;function Cr(e,t,r,i){return{[vr.Program]:{name:"ME: Set Program input",options:{mixeffect:Nt(t,0),input:It(t,i.state,0)},callback:async({options:t})=>{await(e?.changeProgramInput(t.getPlainNumber("input"),t.getPlainNumber("mixeffect")))},learn:({options:e})=>{const t=(0,At.YM)(i.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),input:t.programInput}:void 0}},[vr.ProgramVariables]:{name:"ME: Set Program input from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},callback:async({options:t})=>{const r=await t.getParsedNumber("mixeffect"),i=await t.getParsedNumber("input");isNaN(r)||isNaN(i)||await(e?.changeProgramInput(i,r-1))}},[vr.Preview]:{name:"ME: Set Preview input",options:{mixeffect:Nt(t,0),input:It(t,i.state,0)},callback:async({options:t})=>{await(e?.changePreviewInput(t.getPlainNumber("input"),t.getPlainNumber("mixeffect")))},learn:({options:e})=>{const t=(0,At.YM)(i.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),input:t.previewInput}:void 0}},[vr.PreviewVariables]:{name:"ME: Set Preview input from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},callback:async({options:t})=>{const r=await t.getParsedNumber("mixeffect"),i=await t.getParsedNumber("input");isNaN(r)||isNaN(i)||await(e?.changePreviewInput(i,r-1))}},[vr.Cut]:{name:"ME: Perform CUT transition",options:{mixeffect:Nt(t,0)},callback:async({options:t})=>{await(e?.cut(t.getPlainNumber("mixeffect")))}},[vr.Auto]:{name:"ME: Perform AUTO transition",options:{mixeffect:Nt(t,0)},callback:async({options:t})=>{await(e?.autoTransition(t.getPlainNumber("mixeffect")))}},[vr.TBar]:{name:"ME: Set TBar position",options:{mixeffect:Nt(t,0),position:{type:"textinput",id:"position",label:"Position (0 - 100)",default:"0",useVariables:!0},...ur},callback:async({options:t})=>{const a=await t.getParsedNumber("position");if(isNaN(a))return;const o=t.getPlainNumber("mixeffect"),n=(0,At.YM)(i.state,o);await r.runForFadeOptions(`me.${o}.tbar`,(async t=>{await(e?.setTransitionPosition(t,o))}),n?.transitionPosition.handlePosition,100*a,t)}}}}(Pr=vr||(vr={})).Program="program",Pr.ProgramVariables="programVariables",Pr.Preview="preview",Pr.PreviewVariables="previewVariables",Pr.Cut="cut",Pr.Auto="auto",Pr.TBar="tBar",Pr.Aux="aux",Pr.AuxVariables="auxVariables",Pr.USKType="uskType",Pr.USKSource="uskSource",Pr.USKSourceVariables="uskSourceVariables",Pr.USKOnAir="usk",Pr.USKFly="uskFly",Pr.USKMaskLumaChromaPattern="uskMaskLumaChromaPattern",Pr.USKFlyKeyLumaChromaPattern="uskFlyKeyLumaChromaPattern",Pr.USKFlyKeyLumaChromaPatternVariables="uskFlyKeyLumaChromaPatternVariables",Pr.USKDVEProperties="uskDveProperties",Pr.USKDVEPropertiesVariables="uskDvePropertiesVariables",Pr.USKPatternProperties="uskPatternProperties",Pr.USKPatternPropertiesVariables="uskPatternPropertiesVariables",Pr.USKSetKeyframe="uskSetKeyframe",Pr.USKStoreKeyframe="uskStoreKeyframe",Pr.USKFlyInfinite="uskFlyInfinite",Pr.DSKSource="dskSource",Pr.DSKSourceVariables="dskSourceVariables",Pr.DSKRate="dskRate",Pr.DSKMask="dskMask",Pr.DSKPreMultipliedKey="dskPreMultipliedKey",Pr.DSKOnAir="dsk",Pr.DSKTie="dskTie",Pr.DSKAuto="dskAuto",Pr.MacroRun="macrorun",Pr.MacroContinue="macrocontinue",Pr.MacroStop="macrostop",Pr.MacroLoop="macroloop",Pr.MultiviewerWindowSource="setMvSource",Pr.MultiviewerWindowSourceVariables="setMvSourceVariables",Pr.MultiviewerLayout="multiviewerLayout",Pr.SuperSourceArt="ssrcArt",Pr.SuperSourceArtVariables="ssrcArtVariables",Pr.SuperSourceBoxSource="setSsrcBoxSource",Pr.SuperSourceBoxSourceVaraibles="setSsrcBoxSourceVariables",Pr.SuperSourceBoxOnAir="setSsrcBoxEnable",Pr.SuperSourceBoxProperties="setSsrcBoxProperties",Pr.SuperSourceBoxPropertiesDelta="setSsrcBoxPropertiesDelta",Pr.PreviewTransition="previewTransition",Pr.TransitionStyle="transitionStyle",Pr.TransitionSelection="transitionSelection",Pr.TransitionSelectionComponent="transitionSelectionComponent",Pr.TransitionSelectComponents="transitionSelectComponents",Pr.TransitionRate="transitionRate",Pr.MediaPlayerSource="mediaPlayerSource",Pr.MediaPlayerSourceVariables="mediaPlayerSourceVariables2",Pr.MediaPlayerCycle="mediaPlayerCycle",Pr.MediaCaptureStill="mediaCaptureStill",Pr.MediaDeleteStill="mediaDeleteStill",Pr.FadeToBlackAuto="fadeToBlackAuto",Pr.FadeToBlackRate="fadeToBlackRate",Pr.StreamStartStop="streamStartStop",Pr.StreamService="streamService",Pr.RecordStartStop="recordStartStop",Pr.RecordSwitchDisk="recordSwitchDisk",Pr.RecordFilename="recordFilename",Pr.RecordISO="recordISO",Pr.ClassicAudioGain="classicAudioGain",Pr.ClassicAudioGainDelta="classicAudioGainDelta",Pr.ClassicAudioMixOption="classicAudioMixOption",Pr.ClassicAudioResetPeaks="classicAudioResetPeaks",Pr.ClassicAudioMasterGain="classicAudioMasterGain",Pr.ClassicAudioMasterGainDelta="classicAudioMasterGainDelta",Pr.ClassicAudioMasterPan="classicAudioMasterPan",Pr.ClassicAudioMasterPanDelta="classicAudioMasterPanDelta",Pr.FairlightAudioFaderGain="fairlightAudioFaderGain",Pr.FairlightAudioFaderGainDelta="fairlightAudioFaderGainDelta",Pr.FairlightAudioInputGain="fairlightAudioInputGain",Pr.FairlightAudioInputGainDelta="fairlightAudioInputGainDelta",Pr.FairlightAudioInputDelay="fairlightAudioInputDelay",Pr.FairlightAudioInputDelayDelta="fairlightAudioInputDelayDelta",Pr.FairlightAudioMixOption="fairlightAudioMixOption",Pr.FairlightAudioResetPeaks="fairlightAudioResetPeaks",Pr.FairlightAudioResetSourcePeaks="fairlightAudioResetSourcePeaks",Pr.FairlightAudioMasterGain="fairlightAudioMasterGain",Pr.FairlightAudioMasterGainDelta="fairlightAudioMasterGainDelta",Pr.FairlightAudioMonitorSolo="fairlightAudioMonitorSolo",Pr.FairlightAudioMonitorOutputGain="fairlightAudioMonitorGain",Pr.FairlightAudioMonitorOutputGainDelta="fairlightAudioMonitorGainDelta",Pr.FairlightAudioMonitorMasterMuted="fairlightAudioMonitorMasterMuted",Pr.FairlightAudioMonitorMasterGain="fairlightAudioMonitorMasterGain",Pr.FairlightAudioMonitorMasterGainDelta="fairlightAudioMonitorMasterGainDelta",Pr.FairlightAudioMonitorTalkbackMuted="fairlightAudioMonitorTalkbackMuted",Pr.FairlightAudioMonitorTalkbackGain="fairlightAudioMonitorTalkbackGain",Pr.FairlightAudioMonitorTalkbackGainDelta="fairlightAudioMonitorTalkbackGainDelta",Pr.FairlightAudioMonitorSidetoneGain="fairlightAudioMonitorSidetoneGain",Pr.FairlightAudioMonitorSidetoneGainDelta="fairlightAudioMonitorSidetoneGainDelta",Pr.FairlightAudioRouting="fairlightAudioRouting",Pr.FairlightAudioRoutingVariables="fairlightAudioRoutingVariables",Pr.SaveStartupState="saveStartupState",Pr.ClearStartupState="clearStartupState",Pr.InputName="inputName",Pr.DisplayClockState="displayClockState",Pr.DisplayClockConfigure="displayClockConfigure",Pr.DisplayClockStartTime="displayClockStartTime",Pr.DisplayClockOffsetStartTime="displayClockOffsetStartTime",Pr.Timecode="timecode",Pr.TimecodeMode="timecodeMode",Pr.CameraControlLensFocus="cameraControlLensFocus",Pr.CameraControlLensAutoFocus="cameraControlLensAutoFocus",Pr.CameraControlLensIris="cameraControlLensIris",Pr.CameraControlIncrementLensIris="cameraControlIncrementLensIris",Pr.CameraControlLensAutoIris="cameraControlLensAutoIris",Pr.CameraControlLensOpticalImageStabilisation="cameraControlLensOpticalImageStabilisation",Pr.CameraControlLensZoom="cameraControlLensZoom",Pr.CameraControlVideoManualWhiteBalance="cameraControlVideoManualWhiteBalance",Pr.CameraControlVideoIncrementManualWhiteBalance="cameraControlVideoIncrementManualWhiteBalance",Pr.CameraControlVideoAutoWhiteBalance="cameraControlVideoAutoWhiteBalance",Pr.CameraControlVideoExposure="cameraControlVideoExposure",Pr.CameraControlIncrementVideoExposure="cameraControlIncrementVideoExposure",Pr.CameraControlVideoSharpeningLevel="cameraControlVideoSharpeningLevel",Pr.CameraControlVideoGain="cameraControlVideoGain",Pr.CameraControlIncrementVideoGain="cameraControlIncrementVideoGain",Pr.CameraControlVideoNdFilterStop="cameraControlVideoNdFilterStop",Pr.CameraControlDisplayColorBars="cameraControlDisplayColorBars",Pr.CameraControlMediaRecordSingle="cameraControlMediaRecordSingle",Pr.CameraControlMediaRecordMultiple="cameraControlMediaRecordMultiple",Pr.CameraControlColorLiftAdjust="cameraControlColorLiftAdjust",Pr.CameraControlColorGammaAdjust="cameraControlColorGammaAdjust",Pr.CameraControlColorGainAdjust="cameraControlColorGainAdjust",Pr.CameraControlColorOffsetAdjust="cameraControlColorOffsetAdjust",Pr.CameraControlColorContrastAdjust="cameraControlColorContrastAdjust",Pr.CameraControlColorLumaMix="cameraControlColorLumaMix",Pr.CameraControlColorHueSaturationAdjust="cameraControlColorHueSaturationAdjust";class kr{#l;#le;#ue;constructor(e,t,r){this.#l=e,this.#le=t,this.#ue=r}getJson(){return{...this.#l}}getRaw(e){return this.#l[e]}getPlainString(e){const t=this.#ue[e],r=t&&"default"in t?t.default:void 0,i=this.#l[e];return String(void 0!==r&&void 0===i?r:i)}getPlainNumber(e){const t=this.#ue[e],r=t&&"default"in t?t.default:void 0,i=this.#l[e];if(void 0!==r&&void 0===i)return Number(r);const a=Number(i);if(isNaN(a))throw new Error(`Invalid option '${String(e)}'`);return a}getPlainBoolean(e){const t=this.#ue[e],r=t&&"default"in t?t.default:void 0,i=this.#l[e];return void 0!==r&&void 0===i?Boolean(r):Boolean(i)}async getParsedString(e){const t=this.#l[e];return this.#le.parseVariablesInString(t)}async getParsedNumber(e){const t=await this.getParsedString(e);return Number(t)}async getParsedBoolean(e){const t=await this.getParsedString(e);return"false"!=t.toLowerCase()&&0!=Number(t)}}function Ar(e,t,r){return{id:e.id,controlId:e.controlId,actionId:e.actionId,options:new kr(e.options,t,r)}}function Ir(e){const{subscribe:t,unsubscribe:r,learn:i}=e;return{name:e.name,description:e.description,options:Object.entries(e.options).filter((e=>!!e[1])).map((([e,t])=>({...t,id:e}))),callback:async(t,r)=>e.callback({...Ar(t,r,e.options),surfaceId:t.surfaceId},r),subscribe:t?async(r,i)=>t(Ar(r,i,e.options),i):void 0,unsubscribe:r?async(t,i)=>r(Ar(t,i,e.options),i):void 0,learn:i?async(t,r)=>i({...Ar(t,r,e.options),surfaceId:t.surfaceId},r):void 0,learnTimeout:void 0}}var wr=__webpack_require__(3764);class _r{#ce=new Map;#de=new Map;#pe;#me;#be;constructor(e,t,r){this.#be=e.media,this.#pe=t,this.#me=r}subscribe(e,t){const r=this.#fe(e);let i=this.#de.get(r);i||(i={source:e,subs:new Set},this.#de.set(r,i)),i.subs.add(t),this.ensureLoaded(e)}unsubscribe(e){for(const t of this.#de.values())t.subs.delete(e)}checkUpdatedState(e){this.#be=e.media;for(const e of this.#de.values())e.subs.size>0&&this.ensureLoaded(e.source,!0);for(const[e,t]of this.#ce)(this.#de.get(e)?.subs?.size??0)>0||this.#ge(t)&&this.#ce.delete(e)}isSlotOccupied(e){const t=this.#he(e);return!!t?.isUsed}ensureLoaded(e,t=!1){const r=this.#fe(e),i=this.#ce.get(r),a=this.#he(e);if(i&&!this.#ge(i)||!a?.isUsed){if(i&&this.#ge(i)&&(this.#ce.delete(r),t)){const e=this.#de.get(r);e&&e.subs.size>0&&this.#me(Array.from(e.subs))}}else this.#ye(e,i,a)}async getPreviewImage(e,r){const i=this.#fe(e),a=this.#ce.get(i);if(!a||a.isLoading||!a.rawImage)return null;const o=function(e){let t=`${e.buttonWidth}-${e.buttonHeight}-${e.crop}`;return"none"!==e.crop&&(t+=`-${e.position}`),t}(r);let n=a.scaledImages.get(o);if(!n){let e=wr.tc.fromBuffer(a.rawImage.buffer,a.rawImage.width,a.rawImage.height,wr.Ab.Rgba);const i=a.rawImage.height/r.buttonHeight*r.buttonWidth;switch(r.crop){case"none":break;case"center":e=e.cropCenter(i,a.rawImage.height);break;case"left":e=e.crop(0,0,i,a.rawImage.height);break;case"right":e=e.crop(a.rawImage.width-i,0,i,a.rawImage.height);break;default:(0,t.assertNever)(r.crop)}n=e.scale(4*r.buttonWidth,4*r.buttonHeight,wr.OJ.Fit).toBuffer(wr.Ab.Rgba),a.scaledImages.set(o,n)}const s=await n,l=s.height/4;let u=Math.floor((r.buttonHeight-l)/2);if("none"===r.crop)switch(r.position){case"top":u=0;break;case"bottom":u=r.buttonHeight-l;break;case"center":break;default:(0,t.assertNever)(r.position)}return{imageBuffer:s.buffer,imageBufferEncoding:{pixelFormat:"RGBA"},imageBufferPosition:{x:0,y:u,width:s.width,height:s.height,drawScale:1/4}}}#ye(e,t,r){if(t&&t.isLoading)return;t={source:e,loadedHash:r.hash,loadedFilename:r.fileName,isLoading:!0,isStale:!1,rawImage:void 0,scaledImages:new Map};const i=this.#fe(e);this.#ce.set(i,t),this.#pe(e).then((async e=>{console.log("got image",e.buffer.length);const r=this.#ce.get(i);r&&r===t&&(r.rawImage=e,r.isLoading=!1)})).catch((e=>{const r=this.#ce.get(i);r&&r===t&&(this.#ce.delete(i),console.log("failed image",e))})).finally((()=>{const e=this.#de.get(i);e&&e.subs.size>0&&this.#me(Array.from(e.subs.keys()))}))}#he(e){if(e.isClip){const t=this.#be.clipPool[e.slot];if(!t||t.frameCount<1||e.frameIndex<0||e.frameIndex>=t.frameCount)return;const r=t.frames?.[e.frameIndex];return r||{fileName:`${t.name}-${e.frameIndex}`,hash:`fake-${e.frameIndex}`,isUsed:!0}}return this.#be.stillPool[e.slot]}#ge(e){if(e.isStale)return!0;const t=this.#he(e.source);return!t||t.fileName!==e.loadedFilename||t.hash!==e.loadedHash}#fe(e){return e.isClip?`clip-${e.slot}-${e.frameIndex}`:`still-${e.slot}`}}function xr(e,t){return e.video.mixEffects[Number(t)]}function Er(e,t){const r=xr(e,t);return r?r.transitionProperties:void 0}function Mr(e,t,r){const i=xr(e,t);return i?i.upstreamKeyers[Number(r)]:void 0}function Tr(e,t){return e.video.downstreamKeyers[Number(t)]}function Nr(e,t,r){const i=e.video.superSources[Number(r??0)];return i?i.boxes[Number(t)]:void 0}function Or(e,t){return e.settings.multiViewers[Number(t)]}function Rr(e,t,r){const i=Or(e,t);return i?i.windows[Number(r)]:void 0}function Dr(t,r,i,a,o){return{[vr.PreviewTransition]:{name:"Transition: Preview",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:_}},callback:async({options:e})=>{const t=await e.getParsedNumber("mixeffect");let i;i="toggle"===e.getPlainString("state")?!(0,At.YM)(o.state,t-1).transitionPreview:"true"===e.getPlainString("state"),console.log("previewTransition",i,t),isNaN(t)||await(r?.previewTransition(i,t-1))}},[vr.TransitionStyle]:{name:"Transition: Set style/pattern",options:{mixeffect:Nt(i,0),style:wt(0===i.media.clips)},callback:async({options:e})=>{await(r?.setTransitionStyle({nextStyle:e.getPlainNumber("style")},e.getPlainNumber("mixeffect")))},learn:({options:e})=>{const t=(0,At.YM)(o.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),style:t.transitionProperties.nextStyle}:void 0}},[vr.TransitionRate]:{name:"Transition: Change rate",options:{mixeffect:Nt(i,0),style:wt(!0),rate:xt("Transition Rate")},callback:async({options:i})=>{const a=i.getPlainNumber("style");switch(a){case e.Enums.TransitionStyle.MIX:await(r?.setMixTransitionSettings({rate:i.getPlainNumber("rate")},i.getPlainNumber("mixeffect")));break;case e.Enums.TransitionStyle.DIP:await(r?.setDipTransitionSettings({rate:i.getPlainNumber("rate")},i.getPlainNumber("mixeffect")));break;case e.Enums.TransitionStyle.WIPE:await(r?.setWipeTransitionSettings({rate:i.getPlainNumber("rate")},i.getPlainNumber("mixeffect")));break;case e.Enums.TransitionStyle.DVE:await(r?.setDVETransitionSettings({rate:i.getPlainNumber("rate")},i.getPlainNumber("mixeffect")));break;case e.Enums.TransitionStyle.STING:break;default:t.log("debug","Unknown transition style: "+a)}},learn:({options:t})=>{const r=(0,At.YM)(o.state,t.getPlainNumber("mixeffect"));if(r?.transitionSettings){switch(t.getPlainNumber("style")){case e.Enums.TransitionStyle.MIX:if(!r.transitionSettings.mix)return;return{...t.getJson(),rate:r.transitionSettings.mix.rate};case e.Enums.TransitionStyle.DIP:if(!r.transitionSettings.dip)return;return{...t.getJson(),rate:r.transitionSettings.dip.rate};case e.Enums.TransitionStyle.WIPE:if(!r.transitionSettings.wipe)return;return{...t.getJson(),rate:r.transitionSettings.wipe.rate};case e.Enums.TransitionStyle.DVE:if(!r.transitionSettings.DVE)return;return{...t.getJson(),rate:r.transitionSettings.DVE.rate};case e.Enums.TransitionStyle.STING:default:return}}}},[vr.TransitionSelection]:{name:"Transition: Change selection",options:{mixeffect:Nt(i,0),selection:Mt(i)},callback:async({options:e})=>{await(r?.setTransitionStyle({nextSelection:se(i.USKs,e.getRaw("selection"))},e.getPlainNumber("mixeffect")))}},[vr.TransitionSelectComponents]:{name:"Transition: Select components in transition",options:{mixeffect:Nt(i,0),...Et(i)},callback:async({options:a})=>{const n=a.getPlainNumber("mixeffect"),s=Er(o.state,n);if(!r||!s)return;const l=s.nextSelection,u=[];{const r=l.includes(e.Enums.TransitionSelection.Background);let i;const o=a.getPlainString("background");switch(o){case x.NoChange:i=r;break;case x.Include:i=!0;break;case x.Omit:i=!1;break;case x.Toggle:i=!r;break;default:t.log("debug","Unknown background mode: "+o),i=r}i&&u.push(e.Enums.TransitionSelection.Background)}for(let e=0;e<i.USKs;e++){const r=Mr(o.state,n,e);if(r){const i=1<<e+1,o=l.includes(i),n=a.getPlainString(`key${e}`);let s;switch(n){case T.NoChange:s=o;break;case T.On:case T.Off:s=r.onAir===(n===T.Off);break;case T.Toggle:s=!o;break;case T.Include:s=!0;break;case T.Omit:s=!1;break;default:t.log("debug","Unknown mode: "+n),s=o}s&&u.push(i)}}u.length>0&&await r.setTransitionStyle({nextSelection:u},n)},learn:({options:t})=>{const r=t.getPlainNumber("mixeffect"),a=(0,At.YM)(o.state,r),n=Er(o.state,r);if(a&&n){const a=n.nextSelection,s=a.includes(e.Enums.TransitionSelection.Background)?x.Include:x.Omit,l={};for(let e=0;e<i.USKs;e++){const t=Mr(o.state,r,e);let i;if(t){const r=1<<e+1,o=a.includes(r);i=t.onAir!=o?T.On:T.Off}else i=T.Omit;l[`key${e}`]=i}return{...t.getJson(),background:s,...l}}}},[vr.TransitionSelectionComponent]:{name:"Transition: Change selection component",options:{mixeffect:Nt(i,0),component:Tt(i),mode:{type:"dropdown",id:"mode",label:"State",choices:R,default:R[0].id}},callback:async({options:e})=>{const t=e.getPlainNumber("mixeffect"),i=Er(o.state,t);if(i&&r){let o=a.meTransitionSelection.get(t);o||(o=new ge((async e=>r.setTransitionStyle({nextSelection:e},t)),{delayStep:100,maxBatch:5}),a.meTransitionSelection.set(t,o));const n=e.getPlainString("mode"),s=1<<e.getPlainNumber("component");o.queueChange(i.nextSelection,(e=>{let t=n;return"toggle"===n&&(t=e.includes(s)?"false":"true"),"true"===t?[...e,s]:e.filter((e=>e!==s))}))}}}}}function Fr(t,r,i){return r.displayClock?{[vr.DisplayClockState]:{name:"Display Clock: Start/Stop",options:{state:{id:"state",label:"State",type:"dropdown",default:"toggle",choices:[{id:"toggle",label:"Toggle"},{id:e.Enums.DisplayClockClockState.Running,label:"Start"},{id:e.Enums.DisplayClockClockState.Stopped,label:"Stop"},{id:e.Enums.DisplayClockClockState.Reset,label:"Reset"}]}},callback:async({options:r})=>{let a;const o=r.getRaw("state");switch(o){case"toggle":a=i.state.displayClock?.properties?.clockState===e.Enums.DisplayClockClockState.Running?e.Enums.DisplayClockClockState.Stopped:e.Enums.DisplayClockClockState.Running;break;case e.Enums.DisplayClockClockState.Running:case e.Enums.DisplayClockClockState.Stopped:case e.Enums.DisplayClockClockState.Reset:a=o}void 0!==a&&await(t?.setDisplayClockState(a))}},[vr.DisplayClockConfigure]:{name:"Display Clock: Configure",options:{...pr()},callback:async({options:e})=>{const r={},i=e.getRaw("properties");i&&Array.isArray(i)&&(i.includes("enabled")&&(r.enabled=e.getPlainBoolean("enabled")),i.includes("size")&&(r.size=100*e.getPlainNumber("size")),i.includes("opacity")&&(r.opacity=100*e.getPlainNumber("opacity")),i.includes("x")&&(r.positionX=1e3*e.getPlainNumber("x")),i.includes("y")&&(r.positionY=1e3*e.getPlainNumber("y")),i.includes("autoHide")&&(r.autoHide=e.getPlainBoolean("autoHide")),i.includes("clockMode")&&(r.clockMode=e.getPlainNumber("clockMode"))),0!==Object.keys(r).length&&await(t?.setDisplayClockProperties(r))},learn:({options:e})=>{const t=i.state.displayClock?.properties;return t?{...e.getJson(),enabled:t.enabled,size:t.size/100,opacity:t.opacity/100,x:t.positionX/1e3,y:t.positionY/1e3,autoHide:t.autoHide,clockMode:t.clockMode}:void 0}},[vr.DisplayClockStartTime]:{name:"Display Clock: Set Start Time",options:{hours:{type:"number",id:"hours",label:"Hours",min:0,max:23,range:!0,default:0,step:1},minutes:{type:"number",id:"minutes",label:"Minutes",min:0,max:59,range:!0,default:0,step:1},seconds:{type:"number",id:"seconds",label:"Seconds",min:0,max:59,range:!0,default:0,step:1}},callback:async({options:e})=>{const r={hours:e.getPlainNumber("hours"),minutes:e.getPlainNumber("minutes"),seconds:e.getPlainNumber("seconds"),frames:0};await(t?.setDisplayClockProperties({startFrom:r}))},learn:({options:e})=>{const t=i.state.displayClock?.properties;return t?{...e.getJson(),hours:t.startFrom.hours,minutes:t.startFrom.minutes,seconds:t.startFrom.seconds}:void 0}},[vr.DisplayClockOffsetStartTime]:{name:"Display Clock: Offset Start Time",options:{hours:{type:"number",id:"hours",label:"Hours",min:-23,max:23,range:!0,default:0,step:1},minutes:{type:"number",id:"minutes",label:"Minutes",min:-59,max:59,range:!0,default:0,step:1},seconds:{type:"number",id:"seconds",label:"Seconds",min:-59,max:59,range:!0,default:0,step:1}},callback:async({options:e})=>{const r=i.state.displayClock?.properties?.startFrom;let a=(r?3600*r.hours+60*r.minutes+r.seconds:0)+(3600*e.getPlainNumber("hours")+60*e.getPlainNumber("minutes")+e.getPlainNumber("seconds"));a%=86400,a<0&&(a+=86400);const o={hours:Math.floor(a/3600),minutes:Math.floor(a%3600/60),seconds:a%60,frames:0};await(t?.setDisplayClockProperties({startFrom:o}))}}}:{[vr.DisplayClockState]:void 0,[vr.DisplayClockConfigure]:void 0,[vr.DisplayClockStartTime]:void 0,[vr.DisplayClockOffsetStartTime]:void 0}}function Vr(e,t,r){return t.macros?{[vr.MacroRun]:{name:"Macro: Run",options:{macro:{type:"dropdown",id:"macro",label:"Macro",default:1,choices:q(t,r.state)},action:{type:"dropdown",id:"action",label:"Action",default:"run",choices:[{id:"run",label:"Run"},{id:"runContinue",label:"Run/Continue"}]}},callback:async({options:t})=>{const i=t.getPlainNumber("macro")-1,{macroPlayer:a,macroRecorder:o}=r.state.macro;"runContinue"===t.getPlainString("action")&&a.isWaiting&&a.macroIndex===i?await(e?.macroContinue()):o.isRecording&&o.macroIndex===i?await(e?.macroStopRecord()):await(e?.macroRun(i))}},[vr.MacroContinue]:{name:"Macro: Continue",options:{},callback:async()=>{await(e?.macroContinue())}},[vr.MacroStop]:{name:"Macro: Stop",options:{},callback:async()=>{await(e?.macroStop())}},[vr.MacroLoop]:{name:"Macro: Loop",options:{loop:{id:"loop",type:"dropdown",label:"Loop",default:"toggle",choices:_}},callback:async({options:t})=>{let i="true"===t.getPlainString("loop");"toggle"===t.getPlainString("loop")&&(i=!r.state.macro.macroPlayer.loop),await(e?.macroSetLoop(i))}}}:{[vr.MacroRun]:void 0,[vr.MacroContinue]:void 0,[vr.MacroStop]:void 0,[vr.MacroLoop]:void 0}}function $r(t,r,i){return r.streaming?{[vr.StreamStartStop]:{name:"Stream: Start or Stop",options:{stream:{id:"stream",type:"dropdown",label:"Stream",default:"toggle",choices:_}},callback:async({options:r})=>{let a="true"===r.getPlainString("stream");"toggle"===r.getPlainString("stream")&&(a=i.state.streaming?.status?.state===e.Enums.StreamingStatus.Idle),a?await(t?.startStreaming()):await(t?.stopStreaming())},learn:({options:e})=>i.state.streaming?.status?{...e.getJson(),state:i.state.streaming.status.state}:void 0},[vr.StreamService]:{name:"Stream: Set service",options:{service:{id:"service",label:"Service",type:"textinput",default:"",useVariables:!0},url:{id:"url",label:"URL",type:"textinput",default:"",useVariables:!0},key:{id:"key",label:"Key",type:"textinput",default:"",useVariables:!0}},callback:async({options:e})=>{const[r,i,a]=await Promise.all([e.getParsedString("service"),e.getParsedString("url"),e.getParsedString("key")]);await(t?.setStreamingService({serviceName:r,url:i,key:a}))},learn:({options:e})=>i.state.streaming?.service?{...e.getJson(),service:i.state.streaming.service.serviceName,url:i.state.streaming.service.url,key:i.state.streaming.service.key}:void 0}}:{[vr.StreamStartStop]:void 0,[vr.StreamService]:void 0}}function Br(t,r,i){return r.recording?{[vr.RecordStartStop]:{name:"Recording: Start or Stop",options:{record:{id:"record",type:"dropdown",label:"Record",default:"toggle",choices:_}},callback:async({options:r})=>{let a="true"===r.getPlainString("record");"toggle"===r.getPlainString("record")&&(a=i.state.recording?.status?.state===e.Enums.RecordingStatus.Idle),a?await(t?.startRecording()):await(t?.stopRecording())},learn:({options:e})=>i.state.recording?.status?{...e.getJson(),state:i.state.recording.status.state}:void 0},[vr.RecordSwitchDisk]:{name:"Recording: Switch disk",options:{},callback:async()=>{await(t?.switchRecordingDisk())}},[vr.RecordFilename]:{name:"Recording: Set filename",options:{filename:{id:"filename",label:"Filename",type:"textinput",default:"",useVariables:!0}},callback:async({options:e})=>{const r=await e.getParsedString("filename");await(t?.setRecordingSettings({filename:r}))},learn:({options:e})=>i.state.recording?.properties?{...e.getJson(),filename:i.state.recording?.properties.filename}:void 0},[vr.RecordISO]:{name:"Recording: Enable/Disable ISO",options:{recordISO:{id:"recordISO",type:"dropdown",label:"Record ISO",default:"toggle",choices:_}},callback:async({options:e})=>{let r="true"===e.getPlainString("recordISO");"toggle"===e.getPlainString("recordISO")&&(r=!i.state.recording?.recordAllInputs),await(t?.setEnableISORecording(r))},learn:({options:e})=>null!=i.state.recording?.recordAllInputs?{...e.getJson(),state:i.state.recording.recordAllInputs}:void 0}}:{[vr.RecordStartStop]:void 0,[vr.RecordSwitchDisk]:void 0,[vr.RecordFilename]:void 0,[vr.RecordISO]:void 0}}function Lr(e,t,r){return t.DSKs?{[vr.DSKSource]:{name:"Downstream key: Set inputs",options:{key:Ot(t),fill:Ut(t,r.state),cut:Gt(t,r.state)},callback:async({options:t})=>{await Promise.all([e?.setDownstreamKeyFillSource(t.getPlainNumber("fill"),t.getPlainNumber("key")),e?.setDownstreamKeyCutSource(t.getPlainNumber("cut"),t.getPlainNumber("key"))])},learn:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return t?.sources?{...e.getJson(),fill:t.sources.fillSource,cut:t.sources.cutSource}:void 0}},[vr.DSKSourceVariables]:{name:"Downstream key: Set inputs from variables",options:{key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},fill:{type:"textinput",id:"fill",label:"Fill Source",default:"0",useVariables:!0},cut:{type:"textinput",id:"cut",label:"Key Source",default:"0",useVariables:!0}},callback:async({options:t})=>{const r=await t.getParsedNumber("key")-1,i=await t.getParsedNumber("fill"),a=await t.getParsedNumber("cut");isNaN(r)||isNaN(i)||isNaN(a)||await Promise.all([e?.setDownstreamKeyFillSource(i,r),e?.setDownstreamKeyCutSource(a,r)])},learn:async({options:e})=>{const t=await e.getParsedNumber("key")-1,i=Tr(r.state,t);return i?.sources?{...e.getJson(),fill:i.sources.fillSource+"",cut:i.sources.cutSource+""}:void 0}},[vr.DSKRate]:{name:"Downstream key: Set Rate",options:{key:Ot(t),rate:xt("Rate")},callback:async({options:t})=>{await(e?.setDownstreamKeyRate(t.getPlainNumber("rate"),t.getPlainNumber("key")))},learn:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return t?.properties?{...e.getJson(),rate:t.properties.rate}:void 0}},[vr.DSKMask]:{name:"Downstream key: Set Mask",options:{key:Ot(t),...Rt()},callback:async({options:t})=>{const r=t.getPlainNumber("key"),i={},a=t.getRaw("properties");a&&Array.isArray(a)&&(a.includes("maskEnabled")&&(i.enabled=t.getPlainBoolean("maskEnabled")),a.includes("maskTop")&&(i.top=1e3*t.getPlainNumber("maskTop")),a.includes("maskBottom")&&(i.bottom=1e3*t.getPlainNumber("maskBottom")),a.includes("maskLeft")&&(i.left=1e3*t.getPlainNumber("maskLeft")),a.includes("maskRight")&&(i.right=1e3*t.getPlainNumber("maskRight"))),0!==Object.keys(i).length&&await(e?.setDownstreamKeyMaskSettings(i,r))},learn:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return t?.properties?.mask?{...e.getJson(),maskEnabled:t.properties.mask.enabled,maskTop:t.properties.mask.top/1e3,maskBottom:t.properties.mask.bottom/1e3,maskLeft:t.properties.mask.left/1e3,maskRight:t.properties.mask.right/1e3}:void 0}},[vr.DSKPreMultipliedKey]:{name:"Downstream key: Set Pre Multiplied Key",options:{key:Ot(t),...Dt()},callback:async({options:t})=>{const r=t.getPlainNumber("key"),i={},a=t.getRaw("properties");a&&Array.isArray(a)&&(a.includes("preMultiply")&&(i.preMultiply=t.getPlainBoolean("preMultiply")),a.includes("clip")&&(i.clip=10*t.getPlainNumber("clip")),a.includes("gain")&&(i.gain=10*t.getPlainNumber("gain")),a.includes("invert")&&(i.invert=t.getPlainBoolean("invert"))),0!==Object.keys(i).length&&await(e?.setDownstreamKeyGeneralProperties(i,r))},learn:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return t?.properties?{...e.getJson(),preMultiply:t.properties.preMultiply,clip:t.properties.clip/10,gain:t.properties.gain/10,invert:t.properties.invert}:void 0}},[vr.DSKAuto]:{name:"Downstream key: Run AUTO Transition",options:{downstreamKeyerId:{type:"dropdown",id:"downstreamKeyerId",label:"DSK",default:0,choices:W(t)}},callback:async({options:t})=>{await(e?.autoDownstreamKey(t.getPlainNumber("downstreamKeyerId")))}},[vr.DSKOnAir]:{name:"Downstream key: Set OnAir",options:{onair:{id:"onair",type:"dropdown",label:"On Air",default:"true",choices:R},key:Ot(t)},callback:async({options:t})=>{const i=t.getPlainNumber("key");if("toggle"===t.getPlainString("onair")){const t=Tr(r.state,i);await(e?.setDownstreamKeyOnAir(!t?.onAir,i))}else await(e?.setDownstreamKeyOnAir("true"===t.getPlainString("onair"),i))},learn:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return t?{...e.getJson(),onair:t.onAir?"true":"false"}:void 0}},[vr.DSKTie]:{name:"Downstream key: Set Tied",options:{state:{id:"state",type:"dropdown",label:"State",default:"true",choices:_},key:Ot(t)},callback:async({options:t})=>{const i=t.getPlainNumber("key");if("toggle"===t.getPlainString("state")){const t=Tr(r.state,i);await(e?.setDownstreamKeyTie(!t?.properties?.tie,i))}else await(e?.setDownstreamKeyTie("true"===t.getPlainString("state"),i))},learn:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return t?.properties?{...e.getJson(),state:t.properties.tie?"true":"false"}:void 0}}}:{[vr.DSKSource]:void 0,[vr.DSKSourceVariables]:void 0,[vr.DSKRate]:void 0,[vr.DSKMask]:void 0,[vr.DSKPreMultipliedKey]:void 0,[vr.DSKAuto]:void 0,[vr.DSKOnAir]:void 0,[vr.DSKTie]:void 0}}function jr(e,t,r){return 0===t.outputs.length?{[vr.Aux]:void 0,[vr.AuxVariables]:void 0}:{[vr.Aux]:{name:"Aux/Output: Set source",options:{aux:jt(t),input:zt(t,r.state)},callback:async({options:t})=>{await(e?.setAuxSource(t.getPlainNumber("input"),t.getPlainNumber("aux")))},learn:({options:e})=>{const t=r.state.video.auxilliaries[e.getPlainNumber("aux")];return void 0!==t?{...e.getJson(),input:t}:void 0}},[vr.AuxVariables]:{name:"Aux/Output: Set source from variables",options:{aux:{type:"textinput",id:"aux",label:"AUX",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},callback:async({options:t})=>{const r=await t.getParsedNumber("aux"),i=await t.getParsedNumber("input");isNaN(r)||isNaN(i)||await(e?.setAuxSource(i,r-1))}}}}const Kr=[{id:"ignore",label:"Unchanged"},{id:"toggle",label:"Toggle"},{id:"single",label:"Single"},{id:"quad",label:"Quad"}];function Ur(r,i,a){return i.MVs?{[vr.MultiviewerWindowSource]:{name:"Multiviewer: Change window source",options:{multiViewerId:Kt(i),windowIndex:ir(i),source:rr(i,a.state)},callback:async({options:e})=>{await(r?.setMultiViewerWindowSource(e.getPlainNumber("source"),e.getPlainNumber("multiViewerId"),e.getPlainNumber("windowIndex")))},learn:({options:e})=>{const t=Rr(a.state,e.getPlainNumber("multiViewerId"),e.getPlainNumber("windowIndex"));return t?{...e.getJson(),source:t.source}:void 0}},[vr.MultiviewerWindowSourceVariables]:{name:"Multiviewer: Change window source from variables",options:{multiViewerId:{type:"textinput",id:"multiViewerId",label:"MV",default:"1",useVariables:!0},windowIndex:{type:"textinput",id:"windowIndex",label:"Window #",default:"1",useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"1",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("multiViewerId")-1,i=await e.getParsedNumber("windowIndex")-1,a=await e.getParsedNumber("source");isNaN(t)||isNaN(i)||isNaN(a)||await(r?.setMultiViewerWindowSource(a,t,i))},learn:async({options:e})=>{const t=await e.getParsedNumber("multiViewerId")-1,r=await e.getParsedNumber("windowIndex")-1,i=Rr(a.state,t,r);return i?{...e.getJson(),source:i.source+""}:void 0}},[vr.MultiviewerLayout]:{name:"Multiviewer: Change layout",options:{multiViewerId:{type:"textinput",id:"multiViewerId",label:"MV",default:"1",useVariables:!0},topLeft:{id:"topLeft",type:"dropdown",label:"Top left",choices:Kr,default:"ignore"},topRight:{id:"topRight",type:"dropdown",label:"Top right",choices:Kr,default:"ignore"},bottomLeft:{id:"bottomLeft",type:"dropdown",label:"Bottom left",choices:Kr,default:"ignore"},bottomRight:{id:"bottomRight",type:"dropdown",label:"Bottom right",choices:Kr,default:"ignore"}},callback:async({options:i})=>{const o=await i.getParsedNumber("multiViewerId")-1,n=Or(a.state,o);let s=n?.properties?.layout??e.Enums.MultiViewerLayout.Default;const l=(e,r)=>{switch("toggle"===e&&(e=s&r?"single":"quad"),e){case"ignore":break;case"single":s=~(~s|r);break;case"quad":s|=r;break;default:(0,t.assertNever)(e)}};l(i.getPlainString("topLeft"),e.Enums.MultiViewerLayout.TopLeftSmall),l(i.getPlainString("topRight"),e.Enums.MultiViewerLayout.TopRightSmall),l(i.getPlainString("bottomLeft"),e.Enums.MultiViewerLayout.BottomLeftSmall),l(i.getPlainString("bottomRight"),e.Enums.MultiViewerLayout.BottomRightSmall),isNaN(o)||isNaN(s)||await(r?.setMultiViewerProperties({layout:s},o))},learn:async({options:t})=>{const r=await t.getParsedNumber("multiViewerId")-1,i=Or(a.state,r);if(i?.properties){const r=i.properties.layout,a=e=>r&e?"quad":"single";return{...t.getJson(),topLeft:a(e.Enums.MultiViewerLayout.TopLeftSmall),topRight:a(e.Enums.MultiViewerLayout.TopRightSmall),bottomLeft:a(e.Enums.MultiViewerLayout.BottomLeftSmall),bottomRight:a(e.Enums.MultiViewerLayout.BottomRightSmall)}}}}}:{[vr.MultiviewerWindowSource]:void 0,[vr.MultiviewerWindowSourceVariables]:void 0,[vr.MultiviewerLayout]:void 0}}function Gr(t,r,i){return r.media.players?{[vr.MediaPlayerSource]:{name:"Media player: Set source",options:{mediaplayer:ar(r),source:or(r,i.state)},callback:async({options:r})=>{const i=r.getPlainNumber("source");i>=re?await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Clip,clipIndex:i-re},r.getPlainNumber("mediaplayer"))):await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Still,stillIndex:i},r.getPlainNumber("mediaplayer")))},learn:({options:e})=>{const t=i.state.media.players[e.getPlainNumber("mediaplayer")];return t?{...e.getJson(),source:t.sourceType?t.stillIndex:t.clipIndex+re}:void 0}},[vr.MediaPlayerSourceVariables]:{name:"Media player: Set source from variables",options:{mediaplayer:{id:"mediaplayer",type:"textinput",label:"Media Player",default:"1",useVariables:!0},isClip:r.media.clips>0?{type:"checkbox",id:"isClip",label:"Is clip",default:!1}:void 0,slot:{id:"slot",type:"textinput",label:"Slot number or item name",default:"1",useVariables:!0}},callback:async({options:a})=>{const[o,n]=await Promise.all([a.getParsedNumber("mediaplayer"),a.getParsedString("slot")]);if(r.media.clips>0&&a.getPlainBoolean("isClip")){let r=Number(n)-1;if(isNaN(r)&&(r=i.state.media.clipPool.findIndex((e=>e?.name==n))),-1==r)return void console.warn(`Media player: Clip "${n}" not found`);await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Clip,clipIndex:r},o-1))}else{let r=Number(n)-1;if(isNaN(r)&&(r=i.state.media.stillPool.findIndex((e=>e?.fileName==n))),-1==r)return void console.warn(`Media player: Still "${n}" not found`);await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Still,stillIndex:r},o-1))}},learn:async({options:t})=>{const r=await t.getParsedNumber("mediaplayer"),a=i.state.media.players[r-1];if(a){const r=a.sourceType===e.Enums.MediaSourceType.Clip;return{...t.getJson(),isClip:r,source:r?a.clipIndex:a.stillIndex}}}},[vr.MediaPlayerCycle]:{name:"Media player: Cycle source",options:{mediaplayer:ar(r),direction:{type:"dropdown",id:"direction",label:"Direction",default:"next",choices:[{id:"next",label:"Next"},{id:"previous",label:"Previous"}]}},callback:async({options:r})=>{const a=r.getPlainNumber("mediaplayer"),o="next"===r.getPlainString("direction")?1:-1,n=(0,At.O2)(i.state,a);if(n?.sourceType==e.Enums.MediaSourceType.Still){const r=i.state.media.stillPool.length;let s=n.stillIndex+o;s>=r&&(s=0),s<0&&(s=r-1),await(t?.setMediaPlayerSource({sourceType:e.Enums.MediaSourceType.Still,stillIndex:s},a))}}},[vr.MediaCaptureStill]:{name:"Media player: Capture still",options:{},callback:async()=>{await(t?.captureMediaPoolStill())}},[vr.MediaDeleteStill]:{name:"Media player: Delete still",options:{slot:{id:"slot",type:"textinput",label:"Slot",default:"1",useVariables:!0}},callback:async({options:e})=>{const r=await e.getParsedNumber("slot");await(t?.clearMediaPoolStill(r-1))}}}:{[vr.MediaPlayerSource]:void 0,[vr.MediaPlayerSourceVariables]:void 0,[vr.MediaPlayerCycle]:void 0,[vr.MediaCaptureStill]:void 0,[vr.MediaDeleteStill]:void 0}}function zr(e,t,r){return t.media.players?{[vr.SaveStartupState]:{name:"Startup State: Save",options:{},callback:async()=>{await(e?.saveStartupState())}},[vr.ClearStartupState]:{name:"Startup State: Clear",options:{},callback:async()=>{await(e?.clearStartupState())}},[vr.InputName]:{name:"Input: Set name",options:{source:dr(t,r.state),short_enable:{id:"short_enable",label:"Set short name",type:"checkbox",default:!0},short_value:{id:"short_value",label:"Short name",type:"textinput",default:"",tooltip:"Max 4 characters. Supports variables",useVariables:!0},long_enable:{id:"long_enable",label:"Set long name",type:"checkbox",default:!0},long_value:{id:"long_value",label:"Long name",type:"textinput",default:"",tooltip:"Max 24 characters. Supports variables",useVariables:!0}},callback:async({options:t})=>{const r=t.getPlainNumber("source"),i=t.getPlainBoolean("short_enable"),a=t.getPlainBoolean("long_enable"),o={};i&&(o.shortName=await t.getParsedString("short_value")),a&&(o.longName=await t.getParsedString("long_value")),await Promise.all(["string"!=typeof o.longName||e?.hasInternalMultiviewerLabelGeneration()?void 0:e?.drawMultiviewerLabel(r,o.longName),Object.keys(o).length?e?.setInputSettings(o,r):void 0])},learn:({options:e})=>{const t=e.getPlainNumber("source"),i=r.state.inputs[t];return i?{...e.getJson(),long_value:i.longName,short_value:i.shortName}:void 0}}}:{[vr.SaveStartupState]:void 0,[vr.ClearStartupState]:void 0,[vr.InputName]:void 0}}function Wr(t,r,i){return r.SSrc?{[vr.SuperSourceArt]:{name:"SuperSource: Set art properties",options:{ssrcId:Ht(r),...Xt(r,i.state,!0)},callback:async({options:a})=>{const o=a.getRaw("ssrcId")&&r.SSrc>1?Number(a.getRaw("ssrcId")):0,n={},s=a.getRaw("properties");if(s&&Array.isArray(s)){if(s.includes("fill")&&(n.artFillSource=a.getPlainNumber("fill")),s.includes("key")&&(n.artCutSource=a.getPlainNumber("key")),s.includes("artOption")){const t=a.getRaw("artOption");if("toggle"===t){const t=i.state.video.superSources[o];n.artOption=t?.properties?.artOption===e.Enums.SuperSourceArtOption.Background?e.Enums.SuperSourceArtOption.Foreground:e.Enums.SuperSourceArtOption.Background}else"unchanged"!==t&&(n.artOption=Number(a.getRaw("artOption")))}s.includes("artPreMultiplied")&&(n.artPreMultiplied=a.getPlainBoolean("artPreMultiplied")),s.includes("artClip")&&(n.artClip=10*a.getPlainNumber("artClip")),s.includes("artGain")&&(n.artGain=10*a.getPlainNumber("artGain")),s.includes("artInvertKey")&&(n.artInvertKey=a.getPlainBoolean("artInvertKey"))}0!==Object.keys(n).length&&await(t?.setSuperSourceProperties(n,o))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,a=i.state.video.superSources?.[t]?.properties;return a?{...e.getJson(),fill:a.artFillSource,key:a.artCutSource,artOption:a.artOption,artPreMultiplied:a.artPreMultiplied,artClip:a.artClip/10,artGain:a.artGain/10,artInvertKey:a.artInvertKey}:void 0}},[vr.SuperSourceArtVariables]:{name:"SuperSource: Set art sources from variables",options:{ssrcId:Ht(r),...Qt()},callback:async({options:e})=>{const i=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,a={},o=[],n=(e,t)=>o.push(t.then((t=>{a[e]=t}))),s=e.getRaw("properties");s&&Array.isArray(s)&&(s.includes("fill")&&n("artFillSource",e.getParsedNumber("fill")),s.includes("key")&&n("artCutSource",e.getParsedNumber("key"))),await Promise.all(o),0!==Object.keys(a).length&&await(t?.setSuperSourceProperties(a,i))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,a=i.state.video.superSources?.[t]?.properties;return a?{...e.getJson(),fill:a.artFillSource+"",key:a.artCutSource+""}:void 0}},[vr.SuperSourceBoxSource]:{name:"SuperSource: Set box source",options:{ssrcId:Ht(r),boxIndex:Wt(),source:tr(r,i.state)},callback:async({options:e})=>{await(t?.setSuperSourceBoxSettings({source:e.getPlainNumber("source")},e.getPlainNumber("boxIndex"),e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,a=e.getPlainNumber("boxIndex"),o=i.state.video.superSources?.[t]?.boxes[a];return o?{...e.getJson(),source:o.source}:void 0}},[vr.SuperSourceBoxSourceVaraibles]:{name:"SuperSource: Set box source from variables",options:{ssrcId:r.SSrc>1?{type:"textinput",id:"ssrcId",label:"Super Source",default:"1",useVariables:!0}:void 0,boxIndex:{type:"textinput",id:"boxIndex",label:"Box #",default:"1",useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"1",useVariables:!0}},callback:async({options:e})=>{const i=e.getRaw("ssrcId")&&r.SSrc>1?Number(await e.getParsedNumber("ssrcId"))-1:0,a=await e.getParsedNumber("boxIndex")-1,o=await e.getParsedNumber("source");isNaN(i)||isNaN(a)||isNaN(o)||await(t?.setSuperSourceBoxSettings({source:o},a,i))},learn:async({options:e})=>{const t=e.getRaw("ssrcId")&&r.SSrc>1?Number(await e.getParsedNumber("ssrcId"))-1:0,a=await e.getParsedNumber("boxIndex")-1,o=i.state.video.superSources?.[t]?.boxes[a];return o?{...e.getJson(),source:o.source+""}:void 0}},[vr.SuperSourceBoxOnAir]:{name:"SuperSource: Set box enabled",options:{ssrcId:Ht(r),boxIndex:Wt(),onair:{id:"onair",type:"dropdown",label:"On Air",default:"true",choices:R}},callback:async({options:e})=>{const a=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,o=e.getPlainNumber("boxIndex");if("toggle"===e.getRaw("onair")){const e=Nr(i.state,o,a);await(t?.setSuperSourceBoxSettings({enabled:!e?.enabled},o,a))}else await(t?.setSuperSourceBoxSettings({enabled:"true"===e.getRaw("onair")},o,a))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,a=e.getPlainNumber("boxIndex"),o=i.state.video.superSources?.[t]?.boxes[a];return o?{...e.getJson(),onair:o.enabled?"true":"false"}:void 0}},[vr.SuperSourceBoxProperties]:{name:"SuperSource: Change box properties",options:{ssrcId:Ht(r),boxIndex:Wt(),...Jt(r,i.state)},callback:async({options:e})=>{const a=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,o=e.getPlainNumber("boxIndex"),n={},s=e.getRaw("properties");if(s&&Array.isArray(s)){if(s.includes("onair"))if("toggle"===e.getPlainString("onair")){const e=Nr(i.state,o,a);n.enabled=!e?.enabled}else n.enabled="true"===e.getPlainString("onair");s.includes("source")&&(n.source=e.getPlainNumber("source")),s.includes("size")&&(n.size=1e3*e.getPlainNumber("size")),s.includes("x")&&(n.x=100*e.getPlainNumber("x")),s.includes("y")&&(n.y=100*e.getPlainNumber("y")),s.includes("cropEnable")&&(n.cropped=e.getPlainBoolean("cropEnable")),s.includes("cropTop")&&(n.cropTop=1e3*e.getPlainNumber("cropTop")),s.includes("cropBottom")&&(n.cropBottom=1e3*e.getPlainNumber("cropBottom")),s.includes("cropLeft")&&(n.cropLeft=1e3*e.getPlainNumber("cropLeft")),s.includes("cropRight")&&(n.cropRight=1e3*e.getPlainNumber("cropRight"))}0!==Object.keys(n).length&&await(t?.setSuperSourceBoxSettings(n,o,a))},learn:({options:e})=>{const t=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,a=e.getPlainNumber("boxIndex"),o=i.state.video.superSources?.[t]?.boxes[a];return o?{...e.getJson(),onair:o.enabled?"true":"false",source:o.source,size:o.size/1e3,x:o.x/100,y:o.y/100,cropEnable:o.cropped,cropTop:o.cropTop/1e3,cropBottom:o.cropBottom/1e3,cropLeft:o.cropLeft/1e3,cropRight:o.cropRight/1e3}:void 0}},[vr.SuperSourceBoxPropertiesDelta]:{name:"SuperSource: Offset box properties",options:{ssrcId:Ht(r),boxIndex:Wt(),...Yt()},callback:async({options:e})=>{const a=e.getRaw("ssrcId")&&r.SSrc>1?Number(e.getRaw("ssrcId")):0,o=e.getPlainNumber("boxIndex"),n={},s=Nr(i.state,o,a),l=e.getRaw("properties");s&&l&&Array.isArray(l)&&(l.includes("size")&&(n.size=ne(0,1e3,s.size+1e3*e.getPlainNumber("size"))),l.includes("x")&&(n.x=ne(-4800,4800,s.x+100*e.getPlainNumber("x"))),l.includes("y")&&(n.y=ne(-2700,2700,s.y+100*e.getPlainNumber("y"))),l.includes("cropTop")&&(n.cropTop=ne(0,18e3,s.cropTop+1e3*e.getPlainNumber("cropTop"))),l.includes("cropBottom")&&(n.cropBottom=ne(0,18e3,s.cropBottom+1e3*e.getPlainNumber("cropBottom"))),l.includes("cropLeft")&&(n.cropLeft=ne(0,32e3,s.cropLeft+1e3*e.getPlainNumber("cropLeft"))),l.includes("cropRight")&&(n.cropRight=ne(0,32e3,s.cropRight+1e3*e.getPlainNumber("cropRight")))),0!==Object.keys(n).length&&await(t?.setSuperSourceBoxSettings(n,o,a))}}}:{[vr.SuperSourceArt]:void 0,[vr.SuperSourceArtVariables]:void 0,[vr.SuperSourceBoxSource]:void 0,[vr.SuperSourceBoxSourceVaraibles]:void 0,[vr.SuperSourceBoxOnAir]:void 0,[vr.SuperSourceBoxProperties]:void 0,[vr.SuperSourceBoxPropertiesDelta]:void 0}}function Hr(e,t,r){return t.USKs?{[vr.USKSource]:{name:"Upstream key: Set inputs",options:{mixeffect:Nt(t,0),key:Ft(t),fill:Ut(t,r.state),cut:Gt(t,r.state)},callback:async({options:t})=>{await Promise.all([e?.setUpstreamKeyerFillSource(t.getPlainNumber("fill"),t.getPlainNumber("mixeffect"),t.getPlainNumber("key")),e?.setUpstreamKeyerCutSource(t.getPlainNumber("cut"),t.getPlainNumber("mixeffect"),t.getPlainNumber("key"))])},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?{...e.getJson(),cut:t.cutSource,fill:t.fillSource}:void 0}},[vr.USKType]:{name:"Upstream key: Set type",options:{mixeffect:Nt(t,0),key:Ft(t),type:_t()},callback:async({options:t})=>{await(e?.setUpstreamKeyerType({mixEffectKeyType:t.getPlainNumber("type")},t.getPlainNumber("mixeffect"),t.getPlainNumber("key")))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?{...e.getJson(),type:t.mixEffectKeyType}:void 0}},[vr.USKSourceVariables]:{name:"Upstream key: Set inputs from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},fill:{type:"textinput",id:"fill",label:"Fill Source",default:"0",useVariables:!0},cut:{type:"textinput",id:"cut",label:"Key Source",default:"0",useVariables:!0}},callback:async({options:t})=>{const r=await t.getParsedNumber("mixeffect")-1,i=await t.getParsedNumber("key")-1,a=await t.getParsedNumber("fill"),o=await t.getParsedNumber("cut");isNaN(r)||isNaN(i)||isNaN(a)||isNaN(o)||await Promise.all([e?.setUpstreamKeyerFillSource(a,r,i),e?.setUpstreamKeyerCutSource(o,r,i)])},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("key")-1,a=Mr(r.state,t,i);return a?{...e.getJson(),cut:a.cutSource+"",fill:a.fillSource+""}:void 0}},[vr.USKOnAir]:{name:"Upstream key: Set OnAir",options:{onair:{id:"onair",type:"dropdown",label:"On Air",default:"true",choices:R},mixeffect:Nt(t,0),key:Ft(t)},callback:async({options:t})=>{const i=t.getPlainNumber("mixeffect"),a=t.getPlainNumber("key");if("toggle"===t.getPlainString("onair")){const t=Mr(r.state,i,a);await(e?.setUpstreamKeyerOnAir(!t?.onAir,i,a))}else await(e?.setUpstreamKeyerOnAir("true"===t.getPlainString("onair"),i,a))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?{...e.getJson(),onair:t.onAir?"true":"false"}:void 0}},[vr.USKMaskLumaChromaPattern]:{name:"Upstream key: Set Mask (Luma, Chroma, Pattern)",options:{mixeffect:Nt(t,0),key:Ft(t),...Vt()},callback:async({options:t})=>{const r=t.getPlainNumber("key"),i=t.getPlainNumber("mixeffect"),a={},o=t.getRaw("properties");o&&Array.isArray(o)&&(o.includes("maskEnabled")&&(a.maskEnabled=t.getPlainBoolean("maskEnabled")),o.includes("maskTop")&&(a.maskTop=1e3*t.getPlainNumber("maskTop")),o.includes("maskBottom")&&(a.maskBottom=1e3*t.getPlainNumber("maskBottom")),o.includes("maskLeft")&&(a.maskLeft=1e3*t.getPlainNumber("maskLeft")),o.includes("maskRight")&&(a.maskRight=1e3*t.getPlainNumber("maskRight"))),0!==Object.keys(a).length&&await(e?.setUpstreamKeyerMaskSettings(a,i,r))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.maskSettings?{...e.getJson(),maskEnabled:t.maskSettings.maskEnabled,maskTop:t.maskSettings.maskTop/1e3,maskBottom:t.maskSettings.maskBottom/1e3,maskLeft:t.maskSettings.maskLeft/1e3,maskRight:t.maskSettings.maskRight/1e3}:void 0}},[vr.USKFlyKeyLumaChromaPattern]:{name:"Upstream key: Set Flying Key (Luma, Chroma, Pattern)",options:{mixeffect:Nt(t,0),key:Ft(t),...yr()},callback:async({options:t})=>{const r=t.getPlainNumber("key"),i=t.getPlainNumber("mixeffect"),a={},o={},n=t.getRaw("properties");n&&Array.isArray(n)&&(n.includes("flyEnabled")&&(a.flyEnabled=t.getPlainBoolean("flyEnabled")),n.includes("positionX")&&(o.positionX=1e3*t.getPlainNumber("positionX")),n.includes("positionY")&&(o.positionY=1e3*t.getPlainNumber("positionY")),n.includes("sizeX")&&(o.sizeX=1e3*t.getPlainNumber("sizeX")),n.includes("sizeY")&&(o.sizeY=1e3*t.getPlainNumber("sizeY"))),0!==Object.keys(o).length&&0!==Object.keys(a).length&&(await(e?.setUpstreamKeyerDVESettings(o,i,r)),await(e?.setUpstreamKeyerType(a,i,r)))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.dveSettings?{...e.getJson(),flyEnabled:t.flyEnabled,positionX:t.dveSettings.positionX/1e3,positionY:t.dveSettings.positionY/1e3,sizeX:t.dveSettings.sizeX/1e3,sizeY:t.dveSettings.sizeY/1e3}:void 0}},[vr.USKFlyKeyLumaChromaPatternVariables]:{name:"Upstream key: Set Flying Key (Luma, Chroma, Pattern) from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},...Sr()},callback:async({options:t})=>{const r=await t.getParsedNumber("mixeffect")-1,i=await t.getParsedNumber("key")-1,a={},o={},n=t.getRaw("properties");n&&Array.isArray(n)&&(n.includes("flyEnabled")&&(a.flyEnabled=await t.getParsedBoolean("flyEnabled")),n.includes("positionX")&&(o.positionX=1e3*await t.getParsedNumber("positionX")),n.includes("positionY")&&(o.positionY=1e3*await t.getParsedNumber("positionY")),n.includes("sizeX")&&(o.sizeX=1e3*await t.getParsedNumber("sizeX")),n.includes("sizeY")&&(o.sizeY=1e3*await t.getParsedNumber("sizeY"))),isNaN(r)||isNaN(i)||0!==Object.keys(o).length&&(await(e?.setUpstreamKeyerDVESettings(o,r,i)),0!==Object.keys(a).length&&await(e?.setUpstreamKeyerType(a,r,i)))},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("key")-1,a=Mr(r.state,t,i);return a?.dveSettings?{...e.getJson(),flyEnabled:a.flyEnabled+"",positionX:a.dveSettings.positionX/1e3+"",positionY:a.dveSettings.positionY/1e3+"",sizeX:a.dveSettings.sizeX/1e3+"",sizeY:a.dveSettings.sizeY/1e3+""}:void 0}}}:{[vr.USKSource]:void 0,[vr.USKType]:void 0,[vr.USKSourceVariables]:void 0,[vr.USKOnAir]:void 0,[vr.USKMaskLumaChromaPattern]:void 0,[vr.USKFlyKeyLumaChromaPattern]:void 0,[vr.USKFlyKeyLumaChromaPatternVariables]:void 0}}function qr(e,t,r){return{[vr.FadeToBlackAuto]:{name:"Fade to black: Run AUTO Transition",options:{mixeffect:Nt(t,0)},callback:async({options:t})=>{await(e?.fadeToBlack(t.getPlainNumber("mixeffect")))}},[vr.FadeToBlackRate]:{name:"Fade to black: Change rate",options:{mixeffect:Nt(t,0),rate:xt("Rate")},callback:async({options:t})=>{await(e?.setFadeToBlackRate(t.getPlainNumber("rate"),t.getPlainNumber("mixeffect")))},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect"));return t?.fadeToBlack?{...e.getJson(),rate:t.fadeToBlack.rate}:void 0}}}}function Jr(e,t,r){return t.USKs&&t.DVEs?{[vr.USKDVEProperties]:{name:"Upstream key: Change DVE properties",options:{mixeffect:Nt(t,0),key:Ft(t),...$t()},callback:async({options:t})=>{const r=t.getPlainNumber("key"),i=t.getPlainNumber("mixeffect"),a={},o=t.getRaw("properties");o&&Array.isArray(o)&&(o.includes("maskEnabled")&&(a.maskEnabled=t.getPlainBoolean("maskEnabled")),o.includes("maskTop")&&(a.maskTop=1e3*t.getPlainNumber("maskTop")),o.includes("maskBottom")&&(a.maskBottom=1e3*t.getPlainNumber("maskBottom")),o.includes("maskLeft")&&(a.maskLeft=1e3*t.getPlainNumber("maskLeft")),o.includes("maskRight")&&(a.maskRight=1e3*t.getPlainNumber("maskRight")),o.includes("sizeX")&&(a.sizeX=1e3*t.getPlainNumber("sizeX")),o.includes("sizeY")&&(a.sizeY=1e3*t.getPlainNumber("sizeY")),o.includes("positionX")&&(a.positionX=1e3*t.getPlainNumber("positionX")),o.includes("positionY")&&(a.positionY=1e3*t.getPlainNumber("positionY")),o.includes("rotation")&&(a.rotation=t.getPlainNumber("rotation")),o.includes("borderOuterWidth")&&(a.borderOuterWidth=100*t.getPlainNumber("borderOuterWidth")),o.includes("borderInnerWidth")&&(a.borderInnerWidth=100*t.getPlainNumber("borderInnerWidth")),o.includes("borderOuterSoftness")&&(a.borderOuterSoftness=t.getPlainNumber("borderOuterSoftness")),o.includes("borderInnerSoftness")&&(a.borderInnerSoftness=t.getPlainNumber("borderInnerSoftness")),o.includes("borderBevelSoftness")&&(a.borderBevelSoftness=t.getPlainNumber("borderBevelSoftness")),o.includes("borderBevelPosition")&&(a.borderBevelPosition=t.getPlainNumber("borderBevelPosition")),o.includes("borderOpacity")&&(a.borderOpacity=t.getPlainNumber("borderOpacity")),o.includes("borderHue")&&(a.borderHue=10*t.getPlainNumber("borderHue")),o.includes("borderSaturation")&&(a.borderSaturation=10*t.getPlainNumber("borderSaturation")),o.includes("borderLuma")&&(a.borderLuma=10*t.getPlainNumber("borderLuma")),o.includes("lightSourceDirection")&&(a.lightSourceDirection=10*t.getPlainNumber("lightSourceDirection")),o.includes("lightSourceAltitude")&&(a.lightSourceAltitude=t.getPlainNumber("lightSourceAltitude")),o.includes("borderEnabled")&&(a.borderEnabled=t.getPlainBoolean("borderEnabled")),o.includes("shadowEnabled")&&(a.shadowEnabled=t.getPlainBoolean("shadowEnabled")),o.includes("borderBevel")&&(a.borderBevel=t.getPlainNumber("borderBevel")),o.includes("rate")&&(a.rate=t.getPlainNumber("rate"))),0!==Object.keys(a).length&&await(e?.setUpstreamKeyerDVESettings(a,i,r))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.dveSettings?{...e.getJson(),maskEnabled:t.dveSettings.maskEnabled,maskTop:t.dveSettings.maskTop/1e3,maskBottom:t.dveSettings.maskBottom/1e3,maskLeft:t.dveSettings.maskLeft/1e3,maskRight:t.dveSettings.maskRight/1e3,sizeX:t.dveSettings.sizeX/1e3,sizeY:t.dveSettings.sizeY/1e3,positionX:t.dveSettings.positionX/1e3,positionY:t.dveSettings.positionY/1e3,rotation:t.dveSettings.rotation,borderOuterWidth:t.dveSettings.borderOuterWidth/100,borderInnerWidth:t.dveSettings.borderInnerWidth/100,borderOuterSoftness:t.dveSettings.borderOuterSoftness,borderInnerSoftness:t.dveSettings.borderInnerSoftness,borderBevelSoftness:t.dveSettings.borderBevelSoftness,borderBevelPosition:t.dveSettings.borderBevelPosition,borderOpacity:t.dveSettings.borderOpacity,borderHue:t.dveSettings.borderHue/10,borderSaturation:t.dveSettings.borderSaturation/10,borderLuma:t.dveSettings.borderLuma/10,lightSourceDirection:t.dveSettings.lightSourceDirection/10,lightSourceAltitude:t.dveSettings.lightSourceAltitude,borderEnabled:t.dveSettings.borderEnabled,shadowEnabled:t.dveSettings.shadowEnabled,borderBevel:t.dveSettings.borderBevel,rate:t.dveSettings.rate}:void 0}},[vr.USKDVEPropertiesVariables]:{name:"Upstream key: Change DVE properties from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},...Bt()},callback:async({options:t})=>{const r=await t.getParsedNumber("mixeffect")-1,i=await t.getParsedNumber("key")-1,a={},o=t.getRaw("properties");o&&Array.isArray(o)&&(o.includes("maskEnabled")&&(a.maskEnabled=await t.getParsedBoolean("maskEnabled")),o.includes("maskTop")&&(a.maskTop=1e3*await t.getParsedNumber("maskTop")),o.includes("maskBottom")&&(a.maskBottom=1e3*await t.getParsedNumber("maskBottom")),o.includes("maskLeft")&&(a.maskLeft=1e3*await t.getParsedNumber("maskLeft")),o.includes("maskRight")&&(a.maskRight=1e3*await t.getParsedNumber("maskRight")),o.includes("sizeX")&&(a.sizeX=1e3*await t.getParsedNumber("sizeX")),o.includes("sizeY")&&(a.sizeY=1e3*await t.getParsedNumber("sizeY")),o.includes("positionX")&&(a.positionX=1e3*await t.getParsedNumber("positionX")),o.includes("positionY")&&(a.positionY=1e3*await t.getParsedNumber("positionY")),o.includes("rotation")&&(a.rotation=await t.getParsedNumber("rotation")),o.includes("borderOuterWidth")&&(a.borderOuterWidth=100*await t.getParsedNumber("borderOuterWidth")),o.includes("borderInnerWidth")&&(a.borderInnerWidth=100*await t.getParsedNumber("borderInnerWidth")),o.includes("borderOuterSoftness")&&(a.borderOuterSoftness=await t.getParsedNumber("borderOuterSoftness")),o.includes("borderInnerSoftness")&&(a.borderInnerSoftness=await t.getParsedNumber("borderInnerSoftness")),o.includes("borderBevelSoftness")&&(a.borderBevelSoftness=await t.getParsedNumber("borderBevelSoftness")),o.includes("borderBevelPosition")&&(a.borderBevelPosition=await t.getParsedNumber("borderBevelPosition")),o.includes("borderOpacity")&&(a.borderOpacity=await t.getParsedNumber("borderOpacity")),o.includes("borderHue")&&(a.borderHue=10*await t.getParsedNumber("borderHue")),o.includes("borderSaturation")&&(a.borderSaturation=10*await t.getParsedNumber("borderSaturation")),o.includes("borderLuma")&&(a.borderLuma=10*await t.getParsedNumber("borderLuma")),o.includes("lightSourceDirection")&&(a.lightSourceDirection=10*await t.getParsedNumber("lightSourceDirection")),o.includes("lightSourceAltitude")&&(a.lightSourceAltitude=await t.getParsedNumber("lightSourceAltitude")),o.includes("borderEnabled")&&(a.borderEnabled=await t.getParsedBoolean("borderEnabled")),o.includes("shadowEnabled")&&(a.shadowEnabled=await t.getParsedBoolean("shadowEnabled")),o.includes("borderBevel")&&(a.borderBevel=await t.getParsedNumber("borderBevel")),o.includes("rate")&&(a.rate=await t.getParsedNumber("rate"))),isNaN(r)||isNaN(i)||0!==Object.keys(a).length&&await(e?.setUpstreamKeyerDVESettings(a,r,i))},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("key")-1,a=Mr(r.state,t,i);return a?.dveSettings?{...e.getJson(),maskEnabled:a.dveSettings.maskEnabled+"",maskTop:a.dveSettings.maskTop/1e3+"",maskBottom:a.dveSettings.maskBottom/1e3+"",maskLeft:a.dveSettings.maskLeft/1e3+"",maskRight:a.dveSettings.maskRight/1e3+"",sizeX:a.dveSettings.sizeX/1e3+"",sizeY:a.dveSettings.sizeY/1e3+"",positionX:a.dveSettings.positionX/1e3+"",positionY:a.dveSettings.positionY/1e3+"",rotation:a.dveSettings.rotation+"",borderOuterWidth:a.dveSettings.borderOuterWidth/100+"",borderInnerWidth:a.dveSettings.borderInnerWidth/100+"",borderOuterSoftness:a.dveSettings.borderOuterSoftness+"",borderInnerSoftness:a.dveSettings.borderInnerSoftness+"",borderBevelSoftness:a.dveSettings.borderBevelSoftness+"",borderBevelPosition:a.dveSettings.borderBevelPosition+"",borderOpacity:a.dveSettings.borderOpacity+"",borderHue:a.dveSettings.borderHue/10+"",borderSaturation:a.dveSettings.borderSaturation/10+"",borderLuma:a.dveSettings.borderLuma/10+"",lightSourceDirection:a.dveSettings.lightSourceDirection/10+"",lightSourceAltitude:a.dveSettings.lightSourceAltitude+"",borderEnabled:a.dveSettings.borderEnabled+"",shadowEnabled:a.dveSettings.shadowEnabled+"",borderBevel:a.dveSettings.borderBevel+"",rate:a.dveSettings.rate+""}:void 0}},[vr.USKSetKeyframe]:{name:"Upstream key: Set Keyframe from values",options:{mixeffect:Nt(t,0),key:Ft(t),keyframe:{type:"dropdown",id:"keyframe",label:"Key Frame",choices:F,default:F[0].id},...Lt()},callback:async({options:t})=>{const r=t.getPlainNumber("mixeffect"),i=t.getPlainNumber("key"),a=t.getPlainNumber("keyframe"),o={},n=t.getRaw("properties");n&&Array.isArray(n)&&(n.includes("maskTop")&&(o.maskTop=1e3*t.getPlainNumber("maskTop")),n.includes("maskBottom")&&(o.maskBottom=1e3*t.getPlainNumber("maskBottom")),n.includes("maskLeft")&&(o.maskLeft=1e3*t.getPlainNumber("maskLeft")),n.includes("maskRight")&&(o.maskRight=1e3*t.getPlainNumber("maskRight")),n.includes("sizeX")&&(o.sizeX=1e3*t.getPlainNumber("sizeX")),n.includes("sizeY")&&(o.sizeY=1e3*t.getPlainNumber("sizeY")),n.includes("positionX")&&(o.positionX=1e3*t.getPlainNumber("positionX")),n.includes("positionY")&&(o.positionY=1e3*t.getPlainNumber("positionY")),n.includes("rotation")&&(o.rotation=t.getPlainNumber("rotation")),n.includes("borderOuterWidth")&&(o.borderOuterWidth=100*t.getPlainNumber("borderOuterWidth")),n.includes("borderInnerWidth")&&(o.borderInnerWidth=100*t.getPlainNumber("borderInnerWidth")),n.includes("borderOuterSoftness")&&(o.borderOuterSoftness=t.getPlainNumber("borderOuterSoftness")),n.includes("borderInnerSoftness")&&(o.borderInnerSoftness=t.getPlainNumber("borderInnerSoftness")),n.includes("borderBevelSoftness")&&(o.borderBevelSoftness=t.getPlainNumber("borderBevelSoftness")),n.includes("borderBevelPosition")&&(o.borderBevelPosition=t.getPlainNumber("borderBevelPosition")),n.includes("borderOpacity")&&(o.borderOpacity=t.getPlainNumber("borderOpacity")),n.includes("borderHue")&&(o.borderHue=10*t.getPlainNumber("borderHue")),n.includes("borderSaturation")&&(o.borderSaturation=10*t.getPlainNumber("borderSaturation")),n.includes("borderLuma")&&(o.borderLuma=10*t.getPlainNumber("borderLuma")),n.includes("lightSourceDirection")&&(o.lightSourceDirection=10*t.getPlainNumber("lightSourceDirection")),n.includes("lightSourceAltitude")&&(o.lightSourceAltitude=t.getPlainNumber("lightSourceAltitude"))),0!==Object.keys(o).length&&await(e?.setUpstreamKeyerFlyKeyKeyframe(r,i,a,o))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.dveSettings?{...e.getJson(),maskTop:t.dveSettings.maskTop/1e3,maskBottom:t.dveSettings.maskBottom/1e3,maskLeft:t.dveSettings.maskLeft/1e3,maskRight:t.dveSettings.maskRight/1e3,sizeX:t.dveSettings.sizeX/1e3,sizeY:t.dveSettings.sizeY/1e3,positionX:t.dveSettings.positionX/1e3,positionY:t.dveSettings.positionY/1e3,rotation:t.dveSettings.rotation,borderOuterWidth:t.dveSettings.borderOuterWidth/100,borderInnerWidth:t.dveSettings.borderInnerWidth/100,borderOuterSoftness:t.dveSettings.borderOuterSoftness,borderInnerSoftness:t.dveSettings.borderInnerSoftness,borderBevelSoftness:t.dveSettings.borderBevelSoftness,borderBevelPosition:t.dveSettings.borderBevelPosition,borderOpacity:t.dveSettings.borderOpacity,borderHue:t.dveSettings.borderHue/10,borderSaturation:t.dveSettings.borderSaturation/10,borderLuma:t.dveSettings.borderLuma/10,lightSourceDirection:t.dveSettings.lightSourceDirection/10,lightSourceAltitude:t.dveSettings.lightSourceAltitude}:void 0}},[vr.USKStoreKeyframe]:{name:"Upstream key: Set keyframe from current key state",options:{mixeffect:Nt(t,0),key:Ft(t),keyframe:{type:"dropdown",id:"keyframe",label:"Key Frame",choices:F,default:F[0].id}},callback:async({options:t})=>{await(e?.storeUpstreamKeyerFlyKeyKeyframe(t.getPlainNumber("mixeffect"),t.getPlainNumber("key"),t.getPlainNumber("keyframe")))}},[vr.USKFly]:{name:"Upstream key: fly to keyframe",options:{mixeffect:Nt(t,0),key:Ft(t),keyframe:{type:"dropdown",id:"keyframe",label:"Key Frame",choices:D,default:D[0].id}},callback:async({options:t})=>{await(e?.runUpstreamKeyerFlyKeyTo(t.getPlainNumber("mixeffect"),t.getPlainNumber("key"),t.getPlainNumber("keyframe")))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.flyProperties?{...e.getJson(),keyframe:t.flyProperties.isAtKeyFrame}:void 0}},[vr.USKFlyInfinite]:{name:"Upstream key: fly to infinite",options:{mixeffect:Nt(t,0),key:Ft(t),flydirection:{type:"dropdown",id:"flydirection",label:"Fly direction",choices:$,default:$[0].id}},callback:async({options:t})=>{await(e?.runUpstreamKeyerFlyKeyToInfinite(t.getPlainNumber("mixeffect"),t.getPlainNumber("key"),t.getPlainNumber("flydirection")))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.flyProperties?{...e.getJson(),flydirection:t.flyProperties.runToInfiniteIndex}:void 0}}}:{[vr.USKDVEProperties]:void 0,[vr.USKDVEPropertiesVariables]:void 0,[vr.USKSetKeyframe]:void 0,[vr.USKStoreKeyframe]:void 0,[vr.USKFly]:void 0,[vr.USKFlyInfinite]:void 0}}function Yr(e,t,r){return t.USKs&&t.DVEs?{[vr.USKPatternProperties]:{name:"Upstream key: Change Pattern properties",options:{mixeffect:Nt(t,0),key:Ft(t),...gr()},callback:async({options:t})=>{const r=t.getPlainNumber("key"),i=t.getPlainNumber("mixeffect"),a={},o=t.getRaw("properties");o&&Array.isArray(o)&&(o.includes("style")&&(a.style=t.getPlainNumber("style")),o.includes("size")&&(a.size=100*t.getPlainNumber("size")),o.includes("symmetry")&&(a.symmetry=100*t.getPlainNumber("symmetry")),o.includes("softness")&&(a.softness=100*t.getPlainNumber("softness")),o.includes("positionX")&&(a.positionX=1e4*t.getPlainNumber("positionX")),o.includes("positionY")&&(a.positionY=1e4*t.getPlainNumber("positionY")),o.includes("invert")&&(a.invert=t.getPlainBoolean("invert"))),0!==Object.keys(a).length&&await(e?.setUpstreamKeyerPatternSettings(a,i,r))},learn:async({options:e})=>{const t=e.getPlainNumber("key"),i=e.getPlainNumber("mixeffect"),a=Mr(r.state,i,t);return a?.patternSettings?{...e.getJson(),style:a.patternSettings.style,size:a.patternSettings.size/100,symmetry:a.patternSettings.symmetry/100,softness:a.patternSettings.softness/100,positionX:a.patternSettings.positionX/1e4,positionY:a.patternSettings.positionY/1e4,invert:a.patternSettings.invert}:void 0}},[vr.USKPatternPropertiesVariables]:{name:"Upstream key: Change Pattern properties from variables",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},...hr()},callback:async({options:t})=>{const r=await t.getParsedNumber("mixeffect")-1,i=await t.getParsedNumber("key")-1,a={},o=t.getRaw("properties");o&&Array.isArray(o)&&(o.includes("style")&&(a.style=await t.getParsedNumber("style")),o.includes("size")&&(a.size=100*await t.getParsedNumber("size")),o.includes("symmetry")&&(a.symmetry=100*await t.getParsedNumber("symmetry")),o.includes("softness")&&(a.softness=100*await t.getParsedNumber("softness")),o.includes("positionX")&&(a.positionX=1e4*await t.getParsedNumber("positionX")),o.includes("positionY")&&(a.positionY=1e4*await t.getParsedNumber("positionY")),o.includes("invert")&&(a.invert=await t.getParsedBoolean("invert"))),isNaN(r)||isNaN(i)||0!==Object.keys(a).length&&await(e?.setUpstreamKeyerPatternSettings(a,r,i))},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("key")-1,a=Mr(r.state,t,i);return a?.patternSettings?{...e.getJson(),style:a.patternSettings.style+"",size:a.patternSettings.size/100+"",symmetry:a.patternSettings.symmetry/100+"",softness:a.patternSettings.softness/100+"",positionX:a.patternSettings.positionX/1e4+"",positionY:a.patternSettings.positionY/1e4+"",invert:a.patternSettings.invert+""}:void 0}}}:{[vr.USKPatternProperties]:void 0,[vr.USKPatternPropertiesVariables]:void 0}}function Xr(t,r,i,a){if(!r.classicAudio)return{[vr.ClassicAudioGain]:void 0,[vr.ClassicAudioGainDelta]:void 0,[vr.ClassicAudioMixOption]:void 0,[vr.ClassicAudioResetPeaks]:void 0,[vr.ClassicAudioMasterGain]:void 0,[vr.ClassicAudioMasterGainDelta]:void 0,[vr.ClassicAudioMasterPan]:void 0,[vr.ClassicAudioMasterPanDelta]:void 0};const o=nr(r,a.state);return{[vr.ClassicAudioGain]:{name:"Classic Audio: Set input gain",options:{input:o,gain:{type:"number",label:"Fader Level (-60 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:6},...ur},callback:async({options:e})=>{const r=e.getPlainNumber("input"),o=(a.state.audio?.channels??{})[r];await i.runForFadeOptions(`audio.${r}.gain`,(async e=>{await(t?.setClassicAudioMixerInputProps(r,{gain:e}))}),o?.gain,e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=(a.state.audio?.channels??{})[e.getPlainNumber("input")];return t?{...e.getJson(),gain:t.gain}:void 0}},[vr.ClassicAudioGainDelta]:{name:"Classic Audio: Adjust input gain",options:{input:o,delta:cr,...ur},callback:async({options:e})=>{const r=e.getPlainNumber("input"),o=(a.state.audio?.channels??{})[r];if("number"==typeof o?.gain){const a=Math.max(te,o.gain);await i.runForFadeOptions(`audio.${r}.gain`,(async e=>{await(t?.setClassicAudioMixerInputProps(r,{gain:e}))}),a,a+e.getPlainNumber("delta"),e)}}},[vr.ClassicAudioMixOption]:{name:"Classic Audio: Set input mix option",options:{input:o,option:{id:"option",label:"Mix option",type:"dropdown",default:"toggle",choices:[{id:"toggle",label:"Toggle (On/Off)"},...B]}},callback:async({options:r})=>{const i=r.getPlainNumber("input"),o=a.state.audio?.channels??{},n=o[i]?.mixOption===e.Enums.AudioMixOption.On?e.Enums.AudioMixOption.Off:e.Enums.AudioMixOption.On,s=r.getRaw("option"),l="toggle"===s?n:s;await(t?.setClassicAudioMixerInputProps(i,{mixOption:l}))},learn:({options:e})=>{const t=(a.state.audio?.channels??{})[e.getPlainNumber("input")];return t?{...e.getJson(),option:t.mixOption}:void 0}},[vr.ClassicAudioResetPeaks]:{name:"Classic Audio: Reset peaks",options:{reset:{type:"dropdown",id:"reset",label:"Reset",default:"all",choices:[{id:"all",label:"All"},{id:"master",label:"Master"},{id:"monitor",label:"Monitor"},...o.choices]}},callback:async({options:e})=>{const r=e.getRaw("reset");if("all"===r)await(t?.setClassicAudioResetPeaks({all:!0}));else if("master"===r)await(t?.setClassicAudioResetPeaks({master:!0}));else if("monitor"===r)await(t?.setClassicAudioResetPeaks({monitor:!0}));else{const e=Number(r);await(t?.setClassicAudioResetPeaks({input:e}))}}},[vr.ClassicAudioMasterGain]:{name:"Classic Audio: Set master gain",options:{gain:{type:"number",label:"Fader Level (-60 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:6},...ur},callback:async({options:e})=>{await i.runForFadeOptions("audio.master.gain",(async e=>{await(t?.setClassicAudioMixerMasterProps({gain:e}))}),a.state.audio?.master?.gain,e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.audio?.master;return t?{...e.getJson(),gain:t.gain}:void 0}},[vr.ClassicAudioMasterGainDelta]:{name:"Classic Audio: Adjust master gain",options:{delta:cr,...ur},callback:async({options:e})=>{const r=Math.max(te,a.state.audio?.master?.gain??-1/0);"number"==typeof r&&await i.runForFadeOptions("audio.master.gain",(async e=>{await(t?.setClassicAudioMixerMasterProps({gain:e}))}),r,r+e.getPlainNumber("delta"),e)}},[vr.ClassicAudioMasterPan]:{name:"Classic Audio: Set master pan",options:{balance:{type:"number",label:"Pan",id:"balance",range:!0,required:!0,default:0,step:1,min:-50,max:50},...ur},callback:async({options:e})=>{await i.runForFadeOptions("audio.master.pan",(async e=>{await(t?.setClassicAudioMixerMasterProps({balance:e}))}),a.state.audio?.master?.balance,e.getPlainNumber("balance"),e)},learn:({options:e})=>{const t=a.state.audio?.master;return t?{...e.getJson(),balance:t.balance}:void 0}},[vr.ClassicAudioMasterPanDelta]:{name:"Classic Audio: Adjust master pan",options:{delta:{type:"number",label:"Delta",id:"delta",default:1,max:50,min:-50},...ur},callback:async({options:e})=>{const r=a.state.audio?.master?.balance;"number"==typeof r&&await i.runForFadeOptions("audio.master.gain",(async e=>{await(t?.setClassicAudioMixerMasterProps({balance:e}))}),r,r+e.getPlainNumber("delta"),e)}}}}function Qr(t,r,i,a){if(!r.fairlightAudio)return{[vr.FairlightAudioInputGain]:void 0,[vr.FairlightAudioInputGainDelta]:void 0,[vr.FairlightAudioInputDelay]:void 0,[vr.FairlightAudioInputDelayDelta]:void 0,[vr.FairlightAudioFaderGain]:void 0,[vr.FairlightAudioFaderGainDelta]:void 0,[vr.FairlightAudioMixOption]:void 0,[vr.FairlightAudioResetPeaks]:void 0,[vr.FairlightAudioResetSourcePeaks]:void 0,[vr.FairlightAudioMasterGain]:void 0,[vr.FairlightAudioMasterGainDelta]:void 0,[vr.FairlightAudioMonitorSolo]:void 0,[vr.FairlightAudioMonitorOutputGain]:void 0,[vr.FairlightAudioMonitorOutputGainDelta]:void 0,[vr.FairlightAudioMonitorMasterMuted]:void 0,[vr.FairlightAudioMonitorMasterGain]:void 0,[vr.FairlightAudioMonitorMasterGainDelta]:void 0,[vr.FairlightAudioMonitorTalkbackMuted]:void 0,[vr.FairlightAudioMonitorTalkbackGain]:void 0,[vr.FairlightAudioMonitorTalkbackGainDelta]:void 0,[vr.FairlightAudioMonitorSidetoneGain]:void 0,[vr.FairlightAudioMonitorSidetoneGainDelta]:void 0,[vr.FairlightAudioRouting]:void 0,[vr.FairlightAudioRoutingVariables]:void 0};const o=nr(r,a.state),n=sr(),s=nr(r,a.state,"delay");return{[vr.FairlightAudioInputGain]:{name:"Fairlight Audio: Set input gain",options:{input:o,source:n,gain:{type:"number",label:"Input Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:6},...ur},callback:async({options:e})=>{const r=e.getPlainNumber("input"),o=e.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=(n[r]?.sources??{})[o];await i.runForFadeOptions(`audio.${r}.${o}.gain`,(async e=>{await(t?.setFairlightAudioMixerSourceProps(r,o,{gain:e}))}),s?.properties?.gain,100*e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?{...e.getJson(),gain:r.properties.gain/100}:void 0}},[vr.FairlightAudioInputGainDelta]:{name:"Fairlight Audio: Adjust input gain",options:{input:o,source:n,delta:cr,...ur},callback:async({options:e})=>{const r=e.getPlainNumber("input"),o=e.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=(n[r]?.sources??{})[o];"number"==typeof s?.properties?.gain&&await i.runForFadeOptions(`audio.${r}.${o}.gain`,(async e=>{await(t?.setFairlightAudioMixerSourceProps(r,o,{gain:e}))}),s.properties.gain,s.properties.gain+100*e.getPlainNumber("delta"),e)}},[vr.FairlightAudioInputDelay]:s?{name:"Fairlight Audio: Set delay",options:{input:s,source:n,delay:{type:"number",label:"Delay (frames)",id:"gain",range:!0,required:!0,default:0,step:1,min:0,max:8}},callback:async({options:e})=>{const r=e.getPlainNumber("input"),i=e.getPlainString("source");await(t?.setFairlightAudioMixerSourceProps(r,i,{framesDelay:e.getPlainNumber("delay")}))},learn:({options:e})=>{const t=a.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?{...e.getJson(),delay:r.properties.framesDelay}:void 0}}:void 0,[vr.FairlightAudioInputDelayDelta]:s?{name:"Fairlight Audio: Adjust delay",options:{input:s,source:n,delay:{type:"number",label:"Adjustment (frames)",id:"gain",range:!0,required:!0,default:0,step:1,min:-8,max:8}},callback:async({options:e})=>{const r=e.getPlainNumber("input"),i=e.getPlainString("source"),o=e.getPlainNumber("delay"),n=a.state.fairlight?.inputs??{},s=(n[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")],l=s?.properties?.framesDelay;void 0!==l&&await(t?.setFairlightAudioMixerSourceProps(r,i,{framesDelay:l+o}))}}:void 0,[vr.FairlightAudioFaderGain]:{name:"Fairlight Audio: Set fader gain",options:{input:o,source:n,gain:{type:"number",label:"Fader Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:10},...ur},callback:async({options:e})=>{const r=e.getPlainNumber("input"),o=e.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=(n[r]?.sources??{})[o];await i.runForFadeOptions(`audio.${r}.${o}.faderGain`,(async e=>{await(t?.setFairlightAudioMixerSourceProps(r,o,{faderGain:e}))}),s?.properties?.faderGain,100*e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?{...e.getJson(),gain:r.properties.faderGain/100}:void 0}},[vr.FairlightAudioFaderGainDelta]:{name:"Fairlight Audio: Adjust fader gain",options:{input:o,source:n,delta:cr,...ur},callback:async({options:e})=>{const r=e.getPlainNumber("input"),o=e.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=(n[r]?.sources??{})[o];"number"==typeof s?.properties?.faderGain&&await i.runForFadeOptions(`audio.${r}.${o}.faderGain`,(async e=>{await(t?.setFairlightAudioMixerSourceProps(r,o,{faderGain:e}))}),s.properties.faderGain,s.properties.faderGain+100*e.getPlainNumber("delta"),e)}},[vr.FairlightAudioMixOption]:{name:"Fairlight Audio: Set input mix option",options:{input:o,source:n,option:{id:"option",label:"Mix option",type:"dropdown",default:"toggle",choices:[{id:"toggle",label:"Toggle (On/Off)"},...L]}},callback:async({options:r})=>{const i=r.getPlainNumber("input"),o=r.getPlainString("source"),n=a.state.fairlight?.inputs??{},s=n[i]?.sources??{},l=s[o]?.properties?.mixOption===e.Enums.FairlightAudioMixOption.On?e.Enums.FairlightAudioMixOption.Off:e.Enums.FairlightAudioMixOption.On,u=r.getRaw("option"),c="toggle"===u?l:u;await(t?.setFairlightAudioMixerSourceProps(i,o,{mixOption:c}))},learn:({options:e})=>{const t=a.state.fairlight?.inputs??{},r=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return r?.properties?{...e.getJson(),option:r.properties.mixOption}:void 0}},[vr.FairlightAudioResetPeaks]:{name:"Fairlight Audio: Reset peaks",options:{reset:{type:"dropdown",id:"reset",label:"Reset",default:"all",choices:[{id:"all",label:"All"},{id:"master",label:"Master"}]}},callback:async({options:e})=>{const r=e.getPlainString("reset");"all"===r?await(t?.setFairlightAudioMixerResetPeaks({all:!0,master:!1})):"master"===r&&await(t?.setFairlightAudioMixerResetPeaks({master:!0,all:!1}))}},[vr.FairlightAudioResetSourcePeaks]:{name:"Fairlight Audio: Reset Source peaks",options:{input:o,source:n},callback:async({options:e})=>{const r=e.getPlainNumber("input"),i=e.getPlainString("source");await(t?.setFairlightAudioMixerSourceResetPeaks(r,i,{output:!0,dynamicsInput:!1,dynamicsOutput:!1}))}},[vr.FairlightAudioMasterGain]:{name:"Fairlight Audio: Set master gain",options:{gain:{type:"number",label:"Input Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:6},...ur},callback:async({options:e})=>{await i.runForFadeOptions("audio.master.gain",(async e=>{await(t?.setFairlightAudioMixerMasterProps({faderGain:e}))}),a.state.fairlight?.master?.properties?.faderGain,100*e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.fairlight?.master?.properties;return t?{...e.getJson(),gain:t.faderGain/100}:void 0}},[vr.FairlightAudioMasterGainDelta]:{name:"Fairlight Audio: Adjust master gain",options:{delta:cr,...ur},callback:async({options:e})=>{const r=a.state.fairlight?.master?.properties?.faderGain;"number"==typeof r&&await i.runForFadeOptions("audio.master.gain",(async e=>{await(t?.setFairlightAudioMixerMasterProps({faderGain:e}))}),r,r+100*e.getPlainNumber("delta"),e)}},[vr.FairlightAudioMonitorSolo]:r.fairlightAudio.monitor?{name:"Fairlight Audio: Solo source",options:{solo:{id:"solo",type:"dropdown",label:"State",default:"true",choices:_},input:o,source:n},callback:async({options:e})=>{const r=e.getPlainNumber("input"),i=e.getPlainString("source");let o;if("toggle"===e.getPlainString("solo")){const e=a.state.fairlight?.solo;if(e){const t=e.index===r&&e.source===i;o=!e.solo||!t}else o=!0}else o="true"===e.getPlainString("solo");await(t?.setFairlightAudioMixerMonitorSolo({solo:o,index:r,source:i}))}}:void 0,[vr.FairlightAudioMonitorOutputGain]:r.fairlightAudio.monitor?{name:"Fairlight Audio: Set Monitor/Headphone fader gain",options:{gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10},...ur},callback:async({options:e})=>{await i.runForFadeOptions("audio.monitor.faderGain",(async e=>{await(t?.setFairlightAudioMixerMonitorProps({gain:e}))}),a.state.fairlight?.monitor?.gain,100*e.getPlainNumber("gain"),e)},learn:({options:e})=>{const t=a.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.gain/100}:void 0}}:void 0,[vr.FairlightAudioMonitorOutputGainDelta]:r.fairlightAudio.monitor?{name:"Fairlight Audio: Adjust Monitor/Headphone fader gain",options:{delta:cr,...ur},callback:async({options:e})=>{const r=a.state.fairlight?.monitor?.gain;"number"==typeof r&&await i.runForFadeOptions("audio.monitor.faderGain",(async e=>{await(t?.setFairlightAudioMixerMonitorProps({gain:e}))}),r,r+100*e.getPlainNumber("delta"),e)}}:void 0,...Zr(t,r,i,a),...ei(t,r,i,a),...ti(t,r,i,a),...ri(t,r,0,a)}}function Zr(e,t,r,i){return{[vr.FairlightAudioMonitorMasterMuted]:t.fairlightAudio?.monitor?{name:"Fairlight Audio: Monitor/Headphone master muted",options:{state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:_}},callback:async({options:t})=>{let r;r="toggle"===t.getPlainString("state")?!i.state.fairlight?.monitor?.inputMasterMuted:"true"===t.getPlainString("state"),await(e?.setFairlightAudioMixerMonitorProps({inputMasterMuted:r}))},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),state:t.inputMasterMuted?"true":"false"}:void 0}}:void 0,[vr.FairlightAudioMonitorMasterGain]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Set Monitor/Headphone master gain",options:{gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10},...ur},callback:async({options:t})=>{await r.runForFadeOptions("audio.monitor.inputMasterGain",(async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputMasterGain:t}))}),i.state.fairlight?.monitor?.inputMasterGain,100*t.getPlainNumber("gain"),t)},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputMasterGain/100}:void 0}}:void 0,[vr.FairlightAudioMonitorMasterGainDelta]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Adjust Monitor/Headphone master gain",options:{delta:cr,...ur},callback:async({options:t})=>{const a=i.state.fairlight?.monitor?.inputMasterGain;"number"==typeof a&&await r.runForFadeOptions("audio.monitor.inputMasterGain",(async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputMasterGain:t}))}),a,a+100*t.getPlainNumber("delta"),t)}}:void 0}}function ei(e,t,r,i){return{[vr.FairlightAudioMonitorTalkbackMuted]:t.fairlightAudio?.monitor?{name:"Fairlight Audio: Monitor/Headphone talkback muted",options:{state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:_}},callback:async({options:t})=>{let r;r="toggle"===t.getPlainString("state")?!i.state.fairlight?.monitor?.inputTalkbackMuted:"true"===t.getPlainString("state"),await(e?.setFairlightAudioMixerMonitorProps({inputTalkbackMuted:r}))},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),state:t.inputTalkbackMuted?"true":"false"}:void 0}}:void 0,[vr.FairlightAudioMonitorTalkbackGain]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Set Monitor/Headphone talkback gain",options:{gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10},...ur},callback:async({options:t})=>{await r.runForFadeOptions("audio.monitor.inputTalkbackGain",(async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputTalkbackGain:t}))}),i.state.fairlight?.monitor?.inputTalkbackGain,100*t.getPlainNumber("gain"),t)},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputTalkbackGain/100}:void 0}}:void 0,[vr.FairlightAudioMonitorTalkbackGainDelta]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Adjust Monitor/Headphone talkback gain",options:{delta:cr,...ur},callback:async({options:t})=>{const a=i.state.fairlight?.monitor?.inputTalkbackGain;"number"==typeof a&&await r.runForFadeOptions("audio.monitor.inputTalkbackGain",(async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputTalkbackGain:t}))}),a,a+100*t.getPlainNumber("delta"),t)}}:void 0}}function ti(e,t,r,i){return{[vr.FairlightAudioMonitorSidetoneGain]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Set Monitor/Headphone sidetone gain",options:{gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10},...ur},callback:async({options:t})=>{await r.runForFadeOptions("audio.monitor.inputSidetoneGain",(async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputSidetoneGain:t}))}),i.state.fairlight?.monitor?.inputSidetoneGain,100*t.getPlainNumber("gain"),t)},learn:({options:e})=>{const t=i.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputSidetoneGain/100}:void 0}}:void 0,[vr.FairlightAudioMonitorSidetoneGainDelta]:"split"===t.fairlightAudio?.monitor?{name:"Fairlight Audio: Adjust Monitor/Headphone sidetone gain",options:{delta:cr,...ur},callback:async({options:t})=>{const a=i.state.fairlight?.monitor?.inputSidetoneGain;"number"==typeof a&&await r.runForFadeOptions("audio.monitor.inputSidetoneGain",(async t=>{await(e?.setFairlightAudioMixerMonitorProps({inputSidetoneGain:t}))}),a,a+100*t.getPlainNumber("delta"),t)}}:void 0}}function ri(t,r,i,a){return r.fairlightAudio?.audioRouting?{[vr.FairlightAudioRouting]:{name:"Fairlight Audio: Audio Routing",description:"Requires firmware 9.4+",options:{destinations:br(r,a.state),source:mr(r,a.state)},callback:async({options:r})=>{const i=r.getPlainNumber("source"),a=r.getRaw("destinations");if(!a||0===a.length)return;const o=[];for(const t of a){const r=new e.Commands.AudioRoutingOutputCommand(t);r.updateProps({sourceId:i}),o.push(r)}await(t?.sendCommands(o))}},[vr.FairlightAudioRoutingVariables]:{name:"Fairlight Audio: Audio Routing from variables",description:"Requires firmware 9.4+",options:{destinations:{type:"textinput",id:"destinations",label:"Destinations",default:"1-1",tooltip:'Comma/space separated list of destination IDs. IDs are formed as "output-channel". channel can be omitted when wanting "1/2" eg 1503-3_4 for "MADI 3 3/4"',useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"0",tooltip:'IDs are formed as "output-channel". channel can be omitted when wanting "1/2" eg 1503-3_4 for "MADI 3 3/4"',useVariables:!0}},callback:async({options:r})=>{const[i,a]=await Promise.all([r.getParsedString("source"),r.getParsedString("destinations")]);if(!a||!i)return;const o=be(i)??0,n=a.split(/[,| ]/).map((e=>be(e))).filter((e=>null!==e));if(0===n.length)return;const s=[];for(const t of n){const r=new e.Commands.AudioRoutingOutputCommand(t);r.updateProps({sourceId:o}),s.push(r)}await(t?.sendCommands(s))}}}:{[vr.FairlightAudioRouting]:void 0,[vr.FairlightAudioRoutingVariables]:void 0}}var ii,ai,oi=__webpack_require__(4275);function ni(e,t,r){if(!e.enableCameraControl)return{[vr.CameraControlLensFocus]:void 0,[vr.CameraControlLensAutoFocus]:void 0,[vr.CameraControlLensIris]:void 0,[vr.CameraControlIncrementLensIris]:void 0,[vr.CameraControlLensAutoIris]:void 0,[vr.CameraControlLensOpticalImageStabilisation]:void 0,[vr.CameraControlLensZoom]:void 0};const i=t&&new oi.AtemCameraControlDirectCommandSender(t);return{[vr.CameraControlLensFocus]:{name:"Camera Control: Focus adjust",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},delta:{id:"delta",type:"textinput",label:"Delta",default:"0.1",tooltip:"Max range -1.0 - 1.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("delta");await(i?.lensFocus(t,r,!0))}},[vr.CameraControlLensAutoFocus]:{name:"Camera Control: Trigger Auto Focus",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");await(i?.lensTriggerAutoFocus(t))}},[vr.CameraControlLensIris]:{name:"Camera Control: Iris",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},isNormalised:{id:"isNormalised",type:"checkbox",label:"Normalised",default:!0},fStop:{id:"fStop",type:"textinput",label:"Value",default:"4",tooltip:"Max range -1.0 - 16.0",useVariables:!0,isVisible:e=>!e.isNormalised},normalised:{id:"normalised",type:"textinput",label:"Value",default:"0.5",tooltip:"Range 0.0 - 1.0",useVariables:!0,isVisible:e=>!!e.isNormalised}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");if(e.getPlainBoolean("isNormalised")){const r=await e.getParsedNumber("normalised");await(i?.lensIrisNormalised(t,r))}else{const r=await e.getParsedNumber("fStop");await(i?.lensIrisFStop(t,r))}}},[vr.CameraControlIncrementLensIris]:{name:"Camera Control: Increment Iris",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},fStopIncrement:{id:"fStopIncrement",type:"textinput",label:"Value",default:"1",tooltip:"e.g. 1 or -1",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),a=await e.getParsedNumber("fStopIncrement");let o=(r.atemCameraState.get(t)?.lens.iris??0)+a;o>16?o=1:o<-1&&(o=0),await(i?.lensIrisFStop(t,o))}},[vr.CameraControlLensAutoIris]:{name:"Camera Control: Trigger Auto Iris",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");await(i?.lensTriggerAutoIris(t))}},[vr.CameraControlLensOpticalImageStabilisation]:{name:"Camera Control: Set Optical Image Stabilisation enabled",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:_}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");let a;if("toggle"===e.getPlainString("state")){const e=r.atemCameraState.get(t);a=!e?.lens?.opticalImageStabilisation}else a="true"===e.getPlainString("state");await(i?.lensEnableOpticalImageStabilisation(t,a))}},[vr.CameraControlLensZoom]:{name:"Camera Control: Zoom (Continuous)",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},zoom:{id:"zoom",type:"textinput",label:"Zoom speed",default:"0.0",tooltip:"Max range -1.0 - 1.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("zoom");await(i?.lensSetContinuousZoomSpeed(t,r))}}}}function si(e,t,r){if(!e.enableCameraControl)return{[vr.CameraControlDisplayColorBars]:void 0};const i=t&&new oi.AtemCameraControlDirectCommandSender(t);return{[vr.CameraControlDisplayColorBars]:{name:"Camera Control: Show Color Bars",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:_}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");let a;if("toggle"===e.getPlainString("state")){const e=r.atemCameraState.get(t);a=!e?.display?.colorBarEnable,console.log("camera",e,a)}else a="true"===e.getPlainString("state");await(i?.displayColorBars(t,a))}}}}function li(e,t,r){if(!e.enableCameraControl)return{[vr.CameraControlVideoManualWhiteBalance]:void 0,[vr.CameraControlVideoIncrementManualWhiteBalance]:void 0,[vr.CameraControlVideoAutoWhiteBalance]:void 0,[vr.CameraControlVideoExposure]:void 0,[vr.CameraControlIncrementVideoExposure]:void 0,[vr.CameraControlVideoSharpeningLevel]:void 0,[vr.CameraControlVideoGain]:void 0,[vr.CameraControlIncrementVideoGain]:void 0,[vr.CameraControlVideoNdFilterStop]:void 0};const i=t&&new oi.AtemCameraControlDirectCommandSender(t);return{[vr.CameraControlVideoManualWhiteBalance]:{name:"Camera Control: White Balance",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},colorTemperature:{id:"colorTemperature",type:"textinput",label:"Color Temperature",default:"5600",useVariables:!0},tint:{id:"tint",type:"textinput",label:"Tint",default:"0",tooltip:"Range -50 to 50",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("colorTemperature"),a=await e.getParsedNumber("tint");await(i?.videoManualWhiteBalance(t,r,a))}},[vr.CameraControlVideoIncrementManualWhiteBalance]:{name:"Camera Control: Increment White Balance",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},colorTemperatureIncrement:{id:"colorTemperatureIncrement",type:"textinput",label:"Color Temperature Increment",default:"100",tooltip:"e.g. 100 or -100",useVariables:!0},tintIncrement:{id:"tintIncrement",type:"textinput",label:"Tint Increment",default:"0",tooltip:"e.g 10 or -10",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),a=await e.getParsedNumber("colorTemperatureIncrement"),o=await e.getParsedNumber("tintIncrement"),n=(r.atemCameraState.get(t)?.video.whiteBalance[0]??0)+a;let s=(r.atemCameraState.get(t)?.video.whiteBalance[1]??0)+o;s>50?s=50:s<-50&&(s=-50),await(i?.videoManualWhiteBalance(t,n,s))}},[vr.CameraControlVideoAutoWhiteBalance]:{name:"Camera Control: Trigger Auto White Balance",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");await(i?.videoTriggerAutoWhiteBalance(t))}},[vr.CameraControlVideoExposure]:{name:"Camera Control: Video Exposure",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},framerate:{id:"framerate",type:"textinput",label:"Framerate",default:"60",tooltip:"eg for 1/60 use 50",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("framerate");await(i?.videoExposureUs(t,Math.round(1e6/r)))}},[vr.CameraControlIncrementVideoExposure]:{name:"Camera Control: Increment Video Exposure",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},direction:{id:"direction",type:"dropdown",label:"Direction",choices:[{id:"up",label:"Up +"},{id:"down",label:"Down -"}],default:"up",tooltip:"Up for faster shutter speeds, down for slower."}},callback:async({options:e})=>{const t=[41667,4e4,33333,20833,2e4,16667,13333,11111,1e4,8333,6667,5556,4e3,2778,2e3,1379,1e3,690,500],a=await e.getParsedNumber("cameraId"),o="up"==e.getPlainString("direction")?1:-1,n=t.indexOf(r.atemCameraState.get(a)?.video.exposure??41667);let s=n+o;(s<0||s>t.length-1)&&(s=n),await(i?.videoExposureUs(a,t[s]))}},[vr.CameraControlVideoSharpeningLevel]:{name:"Camera Control: Video Sharpening Level",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},level:{id:"level",type:"dropdown",label:"Level",default:oi.VideoSharpeningLevel.Low,choices:[{id:oi.VideoSharpeningLevel.Off,label:"Off"},{id:oi.VideoSharpeningLevel.Low,label:"Low"},{id:oi.VideoSharpeningLevel.Medium,label:"Medium"},{id:oi.VideoSharpeningLevel.High,label:"High"}]}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=e.getPlainNumber("level");await(i?.videoSharpeningLevel(t,r))}},[vr.CameraControlVideoGain]:{name:"Camera Control: Video Gain",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},gain:{id:"gain",type:"textinput",label:"Value",default:"0",tooltip:"Range 0 - 128",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("gain");await(i?.videoGain(t,r))}},[vr.CameraControlIncrementVideoGain]:{name:"Camera Control: Increment Video Gain",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},increment:{id:"increment",type:"textinput",label:"Value",default:"10",tooltip:"e.g 10 or -10",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),a=await e.getParsedNumber("increment");let o=(r.atemCameraState.get(t)?.video.gain??0)+a;o>127?o=127:o<0&&(o=0),await(i?.videoGain(t,o))}},[vr.CameraControlVideoNdFilterStop]:{name:"Camera Control: ND Filter Stop",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},stop:{id:"stop",type:"textinput",label:"Value",default:"4",tooltip:"Range 0.0 - 15.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("stop");await(i?.videoNdFilterStop(t,r))}}}}function ui(e,t,r){if(!e.enableCameraControl)return{[vr.CameraControlColorLiftAdjust]:void 0,[vr.CameraControlColorGammaAdjust]:void 0,[vr.CameraControlColorGainAdjust]:void 0,[vr.CameraControlColorOffsetAdjust]:void 0,[vr.CameraControlColorContrastAdjust]:void 0,[vr.CameraControlColorLumaMix]:void 0,[vr.CameraControlColorHueSaturationAdjust]:void 0};const i=t&&new oi.AtemCameraControlDirectCommandSender(t),a=(e,t)=>({name:e,options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},red:{id:"red",type:"textinput",label:"Red",default:"0.0",tooltip:"eg for -2.0 to 2.0",useVariables:!0},green:{id:"green",type:"textinput",label:"Green",default:"0.0",tooltip:"eg for -2.0 to 2.0",useVariables:!0},blue:{id:"blue",type:"textinput",label:"Blue",default:"0.0",tooltip:"eg for -2.0 to 2.0",useVariables:!0},luma:{id:"luma",type:"textinput",label:"Luma",default:"0.0",tooltip:"eg for -2.0 to 2.0",useVariables:!0}},callback:async({options:e})=>{const r=await e.getParsedNumber("cameraId"),i=await e.getParsedNumber("red"),a=await e.getParsedNumber("green"),o=await e.getParsedNumber("blue"),n=await e.getParsedNumber("luma");await t(r,i,a,o,n)}});return{[vr.CameraControlColorLiftAdjust]:a("Camera Control: Color Lift Adjust",(async(e,t,r,a,o)=>i?.colorLiftAdjust(e,t,r,a,o))),[vr.CameraControlColorGammaAdjust]:a("Camera Control: Color Gamma Adjust",(async(e,t,r,a,o)=>i?.colorGammaAdjust(e,t,r,a,o))),[vr.CameraControlColorGainAdjust]:a("Camera Control: Color Gain Adjust",(async(e,t,r,a,o)=>i?.colorGainAdjust(e,t,r,a,o))),[vr.CameraControlColorOffsetAdjust]:a("Camera Control: Color Offset Adjust",(async(e,t,r,a,o)=>i?.colorOffsetAdjust(e,t,r,a,o))),[vr.CameraControlColorContrastAdjust]:{name:"Camera Control: Contrast Adjust",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},contrast:{id:"contrast",type:"textinput",label:"Value",default:"1.0",tooltip:"eg for 0.0 to 1.0",useVariables:!0},pivot:{id:"pivot",type:"textinput",label:"Value",default:"1.0",tooltip:"eg for 0.0 to 1.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("contrast"),a=await e.getParsedNumber("pivot");await(i?.colorContrastAdjust(t,r,a))}},[vr.CameraControlColorLumaMix]:{name:"Camera Control: Color LumaMix",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},lumaMix:{id:"lumaMix",type:"textinput",label:"Value",default:"1.0",tooltip:"eg for 0.0 to 1.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("lumaMix");await(i?.colorLumaMix(t,r))}},[vr.CameraControlColorHueSaturationAdjust]:{name:"Camera Control: Color Hue & Saturation",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},hue:{id:"hue",type:"textinput",label:"Hue",default:"0.0",tooltip:"eg for -1.0 to 1.0",useVariables:!0},saturation:{id:"saturation",type:"textinput",label:"Saturation",default:"1.0",tooltip:"eg for 0.0 to 2.0",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId"),r=await e.getParsedNumber("hue"),a=await e.getParsedNumber("saturation");await(i?.colorHueSaturationAdjust(t,r,a))}}}}function ci(e){let t="00:00:00",r="00:00",i="00:00";return e&&(r=`${ie(`${e.hours}`,"0",2)}:${ie(`${e.minutes}`,"0",2)}`,t=`${r}:${ie(`${e.seconds}`,"0",2)}`,i=`${60*e.hours+e.minutes}:${ie(`${e.seconds}`,"0",2)}`),{hm:r,hms:t,ms:i}}function di(e){let t;return e&&(t={hours:0,minutes:0,seconds:0,frames:0,isDropFrame:!1},t.seconds=e%60,e=Math.floor(e/60),t.minutes=e%60,e=Math.floor(e/60),t.hours=e),ci(t)}function pi(t,r,i){return t.config.pollTimecode?{[vr.Timecode]:{name:"Timecode: Set time",options:{time:{id:"time",type:"textinput",label:"Timecode",default:"00:00:00",tooltip:"HH:MM:SS",useVariables:!0}},callback:async({options:e})=>{const t=await e.getParsedString("time"),[i,a,o,n]=t.split(/:|;/).map((e=>parseInt(e,10)));if(isNaN(i)||isNaN(a)||isNaN(o))throw new Error("Invalid timecode");await(r?.setTime(i,a,o,isNaN(n)?0:n))},learn:({options:e})=>{const r=di(t.timecodeSeconds).hms;return{...e.getJson(),time:r}}},[vr.TimecodeMode]:{name:"Timecode: Set mode",options:{mode:{id:"mode",type:"dropdown",label:"Mode",choices:[{id:e.Enums.TimeMode.FreeRun,label:"Free run"},{id:e.Enums.TimeMode.TimeOfDay,label:"Time of Day"}],default:e.Enums.TimeMode.FreeRun}},callback:async({options:e})=>{const t=e.getPlainNumber("mode");await(r?.setTimeMode(t))},learn:({options:t})=>({...t.getJson(),mode:i.state.settings.timeMode??e.Enums.TimeMode.FreeRun})}}:{[vr.Timecode]:void 0,[vr.TimecodeMode]:void 0}}function mi(e,t,i,a){if(!e.enableCameraControl)return{[vr.CameraControlMediaRecordSingle]:void 0,[vr.CameraControlMediaRecordMultiple]:void 0};const o=i&&new oi.AtemCameraControlDirectCommandSender(i);return{[vr.CameraControlMediaRecordSingle]:{name:"Camera Control: Set Camera Recording",options:{cameraId:{id:"cameraId",type:"textinput",useVariables:!0,default:"1",label:"Camera Id"},state:{id:"state",type:"dropdown",label:"State",default:"toggle",choices:[{id:"true",label:"Recording"},{id:"false",label:"Stopped"},{id:"toggle",label:"Toggle"}]}},callback:async({options:e})=>{const t=await e.getParsedNumber("cameraId");let r;if("toggle"===e.getPlainString("state")){const e=a.atemCameraState.get(t);r=!e?.display?.colorBarEnable}else r="true"===e.getPlainString("state");r?await(o?.mediaTriggerSetRecording(t)):await(o?.mediaTriggerSetStopped(t))}},[vr.CameraControlMediaRecordMultiple]:{name:"Camera Control: Set Multiple Camera Recording",options:{cameraIds:{id:"cameraIds",type:"multidropdown",label:"Camera Id",choices:t.inputs.filter((e=>e.portType===r.InternalPortType.External)).map((e=>{const t=a.state.inputs[e.id];return{label:t?.longName?`${t.longName} (${e.id})`:`Camera ${e.id}`,id:e.id}})),default:[1]},state:{id:"state",type:"dropdown",label:"State",default:"true",choices:[{id:"true",label:"Recording"},{id:"false",label:"Stopped"}]}},callback:async({options:e})=>{const t=e.getRaw("cameraIds");if(!t||!Array.isArray(t)||0===t.length)return;const r="true"===e.getPlainString("state");if(!i)return;const a=new oi.AtemCameraControlBatchCommandSender(i);for(const e of t)r?a.mediaTriggerSetRecording(e):a.mediaTriggerSetStopped(e);await a.sendBatch()}}}}function bi(e,r){return{[ii.ProgramTally]:{type:"boolean",name:"Tally: Program",description:"If the input specified has an active progam tally light, change style of the bank",options:{input:It(e,r.state,0)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=r.tally[e.getPlainNumber("input")];return!!t?.program}},[ii.PreviewTally]:{type:"boolean",name:"Tally: Preview",description:"If the input specified has an active preview tally light, change style of the bank",options:{input:It(e,r.state,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.tally[e.getPlainNumber("input")];return!!t?.preview}},[ii.AdvancedTally]:{type:"boolean",name:"Tally: Advanced",description:"Check if the input specified is active in one of the selected outputs/mixes",options:{inputIds:{id:"inputIds",label:"Mixes",type:"multidropdown",default:[10010],choices:X(Y(e,r.state,"tally"))},input:It(e,r.state,0)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=e.getRaw("inputIds")??[];if(!Array.isArray(t))return!1;const i=e.getPlainNumber("input");for(const e of t){const t=r.tallyCache.get(Number(e));if(t&&t.lastVisibleInputs.includes(i))return!0}return!1},subscribe:({id:e,options:t})=>{const i=t.getRaw("inputIds")??[];if(Array.isArray(i))for(const t of i){if("number"!=typeof t)continue;const i=r.tallyCache.get(t);i?i.referencedFeedbackIds.add(e):r.tallyCache.set(t,{referencedFeedbackIds:new Set([e]),lastVisibleInputs:de(r.state,t)})}},unsubscribe:({id:e})=>{for(const t of r.tallyCache.values())t.referencedFeedbackIds.delete(e)}}}}(ai=ii||(ii={})).PreviewBG="preview_bg",ai.PreviewVariables="previewVariables",ai.PreviewBG2="preview_bg_2",ai.PreviewBG3="preview_bg_3",ai.PreviewBG4="preview_bg_4",ai.ProgramBG="program_bg",ai.ProgramVariables="programVariables",ai.ProgramBG2="program_bg_2",ai.ProgramBG3="program_bg_3",ai.ProgramBG4="program_bg_4",ai.AuxBG="aux_bg",ai.AuxVariables="auxVariables",ai.USKOnAir="usk_bg",ai.USKType="usk_type",ai.USKSource="usk_source",ai.USKSourceVariables="usk_source_variables",ai.USKKeyFrame="usk_keyframe",ai.DSKOnAir="dsk_bg",ai.DSKTie="dskTie",ai.DSKSource="dsk_source",ai.DSKSourceVariables="dsk_source_variables",ai.Macro="macro",ai.MacroLoop="macroloop",ai.MVSource="mv_source",ai.MVSourceVariables="mv_source_variables",ai.MultiviewerLayout="multiviewerLayout",ai.SSrcArtProperties="ssrc_art_properties",ai.SSrcArtPropertiesVariables="ssrcArtPropertiesVariables",ai.SSrcArtSource="ssrc_art_source",ai.SSrcArtOption="ssrc_art_option",ai.SSrcBoxOnAir="ssrc_box_enable",ai.SSrcBoxSource="ssrc_box_source",ai.SSrcBoxSourceVariables="ssrc_box_source_variables",ai.SSrcBoxProperties="ssrc_box_properties",ai.PreviewTransition="previewTransition",ai.TransitionStyle="transitionStyle",ai.TransitionSelection="transitionSelection",ai.TransitionRate="transitionRate",ai.InTransition="inTransition",ai.MediaPlayerSource="mediaPlayerSource",ai.MediaPlayerSourceVariables="mediaPlayerSourceVariables",ai.MediaPoolPreview="mediaPoolPreview",ai.MediaPoolPreviewVariables="mediaPoolPreviewVariables",ai.FadeToBlackIsBlack="fadeToBlackIsBlack",ai.FadeToBlackRate="fadeToBlackRate",ai.ProgramTally="program_tally",ai.PreviewTally="preview_tally",ai.AdvancedTally="advanced_tally",ai.StreamStatus="streamStatus",ai.RecordStatus="recordStatus",ai.RecordISO="recordISO",ai.ClassicAudioGain="classicAudioGain",ai.ClassicAudioMixOption="classicAudioMixOption",ai.ClassicAudioMasterGain="classicAudioMasterGain",ai.FairlightAudioFaderGain="fairlightAudioFaderGain",ai.FairlightAudioInputGain="fairlightAudioInputGain",ai.FairlightAudioMixOption="fairlightAudioMixOption",ai.FairlightAudioMasterGain="fairlightAudioMasterGain",ai.FairlightAudioMonitorSolo="fairlightAudioMonitorSolo",ai.FairlightAudioMonitorOutputFaderGain="fairlightAudioMonitorFaderGain",ai.FairlightAudioMonitorMasterMuted="fairlightAudioMonitorMasterMuted",ai.FairlightAudioMonitorMasterGain="fairlightAudioMonitorMasterGain",ai.FairlightAudioMonitorTalkbackMuted="fairlightAudioMonitorTalkbackMuted",ai.FairlightAudioMonitorTalkbackGain="fairlightAudioMonitorTalkbackGain",ai.FairlightAudioMonitorSidetoneGain="fairlightAudioMonitorSidetoneGain",ai.FairlightAudioRouting="fairlightAudioRouting",ai.FairlightAudioRoutingVariables="fairlightAudioRoutingVariables",ai.TimecodeMode="timecodeMode";var fi=__webpack_require__(360);function gi(e,t,r){return{type:e.type,id:e.id,controlId:e.controlId,feedbackId:e.feedbackId,options:new kr(e.options,t,r)}}function hi(e){const{subscribe:t,unsubscribe:r,learn:i}=e;return{name:e.name,description:e.description,options:Object.entries(e.options).filter((e=>!!e[1])).map((([e,t])=>({...t,id:e}))),subscribe:t?async(r,i)=>t(gi(r,i,e.options),i):void 0,unsubscribe:r?async(t,i)=>r(gi(t,i,e.options),i):void 0,learn:i?async(t,r)=>i(gi(t,r,e.options),r):void 0,learnTimeout:void 0}}function yi(e,r){return{[ii.PreviewBG]:{type:"boolean",name:"ME: One ME preview source",description:"If the input specified is selected in preview on the M/E stage specified, change style of the bank",options:{mixeffect:Nt(e,0),input:It(e,r.state,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect"));return t?.previewInput===e.getPlainNumber("input")},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),input:t.previewInput}:void 0}},[ii.PreviewVariables]:{type:"boolean",name:"ME: One ME preview source from variables",description:"If the input specified is selected in preview on the M/E stage specified, change style of the bank",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("input"),a=xr(r.state,t);return a?.previewInput===i},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=xr(r.state,t);return i?{...e.getJson(),input:i.previewInput+""}:void 0}},[ii.PreviewBG2]:e.MEs>=2?{type:"boolean",name:"ME: Two ME preview sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:Nt(e,1),input1:It(e,r.state,1),mixeffect2:Nt(e,2),input2:It(e,r.state,2)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2"));return t?.previewInput===e.getPlainNumber("input1")&&i?.previewInput===e.getPlainNumber("input2")},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2"));return t&&i?{...e.getJson(),input1:t.previewInput,input2:i.previewInput}:void 0}}:void 0,[ii.PreviewBG3]:e.MEs>=3?{type:"boolean",name:"ME: Three ME preview sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:Nt(e,1),input1:It(e,r.state,1),mixeffect2:Nt(e,2),input2:It(e,r.state,2),mixeffect3:Nt(e,3),input3:It(e,r.state,3)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2")),a=xr(r.state,e.getPlainNumber("mixeffect3"));return t?.previewInput===e.getPlainNumber("input1")&&i?.previewInput===e.getPlainNumber("input2")&&a?.previewInput===e.getPlainNumber("input3")},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2")),a=xr(r.state,e.getPlainNumber("mixeffect3"));return t&&i&&a?{...e.getJson(),input1:t.previewInput,input2:i.previewInput,input3:a.previewInput}:void 0}}:void 0,[ii.PreviewBG4]:e.MEs>=4?{type:"boolean",name:"ME: Four ME preview sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:Nt(e,1),input1:It(e,r.state,1),mixeffect2:Nt(e,2),input2:It(e,r.state,2),mixeffect3:Nt(e,3),input3:It(e,r.state,3),mixeffect4:Nt(e,4),input4:It(e,r.state,4)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2")),a=xr(r.state,e.getPlainNumber("mixeffect3")),o=xr(r.state,e.getPlainNumber("mixeffect4"));return t?.previewInput===e.getPlainNumber("input1")&&i?.previewInput===e.getPlainNumber("input2")&&a?.previewInput===e.getPlainNumber("input3")&&o?.previewInput===e.getPlainNumber("input4")},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2")),a=xr(r.state,e.getPlainNumber("mixeffect3")),o=xr(r.state,e.getPlainNumber("mixeffect4"));return t&&i&&a&&o?{...e.getJson(),input1:t.previewInput,input2:i.previewInput,input3:a.previewInput,input4:o.previewInput}:void 0}}:void 0}}function Si(e,r){return{[ii.ProgramBG]:{type:"boolean",name:"ME: One ME program source",description:"If the input specified is selected in program on the M/E stage specified, change style of the bank",options:{mixeffect:Nt(e,0),input:It(e,r.state,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect"));return t?.programInput===e.getPlainNumber("input")},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),input:t.programInput}:void 0}},[ii.ProgramVariables]:{type:"boolean",name:"ME: One ME program source from variables",description:"If the input specified is selected in program on the M/E stage specified, change style of the bank",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("input"),a=xr(r.state,t);return a?.programInput===i},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=xr(r.state,t);return i?{...e.getJson(),input:i.programInput+""}:void 0}},[ii.ProgramBG2]:e.MEs>=2?{type:"boolean",name:"ME: Two ME program sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:Nt(e,1),input1:It(e,r.state,1),mixeffect2:Nt(e,2),input2:It(e,r.state,2)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2"));return t?.programInput===e.getPlainNumber("input1")&&i?.programInput===e.getPlainNumber("input2")},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2"));return t&&i?{...e.getJson(),input1:t.programInput,input2:i.programInput}:void 0}}:void 0,[ii.ProgramBG3]:e.MEs>=3?{type:"boolean",name:"ME: Three ME program sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:Nt(e,1),input1:It(e,r.state,1),mixeffect2:Nt(e,2),input2:It(e,r.state,2),mixeffect3:Nt(e,3),input3:It(e,r.state,3)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2")),a=xr(r.state,e.getPlainNumber("mixeffect3"));return t?.programInput===e.getPlainNumber("input1")&&i?.programInput===e.getPlainNumber("input2")&&a?.programInput===e.getPlainNumber("input3")},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2")),a=xr(r.state,e.getPlainNumber("mixeffect3"));return t&&i&&a?{...e.getJson(),input1:t.programInput,input2:i.programInput,input3:a.programInput}:void 0}}:void 0,[ii.ProgramBG4]:e.MEs>=4?{type:"boolean",name:"ME: Four ME program sources",description:"If the inputs specified are in use by program on the M/E stage specified, change style of the bank",options:{mixeffect1:Nt(e,1),input1:It(e,r.state,1),mixeffect2:Nt(e,2),input2:It(e,r.state,2),mixeffect3:Nt(e,3),input3:It(e,r.state,3),mixeffect4:Nt(e,4),input4:It(e,r.state,4)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2")),a=xr(r.state,e.getPlainNumber("mixeffect3")),o=xr(r.state,e.getPlainNumber("mixeffect4"));return t?.programInput===e.getPlainNumber("input1")&&i?.programInput===e.getPlainNumber("input2")&&a?.programInput===e.getPlainNumber("input3")&&o?.programInput===e.getPlainNumber("input4")},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect1")),i=xr(r.state,e.getPlainNumber("mixeffect2")),a=xr(r.state,e.getPlainNumber("mixeffect3")),o=xr(r.state,e.getPlainNumber("mixeffect4"));return t&&i&&a&&o?{...e.getJson(),input1:t.programInput,input2:i.programInput,input3:a.programInput,input4:o.programInput}:void 0}}:void 0}}function vi(e,r){return{[ii.FadeToBlackIsBlack]:{type:"boolean",name:"Fade to black: Active",description:"If the specified fade to black is active, change style of the bank",options:{mixeffect:Nt(e,0),state:{type:"dropdown",label:"State",id:"state",default:"on",choices:[{id:"on",label:"On"},{id:"off",label:"Off"},{id:"fading",label:"Fading"}]}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect"));if(t&&t.fadeToBlack)switch(e.getPlainString("state")){case"off":return!t.fadeToBlack.isFullyBlack&&!t.fadeToBlack.inTransition;case"fading":return t.fadeToBlack.inTransition;default:return!t.fadeToBlack.inTransition&&t.fadeToBlack.isFullyBlack}return!1}},[ii.FadeToBlackRate]:{type:"boolean",name:"Fade to black: Rate",description:"If the specified fade to black rate matches, change style of the bank",options:{mixeffect:Nt(e,0),rate:xt("Rate")},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect")),i=e.getPlainNumber("rate");return t?.fadeToBlack?.rate===i},learn:({options:e})=>{const t=xr(r.state,e.getPlainNumber("mixeffect"));return t?.fadeToBlack?{...e.getJson(),rate:t.fadeToBlack.rate}:void 0}}}}function Pi(r,i){return r.media.players?{[ii.MediaPlayerSource]:{type:"boolean",name:"Media player: Source",description:"If the specified media player has the specified source, change style of the bank",options:{mediaplayer:ar(r),source:or(r,i.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const r=i.state.media.players[t.getPlainNumber("mediaplayer")];return r?.sourceType===e.Enums.MediaSourceType.Still&&r?.stillIndex===t.getPlainNumber("source")||r?.sourceType===e.Enums.MediaSourceType.Clip&&r?.clipIndex===t.getPlainNumber("source")-re},learn:({options:e})=>{const t=i.state.media.players[e.getPlainNumber("mediaplayer")];return t?{...e.getJson(),source:t.sourceType?t.stillIndex:t.clipIndex+re}:void 0}},[ii.MediaPlayerSourceVariables]:{type:"boolean",name:"Media player: Source from variables",description:"If the specified media player has the specified source, change style of the bank",options:{mediaplayer:{id:"mediaplayer",type:"textinput",label:"Media Player",default:"1",useVariables:!0},isClip:r.media.clips>0?{type:"checkbox",id:"isClip",label:"Is clip",default:!1}:void 0,slot:{id:"slot",type:"textinput",label:"Slot",default:"1",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:t})=>{const[r,a]=await Promise.all([t.getParsedNumber("mediaplayer"),t.getParsedNumber("slot")]),o=t.getPlainBoolean("isClip"),n=i.state.media.players[r-1];return!o&&n?.sourceType===e.Enums.MediaSourceType.Still&&n?.stillIndex===a-1||!(!o||n?.sourceType!==e.Enums.MediaSourceType.Clip||n?.clipIndex!==a-1)},learn:async({options:e})=>{const t=await e.getParsedNumber("mediaplayer"),r=i.state.media.players[t-1];return r?{...e.getJson(),source:r.sourceType?r.stillIndex:r.clipIndex+re}:void 0}}}:{[ii.MediaPlayerSource]:void 0,[ii.MediaPlayerSourceVariables]:void 0}}const Ci=[{id:"ignore",label:"Ignored"},{id:"single",label:"Single"},{id:"quad",label:"Quad"}];function ki(r,i){return r.MVs?{[ii.MVSource]:{type:"boolean",name:"Multiviewer: Window source",description:"If the specified MV window is set to the specified source, change style of the bank",options:{multiViewerId:Kt(r),windowIndex:ir(r),source:rr(r,i.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=Rr(i.state,e.getPlainNumber("multiViewerId"),e.getPlainNumber("windowIndex"));return t?.source===e.getPlainNumber("source")},learn:({options:e})=>{const t=Rr(i.state,e.getPlainNumber("multiViewerId"),e.getPlainNumber("windowIndex"));return t?{...e.getJson(),source:t.source}:void 0}},[ii.MVSourceVariables]:{type:"boolean",name:"Multiviewer: Window source from variables",description:"If the specified MV window is set to the specified source, change style of the bank",options:{multiViewerId:{type:"textinput",id:"multiViewerId",label:"MV",default:"1",useVariables:!0},windowIndex:{type:"textinput",id:"windowIndex",label:"Window #",default:"1",useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"1",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("multiViewerId")-1,r=await e.getParsedNumber("windowIndex")-1,a=await e.getParsedNumber("source"),o=Rr(i.state,t,r);return o?.source===a},learn:async({options:e})=>{const t=await e.getParsedNumber("multiViewerId")-1,r=await e.getParsedNumber("windowIndex")-1,a=Rr(i.state,t,r);return a?{...e.getJson(),source:a.source+""}:void 0}},[ii.MultiviewerLayout]:{type:"boolean",name:"Multiviewer: Layout",options:{multiViewerId:{type:"textinput",id:"multiViewerId",label:"MV",default:"1",useVariables:!0},topLeft:{id:"topLeft",type:"dropdown",label:"Top left",choices:Ci,default:"ignore"},topRight:{id:"topRight",type:"dropdown",label:"Top right",choices:Ci,default:"ignore"},bottomLeft:{id:"bottomLeft",type:"dropdown",label:"Bottom left",choices:Ci,default:"ignore"},bottomRight:{id:"bottomRight",type:"dropdown",label:"Bottom right",choices:Ci,default:"ignore"}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:r})=>{const a=await r.getParsedNumber("multiViewerId")-1,o=Or(i.state,a),n=o?.properties?.layout??e.Enums.MultiViewerLayout.Default,s=(e,r)=>{switch(e){case"ignore":return!0;case"single":return 0==(n&r);case"quad":return(n&r)>0;default:return(0,t.assertNever)(e),!1}};return s(r.getPlainString("topLeft"),e.Enums.MultiViewerLayout.TopLeftSmall)&&s(r.getPlainString("topRight"),e.Enums.MultiViewerLayout.TopRightSmall)&&s(r.getPlainString("bottomLeft"),e.Enums.MultiViewerLayout.BottomLeftSmall)&&s(r.getPlainString("bottomRight"),e.Enums.MultiViewerLayout.BottomRightSmall)},learn:async({options:t})=>{const r=await t.getParsedNumber("multiViewerId")-1,a=Or(i.state,r);if(a?.properties){const r=a.properties.layout,i=e=>r&e?"quad":"single";return{...t.getJson(),topLeft:i(e.Enums.MultiViewerLayout.TopLeftSmall),topRight:i(e.Enums.MultiViewerLayout.TopRightSmall),bottomLeft:i(e.Enums.MultiViewerLayout.BottomLeftSmall),bottomRight:i(e.Enums.MultiViewerLayout.BottomRightSmall)}}}}}:{[ii.MVSource]:void 0,[ii.MVSourceVariables]:void 0,[ii.MultiviewerLayout]:void 0}}var Ai,Ii;function wi(e,r){return e.macros?{[ii.Macro]:{type:"boolean",name:"Macro: State",description:"If the specified macro is running or waiting, change style of the bank",options:{macroIndex:{type:"dropdown",label:"Macro Number (1-100)",id:"macroIndex",default:1,choices:q(e,r.state)},state:{type:"dropdown",label:"State",id:"state",default:Ai.IsWaiting,choices:[{id:Ai.IsRunning,label:"Is Running"},{id:Ai.IsWaiting,label:"Is Waiting"},{id:Ai.IsRecording,label:"Is Recording"},{id:Ai.IsUsed,label:"Is Used"}]}},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>{let t=e.getPlainNumber("macroIndex");if(!isNaN(t)){t-=1;const{macroPlayer:i,macroRecorder:a}=r.state.macro;switch(e.getPlainString("state")){case Ai.IsUsed:{const e=r.state.macro.macroProperties[t];return!!e?.isUsed}case Ai.IsRecording:return a.isRecording&&a.macroIndex===t;case Ai.IsRunning:return i.isRunning&&i.macroIndex===t;case Ai.IsWaiting:return i.isWaiting&&i.macroIndex===t}}return!1}},[ii.MacroLoop]:{type:"boolean",name:"Macro: Looping",description:"If the specified macro is looping, change style of the bank",options:{loop:{type:"checkbox",label:"Looping",id:"loop",default:!0}},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>e.getPlainBoolean("loop")===!!r.state.macro.macroPlayer.loop}}:{[ii.Macro]:void 0,[ii.MacroLoop]:void 0}}function _i(e,r){return 0===e.outputs.length?{[ii.AuxBG]:void 0,[ii.AuxVariables]:void 0}:{[ii.AuxBG]:{type:"boolean",name:"Aux/Output: Source",description:"If the input specified is selected in the aux bus specified, change style of the bank",options:{aux:jt(e),input:zt(e,r.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>r.state.video.auxilliaries[e.getPlainNumber("aux")]===e.getPlainNumber("input"),learn:({options:e})=>{const t=r.state.video.auxilliaries[e.getPlainNumber("aux")];return void 0!==t?{...e.getJson(),input:t}:void 0}},[ii.AuxVariables]:{type:"boolean",name:"Aux/Output: Source from variables",description:"If the input specified is selected in the aux bus specified, change style of the bank",options:{aux:{type:"textinput",id:"aux",label:"AUX",default:"1",useVariables:!0},input:{type:"textinput",id:"input",label:"Input ID",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("aux")-1,i=await e.getParsedNumber("input");return r.state.video.auxilliaries[t]===i},learn:async({options:e})=>{const t=await e.getParsedNumber("aux")-1,i=r.state.video.auxilliaries[t];return void 0!==i?{...e.getJson(),input:i+""}:void 0}}}}function xi(r,i){return r.recording?{[ii.RecordStatus]:{type:"boolean",name:"Recording: Active/Running",description:"If the record has the specified status, change style of the bank",options:{state:{id:"state",label:"State",type:"dropdown",choices:Object.entries(e.Enums.RecordingStatus).filter((([e,t])=>"number"==typeof t)).map((([e,t])=>({id:t,label:e}))),default:e.Enums.RecordingStatus.Recording}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.recording?.status?.state;return t===e.getPlainNumber("state")},learn:({options:e})=>i.state.recording?.status?{...e.getJson(),state:i.state.recording.status.state}:void 0},[ii.RecordISO]:{type:"boolean",name:"Recording: ISO enabled",description:"If ISO recording is enabled",options:{},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:()=>!!i.state.recording?.recordAllInputs}}:{[ii.RecordStatus]:void 0,[ii.RecordISO]:void 0}}function Ei(r,i){return r.streaming?{[ii.StreamStatus]:{type:"boolean",name:"Streaming: Active/Running",description:"If the stream has the specified status, change style of the bank",options:{state:{id:"state",label:"State",type:"dropdown",choices:Object.entries(e.Enums.StreamingStatus).filter((([e,t])=>"number"==typeof t)).map((([e,t])=>({id:t,label:e}))),default:e.Enums.StreamingStatus.Streaming}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=i.state.streaming?.status?.state;return t===e.getPlainNumber("state")},learn:({options:e})=>i.state.streaming?.status?{...e.getJson(),state:i.state.streaming.status.state}:void 0}}:{[ii.StreamStatus]:void 0}}function Mi(e,r){return e.DSKs?{[ii.DSKOnAir]:{type:"boolean",name:"Downstream key: OnAir",description:"If the specified downstream keyer is onair, change style of the bank",options:{key:Ot(e)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return!!t?.onAir}},[ii.DSKTie]:{type:"boolean",name:"Downstream key: Tied",description:"If the specified downstream keyer is tied, change style of the bank",options:{key:Ot(e)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return!!t?.properties?.tie}},[ii.DSKSource]:{type:"boolean",name:"Downstream key: Fill source",description:"If the input specified is selected in the DSK specified, change style of the bank",options:{key:Ot(e),fill:Ut(e,r.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return t?.sources?.fillSource===e.getPlainNumber("fill")},learn:({options:e})=>{const t=Tr(r.state,e.getPlainNumber("key"));return t?.sources?{...e.getJson(),fill:t.sources.fillSource}:void 0}},[ii.DSKSourceVariables]:{type:"boolean",name:"Downstream key: Fill source from variables",description:"If the input specified is selected in the DSK specified, change style of the bank",options:{key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},fill:{type:"textinput",id:"fill",label:"Fill Source",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("key")-1,i=await e.getParsedNumber("fill"),a=Tr(r.state,t);return a?.sources?.fillSource===i},learn:async({options:e})=>{const t=await e.getParsedNumber("key")-1,i=Tr(r.state,t);return i?.sources?{...e.getJson(),fill:i.sources.fillSource+""}:void 0}}}:{[ii.DSKOnAir]:void 0,[ii.DSKTie]:void 0,[ii.DSKSource]:void 0,[ii.DSKSourceVariables]:void 0}}function Ti(e,r){return e.USKs?{[ii.USKOnAir]:{type:"boolean",name:"Upstream key: OnAir state",description:"If the specified upstream keyer is active, change style of the bank",options:{mixeffect:Nt(e,0),key:Ft(e)},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return!!t?.onAir}},[ii.USKType]:{type:"boolean",name:"Upstream key: Key type",description:"If the specified upstream keyer has the specified type, change style of the bank",options:{mixeffect:Nt(e,0),key:Ft(e),type:_t()},defaultStyle:{color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(255,0,0)},callback:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.mixEffectKeyType===e.getPlainNumber("type")}},[ii.USKSource]:{type:"boolean",name:"Upstream key: Fill source",description:"If the input specified is selected in the USK specified, change style of the bank",options:{mixeffect:Nt(e,0),key:Ft(e),fill:Ut(e,r.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.fillSource===e.getPlainNumber("fill")},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?{...e.getJson(),fill:t.fillSource}:void 0}},[ii.USKSourceVariables]:{type:"boolean",name:"Upstream key: Fill source from variables",description:"If the input specified is selected in the USK specified, change style of the bank",options:{mixeffect:{type:"textinput",id:"mixeffect",label:"M/E",default:"1",useVariables:!0},key:{type:"textinput",label:"Key",id:"key",default:"1",useVariables:!0},fill:{type:"textinput",id:"fill",label:"Fill Source",default:"0",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("key")-1,a=await e.getParsedNumber("fill"),o=Mr(r.state,t,i);return o?.fillSource===a},learn:async({options:e})=>{const t=await e.getParsedNumber("mixeffect")-1,i=await e.getParsedNumber("key")-1,a=Mr(r.state,t,i);return a?{...e.getJson(),fill:a.fillSource+""}:void 0}},[ii.USKKeyFrame]:e.DVEs?{type:"boolean",name:"Upstream key: Key frame",description:"If the USK specified is at the Key Frame specified, change style of the bank",options:{mixeffect:Nt(e,0),key:Ft(e),keyframe:{type:"dropdown",id:"keyframe",label:"Key Frame",choices:V,default:V[0].id}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(238,238,0)},callback:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.flyProperties?.isAtKeyFrame===Number(e.getPlainNumber("keyframe"))},learn:({options:e})=>{const t=Mr(r.state,e.getPlainNumber("mixeffect"),e.getPlainNumber("key"));return t?.flyProperties?{...e.getJson(),keyframe:t.flyProperties.isAtKeyFrame}:void 0}}:void 0}:{[ii.USKOnAir]:void 0,[ii.USKType]:void 0,[ii.USKSource]:void 0,[ii.USKSourceVariables]:void 0,[ii.USKKeyFrame]:void 0}}function Ni(r,i){return{[ii.PreviewTransition]:{type:"boolean",name:"Transition: Preview",description:"If the specified transition is being previewed, change style of the bank",options:{mixeffect:Nt(r,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=xr(i.state,e.getPlainNumber("mixeffect"));return!!t?.transitionPreview},learn:({options:e})=>{const t=xr(i.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),state:t.transitionPreview+""}:void 0}},[ii.TransitionStyle]:{type:"boolean",name:"Transition: Style",description:"If the specified transition style is active, change style of the bank",options:{mixeffect:Nt(r,0),style:wt(0===r.media.clips)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=xr(i.state,e.getPlainNumber("mixeffect"));return t?.transitionProperties.nextStyle===e.getPlainNumber("style")},learn:({options:e})=>{const t=xr(i.state,e.getPlainNumber("mixeffect"));return t?{...e.getJson(),style:t.transitionProperties.nextStyle}:void 0}},[ii.TransitionSelection]:{type:"boolean",name:"Transition: Selection",description:"If the specified transition selection is active, change style of the bank",options:{mixeffect:Nt(r,0),matchmethod:{id:"matchmethod",label:"Match method",type:"dropdown",default:"exact",choices:[{id:"exact",label:"Exact"},{id:"contains",label:"Contains"},{id:"not-contain",label:"Not Contain"}]},selection:Mt(r)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=xr(i.state,e.getPlainNumber("mixeffect")),a=se(r.USKs,e.getRaw("selection"));if(t)switch(e.getPlainString("matchmethod")){case"exact":return t.transitionProperties.nextSelection.join(",")===a.join(",");case"contains":return a.every((e=>t.transitionProperties.nextSelection.includes(e)));case"not-contain":return!a.find((e=>t.transitionProperties.nextSelection.includes(e)))}return!1}},[ii.TransitionRate]:{type:"boolean",name:"Transition: Rate",description:"If the specified transition rate is active, change style of the bank",options:{mixeffect:Nt(r,0),style:wt(!0),rate:xt("Transition Rate")},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const r=xr(i.state,t.getPlainNumber("mixeffect"));if(r?.transitionSettings){const i=t.getPlainNumber("style"),a=t.getPlainNumber("rate");switch(i){case e.Enums.TransitionStyle.MIX:return r.transitionSettings.mix?.rate===a;case e.Enums.TransitionStyle.DIP:return r.transitionSettings.dip?.rate===a;case e.Enums.TransitionStyle.WIPE:return r.transitionSettings.wipe?.rate===a;case e.Enums.TransitionStyle.DVE:return r.transitionSettings.DVE?.rate===a;case e.Enums.TransitionStyle.STING:}}return!1},learn:({options:t})=>{const r=xr(i.state,t.getPlainNumber("mixeffect"));if(r?.transitionSettings){switch(t.getPlainNumber("style")){case e.Enums.TransitionStyle.MIX:return{...t.getJson(),rate:r.transitionSettings.mix?.rate??1};case e.Enums.TransitionStyle.DIP:return{...t.getJson(),rate:r.transitionSettings.dip?.rate??1};case e.Enums.TransitionStyle.WIPE:return{...t.getJson(),rate:r.transitionSettings.wipe?.rate??1};case e.Enums.TransitionStyle.DVE:return{...t.getJson(),rate:r.transitionSettings.DVE?.rate??1};case e.Enums.TransitionStyle.STING:default:return}}}},[ii.InTransition]:{type:"boolean",name:"Transition: Active/Running",description:"If the specified transition is active, change style of the bank",options:{mixeffect:Nt(r,0)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>{const t=xr(i.state,e.getPlainNumber("mixeffect"));return!!t?.transitionPosition?.inTransition}}}}function Oi(e,t,r,i=1){const a=e*r;return i&&(t=i*Math.round(t/i)),a===t}function Ri(e,r){return e.SSrc?{[ii.SSrcArtProperties]:{type:"boolean",name:"Supersource: Art properties",description:"If the specified SuperSource art properties match, change style of the bank",options:{ssrcId:Ht(e),...Xt(e,r.state,!1)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,At.hn)(r.state,i).properties,o=t.getRaw("properties");return!(!(a&&o&&Array.isArray(o))||o.includes("fill")&&a.artFillSource!==t.getPlainNumber("fill")||o.includes("key")&&a.artCutSource!==t.getPlainNumber("key")||o.includes("artOption")&&a.artOption!==t.getRaw("artOption")||o.includes("artPreMultiplied")&&a.artPreMultiplied!==t.getPlainBoolean("artPreMultiplied")||o.includes("artClip")&&!Oi(t.getPlainNumber("artClip"),a.artClip,10)||o.includes("artGain")&&!Oi(t.getPlainNumber("artGain"),a.artGain,10)||o.includes("artInvertKey")&&a.artInvertKey!==t.getPlainBoolean("artInvertKey"))},learn:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=r.state.video.superSources?.[i]?.properties;return a?{...t.getJson(),fill:a.artFillSource,key:a.artCutSource,artOption:a.artOption,artPreMultiplied:a.artPreMultiplied,artClip:a.artClip/10,artGain:a.artGain/10,artInvertKey:a.artInvertKey}:void 0}},[ii.SSrcArtPropertiesVariables]:{type:"boolean",name:"Supersource: Art sources from variables",description:"If the specified SuperSource art properties match, change style of the bank",options:{ssrcId:Ht(e),...Qt()},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,At.hn)(r.state,i).properties,o=t.getRaw("properties");if(!a||!o||!Array.isArray(o))return!1;const n=[],s=(e,t)=>n.push(t.then((t=>a[e]==t)));o.includes("fill")&&s("artFillSource",t.getParsedNumber("fill")),o.includes("key")&&s("artCutSource",t.getParsedNumber("key"));const l=await Promise.all(n);for(const e of l)if(!e)return!1;return!0},learn:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=r.state.video.superSources?.[i]?.properties;return a?{...t.getJson(),fill:a.artFillSource+"",key:a.artCutSource+""}:void 0}},[ii.SSrcArtSource]:{type:"boolean",name:"Supersource: Art fill source",description:"If the specified SuperSource art fill is set to the specified source, change style of the bank",options:{ssrcId:Ht(e),source:er(e,r.state,"source","Fill Source")},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,At.hn)(r.state,i);return a.properties?.artFillSource===t.getPlainNumber("source")},learn:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,At.hn)(r.state,i);return a.properties?{...t.getJson(),source:a.properties.artFillSource}:void 0}},[ii.SSrcArtOption]:{type:"boolean",name:"Supersource: Art placement",description:"If the specified SuperSource art is placed in the foreground/background, change style of the bank",options:{ssrcId:Ht(e),artOption:qt(!1)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,At.hn)(r.state,i);return a.properties?.artOption===t.getRaw("artOption")},learn:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=(0,At.hn)(r.state,i);return a.properties?{...t.getJson(),artOption:a.properties.artOption}:void 0}},[ii.SSrcBoxSource]:{type:"boolean",name:"Supersource: Box source",description:"If the specified SuperSource box is set to the specified source, change style of the bank",options:{ssrcId:Ht(e),boxIndex:Wt(),source:tr(e,r.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=Nr(r.state,t.getPlainNumber("boxIndex"),i);return a?.source===t.getPlainNumber("source")},learn:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=Nr(r.state,t.getPlainNumber("boxIndex"),i);return a?{...t.getJson(),source:a.source}:void 0}},[ii.SSrcBoxSourceVariables]:{type:"boolean",name:"Supersource: Box source from variables",description:"If the specified SuperSource box is set to the specified source, change style of the bank",options:{ssrcId:e.SSrc>1?{type:"textinput",id:"ssrcId",label:"Super Source",default:"1",useVariables:!0}:void 0,boxIndex:{type:"textinput",id:"boxIndex",label:"Box #",default:"1",useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"1",useVariables:!0}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:async({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(await t.getParsedNumber("ssrcId"))-1:0,a=await t.getParsedNumber("boxIndex")-1,o=await t.getParsedNumber("source"),n=Nr(r.state,a,i);return n?.source===o},learn:async({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(await t.getParsedNumber("ssrcId"))-1:0,a=await t.getParsedNumber("boxIndex")-1,o=Nr(r.state,a,i);return o?{...t.getJson(),source:o.source+""}:void 0}},[ii.SSrcBoxOnAir]:{type:"boolean",name:"Supersource: Box state",description:"If the specified SuperSource box is enabled, change style of the bank",options:{ssrcId:Ht(e),boxIndex:Wt()},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=Nr(r.state,t.getPlainNumber("boxIndex"),i);return!(!a||!a.enabled)}},[ii.SSrcBoxProperties]:{type:"boolean",name:"Supersource: Box properties",description:"If the specified SuperSource box properties match, change style of the bank",options:{ssrcId:Ht(e),boxIndex:Wt(),...Jt(e,r.state)},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=Nr(r.state,t.getPlainNumber("boxIndex"),i),o=t.getRaw("properties");if(!a||!o||!Array.isArray(o))return!1;if(o.includes("source")&&a.source!==t.getPlainNumber("source"))return!1;if(o.includes("size")&&!Oi(t.getPlainNumber("size"),a.size,1e3,10))return!1;if(o.includes("x")&&!Oi(t.getPlainNumber("x"),a.x,100))return!1;if(o.includes("y")&&!Oi(t.getPlainNumber("y"),a.y,100))return!1;if(o.includes("cropEnable")&&a.cropped!==t.getPlainBoolean("cropEnable"))return!1;if(a.cropped){if(o.includes("cropTop")&&!Oi(t.getPlainNumber("cropTop"),a.cropTop,1e3,10))return!1;if(o.includes("cropBottom")&&!Oi(t.getPlainNumber("cropBottom"),a.cropBottom,1e3,10))return!1;if(o.includes("cropLeft")&&!Oi(t.getPlainNumber("cropLeft"),a.cropLeft,1e3,10))return!1;if(o.includes("cropRight")&&!Oi(t.getPlainNumber("cropRight"),a.cropRight,1e3,10))return!1}return!0},learn:({options:t})=>{const i=t.getRaw("ssrcId")&&e.SSrc>1?Number(t.getRaw("ssrcId")):0,a=t.getPlainNumber("boxIndex"),o=r.state.video.superSources?.[i]?.boxes[a];return o?{...t.getJson(),source:o.source,size:o.size/1e3,x:o.x/100,y:o.y/100,cropEnable:o.cropped,cropTop:o.cropTop/1e3,cropBottom:o.cropBottom/1e3,cropLeft:o.cropLeft/1e3,cropRight:o.cropRight/1e3}:void 0}}}:{[ii.SSrcArtProperties]:void 0,[ii.SSrcArtPropertiesVariables]:void 0,[ii.SSrcArtSource]:void 0,[ii.SSrcArtOption]:void 0,[ii.SSrcBoxSource]:void 0,[ii.SSrcBoxSourceVariables]:void 0,[ii.SSrcBoxOnAir]:void 0,[ii.SSrcBoxProperties]:void 0}}function Di(e,r){if(!e.classicAudio)return{[ii.ClassicAudioGain]:void 0,[ii.ClassicAudioMixOption]:void 0,[ii.ClassicAudioMasterGain]:void 0};const i=nr(e,r.state);return{[ii.ClassicAudioGain]:{type:"boolean",name:"Classic Audio: Audio gain",description:"If the audio input has the specified gain, change style of the bank",options:{input:i,comparitor:lr(),gain:{type:"number",label:"Fader Level (-60 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:6}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=(r.state.audio?.channels??{})[e.getPlainNumber("input")];return!(!t||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t.gain))},learn:({options:e})=>{const t=(r.state.audio?.channels??{})[e.getPlainNumber("input")];return t?{...e.getJson(),gain:t.gain}:void 0}},[ii.ClassicAudioMixOption]:{type:"boolean",name:"Classic Audio: Mix option",description:"If the audio input has the specified mix option, change style of the bank",options:{input:i,option:{id:"option",label:"Mix option",type:"dropdown",default:B[0].id,choices:B}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=(r.state.audio?.channels??{})[e.getPlainNumber("input")];return t?.mixOption===e.getPlainNumber("option")},learn:({options:e})=>{const t=(r.state.audio?.channels??{})[e.getPlainNumber("input")];return t?{...e.getJson(),option:t.mixOption}:void 0}},[ii.ClassicAudioMasterGain]:{type:"boolean",name:"Classic Audio: Master gain",description:"If the audio master has the specified gain, change style of the bank",options:{comparitor:lr(),gain:{type:"number",label:"Fader Level (-60 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:6}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.audio?.master;return!(!t||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t.gain))},learn:({options:e})=>{const t=r.state.audio?.master;return t?{...e.getJson(),gain:t.gain}:void 0}}}}function Fi(e,r){if(!e.fairlightAudio)return{[ii.FairlightAudioInputGain]:void 0,[ii.FairlightAudioFaderGain]:void 0,[ii.FairlightAudioMixOption]:void 0,[ii.FairlightAudioMasterGain]:void 0,[ii.FairlightAudioMonitorSolo]:void 0,[ii.FairlightAudioMonitorOutputFaderGain]:void 0,[ii.FairlightAudioMonitorMasterMuted]:void 0,[ii.FairlightAudioMonitorMasterGain]:void 0,[ii.FairlightAudioMonitorTalkbackMuted]:void 0,[ii.FairlightAudioMonitorTalkbackGain]:void 0,[ii.FairlightAudioMonitorSidetoneGain]:void 0,[ii.FairlightAudioRouting]:void 0,[ii.FairlightAudioRoutingVariables]:void 0};const i=nr(e,r.state),a=sr();return{[ii.FairlightAudioInputGain]:{type:"boolean",name:"Fairlight Audio: Audio input gain",description:"If the audio input has the specified input gain, change style of the bank",options:{input:i,source:a,comparitor:lr(),gain:{type:"number",label:"Input Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:6}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return!(!i?.properties||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),i.properties.gain/100))},learn:({options:e})=>{const t=r.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?{...e.getJson(),gain:i.properties.gain/100}:void 0}},[ii.FairlightAudioFaderGain]:{type:"boolean",name:"Fairlight Audio: Audio fader gain",description:"If the audio input has the specified fader gain, change style of the bank",options:{input:i,source:a,comparitor:lr(),gain:{type:"number",label:"Fader Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return!(!i?.properties||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),i.properties.faderGain/100))},learn:({options:e})=>{const t=r.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?{...e.getJson(),gain:i.properties.faderGain/100}:void 0}},[ii.FairlightAudioMixOption]:{type:"boolean",name:"Fairlight Audio: Audio mix option",description:"If the audio input has the specified mix option, change style of the bank",options:{input:i,source:a,option:{id:"option",label:"Mix option",type:"dropdown",default:L[0].id,choices:L}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?.mixOption===e.getPlainNumber("option")},learn:({options:e})=>{const t=r.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?{...e.getJson(),option:i.properties.mixOption}:void 0}},[ii.FairlightAudioMasterGain]:{type:"boolean",name:"Fairlight Audio: Master fader gain",description:"If the master has the specified fader gain, change style of the bank",options:{comparitor:lr(),gain:{type:"number",label:"Fader Level (-100 = -inf)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-100,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.master?.properties;return!(!t||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t.faderGain/100))},learn:({options:e})=>{const t=r.state.fairlight?.master?.properties;return t?{...e.getJson(),gain:t.faderGain/100}:void 0}},[ii.FairlightAudioMonitorSolo]:e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Solo source",description:"If the specified source is soloed, change style of the bank",options:{nothing:{id:"nothing",type:"checkbox",label:"No solo",default:!1},input:{...i,isVisible:e=>!e.nothing},source:{...a,isVisible:e=>!e.nothing}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.solo;return e.getPlainBoolean("nothing")?!t?.solo:!!t?.solo&&t?.index===e.getPlainNumber("input")&&t?.source===e.getPlainString("source")},learn:({options:e})=>{const t=r.state.fairlight?.inputs??{},i=(t[e.getPlainNumber("input")]?.sources??{})[e.getPlainString("source")];return i?.properties?{...e.getJson(),gain:i.properties.faderGain/100}:void 0}}:void 0,[ii.FairlightAudioMonitorOutputFaderGain]:e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone Gain",description:"If the headphone/monitor has the specified fader gain, change style of the bank",options:{comparitor:lr(),gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.monitor?.gain;return!("number"!=typeof t||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t/100))},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.gain/100}:void 0}}:void 0,[ii.FairlightAudioMonitorMasterMuted]:e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone Master muted",description:"If the headphone master is muted, change style of the bank",options:{},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:()=>!!r.state.fairlight?.monitor?.inputMasterMuted}:void 0,[ii.FairlightAudioMonitorMasterGain]:"split"===e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone master Gain",description:"If the headphone/monitor has the specified master gain, change style of the bank",options:{comparitor:lr(),gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.monitor?.inputMasterGain;return!("number"!=typeof t||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t/100))},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputMasterGain/100}:void 0}}:void 0,[ii.FairlightAudioMonitorTalkbackMuted]:e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone Talkback muted",description:"If the headphone talkback is muted, change style of the bank",options:{},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:()=>!!r.state.fairlight?.monitor?.inputTalkbackMuted}:void 0,[ii.FairlightAudioMonitorTalkbackGain]:"split"===e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone talkback Gain",description:"If the headphone/monitor has the specified talkback gain, change style of the bank",options:{comparitor:lr(),gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.monitor?.inputTalkbackGain;return!("number"!=typeof t||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t/100))},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputTalkbackGain/100}:void 0}}:void 0,[ii.FairlightAudioMonitorSidetoneGain]:"split"===e.fairlightAudio.monitor?{type:"boolean",name:"Fairlight Audio: Monitor/Headphone sidetone Gain",description:"If the headphone/monitor has the specified sidetone gain, change style of the bank",options:{comparitor:lr(),gain:{type:"number",label:"Fader Level (-60 = Min)",id:"gain",range:!0,required:!0,default:0,step:.1,min:-60,max:10}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(0,255,0)},callback:({options:e})=>{const t=r.state.fairlight?.monitor?.inputSidetoneGain;return!("number"!=typeof t||!ce(e.getPlainNumber("gain"),e.getPlainString("comparitor"),t/100))},learn:({options:e})=>{const t=r.state.fairlight?.monitor;return t?{...e.getJson(),gain:t.inputSidetoneGain/100}:void 0}}:void 0,...Vi(e,r)}}function Vi(e,t){return e.fairlightAudio?.audioRouting?{[ii.FairlightAudioRouting]:{type:"boolean",name:"Fairlight Audio: Audio Routing",description:"Requires firmware 9.4+",options:{destination:fr(e,t.state),source:mr(e,t.state)},defaultStyle:{color:0,bgcolor:65280},callback:async({options:e})=>{const r=t.state.fairlight?.audioRouting?.outputs;if(!r)return!1;const i=e.getPlainNumber("source"),a=r[e.getPlainNumber("destination")];return a&&a.sourceId===i}},[ii.FairlightAudioRoutingVariables]:{type:"boolean",name:"Fairlight Audio: Audio Routing from variables",description:"Requires firmware 9.4+",options:{destination:{type:"textinput",id:"destination",label:"Destination",default:"1-1",tooltip:'IDs are formed as "output-channel". channel can be omitted when wanting "1/2" eg 1503-3_4 for "MADI 3 3/4"',useVariables:!0},source:{type:"textinput",id:"source",label:"Source",default:"0",tooltip:'IDs are formed as "output-channel". channel can be omitted when wanting "1/2" eg 1503-3_4 for "MADI 3 3/4"',useVariables:!0}},defaultStyle:{color:0,bgcolor:65280},callback:async({options:e})=>{const r=t.state.fairlight?.audioRouting?.outputs;if(!r)return!1;const[i,a]=await Promise.all([e.getParsedString("source"),e.getParsedString("destination")]);if(!a||!i)return!1;const o=be(i)??0,n=be(a);if(!n)return!1;const s=r[n];return s&&s.sourceId===o}}}:{[ii.FairlightAudioRouting]:void 0,[ii.FairlightAudioRoutingVariables]:void 0}}function $i(r,i,a){return r.pollTimecode?{[ii.TimecodeMode]:{type:"boolean",name:"Timecode: Mode",description:"If the timecode mode is as specified",options:{mode:{id:"mode",type:"dropdown",label:"Mode",choices:[{id:e.Enums.TimeMode.FreeRun,label:"Free run"},{id:e.Enums.TimeMode.TimeOfDay,label:"Time of Day"}],default:e.Enums.TimeMode.FreeRun}},defaultStyle:{color:(0,t.combineRgb)(0,0,0),bgcolor:(0,t.combineRgb)(255,255,0)},callback:({options:e})=>a.state.settings.timeMode===e.getPlainNumber("mode"),learn:({options:t})=>({...t.getJson(),mode:a.state.settings.timeMode??e.Enums.TimeMode.FreeRun})}}:{[ii.TimecodeMode]:void 0}}(Ii=Ai||(Ai={})).IsRunning="isRunning",Ii.IsWaiting="isWaiting",Ii.IsRecording="isRecording",Ii.IsUsed="isUsed";const Bi={crop:{id:"crop",type:"dropdown",label:"Crop",default:"none",choices:[{id:"none",label:"None"},{id:"left",label:"Left"},{id:"center",label:"Center"},{id:"right",label:"Right"}]},position:{id:"position",type:"dropdown",label:"Position",default:"center",choices:[{id:"top",label:"Top"},{id:"center",label:"Center"},{id:"bottom",label:"Bottom"}],isVisible:e=>"none"===e.crop}};function Li(e,t){return e.media.players?{[ii.MediaPoolPreview]:{type:"advanced",name:"Media pool: Preview image",description:"Preview of the specified media pool slot",options:{source:or(e,t.state),...Bi},callback:async({options:e,image:r})=>{const i=Ki(e.getPlainNumber("source"));if(!r)return{};const a={crop:e.getPlainString("crop"),position:e.getPlainString("position"),buttonHeight:r.height,buttonWidth:r.width};return ji(t,a,i)},subscribe:({id:e,options:r})=>{const i=Ki(r.getPlainNumber("source"));t.mediaPoolCache.subscribe(i,e)},unsubscribe:({id:e})=>{t.mediaPoolCache.unsubscribe(e)}},[ii.MediaPoolPreviewVariables]:{type:"advanced",name:"Media pool: Preview image from variables",description:"Preview of the specified media pool slot",options:{isClip:e.media.clips>0?{type:"checkbox",id:"isClip",label:"Is clip",default:!1}:void 0,slot:{id:"slot",type:"textinput",label:"Slot",default:"1",useVariables:{local:!0}},...Bi},callback:async({options:r,image:i})=>{if(!i)return{};const a={slot:await r.getParsedNumber("slot")-1,isClip:e.media.clips>0&&r.getPlainBoolean("isClip"),frameIndex:0},o={crop:r.getPlainString("crop"),position:r.getPlainString("position"),buttonHeight:i.height,buttonWidth:i.width};return ji(t,o,a)},subscribe:async({id:r,options:i})=>{t.mediaPoolCache.subscribe({slot:await i.getParsedNumber("slot")-1,isClip:e.media.clips>0&&i.getPlainBoolean("isClip"),frameIndex:0},r)},unsubscribe:async({id:e})=>{t.mediaPoolCache.unsubscribe(e)}}}:{[ii.MediaPoolPreview]:void 0,[ii.MediaPoolPreviewVariables]:void 0}}async function ji(e,t,r){const i=await e.mediaPoolCache.getPreviewImage(r,t);return i||(e.mediaPoolCache.ensureLoaded(r),e.mediaPoolCache.isSlotOccupied(r)?{text:"Loading...",size:"auto",bgcolor:0,color:16777215}:{text:"Empty",size:"auto",bgcolor:0,color:16777215})}function Ki(e){const t=e>=re;return{slot:t?e-re:e,isClip:t,frameIndex:0}}function Ui(r){return r.streaming?[{name:"Streaming & Recording",presets:{streaming_toggle:{name:"Stream",type:"button",style:{text:"Stream\\n$(atem:stream_duration_hm)",size:"18",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.StreamStatus,options:{state:e.Enums.StreamingStatus.Streaming},style:{bgcolor:(0,t.combineRgb)(0,255,0),color:(0,t.combineRgb)(0,0,0)}},{feedbackId:ii.StreamStatus,options:{state:e.Enums.StreamingStatus.Stopping},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}},{feedbackId:ii.StreamStatus,options:{state:e.Enums.StreamingStatus.Connecting},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.StreamStartStop,options:{stream:"toggle"}}],up:[]}]}}}]:[]}function Gi(r){return r.recording?[{name:"Streaming & Recording",presets:{recording_toggle:{name:"Record",type:"button",style:{text:"Record\\n$(atem:record_duration_hm)",size:"18",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.RecordStatus,options:{state:e.Enums.RecordingStatus.Recording},style:{bgcolor:(0,t.combineRgb)(0,255,0),color:(0,t.combineRgb)(0,0,0)}},{feedbackId:ii.RecordStatus,options:{state:e.Enums.RecordingStatus.Stopping},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.RecordStartStop,options:{record:"toggle"}}],up:[]}]}}}]:[]}function zi(e){return{actionId:String(e.actionId),headline:void 0,options:e.options,delay:e.delay}}function Wi(e){const t={name:void 0,up:e.up.map(zi),down:e.down.map(zi),rotate_left:e.rotate_left?.map(zi),rotate_right:e.rotate_right?.map(zi)},r=Object.keys(e).map((e=>Number(e))).filter((e=>!isNaN(e)));for(const i of r){const r=e[i];r&&(t[i]=Array.isArray(r)?r.map(zi):{options:r.options,actions:r.actions.map(zi)})}return t}function Hi(e,t){return{type:e.type,name:e.name,category:t.name,style:e.style,previewStyle:e.previewStyle,options:e.options,feedbacks:e.feedbacks.map((e=>({feedbackId:String(e.feedbackId),headline:void 0,options:e.options,style:e.style,isInverted:e.isInverted}))),steps:e.steps.map(Wi)}}function qi(e,r,i){const a=[];for(let o=0;o<e.MEs;++o){const e={name:`Fade to black (M/E ${o+1})`,presets:{[`ftb_auto_${o}`]:{name:"Auto fade",type:"button",style:{text:"FTB Auto",size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.FadeToBlackIsBlack,options:{mixeffect:o,state:"off"},style:{bgcolor:(0,t.combineRgb)(0,255,0),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:ii.FadeToBlackIsBlack,options:{mixeffect:o,state:"on"},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:ii.FadeToBlackIsBlack,options:{mixeffect:o,state:"fading"},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.FadeToBlackAuto,options:{mixeffect:o}}],up:[]}]}}};for(const a of i)e.presets[`ftb_rate_${o}_${a}`]={name:`Rate ${a}`,type:"button",style:{text:`Rate ${a}`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.FadeToBlackRate,options:{mixeffect:o,rate:a},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.FadeToBlackRate,options:{mixeffect:o,rate:a}}],up:[]}]};a.push(e)}return a}function Ji(e,r){const i=[];for(let a=0;a<e.media.players;a++){const o={name:`Mediaplayer ${a+1}`,presets:{}};for(let i=0;i<e.media.clips;i++)o.presets[`mediaplayer_clip_${a}_${i}`]={name:`Set Mediaplayer ${a+1} source to clip ${i+1}`,type:"button",style:{text:`MP ${a+1} Clip ${i+1}`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.MediaPlayerSource,options:{mediaplayer:a,source:i+re},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.MediaPlayerSource,options:{mediaplayer:a,source:i+re}}],up:[]}]};for(let i=0;i<e.media.stills;i++)o.presets[`mediaplayer_still_${a}_${i}`]={name:`Set Mediaplayer ${a+1} source to still ${i+1}`,type:"button",style:{text:`MP ${a+1} Still ${i+1}`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.MediaPlayerSource,options:{mediaplayer:a,source:i},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.MediaPlayerSource,options:{mediaplayer:a,source:i}}],up:[]}]};i.push(o)}return i}function Yi(e,r,i,a){const o=[];for(let n=0;n<e.SSrc;n++){const e={name:`SSrc ${n+1} Boxes`,presets:{}};o.push(e);for(let s=0;s<4;s++){e.presets[`ssrc_box_onair_${n}_${s}`]={name:`Toggle SuperSource ${n+1} Box ${s+1} visibility`,type:"button",style:{text:`Box ${s+1}`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.SSrcBoxOnAir,options:{ssrcId:n,boxIndex:s},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.SuperSourceBoxOnAir,options:{ssrcId:n,onair:"toggle",boxIndex:s}}],up:[]}]};const l={name:`SSrc ${n+1} Box ${s+1}`,presets:{}};o.push(l);for(const e of a)l.presets[`ssrc_box_src_${n}_${s}_${e.id}`]={name:`Set SuperSource ${n+1} Box ${s+1} to source ${e.shortName}`,type:"button",style:{text:`$(atem:${i}${e.id})`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.SSrcBoxSource,options:{ssrcId:n,source:e.id,boxIndex:s},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.SuperSourceBoxSource,options:{ssrcId:n,source:e.id,boxIndex:s}}],up:[]}]}}}return o}function Xi(e,r,i,a){const o=[];for(let n=0;n<e.MVs;n++){const s=e.multiviewerFullGrid?0:2,l=e.multiviewerFullGrid?16:10;for(let u=s;u<l;u++){const s={name:`MV ${n+1} Window ${u+1}`,presets:{}};o.push(s);for(const o of Y(e,r,"mv"))s.presets[`mv_win_src_${n}_${u}_${o.id}`]={name:`Set MV ${n+1} Window ${u+1} to source ${o.shortName}`,type:"button",style:{text:`$(atem:${a}${o.id})`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.MVSource,options:{multiViewerId:n,source:o.id,windowIndex:u},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.MultiviewerWindowSource,options:{multiViewerId:n,source:o.id,windowIndex:u}}],up:[]}]}}}return o}function Qi(e){const r=[],i={name:"MACROS",presets:{}};r.push(i);for(let r=0;r<e.macros;r++)i.presets[`macro_run_${r}`]={name:`Run button for macro ${r+1}`,type:"button",style:{text:`$(atem:macro_${r+1})`,size:"auto",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.Macro,options:{macroIndex:r+1,state:Ai.IsUsed},style:{bgcolor:(0,t.combineRgb)(0,0,238),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:ii.Macro,options:{macroIndex:r+1,state:Ai.IsRunning},style:{bgcolor:(0,t.combineRgb)(0,238,0),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:ii.Macro,options:{macroIndex:r+1,state:Ai.IsWaiting},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(255,255,255)}},{feedbackId:ii.Macro,options:{macroIndex:r+1,state:Ai.IsRecording},style:{bgcolor:(0,t.combineRgb)(238,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:vr.MacroRun,options:{macro:r+1,action:"runContinue"}}],up:[]}]};return r}function Zi(e,r,i,a){const o=[];for(let n=0;n<e.MEs;++n){const e={name:`Preview (M/E ${n+1})`,presets:{}},s={name:`Program (M/E ${n+1})`,presets:{}};o.push(e,s);for(const o of a)e.presets[`preview_me_${n}_${o.id}`]={name:`Preview button for ${o.shortName}`,type:"button",style:{text:`$(atem:${i}${o.id})`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.PreviewBG,options:{input:o.id,mixeffect:n},style:{bgcolor:(0,t.combineRgb)(0,255,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:vr.Preview,options:{mixeffect:n,input:o.id}}],up:[]}]},s.presets[`program_me_${n}_${o.id}`]={name:`Program button for ${o.shortName}`,type:"button",style:{text:`$(atem:${i}${o.id})`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.ProgramBG,style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)},options:{input:o.id,mixeffect:n}}],steps:[{down:[{actionId:vr.Program,options:{mixeffect:n,input:o.id}}],up:[]}]}}return o}function ea(e){let t=[];t.push([!0]),t.push([!1]);for(let r=0;r<e;r++){const e=[];for(const r of t)e.push([...r,!1]),e.push([...r,!0]);t=e}return t}function ta(e,r,i){const a=[];for(let o=0;o<e.MEs;++o){const n={name:`Transitions (M/E ${o+1})`,presets:{}};a.push(n),n.presets[`transition_preview_me_${o}`]={name:"PREVIEW",type:"button",style:{text:"PREV TRANS",size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.PreviewTransition,options:{mixeffect:o},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:vr.PreviewTransition,options:{mixeffect:o+1+"",state:"toggle"}}],up:[]}]},n.presets[`transition_cut_me_${o}`]={name:"CUT",type:"button",style:{text:"CUT",size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.InTransition,options:{mixeffect:o},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:vr.Cut,options:{mixeffect:o}}],up:[]}]},n.presets[`transition_auto_me_${o}`]={name:"AUTO",type:"button",style:{text:"AUTO",size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.InTransition,options:{mixeffect:o},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:vr.Auto,options:{mixeffect:o}}],up:[]}]};for(const e of j())n.presets[`transition_style_me_${o}_${e.id}`]={name:`Transition style ${e.label}`,type:"button",style:{text:e.label,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.TransitionStyle,options:{mixeffect:o,style:e.id},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.TransitionStyle,options:{mixeffect:o,style:e.id}}],up:[]}]};for(const e of j(!0))for(const a of i)n.presets[`transition_rate_${o}_${e.id}_${a}`]={name:`Transition ${e.label} rate ${a}`,type:"button",style:{text:`${e.label} ${a}`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.TransitionRate,options:{mixeffect:o,style:e.id,rate:a},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.TransitionRate,options:{mixeffect:o,style:e.id,rate:a}}],up:[]}]};for(const i of ea(e.USKs)){const a=i[0]?["BG"]:[],s=i[0]?["background"]:[];for(let t=0;t<e.USKs;t++)i[t+1]&&(a.push(`K${t+1}`),s.push(`key${t}`));if(0===se(e.USKs,s).length)continue;const l=a.join(" & ");n.presets[`transition_selection_${o}_${l.trim()}`]={name:`Transition Selection ${l.trim()}`,type:"button",style:{text:l.trim(),size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.TransitionSelection,options:{mixeffect:o,matchmethod:"contains",selection:s},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.TransitionSelection,options:{mixeffect:o,selection:s}}],up:[]}]}}}return a}function ra(e,r,i,a){const o=[];for(const n of e.outputs){const s={name:n.name,presets:{}};o.push(s);for(const o of Y(e,r,"aux"))s.presets[`aux_${n.id}_${o.id}`]={name:`${n.name} button for ${o.shortName}`,type:"button",style:{text:`$(atem:${a}${o.id})`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.AuxBG,options:{input:o.id,aux:n.id},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.Aux,options:{aux:n.id,input:o.id}}],up:[]}]}}return o}function ia(r,i,a,o){const n=[],s={name:"KEYs OnAir",presets:{}},l={name:"KEYs Next",presets:{}},u={name:"KEYs Fly",presets:{}},c={name:"KEYs Type",presets:{}};n.push(s,l,u,c);for(let d=0;d<r.MEs;++d)for(let p=0;p<r.USKs;++p){s.presets[`keys_onair_me_${d}_${p}`]={name:`Toggle upstream M/E ${d+1} KEY ${p+1} OnAir`,type:"button",style:{text:"KEY "+(p+1),size:"24",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.USKOnAir,options:{key:p,mixeffect:d},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:vr.USKOnAir,options:{onair:"toggle",key:p,mixeffect:d}}],up:[]}]},l.presets[`keys_next_me_${d}_${p}`]={name:`Toggle upstream M/E ${d+1} KEY ${p+1} Next`,type:"button",style:{text:"KEY "+(p+1),size:"24",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.TransitionSelection,options:{mixeffect:d,matchmethod:"contains",selection:["key"+p]},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.TransitionSelectionComponent,options:{mixeffect:d,component:p+1,mode:"toggle"}}],up:[]}]};const r={name:`M/E ${d+1} Key ${p+1}`,presets:{}};n.push(r);for(const e of o)r.presets[`key_src_${d}_${p}_${e.id}`]={name:`M/E ${d+1} KEY ${p+1} source ${e.shortName}`,type:"button",style:{text:`$(atem:${a}${e.id})`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.USKSource,options:{fill:e.id,key:p,mixeffect:d},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.USKSource,options:{fill:e.id,cut:e.id+1,key:p,mixeffect:d}}],up:[]}]};for(const r of D){let a;switch(r.id){case e.Enums.FlyKeyKeyFrame.A:a=e.Enums.IsAtKeyFrame.A;break;case e.Enums.FlyKeyKeyFrame.B:a=e.Enums.IsAtKeyFrame.B;break;case e.Enums.FlyKeyKeyFrame.Full:a=e.Enums.IsAtKeyFrame.RunToInfinite;break;default:(0,t.assertNever)(r.id);continue}u.presets[`key_fly_me_${d}_${p}_${r.id}`]={name:`Fly M/E ${d+1} KEY ${p+1} to ${r.label}`,type:"button",style:{text:`Fly to ${r.label}`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.USKKeyFrame,options:{mixeffect:d,key:p,keyframe:a},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.USKFly,options:{mixeffect:d,key:p,keyframe:r.id}}],up:[]}]}}const m=K();for(const e of m)c.presets[`key_fly_me_${d}_${p}_type_${e.id}`]={name:`M/E ${d+1} KEY ${p+1} to ${e.label}`,type:"button",style:{text:`${e.label}`,size:i,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.USKType,options:{mixeffect:d,key:p,type:e.id},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.USKType,options:{mixeffect:d,key:p,type:e.id}}],up:[]}]}}return n}function aa(e,r,i,a){const o=[],n={name:"DSK KEYs OnAir",presets:{}},s={name:"DSK KEYs Next",presets:{}};o.push(n,s);for(let l=0;l<e.DSKs;++l){n.presets[`dsk_onair_${l}`]={name:`Toggle downstream KEY ${l+1} OnAir`,type:"button",style:{text:`DSK ${l+1}`,size:"24",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.DSKOnAir,options:{key:l},style:{bgcolor:(0,t.combineRgb)(255,0,0),color:(0,t.combineRgb)(255,255,255)}}],steps:[{down:[{actionId:vr.DSKOnAir,options:{onair:"toggle",key:l}}],up:[]}]},s.presets[`dsk_next_${l}`]={name:`Toggle downstream KEY ${l+1} Next`,type:"button",style:{text:`DSK ${l+1}`,size:"24",color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.DSKTie,options:{key:l},style:{bgcolor:(0,t.combineRgb)(255,255,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.DSKTie,options:{state:"toggle",key:l}}],up:[]}]};const e={name:`DSK ${l+1}`,presets:{}};o.push(e);for(const o of a)e.presets[`dsk_src_${l}_${o.id}`]={name:`DSK ${l+1} source ${o.shortName}`,type:"button",style:{text:`$(atem:${i}${o.id})`,size:r,color:(0,t.combineRgb)(255,255,255),bgcolor:(0,t.combineRgb)(0,0,0)},feedbacks:[{feedbackId:ii.DSKSource,options:{fill:o.id,key:l},style:{bgcolor:(0,t.combineRgb)(238,238,0),color:(0,t.combineRgb)(0,0,0)}}],steps:[{down:[{actionId:vr.DSKSource,options:{fill:o.id,cut:o.id+1,key:l}}],up:[]}]}}return o}const oa=[12,15,25,30,37,45,50,60];function na(e,t){return Math.round(e*t)/t}function sa(e,t,r){r[`camera_${t.cameraId}_focus`]=na(t.lens.focus,1e3),r[`camera_${t.cameraId}_iris`]=na(t.lens.iris,1e3),r[`camera_${t.cameraId}_ois`]=t.lens.opticalImageStabilisation?1:0,r[`camera_${t.cameraId}_wb_temp`]=t.video.whiteBalance[0],r[`camera_${t.cameraId}_wb_tint`]=t.video.whiteBalance[1],r[`camera_${t.cameraId}_exposure_us`]=t.video.exposure,r[`camera_${t.cameraId}_sharpening`]=t.video.videoSharpeningLevel,r[`camera_${t.cameraId}_shutter_speed`]=t.video.shutterSpeed,r[`camera_${t.cameraId}_gain`]=t.video.gain,r[`camera_${t.cameraId}_nd_filter`]=t.video.ndFilterStop,r[`camera_${t.cameraId}_show_color_bars`]=t.display.colorBarEnable?1:0;const i=(e,i)=>{r[`camera_${t.cameraId}_color_${e}_red`]=na(i.red,1e3),r[`camera_${t.cameraId}_color_${e}_green`]=na(i.green,1e3),r[`camera_${t.cameraId}_color_${e}_blue`]=na(i.blue,1e3),r[`camera_${t.cameraId}_color_${e}_luma`]=na(i.luma,1e3)};i("lift",t.colorCorrection.liftAdjust),i("gamma",t.colorCorrection.gammaAdjust),i("gain",t.colorCorrection.gainAdjust),i("offset",t.colorCorrection.offsetAdjust),r[`camera_${t.cameraId}_contrast_pivot`]=na(t.colorCorrection.contrastAdjust.pivot,1e3),r[`camera_${t.cameraId}_contrast_adjust`]=na(t.colorCorrection.contrastAdjust.adj,1e3),r[`camera_${t.cameraId}_lumamix`]=na(t.colorCorrection.lumaMix,1e3),r[`camera_${t.cameraId}_hue_adjust`]=na(t.colorCorrection.colorAdjust.hue,1e3),r[`camera_${t.cameraId}_saturation_adjust`]=na(t.colorCorrection.colorAdjust.saturation,1e3)}function la(e,t,r){r.push({variableId:`camera_${t}_focus`,name:`Camera ${t}: Focus`}),r.push({variableId:`camera_${t}_iris`,name:`Camera ${t}: Iris`}),r.push({variableId:`camera_${t}_ois`,name:`Camera ${t}: Optical Image Stabilisation`}),r.push({variableId:`camera_${t}_wb_temp`,name:`Camera ${t}: White balance temperature`}),r.push({variableId:`camera_${t}_wb_tint`,name:`Camera ${t}: White balance tint`}),r.push({variableId:`camera_${t}_exposure_us`,name:`Camera ${t}: Exposure microseconds (us)`}),r.push({variableId:`camera_${t}_sharpening`,name:`Camera ${t}: Sharpening level`}),r.push({variableId:`camera_${t}_shutter_speed`,name:`Camera ${t}: Shutter speed (1/x)`}),r.push({variableId:`camera_${t}_gain`,name:`Camera ${t}: Gain (dB)`}),r.push({variableId:`camera_${t}_nd_filter`,name:`Camera ${t}: ND Filter`}),r.push({variableId:`camera_${t}_show_color_bars`,name:`Camera ${t}: Show Color Bars`});const i=(e,i)=>{r.push({variableId:`camera_${t}_color_${e}_red`,name:`Camera ${t}: Color ${i} Adjust - Red`}),r.push({variableId:`camera_${t}_color_${e}_green`,name:`Camera ${t}: Color ${i} Adjust - Green`}),r.push({variableId:`camera_${t}_color_${e}_blue`,name:`Camera ${t}: Color ${i} Adjust - Blue`}),r.push({variableId:`camera_${t}_color_${e}_Luma`,name:`Camera ${t}: Color ${i} Adjust - Luma`})};i("lift","Lift"),i("gamma","Gamma"),i("gain","Gain"),i("offset","Offset"),r.push({variableId:`camera_${t}_contrast_pivot`,name:`Camera ${t}: Contrast Pivot`}),r.push({variableId:`camera_${t}_contrast_adjust`,name:`Camera ${t}: Contrast Adjust`}),r.push({variableId:`camera_${t}_lumamix`,name:`Camera ${t}: Luma mix`}),r.push({variableId:`camera_${t}_hue_adjust`,name:`Camera ${t}: Hue Adjust`}),r.push({variableId:`camera_${t}_saturation_adjust`,name:`Camera ${t}: Saturation Adjust`})}function ua(e,t,r){r.timecode=di(e.timecodeSeconds).hms,r.display_clock=di(e.displayClockSeconds).hms}function ca(e,t,r){const i=pe(t),a=e.fairlight?.audioRouting?.sources?.[t];r[`audio_routing_source_${i}_name`]=a?.name}function da(e,t,r){const i=pe(t),a=e.fairlight?.audioRouting?.outputs?.[t];r[`audio_routing_destinations_${i}_name`]=a?.name;const o=a&&e.fairlight?.audioRouting?.sources?.[a?.sourceId];r[`audio_routing_destinations_${i}_source`]=a?.sourceId,r[`audio_routing_destinations_${i}_source_name`]=o?.name}function pa(e,t,r){const i=t.inputs[r];if(i){const t=i.longName||i.shortName||`Input ${r}`;return(Number(e.config.presets)===ct.Long?i.longName:i.shortName)||t}return 0===r?"Black":void 0===r?"Unknown":`Unknown input (${r})`}function ma(e,t,r,i){const a=xr(t,r)?.programInput??0;i[`pgm${r+1}_input`]=pa(e,t,a),i[`pgm${r+1}_input_id`]=a}function ba(e,t,r,i){const a=xr(t,r)?.previewInput??0;i[`pvw${r+1}_input`]=pa(e,t,a),i[`pvw${r+1}_input_id`]=a}function fa(e,t,r){const i=e.video.mixEffects[t]?.transitionPosition?.handlePosition??0;r[`tbar_${t+1}`]=Math.round(i/100)}function ga(e,t,r,i,a){const o=Mr(t,r,i)?.fillSource??0;a[`usk_${r+1}_${i+1}_input`]=pa(e,t,o),a[`usk_${r+1}_${i+1}_input_id`]=o;const n=t.video.mixEffects[r]?.upstreamKeyers[i]?.dveSettings;n&&(a[`usk_${r+1}_${i+1}_maskEnabled`]=n.maskEnabled,a[`usk_${r+1}_${i+1}_maskTop`]=n.maskTop/1e3,a[`usk_${r+1}_${i+1}_maskBottom`]=n.maskBottom/1e3,a[`usk_${r+1}_${i+1}_maskLeft`]=n.maskLeft/1e3,a[`usk_${r+1}_${i+1}_maskRight`]=n.maskRight/1e3,a[`usk_${r+1}_${i+1}_positionX`]=n.positionX/1e3,a[`usk_${r+1}_${i+1}_positionY`]=n.positionY/1e3,a[`usk_${r+1}_${i+1}_sizeX`]=n.sizeX/1e3,a[`usk_${r+1}_${i+1}_sizeY`]=n.sizeY/1e3,a[`usk_${r+1}_${i+1}_rotation`]=n.rotation,a[`usk_${r+1}_${i+1}_bordOutWidth`]=n.borderOuterWidth/100,a[`usk_${r+1}_${i+1}_bordInWidth`]=n.borderInnerWidth/100,a[`usk_${r+1}_${i+1}_bordOutSoft`]=n.borderOuterSoftness,a[`usk_${r+1}_${i+1}_bordInSoft`]=n.borderInnerSoftness,a[`usk_${r+1}_${i+1}_bevelSoft`]=n.borderBevelSoftness,a[`usk_${r+1}_${i+1}_bevelPos`]=n.borderBevelPosition,a[`usk_${r+1}_${i+1}_bordOpacity`]=n.borderOpacity,a[`usk_${r+1}_${i+1}_bordHue`]=n.borderHue/10,a[`usk_${r+1}_${i+1}_bordLum`]=n.borderLuma/10,a[`usk_${r+1}_${i+1}_lightDirection`]=n.lightSourceDirection/10,a[`usk_${r+1}_${i+1}_lightAltitude`]=n.lightSourceAltitude,a[`usk_${r+1}_${i+1}_bordEnabled`]=n.borderEnabled,a[`usk_${r+1}_${i+1}_shadowEnabled`]=n.shadowEnabled,a[`usk_${r+1}_${i+1}_rate`]=n.rate);const s=t.video.mixEffects[r]?.upstreamKeyers[i]?.patternSettings;s&&(a[`usk_${r+1}_${i+1}_pattern_style`]=s.style,a[`usk_${r+1}_${i+1}_pattern_size`]=s.size/100,a[`usk_${r+1}_${i+1}_pattern_symmetry`]=s.symmetry/100,a[`usk_${r+1}_${i+1}_pattern_softness`]=s.softness/100,a[`usk_${r+1}_${i+1}_pattern_positionX`]=s.positionX/1e4,a[`usk_${r+1}_${i+1}_pattern_positionY`]=s.positionY/1e4,a[`usk_${r+1}_${i+1}_pattern_invert`]=s.invert),t.video.mixEffects[r]?.upstreamKeyers[i]&&(a[`usk_${r+1}_${i+1}_canFlyKey`]=t.video.mixEffects[r]?.upstreamKeyers[i]?.canFlyKey,a[`usk_${r+1}_${i+1}_flyEnabled`]=t.video.mixEffects[r]?.upstreamKeyers[i]?.flyEnabled)}function ha(e,t,r,i){const a=Tr(t,r)?.sources?.fillSource??0;i[`dsk_${r+1}_input`]=pa(e,t,a),i[`dsk_${r+1}_input_id`]=a}function ya(e,t,r,i){const a=t.video.auxilliaries[r]??0;i[`aux${r+1}_input`]=pa(e,t,a),i[`aux${r+1}_input_id`]=a}function Sa(e,t,r){const i=e.macro.macroProperties[t];r[`macro_${t+1}`]=i?.name||`Macro ${t+1}`}function va(e,t,r){const i=e.media.stillPool[t];r[`still_${t+1}`]=i?.fileName||`Still ${t+1}`}function Pa(e,t,r){const i=e.media.clipPool[t];r[`clip_${t+1}`]=i?.name||`Clip ${t+1}`}function Ca(t,r,i){const a=t.media.players[r];let o="-1",n="Unknown";if(a)if(a.sourceType===e.Enums.MediaSourceType.Clip){const e=t.media.clipPool[a.clipIndex];o=`C${a.clipIndex+1}`,n=e?.name||`Clip ${a.clipIndex+1}`}else if(a.sourceType===e.Enums.MediaSourceType.Still){const e=t.media.stillPool[a.stillIndex];o=`S${a.stillIndex+1}`,n=e?.fileName||`Still ${a.stillIndex+1}`}i[`mp_index_${r+1}`]=o,i[`mp_source_${r+1}`]=n}function ka(e,t){t[`long_${e.id}`]=e.longName,t[`short_${e.id}`]=e.shortName}function Aa(e,t){const r=(e.streaming?.stats?.encodingBitrate??0)/1048576,i=ci(e.streaming?.duration),a=e.streaming?.stats?.cacheUsed;t.stream_bitrate=r.toFixed(2),t.stream_duration_hm=i.hm,t.stream_duration_hms=i.hms,t.stream_duration_ms=i.ms,t.stream_cache_used=a}function Ia(e,t){const r=ci(e.recording?.duration),i=di(e.recording?.status?.recordingTimeAvailable);t.record_duration_hm=r.hm,t.record_duration_hms=r.hms,t.record_duration_ms=r.ms,t.record_remaining_hm=i.hm,t.record_remaining_hms=i.hms,t.record_remaining_ms=i.ms,t.record_filename=e.recording?.properties.filename||""}function wa(e,t=100){if(void 0!==e)return(e/t).toString()}function _a(t){let r;switch(t){case e.Enums.FairlightAudioMixOption.Off:r="OFF";break;case e.Enums.FairlightAudioMixOption.On:r="ON";break;case e.Enums.FairlightAudioMixOption.AudioFollowVideo:r="AFV"}return r}function xa(e,t,r){const i=function(e,t){return e.fairlight?.inputs[t]}(e,t)?.sources;if(void 0!==i&&i[-65280]){const e=i[-65280]?.properties;r[`audio_input_${t}_balance`]=wa(e?.balance),r[`audio_input_${t}_faderGain`]=wa(e?.faderGain),r[`audio_input_${t}_framesDelay`]=e?.framesDelay.toString(),r[`audio_input_${t}_gain`]=wa(e?.gain),r[`audio_input_${t}_mixOption`]=_a(e?.mixOption)}if(void 0!==i&&i[-256]){const e=i[-256]?.properties;r[`audio_input_${t}_left_balance`]=wa(e?.balance),r[`audio_input_${t}_left_faderGain`]=wa(e?.faderGain),r[`audio_input_${t}_left_framesDelay`]=e?.framesDelay.toString(),r[`audio_input_${t}_left_gain`]=wa(e?.gain),r[`audio_input_${t}_left_mixOption`]=_a(e?.mixOption)}if(void 0!==i&&i[-255]){const e=i[-255]?.properties;r[`audio_input_${t}_right_balance`]=wa(e?.balance),r[`audio_input_${t}_right_faderGain`]=wa(e?.faderGain),r[`audio_input_${t}_right_framesDelay`]=e?.framesDelay.toString(),r[`audio_input_${t}_right_gain`]=wa(e?.gain),r[`audio_input_${t}_right_mixOption`]=_a(e?.mixOption)}}function Ea(t,r,i){const a=function(e,t){return e.audio?.channels[t]}(t,r),o=a&&a.gain<=te?-1/0:a?.gain;i[`audio_input_${r}_balance`]=wa(a?.balance,1),i[`audio_input_${r}_gain`]=wa(o,1),i[`audio_input_${r}_mixOption`]=function(t){let r;switch(t){case e.Enums.AudioMixOption.Off:r="OFF";break;case e.Enums.AudioMixOption.On:r="ON";break;case e.Enums.AudioMixOption.AudioFollowVideo:r="AFV"}return r}(a?.mixOption)}function Ma(e,t){const r=function(e){return e.fairlight?.master}(e);t.audio_master_faderGain=wa(r?.properties?.faderGain)}function Ta(e,t){const r=function(e){return e.fairlight?.monitor}(e);t.audio_monitor_gain=wa(r?.gain),t.audio_monitor_master_gain=wa(r?.inputMasterGain),t.audio_monitor_talkback_gain=wa(r?.inputTalkbackGain),t.audio_monitor_sidetone_gain=wa(r?.inputSidetoneGain)}function Na(e,t,r,i){for(let a=0;a<4;a++){const o=Nr(t,a,r)?.source??0;i[`ssrc${r+1}_box${a+1}_source`]=pa(e,t,o),i[`ssrc${r+1}_box${a+1}_source_id`]=o}}function Oa(e,t,r,i,a){const o=t.settings.multiViewers[r-1]?.windows?.[i-1]?.source??0;a[`mv_${r}_window_${i}_input_id`]=o,a[`mv_${r}_window_${i}_input`]=pa(e,t,o)}function Ra(e,t){t.device_ip=e.parseIpAndPort()?.ip||""}const Da=function(e,t){return e===t||e!=e&&t!=t},Fa=function(e,t){for(var r=e.length;r--;)if(Da(e[r][0],t))return r;return-1};var Va=Array.prototype.splice;function $a(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}$a.prototype.clear=function(){this.__data__=[],this.size=0},$a.prototype.delete=function(e){var t=this.__data__,r=Fa(t,e);return!(r<0||(r==t.length-1?t.pop():Va.call(t,r,1),--this.size,0))},$a.prototype.get=function(e){var t=this.__data__,r=Fa(t,e);return r<0?void 0:t[r][1]},$a.prototype.has=function(e){return Fa(this.__data__,e)>-1},$a.prototype.set=function(e,t){var r=this.__data__,i=Fa(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this};const Ba=$a,La="object"==typeof global&&global&&global.Object===Object&&global;var ja="object"==typeof self&&self&&self.Object===Object&&self;const Ka=La||ja||Function("return this")(),Ua=Ka.Symbol;var Ga=Object.prototype,za=Ga.hasOwnProperty,Wa=Ga.toString,Ha=Ua?Ua.toStringTag:void 0;var qa=Object.prototype.toString;var Ja=Ua?Ua.toStringTag:void 0;const Ya=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ja&&Ja in Object(e)?function(e){var t=za.call(e,Ha),r=e[Ha];try{e[Ha]=void 0;var i=!0}catch(e){}var a=Wa.call(e);return i&&(t?e[Ha]=r:delete e[Ha]),a}(e):function(e){return qa.call(e)}(e)},Xa=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Qa=function(e){if(!Xa(e))return!1;var t=Ya(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Za=Ka["__core-js_shared__"];var eo,to=(eo=/[^.]+$/.exec(Za&&Za.keys&&Za.keys.IE_PROTO||""))?"Symbol(src)_1."+eo:"";var ro=Function.prototype.toString;const io=function(e){if(null!=e){try{return ro.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var ao=/^\[object .+?Constructor\]$/,oo=Function.prototype,no=Object.prototype,so=oo.toString,lo=no.hasOwnProperty,uo=RegExp("^"+so.call(lo).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const co=function(e){return!(!Xa(e)||(t=e,to&&to in t))&&(Qa(e)?uo:ao).test(io(e));var t},po=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return co(r)?r:void 0},mo=po(Ka,"Map"),bo=po(Object,"create");var fo=Object.prototype.hasOwnProperty;var go=Object.prototype.hasOwnProperty;function ho(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}ho.prototype.clear=function(){this.__data__=bo?bo(null):{},this.size=0},ho.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ho.prototype.get=function(e){var t=this.__data__;if(bo){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return fo.call(t,e)?t[e]:void 0},ho.prototype.has=function(e){var t=this.__data__;return bo?void 0!==t[e]:go.call(t,e)},ho.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=bo&&void 0===t?"__lodash_hash_undefined__":t,this};const yo=ho,So=function(e,t){var r,i,a=e.__data__;return("string"==(i=typeof(r=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?a["string"==typeof t?"string":"hash"]:a.map};function vo(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}vo.prototype.clear=function(){this.size=0,this.__data__={hash:new yo,map:new(mo||Ba),string:new yo}},vo.prototype.delete=function(e){var t=So(this,e).delete(e);return this.size-=t?1:0,t},vo.prototype.get=function(e){return So(this,e).get(e)},vo.prototype.has=function(e){return So(this,e).has(e)},vo.prototype.set=function(e,t){var r=So(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this};const Po=vo;function Co(e){var t=this.__data__=new Ba(e);this.size=t.size}Co.prototype.clear=function(){this.__data__=new Ba,this.size=0},Co.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Co.prototype.get=function(e){return this.__data__.get(e)},Co.prototype.has=function(e){return this.__data__.has(e)},Co.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Ba){var i=r.__data__;if(!mo||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new Po(i)}return r.set(e,t),this.size=r.size,this};const ko=Co;function Ao(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Po;++t<r;)this.add(e[t])}Ao.prototype.add=Ao.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ao.prototype.has=function(e){return this.__data__.has(e)};const Io=Ao,wo=function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1},_o=function(e,t,r,i,a,o){var n=1&r,s=e.length,l=t.length;if(s!=l&&!(n&&l>s))return!1;var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;var d=-1,p=!0,m=2&r?new Io:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var b=e[d],f=t[d];if(i)var g=n?i(f,b,d,t,e,o):i(b,f,d,e,t,o);if(void 0!==g){if(g)continue;p=!1;break}if(m){if(!wo(t,(function(e,t){if(n=t,!m.has(n)&&(b===e||a(b,e,r,i,o)))return m.push(t);var n}))){p=!1;break}}else if(b!==f&&!a(b,f,r,i,o)){p=!1;break}}return o.delete(e),o.delete(t),p},xo=Ka.Uint8Array,Eo=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,i){r[++t]=[i,e]})),r},Mo=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r};var To=Ua?Ua.prototype:void 0,No=To?To.valueOf:void 0;const Oo=Array.isArray;var Ro=Object.prototype.propertyIsEnumerable,Do=Object.getOwnPropertySymbols;const Fo=Do?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,i=null==e?0:e.length,a=0,o=[];++r<i;){var n=e[r];t(n,r,e)&&(o[a++]=n)}return o}(Do(e),(function(t){return Ro.call(e,t)})))}:function(){return[]},Vo=function(e){return null!=e&&"object"==typeof e},$o=function(e){return Vo(e)&&"[object Arguments]"==Ya(e)};var Bo=Object.prototype,Lo=Bo.hasOwnProperty,jo=Bo.propertyIsEnumerable;const Ko=$o(function(){return arguments}())?$o:function(e){return Vo(e)&&Lo.call(e,"callee")&&!jo.call(e,"callee")};var Uo="object"==typeof exports&&exports&&!exports.nodeType&&exports,Go=Uo&&"object"==typeof module&&module&&!module.nodeType&&module,zo=Go&&Go.exports===Uo?Ka.Buffer:void 0;const Wo=(zo?zo.isBuffer:void 0)||function(){return!1};var Ho=/^(?:0|[1-9]\d*)$/;const qo=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Ho.test(e))&&e>-1&&e%1==0&&e<t},Jo=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Yo={};Yo["[object Float32Array]"]=Yo["[object Float64Array]"]=Yo["[object Int8Array]"]=Yo["[object Int16Array]"]=Yo["[object Int32Array]"]=Yo["[object Uint8Array]"]=Yo["[object Uint8ClampedArray]"]=Yo["[object Uint16Array]"]=Yo["[object Uint32Array]"]=!0,Yo["[object Arguments]"]=Yo["[object Array]"]=Yo["[object ArrayBuffer]"]=Yo["[object Boolean]"]=Yo["[object DataView]"]=Yo["[object Date]"]=Yo["[object Error]"]=Yo["[object Function]"]=Yo["[object Map]"]=Yo["[object Number]"]=Yo["[object Object]"]=Yo["[object RegExp]"]=Yo["[object Set]"]=Yo["[object String]"]=Yo["[object WeakMap]"]=!1;var Xo="object"==typeof exports&&exports&&!exports.nodeType&&exports,Qo=Xo&&"object"==typeof module&&module&&!module.nodeType&&module,Zo=Qo&&Qo.exports===Xo&&La.process,en=function(){try{return Qo&&Qo.require&&Qo.require("util").types||Zo&&Zo.binding&&Zo.binding("util")}catch(e){}}(),tn=en&&en.isTypedArray;const rn=tn?(an=tn,function(e){return an(e)}):function(e){return Vo(e)&&Jo(e.length)&&!!Yo[Ya(e)]};var an,on=Object.prototype.hasOwnProperty;const nn=function(e,t){var r=Oo(e),i=!r&&Ko(e),a=!r&&!i&&Wo(e),o=!r&&!i&&!a&&rn(e),n=r||i||a||o,s=n?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],l=s.length;for(var u in e)!t&&!on.call(e,u)||n&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||qo(u,l))||s.push(u);return s};var sn=Object.prototype;const ln=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object);var un=Object.prototype.hasOwnProperty;const cn=function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||sn))return ln(e);var t,r,i=[];for(var a in Object(e))un.call(e,a)&&"constructor"!=a&&i.push(a);return i},dn=function(e){return null!=(t=e)&&Jo(t.length)&&!Qa(t)?nn(e):cn(e);var t},pn=function(e){return function(e,t,r){var i=t(e);return Oo(e)?i:function(e,t){for(var r=-1,i=t.length,a=e.length;++r<i;)e[a+r]=t[r];return e}(i,r(e))}(e,dn,Fo)};var mn=Object.prototype.hasOwnProperty;const bn=po(Ka,"DataView"),fn=po(Ka,"Promise"),gn=po(Ka,"Set"),hn=po(Ka,"WeakMap");var yn="[object Map]",Sn="[object Promise]",vn="[object Set]",Pn="[object WeakMap]",Cn="[object DataView]",kn=io(bn),An=io(mo),In=io(fn),wn=io(gn),_n=io(hn),xn=Ya;(bn&&xn(new bn(new ArrayBuffer(1)))!=Cn||mo&&xn(new mo)!=yn||fn&&xn(fn.resolve())!=Sn||gn&&xn(new gn)!=vn||hn&&xn(new hn)!=Pn)&&(xn=function(e){var t=Ya(e),r="[object Object]"==t?e.constructor:void 0,i=r?io(r):"";if(i)switch(i){case kn:return Cn;case An:return yn;case In:return Sn;case wn:return vn;case _n:return Pn}return t});const En=xn;var Mn="[object Arguments]",Tn="[object Array]",Nn="[object Object]",On=Object.prototype.hasOwnProperty;const Rn=function(e,t,r,i,a,o){var n=Oo(e),s=Oo(t),l=n?Tn:En(e),u=s?Tn:En(t),c=(l=l==Mn?Nn:l)==Nn,d=(u=u==Mn?Nn:u)==Nn,p=l==u;if(p&&Wo(e)){if(!Wo(t))return!1;n=!0,c=!1}if(p&&!c)return o||(o=new ko),n||rn(e)?_o(e,t,r,i,a,o):function(e,t,r,i,a,o,n){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new xo(e),new xo(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Da(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=Eo;case"[object Set]":var l=1&i;if(s||(s=Mo),e.size!=t.size&&!l)return!1;var u=n.get(e);if(u)return u==t;i|=2,n.set(e,t);var c=_o(s(e),s(t),i,a,o,n);return n.delete(e),c;case"[object Symbol]":if(No)return No.call(e)==No.call(t)}return!1}(e,t,l,r,i,a,o);if(!(1&r)){var m=c&&On.call(e,"__wrapped__"),b=d&&On.call(t,"__wrapped__");if(m||b){var f=m?e.value():e,g=b?t.value():t;return o||(o=new ko),a(f,g,r,i,o)}}return!!p&&(o||(o=new ko),function(e,t,r,i,a,o){var n=1&r,s=pn(e),l=s.length;if(l!=pn(t).length&&!n)return!1;for(var u=l;u--;){var c=s[u];if(!(n?c in t:mn.call(t,c)))return!1}var d=o.get(e),p=o.get(t);if(d&&p)return d==t&&p==e;var m=!0;o.set(e,t),o.set(t,e);for(var b=n;++u<l;){var f=e[c=s[u]],g=t[c];if(i)var h=n?i(g,f,c,t,e,o):i(f,g,c,e,t,o);if(!(void 0===h?f===g||a(f,g,r,i,o):h)){m=!1;break}b||(b="constructor"==c)}if(m&&!b){var y=e.constructor,S=t.constructor;y==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S||(m=!1)}return o.delete(e),o.delete(t),m}(e,t,r,i,a,o))},Dn=function e(t,r,i,a,o){return t===r||(null==t||null==r||!Vo(t)&&!Vo(r)?t!=t&&r!=r:Rn(t,r,i,a,e,o))},Fn=function(e,t){return Dn(e,t)};function Vn(e,t,r){void 0!==e[t]&&(e[t]=parseFloat(e[t])*r)}const $n={[ii.PreviewBG]:!0,[ii.PreviewBG2]:!0,[ii.PreviewBG3]:!0,[ii.PreviewBG4]:!0,[ii.ProgramBG]:!0,[ii.ProgramBG2]:!0,[ii.ProgramBG3]:!0,[ii.ProgramBG4]:!0,[ii.AuxBG]:!0,[ii.USKOnAir]:!0,[ii.USKSource]:!0,[ii.DSKOnAir]:!0,[ii.DSKTie]:!0,[ii.DSKSource]:!0,[ii.Macro]:!0,[ii.MVSource]:!0,[ii.SSrcBoxOnAir]:!0,[ii.SSrcBoxSource]:!0,[ii.SSrcBoxProperties]:!0,[ii.TransitionStyle]:!0,[ii.TransitionSelection]:!0,[ii.TransitionRate]:!0,[ii.InTransition]:!0,[ii.MediaPlayerSource]:!0,[ii.FadeToBlackIsBlack]:!0,[ii.FadeToBlackRate]:!0,[ii.ProgramTally]:!0,[ii.PreviewTally]:!0,[ii.StreamStatus]:!0,[ii.RecordStatus]:!0,[ii.ClassicAudioGain]:!0,[ii.ClassicAudioMixOption]:!0,[ii.FairlightAudioFaderGain]:!0,[ii.FairlightAudioInputGain]:!0,[ii.FairlightAudioMixOption]:!0},Bn={[ii.ProgramTally]:"invert",[ii.PreviewTally]:"invert",[ii.DSKOnAir]:"invert",[ii.DSKTie]:"invert",[ii.USKOnAir]:"invert"},Ln=[function(e,t){const r={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]};for(const e of t.actions)e.actionId===vr.SuperSourceBoxProperties&&(Vn(e.options,"size",.001),Vn(e.options,"x",.01),Vn(e.options,"y",.01),Vn(e.options,"cropTop",.001),Vn(e.options,"cropBottom",.001),Vn(e.options,"cropLeft",.001),Vn(e.options,"cropRight",.001),r.updatedActions.push(e));for(const e of t.feedbacks)e.feedbackId===ii.SSrcBoxProperties&&(Vn(e.options,"size",.001),Vn(e.options,"x",.01),Vn(e.options,"y",.01),Vn(e.options,"cropTop",.001),Vn(e.options,"cropBottom",.001),Vn(e.options,"cropLeft",.001),Vn(e.options,"cropRight",.001),r.updatedFeedbacks.push(e));return r},(0,t.CreateConvertToBooleanFeedbackUpgradeScript)($n),function(e,t){const r={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]};for(const e of t.actions)e.actionId!==vr.SuperSourceBoxProperties||e.options.properties?e.actionId!==vr.SuperSourceArt||e.options.properties||(e.options.properties=["fill","key","artOption"],r.updatedActions.push(e)):(e.options.properties=["size","x","y","cropEnable","cropTop","cropLeft","cropRight","cropBottom"],r.updatedActions.push(e));for(const e of t.feedbacks)e.feedbackId!==ii.SSrcBoxProperties||e.options.properties||(e.options.properties=["size","x","y","cropEnable","cropTop","cropLeft","cropRight","cropBottom"],r.updatedFeedbacks.push(e));return r},function(e,t){const r={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]};for(const e of t.feedbacks)e.feedbackId===ii.FairlightAudioFaderGain&&void 0===e.options.input&&(e.feedbackId=ii.FairlightAudioMonitorOutputFaderGain,r.updatedFeedbacks.push(e));return r},(0,t.CreateUseBuiltinInvertForFeedbacksUpgradeScript)(Bn),function(e,t){const r={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]},i=e=>{e.selection=[],e.background&&e.selection.push("background"),delete e.background;for(const t of Object.keys(e))t.startsWith("key")&&(e[t]&&e.selection.push(t),delete e[t])};for(const e of t.actions)e.actionId===vr.TransitionSelection&&void 0===e.options.selection&&(i(e.options),r.updatedActions.push(e));for(const e of t.feedbacks)e.feedbackId===ii.TransitionSelection&&void 0===e.options.selection&&(i(e.options),r.updatedFeedbacks.push(e));return r},function(e,t){const r={updatedActions:[],updatedConfig:null,updatedFeedbacks:[]};for(const e of t.actions)"mediaPlayerSourceVariables"===e.actionId&&(e.actionId=vr.MediaPlayerSourceVariables,e.options.mediaplayer=Number(e.options.mediaplayer)+1,r.updatedActions.push(e));return r}];var jn=__webpack_require__(2996),Kn=__webpack_require__(409);const{Atem:Un,AtemConnectionStatus:Gn,AtemStateUtil:zn}=e;Kn.ThreadedClassManager.handleExit=Kn.RegisterExitHandlers.NO;class Wn extends t.InstanceBase{model;atem;wrappedState;commandBatching;isActive;durationInterval;atemTransitions;config={};timecodeSeconds=0;displayClockSeconds=0;constructor(e){super(e),this.commandBatching=new fe;const t=zn.Create();this.wrappedState={state:t,tally:{},tallyCache:new Map,atemCameraState:new oi.AtemCameraControlStateBuilder(0),mediaPoolCache:new _r(t,(async e=>{if(!this.atem)throw new Error("Atem not initialised");const t=this.atem.videoMode;if(!t)throw new Error("No video mode");const r=e.isClip?await this.atem.downloadClipFrame(e.slot,e.frameIndex,"raw"):await this.atem.downloadStill(e.slot,"raw");return{buffer:(0,jn.zC)(t.width,t.height,r),width:t.width,height:t.height}}),(e=>this.checkFeedbacksById(...e)))},this.atemTransitions=new kt(this.config),"undefined"===this.config.modelID&&(this.config.modelID="0",setImmediate((()=>{this.saveConfig(this.config)}))),this.model=st(this.getBestModelId()||0)||lt(),this.isActive=!1}async init(e){this.isActive=!0,this.updateStatus(t.InstanceStatus.Disconnected),this.setupAtemConnection(),await this.configUpdated(e),await new Promise((e=>setTimeout(e,1e3)))}async configUpdated(e){this.config=e;const r={};if(Ra(this,r),this.setVariableValues(r),this.wrappedState.state=zn.Create(),this.wrappedState.atemCameraState.reset(0),this.model=st(this.getBestModelId()||0)||lt(),this.log("debug","ATEM changed model: "+this.model.id),this.atemTransitions.stopAll(),this.atemTransitions=new kt(this.config),this.updateCompanionBits(),this.atem){this.atem.status!==Gn.CLOSED&&this.atem.disconnect().catch((()=>null));const e=this.parseIpAndPort();this.log("info",`Connecting to ${e?.ip}:${e?.port}`),e?(this.updateStatus(t.InstanceStatus.Connecting),this.atem.connect(e.ip,e.port).catch((e=>{this.updateStatus(t.InstanceStatus.ConnectionFailure),this.log("error",`Connecting failed: ${e}`)}))):this.updateStatus(t.InstanceStatus.Disconnected)}}getConfigFields(){return this,[{type:"static-text",id:"info",width:12,label:"Information",value:"This works with all models of Blackmagic Design ATEM mixers. <br />Firmware versions 7.5.2 and later are known to work, other versions may experience problems. <br />Firmware versions after 9.7 are not verified to be working at the time of writing, but they likely will work fine. <br />In general the model can be left in 'Auto Detect', however a specific model can be selected below for offline programming. <br />Devices must be controlled over a network, USB control is NOT supported."},{type:"bonjour-device",id:"bonjourHost",label:"Device",width:6},{type:"textinput",id:"host",label:"Target IP",width:6,isVisible:e=>!e.bonjourHost,default:"",regex:t.Regex.IP},{type:"static-text",id:"host-filler",width:6,label:"",isVisible:e=>!!e.bonjourHost,value:""},{type:"dropdown",id:"modelID",label:"Model",width:6,choices:nt,default:0},{type:"static-text",id:"autoModelName",label:"Detected Model",width:6,isVisible:e=>e.modelID+""=="0",value:this.config.autoModelName??"Pending"},{type:"static-text",id:"autoModelName-filler",width:6,label:"",isVisible:e=>e.modelID+""!="0",value:""},{type:"dropdown",id:"presets",label:"Preset Style",width:6,choices:[{id:ct.Short,label:"Short Names"},{id:ct.Long,label:"Long Names"}],default:ct.Short},{type:"number",id:"fadeFps",label:"Framerate for fades",tooltip:"Higher is smoother, but has higher impact on system performance",width:6,min:5,max:60,step:1,default:10},{type:"checkbox",id:"enableCameraControl",label:"Enable Camera Control",width:6,default:!1},{type:"checkbox",id:"pollTimecode",label:"Enable Timecode variable",width:6,default:!1}]}async destroy(){this.isActive=!1,this.atemTransitions.stopAll(),this.atem&&(this.atem.disconnect().catch((()=>null)),delete this.atem),this.log("debug","destroy: "+this.id)}getBestModelId(){const e=Number(this.config.modelID);if(!isNaN(e)&&e>0)return e;const t=this.wrappedState.state.info;if(t&&t.model)return t.model;const r=this.config.modelID+""=="0"?Number(this.config.autoModelID):0;return!isNaN(r)&&r>0?r:void 0}updateCompanionBits(){var t,r,i;!function(t,r,i){const a=[],o={};a.push({name:"IP address of ATEM",variableId:"device_ip"}),Ra(t,o);for(let e=0;e<r.MEs;++e){a.push({name:`Label of input active on program bus (M/E ${e+1})`,variableId:`pgm${e+1}_input`}),a.push({name:`Id of input active on program bus (M/E ${e+1})`,variableId:`pgm${e+1}_input_id`}),ma(t,i.state,e,o),a.push({name:`Label of input active on preview bus (M/E ${e+1})`,variableId:`pvw${e+1}_input`}),a.push({name:`Id of input active on preview bus (M/E ${e+1})`,variableId:`pvw${e+1}_input_id`}),ba(t,i.state,e,o),a.push({name:`Position of T-bar (M/E ${e+1})`,variableId:`tbar_${e+1}`}),fa(i.state,e,o);for(let n=0;n<r.USKs;++n)a.push({name:`Label of input active on M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_input`}),a.push({name:`Id of input active on M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_input_id`}),r.USKs&&r.DVEs&&(a.push({name:`Mask Enabled for M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskEnabled`}),a.push({name:`Mask cutoff from the top of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskTop`}),a.push({name:`Mask cutoff from the bottom of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskBottom`}),a.push({name:`Mask cutoff from the left of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskLeft`}),a.push({name:`Mask cutoff from the right of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_maskRight`}),a.push({name:`X position of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_positionX`}),a.push({name:`Y position of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_positionY`}),a.push({name:`X scale of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_sizeX`}),a.push({name:`Y scale of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_sizeY`}),a.push({name:`Rotation of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_rotation`}),a.push({name:`Border Width (Outer) of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordOutWidth`}),a.push({name:`Border Width (Inner) of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordInWidth`}),a.push({name:`Border Softness (Outer) of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordOutSoft`}),a.push({name:`Border Softnesss (Inner) of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordInSoft`}),a.push({name:`Border Bevel Softnesss of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bevelSoft`}),a.push({name:`Border Bevel Position of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bevelPos`}),a.push({name:`Border Opacity of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordOpacity`}),a.push({name:`Border Hue of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordHue`}),a.push({name:`Border Luma of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordLum`}),a.push({name:`Light source Angle of shadow of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_lightDirection`}),a.push({name:`Light source Altitude of shadow of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_lightAltitude`}),a.push({name:`Border Enabled for M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_bordEnabled`}),a.push({name:`Shadow Enabled for M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_shadowEnabled`}),a.push({name:`Keyframe transformation Rate of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_rate`}),a.push({name:`Pattern Style of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_style`}),a.push({name:`Pattern Size of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_size`}),a.push({name:`Pattern Symmetry of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_symmetry`}),a.push({name:`Pattern Softness of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_softness`}),a.push({name:`Pattern Position X of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_positionX`}),a.push({name:`Pattern Position Y of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_positionY`}),a.push({name:`Pattern Invert of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_pattern_invert`}),a.push({name:`(read only) Ability to Enable Fly Key or DVE of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_canFlyKey`}),a.push({name:`Fly Key Enable Status of M/E ${e+1} Key ${n+1}`,variableId:`usk_${e+1}_${n+1}_flyEnabled`})),ga(t,i.state,e,n,o)}for(const e of r.outputs)a.push({name:`Label of input active on ${e.name}`,variableId:`aux${e.id+1}_input`}),a.push({name:`Id of input active on ${e.name}`,variableId:`aux${e.id+1}_input_id`}),ya(t,i.state,e.id,o);for(let e=0;e<r.DSKs;++e)a.push({name:`Label of input active on DSK ${e+1}`,variableId:`dsk_${e+1}_input`}),a.push({name:`Id of input active on DSK ${e+1}`,variableId:`dsk_${e+1}_input_id`}),ha(t,i.state,e,o);for(const e of Y(r,i.state))a.push({name:`Long name of source id ${e.id}`,variableId:`long_${e.id}`}),a.push({name:`Short name of source id ${e.id}`,variableId:`short_${e.id}`}),ka(e,o);for(let e=0;e<r.macros;e++)a.push({name:`Name of macro #${e+1}`,variableId:`macro_${e+1}`}),Sa(i.state,e,o);for(let e=0;e<r.media.stills;e++)a.push({name:`Name of still #${e+1}`,variableId:`still_${e+1}`}),va(i.state,e,o);for(let e=0;e<r.media.clips;e++)a.push({name:`Name of clip #${e+1}`,variableId:`clip_${e+1}`}),Pa(i.state,e,o);for(let e=0;e<r.media.players;e++)a.push({name:`Name of media player source #${e+1}`,variableId:`mp_source_${e+1}`}),a.push({name:`Name of media player index #${e+1}`,variableId:`mp_index_${e+1}`}),Ca(i.state,e,o);r.streaming&&(a.push({name:"Streaming bitrate in MB/s",variableId:"stream_bitrate"}),a.push({name:"Streaming duration (hh:mm)",variableId:"stream_duration_hm"}),a.push({name:"Streaming duration (hh:mm:ss)",variableId:"stream_duration_hms"}),a.push({name:"Streaming duration (mm:ss)",variableId:"stream_duration_ms"}),a.push({name:"Streaming Cache Used",variableId:"stream_cache_used"}),Aa(i.state,o)),r.recording&&(a.push({name:"Recording duration (hh:mm)",variableId:"record_duration_hm"}),a.push({name:"Recording duration (hh:mm:ss)",variableId:"record_duration_hms"}),a.push({name:"Recording duration (mm:ss)",variableId:"record_duration_ms"}),a.push({name:"Recording time remaining (hh:mm)",variableId:"record_remaining_hm"}),a.push({name:"Recording time remaining (hh:mm:ss)",variableId:"record_remaining_hms"}),a.push({name:"Recording time remaining (mm:ss)",variableId:"record_remaining_ms"}),a.push({name:"Recording filename",variableId:"record_filename"}),Ia(i.state,o));for(let e=0;e<r.SSrc;e++){for(let t=0;t<4;t++)a.push({name:`Supersource ${e+1} Box ${t+1} source`,variableId:`ssrc${e+1}_box${t+1}_source`}),a.push({name:`Supersource ${e+1} Box ${t+1} source id`,variableId:`ssrc${e+1}_box${t+1}_source_id`});Na(t,i.state,e,o)}if(i.state.fairlight){for(const[e,t]of Object.entries(i.state.fairlight.inputs))void 0!==t?.sources&&t.sources[-65280]&&(a.push({name:`Pan for input ${e}`,variableId:`audio_input_${e}_balance`}),a.push({name:`Fader gain for input ${e}`,variableId:`audio_input_${e}_faderGain`}),a.push({name:`Frames delay for input ${e}`,variableId:`audio_input_${e}_framesDelay`}),a.push({name:`Gain for input ${e}`,variableId:`audio_input_${e}_gain`}),a.push({name:`Mix option for input ${e}`,variableId:`audio_input_${e}_mixOption`})),void 0!==t?.sources&&t.sources[-256]&&(a.push({name:`Pan for input ${e} - left`,variableId:`audio_input_${e}_left_balance`}),a.push({name:`Fader gain for input ${e} - left`,variableId:`audio_input_${e}_left_faderGain`}),a.push({name:`Frames delay for input ${e} - left`,variableId:`audio_input_${e}_left_framesDelay`}),a.push({name:`Gain for input ${e} - left`,variableId:`audio_input_${e}_left_gain`}),a.push({name:`Mix option for input ${e} - left`,variableId:`audio_input_${e}_left_mixOption`})),void 0!==t?.sources&&t.sources[-255]&&(a.push({name:`Pan for input ${e} - right`,variableId:`audio_input_${e}_right_balance`}),a.push({name:`Fader gain for input ${e} - right`,variableId:`audio_input_${e}_right_faderGain`}),a.push({name:`Frames delay for input ${e} - right`,variableId:`audio_input_${e}_right_framesDelay`}),a.push({name:`Gain for input ${e} - right`,variableId:`audio_input_${e}_right_gain`}),a.push({name:`Mix option for input ${e} - right`,variableId:`audio_input_${e}_right_mixOption`})),xa(i.state,Number(e),o);a.push({name:"Fader gain for master",variableId:"audio_master_faderGain"}),Ma(i.state,o),a.push({name:"Gain for Monitor/Headphone",variableId:"audio_monitor_gain"}),a.push({name:"Gain for Monitor/Headphone Master",variableId:"audio_monitor_master_gain"}),a.push({name:"Gain for Monitor/Headphone Talkback",variableId:"audio_monitor_talkback_gain"}),a.push({name:"Gain for Monitor/Headphone Sidetone",variableId:"audio_monitor_sidetone_gain"}),Ta(i.state,o)}if(r.fairlightAudio?.audioRouting){for(const e of r.fairlightAudio.audioRouting.outputs)for(const t of e.channelPairs){const r=C(e.outputId,t),n=pe(r);a.push({name:`Name of audio routing destination ${n}`,variableId:`audio_routing_destinations_${n}_name`},{name:`Source of audio routing destination ${n}`,variableId:`audio_routing_destinations_${n}_source`},{name:`Name of source of audio routing destination ${n}`,variableId:`audio_routing_destinations_${n}_source_name`}),da(i.state,r,o)}for(const e of r.fairlightAudio.audioRouting.sources)for(const t of e.channelPairs){const r=C(e.inputId,t),n=pe(r);a.push({name:`Name of audio routing source ${n}`,variableId:`audio_routing_source_${n}_name`}),ca(i.state,r,o)}}if(r.classicAudio)for(const e of r.classicAudio.inputs)a.push({name:`Pan for input ${e.id}`,variableId:`audio_input_${e.id}_balance`}),a.push({name:`Gain for input ${e.id}`,variableId:`audio_input_${e.id}_gain`}),a.push({name:`Mix option for input ${e.id}`,variableId:`audio_input_${e.id}_mixOption`}),Ea(i.state,e.id,o);const n=r.multiviewerFullGrid?16:10;for(let e=1;e<=r.MVs;e++)for(let r=1;r<=n;r++)a.push({name:`Label of input in multiviewer ${e} window ${r}`,variableId:`mv_${e}_window_${r}_input`}),a.push({name:`Id of input in multiviewer ${e} window ${r}`,variableId:`mv_${e}_window_${r}_input_id`}),Oa(t,i.state,e,r,o);if(t.config.enableCameraControl)for(const t of r.inputs)t.portType===e.Enums.InternalPortType.External&&(la(0,t.id,a),sa(0,i.atemCameraState.get(t.id)??(0,oi.createEmptyState)(t.id),o));t.config.pollTimecode&&(a.push({name:"Timecode",variableId:"timecode"}),a.push({name:"Display Clock",variableId:"display_clock"}),ua(t,i.state,o)),t.setVariableDefinitions(a),t.setVariableValues(o)}(this,this.model,this.wrappedState),this.setPresetDefinitions(function(e,t,r){const i=Number(e.config.presets)===ct.Long?"long_":"short_",a=Number(e.config.presets)===ct.Long?"auto":"18",o=Y(t,r,"me");return function(e){const t={};for(const r of e)if(r)for(const[e,i]of Object.entries(r.presets))i&&(t[e]=Hi(i,r));return t}([...Zi(t,a,i,o),...ta(t,a,oa),...ra(t,r,a,i),...ia(t,a,i,o),...aa(t,a,i,o),...Qi(t),...Xi(t,r,a,i),...Yi(t,a,i,o),...Ji(t,a),...qi(t,a,oa),...Ui(t),...Gi(t)])}(this,this.model,this.wrappedState.state)),this.setFeedbackDefinitions((t=this.config,r=this.model,i=this.wrappedState,function(e){const t={};for(const[r,i]of Object.entries(e)){let e;switch(i?.type){case void 0:e=void 0;break;case"boolean":e={...hi(i),type:"boolean",defaultStyle:i.defaultStyle,showInvert:i.showInvert,callback:async(e,t)=>i.callback({...gi(e,t,i.options)},t)};break;case"advanced":e={...hi(i),type:"advanced",callback:async(e,t)=>i.callback({...gi(e,t,i.options),image:e.image},t)};break;default:(0,fi.assertNever)(i)}t[r]=e}return t}({...bi(r,i),...yi(r,i),...Si(r,i),...Ti(r,i),...Mi(r,i),...Ri(r,i),...vi(r,i),...Ni(r,i),...Ei(r,i),...xi(r,i),...Di(r,i),...Fi(r,i),..._i(r,i),...wi(r,i),...ki(r,i),...Pi(r,i),...Li(r,i),...$i(t,0,i)}))),this.setActionDefinitions(function(e,t,r,i,a,o){return function(e){const t={};for(const[r,i]of Object.entries(e))t[r]=i?Ir(i):void 0;return t}({...Cr(t,r,a,o),...Dr(e,t,r,i,o),...Hr(t,r,o),...Jr(t,r,o),...Yr(t,r,o),...qr(t,r,o),...Lr(t,r,o),...Vr(t,r,o),...Wr(t,r,o),...$r(t,r,o),...Br(t,r,o),...Xr(t,r,a,o),...Qr(t,r,a,o),...jr(t,r,o),...Ur(t,r,o),...Gr(t,r,o),...zr(t,r,o),...Fr(t,r,o),...ni(e.config,t,o),...si(e.config,t,o),...mi(e.config,r,t,o),...li(e.config,t,o),...ui(e.config,t),...pi(e,t,o)})}(this,this.atem,this.model,this.commandBatching,this.atemTransitions,this.wrappedState)),this.checkFeedbacks()}checkFeedbacks(...e){super.checkFeedbacks(...e)}processReceivedCommands(t){const r=[],i={};for(const a of t)a instanceof e.Commands.TallyBySourceCommand?(this.wrappedState.tally=a.properties,this.checkFeedbacks(ii.ProgramTally,ii.PreviewTally)):this.config.enableCameraControl&&a instanceof e.Commands.CameraControlUpdateCommand?r.push(a):this.config.pollTimecode&&a instanceof e.Commands.TimeCommand?(this.timecodeSeconds=3600*a.properties.hour+60*a.properties.minute+a.properties.second,ua(this,this.wrappedState.state,i)):this.config.pollTimecode&&a instanceof e.Commands.DisplayClockCurrentTimeCommand&&(this.displayClockSeconds=3600*a.properties.time.hours+60*a.properties.time.minutes+a.properties.time.seconds,ua(this,this.wrappedState.state,i));if(this.config.enableCameraControl&&r.length>0){const e=this.wrappedState.atemCameraState.applyCommands(r),t=new Set;for(const r of e)t.add(r.cameraId);for(const e of t)sa(0,this.wrappedState.atemCameraState.get(e)??(0,oi.createEmptyState)(e),i)}Object.keys(i).length>0&&this.setVariableValues(i)}processStateChange(e,t){this.wrappedState.state=e,this.wrappedState.mediaPoolCache.checkUpdatedState(e);let r=!1;const i=new Set,a={meProgram:new Set,mePreview:new Set,transitionPosition:new Set,auxes:new Set,dsk:new Set,usk:new Set,macros:new Set,ssrc:new Set,mediaPlayer:new Set,streaming:!1,recording:!1,fairlightAudio:new Set,fairlightAudioMaster:!1,fairlightAudioMonitor:!1,fairlightRoutingSources:new Set,fairlightRoutingOutputs:new Set,classicAudio:new Set,mvWindow:new Set};for(const e of t){if(r)break;const t=e.match(/video.auxilliaries.(\d+)/);if(t){i.add(ii.AuxBG),i.add(ii.AuxVariables),a.auxes.add(parseInt(t[1],10));continue}const o=e.match(/video.downstreamKeyers.(\d+)/);if(o){a.dsk.add(parseInt(o[1],10)),i.add(ii.DSKOnAir),i.add(ii.DSKTie),i.add(ii.DSKSource),i.add(ii.DSKSourceVariables);continue}const n=e.match(/fairlight.inputs.(\d+)/);if(n){a.fairlightAudio.add(parseInt(n[1],10)),i.add(ii.FairlightAudioInputGain),i.add(ii.FairlightAudioFaderGain),i.add(ii.FairlightAudioMixOption);continue}const s=e.match(/audio.channels.(\d+)/);if(s){a.classicAudio.add(parseInt(s[1],10)),i.add(ii.ClassicAudioGain),i.add(ii.ClassicAudioMixOption);continue}if(e.match(/fairlight.master/)){a.fairlightAudioMaster=!0,i.add(ii.FairlightAudioMasterGain);continue}if(e.match(/fairlight.monitor/)){a.fairlightAudioMonitor=!0,i.add(ii.FairlightAudioMonitorOutputFaderGain),i.add(ii.FairlightAudioMonitorMasterGain),i.add(ii.FairlightAudioMonitorMasterMuted),i.add(ii.FairlightAudioMonitorSidetoneGain),i.add(ii.FairlightAudioMonitorTalkbackGain),i.add(ii.FairlightAudioMonitorTalkbackMuted);continue}if(e.match(/fairlight.solo/)){i.add(ii.FairlightAudioMonitorSolo);continue}if(e.match(/^inputs/)){r=!0;break}if(e.match(/video.mixEffects.(\d+).upstreamKeyers.(\d+).flyProperties/)){i.add(ii.USKKeyFrame);continue}if(e.match(/video.mixEffects.(\d+).upstreamKeyers.(\d+).onAir/)){i.add(ii.USKOnAir);continue}const l=e.match(/video.mixEffects.(\d+).upstreamKeyers.(\d+)/);if(l){const e=parseInt(l[1],10),t=parseInt(l[2],10);a.usk.add([e,t]),i.add(ii.USKType),i.add(ii.USKSource),i.add(ii.USKSourceVariables);continue}const u=e.match(/macro.macroProperties.(\d+)/);if(u){const e=parseInt(u[1],10);a.macros.add(e),i.add(ii.Macro);continue}if(e.match(/macro.macroRecorder/)||e.match(/macro.macroPlayer/)){i.add(ii.Macro),i.add(ii.MacroLoop);continue}const c=e.match(/settings.multiViewers.(\d+).windows.(\d+)/);if(c){const e=parseInt(c[1],10),t=parseInt(c[2],10);a.mvWindow.add([e+1,t+1]),i.add(ii.MVSource),i.add(ii.MVSourceVariables);continue}if(e.match(/settings.multiViewers.(\d+).properties/)){i.add(ii.MultiviewerLayout);continue}const d=e.match(/video.mixEffects.(\d+).programInput/);if(d){const e=parseInt(d[1],10);a.meProgram.add(e),i.add(ii.ProgramBG),i.add(ii.ProgramVariables),i.add(ii.ProgramBG2),i.add(ii.ProgramBG3),i.add(ii.ProgramBG4);continue}const p=e.match(/video.mixEffects.(\d+).previewInput/);if(p){const e=parseInt(p[1],10);a.mePreview.add(e),i.add(ii.PreviewBG),i.add(ii.PreviewVariables),i.add(ii.PreviewBG2),i.add(ii.PreviewBG3),i.add(ii.PreviewBG4);continue}const m=e.match(/video.superSources.(\d+).boxes.(\d+)/);if(m){i.add(ii.SSrcBoxSource),i.add(ii.SSrcBoxSourceVariables),i.add(ii.SSrcBoxOnAir),i.add(ii.SSrcBoxProperties),a.ssrc.add(parseInt(m[1],10));continue}if(e.match(/video.superSources.(\d+).properties/)){i.add(ii.SSrcArtOption),i.add(ii.SSrcArtSource),i.add(ii.SSrcArtProperties),i.add(ii.SSrcArtPropertiesVariables);continue}if(e.match(/video.mixEffects.(\d+).transitionProperties/)){i.add(ii.TransitionStyle),i.add(ii.TransitionSelection);continue}if(e.match(/video.mixEffects.(\d+).transitionSettings/)){i.add(ii.TransitionRate);continue}if(e.match(/video.mixEffects.(\d+).transitionPreview/)){i.add(ii.PreviewTransition);continue}const b=e.match(/video.mixEffects.(\d+).transitionPosition/);if(b){const e=parseInt(b[1],10);a.transitionPosition.add(e),i.add(ii.InTransition);continue}if(e.match(/video.mixEffects.(\d+).fadeToBlack/)){i.add(ii.FadeToBlackRate),i.add(ii.FadeToBlackIsBlack);continue}const f=e.match(/media.players.(\d+)/);if(f){const e=parseInt(f[1],10);a.mediaPlayer.add(e),i.add(ii.MediaPlayerSource),i.add(ii.MediaPlayerSourceVariables)}else{if(e.match(/media.clipPool/)||e.match(/media.stillPool/)){r=!0;break}if(e.match(/streaming.status/))i.add(ii.StreamStatus);else if(e.match(/recording.status/))i.add(ii.RecordStatus);else if(e.match(/recording.recordAllInputs/))i.add(ii.RecordISO);else if(e.match(/streaming.duration/)||e.match(/streaming.stats/))a.streaming=!0;else if(e.match(/recording.duration/))a.recording=!0;else if(e.match(/fairlight.monitor/))i.add(ii.FairlightAudioMonitorMasterMuted);else if(e.match(/fairlight.audioRouting/)){i.add(ii.FairlightAudioRouting),i.add(ii.FairlightAudioRoutingVariables);const t=e.match(/fairlight.audioRouting.sources.(\d+)/);if(t){a.fairlightRoutingSources.add(Number(t[1]));continue}const r=e.match(/fairlight.audioRouting.outputs.(\d+)/);if(r){a.fairlightRoutingOutputs.add(Number(r[1]));continue}}else e.match(/settings.timeMode/)&&i.add(ii.TimecodeMode)}}const o=this.invalidateCachedTallyState();r?this.updateCompanionBits():(function(e,t,r){const i={};for(const a of r.meProgram)ma(e,t,a,i);for(const a of r.mePreview)ba(e,t,a,i);for(const e of r.transitionPosition)fa(t,e,i);for(const a of r.auxes)ya(e,t,a,i);for(const a of r.dsk)ha(e,t,a,i);for(const[a,o]of r.usk)ga(e,t,a,o,i);for(const e of r.macros)Sa(t,e,i);for(const a of r.ssrc)Na(e,t,a,i);for(const e of r.mediaPlayer)Ca(t,e,i);r.recording&&Ia(t,i),r.streaming&&Aa(t,i);for(const e of r.fairlightAudio)xa(t,e,i);for(const e of r.classicAudio)Ea(t,e,i);r.fairlightAudioMaster&&Ma(t,i),r.fairlightAudioMonitor&&Ta(t,i);for(const e of r.fairlightRoutingSources)ca(t,e,i);for(const e of r.fairlightRoutingOutputs)da(t,e,i);for(const[a,o]of r.mvWindow)Oa(e,t,a,o,i);Object.keys(i).length>0&&e.setVariableValues(i)}(this,this.wrappedState.state,a),i.size>0&&this.checkFeedbacks(...Array.from(i)),o.size>0&&this.checkFeedbacksById(...Array.from(o)))}invalidateCachedTallyState(){const e=new Set;for(const[t,r]of this.wrappedState.tallyCache.entries())if(r.referencedFeedbackIds.size){const i=de(this.wrappedState.state,t);r.lastVisibleInputs.length===i.length&&Fn(i,r.lastVisibleInputs)||(r.referencedFeedbackIds.forEach((t=>e.add(t))),r.lastVisibleInputs=i)}else r.lastVisibleInputs=[];return e}setupAtemConnection(){this.atem=new Un,this.atem.on("connected",(()=>{if(this.atem?.state){this.wrappedState.state=this.atem.state,this.wrappedState.mediaPoolCache.checkUpdatedState(this.atem.state),this.invalidateCachedTallyState();const e=this.wrappedState.state.info;this.log("info","Connected to a "+e.productIdentifier),this.updateStatus(t.InstanceStatus.Ok);const i=this.getBestModelId(),a=i?st(i):void 0;a?this.model=a:(this.model=function({info:e,inputs:t,settings:i,streaming:a,recording:o,audio:n,fairlight:s,displayClock:l}){const u=lt(),c=ae(Object.values(t)).map((e=>({id:e.inputId,portType:e.internalPortType,sourceAvailability:e.sourceAvailability,meAvailability:e.meAvailability})));return{id:e.model,label:e.productIdentifier??"Blackmagic ATEM",inputs:c,outputs:e.capabilities?he("Aux/Output",e.capabilities.auxilliaries):u.outputs,MEs:e.capabilities?.mixEffects??u.MEs,USKs:e.mixEffects[0]?.keyCount??u.USKs,DSKs:e.capabilities?.downstreamKeyers??u.DSKs,MVs:i.multiViewers.length,multiviewerFullGrid:(i.multiViewers?.[0]?.windows.length||0)>10,DVEs:e.capabilities?.DVEs??u.DVEs,SSrc:e.capabilities?.superSources??u.SSrc,macros:e.macroPool?.macroCount??u.macros,displayClock:l?1:0,media:{players:e.capabilities?.mediaPlayers??u.media.players,stills:e.mediaPool?.stillCount??u.media.stills,clips:e.mediaPool?.clipCount??u.media.clips,captureStills:!!e.mediaPool?.stillCount&&e.model>=r.Model.Mini},streaming:null!=a,recording:null!=o,recordISO:null!=o?.recordAllInputs,classicAudio:n?{inputs:ae(Object.entries(n.channels).map((([e,t])=>{if(t?.portType)return{id:Number(e),portType:t.portType}})))}:void 0,fairlightAudio:s?{monitor:s.monitor?"split":null,audioRouting:s.audioRouting?ut(s.audioRouting):void 0,inputs:ae(Object.entries(s.inputs).map((([e,t])=>{if(t?.properties)return{id:Number(e),portType:t.properties.externalPortType,maxDelay:Math.max(...Object.values(t.sources).map((e=>e?.properties?.maxFramesDelay??0)))}})))}:void 0}}(this.wrappedState.state),this.updateStatus(t.InstanceStatus.UnknownWarning,`Unknown model: ${e.productIdentifier}. Some bits may be missing`)),this.config.modelID+""=="0"?(this.config.autoModelID=this.model.id,this.config.autoModelName=this.model.label):(delete this.config.autoModelID,delete this.config.autoModelName),setImmediate((()=>{console.log("save",this.config),this.saveConfig(this.config)}));const o=this.config.modelID?parseInt(this.config.modelID,10):void 0;0!==o&&void 0!==o&&o!==this.model.id&&this.log("warn","Connected to a "+e.productIdentifier+", but instance is configured for "+this.model.label+".  Change instance to 'Auto Detect' or the appropriate model to ensure stability."),this.updateCompanionBits(),!this.durationInterval&&(this.wrappedState.state.streaming||this.wrappedState.state.recording||this.config.pollTimecode)&&(this.durationInterval=setInterval((()=>{this.atem&&this.wrappedState.state.streaming&&this.atem.requestStreamingDuration().catch((e=>{this.log("debug","Request streaming duration error: "+e)})),this.atem&&this.wrappedState.state.recording&&this.atem.requestRecordingDuration().catch((e=>{this.log("debug","Request recording duration error: "+e)})),this.atem&&this.config.pollTimecode&&(this.atem.requestTime().catch((e=>{this.log("debug","Request time error: "+e)})),this.atem.requestDisplayClockTime().catch((e=>{this.log("debug","Request display clock time error: "+e)})))}),500))}})),this.atem.on("info",(e=>this.log("debug",e))),this.atem.on("error",(e=>{this.log("error",e.message),this.updateStatus(t.InstanceStatus.UnknownError,e.message)})),this.atem.on("disconnected",(()=>{this.isActive&&this.updateStatus(t.InstanceStatus.Connecting),this.log("info","Lost connection"),this.durationInterval&&(clearInterval(this.durationInterval),delete this.durationInterval)})),this.atem.on("stateChanged",this.processStateChange.bind(this)),this.atem.on("receivedCommands",this.processReceivedCommands.bind(this));const e=this.parseIpAndPort();e&&(this.updateStatus(t.InstanceStatus.Connecting),this.atem.connect(e.ip,e.port).catch((e=>{this.updateStatus(t.InstanceStatus.ConnectionFailure),this.log("error",`Connecting failed: ${e}`)})))}parseIpAndPort(){const e=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;if(this.config.bonjourHost){const[t,r]=this.config.bonjourHost.split(":"),i=Number(r);if(t.match(e)&&!isNaN(i))return{ip:t,port:i}}else if(this.config.host&&this.config.host.match(e))return{ip:this.config.host,port:void 0};return null}}(0,t.runEntrypoint)(Wn,Ln)})()})();