(()=>{var e={7169:(e,t,n)=>{"use strict";const r=n(2017);r.code='require("ajv/dist/runtime/equal").default',t.A=r},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n={grad:.9,turn:360,rad:360/(2*Math.PI)},r=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},i=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n+0},a=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e>t?e:t},s=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},o=function(e){return{r:a(e.r,0,255),g:a(e.g,0,255),b:a(e.b,0,255),a:a(e.a)}},l=function(e){return{r:i(e.r),g:i(e.g),b:i(e.b),a:i(e.a,3)}},c=/^#([0-9a-f]{3,8})$/i,u=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,n=e.g,r=e.b,i=e.a,a=Math.max(t,n,r),s=a-Math.min(t,n,r),o=s?a===t?(n-r)/s:a===n?2+(r-t)/s:4+(t-n)/s:0;return{h:60*(o<0?o+6:o),s:a?s/a*100:0,v:a/255*100,a:i}},p=function(e){var t=e.h,n=e.s,r=e.v,i=e.a;t=t/360*6,n/=100,r/=100;var a=Math.floor(t),s=r*(1-n),o=r*(1-(t-a)*n),l=r*(1-(1-t+a)*n),c=a%6;return{r:255*[r,o,s,s,l,r][c],g:255*[l,r,r,o,s,s][c],b:255*[s,s,l,r,r,o][c],a:i}},h=function(e){return{h:s(e.h),s:a(e.s,0,100),l:a(e.l,0,100),a:a(e.a)}},m=function(e){return{h:i(e.h),s:i(e.s),l:i(e.l),a:i(e.a,3)}},b=function(e){return p((n=(t=e).s,{h:t.h,s:(n*=((r=t.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:t.a}));var t,n,r},g=function(e){return{h:(t=d(e)).h,s:(i=(200-(n=t.s))*(r=t.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,n,r,i},f=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,k={string:[[function(e){var t=c.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?i(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?i(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=v.exec(e)||w.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:o({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=f.exec(e)||y.exec(e);if(!t)return null;var r,i,a=h({h:(r=t[1],i=t[2],void 0===i&&(i="deg"),Number(r)*(n[i]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return b(a)},"hsl"]],object:[[function(e){var t=e.r,n=e.g,i=e.b,a=e.a,s=void 0===a?1:a;return r(t)&&r(n)&&r(i)?o({r:Number(t),g:Number(n),b:Number(i),a:Number(s)}):null},"rgb"],[function(e){var t=e.h,n=e.s,i=e.l,a=e.a,s=void 0===a?1:a;if(!r(t)||!r(n)||!r(i))return null;var o=h({h:Number(t),s:Number(n),l:Number(i),a:Number(s)});return b(o)},"hsl"],[function(e){var t=e.h,n=e.s,i=e.v,o=e.a,l=void 0===o?1:o;if(!r(t)||!r(n)||!r(i))return null;var c=function(e){return{h:s(e.h),s:a(e.s,0,100),v:a(e.v,0,100),a:a(e.a)}}({h:Number(t),s:Number(n),v:Number(i),a:Number(l)});return p(c)},"hsv"]]},N=function(e,t){for(var n=0;n<t.length;n++){var r=t[n][0](e);if(r)return[r,t[n][1]]}return[null,void 0]},x=function(e){return"string"==typeof e?N(e.trim(),k.string):"object"==typeof e&&null!==e?N(e,k.object):[null,void 0]},I=function(e,t){var n=g(e);return{h:n.h,s:a(n.s+100*t,0,100),l:n.l,a:n.a}},S=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},C=function(e,t){var n=g(e);return{h:n.h,s:n.s,l:a(n.l+100*t,0,100),a:n.a}},_=function(){function e(e){this.parsed=x(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return i(S(this.rgba),2)},e.prototype.isDark=function(){return S(this.rgba)<.5},e.prototype.isLight=function(){return S(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=l(this.rgba)).r,n=e.g,r=e.b,s=(a=e.a)<1?u(i(255*a)):"","#"+u(t)+u(n)+u(r)+s;var e,t,n,r,a,s},e.prototype.toRgb=function(){return l(this.rgba)},e.prototype.toRgbString=function(){return t=(e=l(this.rgba)).r,n=e.g,r=e.b,(i=e.a)<1?"rgba("+t+", "+n+", "+r+", "+i+")":"rgb("+t+", "+n+", "+r+")";var e,t,n,r,i},e.prototype.toHsl=function(){return m(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=m(g(this.rgba))).h,n=e.s,r=e.l,(i=e.a)<1?"hsla("+t+", "+n+"%, "+r+"%, "+i+")":"hsl("+t+", "+n+"%, "+r+"%)";var e,t,n,r,i},e.prototype.toHsv=function(){return e=d(this.rgba),{h:i(e.h),s:i(e.s),v:i(e.v),a:i(e.a,3)};var e},e.prototype.invert=function(){return M({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),M(I(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),M(I(this.rgba,-e))},e.prototype.grayscale=function(){return M(I(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),M(C(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),M(C(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?M({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):i(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?M({h:e,s:t.s,l:t.l,a:t.a}):i(t.h)},e.prototype.isEqual=function(e){return this.toHex()===M(e).toHex()},e}(),M=function(e){return e instanceof _?e:new _(e)},O=[];t.Colord=_,t.colord=M,t.extend=function(e){e.forEach((function(e){O.indexOf(e)<0&&(e(_,k),O.push(e))}))},t.getFormat=function(e){return x(e)[1]},t.random=function(){return new _({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===r(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var i=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=i,t.convertMapToObject=function(e){return Array.from(e).reduce((function(e,t){var r,i,a=(i=2,function(e){if(Array.isArray(e))return e}(r=t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return a}}(r,i)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(r,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],o=a[1];return e[s]=o,e}),{})},t.isArguments=function(e){return null!=e&&i(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var a={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=a,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(a.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var n=Object.create(null),r=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},i=0;i<64;i++)n[r(i)]=i;var a=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],n=0;n<e;n++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},s={encode:function(e){if("string"==typeof e){var t=e;e=a(t.length);for(var n=0;n<t.length;n++){var i=t.charCodeAt(n);if(i>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[n]=i}}for(var s=[],o=null,l=null,c=null,u=null,d=0;d<e.length;d++)switch(d%3){case 0:o=e[d]>>2&63,l=(3&e[d])<<4;break;case 1:l|=e[d]>>4&15,c=(15&e[d])<<2;break;case 2:c|=e[d]>>6&3,u=63&e[d],s.push(r(o)),s.push(r(l)),s.push(r(c)),s.push(r(u)),o=null,l=null,c=null,u=null}return null!=o&&(s.push(r(o)),s.push(r(l)),null==c?s.push("="):s.push(r(c)),null==u&&s.push("=")),s.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var r,i=a(t),s=null,o=null,l=null,c=0,u=0;u<e.length;u++){var d="="===(r=e.charAt(u))?-1:n[r];switch(u%4){case 0:if(d<0)throw new Error("invalid base64 string");s=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");s|=d>>4,i[c++]=s,o=(15&d)<<4;break;case 2:d>=0&&(o|=d>>2,i[c++]=o,l=(3&d)<<6);break;case 3:d>=0&&(i[c++]=l|d)}}return i},newBinary:a};t.Base64=s},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function e(t,i,a,s,o){var l=i[t];switch(n(l)){case"string":return r(l);case"number":return isFinite(l)?String(l):"null";case"boolean":return String(l);case"object":if(!l)return"null";var c,u=s+a,d=[];if(Array.isArray(l)||{}.hasOwnProperty.call(l,"callee")){for(var p=l.length,h=0;h<p;h+=1)d[h]=e(h,l,a,u,o)||"null";return c=0===d.length?"[]":u?"[\n"+u+d.join(",\n"+u)+"\n"+s+"]":"["+d.join(",")+"]"}var m=Object.keys(l);return o&&(m=m.sort()),m.forEach((function(t){(c=e(t,l,a,u,o))&&d.push(r(t)+(u?": ":":")+c)})),c=0===d.length?"{}":u?"{\n"+u+d.join(",\n"+u)+"\n"+s+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var n=Object.assign({indent:"",canonical:!1},t);if(!0===n.indent)n.indent="  ";else if("number"==typeof n.indent){for(var r="",a=0;a<n.indent;a++)r+=" ";n.indent=r}return i("",{"":e},n.indent,"",n.canonical)},e.exports=t.default}],n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}var i={};!function(){var e=i,t=r(2).Base64,n=r(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var a=r(1),s={};e.EJSON=s;var o=new Map;s.addType=function(e,t){if(o.has(e))throw new Error("Type ".concat(e," already present"));o.set(e,t)};var l=[{matchJSONValue:function(e){return(0,a.hasOwn)(e,"$date")&&1===(0,a.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,a.hasOwn)(e,"$regexp")&&(0,a.hasOwn)(e,"$flags")&&2===(0,a.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,a.hasOwn)(e,"$InfNaN")&&1===(0,a.lengthOf)(e)},matchObject:a.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,a.hasOwn)(e,"$binary")&&1===(0,a.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,a.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,a.hasOwn)(e,"$escape")&&1===(0,a.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var n=(0,a.lengthOf)(e);1!==n&&2!==n||(t=l.some((function(t){return t.matchJSONValue(e)})))}return t},toJSONValue:function(e){var t={};return(0,a.keysOf)(e).forEach((function(n){t[n]=s.toJSONValue(e[n])})),{$escape:t}},fromJSONValue:function(e){var t={};return(0,a.keysOf)(e.$escape).forEach((function(n){t[n]=s.fromJSONValue(e.$escape[n])})),t}},{matchJSONValue:function(e){return(0,a.hasOwn)(e,"$type")&&(0,a.hasOwn)(e,"$value")&&2===(0,a.lengthOf)(e)},matchObject:function(e){return s._isCustomType(e)},toJSONValue:function(e){var t=n._noYieldsAllowed((function(){return e.toJSONValue()}));return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!o.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var r=o.get(t);return n._noYieldsAllowed((function(){return r(e.$value)}))}}];s._isCustomType=function(e){return e&&(0,a.isFunction)(e.toJSONValue)&&(0,a.isFunction)(e.typeName)&&o.has(e.typeName())},s._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?o:(0,a.convertMapToObject)(o)},s._getConverters=function(){return l};var c=function(e){for(var t=0;t<l.length;t++){var n=l[t];if(n.matchObject(e))return n.toJSONValue(e)}},u=function e(t){if(null===t)return null;var n=c(t);return void 0!==n?n:(0,a.isObject)(t)?((0,a.keysOf)(t).forEach((function(n){var r=t[n];if((0,a.isObject)(r)||void 0===r||(0,a.isInfOrNaN)(r)){var i=c(r);i?t[n]=i:e(r)}})),t):t};s._adjustTypesToJSONValue=u,s.toJSONValue=function(e){var t=c(e);if(void 0!==t)return t;var n=e;return(0,a.isObject)(e)&&(n=s.clone(e),u(n)),n};var d=function(e){if((0,a.isObject)(e)&&null!==e){var t=(0,a.keysOf)(e);if(t.length<=2&&t.every((function(e){return"string"==typeof e&&"$"===e.substr(0,1)})))for(var n=0;n<l.length;n++){var r=l[n];if(r.matchJSONValue(e))return r.fromJSONValue(e)}}return e},p=function e(t){if(null===t)return null;var n=d(t);return n!==t?n:(0,a.isObject)(t)?((0,a.keysOf)(t).forEach((function(n){var r=t[n];if((0,a.isObject)(r)){var i=d(r);if(r!==i)return void(t[n]=i);e(r)}})),t):t};s._adjustTypesFromJSONValue=p,s.fromJSONValue=function(e){var t=d(e);return t===e&&(0,a.isObject)(e)&&(t=s.clone(e),p(t)),t},s.stringify=(0,a.handleError)((function(e,t){var n=s.toJSONValue(e);return t&&(t.canonical||t.indent)?r(4)(n,t):JSON.stringify(n)})),s.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return s.fromJSONValue(JSON.parse(e))},s.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},s.equals=function(e,t,n){var r,i=!(!n||!n.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,a.isObject)(e)||!(0,a.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(s.isBinary(e)&&s.isBinary(t)){if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}if((0,a.isFunction)(e.equals))return e.equals(t,n);if((0,a.isFunction)(t.equals))return t.equals(e,n);var o,l=Array.isArray(e),c=Array.isArray(t);if(l!==c)return!1;if(l&&c){if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(!s.equals(e[r],t[r],n))return!1;return!0}switch(s._isCustomType(e)+s._isCustomType(t)){case 1:return!1;case 2:return s.equals(s.toJSONValue(e),s.toJSONValue(t))}var u=(0,a.keysOf)(e),d=(0,a.keysOf)(t);return i?(r=0,o=u.every((function(i){return!(r>=d.length||i!==d[r]||!s.equals(e[i],t[d[r]],n)||(r++,0))}))):(r=0,o=u.every((function(i){return!!(0,a.hasOwn)(t,i)&&!!s.equals(e[i],t[i],n)&&(r++,!0)}))),o&&r===d.length},s.clone=function(e){var t;if(!(0,a.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(s.isBinary(e)){t=s.newBinary(e.length);for(var n=0;n<e.length;n++)t[n]=e[n];return t}return Array.isArray(e)?e.map(s.clone):(0,a.isArguments)(e)?Array.from(e).map(s.clone):(0,a.isFunction)(e.clone)?e.clone():s._isCustomType(e)?s.fromJSONValue(s.clone(s.toJSONValue(e)),!0):(t={},(0,a.keysOf)(e).forEach((function(n){t[n]=s.clone(e[n])})),t)},s.newBinary=t.newBinary}(),e.exports=i.EJSON}()},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,r,a,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new i(r,a||e,s),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},o.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,s=new Array(a);i<a;i++)s[i]=r[i].fn;return s},o.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,i,a,s){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,u=this._events[o],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,a),!0;case 6:return u.fn.call(u.context,t,r,i,a,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var p,h=u.length;for(c=0;c<h;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,i);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,r,i){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||i&&!o.once||r&&o.context!==r||s(this,a);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==t||i&&!o[l].once||r&&o[l].context!==r)&&c.push(o[l]);c.length?this._events[a]=1===c.length?c[0]:c:s(this,a)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o},2017:e=>{"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;0!=i--;){var s=a[i];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},4865:e=>{"use strict";const t=(e,t,r,i)=>{if("length"===r||"prototype"===r)return;if("arguments"===r||"caller"===r)return;const a=Object.getOwnPropertyDescriptor(e,r),s=Object.getOwnPropertyDescriptor(t,r);!n(a,s)&&i||Object.defineProperty(e,r,s)},n=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},r=(e,t)=>`/* Wrapped ${e}*/\n${t}`,i=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),a=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,n,{ignoreNonConfigurable:s=!1}={})=>{const{name:o}=e;for(const r of Reflect.ownKeys(n))t(e,n,r,s);return((e,t)=>{const n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,n)})(e,n),((e,t,n)=>{const s=""===n?"":`with ${n.trim()}() `,o=r.bind(null,s,t.toString());Object.defineProperty(o,"name",a),Object.defineProperty(e,"toString",{...i,value:o})})(e,n,o),e}},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},3290:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(228),i=n(7685),a=n(4774),s=()=>{},o=new i.TimeoutError;t.default=class extends r{constructor(e){var t,n,r,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=s,this._resolveIdle=s,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:a.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=s,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=s,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((n,r)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const a=void 0===this._timeout&&void 0===t.timeout?e():i.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&r(o)}));n(await a)}catch(e){r(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){let r=0,i=e.length;for(;i>0;){const a=i/2|0;let s=r+a;n(e[s],t)<=0?(r=++s,i-=a+1):i=a}return r}},4774:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const n={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(n);const i=r.default(this._queue,n,((e,t)=>t.priority-e.priority));this._queue.splice(i,0,n)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},7685:(e,t,n)=>{"use strict";const r=n(4617);class i extends Error{constructor(e){super(e),this.name="TimeoutError"}}const a=(e,t,n)=>new Promise(((a,s)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void a(e);const o=setTimeout((()=>{if("function"==typeof n){try{a(n())}catch(e){s(e)}return}const r=n instanceof Error?n:new i("string"==typeof n?n:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),s(r)}),t);r(e.then(a,s),(()=>{clearTimeout(o)}))}));e.exports=a,e.exports.default=a,e.exports.TimeoutError=i},9367:(e,t,n)=>{const{Regex:r}=n(6278),{paramSep:i,grpAval:a,grpBval:s,grpCval:o,toggle:l,noChange:c,MatrixCount:u,MatrixSize:d,GroupCount:p,MaxChannelCount:h,cmd:m}=n(1586);e.exports=function(e){e.setActionDefinitions({channel_mode:{name:"Channel - Mode",description:"Set the mode of a channel",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"mode",type:"dropdown",label:"Mode",default:1,choices:e.channel_modes},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.channel.mode,r=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(r)||r<1||r>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;t.query?n+=i+r:n+=i+r+i+t.mode,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsMode[n];return{...t.options,mode:r}},subscribe:async t=>{let n=m.channel.mode,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_preset:{name:"Channel - Preset",description:"Set the preset of a channel",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"preset",type:"dropdown",label:"Preset",default:1,choices:e.channel_modes},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.channel.preset,r=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(r)||r<1||r>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;t.query?n+=i+r:n+=i+r+i+t.preset,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsPreset[n];return{...t.options,preset:r}},subscribe:async t=>{let n=m.channel.preset,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_bypass:{name:"Channel - Bypass",description:"Switch a channel bypass on/off",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"bypass",type:"dropdown",label:"Bypass",default:1,choices:e.channel_bypass},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.channel.bypass,r=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(r)||r<1||r>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;t.query?n+=i+r:t.bypass==l?n+=i+r+i+(1^e.channelsBypass[Number(r)]):n+=i+r+i+t.bypass,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsBypass[n];return{...t.options,bypass:r}},subscribe:async t=>{let n=m.channel.bypass,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_override:{name:"Channel - Override",description:"Switch a channel override on/off",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"override",type:"dropdown",label:"Override",default:0,choices:e.channel_override},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.channel.override,r=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(r)||r<1||r>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;t.query?n+=i+r:t.override==l?n+=i+r+i+(1^e.channelsOverride[Number(r)]):n+=i+r+i+t.override,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsOverride[n];return{...t.options,override:r}},subscribe:async t=>{let n=m.channel.override,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_weight:{name:"Channel - Weight",description:"Set the automix weight of a channel",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"useVar",type:"checkbox",label:"Use Variable",default:!1},{id:"weight",type:"number",label:"Weight",default:0,min:-100,max:15,range:!0,step:.1,required:!0,regex:r.NUMBER,isVisible:e=>!1===e.useVar},{id:"weightVar",type:"textinput",label:"Weight - Variable",default:"",useVariables:!0,regex:r.SOMETHING,isVisible:e=>!0===e.useVar},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.channel.weight,r=Number(await e.parseVariablesInString(t.weightVar));r=r.toFixed(2);let a=parseInt(await e.parseVariablesInString(t.channel)),s=0;if(isNaN(a)||a<1||a>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${a}`),!1;if(t.useVar){if(isNaN(r))return;s=r>15?15:r,s=r<-100?-100:r}else s=t.weight;t.query?n+=i+a:n+=i+a+i+s,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsWeight[n];return{...t.options,weight:r}},subscribe:async t=>{let n=m.channel.weight,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_weight_rel:{name:"Channel - Weight, Relative",description:"Adjust automix weight of a channel",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"weight",type:"number",label:"Weight",default:1,min:-6,max:6,range:!0,step:.1,required:!0,regex:r.NUMBER}],callback:async({options:t})=>{let n=m.channel.weight,r=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(r)||r<1||r>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=(e.channelsWeight[t.channel]+t.weight).toFixed(2);a<-100&&(a=-100),a>15&&(a=15),n+=i+r+i+a,e.addCmdtoQueue(n)},subscribe:async t=>{let n=m.channel.weight,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_music_mode:{name:"Channel - Music Mode",description:"Switch a channel music mode on/off",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"music",type:"dropdown",label:"Music Mode",default:1,choices:e.channel_offOnToggle},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.channel.music,r=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(r)||r<1||r>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;t.query?n+=i+r:t.music==l?n+=i+r+i+(1^e.channelsMusic[Number(r)]):n+=i+r+i+t.music,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsMusic[n];return{...t.options,music:r}},subscribe:async t=>{let n=m.channel.music,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_NOM_mode:{name:"Channel - NOM Mode",description:"Switch a channel NOM mode on/off",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"nom",type:"dropdown",label:"NOM Mode",default:1,choices:e.channel_offOnToggle},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.channel.nom,r=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(r)||r<1||r>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;t.query?n+=i+r:t.nom==l?n+=i+r+i+(1^e.channelsNom[Number(r)]):n+=i+r+i+t.nom,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsNom[n];return{...t.options,nom:r}},subscribe:async t=>{let n=m.channel.nom,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_group_assign:{name:"Channel - Group Assign",description:"Set the group of a channel",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"group",type:"dropdown",label:"Group Assignment",default:1,choices:e.groupNames},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the current name"}],callback:({options:t})=>{let n=m.channel.group;t.query?n+=i+t.channel:n+=i+t.channel+i+t.group,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsGroupAssign[n];return{...t.options,group:r}},subscribe:async t=>{let n=m.channel.group,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},channel_name:{name:"Channel - Name",description:"Name a Channel",options:[{id:"channel",type:"dropdown",label:"Channel",default:1,choices:e.channelNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"name",type:"textinput",label:"Channel Name",default:"Channel 1",required:!0,Regex:r.SOMETHING,useVariables:!0,tooltip:"Max Length: 15 char"},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the current name"}],callback:async({options:t})=>{let n=m.channel.name,r=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(r)||r<1||r>e.config.channels)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;if(t.query)n+=i+r;else{let a=await e.regexSafeString(await e.parseVariablesInString(t.name));if(!(null!=a&&a.length>=1))return e.log("warn","Not a valid channel name"),!1;n+=i+r+i+a}e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(n)||n<1||n>e.config.channels)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.channelsName[n];return{...t.options,name:r}},subscribe:async t=>{let n=m.channel.name,r=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(r)||r<1||r>e.config.channels?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},group_mute:{name:"Group - Mute",description:"Set the mute state of the groups",options:[{id:"groupA",type:"dropdown",label:"Group A Mute",default:0,choices:e.groupA_mute},{id:"groupB",type:"dropdown",label:"Group B Mute",default:0,choices:e.groupB_mute},{id:"groupC",type:"dropdown",label:"Group C Mute",default:0,choices:e.groupC_mute},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the group mute state"}],callback:({options:t})=>{let n=m.group.mute;if(!t.query){let r=0;t.groupA<l&&(r+=t.groupA),t.groupB<l&&(r+=t.groupB),t.groupC<l&&(r+=t.groupC),t.groupA==l&&(r+=e.groupMute[1]^a),t.groupB==l&&(r+=e.groupMute[2]^s),t.groupC==l&&(r+=e.groupMute[3]^o),t.groupA==c&&(r+=e.groupMute[1]),t.groupB==c&&(r+=e.groupMute[2]),t.groupC==c&&(r+=e.groupMute[3]),n+=i+r}e.addCmdtoQueue(n)},learn:t=>{const n=e.groupMute[1],r=e.groupMute[2],i=e.groupMute[3];return{...t.options,groupA:n,groupB:r,groupC:i}},subscribe:()=>{e.addCmdtoQueue(m.group.mute)}},group_preset:{name:"Group - Preset",description:"Set the preset state of the groups",options:[{id:"groupA",type:"dropdown",label:"Group A Preset",default:0,choices:e.groupA_preset},{id:"groupB",type:"dropdown",label:"Group B Preset",default:0,choices:e.groupB_preset},{id:"groupC",type:"dropdown",label:"Group C Preset",default:0,choices:e.groupC_preset},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the group preset state"}],callback:({options:t})=>{let n=m.group.preset;if(!t.query){let r=0;t.groupA<l&&(r+=t.groupA),t.groupB<l&&(r+=t.groupB),t.groupC<l&&(r+=t.groupC),t.groupA==l&&(r+=e.groupPreset[1]^a),t.groupB==l&&(r+=e.groupPreset[2]^s),t.groupC==l&&(r+=e.groupPreset[3]^o),t.groupA==c&&(r+=e.groupPreset[1]),t.groupB==c&&(r+=e.groupPreset[2]),t.groupC==c&&(r+=e.groupPreset[3]),n+=i+r}e.addCmdtoQueue(n)},learn:t=>{const n=e.groupPreset[1],r=e.groupPreset[2],i=e.groupPreset[3];return{...t.options,groupA:n,groupB:r,groupC:i}},subscribe:()=>{e.addCmdtoQueue(m.group.preset)}},group_override:{name:"Group - Override",description:"Set the Override state of the groups",options:[{id:"groupA",type:"dropdown",label:"Group A Override",default:0,choices:e.groupA_override},{id:"groupB",type:"dropdown",label:"Group B Override",default:0,choices:e.groupB_override},{id:"groupC",type:"dropdown",label:"Group C Override",default:0,choices:e.groupC_override},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the group over ride state"}],callback:({options:t})=>{let n=m.group.override;if(!t.query){let r=0;t.groupA<l&&(r+=t.groupA),t.groupB<l&&(r+=t.groupB),t.groupC<l&&(r+=t.groupC),t.groupA==l&&(r+=e.groupOverride[1]^a),t.groupB==l&&(r+=e.groupOverride[2]^s),t.groupC==l&&(r+=e.groupOverride[3]^o),t.groupA==c&&(r+=e.groupOverride[1]),t.groupB==c&&(r+=e.groupOverride[2]),t.groupC==c&&(r+=e.groupOverride[3]),n+=i+r}e.addCmdtoQueue(n)},learn:t=>{const n=e.groupOverride[1],r=e.groupOverride[2],i=e.groupOverride[3];return{...t.options,groupA:n,groupB:r,groupC:i}},subscribe:()=>{e.addCmdtoQueue(m.group.override)}},group_lasthold:{name:"Group - Last Hold",description:"Set the Last Hold state of the groups",options:[{id:"groupA",type:"dropdown",label:"Group A Last Hold",default:0,choices:e.groupA_lasthold},{id:"groupB",type:"dropdown",label:"Group B Last Hold",default:0,choices:e.groupB_lasthold},{id:"groupC",type:"dropdown",label:"Group C Last Hold",default:0,choices:e.groupC_lasthold},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the group last hold state"}],callback:({options:t})=>{let n=m.group.lastHold;if(!t.query){let r=0;t.groupA<l&&(r+=t.groupA),t.groupB<l&&(r+=t.groupB),t.groupC<l&&(r+=t.groupC),t.groupA==l&&(r+=e.groupLastHold[1]^a),t.groupB==l&&(r+=e.groupLastHold[2]^s),t.groupC==l&&(r+=e.groupLastHold[3]^o),t.groupA==c&&(r+=e.groupLastHold[1]),t.groupB==c&&(r+=e.groupLastHold[2]),t.groupC==c&&(r+=e.groupLastHold[3]),n+=i+r}e.addCmdtoQueue(n)},learn:t=>{const n=e.groupLastHold[1],r=e.groupLastHold[2],i=e.groupLastHold[3];return{...t.options,groupA:n,groupB:r,groupC:i}},subscribe:()=>{e.addCmdtoQueue(m.group.lastHold)}},group_automixdepth:{name:"Group - Automix Depth",description:"Set the automix depth of a group",options:[{id:"group",type:"dropdown",label:"Group",default:"1",choices:e.groupNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer group number"},{id:"useVar",type:"checkbox",label:"Use Variable",default:!1},{id:"depth",type:"number",label:"Depth",default:-15,min:-100,max:0,required:!0,range:!0,step:.1,regex:r.NUMBER,isVisible:e=>!1===e.useVar},{id:"depthVar",type:"textinput",label:"Depth - Variable",default:"",useVariables:!0,regex:r.SOMETHING,isVisible:e=>!0===e.useVar},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the group automix depth"}],callback:async({options:t})=>{let n=m.group.automixDepth,r=parseInt(await e.parseVariablesInString(t.group)),a=Number(await e.parseVariablesInString(t.depthVar));a=a.toFixed(2);let s=0;if(isNaN(r)||r<1||r>p)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;if(t.useVar){if(isNaN(a))return;s=a>0?0:a,s=a<-100?-100:a}else s=t.depth;t.query?n+=i+r:n+=i+r+i+s,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.group));if(isNaN(n)||n<1||n>p)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.groupAutomixDepth[n];return{...t.options,depth:r}},subscribe:async t=>{let n=m.group.automixDepth,r=parseInt(await e.parseVariablesInString(t.options.group));isNaN(r)||r<1||r>p?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},group_automixdepth_rel:{name:"Group - Automix Depth, Relative",description:"Adjust the automix depth of a group",options:[{id:"group",type:"dropdown",label:"Group",default:"1",choices:e.groupNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer group number"},{id:"depth",type:"number",label:"Depth",default:1,min:-6,max:6,required:!0,range:!0,step:.1,regex:r.NUMBER}],callback:async({options:t})=>{let n=m.group.automixDepth,r=parseInt(await e.parseVariablesInString(t.group));if(isNaN(r)||r<1||r>p)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=e.groupAutomixDepth[t.group]+t.depth;a<-100&&(a=-100),a>0&&(a=0);let s=a.toFixed(2);n+=i+r+i+s,e.addCmdtoQueue(n)},subscribe:async t=>{let n=m.group.automixDepth,r=parseInt(await e.parseVariablesInString(t.options.group));isNaN(r)||r<1||r>p?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},group_NOMgainlimit:{name:"Group - NOM Gain Limit",description:"Set the NOM gain limit of a group",options:[{id:"group",type:"dropdown",label:"Group",default:"1",choices:e.groupNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer group number"},{id:"useVar",type:"checkbox",label:"Use Variable",default:!1},{id:"nomgain",type:"number",label:"NOM Gain Limit",default:1,min:1,max:10,required:!0,range:!0,step:.1,regex:r.NUMBER,isVisible:e=>!1===e.useVar},{id:"nomVar",type:"textinput",label:"NOM Gain Limit - Variable",default:"",useVariables:!0,regex:r.SOMETHING,isVisible:e=>!0===e.useVar},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the group NOM gain limit"}],callback:async({options:t})=>{let n=m.group.nomGainLimit,r=Number(await e.parseVariablesInString(t.nomVar));r=r.toFixed(2);let a=0,s=parseInt(await e.parseVariablesInString(t.group));if(isNaN(s)||s<1||s>p)return e.log("warn",`an invalid varible has been passed: ${s}`),!1;if(t.useVar){if(isNaN(r))return;a=r>10?10:r,a=r<1?1:r}else a=t.nomgain;t.query?n+=i+s:n+=i+s+i+a,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.group));if(isNaN(n)||n<1||n>p)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.groupNOMgainlimit[n];return{...t.options,nomgain:r}},subscribe:async t=>{let n=m.group.nomGainLimit,r=parseInt(await e.parseVariablesInString(t.options.group));isNaN(r)||r<1||r>p?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},group_NOMgainlimit_rel:{name:"Group - NOM Gain Limit, Relative",description:"Adjust the NOM gain limit of a group",options:[{id:"group",type:"dropdown",label:"Group",default:"1",choices:e.groupNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer group number"},{id:"nomgain",type:"number",label:"NOM Gain Limit",default:1,min:-6,max:6,required:!0,range:!0,step:.1,regex:r.NUMBER}],callback:async({options:t})=>{let n=m.group.nomGainLimit,r=parseInt(await e.parseVariablesInString(t.group));if(isNaN(r)||r<1||r>p)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=e.groupNOMgainlimit[r]+t.nomgain;a<1&&(a=1),a>10&&(a=10);let s=a.toFixed(2);n+=i+r+i+s,e.addCmdtoQueue(n)},subscribe:async t=>{let n=m.group.nomGainLimit,r=parseInt(await e.parseVariablesInString(t.options.group));isNaN(r)||r<1||r>p?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},group_musicthreshold:{name:"Group - Music System Threshold",description:"Set the Music System Threshold of a group",options:[{id:"group",type:"dropdown",label:"Group",default:1,choices:e.groupNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer group number"},{id:"useVar",type:"checkbox",label:"Use Variable",default:!1},{id:"threshold",type:"number",label:"Music System Threshold",default:-10,min:-100,max:15,required:!0,range:!0,step:.1,regex:r.NUMBER,isVisible:e=>!1===e.useVar},{id:"thresholdVar",type:"textinput",label:"Music System Threshold - Variable",default:"",useVariables:!0,regex:r.SOMETHING,isVisible:e=>!0===e.useVar},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the group music system threshold"}],callback:async({options:t})=>{let n=m.group.musicThreshold,r=Number(await e.parseVariablesInString(t.thresholdVar));r=r.toFixed(2);let a=0,s=parseInt(await e.parseVariablesInString(t.group));if(isNaN(s)||s<1||s>p)return e.log("warn",`an invalid varible has been passed: ${s}`),!1;if(t.useVar){if(isNaN(r))return;a=r>15?15:r,a=r<-100?-100:r}else a=t.threshold;t.query?n+=i+s:n+=i+s+i+a,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.group));if(isNaN(n)||n<1||n>p)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.groupMusicThreshold[n];return{...t.options,threshold:r}},subscribe:async t=>{let n=m.group.musicThreshold,r=parseInt(await e.parseVariablesInString(t.options.group));isNaN(r)||r<1||r>p?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},group_musicthreshold_rel:{name:"Group - Music System Threshold, Relative",description:"Adjust the Music System Threshold of a group",options:[{id:"group",type:"dropdown",label:"Group",default:1,choices:e.groupNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer group number"},{id:"threshold",type:"number",label:"Music System Threshold",default:1,min:-6,max:6,required:!0,range:!0,step:.1,regex:r.NUMBER}],callback:async({options:t})=>{let n=m.group.musicThreshold,r=parseInt(await e.parseVariablesInString(t.group));if(isNaN(r)||r<1||r>p)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=e.groupMusicThreshold[r]+t.threshold;a<-150&&(a=-150),a>20&&(a=20);let s=a.toFixed(2);n+=i+r+i+s,e.addCmdtoQueue(n)},subscribe:async t=>{let n=m.group.musicThreshold,r=parseInt(await e.parseVariablesInString(t.options.group));isNaN(r)||r<1||r>p?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},group_musicinput:{name:"Group - Music System Threshold Input",description:"Set the music system Threshold input of a group",options:[{id:"group",type:"dropdown",label:"Group",default:1,choices:e.groupNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer group number"},{id:"input",type:"dropdown",label:"Music System Threshold Input",default:1,choices:e.musicInputs,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer input number 1 - 86"},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the group music system threshold input"}],callback:async({options:t})=>{let n=m.group.musicInput,r=parseInt(await e.parseVariablesInString(t.group));if(isNaN(r)||r<1||r>p)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=parseInt(await e.parseVariablesInString(t.input));if(isNaN(a)||a<1||a>86)return e.log("warn",`an invalid varible has been passed: ${a}`),!1;t.query?n+=i+r:n+=i+r+i+a,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.group));if(isNaN(n)||n<1||n>p)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.groupMusicInput[n];return{...t.options,input:r}},subscribe:async t=>{let n=m.group.musicInput,r=parseInt(await e.parseVariablesInString(t.options.group));isNaN(r)||r<1||r>p?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},matrix_mute:{name:"Matrix - Bus Mute",description:"Mute a Matrix Bus",options:[{id:"matrix",type:"dropdown",label:"Matrix",default:1,choices:e.matrixNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer matrix number"},{id:"mute",type:"dropdown",label:"Mute",default:0,choices:[{id:0,label:"On"},{id:1,label:"Mute"},{id:l,label:"Toggle"}]},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.matrix.mute,r=parseInt(await e.parseVariablesInString(t.matrix));if(isNaN(r)||r<1||r>u)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=1^await e.matrixMute[r];t.query?n+=i+r:t.mute==l?n+=i+r+i+a:n+=i+r+i+t.mute,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.matrix));if(isNaN(n)||n<1||n>u)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.matrixMute[n];return{...t.options,mute:r}},subscribe:async t=>{let n=m.matrix.mute,r=parseInt(await e.parseVariablesInString(t.options.matrix));isNaN(r)||r<1||r>u?e.log("warn",`an invalid varible has been passed: ${u}`):e.addCmdtoQueue(n+i+r)}},matrix_polarity:{name:"Matrix - Bus Polarity",description:"Change polarity of a Matrix Bus",options:[{id:"matrix",type:"dropdown",label:"Matrix",default:1,choices:e.matrixNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer matrix number"},{id:"polarity",type:"dropdown",label:"Polarity",default:0,choices:[{id:0,label:"Normal"},{id:1,label:"Reversed"},{id:l,label:"Toggle"}]},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:async({options:t})=>{let n=m.matrix.polarity,r=parseInt(await e.parseVariablesInString(t.matrix));if(isNaN(r)||r<1||r>u)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=1^await e.matrixPolarity[r];t.query?n+=i+r:t.polarity==l?n+=i+r+i+a:n+=i+r+i+t.polarity,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.matrix));if(isNaN(n)||n<1||n>u)return void e.log("warn",`an invalid varible has been passed: ${u}`);const r=e.matrixPolarity[n];return{...t.options,polarity:r}},subscribe:async t=>{let n=m.matrix.polarity,r=parseInt(await e.parseVariablesInString(t.options.matrix));isNaN(r)||r<1||r>u?e.log("warn",`an invalid varible has been passed: ${u}`):e.addCmdtoQueue(n+i+r)}},matrix_gain:{name:"Matrix - Gain",description:"Set the gain of a Matrix Bus",options:[{id:"matrix",type:"dropdown",label:"Matrix",default:1,choices:e.matrixNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer matrix number"},{id:"useVar",type:"checkbox",label:"Use Variable",default:!1},{id:"gain",type:"number",label:"Gain",default:0,min:-25,max:15,required:!0,range:!0,step:.5,regex:r.NUMBER,isVisible:e=>!1===e.useVar},{id:"gainVar",type:"textinput",label:"Gain - Variable",default:"",useVariables:!0,regex:r.SOMETHING,isVisible:e=>!0===e.useVar},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the current matrix output gain"}],callback:async({options:t})=>{let n=m.matrix.gain,r=Number(await e.parseVariablesInString(t.gainVar));r=r.toFixed(2);let a=0,s=parseInt(await e.parseVariablesInString(t.matrix));if(isNaN(s)||s<1||s>u)return e.log("warn",`an invalid varible has been passed: ${s}`),!1;if(t.useVar){if(isNaN(r))return;a=r>15?15:r,a=r<-25?-25:r}else a=t.gain;t.query?n+=i+s:n+=i+s+i+a,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.matrix));if(isNaN(n)||n<1||n>u)return void e.log("warn",`an invalid varible has been passed: ${u}`);const r=e.matrixGain[n];return{...t.options,gain:r}},subscribe:async t=>{let n=m.matrix.gain,r=parseInt(await e.parseVariablesInString(t.options.matrix));isNaN(r)||r<1||r>u?e.log("warn",`an invalid varible has been passed: ${u}`):e.addCmdtoQueue(n+i+r)}},matrix_gain_rel:{name:"Matrix - Gain, Relative",description:"Adjust the gain of a Matrix Bus",options:[{id:"matrix",type:"dropdown",label:"Matrix",default:1,choices:e.matrixNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer matrix number"},{id:"gain",type:"number",label:"Gain",default:1,min:-6,max:6,required:!0,range:!0,step:.5,regex:r.NUMBER}],callback:async({options:t})=>{let n=m.matrix.gain,r=parseInt(await e.parseVariablesInString(t.matrix));if(isNaN(r)||r<1||r>u)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=e.matrixGain[r]+t.gain;a<-25&&(a=-25),a>15&&(a=15);let s=a.toFixed(2);n+=i+r+i+s,e.addCmdtoQueue(n)},subscribe:async t=>{let n=m.matrix.gain,r=parseInt(await e.parseVariablesInString(t.options.matrix));isNaN(r)||r<1||r>u?e.log("warn",`an invalid varible has been passed: ${u}`):e.addCmdtoQueue(n+i+r)}},matrix_output:{name:"Matrix - Output",description:"Set the output channel of a Matrix Bus",options:[{id:"matrix",type:"dropdown",label:"Matrix",default:1,choices:e.matrixNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer matrix number"},{id:"output",type:"dropdown",label:"Output",default:0,choices:e.matrixDestinations,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer output number 0 - 80"},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the matrix output channel"}],callback:async({options:t})=>{let n=m.matrix.output,r=parseInt(await e.parseVariablesInString(t.matrix));if(isNaN(r)||r<1||r>u)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=parseInt(await e.parseVariablesInString(t.output));if(isNaN(a)||a<0||a>h+16)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;t.query?n+=i+r:n+=i+r+i+a,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.matrix));if(isNaN(n)||n<1||n>u)return void e.log("warn",`an invalid varible has been passed: ${n}`);const r=e.matrixOutput[n];return{...t.options,output:r}},subscribe:async t=>{let n=m.matrix.output,r=parseInt(await e.parseVariablesInString(t.options.matrix));isNaN(r)||r<1||r>u?e.log("warn",`an invalid varible has been passed: ${r}`):e.addCmdtoQueue(n+i+r)}},matrix_crosspoint:{name:"Matrix - Crosspoint",description:"Set the a crosspoint in the matrix",options:[{id:"matrix",type:"dropdown",label:"Matrix",default:1,choices:e.matrixNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer matrix number"},{id:"channel",type:"dropdown",label:"Input Channel",default:1,choices:e.matrixSources,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"useVar",type:"checkbox",label:"Use Variable",default:!1},{id:"gain",type:"number",label:"Crosspoint Gain",default:-96,min:-96,max:0,required:!0,range:!0,step:.5,regex:r.NUMBER,isVisible:e=>!1===e.useVar},{id:"gainVar",type:"textinput",label:"Gain - Variable",default:"",useVariables:!0,regex:r.SOMETHING,isVisible:e=>!0===e.useVar},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the matrix crosspoint gain"}],callback:async({options:t})=>{let n=m.matrix.crosspoint,r=Number(await e.parseVariablesInString(t.gainVar));r=r.toFixed(2);let a=0,s=parseInt(await e.parseVariablesInString(t.matrix));if(isNaN(s)||s<1||s>u)return e.log("warn",`an invalid varible has been passed: ${s}`),!1;let o=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(o)||o<1||o>d)return e.log("warn",`an invalid varible has been passed: ${o}`),!1;if(t.useVar){if(isNaN(r))return;a=r>0?0:r,a=r<-96?-96:r}else a=t.gain;t.query?n+=i+s+i+o:n+=i+s+i+o+i+a,e.addCmdtoQueue(n)},learn:async t=>{let n=parseInt(await e.parseVariablesInString(t.options.matrix));if(isNaN(n)||n<1||n>u)return void e.log("warn",`an invalid varible has been passed: ${u}`);let r=parseInt(await e.parseVariablesInString(t.options.channel));if(isNaN(r)||r<1||r>d)return void e.log("warn",`an invalid varible has been passed: ${r}`);const i=e.matrixXpoint[n][r];return{...t.options,gain:i}},subscribe:async t=>{let n=m.matrix.crosspoint,r=parseInt(await e.parseVariablesInString(t.options.matrix));if(isNaN(r)||r<1||r>u)return void e.log("warn",`an invalid varible has been passed: ${u}`);let a=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(a)||a<1||a>d?e.log("warn",`an invalid varible has been passed: ${a}`):e.addCmdtoQueue(n+i+r+i+a)}},matrix_crosspoint_rel:{name:"Matrix - Crosspoint, Relative",description:"Adjust a crosspoint in the matrix",options:[{id:"matrix",type:"dropdown",label:"Matrix",default:1,choices:e.matrixNames,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer matrix number"},{id:"channel",type:"dropdown",label:"Input Channel",default:1,choices:e.matrixSources,useVariables:!0,allowCustom:!0,tooltip:"Varible must return an integer channel number"},{id:"gain",type:"number",label:"Crosspoint Gain",default:1,min:-6,max:6,required:!0,range:!0,step:.5,regex:r.NUMBER}],callback:async({options:t})=>{let n=m.matrix.crosspoint,r=parseInt(await e.parseVariablesInString(t.matrix));if(isNaN(r)||r<1||r>u)return e.log("warn",`an invalid varible has been passed: ${r}`),!1;let a=parseInt(await e.parseVariablesInString(t.channel));if(isNaN(a)||a<1||a>d)return e.log("warn",`an invalid varible has been passed: ${a}`),!1;let s=e.matrixXpoint[t.matrix][t.channel]+t.gain;s<-96.5&&(s=-96.5),s>0&&(s=0);let o=s.toFixed(2);n+=i+r+i+a+i+o,e.addCmdtoQueue(n)},subscribe:async t=>{let n=m.matrix.crosspoint,r=parseInt(await e.parseVariablesInString(t.options.matrix));if(isNaN(r)||r<1||r>u)return void e.log("warn",`an invalid varible has been passed: ${u}`);let a=parseInt(await e.parseVariablesInString(t.options.channel));isNaN(a)||a<1||a>d?e.log("warn",`an invalid varible has been passed: ${a}`):e.addCmdtoQueue(n+i+r+i+a)}},sc_count:{name:"Scene - Count",description:"Query number of saved scenes",options:[{id:"info",type:"static-text",label:"",value:"Returns number of scenes saved in unit"}],callback:()=>{e.addCmdtoQueue(m.scene.count)}},sc_active:{name:"Scene - Active",description:"Query the active scene",options:[{id:"info",type:"static-text",label:"",value:"Returns name of active scene"}],callback:()=>{e.addCmdtoQueue(m.scene.active)}},sc_recall:{name:"Scene - Recall",description:"Recall a saved scene",options:[{id:"name",type:"dropdown",label:"Scene Name",choices:e.sceneList,default:"Factory Defaults",required:!0,Regex:r.SOMETHING,tooltip:"Max Length: 15 char",useVariables:!0,allowCustom:!0}],callback:async({options:t})=>{let n=m.scene.recall,r=await e.regexSafeString(await e.parseVariablesInString(t.name));null!=r&&r.length>=1?(n+=i+r,e.addCmdtoQueue(n)):e.log("warn","Not a valid scene name")}},sc_save:{name:"Scene - Save",description:"Save a scene",options:[{id:"name",type:"dropdown",label:"Scene Name",choices:e.sceneList,default:"New Scene",required:!0,Regex:r.SOMETHING,tooltip:"Max Length: 15 char",useVariables:!0,allowCustom:!0}],callback:async({options:t})=>{let n=m.scene.save,r=await e.regexSafeString(await e.parseVariablesInString(t.name));null!=r&&r.length>=1?(n+=i+r,e.addCmdtoQueue(n)):e.log("warn","Not a valid scene name")}},sc_newsave:{name:"Scene - Save New",description:"Save a new scene",options:[{id:"name",type:"static-text",label:"Scene Name",value:"A default scene name will be written"}],callback:async()=>{e.addCmdtoQueue(m.scene.saveNew)}},sc_rename:{name:"Scene - Rename",description:"Rename an existing scene",options:[{id:"currentname",type:"dropdown",label:"Current Name",default:"",required:!0,Regex:r.SOMETHING,useVariables:!0,tooltip:"Max Length: 15 char",choices:e.sceneList,allowCustom:!0},{id:"newname",type:"textinput",label:"New Name",default:"New Scene Name",required:!0,Regex:r.SOMETHING,useVariables:!0,tooltip:"Max Length: 15 char"}],callback:async({options:t})=>{let n=m.scene.rename,r=await e.regexSafeString(await e.parseVariablesInString(t.currentname)),a=await e.regexSafeString(await e.parseVariablesInString(t.newname));null!=r&&r.length>=1&&null!=a&&a.length>=1?(n+=i+r+i+a,e.addCmdtoQueue(n)):e.log("warn","Not a valid scene name")}},sc_delete:{name:"Scene - Delete",description:"Delete an existing scene",options:[{id:"name",type:"dropdown",label:"Scene Name",choices:e.sceneList,default:"",required:!0,Regex:r.SOMETHING,useVariables:!0,allowCustom:!0,tooltip:'Max Length: 15 char. "," ";" Forbidden.'}],callback:async({options:t})=>{let n=m.scene.delete,r=await e.regexSafeString(await e.parseVariablesInString(t.name));null!=r&&r.length>=1?(n+=i+r,e.addCmdtoQueue(n)):e.log("warn","Not a valid scene name")}},recall_default:{name:"Recall Defaults",description:"Recall default channel or matrix settings",options:[{id:"mode",type:"dropdown",label:"Channel or Matrix",default:"FP",choices:e.system_defaults}],callback:({options:t})=>{e.addCmdtoQueue(t.mode)}},system_subscribe:{name:"System - Subscribe Unsolicited",description:"Subscribe to unsolicited paramter changes",options:[{id:"subscribe",type:"dropdown",label:"Subscribe",default:1,choices:e.system_subscribe},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:({options:t})=>{let n=m.system.subscribe;t.query||(n+=i+t.subscribe),e.addCmdtoQueue(n)},subscribe:()=>{e.addCmdtoQueue(m.system.subscribe)}},system_linkgroup:{name:"System - Link Group",description:"Set the link group",options:[{id:"linkgroup",type:"number",label:"Link Group Address",default:1,min:0,max:254,required:!0,range:!0,step:1,regex:r.NUMBER,tooltip:"Link group parameters are multicast to 237.1.4.<addr>"},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll current link group"}],callback:({options:t})=>{let n=m.system.linkGroup;t.query||(n+=i+t.linkgroup),e.addCmdtoQueue(n)},subscribe:()=>{e.addCmdtoQueue(m.system.linkGroup)}},system_clocksource:{name:"System - Clock Source",description:"Set the clock source",options:[{id:"clock",type:"dropdown",label:"Clock Source",default:0,choices:e.clockSources},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll the current name"}],callback:({options:t})=>{let n=m.system.clock;t.query||(n+=i+t.clock),e.addCmdtoQueue(n)},subscribe:()=>{e.addCmdtoQueue(m.system.clock)}},system_ADATmirror:{name:"System - ADAT Mirror",description:"Set the number of input channels echoed to ADAT outputs when in Dante mode",options:[{id:"mirror",type:"dropdown",label:"ADAT mirror",default:1,choices:e.system_adatMirror},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:({options:t})=>{let n=m.system.adatMirror;t.query||(n+=i+t.mirror),e.addCmdtoQueue(n)},subscribe:()=>{e.addCmdtoQueue(m.system.adatMirror)}},system_automixchannels:{name:"System - Automix Channels",description:"Set the number of dugan automix channels",options:[{id:"channels",type:"number",label:"Automix Channels",default:e.config.channels,min:e.MinChannelCount,max:e.MaxChannelCount,required:!0,range:!0,step:1,regex:r.NUMBER,tooltip:"Automix Channel Count"},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll current configured automix channels"}],callback:({options:t})=>{let n=m.system.automixChannels;t.query||(n+=i+t.channels),e.addCmdtoQueue(n)},subscribe:()=>{e.addCmdtoQueue(m.system.automixChannels)}},system_channeloffset:{name:"System - Automix Channel Offset",description:"Set the input channel offset",options:[{id:"offset",type:"dropdown",label:"Input Offset",choices:e.offsetChannelList,tooltip:"Input channel mapped to Automix Channel 1"},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll current configured channel offset"}],callback:({options:t})=>{let n=m.system.channelOffset;t.query||(n+=i+t.offset),e.addCmdtoQueue(n)},subscribe:()=>{e.addCmdtoQueue(m.system.channelOffset)}},system_blinkmode:{name:"System - Blink Mode",description:"Set the blink mode",options:[{id:"blink",type:"dropdown",label:"Blink Mode",default:1,choices:e.system_blinkmode},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:({options:t})=>{let n=m.system.blinkMode;t.query||(n+=i+t.blink),e.addCmdtoQueue(n)},subscribe:()=>{e.addCmdtoQueue(m.system.blinkMode)}},system_DHCP:{name:"System - Network DHCP",description:"Set DHCP",options:[{id:"dhcp",type:"dropdown",label:"DHCP. Requires reboot to take effect",default:1,choices:e.system_dhcp},{id:"query",type:"checkbox",label:"Query",default:!1}],callback:({options:t})=>{let n=m.system.dhcp;t.query||(n+=i+t.dhcp),e.addCmdtoQueue(n)},subscribe:()=>{e.addCmdtoQueue(m.system.dhcp)}},query_system:{name:"Query - System",description:"Query system state and write to logs",options:[{id:"mode",type:"dropdown",label:"Mode",default:m.system.config,choices:e.system_query}],callback:({options:t})=>{e.addCmdtoQueue(t.mode)}},system_name:{name:"System - Name",description:"Set unit name",options:[{id:"name",type:"textinput",label:"Unit Name",default:"Dugan Model N",required:!0,Regex:r.SOMETHING,useVariables:!0,tooltip:"Max Length: 15 char"},{id:"query",type:"checkbox",label:"Query",default:!1,tooltip:"Query will poll current configured unit name"}],callback:async({options:t})=>{let n=m.system.name;if(!t.query){let r=await e.regexSafeString(await e.parseVariablesInString(t.name));if(!(null!=r&&r.length>=1))return e.log("warn","Not a valid name"),!1;n+=i+r}e.addCmdtoQueue(n)}},system_network:{name:"System - Network",description:"Set unit IP, Netmask or Gateway. Requires reboot to take effect",options:[{id:"mode",type:"dropdown",label:"Mode",default:m.system.ip,choices:e.system_network},{id:"IP",type:"textinput",label:"IP Address",default:"192.168.1.1",required:!0,regex:r.IP}],callback:({options:t})=>{let n=t.mode;if(!t.query){let r=t.IP.split("."),a=[];for(let t=0;t<r.length;t++)if(a[t]=parseInt(r[t]),isNaN(a[t])||a[t]<0||a[t]>255)return e.log("warn",`Not a valid IP Address, byte: ${t+1} Value: ${a[t]}`),!1;if(4!=a.length)return e.log("warn","Not a valid IP Address, unexpected length"),!1;n+=i+a[0]+i+a[1]+i+a[2]+i+a[3]}e.addCmdtoQueue(n)}},query_meters:{name:"Metering",description:"Get metering data",options:[{id:"mode",type:"dropdown",label:"Meter Type",default:m.metering.channelStatus,choices:e.query_meters}],callback:({options:t})=>{e.addCmdtoQueue(t.mode)}},query_bulk_config:{name:"Query - Bulk Config",description:"Get all channel parameters or matrix cross points",options:[{id:"mode",type:"dropdown",label:"Channels or Matrix",default:m.channel.bulkParams,choices:e.system_bulkconfig}],callback:({options:t})=>{e.addCmdtoQueue(t.mode)}},query_namelist:{name:"Query - Name List",description:"Query a list of channel or scene names",options:[{id:"mode",type:"dropdown",label:"Channel or Scenes",default:m.channel.nameList,choices:e.query_namelistmode},{id:"first",type:"number",label:"First name to recall",default:1,min:1,max:e.config.channels,step:1,range:!0},{id:"count",type:"number",label:"Number of names to recall",default:e.config.channels,min:1,max:e.MaxChannelCount,step:1,range:!0}],callback:({options:t})=>{let n=parseInt(t.first),r=parseInt(t.count);e.addCmdtoQueue(t.mode+i+n+i+r)}}})}},888:(e,t,n)=>{const{grpAval:r,grpBval:i,grpCval:a,toggle:s,noChange:o,duganModels:l,cmd:c}=n(1586);e.exports={channel_modes:[{id:0,label:"Manual"},{id:1,label:"Auto"},{id:2,label:"Mute"}],channel_bypass:[{id:0,label:"Normal"},{id:1,label:"Bypass"},{id:s,label:"Toggle"}],channel_override:[{id:0,label:"Normal"},{id:1,label:"Override"},{id:s,label:"Toggle"}],channel_offOnToggle:[{id:0,label:"Off"},{id:1,label:"On"},{id:s,label:"Toggle"}],groupA_mute:[{id:0,label:"On"},{id:r,label:"Mute"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupB_mute:[{id:0,label:"On"},{id:i,label:"Mute"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupC_mute:[{id:0,label:"On"},{id:a,label:"Mute"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupA_preset:[{id:0,label:"Preset Off"},{id:r,label:"Preset On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupB_preset:[{id:0,label:"Preset Off"},{id:i,label:"Preset On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupC_preset:[{id:0,label:"Preset Off"},{id:a,label:"Preset On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupA_override:[{id:0,label:"Normal"},{id:r,label:"Override On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupB_override:[{id:0,label:"Normal"},{id:i,label:"Override On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupC_override:[{id:0,label:"Normal"},{id:a,label:"Override On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupA_lasthold:[{id:0,label:"Last Hold Off"},{id:r,label:"Last Hold On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupB_lasthold:[{id:0,label:"Last Hold Off"},{id:i,label:"Last Hold On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],groupC_lasthold:[{id:0,label:"Last Hold Off"},{id:a,label:"Last Hold On"},{id:s,label:"Toggle"},{id:o,label:"No Change"}],system_defaults:[{id:c.scene.defaults,label:"Channel Defaults"},{id:c.matrix.defaults,label:"Matrix Defaults"}],system_subscribe:[{id:0,label:"Off"},{id:1,label:"On"}],system_adatMirror:[{id:1,label:"8 Channels"},{id:2,label:"16 Channels"}],system_blinkmode:[{id:0,label:"Off"},{id:1,label:"On"}],system_dhcp:[{id:0,label:"Off"},{id:1,label:"On"}],system_query:[{id:c.system.config,label:"System Configuration"},{id:c.system.firmware,label:"Firmware Versions"},{id:c.system.connections,label:"Client Connections"},{id:c.system.resourceUseage,label:"Resource Useage"},{id:c.system.switchHeadroom,label:"Switch Headroom"},{id:c.system.sampleRate,label:"Sample Rate"},{id:c.system.master,label:"Master"}],system_network:[{id:c.system.ip,label:"IP Address"},{id:c.system.netmask,label:"Subnet Mask"},{id:c.system.gateway,label:"Gateway"}],query_meters:[{id:c.metering.channelStatus,label:"Channel Status"},{id:c.metering.automixGain,label:"Automix Gains"},{id:c.metering.signalPresense,label:"Signal Presence"},{id:c.metering.inputPeaks,label:"Input Peaks"},{id:c.metering.outputPeaks,label:"Output Peaks"},{id:c.metering.musicRef,label:"Music Reference Peaks"},{id:c.metering.nomGain,label:"NOM Gain Limits"},{id:c.metering.matrixOutput,label:"Matrix Output Meters"}],query_namelistmode:[{id:c.channel.nameList,label:"Channels"},{id:c.scene.nameList,label:"Scenes"}],system_bulkconfig:[{id:c.channel.bulkParams,label:"Channels Parameters"},{id:c.matrix.bulkParams,label:"Matrix Crosspoints"}],config_duganModels:[{id:11,label:l[11]},{id:12,label:l[12]}],config_messagingrate:[{id:0,label:"Fast"},{id:1,label:"Medium"},{id:2,label:"Slow"},{id:3,label:"Very Slow"}],config_meterInterval:[{id:0,label:"Off"},{id:250,label:"250 ms"},{id:500,label:"500 ms"},{id:1e3,label:"1 Seconds"},{id:2e3,label:"2 Seconds"},{id:4e3,label:"4 Seconds"}],config_subscribe:[{id:0,label:"Off"},{id:1,label:"On"}]}},8384:(e,t,n)=>{const{Regex:r}=n(6278),{duganChannels:i,automixChannels:a,cmd:s,paramSep:o}=n(1586);e.exports={async configUpdated(e){let t=this.config;this.config=e,1==this.config.channels&&(this.config.channels=i[this.config.model]),t.keepAlive!=this.config.keepAlive&&(clearTimeout(this.keepAliveTimer),this.config.keepAlive>0&&(this.keepAliveTimer=setTimeout((()=>{this.pollStatus()}),1e3*this.config.keepAlive))),t.model==this.config.model&&t.channels==this.config.channels||(this.initVariables(),this.updateActions(),this.updateFeedbacks(),this.updateVariableDefinitions(),this.subscribeFeedbacks()),t.host==this.config.host&&t.port==this.config.port&&t.udp==this.config.udp||(this.udp&&(clearTimeout(this.keepAliveTimer),this.udp.destroy(),delete this.udp),this.socket&&(this.log("debug","deleting socket"),clearTimeout(this.keepAliveTimer),this.sendCommand(s.system.endSession),this.socket.destroy(),delete this.socket),this.config.udp||(this.initTCP(),this.initVariables(),this.updateActions(),this.updateFeedbacks(),this.updateVariableDefinitions())),this.addCmdtoQueue(s.system.subscribe+o+this.config.subscription),clearTimeout(this.meterTimer),this.log("info",`meter rate: ${this.config.meterRate}ms`),this.config.meterRate>=100&&(this.meterTimer=setTimeout((()=>{this.checkMeters()}),this.config.meterRate))},getConfigFields(){return[{type:"textinput",id:"host",label:"Target Host",width:8,regex:r.HOSTNAME},{type:"textinput",id:"port",label:"Target Port",default:23,width:4,regex:r.PORT,tooltip:"Port 23 or 9776"},{type:"checkbox",id:"udp",label:"Use UDP",default:!1,width:4,tooltip:"Connect via UDP instead of TCP",isVisible:()=>!1},{type:"number",id:"keepAlive",label:"Poll Interval",default:60,width:2,min:0,max:180,regex:r.NUMBER,tooltip:"Seconds, set to 0 to turn off"},{type:"dropdown",id:"meterRate",label:"Meter rate",choices:this.config_meterInterval,default:1e3,width:4},{type:"dropdown",id:"model",label:"Dugan Model",choices:this.config_duganModels,default:11,width:4},{type:"dropdown",id:"channels",label:"Automix Channels",choices:a,default:1,width:4},{type:"dropdown",id:"rate",label:"Messaging rate",choices:this.config_messagingrate,default:1,width:4},{type:"dropdown",id:"subscription",label:"Unsocilicted Message Subscription",choices:this.config_subscribe,default:1,width:4,isVisible:()=>!0,tooltip:"This will be forced on if using feedbacks"},{type:"number",id:"isTalkingThreshold",label:"Talking Threshold",default:-3,width:2,min:-24,max:0,range:!0,step:.1,regex:r.NUMBER,tooltip:"Automix gain threshold for Is Talking function"}]}}},1586:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EOM:()=>v,GroupCount:()=>d,MatrixCount:()=>f,MatrixSize:()=>y,MaxChannelCount:()=>c,MinChannelCount:()=>u,SOM:()=>w,adatMirror:()=>O,automixChannels:()=>V,clockSources:()=>P,cmd:()=>A,cmdOnConnect:()=>T,cmdOnPollInterval:()=>j,cmdSep:()=>N,duganChannels:()=>l,duganModels:()=>o,errRange:()=>S,errSyntax1:()=>x,errSyntax2:()=>I,grpAval:()=>p,grpBval:()=>h,grpCval:()=>m,meterCommands:()=>$,msgDelay:()=>a,noChange:()=>g,paramSep:()=>k,regexpCmd:()=>r,regexpSafeString:()=>i,sampleRate:()=>M,timeOutValue:()=>s,toggle:()=>b,welcomeMessageM:()=>C,welcomeMessageN:()=>_});const r=new RegExp(/^([*])([a-zA-Z]{0,3})([,])/g),i=new RegExp(/^[^,*;:]{1,16}/g),a=[55,60,70,100],s=500,o=["0","1","2","3","Model-E1","Dugan-MY16","Model-E1A","Model-E2","Model-E3","Model-VN","10","Model-M","Model-N"],l=[8,8,8,8,8,16,8,28,32,16,8,64,64],c=64,u=8,d=3,p=1,h=2,m=4,b=10,g=11,f=6,y=144,v="\r\n",w="*",k=",",N=";",x="Error: syntax",I="ERROR: syntax",S="Error: Channel number out of range",C="Welcome to Dugan Model M Server.",_="Welcome to Dugan Model N Server.",M=["48kHz","96kHz"],O=["0 Channels","8 Channels","16 Channels"],P=["Dante/Madi","Word Clock","Internal","ADAT"];let V=[];V.push({id:1,label:"Unit Default"});for(let e=u;e<=c;e++)V.push({id:e,label:e+" Automix Channels"});const A={channel:{mode:"CM",preset:"CP",bypass:"BP",override:"CO",weight:"CW",music:"MR",nom:"NE",group:"GA",name:"CN",nameList:"CNS",bulkParams:"GP"},group:{mute:"SM",preset:"SP",override:"SO",lastHold:"LH",automixDepth:"ME",automixDepthAlt:"AD",nomGainLimit:"NL",musicThreshold:"MT",musicInput:"MC"},matrix:{mute:"MXM",polarity:"MXP",gain:"MXV",output:"MXO",crosspoint:"OM",defaults:"RM",bulkParams:"GM"},metering:{channelStatus:"GS",automixGain:"GSA",signalClip:"GSC",signalPresense:"GSS",signalPresenseAlt:"GSP",inputPeaks:"GSI",outputPeaks:"GSO",musicRef:"GSM",nomGain:"GSN",matrixOutput:"GSX"},scene:{count:"SNC",active:"SNA",recall:"SNR",save:"SNS",saveNew:"SNN",rename:"SNE",delete:"SND",defaults:"FP",nameList:"SNL"},system:{subscribe:"SU",linkGroup:"LG",clock:"CS",adatMirror:"AM",automixChannels:"CFN",channelOffset:"CFS",blinkMode:"BM",dhcp:"DH",ip:"IP",netmask:"NM",gateway:"GW",name:"NA",config:"SC",firmware:"VE",connections:"CC",resourceUseage:"HW",switchHeadroom:"HR",sampleRate:"SF",master:"MM",endSession:"QUIT",ping:"PN",pd:"PD"}},$=[A.metering.channelStatus],T=[A.system.config,A.system.firmware,A.system.blinkMode,A.system.resourceUseage,A.system.switchHeadroom,A.scene.count,A.scene.active,A.system.linkGroup,A.system.clock,A.system.adatMirror,A.system.connections,A.system.sampleRate,A.system.master,A.system.channelOffset,A.system.automixChannels],j=[A.scene.active,A.scene.count]},8404:(e,t,n)=>{const{combineRgb:r,Regex:i}=n(6278),{paramSep:a,cmd:s}=n(1586);e.exports=async function(e){e.setFeedbackDefinitions({sceneChanged:{name:"Scene, Has Changed",type:"boolean",label:"Scene, Has Changed",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[],callback:()=>1==e.sceneChanged,subscribe:()=>{e.addCmdtoQueue(s.scene.active),e.checkSubscriptionLevel(1)}},matrixLevel:{name:"Matrix Output Level",type:"boolean",label:"Matrix Output Level",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Matrix",id:"matrix",default:1,choices:e.matrixNames},{type:"number",label:"Less than or equal to",id:"lessThan",default:0,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER},{type:"number",label:"Greater than or equal to",id:"greaterThan",default:-12,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER}],callback:({options:t})=>e.matrixOutputPeak[t.matrix]<=t.lessThan&&e.matrixOutputPeak[t.matrix]>=t.greaterThan,subscribe:()=>{11!=e.config.model&&12!=e.config.model&&e.addCmdtoQueue(s.metering.matrixOutput),e.checkSubscriptionLevel(1)}},matrixMuted:{name:"Matrix Output Mute",type:"boolean",label:"Matrix Output Mute",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Matrix",id:"matrix",default:1,choices:e.matrixNames}],callback:({options:t})=>1==e.matrixMute[t.matrix],subscribe:({options:t})=>{e.addCmdtoQueue(s.matrix.mute+a+t.matrix),e.checkSubscriptionLevel(1)}},matrixPolarity:{name:"Matrix Output Polarity",type:"boolean",label:"Matrix Output Polarity",defaultStyle:{bgcolor:r(255,255,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Matrix",id:"matrix",default:1,choices:e.matrixNames}],callback:({options:t})=>1==e.matrixPolarity[t.matrix],subscribe:({options:t})=>{e.addCmdtoQueue(s.matrix.polarity+a+t.matrix),e.checkSubscriptionLevel(1)}},channelMode:{name:"Channel Mode",type:"boolean",label:"Channel Mode",defaultStyle:{bgcolor:r(0,255,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames},{id:"mode",type:"dropdown",label:"Mode",default:1,choices:e.channel_modes}],callback:({options:t})=>e.channelsMode[t.channel]==t.mode,subscribe:({options:t})=>{e.addCmdtoQueue(s.channel.mode+a+t.channel),e.checkSubscriptionLevel(1)}},channelPreset:{name:"Channel Preset",type:"boolean",label:"Channel Preset",defaultStyle:{bgcolor:r(0,255,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames},{id:"preset",type:"dropdown",label:"Preset",default:1,choices:e.channel_modes}],callback:({options:t})=>e.channelsPreset[t.channel]==t.preset,subscribe:({options:t})=>{e.addCmdtoQueue(s.channel.preset+a+t.channel),e.checkSubscriptionLevel(1)}},channelBypass:{name:"Channel Bypass",type:"boolean",label:"Channel Bypass",defaultStyle:{bgcolor:r(255,255,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames}],callback:({options:t})=>1==e.channelsBypass[t.channel],subscribe:({options:t})=>{e.addCmdtoQueue(s.channel.bypass+a+t.channel),e.checkSubscriptionLevel(1)}},channelOverride:{name:"Channel Override",type:"boolean",label:"Channel Override",defaultStyle:{bgcolor:r(255,255,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames}],callback:({options:t})=>1==e.channelsOverride[t.channel],subscribe:({options:t})=>{e.addCmdtoQueue(s.channel.override+a+t.channel),e.checkSubscriptionLevel(1)}},channelMusic:{name:"Channel Music Mode",type:"boolean",label:"Channel Music Mode",defaultStyle:{bgcolor:r(255,255,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames}],callback:({options:t})=>1==e.channelsMusic[t.channel],subscribe:({options:t})=>{e.addCmdtoQueue(s.channel.music+a+t.channel),e.checkSubscriptionLevel(1)}},channelNOM:{name:"Channel NOM Mode",type:"boolean",label:"Channel NOM Mode",defaultStyle:{bgcolor:r(255,255,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames}],callback:({options:t})=>1==e.channelsNom[t.channel],subscribe:({options:t})=>{e.addCmdtoQueue(s.channel.nom+a+t.channel),e.checkSubscriptionLevel(1)}},channelGroupAssign:{name:"Channel Group Assignment",type:"boolean",label:"Channel Group Assignment",defaultStyle:{bgcolor:r(255,255,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames},{type:"dropdown",label:"Group",id:"group",default:1,choices:e.groupNames}],callback:({options:t})=>e.channelsGroupAssign[t.channel]==t.group,subscribe:({options:t})=>{e.addCmdtoQueue(s.channel.group+a+t.channel),e.checkSubscriptionLevel(1)}},channelClip:{name:"Channel Clip",type:"boolean",label:"Channel Clip",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames}],callback:({options:t})=>e.channelsClip[t.channel],subscribe:()=>{11!=e.config.model&&12!=e.config.model&&e.addCmdtoQueue(s.metering.signalClip),e.checkSubscriptionLevel(2)}},channelPresence:{name:"Channel Signal Presence",type:"boolean",label:"Channel Signal Presence",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"channel",id:"channel",default:1,choices:e.channelNames}],callback:({options:t})=>e.channelsPresence[t.channel],subscribe:()=>{11!=e.config.model&&12!=e.config.model&&e.addCmdtoQueue(s.metering.signalPresense),e.checkSubscriptionLevel(1)}},channelInputPeak:{name:"Channel Input Peak Meter",type:"boolean",label:"Channel Input Peak Meter",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames},{type:"number",label:"Less than or equal to",id:"lessThan",default:0,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER},{type:"number",label:"Greater than or equal to",id:"greaterThan",default:-12,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER}],callback:({options:t})=>e.channelsInputPeak[t.channel]<=t.lessThan&&e.channelsInputPeak[t.channel]>=t.greaterThan,subscribe:()=>{11!=e.config.model&&12!=e.config.model&&e.addCmdtoQueue(s.metering.inputPeaks),e.checkSubscriptionLevel(1)}},channelOutputPeak:{name:"Channel Output Peak Meter",type:"boolean",label:"Channel Output Peak Meter",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames},{type:"number",label:"Less than or equal to",id:"lessThan",default:0,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER},{type:"number",label:"Greater than or equal to",id:"greaterThan",default:-12,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER}],callback:({options:t})=>e.channelsOutputPeak[t.channel]<=t.lessThan&&e.channelsOutputPeak[t.channel]>=t.greaterThan,subscribe:()=>{11!=e.config.model&&12!=e.config.model&&e.addCmdtoQueue(s.metering.outputPeaks),e.checkSubscriptionLevel(1)}},channelAmixGain:{name:"Channel Automix Gain Reduction",type:"boolean",label:"Channel Automix Gain Reduction",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Channel",id:"channel",default:1,choices:e.channelNames},{type:"number",label:"Less than or equal to",id:"lessThan",default:0,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER},{type:"number",label:"Greater than or equal to",id:"greaterThan",default:-12,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER}],callback:({options:t})=>e.channelsAmixGain[t.channel]<=t.lessThan&&e.channelsAmixGain[t.channel]>=t.greaterThan,subscribe:()=>{11!=e.config.model&&12!=e.config.model&&e.addCmdtoQueue(s.metering.automixGain),e.checkSubscriptionLevel(1)}},groupMute:{name:"Group Mute",type:"boolean",label:"Group Mute",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Group",id:"group",default:1,choices:e.groupNames}],callback:({options:t})=>0!=e.groupMute[t.group],subscribe:()=>{e.addCmdtoQueue(s.group.mute),e.checkSubscriptionLevel(1)}},groupPreset:{name:"Group Preset",type:"boolean",label:"Group Preset",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Group",id:"group",default:1,choices:e.groupNames}],callback:({options:t})=>0!=e.groupPreset[t.group],subscribe:()=>{e.addCmdtoQueue(s.group.preset),e.checkSubscriptionLevel(1)}},groupOverride:{name:"Group Override",type:"boolean",label:"Group Override",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Group",id:"group",default:1,choices:e.groupNames}],callback:({options:t})=>0!=e.groupOverride[t.group],subscribe:()=>{e.addCmdtoQueue(s.group.override),e.checkSubscriptionLevel(1)}},groupLastHold:{name:"Group Last Hold",type:"boolean",label:"Group Last Hold",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Group",id:"group",default:1,choices:e.groupNames}],callback:({options:t})=>0!=e.groupLastHold[t.group],subscribe:()=>{e.addCmdtoQueue(s.group.lastHold),e.checkSubscriptionLevel(1)}},groupNOMgain:{name:"Group NOM Gain Reduction",type:"boolean",label:"Group NOM Gain Reduction",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Group",id:"group",default:1,choices:e.groupNames},{type:"number",label:"Less than or equal to",id:"lessThan",default:0,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER},{type:"number",label:"Greater than or equal to",id:"greaterThan",default:-12,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER}],callback:({options:t})=>e.groupNOMpeak[t.group]<=t.lessThan&&e.groupNOMpeak[t.group]>=t.greaterThan,subscribe:()=>{11!=e.config.model&&12!=e.config.model&&e.addCmdtoQueue(s.metering.nomGain),e.checkSubscriptionLevel(2)}},groupMusicPeak:{name:"Group Music System Gain Reduction",type:"boolean",label:"Group Music System Gain Reduction",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Group",id:"group",default:1,choices:e.groupNames},{type:"number",label:"Less than or equal to",id:"lessThan",default:0,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER},{type:"number",label:"Greater than or equal to",id:"greaterThan",default:-12,max:0,min:-128,range:!0,step:.1,required:!0,regex:i.NUMBER}],callback:({options:t})=>e.groupMusicPeak[t.group]<=t.lessThan&&e.groupMusicPeak[t.group]>=t.greaterThan,subscribe:()=>{11!=e.config.model&&12!=e.config.model&&e.addCmdtoQueue(s.metering.musicRef),e.checkSubscriptionLevel(1)}},groupMusicInput:{name:"Group Music System Threshold Input",type:"boolean",label:"Group Music System Threshold Input",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Group",id:"group",default:1,choices:e.groupNames},{id:"input",type:"dropdown",label:"Music System Threshold Input",default:1,choices:e.musicInputs}],callback:({options:t})=>e.groupMusicInput[t.group]==t.input,subscribe:({options:t})=>{e.addCmdtoQueue(s.group.musicInput+a+t.group),e.checkSubscriptionLevel(1)},learn:async t=>{e.addCmdtoQueue(s.group.musicInput+a+t.options.group);const n=e.groupMusicInput[t.options.group];return{...t.options,input:n}}},matrixOutput:{name:"Matrix Output Route",type:"boolean",label:"Matrix Output Route",defaultStyle:{bgcolor:r(255,0,0),color:r(0,0,0)},options:[{type:"dropdown",label:"Matrix",id:"matrix",default:1,choices:e.matrixNames},{id:"output",type:"dropdown",label:"Output",default:1,choices:e.matrixDestinations}],callback:({options:t})=>e.matrixOutput[t.matrix]==t.output,subscribe:({options:t})=>{e.addCmdtoQueue(s.matrix.output+a+t.matrix),e.checkSubscriptionLevel(1)},learn:async t=>{e.addCmdtoQueue(s.matrix.output+a+t.options.matrix);const n=e.matrixOutput[t.options.matrix];return{...t.options,output:n}}}})}},2561:(e,t,n)=>{const{duganModels:r,paramSep:i,cmdSep:a,cmd:s,SOM:o,errSyntax1:l,errSyntax2:c,errRange:u,sampleRate:d,adatMirror:p,clockSources:h,MatrixCount:m,MatrixSize:b,GroupCount:g,grpAval:f,grpBval:y,grpCval:v,welcomeMessageM:w,welcomeMessageN:k,MaxChannelCount:N}=n(1586);e.exports={async processBuffer(e){let t=0,n=[],r=new ArrayBuffer(e.length),a=new Uint8Array(r),l=e.toString();for(;l[0]!=o&&l.length>0;)l=l.slice(1),t+=1;let c=await this.regexCmd(l);if(!(l.length>0&!c)&&0!=l.length){for(let n=t;n<e.length;n++)a[n-t]=e[n];switch(c){case o+s.channel.bulkParams+i:if(a.length<438)return void this.log("warn",`*GP response detected. Expected length > 438 bytes. Buffer length: ${a.length}`);for(let e=1;e<=N;e++)this.channelsMode[e]=a[e+3];this.config.channels!=a[68]&&(this.log("warn",`Mismatch between configured channels: ${this.config.channels} and connected device: ${a[68]}. Changing configuration.`),this.config.channels=a[68],this.initVariables(),this.updateActions(),this.updateFeedbacks());for(let e=1;e<=8;e++){let t=this.processBitFlags(e+68),n=this.processBitFlags(e+76),r=this.processBitFlags(e+84),i=this.processBitFlags(e+92);if(0==t||0==n||0==r||0==i)return this.log("warn","*GP, Unexpected response - one of the bitflag fields returned false"),!1;for(let a=0;a<t.length;a++){let s=a+1+8*(e-1);this.channelsBypass[s]=t[a],this.channelsNom[s]=n[a],this.channelsMusic[s]=r[a],this.channelsOverride[s]=i[a]}}for(let e=1;e<=16;e++){let t=this.process2BitFlags(e+100),n=this.process2BitFlags(e+116);if(0==t||0==n)return this.log("warn","Unexpected response"),!1;for(let r=0;r<n.length;r++){let i=r+1+4*(e-1);this.channelsPreset[i]=n[r],this.channelsGroupAssign[i]=t[r],this.channelsPreset[i]=n[r]}}this.checkFeedbacks("channelMode","channelPreset","channelBypass","channelOverride","channelMusic","channelNOM","channelGroupAssign");break;case o+s.matrix.bulkParams+i:if(a.length<884)return void this.log("warn",`*GM response detected. Expected length >= 884 bytes. Buffer length: ${a.length}`);for(let e=1;e<=m;e++){this.matrixGain[e]=this.calcXpointGain(a[e+879]),n[`matrixOutFader ${a[1]}`]=this.matrixGain[e];for(let t=1;t<=b;t++)this.matrixXpoint[e][t]=this.calcXpointGain(a[t+3+(e-1)*b]),n[`matrix${e}Xpoint${t}`]=this.matrixXpoint[e][t];this.setVariableValues(n)}break;case o+s.metering.channelStatus+i:if(a.length<235)return void this.log("debug",`*GS response detected. Expected length >= 235 bytes. Buffer length: ${a.length}`);for(let e=1;e<=8;e++){let t=this.processBitFlags(parseInt(a[e+3],10)),n=this.processBitFlags(parseInt(a[e+11],10));if(0==t||0==n)return void this.log("warn","Unexpected response signal flags: "+parseInt(a[e+3],10)+" clip flags: "+parseInt(a[e+11],10));for(let r=0;r<t.length;r++){let i=r+1+8*(e-1);this.channelsPresence[i]=t[r],this.channelsClip[i]=n[r]}}for(let e=1;e<=N;e++)this.channelsAmixGain[e]=this.calcGain(Number(a[e+20])),this.channelsInputPeak[e]=this.calcGain(Number(a[e+90])),this.channelsOutputPeak[e]=this.calcGain(Number(a[e+154])),n[`channelAmixGain${e}`]=this.channelsAmixGain[e],n[`channelInputLevel${e}`]=this.channelsInputPeak[e],n[`channelOutputLevel${e}`]=this.channelsOutputPeak[e];for(let e=1;e<=g;e++)this.groupNOMpeak[e]=this.calcGain(Number(a[e+84])),this.groupMusicPeak[e]=this.calcGain(Number(a[e+220])),n[`groupNOMpeak${e}`]=this.groupNOMpeak[e],n[`groupMSTgain${e}`]=this.groupMusicPeak[e];for(let e=1;e<=m;e++)this.matrixOutputPeak[e]=this.calcGain(Number(a[e+226])),n[`matrixOutLevel${e}`]=this.matrixOutputPeak[e];this.setVariableValues(n),this.checkFeedbacks("channelPresence","channelClip","channelAmixGain","channelInputPeak","channelOutputPeak","matrixLevel","groupNOMgain","groupMusicPeak"),this.checkIsTalking();break;default:await this.processCmds(l)}}},async processCmds(e){let t=e.toString().split("\r\n");return await t.forEach((async e=>{let t=e.split(a);await t.forEach((e=>{e.length>3&&this.processParams(e)}))})),!0},async processParams(e){let t=e.toString(),n={};for(;t[0]!=o&&t.length>0;)t=t.slice(1);let a=t.split(i);if(a[1]!=l&&a[1]!=c&&a[1]!=u)switch(a[0]){case o+s.channel.mode:3==a.length?(this.channelsMode[Number(a[1])]=Number(a[2]),this.checkFeedbacks("channelMode"),this.isRecordingActions&&this.recordAction({actionId:"channel_mode",options:{channel:Number(a[1]),mode:Number(a[2]),query:!1}},`channel_mode ${Number(a[1])}`)):this.log("warn",`Unexpected CM response: ${t}`);break;case o+s.channel.preset:3==a.length?(this.channelsPreset[Number(a[1])]=Number(a[2]),this.checkFeedbacks("channelPreset"),this.isRecordingActions&&this.recordAction({actionId:"channel_preset",options:{channel:Number(a[1]),preset:Number(a[2]),query:!1}},`channel_preset ${Number(a[1])}`)):this.log("warn",`Unexpected CP response: ${t}`);break;case o+s.channel.bypass:3==a.length?(this.channelsBypass[Number(a[1])]=Number(a[2]),this.checkFeedbacks("channelBypass"),this.isRecordingActions&&this.recordAction({actionId:"channel_bypass",options:{channel:Number(a[1]),bypass:Number(a[2]),query:!1}},`channel_bypass ${Number(a[1])}`)):this.log("warn",`Unexpected BP response: ${t}`);break;case o+s.channel.override:3==a.length?(this.channelsOverride[Number(a[1])]=Number(a[2]),this.checkFeedbacks("channelOverride"),this.isRecordingActions&&this.recordAction({actionId:"channel_override",options:{channel:Number(a[1]),override:Number(a[2]),query:!1}},`channel_override ${Number(a[1])}`)):this.log("warn",`Unexpected CO response: ${t}`);break;case o+s.channel.weight:3==a.length?(this.channelsWeight[Number(a[1])]=Number(a[2]),n["channelWeight"+a[1]]=Number(a[2]),this.setVariableValues(n),this.isRecordingActions&&this.recordAction({actionId:"channel_weight",options:{channel:Number(a[1]),weight:Number(a[2]),query:!1,useVar:!1,weightVar:""}},`channel_weight ${Number(a[1])}`)):this.log("warn",`Unexpected CW response: ${t}`);break;case o+s.channel.music:3==a.length?(this.channelsMusic[Number(a[1])]=Number(a[2]),this.checkFeedbacks("channelMusic"),this.isRecordingActions&&this.recordAction({actionId:"channel_music_mode",options:{channel:Number(a[1]),music:Number(a[2]),query:!1}},`channel_music_mode ${Number(a[1])}`)):this.log("warn",`Unexpected MR response: ${t}`);break;case o+s.channel.nom:3==a.length?(this.channelsNom[Number(a[1])]=Number(a[2]),this.checkFeedbacks("channelNOM"),this.isRecordingActions&&this.recordAction({actionId:"channel_NOM_mode",options:{channel:Number(a[1]),nom:Number(a[2]),query:!1}},`channel_NOM_mode ${Number(a[1])}`)):this.log("warn",`Unexpected NE response: ${t}`);break;case o+s.channel.group:3==a.length?(this.log("info",`Channel: ${a[1]} assigned to group: ${a[2]}`),this.channelsGroupAssign[Number(a[1])]=Number(a[2]),this.checkFeedbacks("channelGroupAssign"),this.isRecordingActions&&this.recordAction({actionId:"channel_group_assign",options:{channel:Number(a[1]),group:Number(a[2]),query:!1}},`channel_group_assign ${Number(a[1])}`)):this.log("warn",`Unexpected GA response: ${t}`);break;case o+s.channel.name:3==a.length?(this.channelsName[Number(a[1])]=a[2],n[`channelName${a[1]}`]=a[2],this.setVariableValues(n),this.isRecordingActions&&this.recordAction({actionId:"channel_name",options:{channel:Number(a[1]),name:a[2],query:!1}},`channel_name ${Number(a[1])}`)):this.log("warn",`Unexpected CN response: ${t}`);break;case o+s.group.mute:2==a.length?(this.groupMute[1]=Number(a[1])&f,this.groupMute[2]=Number(a[1])&y,this.groupMute[3]=Number(a[1])&v,this.checkFeedbacks("groupMute"),this.isRecordingActions&&this.recordAction({actionId:"group_mute",options:{groupA:this.groupMute[1],groupB:this.groupMute[2],groupC:this.groupMute[3],query:!1}},"group_mute")):this.log("warn",`Unexpected SM response: ${t}`);break;case o+s.group.preset:2==a.length?(this.groupPreset[1]=Number(a[1])&f,this.groupPreset[2]=Number(a[1])&y,this.groupPreset[3]=Number(a[1])&v,this.checkFeedbacks("groupPreset"),this.isRecordingActions&&this.recordAction({actionId:"group_preset",options:{groupA:this.groupPreset[1],groupB:this.groupPreset[2],groupC:this.groupPreset[3],query:!1}},"group_preset")):this.log("warn",`Unexpected SP response: ${t}`);break;case o+s.group.override:2==a.length?(this.groupOverride[1]=Number(a[1])&f,this.groupOverride[2]=Number(a[1])&y,this.groupOverride[3]=Number(a[1])&v,this.checkFeedbacks("groupOverride"),this.isRecordingActions&&this.recordAction({actionId:"group_override",options:{groupA:this.groupOverride[1],groupB:this.groupOverride[2],groupC:this.groupOverride[3],query:!1}},"group_override")):this.log("warn",`Unexpected SO response: ${t}`);break;case o+s.group.lastHold:2==a.length?(this.groupLastHold[1]=Number(a[1])&f,this.groupLastHold[2]=Number(a[1])&y,this.groupLastHold[3]=Number(a[1])&v,this.isRecordingActions&&this.recordAction({actionId:"group_lasthold",options:{groupA:this.groupLastHold[1],groupB:this.groupLastHold[2],groupC:this.groupLastHold[3],query:!1}},"group_lasthold")):this.log("warn",`Unexpected LH response: ${t}`);break;case o+s.group.automixDepth:case o+s.group.automixDepthAlt:3==a.length?(this.groupAutomixDepth[Number(a[1])]=Number(a[2]),n["groupAD"+a[1]]=Number(a[2]),this.setVariableValues(n),this.isRecordingActions&&this.recordAction({actionId:"group_automixdepth",options:{group:Number(a[1]),depth:Number(a[2]),useVar:!1,depthVar:"",query:!1}},`group_automixdepth ${Number(a[1])}`)):this.log("warn",`Unexpected AD/ME response: ${t}`);break;case o+s.group.nomGainLimit:3==a.length?(this.groupNOMgainlimit[Number(a[1])]=Number(a[2]),n[`groupNOM${a[1]}`]=Number(a[2]),this.setVariableValues(n),this.isRecordingActions&&this.recordAction({actionId:"group_NOMgainlimit",options:{group:Number(a[1]),nomgain:Number(a[2]),useVar:!1,nomVar:"",query:!1}},`group_NOMgainlimit ${Number(a[1])}`)):this.log("warn",`Unexpected NL response: ${t}`);break;case o+s.group.musicThreshold:3==a.length?(this.groupMusicThreshold[Number(a[1])]=Number(a[2]),n[`groupMST${a[1]}`]=Number(a[2]),this.setVariableValues(n),this.isRecordingActions&&this.recordAction({actionId:"group_musicthreshold",options:{group:Number(a[1]),threshold:Number(a[2]),useVar:!1,thresholdVar:"",query:!1}},`group_musicthreshold ${Number(a[1])}`)):this.log("warn",`Unexpected MT response: ${t}`);break;case o+s.group.musicInput:3==a.length?(this.groupMusicInput[Number(a[1])]=Number(a[2]),this.checkFeedbacks("groupMusicInput"),this.isRecordingActions&&this.recordAction({actionId:"group_musicinput",options:{group:Number(a[1]),input:Number(a[2]),query:!1}},`group_musicinput ${Number(a[1])}`)):this.log("warn",`Unexpected MXM response: ${t}`);break;case o+s.matrix.mute:3==a.length?(this.matrixMute[Number(a[1])]=Number(a[2]),this.checkFeedbacks("matrixMuted"),this.isRecordingActions&&this.recordAction({actionId:"matrix_mute",options:{matrix:Number(a[1]),mute:Number(a[2]),query:!1}},`matrix_mute ${Number(a[1])}`)):this.log("warn",`Unexpected MXM response: ${t}`);break;case o+s.matrix.polarity:3==a.length?(this.matrixPolarity[Number(a[1])]=Number(a[2]),this.checkFeedbacks("matrixPolarity"),this.isRecordingActions&&this.recordAction({actionId:"matrix_polarity",options:{matrix:Number(a[1]),polarity:Number(a[2]),query:!1}},`matrix_polarity ${Number(a[1])}`)):this.log("warn",`Unexpected MXP response: ${t}`);break;case o+s.matrix.gain:3==a.length?(this.matrixGain[Number(a[1])]=Number(a[2]),n[`matrixOutFader${a[1]}`]=Number(a[2]),this.setVariableValues(n),this.isRecordingActions&&this.recordAction({actionId:"matrix_gain",options:{matrix:Number(a[1]),gain:Number(a[2]),query:!1,useVar:!1,gainVar:""}},`matrix_gain ${Number(a[1])}`)):this.log("warn",`Unexpected MXV response: ${t}`);break;case o+s.matrix.output:3==a.length?(this.matrixOutput[Number(a[1])]=Number(a[2]),this.checkFeedbacks("matrixOutput"),this.isRecordingActions&&this.recordAction({actionId:"matrix_output",options:{matrix:Number(a[1]),output:Number(a[2]),query:!1}},`matrix_output ${Number(a[1])}`)):this.log("warn",`Unexpected MXM response: ${t}`);break;case o+s.matrix.crosspoint:4==a.length?(this.matrixXpoint[Number(a[1])][Number(a[2])]=Number(a[3]),n[`matrix${a[1]}Xpoint${a[2]}`]=Number(a[3]),this.setVariableValues(n),this.isRecordingActions&&this.recordAction({actionId:"matrix_crosspoint",options:{matrix:Number(a[1]),channel:Number(a[2]),gain:Number(a[3]),query:!1,useVar:!1,gainVar:""}},`matrix_crosspoint ${Number(a[1])} ${Number(a[2])}`)):this.log("warn",`Unexpected OM response: ${t}`);break;case o+s.scene.count:if(2==a.length){if(isNaN(Number(a[1])))return this.log("warn",`Unexpected SNC response: ${t}`),!1;this.setVariableValues({sceneCount:Number(a[1])}),this.addCmdtoQueue(`${s.scene.nameList},1,${Number(a[1])}`)}else this.log("warn","Unexpected SNC response: "+t);break;case o+s.scene.active:if(4==a.length){let e=1==Number(a[3]);this.setVariableValues({sceneActive:a[1].toString(),sceneActiveIndex:Number(a[2]),sceneActiveChanged:e}),this.sceneChanged=e,this.checkFeedbacks("sceneChanged")}else this.log("warn",`Unexpected SNA response: ${t}`);break;case o+s.scene.recall:2==a.length?-1==a[1].search("Error: scene")?(this.log("info",`Scene Recalled: ${a[1]}`),this.addCmdtoQueue(s.scene.active),this.isRecordingActions&&this.recordAction({actionId:"sc_recall",options:{name:a[1]}},"sc_recall")):this.log("warn",t):this.log("warn",`Unexpected SNR response: ${t}`);break;case o+s.scene.save:case o+s.scene.saveNew:2==a.length?-1==a[1].search("Error: scene")?(this.log("info",`New scene saved: ${a[1]}`),this.addCmdtoQueue(s.scene.count),this.addCmdtoQueue(s.scene.active)):this.log("warn",t):this.log("warn",`Unexpected SNN/SNS response: ${t}`);break;case o+s.scene.rename:3==a.length?(this.log("info",`Scene: ${a[1]}. Renamed to: ${a[2]}`),this.addCmdtoQueue(s.scene.count),this.addCmdtoQueue(s.scene.active)):this.log("warn",`Error response:  ${t}`);break;case o+s.scene.delete:2==a.length?-1==a[1].search("Error: scene")?(this.log("info",`Scene Deleted: ${a[1]}`),this.addCmdtoQueue(s.scene.count),this.addCmdtoQueue(s.scene.active)):this.log("warn",a[1]):this.log("warn",`Unexpected SND response: ${t}`);break;case o+s.scene.defaults:this.log("info",`Channels reset to defaults. ${t}`),this.addCmdtoQueue(s.scene.active),this.isRecordingActions&&this.recordAction({actionId:"recall_default",options:{mode:"FP"}},"recall_default");break;case o+s.matrix.defaults:this.log("info",`Matrix reset to defaults. ${t}`),this.isRecordingActions&&this.recordAction({actionId:"recall_default",options:{mode:"RM"}},"recall_default");break;case o+s.system.subscribe:if(isNaN(a[1]))return this.log("warn",`SU has returned an unexpected value: ${t}`),!1;this.config.subscription=a[1],this.log("info",`Subscribe unsolicited level set. Level: ${a[1]}`);break;case o+s.system.linkGroup:2==a.length?this.setVariableValues({linkGroup:Number(a[1])}):this.log("warn",`Unexpected LG response: ${t}`);break;case o+s.system.clock:2==a.length?a[1]>0?this.setVariableValues({clockSource:h[a[1]]}):0==a[1]&&11==this.config.model?this.setVariableValues({clockSource:"Madi"}):0==a[1]&&12==this.config.model?this.setVariableValues({clockSource:"Dante"}):this.setVariableValues({clockSource:"Unknown"}):this.log("warn",`Unexpected CS response: ${t}`);break;case o+s.system.adatMirror:2==a.length?this.setVariableValues({adatMirror:p[a[1]]}):this.log("warn",`Unexpected AM response: ${t}`);break;case o+s.system.automixChannels:2==a.length?(this.setVariableValues({channelCount:Number(a[1])}),Number(a[1])!=this.config.channels&&(this.log("warn",`Mismatch between configured channels: ${this.config.channels} and connected device: ${Number(a[1])}. Changing configuration.`),this.config.channels=Number(a[1]),this.initVariables(),this.updateActions(),this.updateFeedbacks())):this.log("warn",`Unexpected CFN response: ${t}`);break;case o+s.system.channelOffset:2==a.length?this.setVariableValues({inputOffset:Number(a[1])}):this.log("warn",`Unexpected CFS response: ${t}`);break;case o+s.system.blinkMode:if(2==a.length){let e="1"==a[1];this.setVariableValues({blinkMode:e})}else this.log("warn",`Unexpected BM response: ${t}`);break;case o+s.system.dhcp:if(2==a.length){let e="1"==a[1];this.setVariableValues({master:e})}else this.log("warn",`Unexpected DH response: ${t}`);break;case o+s.system.config:if(13==a.length){let e="1"==a[11];this.setVariableValues({deviceType:r[a[1]],hostName:a[2],serialNumber:a[3],firmwareVersion:a[4],fpgaVersion:a[5],hardwareRevsion:a[6],macAddress:a[7],ipAddress:a[8],netMask:a[9],gateway:a[10],dhcp:e,channelCount:Number(a[12])}),a[1]!=this.config.model&&(this.log("warn",`Mismatch between configured model: ${r[this.config.model]} and connected device: ${r[a[1]]}`),this.config.model=Number(a[1])),Number(a[12])!=this.config.channels&&(this.log("warn",`Mismatch between configured channels: ${this.config.channels} and connected device: ${Number(a[12])}. Changing configuration.`),this.config.channels=Number(a[12]),this.initVariables(),this.updateActions(),this.updateFeedbacks(),this.updateVariableDefinitions())}else this.log("warn",`Unexpected SC response: ${t}`);break;case"*VE":5==a.length?this.setVariableValues({firmwareVersion:a[1],firmwareSecVersion:a[2],fpgaVersion:a[3],hardwareRevsion:a[4]}):this.log("warn",`Unexpected VE response: ${t}`);break;case o+s.system.connections:if(3==a.length){let e=a[1].split(":"),t=a[2].split(":");this.setVariableValues({clientUDP:Number(e[1]),clientTCP:Number(t[1])}),Number(e[1])+Number(t[1])==5&&this.log("warn","All connections full, cannot accept more concurrent clients")}else this.log("warn",`Unexpected CC response: ${t}`);break;case o+s.system.resourceUseage:if(9==a.length){let e=a[1].split(":"),t=a[2].split(":"),n=a[3].split(":"),r=a[4].split(":"),i=a[5].split(":"),s=a[6].split(":"),o=a[7].split(":"),l=a[8].split(":");this.setVariableValues({heartBeat:Number(e[1]),lwip:Number(t[1]),dsp:Number(n[1]),tcpip:Number(r[1]),macRX:Number(i[1]),macTX:Number(s[1]),rtosHeapFree:Number(o[1]),mallocHeadFree:Number(l[1])})}else this.log("warn",`Unexpected HW response: ${t}`);break;case o+s.system.switchHeadroom:this.setVariableValues({switchHeadroom:Number(a[1])});break;case o+s.system.sampleRate:2==a.length?"0"==a[1]||"1"==a[1]?this.setVariableValues({sampleRate:d[a[1]]}):this.setVariableValues({sampleRate:a[1]}):this.log("warn",`Unexpected SF response: ${t}`);break;case o+s.system.master:if(2==a.length){let e=1==Number(a[2]);this.setVariableValues({master:e})}else this.log("warn",`Unexpected MM response: ${t}`);break;case o+s.system.name:2==a.length?this.setVariableValues({hostName:a[1]}):this.log("warn",`Unexpected NA response: ${t}`);break;case o+s.system.ip:5==a.length?this.setVariableValues({ipAddress:a[2]+"."+a[3]+"."+a[4]+"."+a[5]}):this.log("warn",`Unexpected IP response: ${t}`);break;case o+s.system.netmask:5==a.length?this.setVariableValues({netMask:a[2]+"."+a[3]+"."+a[4]+"."+a[5]}):this.log("warn",`Unexpected NM response: ${t}`);break;case o+s.system.gateway:5==a.length?this.setVariableValues({gateway:`${a[2]}.${a[3]}.${a[4]}.${a[5]}`}):this.log("warn",`Unexpected GW response: ${t}`);break;case o+s.channel.nameList:if(a.length>=4)if(a.length==3+Number(a[2])){let e=Number(a[1]),t=Number(a[2]);for(let r=e;r<=e+t-1;r++)n[`channelName${r}`]=a[r-e+3],this.channelsName[r]=a[r-e+3];this.setVariableValues(n)}else this.log("warn",`Unexpected length. Expected: ${3+Number(a[2])} Recieved: ${a.length}`);else this.log("warn",`Unexpected CNS length: ${t}`);break;case o+s.scene.nameList:if(a.length>4){this.sceneList=[];for(let e=4;e<a.length;e++)this.sceneList.push({id:a[e],label:a[e].toString()});this.updateActions()}else 4==a.length?(this.log("warn",`No custom scenes saved. ${t}`),this.sceneList=[],this.updateActions()):this.log("warn",`Unexpected SNL response: ${t}`);break;case o+s.metering.automixGain:if(a.length!=N+1)return this.log("warn",`Unexpected GSA length: ${a.length} response: ${t}`),!1;for(let e=1;e<=this.config.channels;e++)this.channelsAmixGain[e]=this.calcGain(Number(a[e])),this.checkFeedbacks("channelAmixGain"),n[`channelAmixGain${e}`]=this.channelsAmixGain[e];this.setVariableValues(n),this.checkFeedbacks("channelAmixGain"),this.checkIsTalking();break;case o+s.metering.signalClip:if(9!=a.length)return this.log("warn",`Unexpected GSC length: ${t}`),!1;for(let e=1;e<a.length;e++){let t=this.processBitFlags(parseInt(a[e],16));if(0==t)return this.log("warn",`Unexpected response: ${t}`),!1;for(let n=0;n<t.length;n++){let r=n+1+8*(e-1);this.channelsClip[r]=t[n]}}this.checkFeedbacks("channelClip");break;case o+s.metering.signalPresense:case o+s.metering.signalPresenseAlt:if(9!=a.length)return this.log("warn",`Unexpected GSS/GSP length: ${t}`),!1;for(let e=1;e<a.length;e++){let t=this.processBitFlags(parseInt(a[e],16));if(0==t)return this.log("warn",`Unexpected response: ${t}`),!1;for(let n=0;n<t.length;n++){let r=n+1+8*(e-1);this.channelsPresence[r]=t[n]}}this.checkFeedbacks("channelPresence");break;case o+s.metering.inputPeaks:if(a.length!=N+1)return this.log("warn",`Unexpected GSI length: ${a.length} response: ${t}`),!1;for(let e=1;e<=this.config.channels;e++)this.channelsInputPeak[e]=this.calcGain(Number(a[e])),this.checkFeedbacks("channelInputPeak"),n[`channelInputLevel${e}`]=this.channelsInputPeak[e];this.setVariableValues(n),this.checkFeedbacks("channelInputPeak");break;case o+s.metering.outputPeaks:if(a.length!=N+1)return this.log("warn",`Unexpected GSO length: ${a.length} response: ${t}`),!1;for(let e=1;e<=this.config.channels;e++)this.channelsOutputPeak[e]=this.calcGain(Number(a[e])),this.checkFeedbacks("channelOutputPeak"),n[`channelOutputLevel${e}`]=this.channelsOutputPeak[e];this.setVariableValues(n),this.checkFeedbacks("channelOutputPeak");break;case o+s.metering.musicRef:if(a.length!=g+1)return this.log("warn",`Unexpected GSM length: ${a.length} response: ${t}`),!1;for(let e=1;e<=g;e++)this.groupMusicPeak[e]=this.calcGain(Number(a[e])),this.checkFeedbacks("groupMusicPeak"),n[`groupMSTgain${e}`]=this.groupMusicPeak[e];this.setVariableValues(n),this.checkFeedbacks("groupMusicPeak");break;case o+s.metering.nomGain:if(a.length!=g+1)return this.log("warn",`Unexpected GSN length: ${a.length} response: ${t}`),!1;for(let e=1;e<=g;e++)this.groupNOMpeak[e]=this.calcGain(Number(a[e])),this.checkFeedbacks("groupNOMgain"),n[`groupNOMpeak${e}`]=this.groupNOMpeak[e];this.setVariableValues(n),this.checkFeedbacks("groupNOMgain");break;case o+s.metering.matrixOutput:if(a.length!=m+1)return this.log("warn",`Unexpected GSX length: ${a.length} response: ${t}`),!1;for(let e=1;e<=m;e++)this.matrixOutputPeak[e]=this.calcGain(Number(a[e])),this.checkFeedbacks("matrixLevel"),n[`matrixOutLevel${e}`]=this.matrixOutputPeak[e];this.setVariableValues(n),this.checkFeedbacks("matrixLevel");break;case o+s.system.ping:this.log("info",`Ping received: ${a[1]}`);break;case o+s.system.pd:this.log("info",`PD received: ${a[1]}`);break;case"Dugan N >":case"Dugan M >":case"":break;case w:case k:this.log("info",e);break;default:this.log("warn",`Unexpected response from unit: ${e}`)}else this.log("warn",`bad response: ${t}`)}}},9227:(e,t,n)=>{const{InstanceStatus:r,TCPHelper:i}=n(6278),{msgDelay:a,EOM:s,cmdOnConnect:o,cmdOnPollInterval:l,paramSep:c,meterCommands:u,cmd:d,timeOutValue:p}=n(1586);e.exports={async addCmdtoQueue(e){return void 0!==e&&e.length>=1?(await this.cmdQueue.push(e),!0):(this.log("warn",`Invalid command: ${e}`),!1)},async processCmdQueue(){return this.cmdQueue.length>0&&this.clearToTx?(this.sendCommand(await this.cmdQueue.shift()),this.cmdTimer=setTimeout((()=>{this.processCmdQueue()}),a[this.config.rate]),!0):(this.cmdTimer=setTimeout((()=>{this.processCmdQueue()}),a[this.config.rate]/2),!1)},async sendCommand(e){if(void 0!==e){if(void 0!==this.socket&&this.socket.isConnected)return this.clearToTx=!1,this.socket.send(e+s),this.timeOutTimer=setTimeout((()=>{this.timeOut()}),a[p]),!0;this.log("warn",`Socket not connected, tried to send: ${e}`)}else this.log("warn","Command undefined");return!1},async getNames(){let e=Math.ceil(this.config.channels/16);for(let t=1;t<=e;t++){let e=1+16*(t-1),n=16;e+n-1>this.config.channels&&(n=this.config.channels-e+1),await this.addCmdtoQueue(`${d.channel.nameList}${c}${e}${c}${n}`)}return!0},async queryOnConnect(){clearTimeout(this.keepAliveTimer),clearTimeout(this.meterTimer),o.forEach((e=>{this.addCmdtoQueue(e)})),this.config.subscription=null==this.config.subscription?1:this.config.subscription,this.addCmdtoQueue(`${d.system.subscribe}${c}${this.config.subscription}`),await this.getNames(),await this.subscribeFeedbacks(),await this.subscribeActions(),11!=this.config.model&&12!=this.config.model||this.addCmdtoQueue(d.matrix.bulkParams);for(let e=1;e<=this.config.channels;e++)await this.addCmdtoQueue(`${d.channel.weight}${c}${e}`);return this.config.keepAlive>0&&(this.keepAliveTimer=setTimeout((()=>{this.pollStatus()}),1e3*this.config.keepAlive)),this.config.meterRate>=100&&(this.meterTimer=setTimeout((()=>{this.checkMeters()}),this.config.meterRate)),!0},timeOut(){return this.clearToTx=!0,!0},pollStatus(){l.forEach((e=>{this.addCmdtoQueue(e)})),this.getNames(),this.keepAliveTimer=setTimeout((()=>{this.pollStatus()}),1e3*this.config.keepAlive)},checkMeters(){return 4!=this.config.model&&5!=this.config.model&&6!=this.config.model&&9!=this.config.model&&(u.forEach((e=>{this.addCmdtoQueue(e)})),this.config.meterRate>=100&&(this.meterTimer=setTimeout((()=>{this.checkMeters()}),this.config.meterRate)),!0)},initTCP(){void 0!==this.socket&&(this.sendCommand(d.system.endSession),this.socket.destroy(),delete this.socket,this.updateStatus(r.Disconnected)),this.config.host?(this.log("debug","Creating New Socket"),this.updateStatus(r.Connecting),this.socket=new i(this.config.host,this.config.port),this.socket.on("status_change",((e,t)=>{this.updateStatus(e,t)})),this.socket.on("error",(e=>{this.log("error",`Network error: ${e.message}`),this.updateStatus(r.ConnectionFailure,e.message),this.clearToTx=!0,clearTimeout(this.keepAliveTimer),clearTimeout(this.meterTimer),clearTimeout(this.timeOutTimer)})),this.socket.on("connect",(()=>{this.log("info","Connected"),this.updateStatus(r.Ok),this.clearToTx=!0,clearTimeout(this.timeOutTimer),this.queryOnConnect()})),this.socket.on("data",(e=>{this.clearToTx=!0,clearTimeout(this.timeOutTimer),this.processBuffer(e)}))):this.updateStatus(r.BadConfig)}}},3487:e=>{e.exports=[]},8094:(e,t,n)=>{const{regexpCmd:r,regexpSafeString:i,paramSep:a,cmd:s}=n(1586);e.exports={regexCmd(e){let t,n;for(;null!==(t=r.exec(e));)n=t[0];return n=null!=n&&n,n},regexSafeString(e){let t,n;for(;null!==(t=i.exec(e));)n=t[0];return n=null!=n&&n,n},calcGain(e){return isNaN(e)?(this.log("debug",`calcGain has been passed a Nan: ${e}`),!1):e<0||e>255?(this.log("debug",`calcGain has been passed an out of range number:  ${e}`),!1):0-e/2},calcXpointGain(e){return isNaN(e)?(this.log("debug",`calcXpointGain has been passed a Nan:  ${e}`),!1):e<0||e>255?(this.log("debug",`calcXpointGain has been passed an out of range number:  ${e}`),!1):(e-192)/2},processBitFlags(e){if(isNaN(e))return this.log("debug",`processBitFlags has been passed a Nan:  ${e}`),!1;if(e<0||e>255)return this.log("debug",`processBitFlags has been passed an out of range number:  ${e}`),!1;let t=[],n=[1,2,4,8,16,32,64,128];for(let r=0;r<n.length;r++)t[r]=!!(e&n[r]);return t},process2BitFlags(e){if(isNaN(e))return this.log("debug",`process2BitFlags has been passed a Nan:  ${e}`),!1;if(e<0||e>255)return this.log("debug",`process2BitFlags has been passed an out of range number:  ${e}`),!1;let t=[],n=[3,12,48,192],r=[1,4,16,64];for(let i=0;i<n.length;i++){let a=e&n[i];t[i]=a/r[i]}return t},checkSubscriptionLevel(e){if(isNaN(e))this.log("debug",`checkSubscriptionLevel has been passed a Nan:  ${e}`);else if(!(e<0||e>2))return this.config.subscription>=e||(this.config.subscription=e,this.addCmdtoQueue(s.system.subscribe+a+e),e)},checkIsTalking(){let e=[],t=1;for(let e=2;e<=this.config.channels;e++)t=this.channelsAmixGain[e]>this.channelsAmixGain[t]?e:t;this.channelsAmixGain[t]>=this.config.isTalkingThreshold?(e.isTalkingChannel=t,e.isTalkingName=this.channelsName[t]):(e.isTalkingChannel=0,e.isTalkingName=""),this.setVariableValues(e)}}},2433:e=>{e.exports={deviceType:"unknown",hostName:"unknown",serialNumber:"unknown",firmwareVersion:"unknown",firmwareSecVersion:"unknown",fpgaVersion:"unknown",hardwareRevsion:"unknown",macAddress:"unknown",ipAddress:"unknown",netMask:"unknown",gateway:"unknown",dhcp:"unknown",channelCount:"unknown",linkGroup:"unknown",clockSource:"unknown",adatMirror:"unknown",inputOffset:"unknown",blinkMode:"unknown",clientUDP:"unknown",clientTCP:"unknown",sampleRate:"unknown",switchHeadroom:"unknown",master:"unknown",heartBeat:"unknown",lwip:"unknown",dsp:"unknown",tcpip:"unknown",macRX:"unknown",macTX:"unknown",rtosHeapFree:"unknown",mallocHeapFree:"unknown",sceneCount:"unknown",sceneActive:"unknown",sceneActiveIndex:"unknown",sceneActiveChanged:!1,isTalkingChannel:0,isTalkingName:""}},7969:(e,t,n)=>{const{MaxChannelCount:r,MatrixCount:i,MatrixSize:a,GroupCount:s}=n(1586);e.exports=async function(e){let t=[{variableId:"deviceType",name:"Device Type"},{variableId:"hostName",name:"Host Name"},{variableId:"serialNumber",name:"Serial Number"},{variableId:"firmwareVersion",name:"Firmware Version"},{variableId:"firmwareSecVersion",name:"Secondary Firmware Version"},{variableId:"fpgaVersion",name:"FPGA Version"},{variableId:"hardwareRevsion",name:"Hardware Revsion"},{variableId:"macAddress",name:"MAC Address"},{variableId:"ipAddress",name:"IP Address"},{variableId:"netMask",name:"Subnet Mask"},{variableId:"gateway",name:"Gateway"},{variableId:"dhcp",name:"DHCP"},{variableId:"channelCount",name:"Channel Count"},{variableId:"linkGroup",name:"Link Group"},{variableId:"clockSource",name:"Clock Source"},{variableId:"adatMirror",name:"ADAT Mirror"},{variableId:"inputOffset",name:"Input Channel Offset"},{variableId:"blinkMode",name:"Blink Mode"},{variableId:"clientUDP",name:"UDP Clients"},{variableId:"clientTCP",name:"TCP Clients"},{variableId:"sampleRate",name:"Sample Rate"},{variableId:"switchHeadroom",name:"Switch Headroom"},{variableId:"master",name:"Master"},{variableId:"heartBeat",name:"Heart Beat"},{variableId:"lwip",name:"LWIP"},{variableId:"dsp",name:"DSP"},{variableId:"tcpip",name:"TCPIP"},{variableId:"macRX",name:"Mac RX"},{variableId:"macTX",name:"Mac TX"},{variableId:"rtosHeapFree",name:"RTOS Heap Free"},{variableId:"mallocHeadFree",name:"Malloc Heap Free"},{variableId:"sceneCount",name:"Scene Count"},{variableId:"sceneActive",name:"Active Scene"},{variableId:"sceneActiveIndex",name:"Active Scene Index"},{variableId:"sceneActiveChanged",name:"Active Scene Changed"},{variableId:"isTalkingChannel",name:"Is Talking Channel"},{variableId:"isTalkingName",name:"Is Talking Name"}];for(let e=1;e<=r;e++)t.push({variableId:`channelName${e}`,name:`Channel ${e} Name`},{variableId:`channelWeight${e}`,name:`Channel ${e} Weight`},{variableId:`channelAmixGain${e}`,name:`Channel ${e} Gain Reduction`},{variableId:`channelInputLevel${e}`,name:`Channel ${e} Input Level`},{variableId:`channelOutputLevel${e}`,name:`Channel ${e} Output Level`});for(let e=1;e<=i;e++){t.push({variableId:`matrixOutFader${e}`,name:`Matrix ${e} Fader`},{variableId:`matrixOutLevel${e}`,name:`Matrix ${e} Output Level`});for(let n=1;n<=a;n++)t.push({variableId:`matrix${e}Xpoint${n}`,name:`Matrix ${e} Crosspoint ${n}`})}for(let e=1;e<=s;e++)t.push({variableId:`groupNOM${e}`,name:`Group ${e} NOM Limit`},{variableId:`groupNOMpeak${e}`,name:`Group ${e} NOM Peak`},{variableId:`groupAD${e}`,name:`Group ${e} Automix Depth`},{variableId:`groupMST${e}`,name:`Group ${e} Music System Threshold`},{variableId:`groupMSTgain${e}`,name:`Group ${e} Music System Gain`});e.setVariableDefinitions(t)}},7194:e=>{"use strict";e.exports=require("dgram")},1943:e=>{"use strict";e.exports=require("fs/promises")},9278:e=>{"use strict";e.exports=require("net")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4326:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=void 0;const r=n(1635),i=n(9967),a=r.__importDefault(n(1943)),s=n(360),o=n(4044),l=r.__importDefault(n(6928));let c,u=!1;t.runEntrypoint=function(e,t){Promise.resolve().then((async()=>{if(u)throw new Error("runEntrypoint can only be called once");u=!0;const n=process.env.MODULE_MANIFEST;if(!n)throw new Error("Module initialise is missing MODULE_MANIFEST");const r=await a.default.readFile(n),d=JSON.parse(r.toString());if(d.runtime?.api!==i.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!d.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let p=d.runtime.apiVersion;if("0.0.0"===p)try{const e=await a.default.readFile(l.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(p=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const h=process.env.CONNECTION_ID;if("string"!=typeof h||!h)throw new Error("Module initialise is missing CONNECTION_ID");const m=process.env.VERIFICATION_TOKEN;if("string"!=typeof m||!m)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const b=new o.IpcWrapper({},(e=>{process.send(e)}),5e3);process.once("message",(e=>{b.receivedMessage(e)})),c=new e((0,s.literal)({id:h,upgradeScripts:t,_isInstanceBaseProps:!0})),b.sendWithCb("register",{apiVersion:p,connectionId:h,verificationToken:m}).then((()=>{console.log("Module-host accepted registration")}),(e=>{console.error("Module registration failed",e),process.exit(11)}))})).catch((e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)}))}},6160:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var r=n(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return r.TCPHelper}});var i=n(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return i.TelnetHelper}});var a=n(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return a.UDPHelper}})},8895:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const r=n(1635).__importDefault(n(9278)),i=n(228),a=n(1400);class s extends i.EventEmitter{#e;#t;_socket;#n;#r=!1;#i=!1;#a=!1;#s;#o;#l;get isConnected(){return this.#r}get isConnecting(){return this.#i}get isDestroyed(){return this.#a}constructor(e,t,n){super(),this.#e=e,this.#t=t,this.#n={reconnect_interval:2e3,reconnect:!0,...n},this._socket=new r.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",(e=>{this.#i=!1,this.#r=!1,this.#n.reconnect&&this.#c(),this.#u(a.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this._socket.on("ready",(()=>{this.#r=!0,this.#i=!1,this.#u(a.InstanceStatus.Ok),this.emit("connect")})),this._socket.on("end",(()=>{this.#r=!1,this.#u(a.InstanceStatus.Disconnected),!this.#i&&this.#n.reconnect&&this.#c(),this.emit("end")})),this._socket.on("data",(e=>this.emit("data",e))),this._socket.on("drain",(()=>this.emit("drain"))),setImmediate((()=>{this.#a||this.connect()})),this.#l=setTimeout((()=>{this.#l=void 0,this.#a||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}connect(){if(this.#a)throw new Error("Cannot connect destroyed socket");return!this.#i&&(this.#i=!0,this._socket.connect(this.#t,this.#e),!0)}async send(e){if(this.#a||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#r)return!1;try{return new Promise(((t,n)=>{this._socket.write(e,(e=>{e?n(e):t(!0)}))}))}catch(e){this.#r=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#u(a.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#a=!0,void 0!==this.#o&&(clearTimeout(this.#o),this.#o=void 0),void 0!==this.#l&&(clearTimeout(this.#l),this.#l=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#c(){void 0!==this.#o&&clearTimeout(this.#o),this.#o=setTimeout((()=>{this.#o=void 0,this.#u(a.InstanceStatus.Connecting),this.connect()}),this.#n.reconnect_interval)}#u(e,t){this.#s!=e&&(this.#s=e,this.emit("status_change",e,t))}}t.TCPHelper=s},1118:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const r=n(1635).__importDefault(n(228)),i=n(2203),a=n(8895);class s extends r.default{#d;#p;#l;get isConnected(){return this.#d.isConnected}get isConnecting(){return this.#d.isConnecting}get isDestroyed(){return this.#d.isDestroyed}constructor(e,t,n){super(),this.#d=new a.TCPHelper(e,t,n),this.#p=new o,this.#d._socket.pipe(this.#p),this.#d.on("connect",(()=>this.emit("connect"))),this.#d.on("end",(()=>this.emit("end"))),this.#d.on("error",(e=>this.emit("error",e))),this.#d.on("status_change",((e,t)=>this.emit("status_change",e,t))),this.#p.on("iac",((e,t)=>this.emit("iac",e,t))),this.#p.on("sb",(e=>this.emit("sb",e))),this.#p.on("data",(e=>this.emit("data",e))),this.#p.on("drain",(()=>this.emit("drain"))),this.#l=setTimeout((()=>{this.#l=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)}),5e3)}connect(){return this.#d.connect()}async send(e){return this.#d.send(e)}destroy(){this.#d.destroy(),void 0!==this.#l&&(clearTimeout(this.#l),this.#l=void 0),this.#p.removeAllListeners(),this.#p.destroy()}}t.TelnetHelper=s;class o extends i.Transform{#h;#m;#b;constructor(e){super(e),this.#h=Buffer.alloc(0),this.#m=Buffer.alloc(0),this.#b=0}_transform(e,t,n){for(let t=0;t<e.length;++t)this.#g(e[t]);const r=this.#f();r.length&&this.push(r),n()}#g(e){if(0===this.#b){if(255===e)return void(this.#b=255);this.#h=Buffer.concat([this.#h,Buffer.from([e])])}else if(255===this.#b)switch(e){case 250:case 251:case 252:case 253:case 254:this.#b=e;break;default:this.#b=0}else{if(this.#b>=251&&this.#b<=254){let t;switch(this.#b){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#b=0)}if(250===this.#b){if(240===e)return this.emit("sb",this.#m),this.#b=0,void(this.#m=Buffer.alloc(0));this.#m=Buffer.concat([this.#m,Buffer.from([e])])}}}#f(){const e=this.#h;return this.#h=Buffer.alloc(0),e}}},6259:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const r=n(1635).__importDefault(n(7194)),i=n(228),a=n(1400);class s extends i.EventEmitter{#e;#t;#y;#n;#a=!1;#s;#l;get isDestroyed(){return this.#a}constructor(e,t,n){super(),this.#e=e,this.#t=t,this.#n={...n},this.#y=r.default.createSocket("udp4");try{this.#y.bind(this.#n.bind_port||0,this.#n.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#n.bind_ip||"0.0.0.0"}:${this.#n.bind_port||0}`)}this.#n.broadcast&&this.#y.setBroadcast(!0),void 0!==this.#n.ttl&&this.#y.setTTL(this.#n.ttl),void 0!==this.#n.multicast_ttl&&this.#y.setMulticastTTL(this.#n.multicast_ttl),this.#y.on("error",(e=>{this.#u(a.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this.#y.on("listening",(()=>{this.#n.multicast_interface&&this.#y.setMulticastInterface(this.#n.multicast_interface),this.#u(a.InstanceStatus.Ok),this.emit("listening")})),this.#y.on("message",(e=>this.emit("data",e))),this.#l=setTimeout((()=>{this.#a||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}async send(e){if(this.#a)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise(((t,n)=>{this.#y.send(e,this.#t,this.#e,(e=>{e?n(e):t()}))}))}destroy(){this.#a=!0,void 0!==this.#l&&(clearTimeout(this.#l),this.#l=void 0),this.#y.removeAllListeners(),this.#y.close(),this.removeAllListeners()}#u(e,t){this.#s!=e&&(this.#s=e,this.emit("status_change",e,t))}}t.UDPHelper=s},4044:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const r=n(1635),i=n(360),a=r.__importDefault(n(6022));t.IpcWrapper=class{#v;#w;#k;#N=1;#x=new Map;constructor(e,t,n){this.#v=e,this.#w=t,this.#k=n}async sendWithCb(e,t,n,r=0){r<=0&&(r=this.#k);const i={timeout:void 0,resolve:()=>null,reject:()=>null},s=new Promise(((e,t)=>{i.resolve=e,i.reject=t}));this.#N>268435456&&(this.#N=1);const o=this.#N++;this.#x.set(o,i),this.#w({direction:"call",name:String(e),payload:a.default.stringify(t),callbackId:o});const l=new Error("Call timed out");return i.timeout=setTimeout((()=>{i.reject(n?n():l),this.#x.delete(o)}),r),s}sendWithNoCb(e,t){this.#w({direction:"call",name:String(e),payload:a.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#v[e.name];if(!t)return void(e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!1,payload:a.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?a.default.parse(e.payload):void 0).then((t=>{e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!0,payload:a.default.stringify(t)})}),(t=>{e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):a.default.stringify(t)})}));break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#x.get(e.callbackId);if(this.#x.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const n=e.payload?a.default.parse(e.payload):void 0;if(e.success)t.resolve(n);else{let e=n;n&&"object"==typeof n&&"message"in n&&(e=new Error(n.message),n.stack&&(e.stack=n.stack)),t.reject(e)}break}default:(0,i.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},6278:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const r=n(1635);r.__exportStar(n(9077),t),r.__exportStar(n(2018),t),r.__exportStar(n(4581),t);var i=n(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return i.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return i.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return i.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return i.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return i.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return i.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return i.assertNever}}),r.__exportStar(n(6160),t);var a=n(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return a.runEntrypoint}})},4289:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const r=n(2593);function i(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#I;#S;#C;#_=new Map;#M=new Map;constructor(e,t,n){this.#I=e,this.#S=t,this.#C=n}async handleExecuteAction(e){const t=this.#_.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},n)}handleUpdateActions(e){for(const[t,n]of Object.entries(e)){const e=this.#M.get(t);if(e){const t=this.#_.get(e.actionId);if(t?.unsubscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(i(e),n)).catch((t=>{this.#C("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!n||n.disabled)this.#M.delete(t);else{this.#M.set(t,n);const e=this.#_.get(n.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#I({text:e,controlId:n.controlId,actionInstanceId:n.id,feedbackInstanceId:void 0})).text};Promise.resolve(e.subscribe(i(n),t)).catch((e=>{this.#C("error",`Action subscribe failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)}))}}}}async handleLearnAction(e){const t=this.#_.get(e.action.actionId);if(t&&t.learn){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},n)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#_.clear();for(const[n,i]of Object.entries(e))i&&(t.push({id:n,name:i.name,description:i.description,options:(0,r.serializeIsVisibleFn)(i.options),hasLearn:!!i.learn,learnTimeout:i.learnTimeout}),this.#_.set(n,i));this.#S({actions:t})}_getAllActions(){return Array.from(this.#M.values()).map((e=>({id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options})))}subscribeActions(e){let t=Array.from(this.#M.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.actionId))));for(const e of t){const t=this.#_.get(e.actionId);if(t?.subscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.subscribe(i(e),n)).catch((t=>{this.#C("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeActions(e){let t=Array.from(this.#M.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.actionId))));for(const e of t){const t=this.#_.get(e.actionId);if(t&&t.unsubscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(i(e),n)).catch((t=>{this.#C("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInstanceBaseProps=t.serializeIsVisibleFn=void 0,t.serializeIsVisibleFn=function(e){return(e??[]).map((e=>"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisible:void 0}:{...e,isVisibleFn:void 0}))},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},8039:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const r=n(1635),i=n(2593),a=r.__importDefault(n(7e3));function s(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#I;#O;#P;#C;#V=new Map;#A=new Map;#$=new Map;#T=new Map;#j;get parseVariablesContext(){return this.#j}constructor(e,t,n,r){this.#I=e,this.#O=t,this.#P=n,this.#C=r}getDefinitionIds(){return Array.from(this.#V.keys())}getInstanceIds(){return Array.from(this.#A.keys())}handleUpdateFeedbacks(e){for(const[t,n]of Object.entries(e)){const e=this.#A.get(t);if(e){const t=this.#V.get(e.feedbackId);if(t?.unsubscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(s(t.type,e),n)).catch((t=>{this.#C("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!n||n.disabled)this.#A.delete(t);else{this.#A.set(t,{...n,referencedVariables:null});const e=this.#V.get(n.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#I({text:e,controlId:n.controlId,actionInstanceId:void 0,feedbackInstanceId:n.id})).text};Promise.resolve(e.subscribe(s(e.type,n),t)).catch((e=>{this.#C("error",`Feedback subscribe failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)}))}this.#E(t)}}}async handleLearnFeedback(e){const t=this.#V.get(e.feedback.feedbackId);if(t&&t.learn){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},n)}}return{options:void 0}}handleVariablesChanged(e){if(!e.variablesIds.length)return;const t=new Set(e.variablesIds);for(const t of this.#T.values())for(const n of e.variablesIds)t.changedVariables.add(n);const n=new Set;for(const e of this.#A.values())if(!this.#T.has(e.id)&&e.referencedVariables)for(const r of e.referencedVariables)if(t.has(r)){n.add(e.id);break}for(const e of n)setImmediate((()=>{this.#E(e)}))}#E(e){const t=this.#T.get(e);if(t)return void(t.needsRecheck=!0);const n=this.#A.get(e);if(!n)return;const r=n,i={needsRecheck:!1,changedVariables:new Set};this.#T.set(e,i),Promise.resolve().then((async()=>{const t=this.#V.get(r.feedbackId);let n;const i=new Set;if(t){this.#j=`Feedback ${r.feedbackId} (${e})`;const a={parseVariablesInString:async t=>{const n=await this.#I({text:t,controlId:r.controlId,actionInstanceId:void 0,feedbackInstanceId:e});if(n.variableIds&&n.variableIds.length)for(const e of n.variableIds)i.add(e);return n.text}};n="boolean"===t.type?t.callback({...s("boolean",r),type:"boolean"},a):t.callback({...s("advanced",r),type:"advanced",image:r.image},a),this.#j=void 0}const a=await n;this.#$.set(e,{id:e,controlId:r.controlId,value:a}),this.#Q(),r.referencedVariables=i.size>0?Array.from(i):null})).catch((e=>{console.error(`Feedback check failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)})).finally((()=>{this.#j=void 0,this.#T.delete(e);let t=!1;if(r.referencedVariables)for(const e of r.referencedVariables)if(i.changedVariables.has(e)){t=!0;break}(t||i.needsRecheck)&&setImmediate((()=>{this.#E(e)}))}))}#Q=(0,a.default)((()=>{const e=this.#$;this.#$=new Map,e.size>0&&this.#O({values:Array.from(e.values())})}),{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#V.clear();for(const[n,r]of Object.entries(e))r&&(t.push({id:n,name:r.name,description:r.description,options:(0,i.serializeIsVisibleFn)(r.options),type:r.type,defaultStyle:"boolean"===r.type?r.defaultStyle:void 0,hasLearn:!!r.learn,learnTimeout:r.learnTimeout,showInvert:"boolean"===r.type&&r.showInvert}),this.#V.set(n,r));this.#P({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,n]of this.#A.entries())this.#V.get(n.feedbackId)&&(0===t.size||t.has(n.feedbackId))&&this.#E(e)}checkFeedbacksById(e){for(const t of e)this.#E(t)}_getAllFeedbacks(){return Array.from(this.#A.values()).map((e=>({id:e.id,feedbackId:e.feedbackId,controlId:e.controlId,options:e.options})))}subscribeFeedbacks(e){let t=Array.from(this.#A.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.feedbackId))));for(const e of t){const t=this.#V.get(e.feedbackId);if(t?.subscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.subscribe(s(t.type,e),n)).catch((t=>{this.#C("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeFeedbacks(e){let t=Array.from(this.#A.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.feedbackId))));for(const e of t){const t=this.#V.get(e.feedbackId);if(t&&t.unsubscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(s(t.type,e),n)).catch((t=>{this.#C("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},1706:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=void 0;const r=n(360);function i(e){return JSON.parse(JSON.stringify(e))}t.runThroughUpgradeScripts=function(e,t,n,a,s,o){const l=new Map,c=e=>{let t=l.get(e);return t||(t={actions:[],feedbacks:[],config:!1},l.set(e,t)),t};for(const t of Object.values(e)){const e=t?.upgradeIndex??n;t&&"number"==typeof e&&c(e).actions.push(t.id)}for(const e of Object.values(t)){const t=e?.upgradeIndex??n;e&&"number"==typeof t&&c(t).feedbacks.push(e.id)}if(!o)for(let e=n??-1;e<a.length;e++)c(e).config=!0;const u={},d={};let p;if(l.size>0){const o=Array.from(l.keys()).sort(),c=Math.min(...o,n??-1)+1,h=[],m=[],b=a.length;for(let n=c;n<b;n++){const o=l.get(n-1);o&&(h.push(...o.actions),m.push(...o.feedbacks));const c=!!o?.config;if(!c&&0===h.length&&0===m.length)continue;const b=p??s,g=(0,a[n])({currentConfig:i(b)},{config:c?b:null,actions:h.map((t=>{const n=e[t];if(n)return(0,r.literal)({id:n.id,controlId:n.controlId,actionId:n.actionId,options:void 0!==n.options?i(n.options):{}})})).filter((e=>!!e)),feedbacks:m.map((e=>{const n=t[e];if(n)return(0,r.literal)({id:n.id,controlId:n.controlId,feedbackId:n.feedbackId,options:void 0!==n.options?i(n.options):{},isInverted:n.isInverted})})).filter((e=>!!e))});c&&g.updatedConfig&&(p=g.updatedConfig);for(const t of g.updatedActions)if(t){const n=e[t.id];n&&(n.actionId=t.actionId,n.options=t.options,d[t.id]=n)}for(const e of g.updatedFeedbacks)if(e){const n=t[e.id];n&&(n.feedbackId=e.feedbackId,n.options=e.options,u[e.id]={...n,style:u[e.id]?.style??e.style,isInverted:e.isInverted??!1})}}for(const[t,n]of Object.entries(e))d[t]||"number"!=typeof n?.upgradeIndex||(d[t]=n);for(const[e,n]of Object.entries(t))u[e]||"number"!=typeof n?.upgradeIndex||(u[e]=n)}return{updatedActions:d,updatedFeedbacks:u,updatedConfig:p}}},9077:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=void 0;const r=n(1635).__importDefault(n(7281));t.validateManifest=function(e){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'");if(!(0,r.default)(e)){const e=r.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}}},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1649:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const r=n(1635),i=n(360),a=r.__importDefault(n(3290)),s=n(2593),o=n(1706),l=n(8039),c=n(4044),u=n(4289),d=n(2365);t.InstanceBase=class{#q;#G;id;#F=new a.default({concurrency:1});#D=!1;#R=!1;#U={};#B;#L;#H=new Map;#W=new Map;#J=new Map;#n;#z;get instanceOptions(){return this.#n}get label(){return this.#z}constructor(e){if(!(0,s.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#n={disableVariableValidation:!1},this.#q=new c.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:this._handleVariablesChanged.bind(this),sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},(e=>{process.send(e)}),5e3),process.on("message",(e=>{this.#q.receivedMessage(e)})),this.#B=new u.ActionManager((async e=>this.#q.sendWithCb("parseVariablesInString",e)),(e=>this.#q.sendWithNoCb("setActionDefinitions",e)),this.log.bind(this)),this.#L=new l.FeedbackManager((async e=>this.#q.sendWithCb("parseVariablesInString",e)),(e=>this.#q.sendWithNoCb("updateFeedbackValues",e)),(e=>this.#q.sendWithNoCb("setFeedbackDefinitions",e)),this.log.bind(this)),this.#G=e.upgradeScripts,this.id=e.id,this.#z=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#F.add((async()=>{if(this.#D)throw new Error("Already initialized");const t=e.actions,n=e.feedbacks;if(this.#U=e.config,this.#z=e.label,e.isFirstInit){const t={},n=this.getConfigFields();for(const e of n)"default"in e&&(t[e.id]=e.default);this.#U=t,this.saveConfig(this.#U),e.lastUpgradeIndex=this.#G.length-1}const{updatedActions:r,updatedFeedbacks:i,updatedConfig:a}=(0,o.runThroughUpgradeScripts)(t,n,e.lastUpgradeIndex,this.#G,this.#U,!1);this.#U=a??this.#U;const s=this.#q.sendWithCb("upgradedItems",{updatedActions:r,updatedFeedbacks:i});try{await this.init(this.#U,!!e.isFirstInit),this.#D=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}finally{await s}return setImmediate((()=>{this._handleUpdateActions({actions:t},!0).catch((e=>{this.log("error",`Receive actions failed: ${e}`)})),this._handleUpdateFeedbacks({feedbacks:n},!0).catch((e=>{this.log("error",`Receive feedbacks failed: ${e}`)}))})),{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#G.length-1,updatedConfig:this.#U}}))}async _handleDestroy(){await this.#F.add((async()=>{if(!this.#D)throw new Error("Not initialized");await this.destroy(),this.#D=!1}))}async _handleConfigUpdateAndLabel(e){await this.#F.add((async()=>{if(!this.#D)throw new Error("Not initialized");this.#z=e.label,this.#U=e.config,await this.configUpdated(this.#U)}))}async _handleExecuteAction(e){return this.#B.handleExecuteAction(e)}async _handleUpdateFeedbacks(e,t){if(!t){const t=(0,o.runThroughUpgradeScripts)({},e.feedbacks,null,this.#G,this.#U,!0);this.#q.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded feedbacks: ${e}`)}))}this.#L.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e,t){if(!t){const t=(0,o.runThroughUpgradeScripts)(e.actions,{},null,this.#G,this.#U,!0);this.#q.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded actions: ${e}`)}))}this.#B.handleUpdateActions(e.actions)}async _handleGetConfigFields(e){return{fields:(0,s.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#B.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#L.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#R)return}else if(!this.#R)return;if(!this.handleStartStopRecordActions)throw this.#R=!1,new Error("Recording actions is not supported by this module!");this.#R=e.recording,this.handleStartStopRecordActions(this.#R)}async _handleVariablesChanged(e){this.#L.handleVariablesChanged(e)}async _handleSharedUdpSocketMessage(e){for(const t of this.#H.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#H.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e){this.#U=e,this.#q.sendWithNoCb("saveConfig",{config:e})}setActionDefinitions(e){this.#B.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#L.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[n,r]of Object.entries(e))r&&t.push({...r,id:n});this.#q.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],n=[];this.#W.clear();for(const r of e)t.push({id:r.variableId,name:r.name}),this.#W.set(r.variableId,r),this.#J.has(r.variableId)||(this.#J.set(r.variableId,""),n.push({id:r.variableId,value:""}));if(!this.#n.disableVariableValidation){const e=new Set(this.#W.keys());for(const t of this.#J.keys())e.has(t)||(this.#J.delete(t),n.push({id:t,value:void 0}))}this.#q.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:n})}setVariableValues(e){const t=[];for(const[n,r]of Object.entries(e))this.#n.disableVariableValidation?(void 0===r?this.#J.delete(n):this.#J.set(n,r),t.push({id:n,value:r})):this.#W.has(n)?(this.#J.set(n,r??""),t.push({id:n,value:r??""})):t.push({id:n,value:void 0});this.#q.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#J.get(e)}async parseVariablesInString(e){const t=this.#L.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),(await this.#q.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text}checkFeedbacks(...e){this.#L.checkFeedbacks(e)}checkFeedbacksById(...e){this.#L.checkFeedbacksById(e)}_getAllActions(){return this.#B._getAllActions()}subscribeActions(...e){this.#B.subscribeActions(e)}unsubscribeActions(...e){this.#B.unsubscribeActions(e)}_getAllFeedbacks(){return this.#L._getAllFeedbacks()}subscribeFeedbacks(...e){this.#L.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#L.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#R)throw new Error("Not currently recording actions");this.#q.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}setCustomVariableValue(e,t){this.#q.sendWithNoCb("setCustomVariable",{customVariableId:e,value:t})}oscSend(e,t,n,r){this.#q.sendWithNoCb("send-osc",(0,i.literal)({host:e,port:t,path:n,args:r}))}updateStatus(e,t){this.#q.sendWithNoCb("set-status",(0,i.literal)({status:e,message:t??null}))}log(e,t){this.#q.sendWithNoCb("log-message",(0,i.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const n="string"==typeof e?{type:e}:e,r=new d.SharedUdpSocketImpl(this.#q,this.#H,n);return t&&r.on("message",t),r}}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1400:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(n||(t.InstanceStatus=n={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(r||(t.Regex=r={}))},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2018:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1635);r.__exportStar(n(3730),t),r.__exportStar(n(1649),t),r.__exportStar(n(7386),t),r.__exportStar(n(1400),t),r.__exportStar(n(8983),t),r.__exportStar(n(8104),t),r.__exportStar(n(3258),t),r.__exportStar(n(131),t),r.__exportStar(n(3371),t),r.__exportStar(n(9786),t),r.__exportStar(n(6132),t)},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2365:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const r=n(1635).__importDefault(n(228)),i=n(360);class a extends r.default{#q;#X;#n;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#b&&"object"==typeof this.#b?this.#b:void 0}#b="pending";constructor(e,t,n){super(),this.#q=e,this.#X=t,this.#n={...n}}bind(e,t,n){if(this.#b&&"object"==typeof this.#b)throw new Error("Socket is already bound");switch(this.#b){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,i.assertNever)(this.#b),new Error("Invalid socket state")}this.#b="binding",n&&this.on("listening",n),this.#q.sendWithCb("sharedUdpSocketJoin",{family:this.#n.type,portNumber:e}).then((t=>{this.#b={portNumber:e,handleId:t},this.#X.set(t,this),this.emit("listening")}),(e=>{this.#b="closed",this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}close(e){if(this.#b&&"object"==typeof this.#b);else switch(this.#b){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,i.assertNever)(this.#b),new Error("Invalid socket state")}const t=this.#b.handleId;this.#b="closed",e&&this.on("close",e),this.#q.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then((()=>{this.#X.delete(t),this.emit("close")}),(e=>{this.#X.delete(t),this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}send(e,t,n,r,i,a){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof n){if("number"!=typeof r||"string"!=typeof i)throw new Error("Invalid arguments");if(void 0!==a&&"number"!=typeof a)throw new Error("Invalid arguments");const s=this.#Y(e,t,n);this.#Z(s,r,i,a)}else{if("string"!=typeof n)throw new Error("Invalid arguments");{if(void 0!==r&&"function"!=typeof r)throw new Error("Invalid arguments");const i=this.#Y(e,0,void 0);this.#Z(i,t,n,r)}}}#Y(e,t,n){let r;if("string"==typeof e)r=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))r=e;else{if(Array.isArray(e))return Buffer.from(e);r=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return r.subarray(t,void 0!==n?n+t:void 0)}#Z(e,t,n,r){if(!this.#b||"object"!=typeof this.#b)throw new Error("Socket is not open");this.#q.sendWithCb("sharedUdpSocketSend",{handleId:this.#b.handleId,message:e,address:n,port:t}).then((()=>{r?.()}),(e=>{this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#b="fatalError";const t=this.boundState;t&&this.#X.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=a},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=t.CreateConvertToBooleanFeedbackUpgradeScript=t.EmptyUpgradeScript=void 0,t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}),t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,n)=>{const r=[];for(const t of n.feedbacks){let n=e[t.feedbackId];if(!0===n&&(n={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),n){t.style||(t.style={});for(const[e,i]of Object.entries(n))void 0!==t.options[e]&&(t.style[i]=t.options[e],delete t.options[e],r.push(t))}}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:r}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,n)=>{const r=[];for(const t of n.feedbacks){const n=e[t.feedbackId];if("string"!=typeof n)continue;const i=t.options[n];void 0!==i&&(delete t.options[n],t.isInverted="true"===i||!0===i||Number(i)>0,r.push(t))}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:r}}}},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},360:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.assertNever=t.literal=void 0;const r=n(6284);function i(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,r.colord)(e).isValid()){const t=(0,r.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,n,r){let i=(255&e)<<16|(255&t)<<8|255&n;return r&&r>=0&&r<1&&(i+=16777216*Math.round(255*(1-r))),i},t.splitRgb=i,t.splitHsl=function(e){const t=i(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=i(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=i(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()}},7281:(e,t,n)=>{"use strict";e.exports=l,e.exports.default=l;const r={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"}},required:["name"]}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18"},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}},additionalProperties:!1}},additionalProperties:!1,required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1}}},i={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1},a=Object.prototype.hasOwnProperty,s=n(7169).A,o=new RegExp("","u");function l(e,{instancePath:t="",parentData:n,parentDataProperty:c,rootData:u=e}={}){let d=null,p=0;if(0===p){if(!e||"object"!=typeof e||Array.isArray(e))return l.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let n;if(void 0===e.id&&(n="id")||void 0===e.name&&(n="name")||void 0===e.shortname&&(n="shortname")||void 0===e.description&&(n="description")||void 0===e.version&&(n="version")||void 0===e.license&&(n="license")||void 0===e.repository&&(n="repository")||void 0===e.bugs&&(n="bugs")||void 0===e.maintainers&&(n="maintainers")||void 0===e.legacyIds&&(n="legacyIds")||void 0===e.runtime&&(n="runtime")||void 0===e.manufacturer&&(n="manufacturer")||void 0===e.products&&(n="products")||void 0===e.keywords&&(n="keywords"))return l.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"}],!1;{const n=p;for(const n in e)if(!a.call(r.properties,n))return l.errors=[{instancePath:t,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"}],!1;if(n===p){if(void 0!==e.$schema){const n=p;if("string"!=typeof e.$schema)return l.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var h=n===p}else h=!0;if(h){if(void 0!==e.id){const n=p;if("string"!=typeof e.id)return l.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.name){const n=p;if("string"!=typeof e.name)return l.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.shortname){const n=p;if("string"!=typeof e.shortname)return l.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.description){const n=p;if("string"!=typeof e.description)return l.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.version){const n=p;if("string"!=typeof e.version)return l.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.license){const n=p;if("string"!=typeof e.license)return l.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.repository){const n=p;if("string"!=typeof e.repository)return l.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.bugs){const n=p;if("string"!=typeof e.bugs)return l.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.maintainers){let n=e.maintainers;const r=p;if(p===r){if(!Array.isArray(n))return l.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var m=!0;const e=n.length;for(let r=0;r<e;r++){let e=n[r];const i=p;if(p===i){if(!e||"object"!=typeof e||Array.isArray(e))return l.errors=[{instancePath:t+"/maintainers/"+r,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let n;if(void 0===e.name&&(n="name"))return l.errors=[{instancePath:t+"/maintainers/"+r,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"}],!1;if(void 0!==e.name){const n=p;if("string"!=typeof e.name)return l.errors=[{instancePath:t+"/maintainers/"+r+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var b=n===p}else b=!0;if(b){if(void 0!==e.email){const n=p;if("string"!=typeof e.email)return l.errors=[{instancePath:t+"/maintainers/"+r+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=n===p}else b=!0;if(b)if(void 0!==e.github){const n=p;if("string"!=typeof e.github)return l.errors=[{instancePath:t+"/maintainers/"+r+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=n===p}else b=!0}}}if(!(m=i===p))break}if(m){let e,r=n.length;if(r>1)for(;r--;)for(e=r;e--;)if(s(n[r],n[e]))return l.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1}}}h=r===p}else h=!0;if(h){if(void 0!==e.legacyIds){let n=e.legacyIds;const r=p;if(p===r){if(!Array.isArray(n))return l.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var g=!0;const e=n.length;for(let r=0;r<e;r++){const e=p;if("string"!=typeof n[r])return l.errors=[{instancePath:t+"/legacyIds/"+r,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(g=e===p))break}if(g){let e,r=n.length;if(r>1){const i={};for(;r--;){let a=n[r];if("string"==typeof a){if("number"==typeof i[a])return e=i[a],l.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;i[a]=r}}}}}}h=r===p}else h=!0;if(h){if(void 0!==e.runtime){let n=e.runtime;const i=p;if(p===i){if(!n||"object"!=typeof n||Array.isArray(n))return l.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===n.type&&(e="type")||void 0===n.api&&(e="api")||void 0===n.apiVersion&&(e="apiVersion")||void 0===n.entrypoint&&(e="entrypoint"))return l.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==n.type){const e=p;if("string"!=typeof n.type)return l.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=e===p}else f=!0;if(f){if(void 0!==n.api){let e=n.api;const i=p;if("string"!=typeof e)return l.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return l.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:r.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;f=i===p}else f=!0;if(f){if(void 0!==n.apiVersion){const e=p;if("string"!=typeof n.apiVersion)return l.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=e===p}else f=!0;if(f)if(void 0!==n.entrypoint){const e=p;if("string"!=typeof n.entrypoint)return l.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=e===p}else f=!0}}}}h=i===p}else h=!0;if(h){if(void 0!==e.manufacturer){const n=p;if("string"!=typeof e.manufacturer)return l.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=n===p}else h=!0;if(h){if(void 0!==e.products){let n=e.products;const r=p;if(p===r){if(!Array.isArray(n))return l.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(n.length<1)return l.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var y=!0;const e=n.length;for(let r=0;r<e;r++){const e=p;if("string"!=typeof n[r])return l.errors=[{instancePath:t+"/products/"+r,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(y=e===p))break}if(y){let e,r=n.length;if(r>1){const i={};for(;r--;){let a=n[r];if("string"==typeof a){if("number"==typeof i[a])return e=i[a],l.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;i[a]=r}}}}}}h=r===p}else h=!0;if(h){if(void 0!==e.keywords){let n=e.keywords;const r=p;if(p===r){if(!Array.isArray(n))return l.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var v=!0;const e=n.length;for(let r=0;r<e;r++){const e=p;if("string"!=typeof n[r])return l.errors=[{instancePath:t+"/keywords/"+r,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(v=e===p))break}if(v){let e,r=n.length;if(r>1){const i={};for(;r--;){let a=n[r];if("string"==typeof a){if("number"==typeof i[a])return e=i[a],l.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;i[a]=r}}}}}}h=r===p}else h=!0;if(h)if(void 0!==e.bonjourQueries){let n=e.bonjourQueries;const r=p;if(p===r){if(!n||"object"!=typeof n||Array.isArray(n))return l.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const e=p;for(const e in n)if(!o.test(e))return l.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"}],!1;if(e===p)for(const e in n)if(o.test(e)){let r=n[e];const a=p,s=p;let c=!1,u=null;const h=p;if(p==p)if(r&&"object"==typeof r&&!Array.isArray(r)){let n;if(void 0===r.type&&(n="type")||void 0===r.protocol&&(n="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"};null===d?d=[r]:d.push(r),p++}else{const n=p;for(const n in r)if("type"!==n&&"protocol"!==n&&"txt"!==n){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"};null===d?d=[r]:d.push(r),p++;break}if(n===p){if(void 0!==r.type){const n=p;if("string"!=typeof r.type){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),p++}var w=n===p}else w=!0;if(w){if(void 0!==r.protocol){let n=r.protocol;const a=p;if("string"!=typeof n){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),p++}if("tcp"!==n&&"udp"!==n){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===d?d=[n]:d.push(n),p++}w=a===p}else w=!0;if(w)if(void 0!==r.txt){let n=r.txt;const i=p;if(p===i)if(n&&"object"==typeof n&&!Array.isArray(n)){const r=p;for(const r in n)if(!o.test(r)){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===d?d=[n]:d.push(n),p++;break}if(r===p)for(const r in n)if(o.test(r)){const i=p;if("string"!=typeof n[r]){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),p++}if(i!==p)break}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[n]:d.push(n),p++}w=i===p}else w=!0}}}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[n]:d.push(n),p++}h===p&&(c=!0,u=0);const m=p;if(p===m)if(Array.isArray(r)){const n=r.length;for(let a=0;a<n;a++){let n=r[a];const s=p;if(p==p)if(n&&"object"==typeof n&&!Array.isArray(n)){let r;if(void 0===n.type&&(r="type")||void 0===n.protocol&&(r="protocol")){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===d?d=[n]:d.push(n),p++}else{const r=p;for(const r in n)if("type"!==r&&"protocol"!==r&&"txt"!==r){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a,schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===d?d=[n]:d.push(n),p++;break}if(r===p){if(void 0!==n.type){const r=p;if("string"!=typeof n.type){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),p++}var k=r===p}else k=!0;if(k){if(void 0!==n.protocol){let r=n.protocol;const s=p;if("string"!=typeof r){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),p++}if("tcp"!==r&&"udp"!==r){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===d?d=[n]:d.push(n),p++}k=s===p}else k=!0;if(k)if(void 0!==n.txt){let r=n.txt;const i=p;if(p===i)if(r&&"object"==typeof r&&!Array.isArray(r)){const n=p;for(const n in r)if(!o.test(n)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"};null===d?d=[r]:d.push(r),p++;break}if(n===p)for(const n in r)if(o.test(n)){const i=p;if("string"!=typeof r[n]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a+"/txt/"+n.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),p++}if(i!==p)break}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[n]:d.push(n),p++}k=i===p}else k=!0}}}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+a,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[n]:d.push(n),p++}if(s!==p)break}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===d?d=[n]:d.push(n),p++}var N;if((N=m===p)&&c?(c=!1,u=[u,1]):N&&(c=!0,u=1),!c){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:u},message:"must match exactly one schema in oneOf"};return null===d?d=[n]:d.push(n),p++,l.errors=d,!1}if(p=s,null!==d&&(s?d.length=s:d=null),a!==p)break}}}h=r===p}else h=!0}}}}}}}}}}}}}}}}}}return l.errors=d,0===p}},7e3:(e,t,n)=>{"use strict";const r=n(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:n=0,maxWait:i=0,before:a=!1,after:s=!0}=t;if(!a&&!s)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let o,l,c;const u=function(...t){const r=this,u=a&&!o;return clearTimeout(o),o=setTimeout((()=>{o=void 0,l&&(clearTimeout(l),l=void 0),s&&(c=e.apply(r,t))}),n),i>0&&!l&&s&&(l=setTimeout((()=>{l=void 0,o&&(clearTimeout(o),o=void 0),c=e.apply(r,t)}),i)),u&&(c=e.apply(r,t)),c};return r(u,e),u.cancel=()=>{o&&(clearTimeout(o),o=void 0),l&&(clearTimeout(l),l=void 0)},u}},1635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>T,__assign:()=>a,__asyncDelegator:()=>S,__asyncGenerator:()=>I,__asyncValues:()=>C,__await:()=>x,__awaiter:()=>m,__classPrivateFieldGet:()=>V,__classPrivateFieldIn:()=>$,__classPrivateFieldSet:()=>A,__createBinding:()=>g,__decorate:()=>o,__disposeResources:()=>E,__esDecorate:()=>c,__exportStar:()=>f,__extends:()=>i,__generator:()=>b,__importDefault:()=>P,__importStar:()=>O,__makeTemplateObject:()=>_,__metadata:()=>h,__param:()=>l,__propKey:()=>d,__read:()=>v,__rest:()=>s,__runInitializers:()=>u,__setFunctionName:()=>p,__spread:()=>w,__spreadArray:()=>N,__spreadArrays:()=>k,__values:()=>y,default:()=>Q});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function o(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s}function l(e,t){return function(n,r){t(n,r,e)}}function c(e,t,n,r,i,a){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=r.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?r.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),p=!1,h=n.length-1;h>=0;h--){var m={};for(var b in r)m[b]="access"===b?{}:r[b];for(var b in r.access)m.access[b]=r.access[b];m.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(s(e||null))};var g=(0,n[h])("accessor"===l?{get:d.get,set:d.set}:d[c],m);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(o=s(g.get))&&(d.get=o),(o=s(g.set))&&(d.set=o),(o=s(g.init))&&i.unshift(o)}else(o=s(g))&&("field"===l?i.unshift(o):d[c]=o)}u&&Object.defineProperty(u,r.name,d),p=!0}function u(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))}function b(e,t){var n,r,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}var g=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function f(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return s}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function k(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,i++)r[i]=a[s];return r}function N(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function x(e){return this instanceof x?(this.v=e,this):new x(e)}function I(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),r[Symbol.asyncIterator]=function(){return this},r;function s(e,t){i[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||o(e,t)}))},t&&(r[e]=t(r[e])))}function o(e,t){try{(n=i[e](t)).value instanceof x?Promise.resolve(n.value.v).then(l,c):u(a[0][2],n)}catch(e){u(a[0][3],e)}var n}function l(e){o("next",e)}function c(e){o("throw",e)}function u(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function S(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:x(e[r](t)),done:!1}:i?i(t):t}:i}}function C(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=y(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var M=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return M(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function V(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function A(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function $(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function T(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var j="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function E(e){function t(t){e.error=e.hasError?new j(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var n,r=0;return function i(){for(;n=e.stack.pop();)try{if(!n.async&&1===r)return r=0,e.stack.push(n),Promise.resolve().then(i);if(n.dispose){var a=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(a).then(i,(function(e){return t(e),i()}))}else r|=1}catch(e){t(e)}if(1===r)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}const Q={__extends:i,__assign:a,__rest:s,__decorate:o,__param:l,__metadata:h,__awaiter:m,__generator:b,__createBinding:g,__exportStar:f,__values:y,__read:v,__spread:w,__spreadArrays:k,__spreadArray:N,__await:x,__asyncGenerator:I,__asyncDelegator:S,__asyncValues:C,__makeTemplateObject:_,__importStar:O,__importDefault:P,__classPrivateFieldGet:V,__classPrivateFieldSet:A,__classPrivateFieldIn:$,__addDisposableResource:T,__disposeResources:E}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const{InstanceBase:r,runEntrypoint:i,InstanceStatus:a}=n(6278),s=n(3487),o=n(9367),l=n(8404),c=n(7969),u=n(8384),d=n(888),p=n(2433),h=n(8094),m=n(9227),b=n(2561),{MaxChannelCount:g,GroupCount:f,MatrixCount:y,MatrixSize:v,cmd:w,duganChannels:k,msgDelay:N}=n(1586);i(class extends r{constructor(e){super(e),Object.assign(this,{...u,...h,...m,...b,...d}),this.keepAliveTimer={},this.timeOutTimer={},this.cmdTimer={},this.cmdQueue=[],this.meterTimer={},this.clearToTx=!0}async init(e){this.updateStatus(a.Connecting),this.config=e,this.initVariables(),this.updateActions(),this.updateFeedbacks(),this.updateVariableDefinitions(),this.setVariableValues(p),this.setIterativeVariables(),this.initTCP(),this.cmdTimer=setTimeout((()=>{this.processCmdQueue()}),N[this.config.rate])}async destroy(){this.log("debug",`destroy. ID: ${this.id}`),clearTimeout(this.keepAliveTimer),clearTimeout(this.cmdTimer),clearTimeout(this.meterTimer),clearTimeout(this.timeOutTimer),this.keepAliveTimer=null,this.cmdTimer=null,this.meterTimer=null,this.timeOutTimer=null,this.socket?(await this.sendCommand(w.system.endSession),this.socket.destroy()):this.udp&&this.udp.destroy(),this.updateStatus(a.Disconnected)}setIterativeVariables(){let e=[];for(let t=1;t<=g;t++)e[`channelName${t}`]=this.channelsName[t],e[`channelWeight${t}`]=this.channelsWeight[t],e[`channelAmixGain${t}`]=this.channelsAmixGain[t],e[`channelInputLevel${t}`]=this.channelsInputPeak[t],e[`channelOutputLevel${t}`]=this.channelsOutputPeak[t];for(let t=1;t<=y;t++){e[`matrixOutFader${t}`]=this.matrixOutput[t],e[`matrixOutLevel${t}`]=this.matrixOutputPeak[t];for(let n=1;n<=v;n++)e[`matrix${t}Xpoint${n}`]=this.matrixXpoint[t][n]}for(let t=1;t<=f;t++)e[`groupNOM${t}`]=this.groupNOMgainlimit[t],e[`groupNOMpeak${t}`]=this.groupNOMpeak[t],e[`groupAD${t}`]=this.groupAutomixDepth[t],e[`groupMST${t}`]=this.groupMusicThreshold[t],e[`groupMSTgain${t}`]=this.groupMusicPeak[t];this.setVariableValues(e)}initVariables(){this.log("debug","initVariables"),this.groupCount=f,this.matrixCount=y,this.musicInputs=[],this.matrixSources=[],this.matrixDestinations=[],this.channelNames=[],this.matrixNames=[],this.groupNames=[],this.clockSources=[],this.offsetChannelList=[],this.sceneList=[],this.sceneChanged=!1,this.matrixDestinations.push({id:0,label:"No Output"}),1==this.config.channels&&(this.config.channels=k[this.config.model]);for(let e=1;e<=this.config.channels;e++)this.matrixSources.push({id:e,label:`Automix Channel ${e}`}),this.channelNames.push({id:e,label:`Automix Channel ${e}`});if(11==this.config.model){for(let e=1;e<=32;e++)this.musicInputs.push({id:e,label:`MADI Input ${e}`});for(let e=1;e<=g;e++)this.matrixSources.push({id:e+g,label:`MADI Input ${e}`}),this.matrixDestinations.push({id:e,label:`MADI Output ${e}`});this.clockSources.push({id:0,label:"Madi"});for(let e=1;e<=g-this.config.channels+1;e++)this.offsetChannelList.push({id:e,label:`Madi Input ${e}`})}else{for(let e=1;e<=32;e++)this.musicInputs.push({id:e,label:"Dante Input "+e});for(let e=1;e<=g;e++)this.matrixSources.push({id:e+g,label:`Dante Input ${e}`}),this.matrixDestinations.push({id:e,label:`Dante Output ${e}`});this.clockSources.push({id:0,label:"Dante"});for(let e=1;e<=g-this.config.channels+1;e++)this.offsetChannelList.push({id:e,label:`Dante Input ${e}`})}this.clockSources.push({id:1,label:"Word Clock"}),this.clockSources.push({id:2,label:"Internal"}),this.clockSources.push({id:3,label:"ADAT"});for(let e=1;e<=8;e++)this.musicInputs.push({id:e+g,label:`ADAT Input ${e}`}),this.matrixSources.push({id:e+2*g,label:`ADAT Input ${e}`}),this.matrixDestinations.push({id:e+g,label:`ADAT Output ${e}`});for(let e=81;e<=86;e++)this.musicInputs.push({id:e,label:"Mix Bus "+(e-80)});this.matrixGain=[],this.matrixMute=[],this.matrixPolarity=[],this.matrixXpoint=[],this.matrixOutputPeak=[],this.matrixOutput=[];for(let e=1;e<=this.matrixCount;e++)this.matrixNames.push({id:e,label:`Matrix Bus ${e}`});for(let e=0;e<=this.matrixCount;e++){this.matrixGain[e]=0,this.matrixMute[e]=0,this.matrixPolarity[e]=0,this.matrixXpoint[e]=[],this.matrixOutputPeak[e]=-127.5,this.matrixOutput[e]=0;for(let t=0;t<=v;t++)this.matrixXpoint[e][t]=-96}this.groupNames.push({id:1,label:"Group A"}),this.groupNames.push({id:2,label:"Group B"}),this.groupNames.push({id:3,label:"Group C"}),this.groupAutomixDepth=[],this.groupMusicThreshold=[],this.groupNOMgainlimit=[],this.groupMute=[],this.groupPreset=[],this.groupOverride=[],this.groupLastHold=[],this.groupNOMpeak=[],this.groupMusicPeak=[],this.groupMusicInput=[];for(let e=0;e<=this.groupCount;e++)this.groupAutomixDepth[e]=-15,this.groupMusicThreshold[e]=-10,this.groupNOMgainlimit[e]=1,this.groupMute[e]=0,this.groupPreset[e]=0,this.groupOverride[e]=0,this.groupLastHold[e]=0,this.groupNOMpeak[e]=0,this.groupMusicPeak[e]=0,this.groupMusicInput[e]=0;this.channelsMode=[],this.channelsPreset=[],this.channelsBypass=[],this.channelsOverride=[],this.channelsWeight=[],this.channelsNom=[],this.channelsMusic=[],this.channelsName=[],this.channelsGroupAssign=[],this.channelsAmixGain=[],this.channelsPresence=[],this.channelsClip=[],this.channelsInputPeak=[],this.channelsOutputPeak=[];for(let e=0;e<=this.config.channels;e++)this.channelsMode[e]=1,this.channelsPreset[e]=1,this.channelsBypass[e]=0,this.channelsOverride[e]=0,this.channelsWeight[e]=0,this.channelsNom[e]=0,this.channelsMusic[e]=0,this.channelsName[e]=`Channel ${e}`,this.channelsGroupAssign[e]=1,this.channelsAmixGain[e]=-127.5,this.channelsPresence[e]=!1,this.channelsClip[e]=!1,this.channelsInputPeak[e]=-127.5,this.channelsOutputPeak[e]=-127.5}handleStartStopRecordActions(e){this.isRecordingActions=e}updateActions(){o(this)}updateFeedbacks(){l(this)}updateVariableDefinitions(){c(this)}},s)})();