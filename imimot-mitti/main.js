(()=>{var e={7169:(e,t,r)=>{"use strict";const n=r(2017);n.code='require("ajv/dist/runtime/equal").default',t.A=n},141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CiaoService=t.InternalServiceEvent=t.ServiceEvent=t.ServiceState=t.ServiceType=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(6672)),o=r(4434),a=n.__importDefault(r(9278)),c=r(1360),u=r(4495),l=r(6343),d=r(482),h=r(8225),p=r(1576),f=r(5231),m=r(8318),g=r(8937),y=r(7585),b=n.__importStar(r(9152)),v=r(9152),w=(0,i.default)("ciao:CiaoService"),C=/^(.*) \((\d+)\)$/,_=/^(.*)-\((\d+)\)(\.\w{2,}.)$/;var S,E,A,I;!function(e){e.AIRDROP="airdrop",e.AIRPLAY="airplay",e.AIRPORT="airport",e.COMPANION_LINK="companion-link",e.DACP="dacp",e.HAP="hap",e.HOMEKIT="homekit",e.HTTP="http",e.HTTP_ALT="http_alt",e.IPP="ipp",e.IPPS="ipps",e.RAOP="raop",e.scanner="scanner",e.TOUCH_ABLE="touch-able",e.DNS_SD="dns-sd",e.PRINTER="printer"}(S||(t.ServiceType=S={})),function(e){e.UNANNOUNCED="unannounced",e.PROBING="probing",e.PROBED="probed",e.ANNOUNCING="announcing",e.ANNOUNCED="announced"}(E||(t.ServiceState=E={})),function(e){e.NAME_CHANGED="name-change",e.HOSTNAME_CHANGED="hostname-change"}(A||(t.ServiceEvent=A={})),function(e){e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.REPUBLISH="republish",e.RECORD_UPDATE="records-update",e.RECORD_UPDATE_ON_INTERFACE="records-update-interface"}(I||(t.InternalServiceEvent=I={}));class k extends o.EventEmitter{constructor(e,t){if(super(),this.serviceState="unannounced",this.destroyed=!1,(0,s.default)(e,"networkManager is required"),(0,s.default)(t,"parameters options is required"),(0,s.default)(t.name,"service options parameter 'name' is required"),(0,s.default)(t.type,"service options parameter 'type' is required"),(0,s.default)(t.type.length<=15,"service options parameter 'type' must not be longer than 15 characters"),this.networkManager=e,this.name=t.name,this.type=t.type,this.subTypes=t.subtypes,this.protocol=t.protocol||"tcp",this.serviceDomain=t.domain||"local",this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,y.dnsLowerCase)(this.fqdn),this.typePTR=b.stringify({type:this.type,protocol:this.protocol,domain:this.serviceDomain}),this.loweredTypePTR=(0,y.dnsLowerCase)(this.typePTR),this.subTypes&&(this.subTypePTRs=this.subTypes.map((e=>b.stringify({subtype:e,type:this.type,protocol:this.protocol,domain:this.serviceDomain}))).map(y.dnsLowerCase)),this.hostname=b.formatHostname(t.hostname||this.name,this.serviceDomain).replace(/ /g,"-"),this.loweredHostname=(0,y.dnsLowerCase)(this.hostname),this.port=t.port,t.restrictedAddresses){(0,s.default)(t.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!"),this.restrictedAddresses=new Map;for(const e of t.restrictedAddresses)if(a.default.isIP(e)){if("0.0.0.0"===e||"::"===e)throw new Error(`[${this.fqdn}] Unspecified ip address (${e}) cannot be used to restrict on to!`);const t=g.NetworkManager.resolveInterface(e);if(!t)throw new Error(`[${this.fqdn}] Could not restrict service to address ${e} as we could not resolve it to an interface name!`);const r=this.restrictedAddresses.get(t);r?r.length&&!r.includes(e)&&r.push(e):this.restrictedAddresses.set(t,[e])}else this.restrictedAddresses.set(e,[])}this.disableIpv6=t.disabledIpv6,this.txt=t.txt?k.txtBuffersFromRecord(t.txt):[],this.incrementName(!0)}advertise(){return(0,s.default)(!this.destroyed,"Cannot publish destroyed service!"),(0,s.default)(this.port,"Service port must be defined before advertising the service on the network!"),0===this.listeners("name-change").length&&w("[%s] WARN: No listeners found for a potential name change on the 'name-change' event!",this.name),new Promise(((e,t)=>{this.emit("publish",(r=>r?t(r):e()))}))}end(){return(0,s.default)(!this.destroyed,"Cannot end destroyed service!"),"unannounced"===this.serviceState?Promise.resolve():new Promise(((e,t)=>{this.emit("unpublish",(r=>r?t(r):e()))}))}async destroy(){await this.end(),this.destroyed=!0,this.removeAllListeners()}getFQDN(){return this.fqdn}getTypePTR(){return this.typePTR}getLowerCasedSubtypePTRs(){return this.subTypePTRs}getHostname(){return this.hostname}getPort(){return this.port||-1}getTXT(){return this.txt}getLowerCasedFQDN(){return this.loweredFqdn}getLowerCasedTypePTR(){return this.loweredTypePTR}getLowerCasedHostname(){return this.loweredHostname}updateTxt(e,t=!1){if((0,s.default)(!this.destroyed,"Cannot update destroyed service!"),(0,s.default)(e,"txt cannot be undefined"),this.txt=k.txtBuffersFromRecord(e),w("[%s] Updating txt record%s...",this.name,t?" silently":""),"announcing"===this.serviceState){if(this.rebuildServiceRecords(),t)return;this.currentAnnouncer.hasSentLastAnnouncement()&&this.currentAnnouncer.awaitAnnouncement().then((()=>{this.queueTxtUpdate()}))}else if("announced"===this.serviceState){if(this.rebuildServiceRecords(),t)return;this.queueTxtUpdate()}}queueTxtUpdate(){this.txtTimer||(this.txtTimer=setTimeout((()=>{this.txtTimer=void 0,"announced"===this.serviceState&&this.emit("records-update",{answers:[this.txtRecord()],additionals:[this.serviceNSECRecord()]})}),50))}updatePort(e){(0,s.default)("unannounced"===this.serviceState,"Port number cannot be changed when service is already advertised!"),this.port=e}updateName(e){return"unannounced"===this.serviceState?(this.name=e,this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,y.dnsLowerCase)(this.fqdn),Promise.resolve()):this.end().then((()=>(this.name=e,this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,y.dnsLowerCase)(this.fqdn),this.advertise())))}static txtBuffersFromRecord(e){const t=[];return Object.entries(e).forEach((([e,r])=>{const n=e+"="+r;t.push(Buffer.from(n))})),t}handleNetworkInterfaceUpdate(e){(0,s.default)(!this.destroyed,"Cannot update network of destroyed service!"),"announced"===this.serviceState?(this.rebuildServiceRecords(),(e.added||e.changes)&&this.emit("republish",(e=>{e&&(console.log("FATAL Error occurred trying to re-announce service "+this.fqdn+"! We can't recover from this!"),console.log(e.stack),process.exit(1))}))):"announcing"===this.serviceState&&(this.rebuildServiceRecords(),this.currentAnnouncer.hasSentLastAnnouncement()&&this.currentAnnouncer.awaitAnnouncement().then((()=>{this.handleNetworkInterfaceUpdate(e)})))}incrementName(e){if("unannounced"!==this.serviceState)throw new Error("Service name can only be incremented when in state UNANNOUNCED!");const t=this.name,r=this.hostname;let n,i,o,a,c;const u=this.name.match(C);u?(n=u[1],i=parseInt(u[2]),(0,s.default)(i,`Failed to extract name number from ${this.name}. Resulted in ${i}`)):(n=this.name,i=1);const l=this.hostname.match(_);if(l)o=l[1],a=l[3],c=parseInt(l[2]),(0,s.default)(c,`Failed to extract hostname number from ${this.hostname}. Resulted in ${c}`);else{const e=this.hostname.substring(0,this.hostname.length-1).lastIndexOf(".");o=this.hostname.slice(0,e),a=this.hostname.slice(e),c=1}e||(i++,c++);const d=Math.max(i,c);this.name=1===d?n:`${n} (${d})`,this.hostname=1===d?`${o}${a}`:`${o}-(${d})${a}`,this.loweredHostname=(0,y.dnsLowerCase)(this.hostname),this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,y.dnsLowerCase)(this.fqdn),this.name===t&&this.hostname===r||w("[%s] Service changed name '%s' -> '%s', '%s' -> '%s'",this.name,t,this.name,r,this.hostname),e||this.rebuildServiceRecords()}informAboutNameUpdates(){const e=this.emit("name-change",this.name),t=this.emit("hostname-change",b.removeTLD(this.hostname));e||t||console.warn(`CIAO: [${this.name}] Service changed name but nobody was listening on the 'name-change' event!`)}formatFQDN(){if("unannounced"!==this.serviceState)throw new Error("Name can't be changed after service was already announced!");const e=b.stringify({name:this.name,type:this.type,protocol:this.protocol,domain:this.serviceDomain});return(0,s.default)(e.length<=255,"A fully qualified domain name cannot be longer than 255 characters"),e}rebuildServiceRecords(){(0,s.default)(this.port,"port must be set before building records"),w("[%s] Rebuilding service records...",this.name);const e={},t={},r={},n={},i={};let o;for(const[s,o]of this.networkManager.getInterfaceMap()){if(!this.advertisesOnInterface(s,!0))continue;let a=this.restrictedAddresses?this.restrictedAddresses.get(s):void 0;a&&0===a.length&&(a=void 0),!o.ipv4||a&&!a.includes(o.ipv4)||(e[s]=new u.ARecord(this.hostname,o.ipv4,!0),i[o.ipv4]=new d.PTRRecord((0,v.formatReverseAddressPTRName)(o.ipv4),this.hostname)),!o.ipv6||this.disableIpv6||a&&!a.includes(o.ipv6)||(t[s]=new c.AAAARecord(this.hostname,o.ipv6,!0),i[o.ipv6]=new d.PTRRecord((0,v.formatReverseAddressPTRName)(o.ipv6),this.hostname)),!o.globallyRoutableIpv6||this.disableIpv6||a&&!a.includes(o.globallyRoutableIpv6)||(r[s]=new c.AAAARecord(this.hostname,o.globallyRoutableIpv6,!0),i[o.globallyRoutableIpv6]=new d.PTRRecord((0,v.formatReverseAddressPTRName)(o.globallyRoutableIpv6),this.hostname)),!o.uniqueLocalIpv6||this.disableIpv6||a&&!a.includes(o.uniqueLocalIpv6)||(n[s]=new c.AAAARecord(this.hostname,o.uniqueLocalIpv6,!0),i[o.uniqueLocalIpv6]=new d.PTRRecord((0,v.formatReverseAddressPTRName)(o.uniqueLocalIpv6),this.hostname))}if(this.subTypePTRs){o=[];for(const e of this.subTypePTRs)o.push(new d.PTRRecord(e,this.fqdn))}this.serviceRecords={ptr:new d.PTRRecord(this.typePTR,this.fqdn),subtypePTRs:o,metaQueryPtr:new d.PTRRecord(m.Responder.SERVICE_TYPE_ENUMERATION_NAME,this.typePTR),srv:new h.SRVRecord(this.fqdn,this.hostname,this.port,!0),txt:new p.TXTRecord(this.fqdn,this.txt,!0),serviceNSEC:new l.NSECRecord(this.fqdn,this.fqdn,[16,33],4500,!0),a:e,aaaa:t,aaaaR:r,aaaaULA:n,reverseAddressPTRs:i,addressNSEC:new l.NSECRecord(this.hostname,this.hostname,[1,28],120,!0)}}advertisesOnInterface(e,t){var r,n,s,i;return!this.restrictedAddresses||this.restrictedAddresses.has(e)&&(t||!!(null===(r=this.serviceRecords)||void 0===r?void 0:r.a[e])||!!(null===(n=this.serviceRecords)||void 0===n?void 0:n.aaaa[e])||!!(null===(s=this.serviceRecords)||void 0===s?void 0:s.aaaaR[e])||!!(null===(i=this.serviceRecords)||void 0===i?void 0:i.aaaaULA[e]))}ptrRecord(){return this.serviceRecords.ptr.clone()}subtypePtrRecords(){return this.serviceRecords.subtypePTRs?f.ResourceRecord.clone(this.serviceRecords.subtypePTRs):[]}metaQueryPtrRecord(){return this.serviceRecords.metaQueryPtr.clone()}srvRecord(){return this.serviceRecords.srv.clone()}txtRecord(){return this.serviceRecords.txt.clone()}aRecord(e){const t=this.serviceRecords.a[e];return t?t.clone():void 0}aaaaRecord(e){const t=this.serviceRecords.aaaa[e];return t?t.clone():void 0}aaaaRoutableRecord(e){const t=this.serviceRecords.aaaaR[e];return t?t.clone():void 0}aaaaUniqueLocalRecord(e){const t=this.serviceRecords.aaaaULA[e];return t?t.clone():void 0}allAddressRecords(){const e=[];return Object.values(this.serviceRecords.a).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaa).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaaR).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaaULA).forEach((t=>{e.push(t.clone())})),e}addressNSECRecord(){return this.serviceRecords.addressNSEC.clone()}serviceNSECRecord(e=!1){const t=this.serviceRecords.serviceNSEC.clone();return e&&(t.ttl=120),t}hasAddress(e){return!!this.serviceRecords.reverseAddressPTRs[e]}}t.CiaoService=k},2361:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MDNSServer=void 0,t.SendResultFailedRatio=function(e){if(0===e.length)return 0;let t=0;for(const r of e)"fulfilled"!==r.status&&t++;return t/e.length},t.SendResultFormatError=function(e,t,r=!1){let n=0;for(const t of e)"fulfilled"!==t.status&&n++;if(t||(t="Failed to send packets"),n<e.length?t+=` (${n}/${e.length}):`:t+=":",r){let r="=============================\n"+t;for(const t of e)"rejected"===t.status?r+="\n--------------------\nFailed to send packet on interface "+t.interface+": "+t.reason.stack:"timeout"===t.status&&(r+="\n--------------------\nSending packet on interface "+t.interface+" timed out!");return r+="\n=============================",r}{let r=t;for(const t of e)"rejected"===t.status?r+="\n- Failed to send packet on interface "+t.interface+": "+t.reason.message:"timeout"===t.status&&(r+="\n- Sending packet on interface "+t.interface+" timed out!");return r}};const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(6672)),o=n.__importDefault(r(7194)),a=r(4119),c=r(8937),u=r(9152),l=r(16),d=r(8390),h=(0,i.default)("ciao:MDNSServer");class p{constructor(e,t){this.sockets=new Map,this.sentPackets=new Map,this.suppressUnicastResponseFlag=!1,this.bound=!1,this.closed=!1,this.advertiseFamilies=[],(0,s.default)(e,"handler cannot be undefined"),this.handler=e,this.networkManager=new c.NetworkManager({interface:t&&t.interface,excludeIpv6:t&&t.disableIpv6,excludeIpv6Only:t&&t.excludeIpv6Only}),t&&!1===t.advertiseIpv4||this.advertiseFamilies.push("IPv4"),t&&t.advertiseIpv6&&this.advertiseFamilies.push("IPv6"),this.networkManager.on("network-update",this.handleUpdatedNetworkInterfaces.bind(this))}getNetworkManager(){return this.networkManager}getBoundInterfaceNames(){return this.sockets.keys()}async bind(){if(this.closed)throw new Error("Cannot rebind closed server!");this.suppressUnicastResponseFlag=!0,await this.networkManager.waitForInit();const e=[];for(const[t,r]of this.networkManager.getInterfaceMap())this.advertiseFamilies.forEach((n=>{const s=this.createDgramSocket(t,!0,"IPv6"===n?"udp6":"udp4"),i=this.bindSocket(s,r,n).catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}));e.push(i)}));return Promise.all(e).then((()=>{this.bound=!0}))}shutdown(){this.networkManager.shutdown();for(const e of this.sockets.values())e.close();this.bound=!1,this.closed=!0,this.sockets.clear()}sendQueryBroadcast(e,t){const r=a.DNSPacket.createDNSQueryPackets(e);r.length>1&&h("Query broadcast is split into %d packets!",r.length);const n=[];for(const e of r)n.push(this.sendOnAllNetworksForService(e,t));return Promise.all(n).then((e=>{const t=[];for(const r of e)t.concat(r);return t}))}sendResponseBroadcast(e,t){const r=a.DNSPacket.createDNSResponsePacketsFromRRSet(e);return this.sendOnAllNetworksForService(r,t)}sendResponse(e,t,r){this.send(e,t).then((e=>{"rejected"===e.status?r?r(new Error("Encountered socket error on "+e.reason.name+": "+e.reason.message)):p.logSocketError(e.interface,e.reason):r&&r()}))}sendOnAllNetworksForService(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();this.assertBeforeSend(r,"IPv4");const n=[];for(const[e,s]of this.sockets){if(!t.advertisesOnInterface(e))continue;const i=e.endsWith("/6"),o=new Promise((t=>{s.send(r,p.MDNS_PORT,i?p.MULTICAST_IPV6:p.MULTICAST_IPV4,(n=>{if(n){if(!p.isSilencedSocketError(n))return void t({status:"rejected",interface:e,reason:n})}else this.maintainSentPacketsInterface(e,r);t({status:"fulfilled",interface:e})}))}));n.push(Promise.race([o,(0,d.PromiseTimeout)(p.SEND_TIMEOUT).then((()=>({status:"timeout",interface:e})))]))}return Promise.all(n)}send(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();let n,s,i,o;"string"==typeof t?(o=t.endsWith("/6"),n=o?p.MULTICAST_IPV6:p.MULTICAST_IPV4,s=p.MDNS_PORT,i=t):(o=t.interface.endsWith("/6"),n=t.address,s=t.port,i=t.interface),this.assertBeforeSend(r,o?"IPv6":"IPv4");const a=this.sockets.get(i);if(!a)throw new l.InterfaceNotFoundError(`Could not find socket for given network interface '${i}'`);return new Promise((e=>{a.send(r,s,n,(t=>{if(t){if(!p.isSilencedSocketError(t))return void e({status:"rejected",interface:i,reason:t})}else this.maintainSentPacketsInterface(i,r);e({status:"fulfilled",interface:i})}))}))}checkUnicastResponseFlag(e){this.suppressUnicastResponseFlag&&0===e.type&&e.questions.forEach((e=>e.unicastResponseFlag=!1))}assertBeforeSend(e,t){if(this.closed)throw new l.ServerClosedError("Cannot send packets on a closed mdns server!");(0,s.default)(this.bound,"Cannot send packets before server is not bound!");const r="IPv4"===t?p.DEFAULT_IP4_HEADER:p.DEFAULT_IP6_HEADER;(0,s.default)(r+p.UDP_HEADER+e.length<=9e3,"DNS cannot exceed the size of 9000 bytes even with IP Fragmentation!")}maintainSentPacketsInterface(e,t){const r=t.toString("base64"),n=this.sentPackets.get(e);n?n.push(r):this.sentPackets.set(e,[r])}checkIfPacketWasPreviouslySentFromUs(e,t){const r=t.toString("base64"),n=this.sentPackets.get(e);if(n){const e=n.indexOf(r);if(-1!==e)return n.splice(e,1),!0}return!1}createDgramSocket(e,t=!1,r="udp4"){const n=o.default.createSocket({type:r,reuseAddr:t});return n.on("message",((t,n)=>this.handleMessage(e,t,n,"udp6"===r?"IPv6":"IPv4"))),n.on("error",(t=>{p.isSilencedSocketError(t)||p.logSocketError(e,t)})),n}bindSocket(e,t,r){return new Promise(((n,s)=>{const i=e=>s(new Error("Failed to bind on interface "+t.name+": "+e.message)),o="IPv6"===r;e.once("error",i),e.on("close",(()=>{this.sockets.delete(t.name+(o?"/6":""))})),e.bind(p.MDNS_PORT,(()=>{e.setRecvBufferSize(819200),e.removeListener("error",i);const r=o?p.MULTICAST_IPV6:p.MULTICAST_IPV4,a=o?t.ipv6:t.ipv4;if(a)try{e.addMembership(r,a),e.setMulticastInterface(o?a+"%"+t.name:a),e.setMulticastTTL(p.MDNS_TTL),e.setTTL(p.MDNS_TTL),e.setMulticastLoopback(!0),this.sockets.set(o?t.name+"/6":t.name,e),n()}catch(r){try{e.close()}catch(e){h("Error while closing socket which failed to bind. Error may be expected: "+e.message)}s(new Error("Error binding socket on "+t.name+": "+r.stack))}else{console.log("Warning: no "+(o?"IPv6":"IPv4")+" address available on "+t.name);try{e.close()}catch(e){}n()}}))}))}handleMessage(e,t,r,n){if(!this.bound)return;const s=this.networkManager.getInterface(e);if(!s)return void h("Received packet on non existing network interface: %s!",e);if(this.checkIfPacketWasPreviouslySentFromUs(s.name,t))return;const i="IPv6"===n;if(i)s.loopback!==r.address.includes("%lo")&&h("Received packet on a %s interface (%s) which is coming from a %s interface (%s)",s.loopback?"loopback":"non-loopback",e,r.address.includes("%lo")?"loopback":"non-loopback",r.address);else{const t=(0,u.getNetAddress)(r.address,s.ip4Netmask);if(s.loopback){if(t!==s.ipv4Netaddress)return}else if(this.networkManager.isLoopbackNetaddressV4(t))return void h("Received packet on interface '%s' which is not coming from the same subnet: %o",e,{address:r.address,netaddress:t,interface:s.ipv4})}let o;try{o=a.DNSPacket.decode(r,t)}catch(n){return void h("Received a malformed packet from %o on interface %s. This might or might not be a problem. Here is the received packet for debugging purposes '%s'. Packet decoding failed with %s",r,e,t.toString("base64"),n.stack)}if(0!==o.opcode)return;if(0!==o.rcode)return;const c={address:r.address,port:r.port,interface:e+(i?"/6":"")};if(0===o.type)try{this.handler.handleQuery(o,c)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns query packet: "+t.stack)}else if(1===o.type){if(r.port!==p.MDNS_PORT)return;try{this.handler.handleResponse(o,c)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns response packet: "+t.stack)}}}static isSilencedSocketError(e){const t=e.message.includes("EADDRNOTAVAIL")||e.message.includes("EHOSTDOWN")||e.message.includes("ENETUNREACH")||e.message.includes("EHOSTUNREACH")||e.message.includes("EPERM")||e.message.includes("EINVAL");return t&&h("Silenced and ignored error (This is/should not be a problem, this message is only for informational purposes): "+e.message),t}static logSocketError(e,t){console.warn(`Encountered MDNS socket error on socket '${e}' : ${t.stack}`)}handleUpdatedNetworkInterfaces(e){if(e.removed)for(const t of e.removed){let e=this.sockets.get(t.name);this.sockets.delete(t.name),e&&e.close(),e=this.sockets.get(t.name+"/6"),this.sockets.delete(t.name+"/6"),e&&e.close()}if(e.changes)for(const t of e.changes){let e=this.sockets.get(t.name);if(!t.outdatedIpv4&&t.updatedIpv4)s.default.fail("Reached illegal state! IPv4 address changed from undefined to defined!");else if(t.outdatedIpv4&&!t.updatedIpv4)s.default.fail("Reached illegal state! IPV4 address change from defined to undefined!");else if(e&&t.outdatedIpv4&&t.updatedIpv4){try{e.dropMembership(p.MULTICAST_IPV4,t.outdatedIpv4)}catch(e){h("Thrown unexpected error when dropping outdated address membership: "+e.message)}try{e.addMembership(p.MULTICAST_IPV4,t.updatedIpv4)}catch(e){h("Thrown unexpected error when adding new address membership: "+e.message)}e.setMulticastInterface(t.updatedIpv4)}if(e=this.sockets.get(t.name+"/6"),e&&t.outdatedIpv6&&t.updatedIpv6){try{e.dropMembership(p.MULTICAST_IPV6,t.outdatedIpv6)}catch(e){h("Thrown unexpected error when dropping outdated address membership: "+e.message)}try{e.addMembership(p.MULTICAST_IPV6,t.updatedIpv6)}catch(e){h("Thrown unexpected error when adding new address membership: "+e.message)}}}if(e.added)for(const t of e.added)this.advertiseFamilies.forEach((e=>{const r=this.createDgramSocket(t.name,!0,"IPv6"===e?"udp6":"udp4");this.bindSocket(r,t,e).catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}))}))}}t.MDNSServer=p,p.DEFAULT_IP4_HEADER=20,p.DEFAULT_IP6_HEADER=40,p.UDP_HEADER=8,p.MDNS_PORT=5353,p.MDNS_TTL=255,p.MULTICAST_IPV4="224.0.0.251",p.MULTICAST_IPV6="FF02::FB",p.SEND_TIMEOUT=200},8937:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkManager=t.NetworkManagerEvent=t.WifiState=t.IPFamily=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(5317)),o=n.__importDefault(r(6672)),a=r(4434),c=n.__importDefault(r(2017)),u=n.__importDefault(r(9278)),l=n.__importDefault(r(857)),d=r(9152),h=(0,o.default)("ciao:NetworkManager");var p,f,m;!function(e){e.IPv4="IPv4",e.IPv6="IPv6"}(p||(t.IPFamily=p={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.NOT_A_WIFI_INTERFACE=1]="NOT_A_WIFI_INTERFACE",e[e.NOT_ASSOCIATED=2]="NOT_ASSOCIATED",e[e.CONNECTED=3]="CONNECTED"}(f||(t.WifiState=f={})),function(e){e.NETWORK_UPDATE="network-update"}(m||(t.NetworkManagerEvent=m={}));class g extends a.EventEmitter{constructor(e){if(super(),this.currentInterfaces=new Map,this.loopbackInterfaces=new Map,this.setMaxListeners(100),e&&e.interface){let t;if("string"==typeof e.interface)t=[e.interface];else{if(!Array.isArray(e.interface))throw new Error("Found invalid type for 'interfaces' NetworkManager option!");t=e.interface}const r=[];for(const n of t)if(u.default.isIP(n)){const t=g.resolveInterface(n);t?r.push(t):console.log("CIAO: Interface was specified as ip (%s), though couldn't find a matching interface for the given address.",e.interface)}else r.push(n);0===r.length?console.log("CIAO: 'restrictedInterfaces' array was empty. Going to fallback to bind on all available interfaces."):this.restrictedInterfaces=r}this.excludeIpv6=!(!e||!e.excludeIpv6),this.excludeIpv6Only=this.excludeIpv6||!(!e||!e.excludeIpv6Only),e&&h("Created NetworkManager with options: %s",JSON.stringify(e)),this.initPromise=new Promise((e=>{this.getCurrentNetworkInterfaces().then((t=>{this.currentInterfaces=t;const r=Object.keys(l.default.networkInterfaces()),n=[];for(const e of this.currentInterfaces.keys()){n.push(e);const t=r.indexOf(e);-1!==t&&r.splice(t,1)}h("Initial networks [%s] ignoring [%s]",n.join(", "),r.join(", ")),this.initPromise=void 0,e(),this.scheduleNextJob()}))}))}async waitForInit(){this.initPromise&&await this.initPromise}shutdown(){this.currentTimer&&(clearTimeout(this.currentTimer),this.currentTimer=void 0),this.removeAllListeners()}getInterfaceMap(){return this.initPromise&&s.default.fail("Not yet initialized!"),this.currentInterfaces}getInterface(e){return this.initPromise&&s.default.fail("Not yet initialized!"),this.currentInterfaces.get(e)}isLoopbackNetaddressV4(e){for(const t of this.loopbackInterfaces.values())if(t.ipv4Netaddress===e)return!0;return!1}scheduleNextJob(){this.currentTimer=setTimeout(this.checkForNewInterfaces.bind(this),g.POLLING_TIME),this.currentTimer.unref()}async checkForNewInterfaces(){const e=await this.getCurrentNetworkInterfaces();if(!this.currentTimer)return;let t,r,n;for(const[r,s]of e){const e=this.currentInterfaces.get(r);if(e){if(!(0,c.default)(e,s)){const t={name:r};e.ipv4!==s.ipv4&&(e.ipv4&&(t.outdatedIpv4=e.ipv4),s.ipv4&&(t.updatedIpv4=s.ipv4)),e.ipv6!==s.ipv6&&(e.ipv6&&(t.outdatedIpv6=e.ipv6),s.ipv6&&(t.updatedIpv6=s.ipv6)),e.globallyRoutableIpv6!==s.globallyRoutableIpv6&&(e.globallyRoutableIpv6&&(t.outdatedGloballyRoutableIpv6=e.globallyRoutableIpv6),s.globallyRoutableIpv6&&(t.updatedGloballyRoutableIpv6=s.globallyRoutableIpv6)),e.uniqueLocalIpv6!==s.uniqueLocalIpv6&&(e.uniqueLocalIpv6&&(t.outdatedUniqueLocalIpv6=e.uniqueLocalIpv6),s.uniqueLocalIpv6&&(t.updatedUniqueLocalIpv6=s.uniqueLocalIpv6)),this.currentInterfaces.set(r,s),s.loopback&&this.loopbackInterfaces.set(r,s),(null!=n?n:n=[]).push(t)}}else this.currentInterfaces.set(r,s),s.loopback&&this.currentInterfaces.set(r,s),(null!=t?t:t=[]).push(s)}if(this.currentInterfaces.size!==e.size)for(const[t,n]of this.currentInterfaces)e.has(t)||(this.currentInterfaces.delete(t),this.loopbackInterfaces.delete(t),(null!=r?r:r=[]).push(n));if(t||r||n){const e=t?t.map((e=>e.name)).join(","):"",s=r?r.map((e=>e.name)).join(","):"",i=n?n.map((e=>{let t=`{ name: ${e.name} `;return(e.outdatedIpv4||e.updatedIpv4)&&(t+=`, ${e.outdatedIpv4} -> ${e.updatedIpv4} `),(e.outdatedIpv6||e.updatedIpv6)&&(t+=`, ${e.outdatedIpv6} -> ${e.updatedIpv6} `),(e.outdatedGloballyRoutableIpv6||e.updatedGloballyRoutableIpv6)&&(t+=`, ${e.outdatedGloballyRoutableIpv6} -> ${e.updatedGloballyRoutableIpv6} `),(e.outdatedUniqueLocalIpv6||e.updatedUniqueLocalIpv6)&&(t+=`, ${e.outdatedUniqueLocalIpv6} -> ${e.updatedUniqueLocalIpv6} `),t+"}"})).join(","):"";h("Detected network changes: added: [%s], removed: [%s], changes: [%s]!",e,s,i),this.emit("network-update",{added:t,removed:r,changes:n})}this.scheduleNextJob()}async getCurrentNetworkInterfaces(){let e;if(this.restrictedInterfaces){e=this.restrictedInterfaces;const t=g.getLoopbackInterface();e.includes(t)||e.push(t)}else try{e=await g.getNetworkInterfaceNames()}catch(t){h(`WARNING Detecting network interfaces for platform '${l.default.platform()}' failed. Trying to assume network interfaces! (${t.message})`),e=g.assumeNetworkInterfaceNames()}const t=new Map,r=l.default.networkInterfaces();for(const n of e){const e=r[n];if(!e)continue;let i,o,a,c,u=!1;for(const t of e){if(t.internal&&(u=!0),"IPv4"!==t.family&&4!==t.family||i){if("IPv6"===t.family||6===t.family){if(this.excludeIpv6)continue;t.scopeid&&!o?o=t:0===t.scopeid&&(t.address.startsWith("fc")||t.address.startsWith("fd")?c||(c=t):a||(a=t))}}else i=t;if(i&&o&&a&&c)break}if((0,s.default)(i||o,"Could not find valid addresses for interface '"+n+"'"),this.excludeIpv6Only&&!i)continue;const l={name:n,loopback:u,mac:(null==i?void 0:i.mac)||(null==o?void 0:o.mac)};i&&(l.ipv4=i.address,l.ip4Netmask=i.netmask,l.ipv4Netaddress=(0,d.getNetAddress)(i.address,i.netmask)),o&&(l.ipv6=o.address,l.ipv6Netmask=o.netmask),a&&(l.globallyRoutableIpv6=a.address,l.globallyRoutableIpv6Netmask=a.netmask),c&&(l.uniqueLocalIpv6=c.address,l.uniqueLocalIpv6Netmask=c.netmask),t.set(n,l)}return t}static resolveInterface(e){let t;e:for(const[r,n]of Object.entries(l.default.networkInterfaces()))for(const s of null!=n?n:[])if(s.address===e){t=r;break e}return t}static async getNetworkInterfaceNames(){let e,t;switch(l.default.platform()){case"win32":e=g.getWindowsNetworkInterfaces();break;case"linux":e=g.getLinuxNetworkInterfaces();break;case"darwin":e=g.getDarwinNetworkInterfaces();break;case"freebsd":e=g.getFreeBSDNetworkInterfaces();break;case"openbsd":case"sunos":e=g.getOpenBSD_SUNOS_NetworkInterfaces();break;default:return h("Found unsupported platform %s",l.default.platform()),Promise.reject(new Error("unsupported platform!"))}try{t=await e}catch(e){if(e.message!==g.NOTHING_FOUND_MESSAGE)throw e;t=[]}const r=g.getLoopbackInterface();return t.includes(r)||t.unshift(r),e}static assumeNetworkInterfaceNames(){const e=[];return Object.entries(l.default.networkInterfaces()).forEach((([t,r])=>{for(const n of null!=r?r:[])if(n.internal||"IPv4"===n.family||4===n.family||("IPv6"===n.family||6===n.family)&&0===n.scopeid){e.includes(t)||e.push(t);break}})),e}static getLoopbackInterface(){for(const[e,t]of Object.entries(l.default.networkInterfaces()))for(const r of null!=t?t:[])if(r.internal)return e;throw new Error("Could not detect loopback interface!")}static getWindowsNetworkInterfaces(){return new Promise(((e,t)=>{i.default.exec('arp -a | findstr /C:"---"',((r,n)=>{if(r)return void t(r);const s=n.split(l.default.EOL),i=[];for(let e=0;e<s.length-1;e++){const t=s[e].trim().split(" ");t[t.length-3]?i.push(t[t.length-3]):h(`WINDOWS: Failed to read interface name from line ${e}: '${s[e]}'`)}const o=[];for(const e of i){const t=g.resolveInterface(e);t?o.includes(t)||o.push(t):h(`WINDOWS: Couldn't resolve to an interface name from '${e}'`)}o.length?e(o):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getDarwinNetworkInterfaces(){return new Promise(((e,t)=>{i.default.exec("arp -a -n -l",(async(r,n)=>{if(r)return void t(r);const s=n.split(l.default.EOL),i=[];for(let e=1;e<s.length-1;e++){const t=s[e].trim().split(g.SPACE_PATTERN)[4];t?i.includes(t)||i.push(t):h(`DARWIN: Failed to read interface name from line ${e}: '${s[e]}'`)}const o=[];for(const e of i){const t=g.getDarwinWifiNetworkState(e).then((t=>{if(1!==t&&3!==t){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}));o.push(t)}await Promise.all(o),i.length?e(i):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getLinuxNetworkInterfaces(){return new Promise(((e,t)=>{i.default.exec("ip neigh show",((r,n)=>{if(r)return r.message.includes("ip: not found")?(h("LINUX: ip was not found on the system. Falling back to assuming network interfaces!"),void e(g.assumeNetworkInterfaceNames())):void t(r);const s=n.split(l.default.EOL),i=[];for(let e=0;e<s.length-1;e++){const t=s[e].trim().split(g.SPACE_PATTERN);let r=0;for(;r<t.length&&"dev"!==t[r];r++);if(r>=t.length){h(`LINUX: Out of bounds when reading interface name from line ${e}: '${s[e]}'`);continue}const n=t[r+1];n?i.includes(n)||i.push(n):h(`LINUX: Failed to read interface name from line ${e}: '${s[e]}'`)}i.length?e(i):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getFreeBSDNetworkInterfaces(){return new Promise(((e,t)=>{i.default.exec("arp -a -n",((r,n)=>{if(r)return void t(r);const s=n.split(l.default.EOL),i=[];for(let e=0;e<s.length-1;e++){const t=s[e].trim().split(g.SPACE_PATTERN)[5];t?i.includes(t)||i.push(t):h(`FreeBSD: Failed to read interface name from line ${e}: '${s[e]}'`)}i.length?e(i):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getOpenBSD_SUNOS_NetworkInterfaces(){return new Promise(((e,t)=>{i.default.exec("arp -a -n",((r,n)=>{if(r)return void t(r);const s="sunos"===l.default.platform()?0:2,i=n.split(l.default.EOL),o=[];for(let e=1;e<i.length-1;e++){const t=i[e].trim().split(g.SPACE_PATTERN)[s];t?o.includes(t)||o.push(t):h(`${l.default.platform()}: Failed to read interface name from line ${e}: '${i[e]}'`)}o.length?e(o):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getDarwinWifiNetworkState(e){return new Promise((t=>{i.default.exec("networksetup -getairportnetwork "+e,((r,n)=>{if(r)return n.includes("not a Wi-Fi interface")?void t(1):(console.log(`CIAO WARN: While checking networksetup for ${e} encountered an error (${r.message}) with output: ${n.replace(l.default.EOL,"; ")}`),void t(0));let s=0;n.includes("not a Wi-Fi interface")?s=1:n.includes("Current Wi-Fi Network")?s=3:n.includes("not associated")?s=2:n.includes("All Wi-Fi network services are disabled")?s=1:console.log(`CIAO WARN: While checking networksetup for ${e} encountered an unknown output: ${n.replace(l.default.EOL,"; ")}`),t(s)}))}))}}t.NetworkManager=g,g.SPACE_PATTERN=/\s+/g,g.NOTHING_FOUND_MESSAGE="no interfaces found",g.POLLING_TIME=15e3},4288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Responder=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(6672)),o=r(141),a=r(4119),c=r(5682),u=r(1360),l=r(4495),d=r(482),h=r(8225),p=r(1576),f=r(2361),m=r(9983),g=r(2475),y=r(572),b=r(5745),v=r(341),w=r(16),C=r(8390),_=r(5762),S=(0,i.default)("ciao:Responder"),E=(e,t)=>e.estimatedTimeToBeSent-t.estimatedTimeToBeSent;var A;!function(e){e[e.NO_CONFLICT=0]="NO_CONFLICT",e[e.CONFLICTING_RDATA=1]="CONFLICTING_RDATA",e[e.CONFLICTING_TTL=2]="CONFLICTING_TTL"}(A||(A={}));class I{static getResponder(e){const t=e?JSON.stringify(e):"",r=this.INSTANCES.get(t);if(r)return r.refCount++,r;{const r=new I(e);return this.INSTANCES.set(t,r),r.optionsString=t,r}}constructor(e){this.refCount=1,this.optionsString="",this.bound=!1,this.announcedServices=new Map,this.servicePointer=new Map,this.truncatedQueries={},this.delayedMulticastResponses=[],this.server=new f.MDNSServer(this,e),this.promiseChain=this.start(),this.server.getNetworkManager().on("network-update",this.handleNetworkUpdate.bind(this)),this.ignoreUnicastResponseFlag=null==e?void 0:e.ignoreUnicastResponseFlag,(null==e?void 0:e.periodicBroadcasts)&&(this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e4).unref())}handlePeriodicBroadcasts(){this.broadcastInterval=void 0,S("Sending periodic announcement on "+Array.from(this.server.getNetworkManager().getInterfaceMap().keys()).join(", "));const e=Array.from(this.server.getBoundInterfaceNames());for(const t of this.server.getNetworkManager().getInterfaceMap().values()){const r=new c.Question("_hap._tcp.local.",12,!1);let n=[],s=[];e.includes(t.name)&&(n=this.answerQuestion(r,{port:5353,address:t.ipv4Netaddress,interface:t.name})),e.includes(t.name+"/6")&&(s=this.answerQuestion(r,{port:5353,address:t.ipv6,interface:t.name+"/6"}));const i=[...n,...s];y.QueryResponse.combineResponses(i);for(const e of i)e.hasAnswers()&&this.server.sendResponse(e.asPacket(),t.name)}this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e3*Math.random()+27e3).unref()}createService(e){const t=new o.CiaoService(this.server.getNetworkManager(),e);return t.on("publish",this.advertiseService.bind(this,t)),t.on("unpublish",this.unpublishService.bind(this,t)),t.on("republish",this.republishService.bind(this,t)),t.on("records-update",this.handleServiceRecordUpdate.bind(this,t)),t.on("records-update-interface",this.handleServiceRecordUpdateOnInterface.bind(this,t)),t}shutdown(){if(this.refCount--,this.refCount>0)return Promise.resolve();this.currentProber&&this.currentProber.cancel(),this.broadcastInterval&&clearTimeout(this.broadcastInterval),I.INSTANCES.delete(this.optionsString),S("Shutting down Responder...");const e=[];for(const t of this.announcedServices.values())e.push(this.unpublishService(t));return Promise.all(e).then((()=>{this.server.shutdown(),this.bound=!1}))}getAnnouncedServices(){return this.announcedServices.values()}start(){if(this.bound)throw new Error("Server is already bound!");return this.bound=!0,this.server.bind()}advertiseService(e,t){if("announced"===e.serviceState)throw new Error("Can't publish a service that is already announced. Received "+e.serviceState+" for service "+e.getFQDN());return"probing"===e.serviceState?this.promiseChain.then((()=>{if(e.currentAnnouncer)return e.currentAnnouncer.awaitAnnouncement()})):"announcing"===e.serviceState?((0,s.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement().then((()=>this.advertiseService(e,t))):e.currentAnnouncer.cancel().then((()=>this.advertiseService(e,t)))):(S("[%s] Going to advertise service...",e.getFQDN()),this.promiseChain=this.promiseChain.then((()=>e.rebuildServiceRecords())).then((()=>this.probe(e))),this.promiseChain.then((()=>{this.announce(e).catch((t=>(console.log(`[${e.getFQDN()}] failed announcing with reason: ${t}. Trying again in 2 seconds!`),(0,C.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,(()=>{}))))))),t()}),(r=>{if(r!==g.Prober.CANCEL_REASON)return console.log(`[${e.getFQDN()}] failed probing with reason: ${r}. Trying again in 2 seconds!`),(0,C.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,t)));t()})))}async republishService(e,t,r=!1){if("announced"!==e.serviceState&&"announcing"!==e.serviceState)throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN());return S("[%s] Readvertising service...",e.getFQDN()),"announcing"===e.serviceState?((0,s.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),(e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel()).then((()=>this.advertiseService(e,t)))):(this.clearService(e),e.serviceState="unannounced",r?(0,C.PromiseTimeout)(1e3).then((()=>this.advertiseService(e,t))):this.advertiseService(e,t))}unpublishService(e,t){if("unannounced"===e.serviceState)throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN());if("announced"===e.serviceState||"announcing"===e.serviceState){if("announcing"===e.serviceState)return(0,s.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel().then((()=>(e.serviceState="announced",this.unpublishService(e,t))));S("[%s] Removing service from the network",e.getFQDN()),this.clearService(e),e.serviceState="unannounced";let r=this.goodbye(e);return t&&(r=r.then((()=>t()),(r=>{console.log(`[${e.getFQDN()}] failed goodbye with reason: ${r}.`),t()}))),r}return"probing"===e.serviceState&&(S("[%s] Canceling probing",e.getFQDN()),this.currentProber&&this.currentProber.getService()===e&&(this.currentProber.cancel(),this.currentProber=void 0),e.serviceState="unannounced"),"function"==typeof t&&t(),Promise.resolve()}clearService(e){const t=e.getLowerCasedFQDN(),r=e.getLowerCasedTypePTR(),n=e.getLowerCasedSubtypePTRs();if(this.removePTR(I.SERVICE_TYPE_ENUMERATION_NAME,r),this.removePTR(r,t),n)for(const e of n)this.removePTR(e,t);this.announcedServices.delete(e.getLowerCasedFQDN())}addPTR(e,t){const r=this.servicePointer.get(e);r?r.includes(t)||r.push(t):this.servicePointer.set(e,[t])}removePTR(e,t){const r=this.servicePointer.get(e);if(r){const n=r.indexOf(t);-1!==n&&r.splice(n,1),0===r.length&&this.servicePointer.delete(e)}}probe(e){if("unannounced"!==e.serviceState)throw new Error("Can't probe for a service which is announced already. Received "+e.serviceState+" for service "+e.getFQDN());return e.serviceState="probing",(0,s.default)(void 0===this.currentProber,"Tried creating new Prober when there already was one active!"),this.currentProber=new g.Prober(this,this.server,e),this.currentProber.probe().then((()=>{this.currentProber=void 0,e.serviceState="probed"}),(t=>(e.serviceState="unannounced",this.currentProber=void 0,Promise.reject(t))))}announce(e){if("probed"!==e.serviceState)throw new Error("Cannot announce service which was not probed unique. Received "+e.serviceState+" for service "+e.getFQDN());(0,s.default)(void 0===e.currentAnnouncer,"Service "+e.getFQDN()+" is already announcing!"),e.serviceState="announcing";const t=new m.Announcer(this.server,e,{repetitions:3});e.currentAnnouncer=t;const r=e.getLowerCasedFQDN(),n=e.getLowerCasedTypePTR(),i=e.getLowerCasedSubtypePTRs();if(this.addPTR(I.SERVICE_TYPE_ENUMERATION_NAME,n),this.addPTR(n,r),i)for(const e of i)this.addPTR(e,r);return this.announcedServices.set(r,e),t.announce().then((()=>{e.serviceState="announced",e.currentAnnouncer=void 0}),(t=>{if(e.serviceState="unannounced",e.currentAnnouncer=void 0,this.clearService(e),t!==m.Announcer.CANCEL_REASON)return Promise.reject(t)}))}handleServiceRecordUpdate(e,t,r){var n;if("announced"!==e.serviceState)throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN());S("[%s] Updating %d record(s) for given service!",e.getFQDN(),t.answers.length+((null===(n=t.additionals)||void 0===n?void 0:n.length)||0)),this.server.sendResponseBroadcast(t,e).then((t=>{const n=(0,f.SendResultFailedRatio)(t);if(1===n)return console.log((0,f.SendResultFormatError)(t,`Failed to send records update for '${e.getFQDN()}'`),!0),void(r&&r(new Error("Updating records failed as of socket errors!")));n>0&&S((0,f.SendResultFormatError)(t,`Some of the record updates for '${e.getFQDN()}' failed`)),r&&r()}))}handleServiceRecordUpdateOnInterface(e,t,r,n){if("announced"!==e.serviceState)throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN());S("[%s] Updating %d record(s) for given service on interface %s!",e.getFQDN(),r.length,t);const s=a.DNSPacket.createDNSResponsePacketsFromRRSet({answers:r});this.server.sendResponse(s,t,n)}goodbye(e){(0,s.default)(void 0===e.currentAnnouncer,"Service "+e.getFQDN()+" is already announcing!"),e.serviceState="announcing";const t=new m.Announcer(this.server,e,{repetitions:1,goodbye:!0});return e.currentAnnouncer=t,t.announce().then((()=>{e.serviceState="unannounced",e.currentAnnouncer=void 0}),(t=>(e.serviceState="unannounced",e.currentAnnouncer=void 0,Promise.reject(t))))}handleNetworkUpdate(e){for(const t of this.announcedServices.values())t.handleNetworkInterfaceUpdate(e)}handleQuery(e,t){const r=(new Date).getTime(),n=t.address+":"+t.port+":"+t.interface,s=this.truncatedQueries[n];if(s)switch(s.appendDNSPacket(e)){case 1:return delete this.truncatedQueries[n],void S("[%s] Aborting to wait for more truncated queries. Waited a total of %d ms receiving %d queries",n,s.getTotalWaitTime(),s.getArrivedPacketCount());case 2:return void S("[%s] Received a query marked as truncated, waiting for more to arrive",n);case 3:delete this.truncatedQueries[n],e=s.getPacket(),S("[%s] Last part of the truncated query arrived. Received %d packets taking a total of %d ms",n,s.getArrivedPacketCount(),s.getTotalWaitTime())}else if(e.flags.truncation){S("Received truncated query from "+JSON.stringify(t)+" waiting for more to come!");const r=new v.TruncatedQuery(e);return this.truncatedQueries[n]=r,void r.on("timeout",(()=>{S("[%s] Timeout passed since the last truncated query was received. Discarding %d packets received in %d ms.",n,r.getArrivedPacketCount(),r.getTotalWaitTime()),delete this.truncatedQueries[n]}))}const i=t.port!==f.MDNSServer.MDNS_PORT,o=e.authorities.size>0;let a;for(const t of e.additionals.values())if(41===t.type){a=t.udpPayloadSize;break}const c=[],u=[];if(e.questions.forEach((r=>{const n=this.answerQuestion(r,t,e.answers);i||r.unicastResponseFlag&&!this.ignoreUnicastResponseFlag?u.push(...n):c.push(...n)})),this.currentProber&&this.currentProber.handleQuery(e,t),i)for(let t=0;t<u.length;t++)u[t].markLegacyUnicastResponse(e.id,0===t?Array.from(e.questions.values()):void 0);y.QueryResponse.combineResponses(c,a),y.QueryResponse.combineResponses(u,a),i&&u.length>1&&(u.splice(1,u.length-1),u[0].markTruncated());for(const e of u){if(!e.hasAnswers())continue;this.server.sendResponse(e.asPacket(),t);const n=(new Date).getTime()-r;S("Sending response via unicast to %s (took %d ms): %s",JSON.stringify(t),n,e.asString(a))}for(const n of c)if(n.hasAnswers())if((n.containsSharedAnswer()||e.questions.size>1)&&!o){const e=(new Date).getTime()-r;this.enqueueDelayedMulticastResponse(n.asPacket(),t.interface,e)}else{let e=!1;for(let s=0;s<this.delayedMulticastResponses.length;s++){const i=this.delayedMulticastResponses[s];if(i.getTimeTillSent()>b.QueuedResponse.MAX_DELAY)break;if(i.combineWithUniqueResponseIfPossible(n,t.interface)){const n=(new Date).getTime()-r;e=!0,S("Multicast response on interface %s containing unique records (took %d ms) was combined with response which is sent out later",t.interface,n);break}}if(!e){this.server.sendResponse(n.asPacket(),t.interface);const e=(new Date).getTime()-r;S("Sending response via multicast on network %s (took %d ms): %s",t.interface,e,n.asString(a))}}}handleResponse(e,t){this.currentProber&&this.currentProber.handleResponse(e,t);for(const r of this.announcedServices.values()){let n=!1,s=0;for(const i of e.answers.values()){const e=I.checkRecordConflictType(r,i,t);if(1===e){n=!0;break}2===e&&s++}if(!n)for(const i of e.additionals.values()){const e=I.checkRecordConflictType(r,i,t);if(1===e){n=!0;break}2===e&&s++}if(n)this.republishService(r,(e=>{e&&(console.log(`FATAL Error occurred trying to resolve conflict for service ${r.getFQDN()}! We can't recover from this!`),console.log(e.stack),process.exit(1))}),!0);else if(s&&!r.currentAnnouncer){r.serviceState="announcing";const e=new m.Announcer(this.server,r,{repetitions:1});r.currentAnnouncer=e,e.announce().then((()=>{r.currentAnnouncer=void 0,r.serviceState="announced"}),(e=>{r.currentAnnouncer=void 0,r.serviceState="announced",e!==m.Announcer.CANCEL_REASON&&console.warn("When trying to resolve a ttl conflict on the network, we were unable to send our response packet: "+e.message)}))}}}static checkRecordConflictType(e,t,r){if(!e.advertisesOnInterface(r.interface))return 0;const n=t.getLowerCasedName();if(n===e.getLowerCasedFQDN()){if(33===t.type){const r=t;if(r.getLowerCasedHostname()!==e.getLowerCasedHostname())return S("[%s] Noticed conflicting record on the network. SRV with hostname: %s",e.getFQDN(),r.hostname),1;if(r.port!==e.getPort())return S("[%s] Noticed conflicting record on the network. SRV with port: %s",e.getFQDN(),r.port),1;if(r.ttl<h.SRVRecord.DEFAULT_TTL/2)return 2}else if(16===t.type){const r=t,n=e.getTXT();if(n.length!==r.txt.length)return S("[%s] Noticed conflicting record on the network. TXT with differing data length",e.getFQDN()),1;for(let t=0;t<n.length;t++){const s=n[t],i=r.txt[t];if(s.length!==i.length||s.toString("hex")!==i.toString("hex"))return S("[%s] Noticed conflicting record on the network. TXT with differing data.",e.getFQDN()),1}if(r.ttl<p.TXTRecord.DEFAULT_TTL/2)return 2}}else if(n===e.getLowerCasedHostname()){if(1===t.type){const r=t;if(!e.hasAddress(r.ipAddress))return S("[%s] Noticed conflicting record on the network. A with ip address: %s",e.getFQDN(),r.ipAddress),1;if(r.ttl<l.ARecord.DEFAULT_TTL/2)return 2}else if(28===t.type){const r=t;if(!e.hasAddress(r.ipAddress))return S("[%s] Noticed conflicting record on the network. AAAA with ip address: %s",e.getFQDN(),r.ipAddress),1;if(r.ttl<u.AAAARecord.DEFAULT_TTL/2)return 2}}else if(12===t.type){const r=t;if(n===e.getLowerCasedTypePTR()){if(r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<d.PTRRecord.DEFAULT_TTL/2)return 2}else if(n===I.SERVICE_TYPE_ENUMERATION_NAME);else{const t=e.getLowerCasedSubtypePTRs();if(t&&t.includes(n)&&r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<d.PTRRecord.DEFAULT_TTL/2)return 2}}return 0}enqueueDelayedMulticastResponse(e,t,r){const n=new b.QueuedResponse(e,t);n.calculateRandomDelay(),(0,_.sortedInsert)(this.delayedMulticastResponses,n,E);for(let e=0;e<this.delayedMulticastResponses.length;e++){const t=this.delayedMulticastResponses[e];for(let r=e+1;r<this.delayedMulticastResponses.length;r++){const n=this.delayedMulticastResponses[r];if(!t.delayWouldBeInTimelyManner(n))break;if(t.combineWithNextPacketIfPossible(n)){const r=this.delayedMulticastResponses.indexOf(t);-1!==r&&this.delayedMulticastResponses.splice(r,1),e--;break}}}n.delayed||n.scheduleResponse((()=>{const e=this.delayedMulticastResponses.indexOf(n);-1!==e&&this.delayedMulticastResponses.splice(e,1);try{this.server.sendResponse(n.getPacket(),t),S("Sending (delayed %dms) response via multicast on network interface %s (took %d ms): %s",Math.round(n.getTimeSinceCreation()),t,r,n.getPacket().asLoggingString())}catch(e){if(e.name===w.ERR_INTERFACE_NOT_FOUND)S("Multicast response (delayed %dms) was cancelled as the network interface %s is no longer available!",Math.round(n.getTimeSinceCreation()),t);else{if(e.name!==w.ERR_SERVER_CLOSED)throw e;S("Multicast response (delayed %dms) was cancelled as the server is about to be shutdown!",Math.round(n.getTimeSinceCreation()))}}}))}answerQuestion(e,t,r){if(1!==e.class&&255!==e.class)return[];const n=[];let s;if(12===e.type||255===e.type||5===e.type){const i=this.servicePointer.get(e.getLowerCasedName());if(i){for(const o of i){const i=this.announcedServices.get(o);if(i){if(i.advertisesOnInterface(t.interface)){const s=I.answerServiceQuestion(i,e,t,r);s.hasAnswers()&&n.push(s)}}else s||(s=new y.QueryResponse(r),n.unshift(s)),s.addAnswer(new d.PTRRecord(e.name,o))}return n}}for(const s of this.announcedServices.values()){if(!s.advertisesOnInterface(t.interface))continue;const i=I.answerServiceQuestion(s,e,t,r);i.hasAnswers()&&n.push(i)}return n}static answerServiceQuestion(e,t,r,n){const i=new y.QueryResponse(n),o=t.getLowerCasedName(),a=255===t.type||5===t.type,c=i.addAnswer.bind(i),u=i.addAdditional.bind(i);if(o===e.getLowerCasedTypePTR())(a||12===t.type)&&i.addAnswer(e.ptrRecord())&&(i.addAdditional(e.txtRecord(),e.srvRecord()),this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),i.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()));else if(o===e.getLowerCasedFQDN())a?(i.addAnswer(e.txtRecord()),i.addAnswer(e.srvRecord())&&(this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),i.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))):33===t.type?i.addAnswer(e.srvRecord())&&(this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),i.addAdditional(e.serviceNSECRecord(!0),e.addressNSECRecord())):16===t.type&&(i.addAnswer(e.txtRecord()),i.addAdditional(e.serviceNSECRecord()));else if(o===e.getLowerCasedHostname()||o+"local."===e.getLowerCasedHostname())a?(this.addAddressRecords(e,r,1,c),this.addAddressRecords(e,r,28,c),i.addAdditional(e.addressNSECRecord())):1===t.type?(this.addAddressRecords(e,r,1,c)&&this.addAddressRecords(e,r,28,u),i.addAdditional(e.addressNSECRecord())):28===t.type&&(this.addAddressRecords(e,r,28,c)&&this.addAddressRecords(e,r,1,u),i.addAdditional(e.addressNSECRecord()));else if(e.getLowerCasedSubtypePTRs()&&(a||12===t.type)){const t=e.getLowerCasedSubtypePTRs().indexOf(o);if(-1!==t){const n=e.subtypePtrRecords()[t];(0,s.default)(o===n.name,"Question Name didn't match selected sub type ptr record!"),i.addAnswer(n)&&(i.addAdditional(e.txtRecord(),e.srvRecord()),this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),i.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}}return i}static addAddressRecords(e,t,r,n){const i=t.interface.endsWith("/6")?t.interface.substr(0,t.interface.length-2):t.interface;if(1===r){const t=e.aRecord(i);return!!t&&n(t)}if(28===r){const t=e.aaaaRecord(i),r=e.aaaaRoutableRecord(i),s=e.aaaaUniqueLocalRecord(i);let o=!1;if(t&&(o=n(t)),r){const e=n(r);o=o||e}if(s){const e=n(s);o=o||e}return o}s.default.fail("Illegal argument!")}}t.Responder=I,I.SERVICE_TYPE_ENUMERATION_NAME="_services._dns-sd._udp.local.",I.INSTANCES=new Map},7352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonCompressionLabelCoder=t.DNSLabelCoder=void 0;const n=r(1635).__importDefault(r(2613));class s{constructor(e){this.trackedLengths=[],this.writtenNames=[],this.legacyUnicastEncoding=e||!1}initBuf(e){this.buffer=e}initRRLocation(e,t,r){this.startOfRR=e,this.startOfRData=t,this.rDataLength=r}clearRRLocation(){this.startOfRR=void 0,this.startOfRData=void 0,this.rDataLength=void 0}getUncompressedNameLength(e){if("."===e)return 1;(0,n.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");let t=0;const r=e.split(".");for(let i=0;i<r.length;i++){const o=r[i];!o&&i<r.length-1&&n.default.fail("Label "+i+" in name '"+e+"' was empty"),t+=s.getLabelLength(o)}return t}getNameLength(e){if(s.DISABLE_COMPRESSION)return this.getUncompressedNameLength(e);if("."===e)return 1;(0,n.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");const t=e.split(".").map((e=>s.getLabelLength(e))),r={name:e,length:0,labelLengths:t};let i,o=0;for(let t=0;t<this.trackedLengths.length;t++){const r=this.trackedLengths[t],n=s.computeLabelSuffixLength(r.name,e);n>o&&(i=r,o=n)}let a=0;if(i){const e=t.length-1-o;for(let r=0;r<e;r++)a+=t[r];a+=2}else for(let e=0;e<t.length;e++)a+=t[e];return r.length=a,this.trackedLengths.push(r),r.length}encodeUncompressedName(e,t){return this.buffer||n.default.fail("Illegal state. Buffer not initialized!"),s.encodeUncompressedName(e,this.buffer,t)}static encodeUncompressedName(e,t,r){(0,n.default)(e.endsWith("."),"Name does not end with the root label");const s=r,i="."===e?[""]:e.split(".");for(let e=0;e<i.length;e++){const s=i[e];if(""===s){(0,n.default)(e===i.length-1,"Encountered root label being not at the end of the domain name"),t.writeUInt8(0,r++);break}const o=t.write(s,r+1);t.writeUInt8(o,r),r+=o+1}return r-s}encodeName(e,t){if(s.DISABLE_COMPRESSION)return this.encodeUncompressedName(e,t);if(this.buffer||n.default.fail("Illegal state. Buffer not initialized!"),"."===e)return this.buffer.writeUInt8(0,t),1;const r=t,i=e.split("."),o={name:e,writtenLabels:new Array(i.length).fill(-1)};let a,c=0;for(let t=0;t<this.writtenNames.length;t++){const r=this.writtenNames[t],n=s.computeLabelSuffixLength(r.name,e);n>c&&(a=r,c=n)}if(a){const e=i.length-1-c,r=a.writtenLabels.length-1-c;for(let r=0;r<e;r++)o.writtenLabels[r]=t,t+=s.writeLabel(i[r],this.buffer,t);const u=a.writtenLabels[r];(0,n.default)(-1!==u,"Label which was pointed at wasn't yet written to the buffer!"),(0,n.default)(u<=s.NOT_POINTER_MASK,"Pointer exceeds to length of a maximum of 14 bits"),(0,n.default)(u<t,"Pointer can only point to a prior location");const l=s.POINTER_MASK|u;this.buffer.writeUInt16BE(l,t),t+=2}else for(let e=0;e<i.length;e++)o.writtenLabels[e]=t,t+=s.writeLabel(i[e],this.buffer,t);return this.writtenNames.push(o),t-r}decodeName(e,t=!0){this.buffer||n.default.fail("Illegal state. Buffer not initialized!");const r=e;let i="";for(;;){const o=this.buffer.readUInt8(e++);if(0===o){i+=".";break}const a=o&s.POINTER_MASK_ONE_BYTE;if(a){if(a===s.POINTER_MASK_ONE_BYTE){const o=this.buffer.readUInt16BE(e-1)&s.NOT_POINTER_MASK;if(e++,!t){i+=i?".~":"~";break}(0,n.default)(o<r,"Pointer at "+(e-2)+" MUST point to a prior location!"),i+=(i?".":"")+this.decodeName(o).data;break}if(a===s.LOCAL_COMPRESSION_ONE_BYTE){let o=this.buffer.readUInt16BE(e-1)&s.NOT_POINTER_MASK;if(e++,!t){i+=i?".~":"~";break}o>=0&&o<255?((0,n.default)(void 0!==this.startOfRR,"Cannot decompress locally compressed name as record is not initialized!"),o+=this.startOfRR,(0,n.default)(o<r,"LocalPointer <255 at "+(e-2)+" MUST point to a prior location!"),i+=(i?".":"")+this.decodeName(o).data):o>=256?((0,n.default)(void 0!==this.startOfRData&&void 0!==this.rDataLength,"Cannot decompress locally compressed name as record is not initialized!"),o-=-256,o+=this.startOfRData,(0,n.default)(o<r,"LocationPoint >265 at "+(e+2)+" MUST point to a prior location!"),i+=(i?".":"")+this.decodeName(o).data):n.default.fail("Encountered unknown pointer range "+o);break}if(a===s.EXTENDED_LABEL_TYPE_ONE_BYTE){const t=o&s.NOT_POINTER_MASK_ONE_BYTE;n.default.fail("Received extended label type "+t+" at "+(e-1))}else n.default.fail("Encountered unknown pointer type: "+Buffer.from([a>>6]).toString("hex")+" (with original byte "+Buffer.from([o]).toString("hex")+")")}const c=this.buffer.toString("utf-8",e,e+o);e+=o,i+=(i?".":"")+c}return{data:i,readBytes:e-r}}static getLabelLength(e){if(e){const t=Buffer.byteLength(e);return(0,n.default)(t<=63,"Label cannot be longer than 63 bytes ("+e+")"),1+t}return 1}static writeLabel(e,t,r){if(e){const n=t.write(e,r+1);return t.writeUInt8(n,r),n+1}return t.writeUInt8(0,r),1}static computeLabelSuffixLength(e,t){(0,n.default)(0!==e.length&&0!==t.length,"Encountered empty name when comparing suffixes!");const r=e.length-1,s=t.length-1;let i=0,o=!1;for(let a=1;a<=r&&a<=s;a++){const c=e.charAt(r-a),u=t.charAt(s-a);if((0,n.default)(!!c&&!!u,"Seemingly encountered out of bounds trying to calculate suffixes"),c!==u){o=!0;break}"."===c&&i++}return o||i++,i}}t.DNSLabelCoder=s,s.DISABLE_COMPRESSION=!1,s.POINTER_MASK=49152,s.POINTER_MASK_ONE_BYTE=192,s.LOCAL_COMPRESSION_ONE_BYTE=128,s.EXTENDED_LABEL_TYPE_ONE_BYTE=64,s.NOT_POINTER_MASK=16383,s.NOT_POINTER_MASK_ONE_BYTE=63;class i extends s{getNameLength(e){return this.getUncompressedNameLength(e)}encodeName(e,t){return this.encodeUncompressedName(e,t)}}t.NonCompressionLabelCoder=i,i.INSTANCE=new i},4119:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DNSPacket=t.PacketType=t.QClass=t.RClass=t.QType=t.RType=t.RCode=t.OpCode=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(2017)),o=r(1673),a=r(7352),c=r(5682);r(9577);const u=r(5231);var l,d,h,p,f,m,g;function y(e){return"answers"in e}!function(e){e[e.QUERY=0]="QUERY"}(l||(t.OpCode=l={})),function(e){e[e.NoError=0]="NoError"}(d||(t.RCode=d={})),function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.PTR=12]="PTR",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA",e[e.SRV=33]="SRV",e[e.OPT=41]="OPT",e[e.NSEC=47]="NSEC"}(h||(t.RType=h={})),function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.PTR=12]="PTR",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA",e[e.SRV=33]="SRV",e[e.NSEC=47]="NSEC",e[e.ANY=255]="ANY"}(p||(t.QType=p={})),function(e){e[e.IN=1]="IN"}(f||(t.RClass=f={})),function(e){e[e.IN=1]="IN",e[e.ANY=255]="ANY"}(m||(t.QClass=m={})),function(e){e[e.QUERY=0]="QUERY",e[e.RESPONSE=1]="RESPONSE"}(g||(t.PacketType=g={}));class b{constructor(e){this.questions=new Map,this.answers=new Map,this.authorities=new Map,this.additionals=new Map,this.estimatedEncodingLength=0,this.lastCalculatedLength=0,this.lengthDirty=!0,this.id=e.id||0,this.legacyUnicastEncoding=e.legacyUnicast||!1,this.type=e.type,this.opcode=e.opcode||0,this.flags=e.flags||{},this.rcode=e.rCode||0,1===this.type&&(this.flags.authoritativeAnswer=!0),e.questions&&this.addQuestions(...e.questions),e.answers&&this.addAnswers(...e.answers),e.authorities&&this.addAuthorities(...e.authorities),e.additionals&&this.addAdditionals(...e.additionals)}static createDNSQueryPacket(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=this.createDNSQueryPackets(e,t);return(0,s.default)(1===r.length,"Cannot user short method createDNSQueryPacket when query packets are more than one: is "+r.length),r[0]}static createDNSQueryPackets(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=[],n=new b({type:0,questions:e.questions,additionals:y(e)?e.additionals:void 0});if(r.push(n),n.getEstimatedEncodingLength()>t){const e=n.getEncodingLength();e>t&&s.default.fail("Cannot send query where already the query section is exceeding the udpPayloadSize ("+e+">"+t+")!")}if(y(e)&&e.answers){let s=n,i=0;const o=e.answers.concat([]);for(o.sort(((e,t)=>e.getEncodingLength(a.NonCompressionLabelCoder.INSTANCE)-t.getEncodingLength(a.NonCompressionLabelCoder.INSTANCE)));i<o.length;){for(;i<o.length;i++){const e=o[i],r=e.getEncodingLength(a.NonCompressionLabelCoder.INSTANCE);if(n.getEstimatedEncodingLength()+r<=t)s.addAnswers(e);else{if(!(n.getEncodingLength()+r<=t)){0===s.questions.size&&0===s.answers.size&&n.addAnswers(e);break}s.addAnswers(e)}}i<o.length&&(s.flags.truncation=!0,s=new b({type:0}),r.push(s))}}else if("authorities"in e&&e.authorities){n.addAuthorities(...e.authorities);const r=n.getEncodingLength();r>t&&s.default.fail(`Probe query packet exceeds the mtu size (${r}>${t}). Can't split probe queries at the moment!`)}return r}static createDNSResponsePacketsFromRRSet(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=new b({id:e.id,legacyUnicast:e.legacyUnicast,type:1,flags:{authoritativeAnswer:!0},questions:e.questions,answers:e.answers,additionals:e.additionals});return r.getEncodingLength()>t&&s.default.fail("Couldn't construct a dns response packet from a rr set which fits in an udp payload sized packet!"),r}canBeCombinedWith(e,t=b.UDP_PAYLOAD_SIZE_IPV4){return this.id===e.id&&this.type===e.type&&this.opcode===e.opcode&&(0,i.default)(this.flags,e.flags)&&this.rcode===e.rcode&&this.getEncodingLength()+e.getEncodingLength()<=t}combineWith(e){this.setLegacyUnicastEncoding(this.legacyUnicastEncoding||e.legacyUnicastEncoding),this.addRecords(this.questions,e.questions.values()),this.addRecords(this.answers,e.answers.values(),this.additionals),this.addRecords(this.authorities,e.authorities.values()),this.addRecords(this.additionals,e.additionals.values())}addQuestions(...e){return this.addRecords(this.questions,e)}addAnswers(...e){return this.addRecords(this.answers,e,this.additionals)}addAuthorities(...e){return this.addRecords(this.authorities,e)}addAdditionals(...e){return this.addRecords(this.additionals,e)}addRecords(e,t,r){let n=!1;for(const s of t)e.has(s.asString())||(this.estimatedEncodingLength&&(this.estimatedEncodingLength+=s.getEncodingLength(a.NonCompressionLabelCoder.INSTANCE)),e.set(s.asString(),s),n=!0,this.lengthDirty=!0,r&&r.delete(s.asString()));return n}setLegacyUnicastEncoding(e){this.legacyUnicastEncoding!==e&&(this.lengthDirty=!0),this.legacyUnicastEncoding=e}legacyUnicastEncodingEnabled(){return this.legacyUnicastEncoding}getEstimatedEncodingLength(){if(this.estimatedEncodingLength)return this.estimatedEncodingLength;const e=a.NonCompressionLabelCoder.INSTANCE;let t=b.DNS_PACKET_HEADER_SIZE;for(const r of this.questions.values())t+=r.getEncodingLength(e);for(const r of this.answers.values())t+=r.getEncodingLength(e);for(const r of this.authorities.values())t+=r.getEncodingLength(e);for(const r of this.additionals.values())t+=r.getEncodingLength(e);return this.estimatedEncodingLength=t,t}getEncodingLength(e){if(!this.lengthDirty)return this.lastCalculatedLength;const t=e||new a.DNSLabelCoder(this.legacyUnicastEncoding);let r=b.DNS_PACKET_HEADER_SIZE;for(const e of this.questions.values())r+=e.getEncodingLength(t);for(const e of this.answers.values())r+=e.getEncodingLength(t);for(const e of this.authorities.values())r+=e.getEncodingLength(t);for(const e of this.additionals.values())r+=e.getEncodingLength(t);return this.lengthDirty=!1,this.lastCalculatedLength=r,this.estimatedEncodingLength=r,r}encode(){const e=new a.DNSLabelCoder(this.legacyUnicastEncoding),t=this.getEncodingLength(e),r=Buffer.allocUnsafe(t);e.initBuf(r);let n=0;r.writeUInt16BE(this.id,n),n+=2;let i=this.type<<15|this.opcode<<11|this.rcode;this.flags.authoritativeAnswer&&(i|=b.AUTHORITATIVE_ANSWER_MASK),this.flags.truncation&&(i|=b.TRUNCATION_MASK),this.flags.recursionDesired&&(i|=b.RECURSION_DESIRED_MASK),this.flags.recursionAvailable&&(i|=b.RECURSION_AVAILABLE_MASK),this.flags.zero&&(i|=b.ZERO_HEADER_MASK),this.flags.authenticData&&(i|=b.AUTHENTIC_DATA_MASK),this.flags.checkingDisabled&&(i|=b.CHECKING_DISABLED_MASK),r.writeUInt16BE(i,n),n+=2,r.writeUInt16BE(this.questions.size,n),n+=2,r.writeUInt16BE(this.answers.size,n),n+=2,r.writeUInt16BE(this.authorities.size,n),n+=2,r.writeUInt16BE(this.additionals.size,n),n+=2;for(const t of this.questions.values())n+=t.encode(e,r,n);for(const t of this.answers.values())n+=t.encode(e,r,n);for(const t of this.authorities.values())n+=t.encode(e,r,n);for(const t of this.additionals.values())n+=t.encode(e,r,n);return(0,s.default)(n===r.length,"Bytes written didn't match the buffer size!"),r}static decode(e,t,r=0){const n=new a.DNSLabelCoder;n.initBuf(t);const i=t.readUInt16BE(r);r+=2;const o=t.readUInt16BE(r);r+=2;const l=t.readUInt16BE(r);r+=2;const d=t.readUInt16BE(r);r+=2;const h=t.readUInt16BE(r);r+=2;const p=t.readUInt16BE(r);r+=2;const f=[],m=[],g=[],y=[];r+=b.decodeList(e,n,t,r,l,c.Question.decode.bind(c.Question),f),r+=b.decodeList(e,n,t,r,d,u.ResourceRecord.decode.bind(u.ResourceRecord),m),r+=b.decodeList(e,n,t,r,h,u.ResourceRecord.decode.bind(u.ResourceRecord),g),r+=b.decodeList(e,n,t,r,p,u.ResourceRecord.decode.bind(u.ResourceRecord),y),(0,s.default)(r===t.length,"Didn't read the full buffer (offset="+r+", length="+t.length+")");const v=o>>15,w=o>>11&15,C=15&o,_={};return o&this.AUTHORITATIVE_ANSWER_MASK&&(_.authoritativeAnswer=!0),o&this.TRUNCATION_MASK&&(_.truncation=!0),o&this.RECURSION_DESIRED_MASK&&(_.recursionDesired=!0),o&this.RECURSION_AVAILABLE_MASK&&(_.recursionAvailable=!0),o&this.ZERO_HEADER_MASK&&(_.zero=!0),o&this.AUTHENTIC_DATA_MASK&&(_.authenticData=!0),o&this.CHECKING_DISABLED_MASK&&(_.checkingDisabled=!0),new b({id:i,type:v,opcode:w,rCode:C,flags:_,questions:f,answers:m,authorities:g,additionals:y})}static decodeList(e,t,r,n,s,i,o){const a=n;for(let a=0;a<s;a++){const s=i(e,t,r,n);n+=s.readBytes,s.data&&o.push(s.data)}return n-a}asLoggingString(e){let t="",r="";for(const e of this.answers.values())t&&(t+=","),t+=(0,o.dnsTypeToString)(e.type);for(const e of this.additionals.values())r&&(r+=","),r+=(0,o.dnsTypeToString)(e.type);const n=[];this.legacyUnicastEncodingEnabled()&&n.push("U"),e&&n.push("UPS: "+e);const s=0!==n.length?` (${n})`:"";return`[${t}] answers and [${r}] additionals with size ${this.getEncodingLength()}B${s}`}}t.DNSPacket=b,b.UDP_PAYLOAD_SIZE_IPV4=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440,b.UDP_PAYLOAD_SIZE_IPV6=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440,b.AUTHORITATIVE_ANSWER_MASK=1024,b.TRUNCATION_MASK=512,b.RECURSION_DESIRED_MASK=256,b.RECURSION_AVAILABLE_MASK=128,b.ZERO_HEADER_MASK=64,b.AUTHENTIC_DATA_MASK=32,b.CHECKING_DISABLED_MASK=16,b.DNS_PACKET_HEADER_SIZE=12},5682:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Question=void 0;const n=r(7585);class s{constructor(e,t,r=!1,n=1){this.unicastResponseFlag=!1,e.endsWith(".")||(e+="."),this.name=e,this.type=t,this.class=n,this.unicastResponseFlag=r}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,n.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+4}encode(e,t,r){const n=r;r+=e.encodeName(this.name,r),t.writeUInt16BE(this.type,r),r+=2;let i=this.class;return this.unicastResponseFlag&&(i|=s.QU_MASK),t.writeUInt16BE(i,r),(r+=2)-n}clone(){return new s(this.name,this.type,this.unicastResponseFlag,this.class)}asString(){return`Q ${this.name} ${this.type} ${this.class}`}static decode(e,t,r,n){const i=n,o=t.decodeName(n);n+=o.readBytes;const a=r.readUInt16BE(n);n+=2;const c=r.readUInt16BE(n);n+=2;const u=c&this.NOT_QU_MASK,l=!!(c&this.QU_MASK);return{data:new s(o.data,a,l,u),readBytes:n-i}}}t.Question=s,s.QU_MASK=32768,s.NOT_QU_MASK=32767},5231:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceRecord=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(6672)),o=r(7585),a=r(1673),c=r(7352),u=(0,i.default)("ciao:decoder");class l{constructor(e,t,r=l.RR_DEFAULT_TTL,n=!1,s=1){this.flushFlag=!1,"string"==typeof e?(e.endsWith(".")||(e+="."),this.name=e,this.type=t,this.class=s,this.ttl=r,this.flushFlag=n):(this.name=e.name,this.type=e.type,this.class=e.class,this.ttl=e.ttl,this.flushFlag=e.flushFlag)}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,o.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+10+this.getRDataEncodingLength(e)}encode(e,t,r){const n=r;r+=e.encodeName(this.name,r),t.writeUInt16BE(this.type,r),r+=2;let s=this.class;this.flushFlag&&(s|=l.FLUSH_MASK),t.writeUInt16BE(s,r),r+=2,t.writeUInt32BE(this.ttl,r),r+=4;const i=this.encodeRData(e,t,r+2);return t.writeUInt16BE(i,r),(r+=2+i)-n}getRawData(){const e=c.NonCompressionLabelCoder.INSTANCE,t=this.getRDataEncodingLength(e),r=Buffer.allocUnsafe(t);e.initBuf(r);const n=this.encodeRData(e,r,0);return(0,s.default)(n===r.length,"Didn't completely write to the buffer! ("+n+"!="+r.length+")"),e.initBuf(),r}static clone(e){return e.map((e=>e.clone()))}getRecordRepresentation(){return{name:this.name,type:this.type,class:this.class,ttl:this.ttl,flushFlag:this.flushFlag}}aboutEqual(e){return this.type===e.type&&this.name===e.name&&this.class===e.class&&this.dataEquals(e)}representsSameData(e){return this.type===e.type&&this.name===e.name&&this.class===e.class}asString(){return`RR ${this.name} ${this.type} ${this.class} ${this.dataAsString()}`}static decode(e,t,r,n){const s=n,i=this.decodeRecordHeader(t,r,n);n+=i.readBytes;const o=i.data,c=this.typeToRecordDecoder.get(o.type);if(!c)return{readBytes:n+o.rDataLength-s};t.initRRLocation(s,n,o.rDataLength);const l=r.subarray(0,n+o.rDataLength);let d;try{d=c(t,o,l,n)}catch(t){return u(`Received malformed rdata section for ${(0,a.dnsTypeToString)(o.type)} ${o.name} ${o.ttl} from ${e.address}:${e.port} with data '${l.subarray(n).toString("hex")}': ${t.stack}`),{readBytes:n+o.rDataLength-s}}return n+=d.readBytes,t.clearRRLocation(),{data:d.data,readBytes:n-s}}static decodeRecordHeader(e,t,r){const n=r,s=e.decodeName(r);r+=s.readBytes;const i=t.readUInt16BE(r);r+=2;const o=t.readUInt16BE(r);let a;r+=2;let c=!1;41!==i?(a=o&this.NOT_FLUSH_MASK,c=!!(o&this.FLUSH_MASK)):a=o;const u=t.readUInt32BE(r);r+=4;const l=t.readUInt16BE(r);return r+=2,{data:{name:s.data,type:i,class:a,ttl:u,flushFlag:c,rDataLength:l},readBytes:r-n}}}t.ResourceRecord=l,l.typeToRecordDecoder=new Map,l.FLUSH_MASK=32768,l.NOT_FLUSH_MASK=32767,l.RR_DEFAULT_TTL_SHORT=120,l.RR_DEFAULT_TTL=4500},1673:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dnsTypeToString=function(e){switch(e){case 1:return"A";case 5:return"CNAME";case 12:return"PTR";case 16:return"TXT";case 28:return"AAAA";case 33:return"SRV";case 41:return"OPT";case 47:return"NSEC";case 255:return"ANY"}return"UNSUPPORTED_"+e}},1360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AAAARecord=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(9278)),o=r(9152),a=r(5231);class c extends a.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,28,n||c.DEFAULT_TTL,r):((0,s.default)(28===e.type),super(e)),(0,s.default)(i.default.isIPv6(t),"IP address is not in v6 format!"),this.ipAddress=t}getRDataEncodingLength(){return 16}encodeRData(e,t,r){const n=r,i=(0,o.enlargeIPv6)(this.ipAddress).split(":");(0,s.default)(8===i.length,"invalid IP address");for(const e of i){const n=parseInt(e,16);t.writeUInt16BE(n,r),r+=2}return r-n}static decodeData(e,t,r,n){const s=n,i=new Array(8);for(let e=0;e<8;e++){const t=r.readUInt16BE(n);n+=2,i[e]=t.toString(16)}const a=(0,o.shortenIPv6)(i.join(":"));return{data:new c(t,a),readBytes:n-s}}clone(){return new c(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.AAAARecord=c,c.DEFAULT_TTL=c.RR_DEFAULT_TTL_SHORT},4495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ARecord=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(9278)),o=r(5231);class a extends o.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,1,n||a.DEFAULT_TTL,r):((0,s.default)(1===e.type),super(e)),(0,s.default)(i.default.isIPv4(t),"IP address is not in IPv4 format!"),this.ipAddress=t}getRDataEncodingLength(){return 4}encodeRData(e,t,r){const n=r,i=this.ipAddress.split(".");(0,s.default)(4===i.length,"invalid ip address");for(const e of i){const n=parseInt(e,10);t.writeUInt8(n,r++)}return r-n}static decodeData(e,t,r,n){const s=n,i=new Array(4);for(let e=0;e<4;e++){const t=r.readUInt8(n++);i[e]=t.toString(10)}const o=i.join(".");return{data:new a(t,o),readBytes:n-s}}clone(){return new a(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.ARecord=a,a.DEFAULT_TTL=a.RR_DEFAULT_TTL_SHORT},5102:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CNAMERecord=void 0;const n=r(1635).__importDefault(r(2613)),s=r(7585),i=r(5231);class o extends i.ResourceRecord{constructor(e,t,r,s){"string"==typeof e?super(e,5,s,r):((0,n.default)(5===e.type),super(e)),t.endsWith(".")||(t+="."),this.cname=t}getLowerCasedCName(){return this.lowerCasedCName||(this.lowerCasedCName=(0,s.dnsLowerCase)(this.cname))}getRDataEncodingLength(e){return e.getNameLength(this.cname)}encodeRData(e,t,r){const n=r;return(r+=e.encodeName(this.cname,r))-n}static decodeData(e,t,r,n){const s=n,i=e.decodeName(n);return n+=i.readBytes,{data:new o(t,i.data),readBytes:n-s}}clone(){return new o(this.getRecordRepresentation(),this.cname)}dataAsString(){return this.cname}dataEquals(e){return this.getLowerCasedCName()===e.getLowerCasedCName()}}t.CNAMERecord=o,o.DEFAULT_TTL=i.ResourceRecord.RR_DEFAULT_TTL},6343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NSECRecord=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(2017)),o=r(7585),a=r(5231);class c extends a.ResourceRecord{constructor(e,t,r,n,i){"string"==typeof e?super(e,47,n||c.RR_DEFAULT_TTL_SHORT,i):((0,s.default)(47===e.type),super(e)),t.endsWith(".")||(t+="."),this.nextDomainName=t,this.rrTypeWindows=c.rrTypesToWindowMap(r)}getLowerCasedNextDomainName(){return this.lowerCasedNextDomainName||(this.lowerCasedNextDomainName=(0,o.dnsLowerCase)(this.nextDomainName))}getRRTypesBitMapEncodingLength(){let e=0;for(const t of this.rrTypeWindows)(0,s.default)(t.rrtypes.length>0,"types array for windowId "+t.windowId+" cannot be empty!"),e+=2+t.bitMapSize;return e}getRDataEncodingLength(e){return e.legacyUnicastEncoding,e.getUncompressedNameLength(this.nextDomainName)+this.getRRTypesBitMapEncodingLength()}encodeRData(e,t,r){const n=r;r+=(e.legacyUnicastEncoding,e.encodeUncompressedName(this.nextDomainName,r));for(const e of this.rrTypeWindows){t.writeUInt8(e.windowId,r++),t.writeUInt8(e.bitMapSize,r++);const n=Buffer.alloc(e.bitMapSize);for(const t of e.rrtypes){const e=(255&t)>>3;let r=n.readUInt8(e);r|=1<<7-(7&t),n.writeUInt8(r,e)}n.copy(t,r),r+=n.length}return r-n}static decodeData(e,t,r,n){const s=n,i=e.decodeName(n,!1);n+=i.readBytes;const o=[];for(;n<r.length;){const e=r.readUInt8(n++),t=r.readUInt8(n++),s=e<<8;for(let e=0;e<t;e++){const t=r.readUInt8(n++);for(let r=0;r<8;r++)if(t&1<<7-r){const t=s|e<<3|r;o.push(t)}}}return{data:new c(t,i.data,o),readBytes:n-s}}clone(){return new c(this.getRecordRepresentation(),this.nextDomainName,c.windowsToRRTypes(this.rrTypeWindows))}dataAsString(){return`${this.nextDomainName} [${c.windowsToRRTypes(this.rrTypeWindows).map((e=>""+e)).join(",")}]`}dataEquals(e){return this.getLowerCasedNextDomainName()===e.getLowerCasedNextDomainName()&&(0,i.default)(this.rrTypeWindows,e.rrTypeWindows)}static rrTypesToWindowMap(e){const t=[];for(const r of e){const e=r>>8;let n;for(const r of t)if(r.windowId===e){n=r;break}if(n){n.rrtypes.push(r);const e=Math.ceil((255&r)/8);e>n.bitMapSize&&(n.bitMapSize=e)}else n={windowId:e,bitMapSize:Math.ceil((255&r)/8),rrtypes:[r]},t.push(n)}return t.sort(((e,t)=>e.windowId-t.windowId)),t.forEach((e=>e.rrtypes.sort(((e,t)=>e-t)))),t}static windowsToRRTypes(e){const t=[];for(const r of e)t.push(...r.rrtypes);return t}}t.NSECRecord=c},6141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OPTRecord=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(2017)),o=r(5231);class a extends o.ResourceRecord{constructor(e,t,r,n,i,o){"number"==typeof e?(super(".",41,o,!1,e),this.udpPayloadSize=e):((0,s.default)(41===e.type),super(e),this.udpPayloadSize=e.class),this.extendedRCode=r||0,this.ednsVersion=i||a.EDNS_VERSION,this.flags={dnsSecOK:(null==n?void 0:n.dnsSecOK)||!1,zero:(null==n?void 0:n.zero)||0,...n},this.options=t||[]}getRDataEncodingLength(){let e=0;for(const t of this.options)e+=4+t.data.length;return e}encodeRData(e,t,r){const n=r,s=r-8,i=r-6;t.writeUInt16BE(this.udpPayloadSize,s),t.writeUInt8(this.extendedRCode,i),t.writeUInt8(this.ednsVersion,i+1);let o=this.flags.zero||0;this.flags.dnsSecOK&&(o|=a.DNS_SEC_OK_MASK),t.writeUInt16BE(o,i+2);for(const e of this.options)t.writeUInt16BE(e.code,r),r+=2,t.writeUInt16BE(e.data.length,r),r+=2,e.data.copy(t,r),r+=e.data.length;return r-n}static decodeData(e,t,r,n){const s=n,i=n-8,o=n-6,c=r.readUInt16BE(i),u=r.readUInt8(o),l=r.readUInt8(o+1),d=r.readUInt16BE(o+2),h={dnsSecOK:!!(d&a.DNS_SEC_OK_MASK),zero:d&a.NOT_DNS_SEC_OK_MASK},p=[];for(;n<r.length;){const e=r.readUInt16BE(n);n+=2;const t=r.readUInt16BE(n);n+=2;const s=r.subarray(n,n+t);n+=t,p.push({code:e,data:s})}return t.class=c,t.ttl=4500,{data:new a(t,p,u,h,l),readBytes:n-s}}clone(){return new a(this.getRecordRepresentation(),this.options,this.extendedRCode,this.flags,this.ednsVersion)}dataAsString(){return`${this.udpPayloadSize} ${this.extendedRCode} ${this.ednsVersion} ${JSON.stringify(this.flags)} [${this.options.map((e=>`${e.code} ${e.data.toString("base64")}`)).join(",")}]`}dataEquals(e){return this.udpPayloadSize===e.udpPayloadSize&&this.extendedRCode===e.extendedRCode&&this.ednsVersion===e.ednsVersion&&a.optionsEquality(this.options,e.options)&&(0,i.default)(this.flags,e.flags)}static optionsEquality(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){if(e[r].code!==t[r].code)return!1;if(e[r].data.toString("hex")!==t[r].data.toString("hex"))return!1}return!0}}t.OPTRecord=a,a.EDNS_VERSION=0,a.DNS_SEC_OK_MASK=32768,a.NOT_DNS_SEC_OK_MASK=32767},482:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PTRRecord=void 0;const n=r(1635).__importDefault(r(2613)),s=r(7585),i=r(5231);class o extends i.ResourceRecord{constructor(e,t,r,s){"string"==typeof e?super(e,12,s,r):((0,n.default)(12===e.type),super(e)),t.endsWith(".")||(t+="."),this.ptrName=t}getLowerCasedPTRName(){return this.lowerCasedPtrName||(this.lowerCasedPtrName=(0,s.dnsLowerCase)(this.ptrName))}getRDataEncodingLength(e){return e.getNameLength(this.ptrName)}encodeRData(e,t,r){const n=r;return(r+=e.encodeName(this.ptrName,r))-n}static decodeData(e,t,r,n){const s=n,i=e.decodeName(n);return n+=i.readBytes,{data:new o(t,i.data),readBytes:n-s}}clone(){return new o(this.getRecordRepresentation(),this.ptrName)}dataAsString(){return this.ptrName}dataEquals(e){return this.getLowerCasedPTRName()===e.getLowerCasedPTRName()}}t.PTRRecord=o,o.DEFAULT_TTL=i.ResourceRecord.RR_DEFAULT_TTL},8225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SRVRecord=void 0;const n=r(1635).__importDefault(r(2613)),s=r(7585),i=r(5231);class o extends i.ResourceRecord{constructor(e,t,r,s,i){"string"==typeof e?super(e,33,i||o.RR_DEFAULT_TTL_SHORT,s):((0,n.default)(33===e.type),super(e)),t.endsWith(".")?this.hostname=t:this.hostname=t+".",this.port=r,this.priority=0,this.weight=0}getLowerCasedHostname(){return this.lowerCasedHostname||(this.lowerCasedHostname=(0,s.dnsLowerCase)(this.hostname))}getRDataEncodingLength(e){return 6+(e.legacyUnicastEncoding?e.getUncompressedNameLength(this.hostname):e.getNameLength(this.hostname))}encodeRData(e,t,r){const n=r;return t.writeUInt16BE(this.priority,r),r+=2,t.writeUInt16BE(this.weight,r),r+=2,t.writeUInt16BE(this.port,r),r+=2,(r+=e.legacyUnicastEncoding?e.encodeUncompressedName(this.hostname,r):e.encodeName(this.hostname,r))-n}static decodeData(e,t,r,n){const s=n;n+=2,n+=2;const i=r.readUInt16BE(n);n+=2;const a=e.decodeName(n);return n+=a.readBytes,{data:new o(t,a.data,i),readBytes:n-s}}clone(){return new o(this.getRecordRepresentation(),this.hostname,this.port)}dataAsString(){return`${this.hostname} ${this.port} ${this.priority} ${this.weight}`}dataEquals(e){return this.getLowerCasedHostname()===e.getLowerCasedHostname()&&this.port===e.port&&this.weight===e.weight&&this.priority===e.priority}}t.SRVRecord=o,o.DEFAULT_TTL=120},1576:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TXTRecord=void 0;const n=r(1635).__importDefault(r(2613)),s=r(5231);class i extends s.ResourceRecord{constructor(e,t,r,s){"string"==typeof e?super(e,16,s,r):((0,n.default)(16===e.type),super(e)),this.txt=0===t.length?[Buffer.from([])]:t}getRDataEncodingLength(){let e=0;for(const t of this.txt)e+=1+t.length,(0,n.default)(t.length<=255,"One txt character-string can only have a length of 255 chars");return e}encodeRData(e,t,r){const n=r;for(const e of this.txt)t.writeUInt8(e.length,r++),e.copy(t,r),r+=e.length;return r-n}clone(){return new i(this.getRecordRepresentation(),this.txt)}dataAsString(){return`[${this.txt.map((e=>`${e.toString("base64")}`)).join(",")}]`}dataEquals(e){if(this.txt.length!==e.txt.length)return!1;for(let t=0;t<this.txt.length;t++)if(this.txt[t].toString("hex")!==e.txt[t].toString("hex"))return!1;return!0}static decodeData(e,t,r,n){const s=n,o=[];for(;n<r.length;){const e=r.readUInt8(n++);o.push(r.subarray(n,n+e)),n+=e}return{data:new i(t,o),readBytes:n-s}}}t.TXTRecord=i,i.DEFAULT_TTL=s.ResourceRecord.RR_DEFAULT_TTL},9577:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5231),s=r(1360),i=r(4495),o=r(5102),a=r(6343),c=r(6141),u=r(482),l=r(8225),d=r(1576);n.ResourceRecord.typeToRecordDecoder.set(28,s.AAAARecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(1,i.ARecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(5,o.CNAMERecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(47,a.NSECRecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(12,u.PTRRecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(33,l.SRVRecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(41,c.OPTRecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(16,d.TXTRecord.decodeData)},8318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Protocol=void 0,t.getResponder=c;const n=r(1635);r(3476);const s=n.__importDefault(r(6672)),i=r(3325).rE;if(i.includes("beta")||process.env.BCT){const e=process.env.DEBUG;e&&e.includes("ciao")||(e?s.default.enable(e+",ciao:*"):s.default.enable("ciao:*"))}r(9577);const o=r(4288);var a;function c(e){return o.Responder.getResponder(e)}n.__exportStar(r(141),t),n.__exportStar(r(4288),t),(0,s.default)("ciao:init")("Loading ciao v"+i+"..."),function(e){e.TCP="tcp",e.UDP="udp"}(a||(t.Protocol=a={})),t.default={getResponder:c}},9983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Announcer=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(6672)),o=r(4119),a=r(2361),c=r(8390),u=(0,i.default)("ciao:Announcer");class l{constructor(e,t,r){this.repetitions=1,this.announceIntervalIncreaseFactor=2,this.goodbye=!1,this.sentAnnouncements=0,this.sentLastAnnouncement=!1,this.nextInterval=1e3,this.nextAnnouncementTime=0,(0,s.default)(e,"server must be defined"),(0,s.default)(t,"service must be defined"),this.server=e,this.service=t,r&&(void 0!==r.repetitions&&(this.repetitions=r.repetitions),r.goodbye&&(this.goodbye=!0)),(0,s.default)(this.repetitions>0&&this.repetitions<=8,"repetitions must in [1;8]")}announce(){return u("[%s] Sending %s for service",this.service.getFQDN(),this.goodbye?"goodbye":"announcement"),this.goodbye||this.service.rebuildServiceRecords(),this.promise=new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.timer=setTimeout(this.sendAnnouncement.bind(this),0),this.timer.unref(),this.nextAnnouncementTime=(new Date).getTime()}))}async cancel(){return u("[%s] Canceling %s",this.service.getFQDN(),this.goodbye?"goodbye":"announcement"),this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.promiseReject(l.CANCEL_REASON),this.awaitAnnouncement().catch((e=>{if(e!==l.CANCEL_REASON)return Promise.reject(e)}))}hasSentLastAnnouncement(){return this.sentLastAnnouncement}async awaitAnnouncement(){await this.promise}isSendingGoodbye(){return this.goodbye}sendAnnouncement(){u("[%s] Sending %s number %d",this.service.getFQDN(),this.goodbye?"goodbye":"announcement",this.sentAnnouncements+1);const e=[this.service.ptrRecord(),...this.service.subtypePtrRecords(),this.service.srvRecord(),this.service.txtRecord()];if(this.goodbye)for(const t of e)t.ttl=0;else e.push(this.service.metaQueryPtrRecord());this.sentAnnouncements+1>=this.repetitions&&(this.sentLastAnnouncement=!0),l.sendResponseAddingAddressRecords(this.server,this.service,e,this.goodbye).then((e=>{const t=(0,a.SendResultFailedRatio)(e);if(1===t)return console.error((0,a.SendResultFormatError)(e,`[${this.service.getFQDN()}] Failed to send ${this.goodbye?"goodbye":"announcement"} requests`),!0),void this.promiseReject(new Error((this.goodbye?"Goodbye":"Announcement")+" failed as of socket errors!"));t>0&&u((0,a.SendResultFormatError)(e,`Some of the ${this.goodbye?"goodbye":"announcement"} requests for '${this.service.getFQDN()}' encountered an error`)),"announcing"===this.service.serviceState?(this.sentAnnouncements++,this.sentAnnouncements>=this.repetitions?this.promiseResolve():(this.timer=setTimeout(this.sendAnnouncement.bind(this),this.nextInterval),this.timer.unref(),this.nextAnnouncementTime=(new Date).getTime()+this.nextInterval,this.nextInterval*=this.announceIntervalIncreaseFactor)):u("[%s] Service is no longer in announcing state. Stopping. (Received %s)",this.service.getFQDN(),this.service.serviceState)}))}static sendResponseAddingAddressRecords(e,t,r,n){const s=[];for(const i of e.getBoundInterfaceNames()){if(!t.advertisesOnInterface(i))continue;const u=r.concat([]),l=t.aRecord(i),d=t.aaaaRecord(i),h=t.aaaaRoutableRecord(i),p=t.aaaaUniqueLocalRecord(i),f=t.addressNSECRecord(),m=t.serviceNSECRecord();l&&(n&&(l.ttl=0),u.push(l)),d&&(n&&(d.ttl=0),u.push(d)),h&&(n&&(h.ttl=0),u.push(h)),p&&(n&&(p.ttl=0),u.push(p)),n&&(f.ttl=0,m.ttl=0);const g=[];g.push(f,m);const y=o.DNSPacket.createDNSResponsePacketsFromRRSet({answers:u,additionals:g});s.push(Promise.race([e.send(y,i),(0,c.PromiseTimeout)(a.MDNSServer.SEND_TIMEOUT).then((()=>({status:"timeout",interface:i})))]))}return Promise.all(s)}}t.Announcer=l,l.CANCEL_REASON="CIAO ANNOUNCEMENT CANCELLED"},2475:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Prober=void 0;const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(6672)),o=r(5682),a=r(2361),c=n.__importStar(r(6948)),u=r(6948),l=(0,i.default)("ciao:Prober");class d{constructor(e,t,r){this.records=[],this.currentInterval=250,this.serviceEncounteredNameChange=!1,this.sentFirstProbeQuery=!1,this.sentQueriesForCurrentTry=0,this.sentQueries=0,(0,s.default)(e,"responder must be defined"),(0,s.default)(t,"server must be defined"),(0,s.default)(r,"service must be defined"),this.responder=e,this.server=t,this.service=r}getService(){return this.service}probe(){return l("Starting to probe for '%s'...",this.service.getFQDN()),new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.timer=setTimeout(this.sendProbeRequest.bind(this),250*Math.random()),this.timer.unref()}))}cancel(){this.clear(),this.promiseReject(d.CANCEL_REASON)}clear(){this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.sentFirstProbeQuery=!1,this.sentQueriesForCurrentTry=0}endProbing(e){this.clear(),e&&(l("Probing for '%s' finished successfully",this.service.getFQDN()),this.promiseResolve(),this.serviceEncounteredNameChange&&this.service.informAboutNameUpdates())}sendProbeRequest(){if(0===this.sentQueriesForCurrentTry&&(this.records=[this.service.srvRecord(),this.service.txtRecord(),this.service.ptrRecord(),...this.service.subtypePtrRecords(),...this.service.allAddressRecords()].sort(u.rrComparator),this.records.forEach((e=>e.flushFlag=!1))),this.sentQueriesForCurrentTry>=3)return void this.endProbing(!0);this.sentQueries>=15&&(this.currentInterval=1e3),l("Sending prober query number %d for '%s'...",this.sentQueriesForCurrentTry+1,this.service.getFQDN()),(0,s.default)(this.records.length>0,"Tried sending probing request for zero record length!");const e=[new o.Question(this.service.getFQDN(),255,!0),new o.Question(this.service.getHostname(),255,!0)];this.server.sendQueryBroadcast({questions:e,authorities:this.records},this.service).then((e=>{const t=(0,a.SendResultFailedRatio)(e);if(1===t)return console.error((0,a.SendResultFormatError)(e,`Failed to send probe queries for '${this.service.getFQDN()}'`),!0),this.endProbing(!1),void this.promiseReject(new Error("Probing failed as of socket errors!"));t>0&&l((0,a.SendResultFormatError)(e,`Some of the probe queries for '${this.service.getFQDN()}' encountered an error`)),"probing"===this.service.serviceState?(this.sentFirstProbeQuery=!0,this.sentQueriesForCurrentTry++,this.sentQueries++,this.timer=setTimeout(this.sendProbeRequest.bind(this),this.currentInterval),this.timer.unref(),this.checkLocalConflicts()):l("Service '%s' is no longer in probing state. Stopping.",this.service.getFQDN())}))}checkLocalConflicts(){let e=!1;for(const t of this.responder.getAnnouncedServices())if(t.getLowerCasedFQDN()===this.service.getLowerCasedFQDN()||t.getLowerCasedHostname()===this.service.getLowerCasedHostname()){e=!0;break}e&&(l("Probing for '%s' failed as of local service. Doing a name change",this.service.getFQDN()),this.handleNameChange())}handleResponse(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface))return;let r=!1;for(const t of e.answers.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}for(const t of e.additionals.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}r&&(l("Probing for '%s' failed. Doing a name change",this.service.getFQDN()),this.handleNameChange())}handleNameChange(){this.endProbing(!1),this.service.serviceState="unannounced",this.service.incrementName(),this.service.serviceState="probing",this.serviceEncounteredNameChange=!0,this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3),this.timer.unref()}handleQuery(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface))return;let r=!1;for(const t of e.questions.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}r&&this.doTiebreaking(e)}doTiebreaking(e){if(!this.sentFirstProbeQuery)return;let t=0===e.authorities.size;for(const r of e.authorities.values())if(r.getLowerCasedName()===this.service.getLowerCasedFQDN()||r.getLowerCasedName()===this.service.getLowerCasedHostname()){t=!0;break}if(!t)return;const r=this.records,n=Array.from(e.authorities.values()).sort(c.rrComparator),s=c.runTiebreaking(r,n);1===s?l("'%s' won the tiebreak. We gonna ignore the other probing request!",this.service.getFQDN()):-1===s&&(l("'%s' lost the tiebreak. We are waiting a second and try to probe again...",this.service.getFQDN()),this.endProbing(!1),this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3),this.timer.unref())}}t.Prober=d,d.CANCEL_REASON="CIAO PROBING CANCELLED"},572:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryResponse=void 0;const n=r(4119);t.QueryResponse=class{constructor(e){this.sharedAnswer=!1,this.dnsPacket=new n.DNSPacket({type:1}),this.knownAnswers=e}asPacket(){return this.dnsPacket}asString(e){return this.dnsPacket.asLoggingString(e)}containsSharedAnswer(){return this.sharedAnswer}addAnswer(...e){let t=!1;for(const r of e)this.isKnownAnswer(r)||this.dnsPacket.addAnswers(r)&&(t=!0,r.flushFlag||(this.sharedAnswer=!0));return t}addAdditional(...e){let t=!1;for(const r of e)this.isKnownAnswer(r)||this.dnsPacket.answers.has(r.asString())||this.dnsPacket.addAdditionals(r)&&(t=!0);return t}markLegacyUnicastResponse(e,t){this.dnsPacket.id=e,t&&this.dnsPacket.addQuestions(...t),this.dnsPacket.answers.forEach((e=>{e.flushFlag=!1,e.ttl=10})),this.dnsPacket.additionals.forEach((e=>{e.flushFlag=!1,e.ttl=10})),this.dnsPacket.setLegacyUnicastEncoding(!0)}markTruncated(){this.dnsPacket.flags.truncation=!0}hasAnswers(){return this.dnsPacket.answers.size>0}isKnownAnswer(e){if(!this.knownAnswers)return!1;const t=this.knownAnswers.get(e.asString());return void 0!==t&&t.ttl>e.ttl/2}static combineResponses(e,t){for(let r=0;r<e.length-1;r++){const n=e[r],s=n.dnsPacket,i=e[r+1],o=i.dnsPacket;s.canBeCombinedWith(o,t)&&(s.combineWith(o),e.splice(r+1,1),n.sharedAnswer=n.sharedAnswer||i.sharedAnswer,r--)}}}},5745:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueuedResponse=void 0;class r{constructor(e,t){this.timeOfCreation=(new Date).getTime(),this.estimatedTimeToBeSent=0,this.delay=-1,this.packet=e,this.interfaceName=t}getPacket(){return this.packet}getTimeSinceCreation(){return(new Date).getTime()-this.timeOfCreation}getTimeTillSent(){return Math.max(0,this.estimatedTimeToBeSent-(new Date).getTime())}calculateRandomDelay(){this.delay=100*Math.random()+20,this.estimatedTimeToBeSent=(new Date).getTime()+this.delay}scheduleResponse(e){this.timer=setTimeout(e,this.delay),this.timer.unref()}delayWouldBeInTimelyManner(e){return e.estimatedTimeToBeSent-this.timeOfCreation<=r.MAX_DELAY}combineWithNextPacketIfPossible(e){return this.interfaceName===e.interfaceName&&!!e.packet.canBeCombinedWith(this.packet)&&(e.packet.combineWith(this.packet),e.timeOfCreation=Math.min(this.timeOfCreation,e.timeOfCreation),this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.delayed=!0,!0)}combineWithUniqueResponseIfPossible(e,t){return this.interfaceName===t&&!!this.packet.canBeCombinedWith(e.asPacket())&&(this.packet.combineWith(e.asPacket()),!0)}}t.QueuedResponse=r,r.MAX_DELAY=500},341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TruncatedQuery=t.TruncatedQueryEvent=t.TruncatedQueryResult=void 0;const n=r(4434);var s,i;!function(e){e[e.ABORT=1]="ABORT",e[e.AGAIN_TRUNCATED=2]="AGAIN_TRUNCATED",e[e.FINISHED=3]="FINISHED"}(s||(t.TruncatedQueryResult=s={})),function(e){e.TIMEOUT="timeout"}(i||(t.TruncatedQueryEvent=i={}));class o extends n.EventEmitter{constructor(e){super(),this.arrivedPackets=1,this.timeOfArrival=(new Date).getTime(),this.packet=e,this.timer=this.resetTimer()}getPacket(){return this.packet}getArrivedPacketCount(){return this.arrivedPackets}getTotalWaitTime(){return(new Date).getTime()-this.timeOfArrival}appendDNSPacket(e){return this.packet.combineWith(e),this.arrivedPackets++,e.flags.truncation?(new Date).getTime()-this.timeOfArrival>5e3?1:(this.resetTimer(),2):(clearTimeout(this.timer),this.removeAllListeners(),3)}resetTimer(){return this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.timeout.bind(this),400+100*Math.random())}timeout(){this.emit("timeout"),this.removeAllListeners()}}t.TruncatedQuery=o},7585:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dnsLowerCase=function(e){return e.replace(r,(e=>e.toLowerCase()))};const r=/[A-Z]/g},9152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFQDN=function(e){const t=e.split(".");(0,s.default)(t.length>=3,"Received illegal fqdn: "+e);let r=t.length-1,n="";for(;"_tcp"!==(i=t[r])&&"_udp"!==i;)n=a(t[r])+(n?"."+n:""),r--;var i;(0,s.default)(r>=1,"Failed to parse illegal fqdn: "+e);const o=a(t[r--]),c=a(t[r--]);return r<0?{domain:n,protocol:o,type:c}:function(e){return"_sub"===e}(t[r])?(r--,(0,s.default)(0===r,"Received illegal formatted sub type fqdn: "+e),{domain:n,protocol:o,type:c,subtype:a(t[r])}):{domain:n,protocol:o,type:c,name:a(t.slice(0,r+1).join("."))}},t.stringify=function(e){let t;return(0,s.default)(e.type,"type cannot be undefined"),(0,s.default)(e.type.length<=15,"type must not be longer than 15 characters"),t=function(e){return"subtype"in e}(e)?`_${e.subtype}._sub.`:e.name?`${e.name}.`:"",`${t}_${e.type}._${e.protocol||"tcp"}.${e.domain||"local"}.`},t.formatHostname=function(e,t="local"){(0,s.default)(!e.endsWith("."),"hostname must not end with the root label!");const r="."+t;return(e.endsWith(r)?e:e+r)+"."},t.removeTLD=function(e){e.endsWith(".")&&(e=e.substring(0,e.length-1));const t=e.lastIndexOf(".");return e.slice(0,t)},t.formatMappedIPv4Address=function(e){(0,o.isIPv4Mapped)(e)||(0,s.default)(i.default.isIPv4(e),"Illegal argument. Must be an IPv4 address!"),(0,s.default)(i.default.isIPv4(e),"Illegal argument. Must be an IPv4 address!");return`::ffff:${e.split(".").map((e=>parseInt(e).toString(16).padStart(2,"0"))).join("")}`.replace(/(.{4})(.{4})$/,"$1:$2")},t.enlargeIPv6=c,t.shortenIPv6=u,t.formatReverseAddressPTRName=function(e){if(i.default.isIPv4(e))return e.split(".").reverse().join(".")+".in-addr.arpa";if(!i.default.isIPv6(e))throw new Error("Supplied illegal ip address format: "+e);if((0,o.isIPv4Mapped)(e))return(0,o.getIPFromV4Mapped)(e).split(".").reverse().join(".")+".in-addr.arpa";const t=(e=c(e).toUpperCase()).replace(/:/g,"").split("").reverse();return(0,s.default)(32===t.length,"Encountered invalid ipv6 address length! "+t.length),t.join(".")+".ip6.arpa"},t.ipAddressFromReversAddressName=function(e){if((e=e.toLowerCase()).endsWith(".in-addr.arpa"))return e.replace(".in-addr.arpa","").split(".").reverse().join(".");if(e.endsWith(".ip6.arpa")){const t=e.replace(".ip6.arpa","").split(".").reverse();(0,s.default)(32===t.length,"Encountered illegal length for .ip6.arpa split!");const r=[];for(let e=0;e<t.length;e+=4)r.push(t.slice(e,e+4).join(""));return u(r.join(":"))}throw new Error("Supplied unknown reverse address name format: "+e)},t.getNetAddress=function(e,t){if((0,s.default)(i.default.isIP(e)===i.default.isIP(t),"IP address version must match. Netmask cannot have a version different from the address!"),i.default.isIPv4(e)){const r=e.split("."),n=t.split("."),s=new Array(4);for(let e=0;e<r.length;e++){const t=parseInt(r[e]),i=parseInt(n[e]);s[e]=(t&i).toString()}return s.join(".")}if(i.default.isIPv6(e)){const r=c(e).split(":"),n=c(t).split(":"),s=new Array(8);for(let e=0;e<r.length;e++){const t=parseInt(r[e],16),i=parseInt(n[e],16);s[e]=(t&i).toString(16)}return u(c(s.join(":")))}throw new Error("Illegal argument. Address is not an ip address!")};const n=r(1635),s=n.__importDefault(r(2613)),i=n.__importDefault(r(9278)),o=r(10);function a(e){return e.startsWith("_")?e.slice(1):e}function c(e){(0,s.default)(i.default.isIPv6(e),"Illegal argument. Must be ipv6 address!");const t=e.split("::"),r=t[0]?t[0].split(":"):[],n=t[1]?t[1].split(":"):[],o=new Array(8-r.length-n.length).fill("0000");return[...r,...o,...n].map((e=>e.padStart(4,"0"))).join(":")}function u(e){"string"==typeof e&&(e=e.split(":"));for(let t=0;t<e.length;t++){const r=e[t];let n=0;for(;n<Math.min(3,r.length-1)&&"0"===r.charAt(n);n++);e[t]=r.substr(n)}let t=-1,r=0;for(let n=0;n<e.length;n++){if("0"!==e[n])continue;let s=1,i=n+1;for(;i<e.length&&"0"===e[i];i++)s++;s>r&&(t=n,r=s),n=i}if(-1!==t){const n=0===t||t+r===8;e[t]=n?":":"",r>1&&e.splice(t+1,r-1)}const n=e.join(":");return":"===n?"::":n}},16:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerClosedError=t.InterfaceNotFoundError=t.ERR_SERVER_CLOSED=t.ERR_INTERFACE_NOT_FOUND=void 0,t.ERR_INTERFACE_NOT_FOUND="ERR_INTERFACE_NOT_FOUND",t.ERR_SERVER_CLOSED="ERR_SERVER_CLOSED";class r extends Error{constructor(e){super(e),this.name="ERR_INTERFACE_NOT_FOUND"}}t.InterfaceNotFoundError=r;class n extends Error{constructor(e){super(e),this.name=t.ERR_SERVER_CLOSED}}t.ServerClosedError=n},8390:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseTimeout=function(e){return new Promise((t=>{setTimeout((()=>t()),e)}))}},5762:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortedInsert=function(e,t,r){let n=0,s=e.length-1,i=-1;for(;n<s;){const o=Math.floor((n+s)/2),a=r(t,e[o]);if(0===a){i=o+1;break}a<0?s=o-1:n=o+1}0===e.length?i=0:i<0&&(i=r(t,e[n])>0?n+1:n),e.splice(i,0,t)}},6948:(e,t)=>{"use strict";function r(e,t){if(e.class!==t.class)return e.class-t.class;if(e.type!==t.type)return e.type-t.type;const r=e.getRawData(),n=t.getRawData(),s=Math.max(r.length,n.length);for(let e=0;e<s;e++){if(e>=r.length&&e<n.length)return-1;if(e>=n.length&&e<r.length)return 1;const t=r.readUInt8(e),s=n.readUInt8(e);if(t!==s)return t<s?-1:1}return 0}var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TiebreakingResult=void 0,t.rrComparator=r,t.runTiebreaking=function(e,t){const n=Math.max(e.length,t.length);for(let s=0;s<n;s++){if(s>=e.length&&s<t.length)return-1;if(s>=t.length&&s<e.length)return 1;const n=r(e[s],t[s]);if(0!==n)return n}return 0},function(e){e[e.OPPONENT=-1]="OPPONENT",e[e.TIE=0]="TIE",e[e.HOST=1]="HOST"}(n||(t.TiebreakingResult=n={}))},10:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIPv4Mapped=function(e){var t;if(!/^::ffff:(\d{1,3}\.){3}\d{1,3}$/i.test(e))return!1;const r=null===(t=e.split(/::ffff:/i)[1])||void 0===t?void 0:t.split(".").map(Number);return 4===(null==r?void 0:r.length)&&r.every((e=>e>=0&&e<=255))},t.getIPFromV4Mapped=function(e){var t;return null!==(t=e.split(/^::ffff:/i)[1])&&void 0!==t?t:null}},3676:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(2755)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2755:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e,t){let r=0,n=0,s=-1,i=0;for(;r<e.length;)if(n<t.length&&(t[n]===e[r]||"*"===t[n]))"*"===t[n]?(s=n,i=r,n++):(r++,n++);else{if(-1===s)return!1;n=s+1,i++,r=i}for(;n<t.length&&"*"===t[n];)n++;return n===t.length}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names,...t.skips.map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const e of r)"-"===e[0]?t.skips.push(e.slice(1)):t.names.push(e)},t.enabled=function(e){for(const r of t.skips)if(s(e,r))return!1;for(const r of t.names)if(s(e,r))return!0;return!1},t.humanize=r(6585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},6672:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(3676):e.exports=r(3518)},3518:(e,t,r)=>{const n=r(9637),s=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(s.formatWithOptions(t.inspectOpts,...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:s}=this;if(s){const t=this.color,s="[3"+(t<8?t:"8;5;"+t),i=`  ${s};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=s.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(2755)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)}},6848:(e,t,r)=>{"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});const s=n(r(423)).default("serialport/binding-mock");let i={},o=0;function a(){return new Promise((e=>process.nextTick((()=>e()))))}class c extends Error{constructor(e){super(e),this.canceled=!0}}const u={reset(){i={},o=0},createPort(e,t={}){o++;const r=Object.assign({echo:!1,record:!1,manufacturer:"The J5 Robotics Company",vendorId:void 0,productId:void 0,maxReadSize:1024},t);i[e]={data:Buffer.alloc(0),echo:r.echo,record:r.record,readyData:r.readyData,maxReadSize:r.maxReadSize,info:{path:e,manufacturer:r.manufacturer,serialNumber:`${o}`,pnpId:void 0,locationId:void 0,vendorId:r.vendorId,productId:r.productId}},s(o,"created port",JSON.stringify({path:e,opt:t}))},list:async()=>(s(null,"list"),Object.values(i).map((e=>e.info))),async open(e){var t;if(!e||"object"!=typeof e||Array.isArray(e))throw new TypeError('"options" is not an object');if(!e.path)throw new TypeError('"path" is not a valid port');if(!e.baudRate)throw new TypeError('"baudRate" is not a valid baudRate');const r=Object.assign({dataBits:8,lock:!0,stopBits:1,parity:"none",rtscts:!1,xon:!1,xoff:!1,xany:!1,hupcl:!0},e),{path:n}=r;s(null,`open: opening path ${n}`);const o=i[n];if(await a(),!o)throw new Error(`Port does not exist - please call MockBinding.createPort('${n}') first`);const c=o.info.serialNumber;if(null===(t=o.openOpt)||void 0===t?void 0:t.lock)throw s(c,"open: Port is locked cannot open"),new Error("Port is locked cannot open");return s(c,`open: opened path ${n}`),o.openOpt=Object.assign({},r),new l(o,r)}};class l{constructor(e,t){if(this.port=e,this.openOptions=t,this.pendingRead=null,this.isOpen=!0,this.lastWrite=null,this.recording=Buffer.alloc(0),this.writeOperation=null,this.serialNumber=e.info.serialNumber,e.readyData){const t=e.readyData;process.nextTick((()=>{this.isOpen&&(s(this.serialNumber,"emitting ready data"),this.emitData(t))}))}}emitData(e){if(!this.isOpen||!this.port)throw new Error("Port must be open to pretend to receive data");const t=Buffer.isBuffer(e)?e:Buffer.from(e);s(this.serialNumber,"emitting data - pending read:",Boolean(this.pendingRead)),this.port.data=Buffer.concat([this.port.data,t]),this.pendingRead&&(process.nextTick(this.pendingRead),this.pendingRead=null)}async close(){if(s(this.serialNumber,"close"),!this.isOpen)throw new Error("Port is not open");const e=this.port;if(!e)throw new Error("already closed");e.openOpt=void 0,e.data=Buffer.alloc(0),s(this.serialNumber,"port is closed"),this.serialNumber=void 0,this.isOpen=!1,this.pendingRead&&this.pendingRead(new c("port is closed"))}async read(e,t,r){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if("number"!=typeof t||isNaN(t))throw new TypeError(`"offset" is not an integer got "${isNaN(t)?"NaN":typeof t}"`);if("number"!=typeof r||isNaN(r))throw new TypeError(`"length" is not an integer got "${isNaN(r)?"NaN":typeof r}"`);if(e.length<t+r)throw new Error("buffer is too small");if(!this.isOpen)throw new Error("Port is not open");if(s(this.serialNumber,"read",r,"bytes"),await a(),!this.isOpen||!this.port)throw new c("Read canceled");if(this.port.data.length<=0)return new Promise(((n,s)=>{this.pendingRead=i=>{if(i)return s(i);this.read(e,t,r).then(n,s)}}));const n=this.port.maxReadSize>r?r:this.port.maxReadSize,i=this.port.data.slice(0,n).copy(e,t);return this.port.data=this.port.data.slice(n),s(this.serialNumber,"read",i,"bytes"),{bytesRead:i,buffer:e}}async write(e){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(!this.isOpen||!this.port)throw s("write","error port is not open"),new Error("Port is not open");if(s(this.serialNumber,"write",e.length,"bytes"),this.writeOperation)throw new Error("Overlapping writes are not supported and should be queued by the serialport object");return this.writeOperation=(async()=>{if(await a(),!this.isOpen||!this.port)throw new Error("Write canceled");const t=this.lastWrite=Buffer.from(e);this.port.record&&(this.recording=Buffer.concat([this.recording,t])),this.port.echo&&process.nextTick((()=>{this.isOpen&&this.emitData(t)})),this.writeOperation=null,s(this.serialNumber,"writing finished")})(),this.writeOperation}async update(e){if("object"!=typeof e)throw TypeError('"options" is not an object');if("number"!=typeof e.baudRate)throw new TypeError('"options.baudRate" is not a number');if(s(this.serialNumber,"update"),!this.isOpen||!this.port)throw new Error("Port is not open");await a(),this.port.openOpt&&(this.port.openOpt.baudRate=e.baudRate)}async set(e){if("object"!=typeof e)throw new TypeError('"options" is not an object');if(s(this.serialNumber,"set"),!this.isOpen)throw new Error("Port is not open");await a()}async get(){if(s(this.serialNumber,"get"),!this.isOpen)throw new Error("Port is not open");return await a(),{cts:!0,dsr:!1,dcd:!1}}async getBaudRate(){var e;if(s(this.serialNumber,"getBaudRate"),!this.isOpen||!this.port)throw new Error("Port is not open");if(await a(),!(null===(e=this.port.openOpt)||void 0===e?void 0:e.baudRate))throw new Error("Internal Error");return{baudRate:this.port.openOpt.baudRate}}async flush(){if(s(this.serialNumber,"flush"),!this.isOpen||!this.port)throw new Error("Port is not open");await a(),this.port.data=Buffer.alloc(0)}async drain(){if(s(this.serialNumber,"drain"),!this.isOpen)throw new Error("Port is not open");await this.writeOperation,await a()}}t.CanceledError=c,t.MockBinding=u,t.MockPortBinding=l},6443:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(5270)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},5270:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(8503),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},423:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(6443):e.exports=r(6855)},6855:(e,t,r)=>{const n=r(9637),s=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(s.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:s}=this;if(s){const t=this.color,s="[3"+(t<8?t:"8;5;"+t),i=`  ${s};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=s.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(5270)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)}},8503:e=>{var t=1e3,r=60*t,n=60*r,s=24*n,i=7*s;function o(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,a){a=a||{};var c,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*i;case"days":case"day":case"d":return a*s;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(c=e,(u=Math.abs(c))>=s?o(c,u,s,"day"):u>=n?o(c,u,n,"hour"):u>=r?o(c,u,r,"minute"):u>=t?o(c,u,t,"second"):c+" ms"):function(e){var i=Math.abs(e);return i>=s?Math.round(e/s)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6269:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DarwinPortBinding=t.DarwinBinding=void 0;const s=n(r(1751)),i=r(6237),o=r(6924),a=r(9269),c=r(1078),u=(0,s.default)("serialport/bindings-cpp");t.DarwinBinding={list:()=>(u("list"),(0,i.asyncList)()),async open(e){if(!e||"object"!=typeof e||Array.isArray(e))throw new TypeError('"options" is not an object');if(!e.path)throw new TypeError('"path" is not a valid port');if(!e.baudRate)throw new TypeError('"baudRate" is not a valid baudRate');u("open");const t=Object.assign({vmin:1,vtime:0,dataBits:8,lock:!0,stopBits:1,parity:"none",rtscts:!1,xon:!1,xoff:!1,xany:!1,hupcl:!0},e),r=await(0,i.asyncOpen)(t.path,t);return new l(r,t)}};class l{constructor(e,t){this.fd=e,this.openOptions=t,this.poller=new o.Poller(e),this.writeOperation=null}get isOpen(){return null!==this.fd}async close(){if(u("close"),!this.isOpen)throw new Error("Port is not open");const e=this.fd;this.poller.stop(),this.poller.destroy(),this.fd=null,await(0,i.asyncClose)(e)}async read(e,t,r){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if("number"!=typeof t||isNaN(t))throw new TypeError(`"offset" is not an integer got "${isNaN(t)?"NaN":typeof t}"`);if("number"!=typeof r||isNaN(r))throw new TypeError(`"length" is not an integer got "${isNaN(r)?"NaN":typeof r}"`);if(u("read"),e.length<t+r)throw new Error("buffer is too small");if(!this.isOpen)throw new Error("Port is not open");return(0,a.unixRead)({binding:this,buffer:e,offset:t,length:r})}async write(e){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(u("write",e.length,"bytes"),!this.isOpen)throw u("write","error port is not open"),new Error("Port is not open");return this.writeOperation=(async()=>{0!==e.length&&(await(0,c.unixWrite)({binding:this,buffer:e}),this.writeOperation=null)})(),this.writeOperation}async update(e){if(!e||"object"!=typeof e||Array.isArray(e))throw TypeError('"options" is not an object');if("number"!=typeof e.baudRate)throw new TypeError('"options.baudRate" is not a number');if(u("update"),!this.isOpen)throw new Error("Port is not open");await(0,i.asyncUpdate)(this.fd,e)}async set(e){if(!e||"object"!=typeof e||Array.isArray(e))throw new TypeError('"options" is not an object');if(u("set",e),!this.isOpen)throw new Error("Port is not open");await(0,i.asyncSet)(this.fd,e)}async get(){if(u("get"),!this.isOpen)throw new Error("Port is not open");return(0,i.asyncGet)(this.fd)}async getBaudRate(){if(u("getBaudRate"),!this.isOpen)throw new Error("Port is not open");throw new Error("getBaudRate is not implemented on darwin")}async flush(){if(u("flush"),!this.isOpen)throw new Error("Port is not open");await(0,i.asyncFlush)(this.fd)}async drain(){if(u("drain"),!this.isOpen)throw new Error("Port is not open");await this.writeOperation,await(0,i.asyncDrain)(this.fd)}}t.DarwinPortBinding=l},3841:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingsError=void 0;class r extends Error{constructor(e,{canceled:t=!1}={}){super(e),this.canceled=t}}t.BindingsError=r},176:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.autoDetect=void 0;const o=i(r(1751)),a=r(6269),c=r(8238),u=r(1363),l=(0,o.default)("serialport/bindings-cpp");s(r(1470),t),s(r(6269),t),s(r(8238),t),s(r(1363),t),s(r(3841),t),t.autoDetect=function(){switch(process.platform){case"win32":return l("loading WindowsBinding"),u.WindowsBinding;case"darwin":return l("loading DarwinBinding"),a.DarwinBinding;default:return l("loading LinuxBinding"),c.LinuxBinding}}},8583:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linuxList=void 0;const n=r(5317),s=r(2348);t.linuxList=function(e=n.spawn){const t=[],r=e("udevadm",["info","-e"]),i=r.stdout.pipe(new s.ReadlineParser);let o=!1,a={path:"",manufacturer:void 0,serialNumber:void 0,pnpId:void 0,locationId:void 0,vendorId:void 0,productId:void 0};return i.on("data",(e=>{const r=e.slice(0,1),n=e.slice(3);if("P"===r)return a={path:"",manufacturer:void 0,serialNumber:void 0,pnpId:void 0,locationId:void 0,vendorId:void 0,productId:void 0},void(o=!1);var s;if(!o)if("N"!==r){if("E"===r){const e=n.match(/^(.+)=(.*)/);if(!e)return;const t={DEVNAME:"path",ID_VENDOR_ENC:"manufacturer",ID_SERIAL_SHORT:"serialNumber",ID_VENDOR_ID:"vendorId",ID_MODEL_ID:"productId",DEVLINKS:"pnpId",ID_USB_VENDOR_ENC:"manufacturer",ID_USB_SERIAL_SHORT:"serialNumber",ID_USB_VENDOR_ID:"vendorId",ID_USB_MODEL_ID:"productId"}[e[1].toUpperCase()];if(!t)return;a[t]=function(e,t){if("pnpId"===e){const e=t.match(/\/by-id\/([^\s]+)/);return(null==e?void 0:e[1])||void 0}return"manufacturer"===e?t.replace(/\\x([a-fA-F0-9]{2})/g,((e,t)=>String.fromCharCode(parseInt(t,16)))):/^0x/.test(t)?t.substr(2):t}(t,e[2])}}else/(tty(S|WCH|ACM|USB|AMA|MFD|O|XRUSB)|rfcomm)/.test(s=n)&&s?t.push(a):o=!0})),new Promise(((e,n)=>{r.on("close",(e=>{e&&n(new Error(`Error listing ports udevadm exited with error code: ${e}`))})),r.on("error",n),i.on("error",n),i.on("finish",(()=>e(t)))}))}},8238:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LinuxPortBinding=t.LinuxBinding=void 0;const s=n(r(1751)),i=r(8583),o=r(6924),a=r(9269),c=r(1078),u=r(6237),l=(0,s.default)("serialport/bindings-cpp");t.LinuxBinding={list:()=>(l("list"),(0,i.linuxList)()),async open(e){if(!e||"object"!=typeof e||Array.isArray(e))throw new TypeError('"options" is not an object');if(!e.path)throw new TypeError('"path" is not a valid port');if(!e.baudRate)throw new TypeError('"baudRate" is not a valid baudRate');l("open");const t=Object.assign({vmin:1,vtime:0,dataBits:8,lock:!0,stopBits:1,parity:"none",rtscts:!1,xon:!1,xoff:!1,xany:!1,hupcl:!0},e),r=await(0,u.asyncOpen)(t.path,t);return this.fd=r,new d(r,t)}};class d{constructor(e,t){this.fd=e,this.openOptions=t,this.poller=new o.Poller(e),this.writeOperation=null}get isOpen(){return null!==this.fd}async close(){if(l("close"),!this.isOpen)throw new Error("Port is not open");const e=this.fd;this.poller.stop(),this.poller.destroy(),this.fd=null,await(0,u.asyncClose)(e)}async read(e,t,r){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if("number"!=typeof t||isNaN(t))throw new TypeError(`"offset" is not an integer got "${isNaN(t)?"NaN":typeof t}"`);if("number"!=typeof r||isNaN(r))throw new TypeError(`"length" is not an integer got "${isNaN(r)?"NaN":typeof r}"`);if(l("read"),e.length<t+r)throw new Error("buffer is too small");if(!this.isOpen)throw new Error("Port is not open");return(0,a.unixRead)({binding:this,buffer:e,offset:t,length:r})}async write(e){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(l("write",e.length,"bytes"),!this.isOpen)throw l("write","error port is not open"),new Error("Port is not open");return this.writeOperation=(async()=>{0!==e.length&&(await(0,c.unixWrite)({binding:this,buffer:e}),this.writeOperation=null)})(),this.writeOperation}async update(e){if(!e||"object"!=typeof e||Array.isArray(e))throw TypeError('"options" is not an object');if("number"!=typeof e.baudRate)throw new TypeError('"options.baudRate" is not a number');if(l("update"),!this.isOpen)throw new Error("Port is not open");await(0,u.asyncUpdate)(this.fd,e)}async set(e){if(!e||"object"!=typeof e||Array.isArray(e))throw new TypeError('"options" is not an object');if(l("set"),!this.isOpen)throw new Error("Port is not open");await(0,u.asyncSet)(this.fd,e)}async get(){if(l("get"),!this.isOpen)throw new Error("Port is not open");return(0,u.asyncGet)(this.fd)}async getBaudRate(){if(l("getBaudRate"),!this.isOpen)throw new Error("Port is not open");return(0,u.asyncGetBaudRate)(this.fd)}async flush(){if(l("flush"),!this.isOpen)throw new Error("Port is not open");await(0,u.asyncFlush)(this.fd)}async drain(){if(l("drain"),!this.isOpen)throw new Error("Port is not open");await this.writeOperation,await(0,u.asyncDrain)(this.fd)}}t.LinuxPortBinding=d},6237:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncWrite=t.asyncRead=t.asyncUpdate=t.asyncSet=t.asyncOpen=t.asyncList=t.asyncGetBaudRate=t.asyncGet=t.asyncFlush=t.asyncDrain=t.asyncClose=void 0;const s=n(r(8169)),i=r(9023),o=r(6928),a=(0,s.default)((0,o.join)(__dirname,"../"));t.asyncClose=a.close?(0,i.promisify)(a.close):async()=>{throw new Error('"binding.close" Method not implemented')},t.asyncDrain=a.drain?(0,i.promisify)(a.drain):async()=>{throw new Error('"binding.drain" Method not implemented')},t.asyncFlush=a.flush?(0,i.promisify)(a.flush):async()=>{throw new Error('"binding.flush" Method not implemented')},t.asyncGet=a.get?(0,i.promisify)(a.get):async()=>{throw new Error('"binding.get" Method not implemented')},t.asyncGetBaudRate=a.getBaudRate?(0,i.promisify)(a.getBaudRate):async()=>{throw new Error('"binding.getBaudRate" Method not implemented')},t.asyncList=a.list?(0,i.promisify)(a.list):async()=>{throw new Error('"binding.list" Method not implemented')},t.asyncOpen=a.open?(0,i.promisify)(a.open):async()=>{throw new Error('"binding.open" Method not implemented')},t.asyncSet=a.set?(0,i.promisify)(a.set):async()=>{throw new Error('"binding.set" Method not implemented')},t.asyncUpdate=a.update?(0,i.promisify)(a.update):async()=>{throw new Error('"binding.update" Method not implemented')},t.asyncRead=a.read?(0,i.promisify)(a.read):async()=>{throw new Error('"binding.read" Method not implemented')},t.asyncWrite=a.write?(0,i.promisify)(a.write):async()=>{throw new Error('"binding.write" Method not implemented')}},6924:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Poller=t.EVENTS=void 0;const s=n(r(1751)),i=r(4434),o=r(6928),a=n(r(8169)),c=r(3841),{Poller:u}=(0,a.default)((0,o.join)(__dirname,"../")),l=(0,s.default)("serialport/bindings-cpp/poller");function d(e,r){if(e)return l("error",e),this.emit("readable",e),this.emit("writable",e),void this.emit("disconnect",e);r&t.EVENTS.UV_READABLE&&(l('received "readable"'),this.emit("readable",null)),r&t.EVENTS.UV_WRITABLE&&(l('received "writable"'),this.emit("writable",null)),r&t.EVENTS.UV_DISCONNECT&&(l('received "disconnect"'),this.emit("disconnect",null))}t.EVENTS={UV_READABLE:1,UV_WRITABLE:2,UV_DISCONNECT:4};class h extends i.EventEmitter{constructor(e,t=u){l("Creating poller"),super(),this.poller=new t(e,d.bind(this))}once(e,r){switch(e){case"readable":this.poll(t.EVENTS.UV_READABLE);break;case"writable":this.poll(t.EVENTS.UV_WRITABLE);break;case"disconnect":this.poll(t.EVENTS.UV_DISCONNECT)}return super.once(e,r)}poll(e=0){e&t.EVENTS.UV_READABLE&&l('Polling for "readable"'),e&t.EVENTS.UV_WRITABLE&&l('Polling for "writable"'),e&t.EVENTS.UV_DISCONNECT&&l('Polling for "disconnect"'),this.poller.poll(e)}stop(){l("Stopping poller"),this.poller.stop(),this.emitCanceled()}destroy(){l("Destroying poller"),this.poller.destroy(),this.emitCanceled()}emitCanceled(){const e=new c.BindingsError("Canceled",{canceled:!0});this.emit("readable",e),this.emit("writable",e),this.emit("disconnect",e)}}t.Poller=h},9269:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unixRead=void 0;const s=r(9023),i=r(9896),o=r(3841),a=(0,n(r(1751)).default)("serialport/bindings-cpp/unixRead"),c=(0,s.promisify)(i.read);t.unixRead=async({binding:e,buffer:r,offset:n,length:s,fsReadAsync:i=c})=>{if(a("Starting read"),!e.isOpen||!e.fd)throw new o.BindingsError("Port is not open",{canceled:!0});try{const{bytesRead:o}=await i(e.fd,r,n,s,null);return 0===o?(0,t.unixRead)({binding:e,buffer:r,offset:n,length:s,fsReadAsync:i}):(a("Finished read",o,"bytes"),{bytesRead:o,buffer:r})}catch(c){if(a("read error",c),"EAGAIN"===c.code||"EWOULDBLOCK"===c.code||"EINTR"===c.code){if(!e.isOpen)throw new o.BindingsError("Port is not open",{canceled:!0});return a("waiting for readable because of code:",c.code),await(e=>new Promise(((t,r)=>{if(!e.poller)throw new Error("No poller on bindings");e.poller.once("readable",(e=>e?r(e):t()))})))(e),(0,t.unixRead)({binding:e,buffer:r,offset:n,length:s,fsReadAsync:i})}throw("EBADF"===c.code||"ENXIO"===c.code||"UNKNOWN"===c.code||-1===c.errno)&&(c.disconnect=!0,a("disconnecting",c)),c}}},1078:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unixWrite=void 0;const s=r(9896),i=n(r(1751)),o=r(9023),a=(0,i.default)("serialport/bindings-cpp/unixWrite"),c=(0,o.promisify)(s.write);t.unixWrite=async({binding:e,buffer:r,offset:n=0,fsWriteAsync:s=c})=>{const i=r.length-n;if(a("Starting write",r.length,"bytes offset",n,"bytesToWrite",i),!e.isOpen||!e.fd)throw new Error("Port is not open");try{const{bytesWritten:o}=await s(e.fd,r,n,i);if(a("write returned: wrote",o,"bytes"),o+n<r.length){if(!e.isOpen)throw new Error("Port is not open");return(0,t.unixWrite)({binding:e,buffer:r,offset:o+n,fsWriteAsync:s})}a("Finished writing",o+n,"bytes")}catch(i){if(a("write errored",i),"EAGAIN"===i.code||"EWOULDBLOCK"===i.code||"EINTR"===i.code){if(!e.isOpen)throw new Error("Port is not open");return a("waiting for writable because of code:",i.code),await(e=>new Promise(((t,r)=>{e.poller.once("writable",(e=>e?r(e):t()))})))(e),(0,t.unixWrite)({binding:e,buffer:r,offset:n,fsWriteAsync:s})}throw("EBADF"===i.code||"ENXIO"===i.code||"UNKNOWN"===i.code||-1===i.errno)&&(i.disconnect=!0,a("disconnecting",i)),a("error",i),i}}},5037:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serialNumParser=void 0;const r=[/USB\\(?:.+)\\(.+)/,/FTDIBUS\\(?:.+)\+(.+?)A?\\.+/];t.serialNumParser=e=>{if(!e)return null;for(const t of r){const r=e.match(t);if(r)return r[1]}return null}},1363:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WindowsPortBinding=t.WindowsBinding=void 0;const s=n(r(1751)),i=r(176),o=r(6237),a=r(5037),c=(0,s.default)("serialport/bindings-cpp");t.WindowsBinding={list:async()=>(await(0,o.asyncList)()).map((e=>{if(e.pnpId&&!e.serialNumber){const t=(0,a.serialNumParser)(e.pnpId);if(t)return Object.assign(Object.assign({},e),{serialNumber:t})}return e})),async open(e){if(!e||"object"!=typeof e||Array.isArray(e))throw new TypeError('"options" is not an object');if(!e.path)throw new TypeError('"path" is not a valid port');if(!e.baudRate)throw new TypeError('"baudRate" is not a valid baudRate');c("open");const t=Object.assign({dataBits:8,lock:!0,stopBits:1,parity:"none",rtscts:!1,rtsMode:"handshake",xon:!1,xoff:!1,xany:!1,hupcl:!0},e),r=await(0,o.asyncOpen)(t.path,t);return new u(r,t)}};class u{constructor(e,t){this.fd=e,this.openOptions=t,this.writeOperation=null}get isOpen(){return null!==this.fd}async close(){if(c("close"),!this.isOpen)throw new Error("Port is not open");const e=this.fd;this.fd=null,await(0,o.asyncClose)(e)}async read(e,t,r){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if("number"!=typeof t||isNaN(t))throw new TypeError(`"offset" is not an integer got "${isNaN(t)?"NaN":typeof t}"`);if("number"!=typeof r||isNaN(r))throw new TypeError(`"length" is not an integer got "${isNaN(r)?"NaN":typeof r}"`);if(c("read"),e.length<t+r)throw new Error("buffer is too small");if(!this.isOpen)throw new Error("Port is not open");try{return{bytesRead:await(0,o.asyncRead)(this.fd,e,t,r),buffer:e}}catch(e){if(!this.isOpen)throw new i.BindingsError(e.message,{canceled:!0});throw e}}async write(e){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(c("write",e.length,"bytes"),!this.isOpen)throw c("write","error port is not open"),new Error("Port is not open");return this.writeOperation=(async()=>{0!==e.length&&(await(0,o.asyncWrite)(this.fd,e),this.writeOperation=null)})(),this.writeOperation}async update(e){if(!e||"object"!=typeof e||Array.isArray(e))throw TypeError('"options" is not an object');if("number"!=typeof e.baudRate)throw new TypeError('"options.baudRate" is not a number');if(c("update"),!this.isOpen)throw new Error("Port is not open");await(0,o.asyncUpdate)(this.fd,e)}async set(e){if(!e||"object"!=typeof e||Array.isArray(e))throw new TypeError('"options" is not an object');if(c("set",e),!this.isOpen)throw new Error("Port is not open");await(0,o.asyncSet)(this.fd,e)}async get(){if(c("get"),!this.isOpen)throw new Error("Port is not open");return(0,o.asyncGet)(this.fd)}async getBaudRate(){if(c("getBaudRate"),!this.isOpen)throw new Error("Port is not open");return(0,o.asyncGetBaudRate)(this.fd)}async flush(){if(c("flush"),!this.isOpen)throw new Error("Port is not open");await(0,o.asyncFlush)(this.fd)}async drain(){if(c("drain"),!this.isOpen)throw new Error("Port is not open");await this.writeOperation,await(0,o.asyncDrain)(this.fd)}}t.WindowsPortBinding=u},3547:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(4662)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},4662:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(2791),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},1751:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(3547):e.exports=r(9095)},9095:(e,t,r)=>{const n=r(9637),s=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(s.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:s}=this;if(s){const t=this.color,s="[3"+(t<8?t:"8;5;"+t),i=`  ${s};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=s.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(4662)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)}},2791:e=>{var t=1e3,r=60*t,n=60*r,s=24*n,i=7*s;function o(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,a){a=a||{};var c,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*i;case"days":case"day":case"d":return a*s;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(c=e,(u=Math.abs(c))>=s?o(c,u,s,"day"):u>=n?o(c,u,n,"hour"):u>=r?o(c,u,r,"minute"):u>=t?o(c,u,t,"second"):c+" ms"):function(e){var i=Math.abs(e);return i>=s?Math.round(e/s)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},1470:()=>{},9847:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ByteLengthParser=void 0;const n=r(2203);class s extends n.Transform{length;position;buffer;constructor(e){if(super(e),"number"!=typeof e.length)throw new TypeError('"length" is not a number');if(e.length<1)throw new TypeError('"length" is not greater than 0');this.length=e.length,this.position=0,this.buffer=Buffer.alloc(this.length)}_transform(e,t,r){let n=0;for(;n<e.length;)this.buffer[this.position]=e[n],n++,this.position++,this.position===this.length&&(this.push(this.buffer),this.buffer=Buffer.alloc(this.length),this.position=0);r()}_flush(e){this.push(this.buffer.slice(0,this.position)),this.buffer=Buffer.alloc(this.length),e()}}t.ByteLengthParser=s},3662:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CCTalkParser=void 0;const n=r(2203);class s extends n.Transform{array;cursor;lastByteFetchTime;maxDelayBetweenBytesMs;constructor(e=50){super(),this.array=[],this.cursor=0,this.lastByteFetchTime=0,this.maxDelayBetweenBytesMs=e}_transform(e,t,r){if(this.maxDelayBetweenBytesMs>0){const e=Date.now();e-this.lastByteFetchTime>this.maxDelayBetweenBytesMs&&(this.array=[],this.cursor=0),this.lastByteFetchTime=e}for(this.cursor+=e.length,Array.from(e).map((e=>this.array.push(e)));this.cursor>1&&this.cursor>=this.array[1]+5;){const e=this.array[1]+5,t=Buffer.from(this.array.slice(0,e));this.array=this.array.slice(t.length,this.array.length),this.cursor-=e,this.push(t)}r()}}t.CCTalkParser=s},447:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DelimiterParser=void 0;const n=r(2203);class s extends n.Transform{includeDelimiter;delimiter;buffer;constructor({delimiter:e,includeDelimiter:t=!1,...r}){if(super(r),void 0===e)throw new TypeError('"delimiter" is not a bufferable object');if(0===e.length)throw new TypeError('"delimiter" has a 0 or undefined length');this.includeDelimiter=t,this.delimiter=Buffer.from(e),this.buffer=Buffer.alloc(0)}_transform(e,t,r){let n,s=Buffer.concat([this.buffer,e]);for(;-1!==(n=s.indexOf(this.delimiter));)this.push(s.slice(0,n+(this.includeDelimiter?this.delimiter.length:0))),s=s.slice(n+this.delimiter.length);this.buffer=s,r()}_flush(e){this.push(this.buffer),this.buffer=Buffer.alloc(0),e()}}t.DelimiterParser=s},6937:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InterByteTimeoutParser=void 0;const n=r(2203);class s extends n.Transform{maxBufferSize;currentPacket;interval;intervalID;constructor({maxBufferSize:e=65536,interval:t,...r}){if(super(r),!t)throw new TypeError('"interval" is required');if("number"!=typeof t||Number.isNaN(t))throw new TypeError('"interval" is not a number');if(t<1)throw new TypeError('"interval" is not greater than 0');if("number"!=typeof e||Number.isNaN(e))throw new TypeError('"maxBufferSize" is not a number');if(e<1)throw new TypeError('"maxBufferSize" is not greater than 0');this.maxBufferSize=e,this.currentPacket=[],this.interval=t}_transform(e,t,r){this.intervalID&&clearTimeout(this.intervalID);for(let t=0;t<e.length;t++)this.currentPacket.push(e[t]),this.currentPacket.length>=this.maxBufferSize&&this.emitPacket();this.intervalID=setTimeout(this.emitPacket.bind(this),this.interval),r()}emitPacket(){this.intervalID&&clearTimeout(this.intervalID),this.currentPacket.length>0&&this.push(Buffer.from(this.currentPacket)),this.currentPacket=[]}_flush(e){this.emitPacket(),e()}}t.InterByteTimeoutParser=s},1693:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PacketLengthParser=void 0;const n=r(2203);class s extends n.Transform{buffer;start;opts;constructor(e={}){super(e);const{delimiter:t=170,packetOverhead:r=2,lengthBytes:n=1,lengthOffset:s=1,maxLen:i=255}=e;this.opts={delimiter:t,packetOverhead:r,lengthBytes:n,lengthOffset:s,maxLen:i},this.buffer=Buffer.alloc(0),this.start=!1}_transform(e,t,r){for(let t=0;t<e.length;t++){const r=e[t];if(r===this.opts.delimiter&&(this.start=!0),!0===this.start&&(this.buffer=Buffer.concat([this.buffer,Buffer.from([r])]),this.buffer.length>=this.opts.lengthOffset+this.opts.lengthBytes)){const e=this.buffer.readUIntLE(this.opts.lengthOffset,this.opts.lengthBytes);(this.buffer.length==e+this.opts.packetOverhead||e>this.opts.maxLen)&&(this.push(this.buffer),this.buffer=Buffer.alloc(0),this.start=!1)}}r()}_flush(e){this.push(this.buffer),this.buffer=Buffer.alloc(0),e()}}t.PacketLengthParser=s},2348:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadlineParser=void 0;const n=r(2181);class s extends n.DelimiterParser{constructor(e){const t={delimiter:Buffer.from("\n","utf8"),encoding:"utf8",...e};"string"==typeof t.delimiter&&(t.delimiter=Buffer.from(t.delimiter,t.encoding)),super(t)}}t.ReadlineParser=s},2181:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DelimiterParser=void 0;const n=r(2203);class s extends n.Transform{constructor({delimiter:e,includeDelimiter:t=!1,...r}){if(super(r),void 0===e)throw new TypeError('"delimiter" is not a bufferable object');if(0===e.length)throw new TypeError('"delimiter" has a 0 or undefined length');this.includeDelimiter=t,this.delimiter=Buffer.from(e),this.buffer=Buffer.alloc(0)}_transform(e,t,r){let n,s=Buffer.concat([this.buffer,e]);for(;-1!==(n=s.indexOf(this.delimiter));)this.push(s.slice(0,n+(this.includeDelimiter?this.delimiter.length:0))),s=s.slice(n+this.delimiter.length);this.buffer=s,r()}_flush(e){this.push(this.buffer),this.buffer=Buffer.alloc(0),e()}}t.DelimiterParser=s},8145:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadyParser=void 0;const n=r(2203);class s extends n.Transform{delimiter;readOffset;ready;constructor({delimiter:e,...t}){if(void 0===e)throw new TypeError('"delimiter" is not a bufferable object');if(0===e.length)throw new TypeError('"delimiter" has a 0 or undefined length');super(t),this.delimiter=Buffer.from(e),this.readOffset=0,this.ready=!1}_transform(e,t,r){if(this.ready)return this.push(e),r();const n=this.delimiter;let s=0;for(;this.readOffset<n.length&&s<e.length;)n[this.readOffset]===e[s]?this.readOffset++:this.readOffset=0,s++;if(this.readOffset===n.length){this.ready=!0,this.emit("ready");const t=e.slice(s);t.length>0&&this.push(t)}r()}}t.ReadyParser=s},637:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegexParser=void 0;const n=r(2203);class s extends n.Transform{regex;data;constructor({regex:e,...t}){const r={encoding:"utf8",...t};if(void 0===e)throw new TypeError('"options.regex" must be a regular expression pattern or object');e instanceof RegExp||(e=new RegExp(e.toString())),super(r),this.regex=e,this.data=""}_transform(e,t,r){const n=(this.data+e).split(this.regex);this.data=n.pop()||"",n.forEach((e=>{this.push(e)})),r()}_flush(e){this.push(this.data),this.data="",e()}}t.RegexParser=s},9831:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlipDecoder=void 0;const n=r(2203);class s extends n.Transform{opts;buffer;escape;start;constructor(e={}){super(e);const{START:t,ESC:r=219,END:n=192,ESC_START:s,ESC_END:i=220,ESC_ESC:o=221}=e;this.opts={START:t,ESC:r,END:n,ESC_START:s,ESC_END:i,ESC_ESC:o},this.buffer=Buffer.alloc(0),this.escape=!1,this.start=!1}_transform(e,t,r){for(let t=0;t<e.length;t++){let r=e[t];if(r!==this.opts.START){if(null==this.opts.START&&(this.start=!0),this.escape)r===this.opts.ESC_START&&this.opts.START?r=this.opts.START:r===this.opts.ESC_ESC?r=this.opts.ESC:r===this.opts.ESC_END?r=this.opts.END:(this.escape=!1,this.push(this.buffer),this.buffer=Buffer.alloc(0));else{if(r===this.opts.ESC){this.escape=!0;continue}if(r===this.opts.END){this.push(this.buffer),this.buffer=Buffer.alloc(0),this.escape=!1,this.start=!1;continue}}this.escape=!1,this.start&&(this.buffer=Buffer.concat([this.buffer,Buffer.from([r])]))}else this.start=!0}r()}_flush(e){this.push(this.buffer),this.buffer=Buffer.alloc(0),e()}}t.SlipDecoder=s},4399:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlipEncoder=void 0;const n=r(2203);class s extends n.Transform{opts;constructor(e={}){super(e);const{START:t,ESC:r=219,END:n=192,ESC_START:s,ESC_END:i=220,ESC_ESC:o=221,bluetoothQuirk:a=!1}=e;this.opts={START:t,ESC:r,END:n,ESC_START:s,ESC_END:i,ESC_ESC:o,bluetoothQuirk:a}}_transform(e,t,r){const n=e.length;if(this.opts.bluetoothQuirk&&0===n)return r();const s=Buffer.alloc(2*n+2);let i=0;1==this.opts.bluetoothQuirk&&(s[i++]=this.opts.END),void 0!==this.opts.START&&(s[i++]=this.opts.START);for(let t=0;t<n;t++){let r=e[t];r===this.opts.START&&this.opts.ESC_START?(s[i++]=this.opts.ESC,r=this.opts.ESC_START):r===this.opts.END?(s[i++]=this.opts.ESC,r=this.opts.ESC_END):r===this.opts.ESC&&(s[i++]=this.opts.ESC,r=this.opts.ESC_ESC),s[i++]=r}s[i++]=this.opts.END,r(null,s.slice(0,i))}}t.SlipEncoder=s},3819:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(9831),t),s(r(4399),t)},7102:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpacePacketParser=void 0;const n=r(2203),s=r(2415);class i extends n.Transform{timeCodeFieldLength;ancillaryDataFieldLength;dataBuffer;headerBuffer;dataLength;expectingHeader;dataSlice;header;constructor(e={}){super({...e,objectMode:!0}),this.timeCodeFieldLength=e.timeCodeFieldLength||0,this.ancillaryDataFieldLength=e.ancillaryDataFieldLength||0,this.dataSlice=this.timeCodeFieldLength+this.ancillaryDataFieldLength,this.dataBuffer=Buffer.alloc(0),this.headerBuffer=Buffer.alloc(0),this.dataLength=0,this.expectingHeader=!0}pushCompletedPacket(){if(!this.header)throw new Error("Missing header");const e=Buffer.from(this.dataBuffer.slice(0,this.timeCodeFieldLength)),t=Buffer.from(this.dataBuffer.slice(this.timeCodeFieldLength,this.timeCodeFieldLength+this.ancillaryDataFieldLength)),r=Buffer.from(this.dataBuffer.slice(this.dataSlice,this.dataLength)),n={header:{...this.header},data:r.toString()};(e.length>0||t.length>0)&&(n.secondaryHeader={},e.length&&(n.secondaryHeader.timeCode=e.toString()),t.length&&(n.secondaryHeader.ancillaryData=t.toString())),this.push(n);const i=Buffer.from(this.dataBuffer.slice(this.dataLength));i.length>=s.HEADER_LENGTH?this.extractHeader(i):(this.headerBuffer=i,this.dataBuffer=Buffer.alloc(0),this.expectingHeader=!0,this.dataLength=0,this.header=void 0)}extractHeader(e){const t=Buffer.concat([this.headerBuffer,e]),r=t.slice(s.HEADER_LENGTH);t.length>=s.HEADER_LENGTH?(this.header=(0,s.convertHeaderBufferToObj)(t),this.dataLength=this.header.dataLength,this.headerBuffer=Buffer.alloc(0),this.expectingHeader=!1):this.headerBuffer=t,r.length>0&&(this.dataBuffer=Buffer.from(r),this.dataBuffer.length>=this.dataLength&&this.pushCompletedPacket())}_transform(e,t,r){this.expectingHeader?this.extractHeader(e):(this.dataBuffer=Buffer.concat([this.dataBuffer,e]),this.dataBuffer.length>=this.dataLength&&this.pushCompletedPacket()),r()}_flush(e){const t=Buffer.concat([this.headerBuffer,this.dataBuffer]),r=Array.from(t);this.push(r),e()}}t.SpacePacketParser=i},2415:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertHeaderBufferToObj=t.HEADER_LENGTH=void 0,t.HEADER_LENGTH=6,t.convertHeaderBufferToObj=e=>{const r=Array.from(e.slice(0,t.HEADER_LENGTH)).reduce(((e,t)=>`${e}${(e=>{let t=Number(e).toString(2);for(;t.length<8;)t=`0${t}`;return t})(t)}`),""),n="000"===r.slice(0,3)?1:"UNKNOWN_VERSION",s=Number(r[3]),i=Number(r[4]),o=parseInt(r.slice(5,16),2),a=parseInt(r.slice(16,18),2);return{versionNumber:n,identification:{apid:o,secondaryHeader:i,type:s},sequenceControl:{packetName:parseInt(r.slice(18,32),2),sequenceFlags:a},dataLength:parseInt(r.slice(-16),2)+1}}},5802:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SerialPortStream=t.DisconnectedError=void 0;const s=r(2203),i=(0,n(r(3069)).default)("serialport/stream");class o extends Error{disconnected;constructor(e){super(e),this.disconnected=!0}}t.DisconnectedError=o;const a={brk:!1,cts:!1,dtr:!0,rts:!0};function c(e){const t=Buffer.allocUnsafe(e);return t.used=0,t}class u extends s.Duplex{port;_pool;_kMinPoolSpace;opening;closing;settings;constructor(e,t){const r={autoOpen:!0,endOnClose:!1,highWaterMark:65536,...e};if(super({highWaterMark:r.highWaterMark}),!r.binding)throw new TypeError('"Bindings" is invalid pass it as `options.binding`');if(!r.path)throw new TypeError(`"path" is not defined: ${r.path}`);if("number"!=typeof r.baudRate)throw new TypeError(`"baudRate" must be a number: ${r.baudRate}`);this.settings=r,this.opening=!1,this.closing=!1,this._pool=c(this.settings.highWaterMark),this._kMinPoolSpace=128,this.settings.autoOpen&&this.open(t)}get path(){return this.settings.path}get baudRate(){return this.settings.baudRate}get isOpen(){return(this.port?.isOpen??!1)&&!this.closing}_error(e,t){t?t.call(this,e):this.emit("error",e)}_asyncError(e,t){process.nextTick((()=>this._error(e,t)))}open(e){if(this.isOpen)return this._asyncError(new Error("Port is already open"),e);if(this.opening)return this._asyncError(new Error("Port is opening"),e);const{highWaterMark:t,binding:r,autoOpen:n,endOnClose:s,...o}=this.settings;this.opening=!0,i("opening",`path: ${this.path}`),this.settings.binding.open(o).then((t=>{i("opened",`path: ${this.path}`),this.port=t,this.opening=!1,this.emit("open"),e&&e.call(this,null)}),(t=>{this.opening=!1,i("Binding #open had an error",t),this._error(t,e)}))}update(e,t){if(!this.isOpen||!this.port)return i("update attempted, but port is not open"),this._asyncError(new Error("Port is not open"),t);i("update",`baudRate: ${e.baudRate}`),this.port.update(e).then((()=>{i("binding.update","finished"),this.settings.baudRate=e.baudRate,t&&t.call(this,null)}),(e=>(i("binding.update","error",e),this._error(e,t))))}write(e,t,r){return Array.isArray(e)&&(e=Buffer.from(e)),"function"==typeof t?super.write(e,t):super.write(e,t,r)}_write(e,t,r){this.isOpen&&this.port?(i("_write",`${e.length} bytes of data`),this.port.write(e).then((()=>{i("binding.write","write finished"),r(null)}),(e=>{i("binding.write","error",e),e.canceled||this._disconnected(e),r(e)}))):this.once("open",(()=>{this._write(e,t,r)}))}_writev(e,t){i("_writev",`${e.length} chunks of data`);const r=e.map((e=>e.chunk));this._write(Buffer.concat(r),void 0,t)}_read(e){if(!this.isOpen||!this.port)return i("_read","queueing _read for after open"),void this.once("open",(()=>{this._read(e)}));(!this._pool||this._pool.length-this._pool.used<this._kMinPoolSpace)&&(i("_read","discarding the read buffer pool because it is below kMinPoolSpace"),this._pool=c(this.settings.highWaterMark));const t=this._pool,r=Math.min(t.length-t.used,e),n=t.used;i("_read","reading",{start:n,toRead:r}),this.port.read(t,n,r).then((({bytesRead:e})=>{if(i("binding.read","finished",{bytesRead:e}),0===e)return i("binding.read","Zero bytes read closing readable stream"),void this.push(null);t.used+=e,this.push(t.slice(n,n+e))}),(t=>{i("binding.read","error",t),t.canceled||this._disconnected(t),this._read(e)}))}_disconnected(e){this.isOpen?(i("disconnected",e),this.close(void 0,new o(e.message))):i("disconnected aborted because already closed",e)}close(e,t=null){if(!this.isOpen||!this.port)return i("close attempted, but port is not open"),this._asyncError(new Error("Port is not open"),e);this.closing=!0,i("#close"),this.port.close().then((()=>{this.closing=!1,i("binding.close","finished"),this.emit("close",t),this.settings.endOnClose&&this.emit("end"),e&&e.call(this,t)}),(t=>(this.closing=!1,i("binding.close","had an error",t),this._error(t,e))))}set(e,t){if(!this.isOpen||!this.port)return i("set attempted, but port is not open"),this._asyncError(new Error("Port is not open"),t);const r={...a,...e};i("#set",r),this.port.set(r).then((()=>{i("binding.set","finished"),t&&t.call(this,null)}),(e=>(i("binding.set","had an error",e),this._error(e,t))))}get(e){if(!this.isOpen||!this.port)return i("get attempted, but port is not open"),this._asyncError(new Error("Port is not open"),e);i("#get"),this.port.get().then((t=>{i("binding.get","finished"),e.call(this,null,t)}),(t=>(i("binding.get","had an error",t),this._error(t,e))))}flush(e){if(!this.isOpen||!this.port)return i("flush attempted, but port is not open"),this._asyncError(new Error("Port is not open"),e);i("#flush"),this.port.flush().then((()=>{i("binding.flush","finished"),e&&e.call(this,null)}),(t=>(i("binding.flush","had an error",t),this._error(t,e))))}drain(e){if(i("drain"),!this.isOpen||!this.port)return i("drain queuing on port open"),void this.once("open",(()=>{this.drain(e)}));this.port.drain().then((()=>{i("binding.drain","finished"),e&&e.call(this,null)}),(t=>(i("binding.drain","had an error",t),this._error(t,e))))}}t.SerialPortStream=u},1821:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(8220)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},8220:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(37),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},3069:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(1821):e.exports=r(4037)},4037:(e,t,r)=>{const n=r(9637),s=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(s.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:s}=this;if(s){const t=this.color,s="[3"+(t<8?t:"8;5;"+t),i=`  ${s};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=s.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(8220)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)}},37:e=>{var t=1e3,r=60*t,n=60*r,s=24*n,i=7*s;function o(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,a){a=a||{};var c,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*i;case"days":case"day":case"d":return a*s;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(c=e,(u=Math.abs(c))>=s?o(c,u,s,"day"):u>=n?o(c,u,n,"hour"):u>=r?o(c,u,r,"minute"):u>=t?o(c,u,t,"second"):c+" ms"):function(e){var i=Math.abs(e);return i>=s?Math.round(e/s)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2746:e=>{var t=Object.prototype.toString,r="undefined"!=typeof Buffer&&"function"==typeof Buffer.alloc&&"function"==typeof Buffer.allocUnsafe&&"function"==typeof Buffer.from;e.exports=function(e,n,s){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return i=e,"ArrayBuffer"===t.call(i).slice(8,-1)?function(e,t,n){t>>>=0;var s=e.byteLength-t;if(s<0)throw new RangeError("'offset' is out of bounds");if(void 0===n)n=s;else if((n>>>=0)>s)throw new RangeError("'length' is out of bounds");return r?Buffer.from(e.slice(t,t+n)):new Buffer(new Uint8Array(e.slice(t,t+n)))}(e,n,s):"string"==typeof e?function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Buffer.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');return r?Buffer.from(e,t):new Buffer(e,t)}(e,n):r?Buffer.from(e):new Buffer(e);var i}},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r={grad:.9,turn:360,rad:360/(2*Math.PI)},n=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},s=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},i=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},o=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},a=function(e){return{r:i(e.r,0,255),g:i(e.g,0,255),b:i(e.b,0,255),a:i(e.a)}},c=function(e){return{r:s(e.r),g:s(e.g),b:s(e.b),a:s(e.a,3)}},u=/^#([0-9a-f]{3,8})$/i,l=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,r=e.g,n=e.b,s=e.a,i=Math.max(t,r,n),o=i-Math.min(t,r,n),a=o?i===t?(r-n)/o:i===r?2+(n-t)/o:4+(t-r)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:s}},h=function(e){var t=e.h,r=e.s,n=e.v,s=e.a;t=t/360*6,r/=100,n/=100;var i=Math.floor(t),o=n*(1-r),a=n*(1-(t-i)*r),c=n*(1-(1-t+i)*r),u=i%6;return{r:255*[n,a,o,o,c,n][u],g:255*[c,n,n,a,o,o][u],b:255*[o,o,c,n,n,a][u],a:s}},p=function(e){return{h:o(e.h),s:i(e.s,0,100),l:i(e.l,0,100),a:i(e.a)}},f=function(e){return{h:s(e.h),s:s(e.s),l:s(e.l),a:s(e.a,3)}},m=function(e){return h((r=(t=e).s,{h:t.h,s:(r*=((n=t.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:t.a}));var t,r,n},g=function(e){return{h:(t=d(e)).h,s:(s=(200-(r=t.s))*(n=t.v)/100)>0&&s<200?r*n/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,r,n,s},y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,C={string:[[function(e){var t=u.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?s(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?s(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=v.exec(e)||w.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=y.exec(e)||b.exec(e);if(!t)return null;var n,s,i=p({h:(n=t[1],s=t[2],void 0===s&&(s="deg"),Number(n)*(r[s]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return m(i)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,s=e.b,i=e.a,o=void 0===i?1:i;return n(t)&&n(r)&&n(s)?a({r:Number(t),g:Number(r),b:Number(s),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,r=e.s,s=e.l,i=e.a,o=void 0===i?1:i;if(!n(t)||!n(r)||!n(s))return null;var a=p({h:Number(t),s:Number(r),l:Number(s),a:Number(o)});return m(a)},"hsl"],[function(e){var t=e.h,r=e.s,s=e.v,a=e.a,c=void 0===a?1:a;if(!n(t)||!n(r)||!n(s))return null;var u=function(e){return{h:o(e.h),s:i(e.s,0,100),v:i(e.v,0,100),a:i(e.a)}}({h:Number(t),s:Number(r),v:Number(s),a:Number(c)});return h(u)},"hsv"]]},_=function(e,t){for(var r=0;r<t.length;r++){var n=t[r][0](e);if(n)return[n,t[r][1]]}return[null,void 0]},S=function(e){return"string"==typeof e?_(e.trim(),C.string):"object"==typeof e&&null!==e?_(e,C.object):[null,void 0]},E=function(e,t){var r=g(e);return{h:r.h,s:i(r.s+100*t,0,100),l:r.l,a:r.a}},A=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},I=function(e,t){var r=g(e);return{h:r.h,s:r.s,l:i(r.l+100*t,0,100),a:r.a}},k=function(){function e(e){this.parsed=S(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return s(A(this.rgba),2)},e.prototype.isDark=function(){return A(this.rgba)<.5},e.prototype.isLight=function(){return A(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=c(this.rgba)).r,r=e.g,n=e.b,o=(i=e.a)<1?l(s(255*i)):"","#"+l(t)+l(r)+l(n)+o;var e,t,r,n,i,o},e.prototype.toRgb=function(){return c(this.rgba)},e.prototype.toRgbString=function(){return t=(e=c(this.rgba)).r,r=e.g,n=e.b,(s=e.a)<1?"rgba("+t+", "+r+", "+n+", "+s+")":"rgb("+t+", "+r+", "+n+")";var e,t,r,n,s},e.prototype.toHsl=function(){return f(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=f(g(this.rgba))).h,r=e.s,n=e.l,(s=e.a)<1?"hsla("+t+", "+r+"%, "+n+"%, "+s+")":"hsl("+t+", "+r+"%, "+n+"%)";var e,t,r,n,s},e.prototype.toHsv=function(){return e=d(this.rgba),{h:s(e.h),s:s(e.s),v:s(e.v),a:s(e.a,3)};var e},e.prototype.invert=function(){return O({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),O(E(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),O(E(this.rgba,-e))},e.prototype.grayscale=function(){return O(E(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),O(I(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),O(I(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?O({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):s(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?O({h:e,s:t.s,l:t.l,a:t.a}):s(t.h)},e.prototype.isEqual=function(e){return this.toHex()===O(e).toHex()},e}(),O=function(e){return e instanceof k?e:new k(e)},P=[];t.Colord=k,t.colord=O,t.extend=function(e){e.forEach((function(e){P.indexOf(e)<0&&(e(k,C),P.push(e))}))},t.getFormat=function(e){return S(e)[1]},t.random=function(){return new k({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===n(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var s=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=s,t.convertMapToObject=function(e){return Array.from(e).reduce((function(e,t){var n,s,i=(s=2,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,s,i=[],o=!0,a=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){a=!0,s=e}finally{try{o||null==r.return||r.return()}finally{if(a)throw s}}return i}}(n,s)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(n,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],a=i[1];return e[o]=a,e}),{})},t.isArguments=function(e){return null!=e&&s(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var i={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=i,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(i.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var r=Object.create(null),n=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},s=0;s<64;s++)r[n(s)]=s;var i=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],r=0;r<e;r++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},o={encode:function(e){if("string"==typeof e){var t=e;e=i(t.length);for(var r=0;r<t.length;r++){var s=t.charCodeAt(r);if(s>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[r]=s}}for(var o=[],a=null,c=null,u=null,l=null,d=0;d<e.length;d++)switch(d%3){case 0:a=e[d]>>2&63,c=(3&e[d])<<4;break;case 1:c|=e[d]>>4&15,u=(15&e[d])<<2;break;case 2:u|=e[d]>>6&3,l=63&e[d],o.push(n(a)),o.push(n(c)),o.push(n(u)),o.push(n(l)),a=null,c=null,u=null,l=null}return null!=a&&(o.push(n(a)),o.push(n(c)),null==u?o.push("="):o.push(n(u)),null==l&&o.push("=")),o.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var n,s=i(t),o=null,a=null,c=null,u=0,l=0;l<e.length;l++){var d="="===(n=e.charAt(l))?-1:r[n];switch(l%4){case 0:if(d<0)throw new Error("invalid base64 string");o=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");o|=d>>4,s[u++]=o,a=(15&d)<<4;break;case 2:d>=0&&(a|=d>>2,s[u++]=a,c=(3&d)<<6);break;case 3:d>=0&&(s[u++]=c|d)}}return s},newBinary:i};t.Base64=o},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function e(t,s,i,o,a){var c=s[t];switch(r(c)){case"string":return n(c);case"number":return isFinite(c)?String(c):"null";case"boolean":return String(c);case"object":if(!c)return"null";var u,l=o+i,d=[];if(Array.isArray(c)||{}.hasOwnProperty.call(c,"callee")){for(var h=c.length,p=0;p<h;p+=1)d[p]=e(p,c,i,l,a)||"null";return u=0===d.length?"[]":l?"[\n"+l+d.join(",\n"+l)+"\n"+o+"]":"["+d.join(",")+"]"}var f=Object.keys(c);return a&&(f=f.sort()),f.forEach((function(t){(u=e(t,c,i,l,a))&&d.push(n(t)+(l?": ":":")+u)})),u=0===d.length?"{}":l?"{\n"+l+d.join(",\n"+l)+"\n"+o+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var r=Object.assign({indent:"",canonical:!1},t);if(!0===r.indent)r.indent="  ";else if("number"==typeof r.indent){for(var n="",i=0;i<r.indent;i++)n+=" ";r.indent=n}return s("",{"":e},r.indent,"",r.canonical)},e.exports=t.default}],r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,n),i.exports}var s={};!function(){var e=s,t=n(2).Base64,r=n(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var i=n(1),o={};e.EJSON=o;var a=new Map;o.addType=function(e,t){if(a.has(e))throw new Error("Type ".concat(e," already present"));a.set(e,t)};var c=[{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$date")&&1===(0,i.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$regexp")&&(0,i.hasOwn)(e,"$flags")&&2===(0,i.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$InfNaN")&&1===(0,i.lengthOf)(e)},matchObject:i.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$binary")&&1===(0,i.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,i.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$escape")&&1===(0,i.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var r=(0,i.lengthOf)(e);1!==r&&2!==r||(t=c.some((function(t){return t.matchJSONValue(e)})))}return t},toJSONValue:function(e){var t={};return(0,i.keysOf)(e).forEach((function(r){t[r]=o.toJSONValue(e[r])})),{$escape:t}},fromJSONValue:function(e){var t={};return(0,i.keysOf)(e.$escape).forEach((function(r){t[r]=o.fromJSONValue(e.$escape[r])})),t}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$type")&&(0,i.hasOwn)(e,"$value")&&2===(0,i.lengthOf)(e)},matchObject:function(e){return o._isCustomType(e)},toJSONValue:function(e){var t=r._noYieldsAllowed((function(){return e.toJSONValue()}));return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!a.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var n=a.get(t);return r._noYieldsAllowed((function(){return n(e.$value)}))}}];o._isCustomType=function(e){return e&&(0,i.isFunction)(e.toJSONValue)&&(0,i.isFunction)(e.typeName)&&a.has(e.typeName())},o._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?a:(0,i.convertMapToObject)(a)},o._getConverters=function(){return c};var u=function(e){for(var t=0;t<c.length;t++){var r=c[t];if(r.matchObject(e))return r.toJSONValue(e)}},l=function e(t){if(null===t)return null;var r=u(t);return void 0!==r?r:(0,i.isObject)(t)?((0,i.keysOf)(t).forEach((function(r){var n=t[r];if((0,i.isObject)(n)||void 0===n||(0,i.isInfOrNaN)(n)){var s=u(n);s?t[r]=s:e(n)}})),t):t};o._adjustTypesToJSONValue=l,o.toJSONValue=function(e){var t=u(e);if(void 0!==t)return t;var r=e;return(0,i.isObject)(e)&&(r=o.clone(e),l(r)),r};var d=function(e){if((0,i.isObject)(e)&&null!==e){var t=(0,i.keysOf)(e);if(t.length<=2&&t.every((function(e){return"string"==typeof e&&"$"===e.substr(0,1)})))for(var r=0;r<c.length;r++){var n=c[r];if(n.matchJSONValue(e))return n.fromJSONValue(e)}}return e},h=function e(t){if(null===t)return null;var r=d(t);return r!==t?r:(0,i.isObject)(t)?((0,i.keysOf)(t).forEach((function(r){var n=t[r];if((0,i.isObject)(n)){var s=d(n);if(n!==s)return void(t[r]=s);e(n)}})),t):t};o._adjustTypesFromJSONValue=h,o.fromJSONValue=function(e){var t=d(e);return t===e&&(0,i.isObject)(e)&&(t=o.clone(e),h(t)),t},o.stringify=(0,i.handleError)((function(e,t){var r=o.toJSONValue(e);return t&&(t.canonical||t.indent)?n(4)(r,t):JSON.stringify(r)})),o.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return o.fromJSONValue(JSON.parse(e))},o.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},o.equals=function(e,t,r){var n,s=!(!r||!r.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,i.isObject)(e)||!(0,i.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(o.isBinary(e)&&o.isBinary(t)){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}if((0,i.isFunction)(e.equals))return e.equals(t,r);if((0,i.isFunction)(t.equals))return t.equals(e,r);var a,c=Array.isArray(e),u=Array.isArray(t);if(c!==u)return!1;if(c&&u){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(!o.equals(e[n],t[n],r))return!1;return!0}switch(o._isCustomType(e)+o._isCustomType(t)){case 1:return!1;case 2:return o.equals(o.toJSONValue(e),o.toJSONValue(t))}var l=(0,i.keysOf)(e),d=(0,i.keysOf)(t);return s?(n=0,a=l.every((function(s){return!(n>=d.length||s!==d[n]||!o.equals(e[s],t[d[n]],r)||(n++,0))}))):(n=0,a=l.every((function(s){return!!(0,i.hasOwn)(t,s)&&!!o.equals(e[s],t[s],r)&&(n++,!0)}))),a&&n===d.length},o.clone=function(e){var t;if(!(0,i.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(o.isBinary(e)){t=o.newBinary(e.length);for(var r=0;r<e.length;r++)t[r]=e[r];return t}return Array.isArray(e)?e.map(o.clone):(0,i.isArguments)(e)?Array.from(e).map(o.clone):(0,i.isFunction)(e.clone)?e.clone():o._isCustomType(e)?o.fromJSONValue(o.clone(o.toJSONValue(e)),!0):(t={},(0,i.keysOf)(e).forEach((function(r){t[r]=o.clone(e[r])})),t)},o.newBinary=t.newBinary}(),e.exports=s.EJSON}()},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,i||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,s=[];if(0===this._eventsCount)return s;for(n in e=this._events)t.call(e,n)&&s.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,i=n.length,o=new Array(i);s<i;s++)o[s]=n[s].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,s,i,o){var a=r?r+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,s),!0;case 5:return l.fn.call(l.context,t,n,s,i),!0;case 6:return l.fn.call(l.context,t,n,s,i,o),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,s);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,s){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||s&&!a.once||n&&a.context!==n||o(this,i);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||s&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[i]=1===u.length?u[0]:u:o(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},2017:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,s,i;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(s=n;0!=s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(r,i[s]))return!1;for(s=n;0!=s--;){var o=i[s];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}},5884:e=>{"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),s=t.indexOf("--");return-1!==n&&(-1===s||n<s)}},8570:e=>{e.exports=r;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var s={},i={};function o(e,t){var r,n,o;return t?(o=0<=(e>>>=0)&&e<256)&&(n=i[e])?n:(r=c(e,(0|e)<0?-1:0,!0),o&&(i[e]=r),r):(o=-128<=(e|=0)&&e<128)&&(n=s[e])?n:(r=c(e,e<0?-1:0,!1),o&&(s[e]=r),r)}function a(e,t){if(isNaN(e))return t?y:g;if(t){if(e<0)return y;if(e>=p)return _}else{if(e<=-f)return S;if(e+1>=f)return C}return e<0?a(-e,t).neg():c(e%h|0,e/h|0,t)}function c(e,t,n){return new r(e,t,n)}r.fromInt=o,r.fromNumber=a,r.fromBits=c;var u=Math.pow;function l(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return l(e.substring(1),t,r).neg();for(var s=a(u(r,8)),i=g,o=0;o<e.length;o+=8){var c=Math.min(8,e.length-o),d=parseInt(e.substring(o,o+c),r);if(c<8){var h=a(u(r,c));i=i.mul(h).add(a(d))}else i=(i=i.mul(s)).add(a(d))}return i.unsigned=t,i}function d(e,t){return"number"==typeof e?a(e,t):"string"==typeof e?l(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=l,r.fromValue=d;var h=4294967296,p=h*h,f=p/2,m=o(1<<24),g=o(0);r.ZERO=g;var y=o(0,!0);r.UZERO=y;var b=o(1);r.ONE=b;var v=o(1,!0);r.UONE=v;var w=o(-1);r.NEG_ONE=w;var C=c(-1,2147483647,!1);r.MAX_VALUE=C;var _=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=_;var S=c(0,-2147483648,!1);r.MIN_VALUE=S;var E=r.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},E.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=a(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var s=a(u(e,6),this.unsigned),i=this,o="";;){var c=i.div(s),l=(i.sub(c.mul(s)).toInt()>>>0).toString(e);if((i=c).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},E.isZero=function(){return 0===this.high&&0===this.low},E.eqz=E.isZero,E.isNegative=function(){return!this.unsigned&&this.high<0},E.isPositive=function(){return this.unsigned||this.high>=0},E.isOdd=function(){return!(1&~this.low)},E.isEven=function(){return!(1&this.low)},E.equals=function(e){return n(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},E.eq=E.equals,E.notEquals=function(e){return!this.eq(e)},E.neq=E.notEquals,E.ne=E.notEquals,E.lessThan=function(e){return this.comp(e)<0},E.lt=E.lessThan,E.lessThanOrEqual=function(e){return this.comp(e)<=0},E.lte=E.lessThanOrEqual,E.le=E.lessThanOrEqual,E.greaterThan=function(e){return this.comp(e)>0},E.gt=E.greaterThan,E.greaterThanOrEqual=function(e){return this.comp(e)>=0},E.gte=E.greaterThanOrEqual,E.ge=E.greaterThanOrEqual,E.compare=function(e){if(n(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(b)},E.neg=E.negate,E.add=function(e){n(e)||(e=d(e));var t=this.high>>>16,r=65535&this.high,s=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,u=e.low>>>16,l=0,h=0,p=0,f=0;return p+=(f+=i+(65535&e.low))>>>16,h+=(p+=s+u)>>>16,l+=(h+=r+a)>>>16,l+=t+o,c((p&=65535)<<16|(f&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},E.subtract=function(e){return n(e)||(e=d(e)),this.add(e.neg())},E.sub=E.subtract,E.multiply=function(e){if(this.isZero())return g;if(n(e)||(e=d(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(S))return e.isOdd()?S:g;if(e.eq(S))return this.isOdd()?S:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return a(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=65535&this.high,i=this.low>>>16,o=65535&this.low,u=e.high>>>16,l=65535&e.high,h=e.low>>>16,p=65535&e.low,f=0,y=0,b=0,v=0;return b+=(v+=o*p)>>>16,y+=(b+=i*p)>>>16,b&=65535,y+=(b+=o*h)>>>16,f+=(y+=s*p)>>>16,y&=65535,f+=(y+=i*h)>>>16,y&=65535,f+=(y+=o*l)>>>16,f+=r*p+s*h+i*l+o*u,c((b&=65535)<<16|(v&=65535),(f&=65535)<<16|(y&=65535),this.unsigned)},E.mul=E.multiply,E.divide=function(e){if(n(e)||(e=d(e)),e.isZero())throw Error("division by zero");var r,s,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return v;i=y}else{if(this.eq(S))return e.eq(b)||e.eq(w)?S:e.eq(S)?b:(r=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?b:w:(s=this.sub(e.mul(r)),i=r.add(s.div(e)));if(e.eq(S))return this.unsigned?y:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=g}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),l=o<=48?1:u(2,o-48),h=a(r),p=h.mul(e);p.isNegative()||p.gt(s);)p=(h=a(r-=l,this.unsigned)).mul(e);h.isZero()&&(h=b),i=i.add(h),s=s.sub(p)}return i},E.div=E.divide,E.modulo=function(e){return n(e)||(e=d(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},E.mod=E.modulo,E.rem=E.modulo,E.not=function(){return c(~this.low,~this.high,this.unsigned)},E.and=function(e){return n(e)||(e=d(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},E.or=function(e){return n(e)||(e=d(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},E.xor=function(e){return n(e)||(e=d(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},E.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.shr_u=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},E.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},E.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},4865:e=>{"use strict";const t=(e,t,n,s)=>{if("length"===n||"prototype"===n)return;if("arguments"===n||"caller"===n)return;const i=Object.getOwnPropertyDescriptor(e,n),o=Object.getOwnPropertyDescriptor(t,n);!r(i,o)&&s||Object.defineProperty(e,n,o)},r=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},n=(e,t)=>`/* Wrapped ${e}*/\n${t}`,s=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),i=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,r,{ignoreNonConfigurable:o=!1}={})=>{const{name:a}=e;for(const n of Reflect.ownKeys(r))t(e,r,n,o);return((e,t)=>{const r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)})(e,r),((e,t,r)=>{const o=""===r?"":`with ${r.trim()}() `,a=n.bind(null,o,t.toString());Object.defineProperty(a,"name",i),Object.defineProperty(e,"toString",{...s,value:a})})(e,r,a),e}},6585:e=>{var t=1e3,r=60*t,n=60*r,s=24*n,i=7*s;function o(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,a){a=a||{};var c,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*i;case"days":case"day":case"d":return a*s;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(c=e,(u=Math.abs(c))>=s?o(c,u,s,"day"):u>=n?o(c,u,n,"hour"):u>=r?o(c,u,r,"minute"):u>=t?o(c,u,t,"second"):c+" ms"):function(e){var i=Math.abs(e);return i>=s?Math.round(e/s)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},8169:(e,t,r)=>{"function"==typeof process.addon?e.exports=process.addon.bind(process):e.exports=r(1381)},1381:(e,t,r)=>{var n=r(9896),s=r(6928),i=r(857),o=require,a=process.config&&process.config.variables||{},c=!!process.env.PREBUILDS_ONLY,u=process.versions.modules,l=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":process.versions&&process.versions.nw?"node-webkit":"node",d=process.env.npm_config_arch||i.arch(),h=process.env.npm_config_platform||i.platform(),p=process.env.LIBC||(function(e){return"linux"===e&&n.existsSync("/etc/alpine-release")}(h)?"musl":"glibc"),f=process.env.ARM_VERSION||("arm64"===d?"8":a.arm_version)||"",m=(process.versions.uv||"").split(".")[0];function g(e){return o(g.resolve(e))}function y(e){try{return n.readdirSync(e)}catch(e){return[]}}function b(e,t){var r=y(e).filter(t);return r[0]&&s.join(e,r[0])}function v(e){return/\.node$/.test(e)}function w(e){var t=e.split("-");if(2===t.length){var r=t[0],n=t[1].split("+");if(r&&n.length&&n.every(Boolean))return{name:e,platform:r,architectures:n}}}function C(e,t){return function(r){return null!=r&&r.platform===e&&r.architectures.includes(t)}}function _(e,t){return e.architectures.length-t.architectures.length}function S(e){var t=e.split("."),r={file:e,specificity:0};if("node"===t.pop()){for(var n=0;n<t.length;n++){var s=t[n];if("node"===s||"electron"===s||"node-webkit"===s)r.runtime=s;else if("napi"===s)r.napi=!0;else if("abi"===s.slice(0,3))r.abi=s.slice(3);else if("uv"===s.slice(0,2))r.uv=s.slice(2);else if("armv"===s.slice(0,4))r.armv=s.slice(4);else{if("glibc"!==s&&"musl"!==s)continue;r.libc=s}r.specificity++}return r}}function E(e,t){return function(r){return!(null==r||r.runtime!==e&&!function(e){return"node"===e.runtime&&e.napi}(r)||r.abi!==t&&!r.napi||r.uv&&r.uv!==m||r.armv&&r.armv!==f||r.libc&&r.libc!==p)}}function A(e){return function(t,r){return t.runtime!==r.runtime?t.runtime===e?-1:1:t.abi!==r.abi?t.abi?-1:1:t.specificity!==r.specificity?t.specificity>r.specificity?-1:1:0}}e.exports=g,g.resolve=g.path=function(e){e=s.resolve(e||".");try{var t=o(s.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[t+"_PREBUILD"]&&(e=process.env[t+"_PREBUILD"])}catch(e){}if(!c){var r=b(s.join(e,"build/Release"),v);if(r)return r;var n=b(s.join(e,"build/Debug"),v);if(n)return n}var i=I(e);if(i)return i;var a=I(s.dirname(process.execPath));if(a)return a;var g=["platform="+h,"arch="+d,"runtime="+l,"abi="+u,"uv="+m,f?"armv="+f:"","libc="+p,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ");throw new Error("No native build was found for "+g+"\n    loaded from: "+e+"\n");function I(e){var t=y(s.join(e,"prebuilds")).map(w).filter(C(h,d)).sort(_)[0];if(t){var r=s.join(e,"prebuilds",t.name),n=y(r).map(S).filter(E(l,u)).sort(A(l))[0];return n?s.join(r,n.file):void 0}}},g.parseTags=S,g.matchTags=E,g.compareTags=A,g.parseTuple=w,g.matchTuple=C,g.compareTuples=_},825:(e,t,r)=>{var n=n||r(7026),s=s||r(5170),i=i||r(4434).EventEmitter;!function(){"use strict";n.supportsSerial=!1,n.firePacketEvents=function(e,t,r,s){t.address?e.emit("message",t,r,s):n.fireBundleEvents(e,t,r,s)},n.fireBundleEvents=function(e,t,r,s){e.emit("bundle",t,r,s);for(var i=0;i<t.packets.length;i++){var o=t.packets[i];n.firePacketEvents(e,o,t.timeTag,s)}},n.fireClosedPortSendError=function(e,t){t=t||"Can't send packets on a closed osc.Port object. Please open (or reopen) this Port by calling open().",e.emit("error",t)},n.Port=function(e){this.options=e||{},this.on("data",this.decodeOSC.bind(this))};var t=n.Port.prototype=Object.create(i.prototype);t.constructor=n.Port,t.send=function(e){var t=Array.prototype.slice.call(arguments),r=this.encodeOSC(e),s=n.nativeBuffer(r);t[0]=s,this.sendRaw.apply(this,t)},t.encodeOSC=function(e){var t;e=e.buffer?e.buffer:e;try{t=n.writePacket(e,this.options)}catch(e){this.emit("error",e)}return t},t.decodeOSC=function(e,t){e=n.byteArray(e),this.emit("raw",e,t);try{var r=n.readPacket(e,this.options);this.emit("osc",r,t),n.firePacketEvents(this,r,void 0,t)}catch(e){this.emit("error",e)}},n.SLIPPort=function(e){var t=this,r=this.options=e||{};r.useSLIP=void 0===r.useSLIP||r.useSLIP,this.decoder=new s.Decoder({onMessage:this.decodeOSC.bind(this),onError:function(e){t.emit("error",e)}});var n=r.useSLIP?this.decodeSLIPData:this.decodeOSC;this.on("data",n.bind(this))},(t=n.SLIPPort.prototype=Object.create(n.Port.prototype)).constructor=n.SLIPPort,t.encodeOSC=function(e){var t;e=e.buffer?e.buffer:e;try{var r=n.writePacket(e,this.options);t=s.encode(r)}catch(e){this.emit("error",e)}return t},t.decodeSLIPData=function(e,t){this.decoder.decode(e,t)},n.relay=function(e,t,r,n,s,i){r=r||"message",n=n||"send",s=s||function(){},i=i?[null].concat(i):[];var o=function(e){i[0]=e,e=s(e),t[n].apply(t,i)};return e.on(r,o),{eventName:r,listener:o}},n.relayPorts=function(e,t,r){var s=r.raw?"raw":"osc",i=r.raw?"sendRaw":"send";return n.relay(e,t,s,i,r.transform)},n.stopRelaying=function(e,t){e.removeListener(t.eventName,t.listener)},n.Relay=function(e,t,r){(this.options=r||{}).raw=!1,this.port1=e,this.port2=t,this.listen()},(t=n.Relay.prototype=Object.create(i.prototype)).constructor=n.Relay,t.open=function(){this.port1.open(),this.port2.open()},t.listen=function(){this.port1Spec&&this.port2Spec&&this.close(),this.port1Spec=n.relayPorts(this.port1,this.port2,this.options),this.port2Spec=n.relayPorts(this.port2,this.port1,this.options);var e=this.close.bind(this);this.port1.on("close",e),this.port2.on("close",e)},t.close=function(){n.stopRelaying(this.port1,this.port1Spec),n.stopRelaying(this.port2,this.port2Spec),this.emit("close",this.port1,this.port2)},e.exports&&(e.exports=n)}()},7026:(e,t,r)=>{var n=n||{};!function(){"use strict";n.SECS_70YRS=2208988800,n.TWO_32=4294967296,n.defaults={metadata:!1,unpackSingleArgs:!0},n.isCommonJS=!!e.exports,n.isNode=n.isCommonJS&&"undefined"==typeof window,n.isElectron=!("undefined"==typeof process||!process.versions||!process.versions.electron),n.isBufferEnv=n.isNode||n.isElectron,n.isArray=function(e){return e&&"[object Array]"===Object.prototype.toString.call(e)},n.isTypedArrayView=function(e){return e.buffer&&e.buffer instanceof ArrayBuffer},n.isBuffer=function(e){return n.isBufferEnv&&e instanceof Buffer},n.Long="undefined"!=typeof Long?Long:n.isNode?r(8570):void 0,n.TextDecoder="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):"undefined"!=typeof util&&(util.TextDecoder,1)?new util.TextDecoder("utf-8"):void 0,n.TextEncoder="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):"undefined"!=typeof util&&(util.TextEncoder,1)?new util.TextEncoder("utf-8"):void 0,n.dataView=function(e,t,r){return e.buffer?new DataView(e.buffer,t,r):e instanceof ArrayBuffer?new DataView(e,t,r):new DataView(new Uint8Array(e),t,r)},n.byteArray=function(e){if(e instanceof Uint8Array)return e;var t=e.buffer?e.buffer:e;if(!(t instanceof ArrayBuffer||void 0!==t.length&&"string"!=typeof t))throw new Error("Can't wrap a non-array-like object as Uint8Array. Object was: "+JSON.stringify(e,null,2));return new Uint8Array(t)},n.nativeBuffer=function(e){return n.isBufferEnv?n.isBuffer(e)?e:Buffer.from(e.buffer?e:new Uint8Array(e)):n.isTypedArrayView(e)?e:new Uint8Array(e)},n.copyByteArray=function(e,t,r){if(n.isTypedArrayView(e)&&n.isTypedArrayView(t))t.set(e,r);else for(var s=void 0===r?0:r,i=Math.min(t.length-r,e.length),o=0,a=s;o<i;o++,a++)t[a]=e[o];return t},n.readString=function(e,t){for(var r=[],s=t.idx;s<e.byteLength;s++){var i=e.getUint8(s);if(0===i){s++;break}r.push(i)}return s=s+3&-4,t.idx=s,(n.isBufferEnv?n.readString.withBuffer:n.TextDecoder?n.readString.withTextDecoder:n.readString.raw)(r)},n.readString.raw=function(e){for(var t="",r=0;r<e.length;r+=1e4)t+=String.fromCharCode.apply(null,e.slice(r,r+1e4));return t},n.readString.withTextDecoder=function(e){var t=new Int8Array(e);return n.TextDecoder.decode(t)},n.readString.withBuffer=function(e){return Buffer.from(e).toString("utf-8")},n.writeString=function(e){var t,r=n.isBufferEnv?n.writeString.withBuffer:n.TextEncoder?n.writeString.withTextEncoder:null,s=e+"\0";r&&(t=r(s));for(var i=r?t.length:s.length,o=new Uint8Array(i+3&-4),a=0;a<i-1;a++){var c=r?t[a]:s.charCodeAt(a);o[a]=c}return o},n.writeString.withTextEncoder=function(e){return n.TextEncoder.encode(e)},n.writeString.withBuffer=function(e){return Buffer.from(e)},n.readPrimitive=function(e,t,r,n){var s=e[t](n.idx,!1);return n.idx+=r,s},n.writePrimitive=function(e,t,r,n,s){var i;return s=void 0===s?0:s,t?i=new Uint8Array(t.buffer):(i=new Uint8Array(n),t=new DataView(i.buffer)),t[r](s,e,!1),i},n.readInt32=function(e,t){return n.readPrimitive(e,"getInt32",4,t)},n.writeInt32=function(e,t,r){return n.writePrimitive(e,t,"setInt32",4,r)},n.readInt64=function(e,t){var r=n.readPrimitive(e,"getInt32",4,t),s=n.readPrimitive(e,"getInt32",4,t);return n.Long?new n.Long(s,r):{high:r,low:s,unsigned:!1}},n.writeInt64=function(e,t,r){var s=new Uint8Array(8);return s.set(n.writePrimitive(e.high,t,"setInt32",4,r),0),s.set(n.writePrimitive(e.low,t,"setInt32",4,r+4),4),s},n.readFloat32=function(e,t){return n.readPrimitive(e,"getFloat32",4,t)},n.writeFloat32=function(e,t,r){return n.writePrimitive(e,t,"setFloat32",4,r)},n.readFloat64=function(e,t){return n.readPrimitive(e,"getFloat64",8,t)},n.writeFloat64=function(e,t,r){return n.writePrimitive(e,t,"setFloat64",8,r)},n.readChar32=function(e,t){var r=n.readPrimitive(e,"getUint32",4,t);return String.fromCharCode(r)},n.writeChar32=function(e,t,r){var s=e.charCodeAt(0);if(!(void 0===s||s<-1))return n.writePrimitive(s,t,"setUint32",4,r)},n.readBlob=function(e,t){var r=n.readInt32(e,t),s=r+3&-4,i=new Uint8Array(e.buffer,t.idx,r);return t.idx+=s,i},n.writeBlob=function(e){var t=(e=n.byteArray(e)).byteLength,r=new Uint8Array(4+(t+3&-4)),s=new DataView(r.buffer);return n.writeInt32(t,s),r.set(e,4),r},n.readMIDIBytes=function(e,t){var r=new Uint8Array(e.buffer,t.idx,4);return t.idx+=4,r},n.writeMIDIBytes=function(e){e=n.byteArray(e);var t=new Uint8Array(4);return t.set(e),t},n.readColor=function(e,t){var r=new Uint8Array(e.buffer,t.idx,4),n=r[3]/255;return t.idx+=4,{r:r[0],g:r[1],b:r[2],a:n}},n.writeColor=function(e){var t=Math.round(255*e.a);return new Uint8Array([e.r,e.g,e.b,t])},n.readTrue=function(){return!0},n.readFalse=function(){return!1},n.readNull=function(){return null},n.readImpulse=function(){return 1},n.readTimeTag=function(e,t){var r=n.readPrimitive(e,"getUint32",4,t),s=n.readPrimitive(e,"getUint32",4,t);return{raw:[r,s],native:0===r&&1===s?Date.now():n.ntpToJSTime(r,s)}},n.writeTimeTag=function(e){var t=e.raw?e.raw:n.jsToNTPTime(e.native),r=new Uint8Array(8),s=new DataView(r.buffer);return n.writeInt32(t[0],s,0),n.writeInt32(t[1],s,4),r},n.timeTag=function(e,t){e=e||0;var r=(t=t||Date.now())/1e3,s=Math.floor(r),i=r-s,o=Math.floor(e),a=i+(e-o);if(a>1){var c=Math.floor(a);o+=c,a-=c}return{raw:[s+o+n.SECS_70YRS,Math.round(n.TWO_32*a)]}},n.ntpToJSTime=function(e,t){return 1e3*(e-n.SECS_70YRS+t/n.TWO_32)},n.jsToNTPTime=function(e){var t=e/1e3,r=Math.floor(t),s=t-r;return[r+n.SECS_70YRS,Math.round(n.TWO_32*s)]},n.readArguments=function(e,t,r){var s=n.readString(e,r);if(0!==s.indexOf(","))throw new Error("A malformed type tag string was found while reading the arguments of an OSC message. String was: "+s," at offset: "+r.idx);var i=s.substring(1).split(""),o=[];return n.readArgumentsIntoArray(o,i,s,e,t,r),o},n.readArgument=function(e,t,r,s,i){var o=n.argumentTypes[e];if(!o)throw new Error("'"+e+"' is not a valid OSC type tag. Type tag string was: "+t);var a=o.reader,c=n[a](r,i);return s.metadata&&(c={type:e,value:c}),c},n.readArgumentsIntoArray=function(e,t,r,s,i,o){for(var a=0;a<t.length;){var c,u=t[a];if("["===u){var l=t.slice(a+1),d=l.indexOf("]");if(d<0)throw new Error("Invalid argument type tag: an open array type tag ('[') was found without a matching close array tag ('[]'). Type tag was: "+r);var h=l.slice(0,d);c=n.readArgumentsIntoArray([],h,r,s,i,o),a+=d+2}else c=n.readArgument(u,r,s,i,o),a++;e.push(c)}return e},n.writeArguments=function(e,t){var r=n.collectArguments(e,t);return n.joinParts(r)},n.joinParts=function(e){for(var t=new Uint8Array(e.byteLength),r=e.parts,s=0,i=0;i<r.length;i++){var o=r[i];n.copyByteArray(o,t,s),s+=o.length}return t},n.addDataPart=function(e,t){t.parts.push(e),t.byteLength+=e.length},n.writeArrayArguments=function(e,t){for(var r="[",s=0;s<e.length;s++){var i=e[s];r+=n.writeArgument(i,t)}return r+"]"},n.writeArgument=function(e,t){if(n.isArray(e))return n.writeArrayArguments(e,t);var r=e.type,s=n.argumentTypes[r].writer;if(s){var i=n[s](e.value);n.addDataPart(i,t)}return e.type},n.collectArguments=function(e,t,r){n.isArray(e)||(e=void 0===e?[]:[e]),r=r||{byteLength:0,parts:[]},t.metadata||(e=n.annotateArguments(e));for(var s=",",i=r.parts.length,o=0;o<e.length;o++){var a=e[o];s+=n.writeArgument(a,r)}var c=n.writeString(s);return r.byteLength+=c.byteLength,r.parts.splice(i,0,c),r},n.readMessage=function(e,t,r){t=t||n.defaults;var s=n.dataView(e,e.byteOffset,e.byteLength);r=r||{idx:0};var i=n.readString(s,r);return n.readMessageContents(i,s,t,r)},n.readMessageContents=function(e,t,r,s){if(0!==e.indexOf("/"))throw new Error("A malformed OSC address was found while reading an OSC message. String was: "+e);var i=n.readArguments(t,r,s);return{address:e,args:1===i.length&&r.unpackSingleArgs?i[0]:i}},n.collectMessageParts=function(e,t,r){return r=r||{byteLength:0,parts:[]},n.addDataPart(n.writeString(e.address),r),n.collectArguments(e.args,t,r)},n.writeMessage=function(e,t){if(t=t||n.defaults,!n.isValidMessage(e))throw new Error("An OSC message must contain a valid address. Message was: "+JSON.stringify(e,null,2));var r=n.collectMessageParts(e,t);return n.joinParts(r)},n.isValidMessage=function(e){return e.address&&0===e.address.indexOf("/")},n.readBundle=function(e,t,r){return n.readPacket(e,t,r)},n.collectBundlePackets=function(e,t,r){r=r||{byteLength:0,parts:[]},n.addDataPart(n.writeString("#bundle"),r),n.addDataPart(n.writeTimeTag(e.timeTag),r);for(var s=0;s<e.packets.length;s++){var i=e.packets[s],o=(i.address?n.collectMessageParts:n.collectBundlePackets)(i,t);r.byteLength+=o.byteLength,n.addDataPart(n.writeInt32(o.byteLength),r),r.parts=r.parts.concat(o.parts)}return r},n.writeBundle=function(e,t){if(!n.isValidBundle(e))throw new Error("An OSC bundle must contain 'timeTag' and 'packets' properties. Bundle was: "+JSON.stringify(e,null,2));t=t||n.defaults;var r=n.collectBundlePackets(e,t);return n.joinParts(r)},n.isValidBundle=function(e){return void 0!==e.timeTag&&void 0!==e.packets},n.readBundleContents=function(e,t,r,s){for(var i=n.readTimeTag(e,r),o=[];r.idx<s;){var a=n.readInt32(e,r),c=r.idx+a,u=n.readPacket(e,t,r,c);o.push(u)}return{timeTag:i,packets:o}},n.readPacket=function(e,t,r,s){var i=n.dataView(e,e.byteOffset,e.byteLength);s=void 0===s?i.byteLength:s,r=r||{idx:0};var o=n.readString(i,r),a=o[0];if("#"===a)return n.readBundleContents(i,t,r,s);if("/"===a)return n.readMessageContents(o,i,t,r);throw new Error("The header of an OSC packet didn't contain an OSC address or a #bundle string. Header was: "+o)},n.writePacket=function(e,t){if(n.isValidMessage(e))return n.writeMessage(e,t);if(n.isValidBundle(e))return n.writeBundle(e,t);throw new Error("The specified packet was not recognized as a valid OSC message or bundle. Packet was: "+JSON.stringify(e,null,2))},n.argumentTypes={i:{reader:"readInt32",writer:"writeInt32"},h:{reader:"readInt64",writer:"writeInt64"},f:{reader:"readFloat32",writer:"writeFloat32"},s:{reader:"readString",writer:"writeString"},S:{reader:"readString",writer:"writeString"},b:{reader:"readBlob",writer:"writeBlob"},t:{reader:"readTimeTag",writer:"writeTimeTag"},T:{reader:"readTrue"},F:{reader:"readFalse"},N:{reader:"readNull"},I:{reader:"readImpulse"},d:{reader:"readFloat64",writer:"writeFloat64"},c:{reader:"readChar32",writer:"writeChar32"},r:{reader:"readColor",writer:"writeColor"},m:{reader:"readMIDIBytes",writer:"writeMIDIBytes"}},n.inferTypeForArgument=function(e){switch(typeof e){case"boolean":return e?"T":"F";case"string":return"s";case"number":return"f";case"undefined":return"N";case"object":if(null===e)return"N";if(e instanceof Uint8Array||e instanceof ArrayBuffer)return"b";if("number"==typeof e.high&&"number"==typeof e.low)return"h"}throw new Error("Can't infer OSC argument type for value: "+JSON.stringify(e,null,2))},n.annotateArguments=function(e){for(var t=[],r=0;r<e.length;r++){var s,i=e[r];s="object"==typeof i&&i.type&&void 0!==i.value?i:n.isArray(i)?n.annotateArguments(i):{type:n.inferTypeForArgument(i),value:i},t.push(s)}return t},n.isCommonJS&&(e.exports=n)}()},7542:(e,t,r)=>{var n=n||r(7026);try{r(4987),r(2920)}catch(e){n.SerialPort=function(){throw new Error("The Node.js SerialPort library is not installed. osc.js' serial transport is unavailable.")}}},2920:(e,t,r)=>{var n=n||r(7026),s=r(4987).SerialPort;n.supportsSerial=!0,n.SerialPort=function(e){this.on("open",this.listen.bind(this)),n.SLIPPort.call(this,e),this.options.bitrate=this.options.bitrate||9600,this.serialPort=e.serialPort,this.serialPort&&this.emit("open",this.serialPort)};var i=n.SerialPort.prototype=Object.create(n.SLIPPort.prototype);i.constructor=n.SerialPort,i.open=function(){if(this.serialPort)return this.once("close",this.open.bind(this)),void this.close();var e=this;this.serialPort=new s({path:this.options.devicePath,baudRate:this.options.bitrate,autoOpen:!1}),this.serialPort.on("error",(function(t){e.emit("error",t)})),this.serialPort.on("open",(function(){e.emit("open",e.serialPort)})),this.serialPort.open()},i.listen=function(){var e=this;this.serialPort.on("data",(function(t){e.emit("data",t,void 0)})),this.serialPort.on("close",(function(){e.emit("close")})),e.emit("ready")},i.sendRaw=function(e){this.serialPort&&this.serialPort.isOpen?this.serialPort.write(e):n.fireClosedPortSendError(this)},i.close=function(){this.serialPort&&this.serialPort.close()}},9562:(e,t,r)=>{!function(){"use strict";var t,n,s=r(7194),i=r(9278),o=(r(7699),[r(7026),r(825),r(2627),r(7542)]),a=(t=(t={})||{},void 0===(n=o).forEach&&(n=[n]),n.forEach((function(e){for(var r in e)t[r]=e[r]})),t);a.UDPPort=function(e){a.Port.call(this,e),this.options.localAddress=this.options.localAddress||"127.0.0.1",this.options.localPort=void 0!==this.options.localPort?this.options.localPort:57121,this.options.remoteAddress=this.options.remoteAddress||"127.0.0.1",this.options.remotePort=void 0!==this.options.remotePort?this.options.remotePort:57121,this.on("open",this.listen.bind(this)),this.socket=e.socket,this.socket&&this.emit("open",this.socket)};var c=a.UDPPort.prototype=Object.create(a.Port.prototype);c.constructor=a.UDPPort,c.open=function(){var e=this;this.socket||(this.socket=s.createSocket("udp4"),this.socket.on("error",(function(t){e.emit("error",t)})),this.socket.bind(this.options.localPort,this.options.localAddress,(function(){a.UDPPort.setupMulticast(e),e.options.broadcast&&e.socket.setBroadcast(e.options.broadcast),e.emit("open",e.socket)})))},c.listen=function(){if(this.socket){var e=this;this.socket.on("message",(function(t,r){e.emit("data",t,r)})),this.socket.on("close",(function(){e.emit("close")})),e.emit("ready")}},c.sendRaw=function(e,t,r){if(this.socket){var n=void 0!==e.byteLength?e.byteLength:e.length,s=this;t=t||this.options.remoteAddress,r=void 0!==r?r:this.options.remotePort,this.socket.send(e,0,n,r,t,(function(e){e&&s.emit("error",e)}))}else a.fireClosedPortSendError(this)},c.close=function(){this.socket&&this.socket.close()},a.UDPPort.setupMulticast=function(e){void 0!==e.options.multicastTTL&&e.socket.setMulticastTTL(e.options.multicastTTL),e.options.multicastMembership&&("string"==typeof e.options.multicastMembership&&(e.options.multicastMembership=[e.options.multicastMembership]),e.options.multicastMembership.forEach((function(t){"string"==typeof t?e.socket.addMembership(t):e.socket.addMembership(t.address,t.interface)})))},a.TCPSocketPort=function(e){a.SLIPPort.call(this,e);var t=this.options;t.address=t.address||t.localAddress||"127.0.0.1",t.port=void 0!==t.port?t.port:void 0!==t.localPort?t.localPort:57121,this.on("open",this.listen.bind(this)),this.socket=e.socket,this.socket&&this.emit("open",this.socket)},(c=a.TCPSocketPort.prototype=Object.create(a.SLIPPort.prototype)).constructor=a.TCPSocketPort,c.open=function(e,t){var r=this.options;e=e||r.address,t=void 0!==t?t:r.port,this.socket?this.socket.connect(t,e):this.socket=i.connect({port:t,host:e}),this.emit("open",this.socket)},c.listen=function(){var e=this;this.socket.on("data",(function(t){e.emit("data",t,void 0)})),this.socket.on("error",(function(t){e.emit("error",t)})),this.socket.on("close",(function(t){e.emit("close",t)})),this.socket.on("connect",(function(){e.emit("ready")}))},c.sendRaw=function(e){if(this.socket){e=Buffer.from(e);try{this.socket.write(e)}catch(e){this.emit("error",e)}}},c.close=function(){this.socket.end()},e.exports=a}()},2627:(e,t,r)=>{var n=n||r(7026);!function(){"use strict";n.WebSocket="undefined"!=typeof WebSocket?WebSocket:r(7699),n.WebSocketPort=function(e){n.Port.call(this,e),this.on("open",this.listen.bind(this)),this.socket=e.socket,this.socket&&(1===this.socket.readyState?(n.WebSocketPort.setupSocketForBinary(this.socket),this.emit("open",this.socket)):this.open())};var e=n.WebSocketPort.prototype=Object.create(n.Port.prototype);e.constructor=n.WebSocketPort,e.open=function(){(!this.socket||this.socket.readyState>1)&&(this.socket=new n.WebSocket(this.options.url)),n.WebSocketPort.setupSocketForBinary(this.socket);var e=this;this.socket.onopen=function(){e.emit("open",e.socket)},this.socket.onerror=function(t){e.emit("error",t)}},e.listen=function(){var e=this;this.socket.onmessage=function(t){e.emit("data",t.data,t)},this.socket.onclose=function(t){e.emit("close",t)},e.emit("ready")},e.sendRaw=function(e){this.socket&&1===this.socket.readyState?this.socket.send(e):n.fireClosedPortSendError(this)},e.close=function(e,t){this.socket.close(e,t)},n.WebSocketPort.setupSocketForBinary=function(e){e.binaryType=n.isNode?"nodebuffer":"arraybuffer"}}()},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},3290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6368),s=r(6641),i=r(4774),o=()=>{},a=new s.TimeoutError;t.default=class extends n{constructor(e){var t,r,n,s;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=o,this._resolveIdle=o,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:i.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(s=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==s?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=o,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=o,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((r,n)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const i=void 0===this._timeout&&void 0===t.timeout?e():s.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&n(a)}));r(await i)}catch(e){n(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let n=0,s=e.length;for(;s>0;){const i=s/2|0;let o=n+i;r(e[o],t)<=0?(n=++o,s-=i+1):s=i}return n}},4774:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const s=n.default(this._queue,r,((e,t)=>t.priority-e.priority));this._queue.splice(s,0,r)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},6368:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,i||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,s=[];if(0===this._eventsCount)return s;for(n in e=this._events)t.call(e,n)&&s.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,i=n.length,o=new Array(i);s<i;s++)o[s]=n[s].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,s,i,o){var a=r?r+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,s),!0;case 5:return l.fn.call(l.context,t,n,s,i),!0;case 6:return l.fn.call(l.context,t,n,s,i,o),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,s);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,s){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||s&&!a.once||n&&a.context!==n||o(this,i);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||s&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[i]=1===u.length?u[0]:u:o(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},6641:(e,t,r)=>{"use strict";const n=r(4617);class s extends Error{constructor(e){super(e),this.name="TimeoutError"}}const i=(e,t,r)=>new Promise(((i,o)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void i(e);const a=setTimeout((()=>{if("function"==typeof r){try{i(r())}catch(e){o(e)}return}const n=r instanceof Error?r:new s("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),o(n)}),t);n(e.then(i,o),(()=>{clearTimeout(a)}))}));e.exports=i,e.exports.default=i,e.exports.TimeoutError=s},4987:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(9847),t),s(r(3662),t),s(r(447),t),s(r(6937),t),s(r(1693),t),s(r(8739),t),s(r(8145),t),s(r(637),t),s(r(3819),t),s(r(7102),t),s(r(8007),t),s(r(9076),t)},8007:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SerialPortMock=void 0;const n=r(5802),s=r(6848);class i extends n.SerialPortStream{static list=s.MockBinding.list;static binding=s.MockBinding;constructor(e,t){super({binding:s.MockBinding,...e},t)}}t.SerialPortMock=i},9076:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SerialPort=void 0;const n=r(5802),s=(0,r(176).autoDetect)();class i extends n.SerialPortStream{static list=s.list;static binding=s;constructor(e,t){super({binding:s,...e},t)}}t.SerialPort=i},8739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadlineParser=void 0;const n=r(447);class s extends n.DelimiterParser{constructor(e){const t={delimiter:Buffer.from("\n","utf8"),encoding:"utf8",...e};"string"==typeof t.delimiter&&(t.delimiter=Buffer.from(t.delimiter,t.encoding)),super(t)}}t.ReadlineParser=s},5170:function(e,t){!function(e,r){"use strict";e.slip=t,function(e){var t=e;t.END=192,t.ESC=219,t.ESC_END=220,t.ESC_ESC=221,t.byteArray=function(e,t,r){return e instanceof ArrayBuffer?new Uint8Array(e,t,r):e},t.expandByteArray=function(e){var t=new Uint8Array(2*e.length);return t.set(e),t},t.sliceByteArray=function(e,t,r){var n=e.buffer.slice?e.buffer.slice(t,r):e.subarray(t,r);return new Uint8Array(n)},t.encode=function(e,r){(r=r||{}).bufferPadding=r.bufferPadding||4;var n=(e=t.byteArray(e,r.offset,r.byteLength)).length+r.bufferPadding+3&-4,s=new Uint8Array(n),i=1;s[0]=t.END;for(var o=0;o<e.length;o++){i>s.length-3&&(s=t.expandByteArray(s));var a=e[o];a===t.END?(s[i++]=t.ESC,a=t.ESC_END):a===t.ESC&&(s[i++]=t.ESC,a=t.ESC_ESC),s[i++]=a}return s[i]=t.END,t.sliceByteArray(s,0,i+1)},t.Decoder=function(e){e="function"!=typeof e?e||{}:{onMessage:e},this.maxMessageSize=e.maxMessageSize||10485760,this.bufferSize=e.bufferSize||1024,this.msgBuffer=new Uint8Array(this.bufferSize),this.msgBufferIdx=0,this.onMessage=e.onMessage,this.onError=e.onError,this.escape=!1};var r=t.Decoder.prototype;r.decode=function(e){var r;e=t.byteArray(e);for(var n=0;n<e.length;n++){var s=e[n];if(this.escape)s===t.ESC_ESC?s=t.ESC:s===t.ESC_END&&(s=t.END);else{if(s===t.ESC){this.escape=!0;continue}if(s===t.END){r=this.handleEnd();continue}}this.addByte(s)||this.handleMessageMaxError()}return r},r.handleMessageMaxError=function(){this.onError&&this.onError(this.msgBuffer.subarray(0),"The message is too large; the maximum message size is "+this.maxMessageSize/1024+"KB. Use a larger maxMessageSize if necessary."),this.msgBufferIdx=0,this.escape=!1},r.addByte=function(e){return this.msgBufferIdx>this.msgBuffer.length-1&&(this.msgBuffer=t.expandByteArray(this.msgBuffer)),this.msgBuffer[this.msgBufferIdx++]=e,this.escape=!1,this.msgBuffer.length<this.maxMessageSize},r.handleEnd=function(){if(0!==this.msgBufferIdx){var e=t.sliceByteArray(this.msgBuffer,0,this.msgBufferIdx);return this.onMessage&&this.onMessage(e),this.msgBufferIdx=0,e}}}(t)}(this)},3476:(e,t,r)=>{r(2345).install()},2345:(e,t,r)=>{e=r.nmd(e);var n,s=r(9665).SourceMapConsumer,i=r(6928);try{(n=r(9896)).existsSync&&n.readFileSync||(n=null)}catch(e){}var o=r(2746);function a(e,t){return e.require(t)}var c=!1,u=!1,l=!1,d="auto",h={},p={},f=/^data:application\/json[^,]+base64,/,m=[],g=[];function y(){return"browser"===d||"node"!==d&&"undefined"!=typeof window&&"function"==typeof XMLHttpRequest&&!(window.require&&window.module&&window.process&&"renderer"===window.process.type)}function b(e){return function(t){for(var r=0;r<e.length;r++){var n=e[r](t);if(n)return n}return null}}var v=b(m);function w(e,t){if(!e)return t;var r=i.dirname(e),n=/^\w+:\/\/[^\/]*/.exec(r),s=n?n[0]:"",o=r.slice(s.length);return s&&/^\/\w\:/.test(o)?(s+="/")+i.resolve(r.slice(s.length),t).replace(/\\/g,"/"):s+i.resolve(r.slice(s.length),t)}m.push((function(e){if(e=e.trim(),/^file:/.test(e)&&(e=e.replace(/file:\/\/\/(\w:)?/,(function(e,t){return t?"":"/"}))),e in h)return h[e];var t="";try{if(n)n.existsSync(e)&&(t=n.readFileSync(e,"utf8"));else{var r=new XMLHttpRequest;r.open("GET",e,!1),r.send(null),4===r.readyState&&200===r.status&&(t=r.responseText)}}catch(e){}return h[e]=t}));var C=b(g);function _(e){var t=p[e.source];if(!t){var r=C(e.source);r?(t=p[e.source]={url:r.url,map:new s(r.map)}).map.sourcesContent&&t.map.sources.forEach((function(e,r){var n=t.map.sourcesContent[r];if(n){var s=w(t.url,e);h[s]=n}})):t=p[e.source]={url:null,map:null}}if(t&&t.map&&"function"==typeof t.map.originalPositionFor){var n=t.map.originalPositionFor(e);if(null!==n.source)return n.source=w(t.url,n.source),n}return e}function S(e){var t=/^eval at ([^(]+) \((.+):(\d+):(\d+)\)$/.exec(e);if(t){var r=_({source:t[2],line:+t[3],column:t[4]-1});return"eval at "+t[1]+" ("+r.source+":"+r.line+":"+(r.column+1)+")"}return(t=/^eval at ([^(]+) \((.+)\)$/.exec(e))?"eval at "+t[1]+" ("+S(t[2])+")":e}function E(){var e,t="";if(this.isNative())t="native";else{!(e=this.getScriptNameOrSourceURL())&&this.isEval()&&(t=this.getEvalOrigin(),t+=", "),t+=e||"<anonymous>";var r=this.getLineNumber();if(null!=r){t+=":"+r;var n=this.getColumnNumber();n&&(t+=":"+n)}}var s="",i=this.getFunctionName(),o=!0,a=this.isConstructor();if(this.isToplevel()||a)a?s+="new "+(i||"<anonymous>"):i?s+=i:(s+=t,o=!1);else{var c=this.getTypeName();"[object Object]"===c&&(c="null");var u=this.getMethodName();i?(c&&0!=i.indexOf(c)&&(s+=c+"."),s+=i,u&&i.indexOf("."+u)!=i.length-u.length-1&&(s+=" [as "+u+"]")):s+=c+"."+(u||"<anonymous>")}return o&&(s+=" ("+t+")"),s}function A(e){var t={};return Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(r){t[r]=/^(?:is|get)/.test(r)?function(){return e[r].call(e)}:e[r]})),t.toString=E,t}function I(e,t){if(void 0===t&&(t={nextPosition:null,curPosition:null}),e.isNative())return t.curPosition=null,e;var r=e.getFileName()||e.getScriptNameOrSourceURL();if(r){var n=e.getLineNumber(),s=e.getColumnNumber()-1,i=/^v(10\.1[6-9]|10\.[2-9][0-9]|10\.[0-9]{3,}|1[2-9]\d*|[2-9]\d|\d{3,}|11\.11)/.test("object"==typeof process&&null!==process?process.version:"")?0:62;1===n&&s>i&&!y()&&!e.isEval()&&(s-=i);var o=_({source:r,line:n,column:s});t.curPosition=o;var a=(e=A(e)).getFunctionName;return e.getFunctionName=function(){return null==t.nextPosition?a():t.nextPosition.name||a()},e.getFileName=function(){return o.source},e.getLineNumber=function(){return o.line},e.getColumnNumber=function(){return o.column+1},e.getScriptNameOrSourceURL=function(){return o.source},e}var c=e.isEval()&&e.getEvalOrigin();return c?(c=S(c),(e=A(e)).getEvalOrigin=function(){return c},e):e}function k(e,t){l&&(h={},p={});for(var r=(e.name||"Error")+": "+(e.message||""),n={nextPosition:null,curPosition:null},s=[],i=t.length-1;i>=0;i--)s.push("\n    at "+I(t[i],n)),n.nextPosition=n.curPosition;return n.curPosition=n.nextPosition=null,r+s.reverse().join("")}function O(e){var t=/\n    at [^(]+ \((.*):(\d+):(\d+)\)/.exec(e.stack);if(t){var r=t[1],s=+t[2],i=+t[3],o=h[r];if(!o&&n&&n.existsSync(r))try{o=n.readFileSync(r,"utf8")}catch(e){o=""}if(o){var a=o.split(/(?:\r\n|\r|\n)/)[s-1];if(a)return r+":"+s+"\n"+a+"\n"+new Array(i).join(" ")+"^"}}return null}g.push((function(e){var t,r=function(e){var t;if(y())try{var r=new XMLHttpRequest;r.open("GET",e,!1),r.send(null),t=4===r.readyState?r.responseText:null;var n=r.getResponseHeader("SourceMap")||r.getResponseHeader("X-SourceMap");if(n)return n}catch(e){}t=v(e);for(var s,i,o=/(?:\/\/[@#][\s]*sourceMappingURL=([^\s'"]+)[\s]*$)|(?:\/\*[@#][\s]*sourceMappingURL=([^\s*'"]+)[\s]*(?:\*\/)[\s]*$)/gm;i=o.exec(t);)s=i;return s?s[1]:null}(e);if(!r)return null;if(f.test(r)){var n=r.slice(r.indexOf(",")+1);t=o(n,"base64").toString(),r=e}else r=w(e,r),t=v(r);return t?{url:r,map:t}:null}));var P=m.slice(0),T=g.slice(0);t.wrapCallSite=I,t.getErrorSource=O,t.mapSourcePosition=_,t.retrieveSourceMap=C,t.install=function(t){if((t=t||{}).environment&&(d=t.environment,-1===["node","browser","auto"].indexOf(d)))throw new Error("environment "+d+" was unknown. Available options are {auto, browser, node}");if(t.retrieveFile&&(t.overrideRetrieveFile&&(m.length=0),m.unshift(t.retrieveFile)),t.retrieveSourceMap&&(t.overrideRetrieveSourceMap&&(g.length=0),g.unshift(t.retrieveSourceMap)),t.hookRequire&&!y()){var r=a(e,"module"),n=r.prototype._compile;n.__sourceMapSupport||(r.prototype._compile=function(e,t){return h[t]=e,p[t]=void 0,n.call(this,e,t)},r.prototype._compile.__sourceMapSupport=!0)}if(l||(l="emptyCacheBetweenOperations"in t&&t.emptyCacheBetweenOperations),c||(c=!0,Error.prepareStackTrace=k),!u){var s=!("handleUncaughtExceptions"in t)||t.handleUncaughtExceptions;try{!1===a(e,"worker_threads").isMainThread&&(s=!1)}catch(e){}s&&"object"==typeof process&&null!==process&&"function"==typeof process.on&&(u=!0,i=process.emit,process.emit=function(e){if("uncaughtException"===e){var t=arguments[1]&&arguments[1].stack,r=this.listeners(e).length>0;if(t&&!r)return s=O(n=arguments[1]),(o=function(){if("object"==typeof process&&null!==process)return process.stderr}())&&o._handle&&o._handle.setBlocking&&o._handle.setBlocking(!0),s&&(console.error(),console.error(s)),console.error(n.stack),void("object"==typeof process&&null!==process&&"function"==typeof process.exit&&process.exit(1))}var n,s,o;return i.apply(this,arguments)})}var i},t.resetRetrieveHandlers=function(){m.length=0,g.length=0,m=P.slice(0),g=T.slice(0),C=b(g),v=b(m)}},735:(e,t,r)=>{var n=r(251),s=Object.prototype.hasOwnProperty,i="undefined"!=typeof Map;function o(){this._array=[],this._set=i?new Map:Object.create(null)}o.fromArray=function(e,t){for(var r=new o,n=0,s=e.length;n<s;n++)r.add(e[n],t);return r},o.prototype.size=function(){return i?this._set.size:Object.getOwnPropertyNames(this._set).length},o.prototype.add=function(e,t){var r=i?e:n.toSetString(e),o=i?this.has(e):s.call(this._set,r),a=this._array.length;o&&!t||this._array.push(e),o||(i?this._set.set(e,a):this._set[r]=a)},o.prototype.has=function(e){if(i)return this._set.has(e);var t=n.toSetString(e);return s.call(this._set,t)},o.prototype.indexOf=function(e){if(i){var t=this._set.get(e);if(t>=0)return t}else{var r=n.toSetString(e);if(s.call(this._set,r))return this._set[r]}throw new Error('"'+e+'" is not in the set.')},o.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},o.prototype.toArray=function(){return this._array.slice()},t.C=o},7092:(e,t,r)=>{var n=r(2364);t.encode=function(e){var t,r="",s=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&s,(s>>>=5)>0&&(t|=32),r+=n.encode(t)}while(s>0);return r},t.decode=function(e,t,r){var s,i,o,a,c=e.length,u=0,l=0;do{if(t>=c)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(i=n.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));s=!!(32&i),u+=(i&=31)<<l,l+=5}while(s);r.value=(a=(o=u)>>1,1&~o?a:-a),r.rest=t}},2364:(e,t)=>{var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<r.length)return r[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},1163:(e,t)=>{function r(e,n,s,i,o,a){var c=Math.floor((n-e)/2)+e,u=o(s,i[c],!0);return 0===u?c:u>0?n-c>1?r(c,n,s,i,o,a):a==t.LEAST_UPPER_BOUND?n<i.length?n:-1:c:c-e>1?r(e,c,s,i,o,a):a==t.LEAST_UPPER_BOUND?c:e<0?-1:e}t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,n,s,i){if(0===n.length)return-1;var o=r(-1,n.length,e,n,s,i||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&0===s(n[o],n[o-1],!0);)--o;return o}},3302:(e,t,r)=>{var n=r(251);function s(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}s.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},s.prototype.add=function(e){var t,r,s,i,o,a;r=e,s=(t=this._last).generatedLine,i=r.generatedLine,o=t.generatedColumn,a=r.generatedColumn,i>s||i==s&&a>=o||n.compareByGeneratedPositionsInflated(t,r)<=0?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},s.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.P=s},3801:(e,t)=>{function r(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function n(e,t,s,i){if(s<i){var o=s-1;r(e,(l=s,d=i,Math.round(l+Math.random()*(d-l))),i);for(var a=e[i],c=s;c<i;c++)t(e[c],a)<=0&&r(e,o+=1,c);r(e,o+1,c);var u=o+1;n(e,t,s,u-1),n(e,t,u+1,i)}var l,d}t.g=function(e,t){n(e,t,0,e.length-1)}},7446:(e,t,r)=>{var n=r(251),s=r(1163),i=r(735).C,o=r(7092),a=r(3801).g;function c(e,t){var r=e;return"string"==typeof e&&(r=n.parseSourceMapInput(e)),null!=r.sections?new d(r,t):new u(r,t)}function u(e,t){var r=e;"string"==typeof e&&(r=n.parseSourceMapInput(e));var s=n.getArg(r,"version"),o=n.getArg(r,"sources"),a=n.getArg(r,"names",[]),c=n.getArg(r,"sourceRoot",null),u=n.getArg(r,"sourcesContent",null),l=n.getArg(r,"mappings"),d=n.getArg(r,"file",null);if(s!=this._version)throw new Error("Unsupported version: "+s);c&&(c=n.normalize(c)),o=o.map(String).map(n.normalize).map((function(e){return c&&n.isAbsolute(c)&&n.isAbsolute(e)?n.relative(c,e):e})),this._names=i.fromArray(a.map(String),!0),this._sources=i.fromArray(o,!0),this._absoluteSources=this._sources.toArray().map((function(e){return n.computeSourceURL(c,e,t)})),this.sourceRoot=c,this.sourcesContent=u,this._mappings=l,this._sourceMapURL=t,this.file=d}function l(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function d(e,t){var r=e;"string"==typeof e&&(r=n.parseSourceMapInput(e));var s=n.getArg(r,"version"),o=n.getArg(r,"sections");if(s!=this._version)throw new Error("Unsupported version: "+s);this._sources=new i,this._names=new i;var a={line:-1,column:0};this._sections=o.map((function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var r=n.getArg(e,"offset"),s=n.getArg(r,"line"),i=n.getArg(r,"column");if(s<a.line||s===a.line&&i<a.column)throw new Error("Section offsets must be ordered and non-overlapping.");return a=r,{generatedOffset:{generatedLine:s+1,generatedColumn:i+1},consumer:new c(n.getArg(e,"map"),t)}}))}c.fromSourceMap=function(e,t){return u.fromSourceMap(e,t)},c.prototype._version=3,c.prototype.__generatedMappings=null,Object.defineProperty(c.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),c.prototype.__originalMappings=null,Object.defineProperty(c.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),c.prototype._charIsMappingSeparator=function(e,t){var r=e.charAt(t);return";"===r||","===r},c.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},c.GENERATED_ORDER=1,c.ORIGINAL_ORDER=2,c.GREATEST_LOWER_BOUND=1,c.LEAST_UPPER_BOUND=2,c.prototype.eachMapping=function(e,t,r){var s,i=t||null;switch(r||c.GENERATED_ORDER){case c.GENERATED_ORDER:s=this._generatedMappings;break;case c.ORIGINAL_ORDER:s=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var o=this.sourceRoot;s.map((function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=n.computeSourceURL(o,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,i)},c.prototype.allGeneratedPositionsFor=function(e){var t=n.getArg(e,"line"),r={source:n.getArg(e,"source"),originalLine:t,originalColumn:n.getArg(e,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];var i=[],o=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,s.LEAST_UPPER_BOUND);if(o>=0){var a=this._originalMappings[o];if(void 0===e.column)for(var c=a.originalLine;a&&a.originalLine===c;)i.push({line:n.getArg(a,"generatedLine",null),column:n.getArg(a,"generatedColumn",null),lastColumn:n.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++o];else for(var u=a.originalColumn;a&&a.originalLine===t&&a.originalColumn==u;)i.push({line:n.getArg(a,"generatedLine",null),column:n.getArg(a,"generatedColumn",null),lastColumn:n.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++o]}return i},t.SourceMapConsumer=c,u.prototype=Object.create(c.prototype),u.prototype.consumer=c,u.prototype._findSourceIndex=function(e){var t,r=e;if(null!=this.sourceRoot&&(r=n.relative(this.sourceRoot,r)),this._sources.has(r))return this._sources.indexOf(r);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},u.fromSourceMap=function(e,t){var r=Object.create(u.prototype),s=r._names=i.fromArray(e._names.toArray(),!0),o=r._sources=i.fromArray(e._sources.toArray(),!0);r.sourceRoot=e._sourceRoot,r.sourcesContent=e._generateSourcesContent(r._sources.toArray(),r.sourceRoot),r.file=e._file,r._sourceMapURL=t,r._absoluteSources=r._sources.toArray().map((function(e){return n.computeSourceURL(r.sourceRoot,e,t)}));for(var c=e._mappings.toArray().slice(),d=r.__generatedMappings=[],h=r.__originalMappings=[],p=0,f=c.length;p<f;p++){var m=c[p],g=new l;g.generatedLine=m.generatedLine,g.generatedColumn=m.generatedColumn,m.source&&(g.source=o.indexOf(m.source),g.originalLine=m.originalLine,g.originalColumn=m.originalColumn,m.name&&(g.name=s.indexOf(m.name)),h.push(g)),d.push(g)}return a(r.__originalMappings,n.compareByOriginalPositions),r},u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),u.prototype._parseMappings=function(e,t){for(var r,s,i,c,u,d=1,h=0,p=0,f=0,m=0,g=0,y=e.length,b=0,v={},w={},C=[],_=[];b<y;)if(";"===e.charAt(b))d++,b++,h=0;else if(","===e.charAt(b))b++;else{for((r=new l).generatedLine=d,c=b;c<y&&!this._charIsMappingSeparator(e,c);c++);if(i=v[s=e.slice(b,c)])b+=s.length;else{for(i=[];b<c;)o.decode(e,b,w),u=w.value,b=w.rest,i.push(u);if(2===i.length)throw new Error("Found a source, but no line and column");if(3===i.length)throw new Error("Found a source and line, but no column");v[s]=i}r.generatedColumn=h+i[0],h=r.generatedColumn,i.length>1&&(r.source=m+i[1],m+=i[1],r.originalLine=p+i[2],p=r.originalLine,r.originalLine+=1,r.originalColumn=f+i[3],f=r.originalColumn,i.length>4&&(r.name=g+i[4],g+=i[4])),_.push(r),"number"==typeof r.originalLine&&C.push(r)}a(_,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=_,a(C,n.compareByOriginalPositions),this.__originalMappings=C},u.prototype._findMapping=function(e,t,r,n,i,o){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[n]);return s.search(e,t,i,o)},u.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(t.generatedLine===r.generatedLine){t.lastGeneratedColumn=r.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},u.prototype.originalPositionFor=function(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")},r=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(r>=0){var s=this._generatedMappings[r];if(s.generatedLine===t.generatedLine){var i=n.getArg(s,"source",null);null!==i&&(i=this._sources.at(i),i=n.computeSourceURL(this.sourceRoot,i,this._sourceMapURL));var o=n.getArg(s,"name",null);return null!==o&&(o=this._names.at(o)),{source:i,line:n.getArg(s,"originalLine",null),column:n.getArg(s,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}},u.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e}))},u.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var r=this._findSourceIndex(e);if(r>=0)return this.sourcesContent[r];var s,i=e;if(null!=this.sourceRoot&&(i=n.relative(this.sourceRoot,i)),null!=this.sourceRoot&&(s=n.urlParse(this.sourceRoot))){var o=i.replace(/^file:\/\//,"");if("file"==s.scheme&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!s.path||"/"==s.path)&&this._sources.has("/"+i))return this.sourcesContent[this._sources.indexOf("/"+i)]}if(t)return null;throw new Error('"'+i+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(e){var t=n.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var r={source:t,originalLine:n.getArg(e,"line"),originalColumn:n.getArg(e,"column")},s=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(s>=0){var i=this._originalMappings[s];if(i.source===r.source)return{line:n.getArg(i,"generatedLine",null),column:n.getArg(i,"generatedColumn",null),lastColumn:n.getArg(i,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},d.prototype=Object.create(c.prototype),d.prototype.constructor=c,d.prototype._version=3,Object.defineProperty(d.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}}),d.prototype.originalPositionFor=function(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")},r=s.search(t,this._sections,(function(e,t){return e.generatedLine-t.generatedOffset.generatedLine||e.generatedColumn-t.generatedOffset.generatedColumn})),i=this._sections[r];return i?i.consumer.originalPositionFor({line:t.generatedLine-(i.generatedOffset.generatedLine-1),column:t.generatedColumn-(i.generatedOffset.generatedLine===t.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},d.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))},d.prototype.sourceContentFor=function(e,t){for(var r=0;r<this._sections.length;r++){var n=this._sections[r].consumer.sourceContentFor(e,!0);if(n)return n}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},d.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var r=this._sections[t];if(-1!==r.consumer._findSourceIndex(n.getArg(e,"source"))){var s=r.consumer.generatedPositionFor(e);if(s)return{line:s.line+(r.generatedOffset.generatedLine-1),column:s.column+(r.generatedOffset.generatedLine===s.line?r.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},d.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var r=0;r<this._sections.length;r++)for(var s=this._sections[r],i=s.consumer._generatedMappings,o=0;o<i.length;o++){var c=i[o],u=s.consumer._sources.at(c.source);u=n.computeSourceURL(s.consumer.sourceRoot,u,this._sourceMapURL),this._sources.add(u),u=this._sources.indexOf(u);var l=null;c.name&&(l=s.consumer._names.at(c.name),this._names.add(l),l=this._names.indexOf(l));var d={source:u,generatedLine:c.generatedLine+(s.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(s.generatedOffset.generatedLine===c.generatedLine?s.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:l};this.__generatedMappings.push(d),"number"==typeof d.originalLine&&this.__originalMappings.push(d)}a(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),a(this.__originalMappings,n.compareByOriginalPositions)}},4041:(e,t,r)=>{var n=r(7092),s=r(251),i=r(735).C,o=r(3302).P;function a(e){e||(e={}),this._file=s.getArg(e,"file",null),this._sourceRoot=s.getArg(e,"sourceRoot",null),this._skipValidation=s.getArg(e,"skipValidation",!1),this._sources=new i,this._names=new i,this._mappings=new o,this._sourcesContents=null}a.prototype._version=3,a.fromSourceMap=function(e){var t=e.sourceRoot,r=new a({file:e.file,sourceRoot:t});return e.eachMapping((function(e){var n={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(n.source=e.source,null!=t&&(n.source=s.relative(t,n.source)),n.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(n.name=e.name)),r.addMapping(n)})),e.sources.forEach((function(n){var i=n;null!==t&&(i=s.relative(t,n)),r._sources.has(i)||r._sources.add(i);var o=e.sourceContentFor(n);null!=o&&r.setSourceContent(n,o)})),r},a.prototype.addMapping=function(e){var t=s.getArg(e,"generated"),r=s.getArg(e,"original",null),n=s.getArg(e,"source",null),i=s.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,r,n,i),null!=n&&(n=String(n),this._sources.has(n)||this._sources.add(n)),null!=i&&(i=String(i),this._names.has(i)||this._names.add(i)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=r&&r.line,originalColumn:null!=r&&r.column,source:n,name:i})},a.prototype.setSourceContent=function(e,t){var r=e;null!=this._sourceRoot&&(r=s.relative(this._sourceRoot,r)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[s.toSetString(r)]=t):this._sourcesContents&&(delete this._sourcesContents[s.toSetString(r)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},a.prototype.applySourceMap=function(e,t,r){var n=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');n=e.file}var o=this._sourceRoot;null!=o&&(n=s.relative(o,n));var a=new i,c=new i;this._mappings.unsortedForEach((function(t){if(t.source===n&&null!=t.originalLine){var i=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=i.source&&(t.source=i.source,null!=r&&(t.source=s.join(r,t.source)),null!=o&&(t.source=s.relative(o,t.source)),t.originalLine=i.line,t.originalColumn=i.column,null!=i.name&&(t.name=i.name))}var u=t.source;null==u||a.has(u)||a.add(u);var l=t.name;null==l||c.has(l)||c.add(l)}),this),this._sources=a,this._names=c,e.sources.forEach((function(t){var n=e.sourceContentFor(t);null!=n&&(null!=r&&(t=s.join(r,t)),null!=o&&(t=s.relative(o,t)),this.setSourceContent(t,n))}),this)},a.prototype._validateMapping=function(e,t,r,n){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||r||n)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:n}))},a.prototype._serializeMappings=function(){for(var e,t,r,i,o=0,a=1,c=0,u=0,l=0,d=0,h="",p=this._mappings.toArray(),f=0,m=p.length;f<m;f++){if(e="",(t=p[f]).generatedLine!==a)for(o=0;t.generatedLine!==a;)e+=";",a++;else if(f>0){if(!s.compareByGeneratedPositionsInflated(t,p[f-1]))continue;e+=","}e+=n.encode(t.generatedColumn-o),o=t.generatedColumn,null!=t.source&&(i=this._sources.indexOf(t.source),e+=n.encode(i-d),d=i,e+=n.encode(t.originalLine-1-u),u=t.originalLine-1,e+=n.encode(t.originalColumn-c),c=t.originalColumn,null!=t.name&&(r=this._names.indexOf(t.name),e+=n.encode(r-l),l=r)),h+=e}return h},a.prototype._generateSourcesContent=function(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=s.relative(t,e));var r=s.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null}),this)},a.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},a.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.x=a},1683:(e,t,r)=>{var n=r(4041).x,s=r(251),i=/(\r?\n)/,o="$$$isSourceNode$$$";function a(e,t,r,n,s){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==s?null:s,this[o]=!0,null!=n&&this.add(n)}a.fromStringWithSourceMap=function(e,t,r){var n=new a,o=e.split(i),c=0,u=function(){return e()+(e()||"");function e(){return c<o.length?o[c++]:void 0}},l=1,d=0,h=null;return t.eachMapping((function(e){if(null!==h){if(!(l<e.generatedLine)){var t=(r=o[c]||"").substr(0,e.generatedColumn-d);return o[c]=r.substr(e.generatedColumn-d),d=e.generatedColumn,p(h,t),void(h=e)}p(h,u()),l++,d=0}for(;l<e.generatedLine;)n.add(u()),l++;if(d<e.generatedColumn){var r=o[c]||"";n.add(r.substr(0,e.generatedColumn)),o[c]=r.substr(e.generatedColumn),d=e.generatedColumn}h=e}),this),c<o.length&&(h&&p(h,u()),n.add(o.splice(c).join(""))),t.sources.forEach((function(e){var i=t.sourceContentFor(e);null!=i&&(null!=r&&(e=s.join(r,e)),n.setSourceContent(e,i))})),n;function p(e,t){if(null===e||void 0===e.source)n.add(t);else{var i=r?s.join(r,e.source):e.source;n.add(new a(e.originalLine,e.originalColumn,i,t,e.name))}}},a.prototype.add=function(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},a.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},a.prototype.walk=function(e){for(var t,r=0,n=this.children.length;r<n;r++)(t=this.children[r])[o]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},a.prototype.join=function(e){var t,r,n=this.children.length;if(n>0){for(t=[],r=0;r<n-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this},a.prototype.replaceRight=function(e,t){var r=this.children[this.children.length-1];return r[o]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this},a.prototype.setSourceContent=function(e,t){this.sourceContents[s.toSetString(e)]=t},a.prototype.walkSourceContents=function(e){for(var t=0,r=this.children.length;t<r;t++)this.children[t][o]&&this.children[t].walkSourceContents(e);var n=Object.keys(this.sourceContents);for(t=0,r=n.length;t<r;t++)e(s.fromSetString(n[t]),this.sourceContents[n[t]])},a.prototype.toString=function(){var e="";return this.walk((function(t){e+=t})),e},a.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},r=new n(e),s=!1,i=null,o=null,a=null,c=null;return this.walk((function(e,n){t.code+=e,null!==n.source&&null!==n.line&&null!==n.column?(i===n.source&&o===n.line&&a===n.column&&c===n.name||r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name}),i=n.source,o=n.line,a=n.column,c=n.name,s=!0):s&&(r.addMapping({generated:{line:t.line,column:t.column}}),i=null,s=!1);for(var u=0,l=e.length;u<l;u++)10===e.charCodeAt(u)?(t.line++,t.column=0,u+1===l?(i=null,s=!1):s&&r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name})):t.column++})),this.walkSourceContents((function(e,t){r.setSourceContent(e,t)})),{code:t.code,map:r}}},251:(e,t)=>{t.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,n=/^data:.+\,.+$/;function s(e){var t=e.match(r);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function i(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function o(e){var r=e,n=s(e);if(n){if(!n.path)return e;r=n.path}for(var o,a=t.isAbsolute(r),c=r.split(/\/+/),u=0,l=c.length-1;l>=0;l--)"."===(o=c[l])?c.splice(l,1):".."===o?u++:u>0&&(""===o?(c.splice(l+1,u),u=0):(c.splice(l,2),u--));return""===(r=c.join("/"))&&(r=a?"/":"."),n?(n.path=r,i(n)):r}function a(e,t){""===e&&(e="."),""===t&&(t=".");var r=s(t),a=s(e);if(a&&(e=a.path||"/"),r&&!r.scheme)return a&&(r.scheme=a.scheme),i(r);if(r||t.match(n))return t;if(a&&!a.host&&!a.path)return a.host=t,i(a);var c="/"===t.charAt(0)?t:o(e.replace(/\/+$/,"")+"/"+t);return a?(a.path=c,i(a)):c}t.urlParse=s,t.urlGenerate=i,t.normalize=o,t.join=a,t.isAbsolute=function(e){return"/"===e.charAt(0)||r.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var r=0;0!==t.indexOf(e+"/");){var n=e.lastIndexOf("/");if(n<0)return t;if((e=e.slice(0,n)).match(/^([^\/]+:\/)?\/*$/))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)};var c=!("__proto__"in Object.create(null));function u(e){return e}function l(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function d(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=c?u:function(e){return l(e)?"$"+e:e},t.fromSetString=c?u:function(e){return l(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,r){var n=d(e.source,t.source);return 0!==n||0!=(n=e.originalLine-t.originalLine)||0!=(n=e.originalColumn-t.originalColumn)||r||0!=(n=e.generatedColumn-t.generatedColumn)||0!=(n=e.generatedLine-t.generatedLine)?n:d(e.name,t.name)},t.compareByGeneratedPositionsDeflated=function(e,t,r){var n=e.generatedLine-t.generatedLine;return 0!==n||0!=(n=e.generatedColumn-t.generatedColumn)||r||0!==(n=d(e.source,t.source))||0!=(n=e.originalLine-t.originalLine)||0!=(n=e.originalColumn-t.originalColumn)?n:d(e.name,t.name)},t.compareByGeneratedPositionsInflated=function(e,t){var r=e.generatedLine-t.generatedLine;return 0!==r||0!=(r=e.generatedColumn-t.generatedColumn)||0!==(r=d(e.source,t.source))||0!=(r=e.originalLine-t.originalLine)||0!=(r=e.originalColumn-t.originalColumn)?r:d(e.name,t.name)},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,r){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),r){var n=s(r);if(!n)throw new Error("sourceMapURL could not be parsed");if(n.path){var c=n.path.lastIndexOf("/");c>=0&&(n.path=n.path.substring(0,c+1))}t=a(i(n),t)}return o(t)}},9665:(e,t,r)=>{r(4041).x,t.SourceMapConsumer=r(7446).SourceMapConsumer,r(1683)},7687:(e,t,r)=>{"use strict";const n=r(857),s=r(9637),i=r(5884),{env:o}=process;let a;function c(e,t={}){return 0!==(r=function(e,{streamIsTTY:t,sniffFlags:r=!0}={}){const s=function(){if("FORCE_COLOR"in o)return"true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(Number.parseInt(o.FORCE_COLOR,10),3)}();void 0!==s&&(a=s);const c=r?a:s;if(0===c)return 0;if(r){if(i("color=16m")||i("color=full")||i("color=truecolor"))return 3;if(i("color=256"))return 2}if(e&&!t&&void 0===c)return 0;const u=c||0;if("dumb"===o.TERM)return u;if("win32"===process.platform){const e=n.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some((e=>e in o))||"codeship"===o.CI_NAME?1:u;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=Number.parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:u}(e,{streamIsTTY:e&&e.isTTY,...t}))&&{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3};var r}i("no-color")||i("no-colors")||i("color=false")||i("color=never")?a=0:(i("color")||i("colors")||i("color=true")||i("color=always"))&&(a=1),e.exports={supportsColor:c,stdout:c({isTTY:s.isatty(1)}),stderr:c({isTTY:s.isatty(2)})}},7699:(e,t,r)=>{"use strict";const n=r(1060);n.createWebSocketStream=r(3719),n.Server=r(1722),n.Receiver=r(6286),n.Sender=r(914),n.WebSocket=n,n.WebSocketServer=n.Server,e.exports=n},3338:(e,t,r)=>{"use strict";const{EMPTY_BUFFER:n}=r(2614),s=Buffer[Symbol.species];function i(e,t,r,n,s){for(let i=0;i<s;i++)r[n+i]=e[i]^t[3&i]}function o(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}if(e.exports={concat:function(e,t){if(0===e.length)return n;if(1===e.length)return e[0];const r=Buffer.allocUnsafe(t);let i=0;for(let t=0;t<e.length;t++){const n=e[t];r.set(n,i),i+=n.length}return i<t?new s(r.buffer,r.byteOffset,i):r},mask:i,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let r;return t instanceof ArrayBuffer?r=new s(t):ArrayBuffer.isView(t)?r=new s(t.buffer,t.byteOffset,t.byteLength):(r=Buffer.from(t),e.readOnly=!1),r},unmask:o},!process.env.WS_NO_BUFFER_UTIL)try{const t=r(Object(function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()));e.exports.mask=function(e,r,n,s,o){o<48?i(e,r,n,s,o):t.mask(e,r,n,s,o)},e.exports.unmask=function(e,r){e.length<32?o(e,r):t.unmask(e,r)}}catch(e){}},2614:e=>{"use strict";const t=["nodebuffer","arraybuffer","fragments"],r="undefined"!=typeof Blob;r&&t.push("blob"),e.exports={BINARY_TYPES:t,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:r,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},597:(e,t,r)=>{"use strict";const{kForOnEventAttribute:n,kListener:s}=r(2614),i=Symbol("kCode"),o=Symbol("kData"),a=Symbol("kError"),c=Symbol("kMessage"),u=Symbol("kReason"),l=Symbol("kTarget"),d=Symbol("kType"),h=Symbol("kWasClean");class p{constructor(e){this[l]=null,this[d]=e}get target(){return this[l]}get type(){return this[d]}}Object.defineProperty(p.prototype,"target",{enumerable:!0}),Object.defineProperty(p.prototype,"type",{enumerable:!0});class f extends p{constructor(e,t={}){super(e),this[i]=void 0===t.code?0:t.code,this[u]=void 0===t.reason?"":t.reason,this[h]=void 0!==t.wasClean&&t.wasClean}get code(){return this[i]}get reason(){return this[u]}get wasClean(){return this[h]}}Object.defineProperty(f.prototype,"code",{enumerable:!0}),Object.defineProperty(f.prototype,"reason",{enumerable:!0}),Object.defineProperty(f.prototype,"wasClean",{enumerable:!0});class m extends p{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[c]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[c]}}Object.defineProperty(m.prototype,"error",{enumerable:!0}),Object.defineProperty(m.prototype,"message",{enumerable:!0});class g extends p{constructor(e,t={}){super(e),this[o]=void 0===t.data?null:t.data}get data(){return this[o]}}Object.defineProperty(g.prototype,"data",{enumerable:!0});const y={addEventListener(e,t,r={}){for(const i of this.listeners(e))if(!r[n]&&i[s]===t&&!i[n])return;let i;if("message"===e)i=function(e,r){const n=new g("message",{data:r?e:e.toString()});n[l]=this,b(t,this,n)};else if("close"===e)i=function(e,r){const n=new f("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});n[l]=this,b(t,this,n)};else if("error"===e)i=function(e){const r=new m("error",{error:e,message:e.message});r[l]=this,b(t,this,r)};else{if("open"!==e)return;i=function(){const e=new p("open");e[l]=this,b(t,this,e)}}i[n]=!!r[n],i[s]=t,r.once?this.once(e,i):this.on(e,i)},removeEventListener(e,t){for(const r of this.listeners(e))if(r[s]===t&&!r[n]){this.removeListener(e,r);break}}};function b(e,t,r){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}e.exports={CloseEvent:f,ErrorEvent:m,Event:p,EventTarget:y,MessageEvent:g}},5926:(e,t,r)=>{"use strict";const{tokenChars:n}=r(5880);function s(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}e.exports={format:function(e){return Object.keys(e).map((t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map((e=>[t].concat(Object.keys(e).map((t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let r,i,o=Object.create(null),a=!1,c=!1,u=!1,l=-1,d=-1,h=-1,p=0;for(;p<e.length;p++)if(d=e.charCodeAt(p),void 0===r)if(-1===h&&1===n[d])-1===l&&(l=p);else if(0===p||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${p}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);const n=e.slice(l,h);44===d?(s(t,n,o),o=Object.create(null)):r=n,l=h=-1}}else-1===h&&-1!==l&&(h=p);else if(void 0===i)if(-1===h&&1===n[d])-1===l&&(l=p);else if(32===d||9===d)-1===h&&-1!==l&&(h=p);else if(59===d||44===d){if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p),s(o,e.slice(l,h),!0),44===d&&(s(t,r,o),o=Object.create(null),r=void 0),l=h=-1}else{if(61!==d||-1===l||-1!==h)throw new SyntaxError(`Unexpected character at index ${p}`);i=e.slice(l,p),l=h=-1}else if(c){if(1!==n[d])throw new SyntaxError(`Unexpected character at index ${p}`);-1===l?l=p:a||(a=!0),c=!1}else if(u)if(1===n[d])-1===l&&(l=p);else if(34===d&&-1!==l)u=!1,h=p;else{if(92!==d)throw new SyntaxError(`Unexpected character at index ${p}`);c=!0}else if(34===d&&61===e.charCodeAt(p-1))u=!0;else if(-1===h&&1===n[d])-1===l&&(l=p);else if(-1===l||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${p}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);let n=e.slice(l,h);a&&(n=n.replace(/\\/g,""),a=!1),s(o,i,n),44===d&&(s(t,r,o),o=Object.create(null),r=void 0),i=void 0,l=h=-1}}else-1===h&&(h=p);if(-1===l||u||32===d||9===d)throw new SyntaxError("Unexpected end of input");-1===h&&(h=p);const f=e.slice(l,h);return void 0===r?s(t,f,o):(void 0===i?s(o,f,!0):s(o,i,a?f.replace(/\\/g,""):f),s(t,r,o)),t}}},4759:e=>{"use strict";const t=Symbol("kDone"),r=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[r]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[r]()}[r](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},2971:(e,t,r)=>{"use strict";const n=r(3106),s=r(3338),i=r(4759),{kStatusCode:o}=r(2614),a=Buffer[Symbol.species],c=Buffer.from([0,0,255,255]),u=Symbol("permessage-deflate"),l=Symbol("total-length"),d=Symbol("callback"),h=Symbol("buffers"),p=Symbol("error");let f;function m(e){this[h].push(e),this[l]+=e.length}function g(e){this[l]+=e.length,this[u]._maxPayload<1||this[l]<=this[u]._maxPayload?this[h].push(e):(this[p]=new RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][o]=1009,this.removeListener("data",g),this.reset())}function y(e){this[u]._inflate=null,e[o]=1007,this[d](e)}e.exports=class{constructor(e,t,r){if(this._maxPayload=0|r,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!f){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;f=new i(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[d];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,r=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!r)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:!0!==r.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete r.client_max_window_bits,r}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let r=e[t];if(r.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){const e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){const e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==r)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}e[t]=r}))})),e}decompress(e,t,r){f.add((n=>{this._decompress(e,t,((e,t)=>{n(),r(e,t)}))}))}compress(e,t,r){f.add((n=>{this._compress(e,t,((e,t)=>{n(),r(e,t)}))}))}_decompress(e,t,r){const i=this._isServer?"client":"server";if(!this._inflate){const e=`${i}_max_window_bits`,t="number"!=typeof this.params[e]?n.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=n.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[u]=this,this._inflate[l]=0,this._inflate[h]=[],this._inflate.on("error",y),this._inflate.on("data",g)}this._inflate[d]=r,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush((()=>{const e=this._inflate[p];if(e)return this._inflate.close(),this._inflate=null,void r(e);const n=s.concat(this._inflate[h],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[h]=[],t&&this.params[`${i}_no_context_takeover`]&&this._inflate.reset()),r(null,n)}))}_compress(e,t,r){const i=this._isServer?"server":"client";if(!this._deflate){const e=`${i}_max_window_bits`,t="number"!=typeof this.params[e]?n.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=n.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[l]=0,this._deflate[h]=[],this._deflate.on("data",m)}this._deflate[d]=r,this._deflate.write(e),this._deflate.flush(n.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=s.concat(this._deflate[h],this._deflate[l]);t&&(e=new a(e.buffer,e.byteOffset,e.length-4)),this._deflate[d]=null,this._deflate[l]=0,this._deflate[h]=[],t&&this.params[`${i}_no_context_takeover`]&&this._deflate.reset(),r(null,e)}))}}},6286:(e,t,r)=>{"use strict";const{Writable:n}=r(2203),s=r(2971),{BINARY_TYPES:i,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:c}=r(2614),{concat:u,toArrayBuffer:l,unmask:d}=r(3338),{isValidStatusCode:h,isValidUTF8:p}=r(5880),f=Buffer[Symbol.species];e.exports=class extends n{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||i[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new f(t.buffer,t.byteOffset+e,t.length-e),new f(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const r=this._buffers[0],n=t.length-e;e>=r.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),n),this._buffers[0]=new f(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)return void(this._loop=!1);const t=this.consume(2);if(48&t[0])return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));const r=!(64&~t[0]);if(!r||this._extensions[s.extensionName]){if(this._fin=!(128&~t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(r)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=r}else{if(!(this._opcode>7&&this._opcode<11))return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(r)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=!(128&~t[1]),this._isServer){if(!this._masked)return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}else e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){if(this._bufferedBytes<8)return void(this._loop=!1);const t=this.consume(8),r=t.readUInt32BE(0);r>Math.pow(2,21)-1?e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=r*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e))}haveLength(e){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&d(t,this._mask)}if(this._opcode>7)this.controlMessage(t,e);else{if(this._compressed)return this._state=5,void this.decompress(t,e);t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}}decompress(e,t){this._extensions[s.extensionName].decompress(e,this._fin,((e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0){const e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void t(e)}this._fragments.push(r)}this.dataMessage(t),0===this._state&&this.startLoop(t)}))}dataMessage(e){if(!this._fin)return void(this._state=0);const t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?u(r,t):"arraybuffer"===this._binaryType?l(u(r,t)):"blob"===this._binaryType?new Blob(r):r,this._allowSynchronousEvents?(this.emit("message",n,!0),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",n,!0),this._state=0,this.startLoop(e)})))}else{const n=u(r,t);if(!this._skipUTF8Validation&&!p(n)){const t=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(t)}5===this._state||this._allowSynchronousEvents?(this.emit("message",n,!1),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",n,!1),this._state=0,this.startLoop(e)})))}}controlMessage(e,t){if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate((()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)})));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,o),this.end();else{const r=e.readUInt16BE(0);if(!h(r)){const e=this.createError(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(e)}const n=new f(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!p(n)){const e=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(e)}this._loop=!1,this.emit("conclude",r,n),this.end()}this._state=0}}createError(e,t,r,n,s){this._loop=!1,this._errored=!0;const i=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(i,this.createError),i.code=s,i[a]=n,i}}},914:(e,t,r)=>{"use strict";const{Duplex:n}=r(2203),{randomFillSync:s}=r(6982),i=r(2971),{EMPTY_BUFFER:o,kWebSocket:a,NOOP:c}=r(2614),{isBlob:u,isValidStatusCode:l}=r(5880),{mask:d,toBuffer:h}=r(3338),p=Symbol("kByteLength"),f=Buffer.alloc(4),m=8192;let g,y=m;class b{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=c,this[a]=void 0}static frame(e,t){let r,n,i=!1,o=2,a=!1;t.mask&&(r=t.maskBuffer||f,t.generateMask?t.generateMask(r):(y===m&&(void 0===g&&(g=Buffer.alloc(m)),s(g,0,m),y=0),r[0]=g[y++],r[1]=g[y++],r[2]=g[y++],r[3]=g[y++]),a=!(r[0]|r[1]|r[2]|r[3]),o=6),"string"==typeof e?n=t.mask&&!a||void 0===t[p]?(e=Buffer.from(e)).length:t[p]:(n=e.length,i=t.mask&&t.readOnly&&!a);let c=n;n>=65536?(o+=8,c=127):n>125&&(o+=2,c=126);const u=Buffer.allocUnsafe(i?n+o:o);return u[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(u[0]|=64),u[1]=c,126===c?u.writeUInt16BE(n,2):127===c&&(u[2]=u[3]=0,u.writeUIntBE(n,4,6)),t.mask?(u[1]|=128,u[o-4]=r[0],u[o-3]=r[1],u[o-2]=r[2],u[o-1]=r[3],a?[u,e]:i?(d(e,r,u,o,n),[u]):(d(e,r,e,0,n),[u,e])):[u,e]}close(e,t,r,n){let s;if(void 0===e)s=o;else{if("number"!=typeof e||!l(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const r=Buffer.byteLength(t);if(r>123)throw new RangeError("The message must not be greater than 123 bytes");s=Buffer.allocUnsafe(2+r),s.writeUInt16BE(e,0),"string"==typeof t?s.write(t,2):s.set(t,2)}else s=Buffer.allocUnsafe(2),s.writeUInt16BE(e,0)}const i={[p]:s.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,s,!1,i,n]):this.sendFrame(b.frame(s,i),n)}ping(e,t,r){let n,s;if("string"==typeof e?(n=Buffer.byteLength(e),s=!1):u(e)?(n=e.size,s=!1):(n=(e=h(e)).length,s=h.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");const i={[p]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:s,rsv1:!1};u(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,i,r]):this.getBlobData(e,!1,i,r):0!==this._state?this.enqueue([this.dispatch,e,!1,i,r]):this.sendFrame(b.frame(e,i),r)}pong(e,t,r){let n,s;if("string"==typeof e?(n=Buffer.byteLength(e),s=!1):u(e)?(n=e.size,s=!1):(n=(e=h(e)).length,s=h.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");const i={[p]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:s,rsv1:!1};u(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,i,r]):this.getBlobData(e,!1,i,r):0!==this._state?this.enqueue([this.dispatch,e,!1,i,r]):this.sendFrame(b.frame(e,i),r)}send(e,t,r){const n=this._extensions[i.extensionName];let s,o,a=t.binary?2:1,c=t.compress;"string"==typeof e?(s=Buffer.byteLength(e),o=!1):u(e)?(s=e.size,o=!1):(s=(e=h(e)).length,o=h.readOnly),this._firstFragment?(this._firstFragment=!1,c&&n&&n.params[n._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(c=s>=n._threshold),this._compress=c):(c=!1,a=0),t.fin&&(this._firstFragment=!0);const l={[p]:s,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:o,rsv1:c};u(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,l,r]):this.getBlobData(e,this._compress,l,r):0!==this._state?this.enqueue([this.dispatch,e,this._compress,l,r]):this.dispatch(e,this._compress,l,r)}getBlobData(e,t,r,n){this._bufferedBytes+=r[p],this._state=2,e.arrayBuffer().then((e=>{if(this._socket.destroyed){const e=new Error("The socket was closed while the blob was being read");return void process.nextTick(v,this,e,n)}this._bufferedBytes-=r[p];const s=h(e);t?this.dispatch(s,t,r,n):(this._state=0,this.sendFrame(b.frame(s,r),n),this.dequeue())})).catch((e=>{process.nextTick(w,this,e,n)}))}dispatch(e,t,r,n){if(!t)return void this.sendFrame(b.frame(e,r),n);const s=this._extensions[i.extensionName];this._bufferedBytes+=r[p],this._state=1,s.compress(e,r.fin,((e,t)=>{this._socket.destroyed?v(this,new Error("The socket was closed while data was being compressed"),n):(this._bufferedBytes-=r[p],this._state=0,r.readOnly=!1,this.sendFrame(b.frame(t,r),n),this.dequeue())}))}dequeue(){for(;0===this._state&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][p],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][p],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}function v(e,t,r){"function"==typeof r&&r(t);for(let r=0;r<e._queue.length;r++){const n=e._queue[r],s=n[n.length-1];"function"==typeof s&&s(t)}}function w(e,t,r){v(e,t,r),e.onerror(t)}e.exports=b},3719:(e,t,r)=>{"use strict";const{Duplex:n}=r(2203);function s(e){e.emit("close")}function i(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let r=!0;const a=new n({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t,r){const n=!r&&a._readableState.objectMode?t.toString():t;a.push(n)||e.pause()})),e.once("error",(function(e){a.destroyed||(r=!1,a.destroy(e))})),e.once("close",(function(){a.destroyed||a.push(null)})),a._destroy=function(t,n){if(e.readyState===e.CLOSED)return n(t),void process.nextTick(s,a);let i=!1;e.once("error",(function(e){i=!0,n(e)})),e.once("close",(function(){i||n(t),process.nextTick(s,a)})),r&&e.terminate()},a._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){a._final(t)}))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,r,n){e.readyState!==e.CONNECTING?e.send(t,n):e.once("open",(function(){a._write(t,r,n)}))},a.on("end",i),a.on("error",o),a}},8237:(e,t,r)=>{"use strict";const{tokenChars:n}=r(5880);e.exports={parse:function(e){const t=new Set;let r=-1,s=-1,i=0;for(;i<e.length;i++){const o=e.charCodeAt(i);if(-1===s&&1===n[o])-1===r&&(r=i);else if(0===i||32!==o&&9!==o){if(44!==o)throw new SyntaxError(`Unexpected character at index ${i}`);{if(-1===r)throw new SyntaxError(`Unexpected character at index ${i}`);-1===s&&(s=i);const n=e.slice(r,s);if(t.has(n))throw new SyntaxError(`The "${n}" subprotocol is duplicated`);t.add(n),r=s=-1}}else-1===s&&-1!==r&&(s=i)}if(-1===r||-1!==s)throw new SyntaxError("Unexpected end of input");const o=e.slice(r,i);if(t.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}},5880:(e,t,r)=>{"use strict";const{isUtf8:n}=r(181),{hasBlob:s}=r(2614);function i(e){const t=e.length;let r=0;for(;r<t;)if(128&e[r])if(192==(224&e[r])){if(r+1===t||128!=(192&e[r+1])||192==(254&e[r]))return!1;r+=2}else if(224==(240&e[r])){if(r+2>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||224===e[r]&&128==(224&e[r+1])||237===e[r]&&160==(224&e[r+1]))return!1;r+=3}else{if(240!=(248&e[r]))return!1;if(r+3>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||128!=(192&e[r+3])||240===e[r]&&128==(240&e[r+1])||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}else r++;return!0}if(e.exports={isBlob:function(e){return s&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:i,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},n)e.exports.isValidUTF8=function(e){return e.length<24?i(e):n(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const t=r(Object(function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}()));e.exports.isValidUTF8=function(e){return e.length<32?i(e):t(e)}}catch(e){}},1722:(e,t,r)=>{"use strict";const n=r(4434),s=r(8611),{Duplex:i}=r(2203),{createHash:o}=r(6982),a=r(5926),c=r(2971),u=r(8237),l=r(1060),{GUID:d,kWebSocket:h}=r(2614),p=/^[+/0-9A-Za-z]{22}==$/;function f(e){e._state=2,e.emit("close")}function m(){this.destroy()}function g(e,t,r,n){r=r||s.STATUS_CODES[t],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${s.STATUS_CODES[t]}\r\n`+Object.keys(n).map((e=>`${e}: ${n[e]}`)).join("\r\n")+"\r\n\r\n"+r)}function y(e,t,r,n,s){if(e.listenerCount("wsClientError")){const n=new Error(s);Error.captureStackTrace(n,y),e.emit("wsClientError",n,r,t)}else g(r,n,s)}e.exports=class extends n{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:l,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=s.createServer(((e,t)=>{const r=s.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const r of Object.keys(t))e.on(r,t[r]);return function(){for(const r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,n)=>{this.handleUpgrade(t,r,n,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(f,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(f,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{f(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,n){t.on("error",m);const s=e.headers["sec-websocket-key"],i=e.headers.upgrade,o=+e.headers["sec-websocket-version"];if("GET"!==e.method)return void y(this,e,t,405,"Invalid HTTP method");if(void 0===i||"websocket"!==i.toLowerCase())return void y(this,e,t,400,"Invalid Upgrade header");if(void 0===s||!p.test(s))return void y(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");if(8!==o&&13!==o)return void y(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");if(!this.shouldHandle(e))return void g(t,400);const l=e.headers["sec-websocket-protocol"];let d=new Set;if(void 0!==l)try{d=u.parse(l)}catch(r){return void y(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}const h=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==h){const r=new c(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const e=a.parse(h);e[c.extensionName]&&(r.accept(e[c.extensionName]),f[c.extensionName]=r)}catch(r){return void y(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){const i={origin:e.headers[8===o?"sec-websocket-origin":"origin"],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(i,((i,o,a,c)=>{if(!i)return g(t,o||401,a,c);this.completeUpgrade(f,s,d,e,t,r,n)}));if(!this.options.verifyClient(i))return g(t,401)}this.completeUpgrade(f,s,d,e,t,r,n)}completeUpgrade(e,t,r,n,s,i,u){if(!s.readable||!s.writable)return s.destroy();if(s[h])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return g(s,503);const l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${o("sha1").update(t+d).digest("base64")}`],p=new this.options.WebSocket(null,void 0,this.options);if(r.size){const e=this.options.handleProtocols?this.options.handleProtocols(r,n):r.values().next().value;e&&(l.push(`Sec-WebSocket-Protocol: ${e}`),p._protocol=e)}if(e[c.extensionName]){const t=e[c.extensionName].params,r=a.format({[c.extensionName]:[t]});l.push(`Sec-WebSocket-Extensions: ${r}`),p._extensions=e}this.emit("headers",l,n),s.write(l.concat("\r\n").join("\r\n")),s.removeListener("error",m),p.setSocket(s,i,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(p),p.on("close",(()=>{this.clients.delete(p),this._shouldEmitClose&&!this.clients.size&&process.nextTick(f,this)}))),u(p,n)}}},1060:(e,t,r)=>{"use strict";const n=r(4434),s=r(5692),i=r(8611),o=r(9278),a=r(4756),{randomBytes:c,createHash:u}=r(6982),{Duplex:l,Readable:d}=r(2203),{URL:h}=r(7016),p=r(2971),f=r(6286),m=r(914),{isBlob:g}=r(5880),{BINARY_TYPES:y,EMPTY_BUFFER:b,GUID:v,kForOnEventAttribute:w,kListener:C,kStatusCode:_,kWebSocket:S,NOOP:E}=r(2614),{EventTarget:{addEventListener:A,removeEventListener:I}}=r(597),{format:k,parse:O}=r(5926),{toBuffer:P}=r(3338),T=3e4,N=Symbol("kAborted"),R=[8,13],x=["CONNECTING","OPEN","CLOSING","CLOSED"],D=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class F extends n{constructor(e,t,r){super(),this._binaryType=y[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=b,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=F.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(r=t,t=[]):t=[t]),L(this,e,t,r)):(this._autoPong=r.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){y.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){const n=new f({allowSynchronousEvents:r.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation}),s=new m(e,this._extensions,r.generateMask);this._receiver=n,this._sender=s,this._socket=e,n[S]=this,s[S]=this,e[S]=this,n.on("conclude",q),n.on("drain",$),n.on("error",W),n.on("message",H),n.on("ping",Q),n.on("pong",G),s.onerror=K,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",X),e.on("data",Z),e.on("end",ee),e.on("error",te),this._readyState=F.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=F.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[p.extensionName]&&this._extensions[p.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=F.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==F.CLOSED)if(this.readyState!==F.CONNECTING)this.readyState!==F.CLOSING?(this._readyState=F.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),Y(this)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";j(this,this._req,e)}}pause(){this.readyState!==F.CONNECTING&&this.readyState!==F.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===F.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||b,t,r)):V(this,e,r)}pong(e,t,r){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===F.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||b,t,r)):V(this,e,r)}resume(){this.readyState!==F.CONNECTING&&this.readyState!==F.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==F.OPEN)return void V(this,e,r);const n={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[p.extensionName]||(n.compress=!1),this._sender.send(e||b,n,r)}terminate(){if(this.readyState!==F.CLOSED)if(this.readyState!==F.CONNECTING)this._socket&&(this._readyState=F.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";j(this,this._req,e)}}}function L(e,t,r,n){const o={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:R[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(e._autoPong=o.autoPong,!R.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${R.join(", ")})`);let a;if(t instanceof h)a=t;else try{a=new h(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),e._url=a.href;const l="wss:"===a.protocol,d="ws+unix:"===a.protocol;let f;if("ws:"===a.protocol||l||d?d&&!a.pathname?f="The URL's pathname is empty":a.hash&&(f="The URL contains a fragment identifier"):f='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',f){const t=new SyntaxError(f);if(0===e._redirects)throw t;return void B(e,t)}const m=l?443:80,g=c(16).toString("base64"),y=l?s.request:i.request,b=new Set;let w,C;if(o.createConnection=o.createConnection||(l?U:M),o.defaultPort=o.defaultPort||m,o.port=a.port||m,o.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":g,Connection:"Upgrade",Upgrade:"websocket"},o.path=a.pathname+a.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(w=new p(!0!==o.perMessageDeflate?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=k({[p.extensionName]:w.offer()})),r.length){for(const e of r){if("string"!=typeof e||!D.test(e)||b.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");b.add(e)}o.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(a.username||a.password)&&(o.auth=`${a.username}:${a.password}`),d){const e=o.path.split(":");o.socketPath=e[0],o.path=e[1]}if(o.followRedirects){if(0===e._redirects){e._originalIpc=d,e._originalSecure=l,e._originalHostOrSocketPath=d?o.socketPath:a.host;const t=n&&n.headers;if(n={...n,headers:{}},t)for(const[e,r]of Object.entries(t))n.headers[e.toLowerCase()]=r}else if(0===e.listenerCount("redirect")){const t=d?!!e._originalIpc&&o.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&a.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!l)&&(delete o.headers.authorization,delete o.headers.cookie,t||delete o.headers.host,o.auth=void 0)}o.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")),C=e._req=y(o),e._redirects&&e.emit("redirect",e.url,C)}else C=e._req=y(o);o.timeout&&C.on("timeout",(()=>{j(e,C,"Opening handshake has timed out")})),C.on("error",(t=>{null===C||C[N]||(C=e._req=null,B(e,t))})),C.on("response",(s=>{const i=s.headers.location,a=s.statusCode;if(i&&o.followRedirects&&a>=300&&a<400){if(++e._redirects>o.maxRedirects)return void j(e,C,"Maximum redirects exceeded");let s;C.abort();try{s=new h(i,t)}catch(t){const r=new SyntaxError(`Invalid URL: ${i}`);return void B(e,r)}L(e,s,r,n)}else e.emit("unexpected-response",C,s)||j(e,C,`Unexpected server response: ${s.statusCode}`)})),C.on("upgrade",((t,r,n)=>{if(e.emit("upgrade",t),e.readyState!==F.CONNECTING)return;C=e._req=null;const s=t.headers.upgrade;if(void 0===s||"websocket"!==s.toLowerCase())return void j(e,r,"Invalid Upgrade header");const i=u("sha1").update(g+v).digest("base64");if(t.headers["sec-websocket-accept"]!==i)return void j(e,r,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"];let c;if(void 0!==a?b.size?b.has(a)||(c="Server sent an invalid subprotocol"):c="Server sent a subprotocol but none was requested":b.size&&(c="Server sent no subprotocol"),c)return void j(e,r,c);a&&(e._protocol=a);const l=t.headers["sec-websocket-extensions"];if(void 0!==l){if(!w)return void j(e,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");let t;try{t=O(l)}catch(t){return void j(e,r,"Invalid Sec-WebSocket-Extensions header")}const n=Object.keys(t);if(1!==n.length||n[0]!==p.extensionName)return void j(e,r,"Server indicated an extension that was not requested");try{w.accept(t[p.extensionName])}catch(t){return void j(e,r,"Invalid Sec-WebSocket-Extensions header")}e._extensions[p.extensionName]=w}e.setSocket(r,n,{allowSynchronousEvents:o.allowSynchronousEvents,generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})})),o.finishRequest?o.finishRequest(C,e):C.end()}function B(e,t){e._readyState=F.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function M(e){return e.path=e.socketPath,o.connect(e)}function U(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=o.isIP(e.host)?"":e.host),a.connect(e)}function j(e,t,r){e._readyState=F.CLOSING;const n=new Error(r);Error.captureStackTrace(n,j),t.setHeader?(t[N]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(B,e,n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function V(e,t,r){if(t){const r=g(t)?t.size:P(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${x[e.readyState]})`);process.nextTick(r,t)}}function q(e,t){const r=this[S];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[S]&&(r._socket.removeListener("data",Z),process.nextTick(J,r._socket),1005===e?r.close():r.close(e,t))}function $(){const e=this[S];e.isPaused||e._socket.resume()}function W(e){const t=this[S];void 0!==t._socket[S]&&(t._socket.removeListener("data",Z),process.nextTick(J,t._socket),t.close(e[_])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function z(){this[S].emitClose()}function H(e,t){this[S].emit("message",e,t)}function Q(e){const t=this[S];t._autoPong&&t.pong(e,!this._isServer,E),t.emit("ping",e)}function G(e){this[S].emit("pong",e)}function J(e){e.resume()}function K(e){const t=this[S];t.readyState!==F.CLOSED&&(t.readyState===F.OPEN&&(t._readyState=F.CLOSING,Y(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function Y(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),T)}function X(){const e=this[S];let t;this.removeListener("close",X),this.removeListener("data",Z),this.removeListener("end",ee),e._readyState=F.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[S]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",z),e._receiver.on("finish",z))}function Z(e){this[S]._receiver.write(e)||this.pause()}function ee(){const e=this[S];e._readyState=F.CLOSING,e._receiver.end(),this.end()}function te(){const e=this[S];this.removeListener("error",te),this.on("error",E),e&&(e._readyState=F.CLOSING,this.destroy())}Object.defineProperty(F,"CONNECTING",{enumerable:!0,value:x.indexOf("CONNECTING")}),Object.defineProperty(F.prototype,"CONNECTING",{enumerable:!0,value:x.indexOf("CONNECTING")}),Object.defineProperty(F,"OPEN",{enumerable:!0,value:x.indexOf("OPEN")}),Object.defineProperty(F.prototype,"OPEN",{enumerable:!0,value:x.indexOf("OPEN")}),Object.defineProperty(F,"CLOSING",{enumerable:!0,value:x.indexOf("CLOSING")}),Object.defineProperty(F.prototype,"CLOSING",{enumerable:!0,value:x.indexOf("CLOSING")}),Object.defineProperty(F,"CLOSED",{enumerable:!0,value:x.indexOf("CLOSED")}),Object.defineProperty(F.prototype,"CLOSED",{enumerable:!0,value:x.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(F.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(F.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[w])return t[C];return null},set(t){for(const t of this.listeners(e))if(t[w]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[w]:!0})}})})),F.prototype.addEventListener=A,F.prototype.removeEventListener=I,e.exports=F},2613:e=>{"use strict";e.exports=require("assert")},181:e=>{"use strict";e.exports=require("buffer")},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},7194:e=>{"use strict";e.exports=require("dgram")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},1943:e=>{"use strict";e.exports=require("fs/promises")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},9278:e=>{"use strict";e.exports=require("net")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},4756:e=>{"use strict";e.exports=require("tls")},9637:e=>{"use strict";e.exports=require("tty")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},3106:e=>{"use strict";e.exports=require("zlib")},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=function(e,t){Promise.resolve().then((async()=>{if(l)throw new Error("runEntrypoint can only be called once");if(l=!0,t||(t=[]),!Array.isArray(t))throw new Error("upgradeScripts must be an array");for(const e of t)if("function"!=typeof e)throw new Error("upgradeScripts must be an array of functions");const r=process.env.MODULE_MANIFEST;if(!r)throw new Error("Module initialise is missing MODULE_MANIFEST");const n=await i.default.readFile(r),d=JSON.parse(n.toString());if(d.runtime?.api!==s.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!d.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let h=d.runtime.apiVersion;if("0.0.0"===h)try{const e=await i.default.readFile(c.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(h=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const p=process.env.CONNECTION_ID;if("string"!=typeof p||!p)throw new Error("Module initialise is missing CONNECTION_ID");const f=process.env.VERIFICATION_TOKEN;if("string"!=typeof f||!f)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const m=new a.IpcWrapper({},(e=>{process.send(e)}),5e3);process.once("message",(e=>{m.receivedMessage(e)})),u=new e((0,o.literal)({id:p,upgradeScripts:t,_isInstanceBaseProps:!0})),m.sendWithCb("register",{apiVersion:h,connectionId:p,verificationToken:f}).then((()=>{console.log("Module-host accepted registration")}),(e=>{console.error("Module registration failed",e),process.exit(11)}))})).catch((e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)}))};const n=r(1635),s=r(9967),i=n.__importDefault(r(1943)),o=r(360),a=r(4044),c=n.__importDefault(r(6928));let u,l=!1},6160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var n=r(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return n.TCPHelper}});var s=r(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return s.TelnetHelper}});var i=r(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return i.UDPHelper}})},8895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const n=r(1635).__importDefault(r(9278)),s=r(228),i=r(1400);class o extends s.EventEmitter{#e;#t;_socket;#r;#n=!1;#s=!1;#i=!1;#o;#a;#c;get isConnected(){return this.#n}get isConnecting(){return this.#s}get isDestroyed(){return this.#i}constructor(e,t,r){super(),this.#e=e,this.#t=t,this.#r={reconnect_interval:2e3,reconnect:!0,...r},this._socket=new n.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",(e=>{this.#s=!1,this.#n=!1,this.#r.reconnect&&this.#u(),this.#l(i.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this._socket.on("ready",(()=>{this.#n=!0,this.#s=!1,this.#l(i.InstanceStatus.Ok),this.emit("connect")})),this._socket.on("end",(()=>{this.#n=!1,this.#l(i.InstanceStatus.Disconnected),!this.#s&&this.#r.reconnect&&this.#u(),this.emit("end")})),this._socket.on("data",(e=>this.emit("data",e))),this._socket.on("drain",(()=>this.emit("drain"))),setImmediate((()=>{this.#i||this.connect()})),this.#c=setTimeout((()=>{this.#c=void 0,this.#i||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}connect(){if(this.#i)throw new Error("Cannot connect destroyed socket");return!this.#s&&(this.#s=!0,this._socket.connect(this.#t,this.#e),!0)}async send(e){if(this.#i||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#n)return!1;try{return new Promise(((t,r)=>{this._socket.write(e,(e=>{e?r(e):t(!0)}))}))}catch(e){this.#n=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#l(i.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#i=!0,void 0!==this.#a&&(clearTimeout(this.#a),this.#a=void 0),void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#u(){void 0!==this.#a&&clearTimeout(this.#a),this.#a=setTimeout((()=>{this.#a=void 0,this.#l(i.InstanceStatus.Connecting),this.connect()}),this.#r.reconnect_interval)}#l(e,t){this.#o!=e&&(this.#o=e,this.emit("status_change",e,t))}}t.TCPHelper=o},1118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const n=r(1635).__importDefault(r(228)),s=r(2203),i=r(8895);class o extends n.default{#d;#h;#c;get isConnected(){return this.#d.isConnected}get isConnecting(){return this.#d.isConnecting}get isDestroyed(){return this.#d.isDestroyed}constructor(e,t,r){super(),this.#d=new i.TCPHelper(e,t,r),this.#h=new a,this.#d._socket.pipe(this.#h),this.#d.on("connect",(()=>this.emit("connect"))),this.#d.on("end",(()=>this.emit("end"))),this.#d.on("error",(e=>this.emit("error",e))),this.#d.on("status_change",((e,t)=>this.emit("status_change",e,t))),this.#h.on("iac",((e,t)=>this.emit("iac",e,t))),this.#h.on("sb",(e=>this.emit("sb",e))),this.#h.on("data",(e=>this.emit("data",e))),this.#h.on("drain",(()=>this.emit("drain"))),this.#c=setTimeout((()=>{this.#c=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)}),5e3)}connect(){return this.#d.connect()}async send(e){return this.#d.send(e)}destroy(){this.#d.destroy(),void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this.#h.removeAllListeners(),this.#h.destroy()}}t.TelnetHelper=o;class a extends s.Transform{#p;#f;#m;constructor(e){super(e),this.#p=Buffer.alloc(0),this.#f=Buffer.alloc(0),this.#m=0}_transform(e,t,r){for(let t=0;t<e.length;++t)this.#g(e[t]);const n=this.#y();n.length&&this.push(n),r()}#g(e){if(0===this.#m){if(255===e)return void(this.#m=255);this.#p=Buffer.concat([this.#p,Buffer.from([e])])}else if(255===this.#m)switch(e){case 250:case 251:case 252:case 253:case 254:this.#m=e;break;default:this.#m=0}else{if(this.#m>=251&&this.#m<=254){let t;switch(this.#m){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#m=0)}if(250===this.#m){if(240===e)return this.emit("sb",this.#f),this.#m=0,void(this.#f=Buffer.alloc(0));this.#f=Buffer.concat([this.#f,Buffer.from([e])])}}}#y(){const e=this.#p;return this.#p=Buffer.alloc(0),e}}},6259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const n=r(1635).__importDefault(r(7194)),s=r(228),i=r(1400);class o extends s.EventEmitter{#e;#t;#b;#r;#i=!1;#o;#c;get isDestroyed(){return this.#i}constructor(e,t,r){super(),this.#e=e,this.#t=t,this.#r={...r},this.#b=n.default.createSocket("udp4");try{this.#b.bind(this.#r.bind_port||0,this.#r.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#r.bind_ip||"0.0.0.0"}:${this.#r.bind_port||0}`)}void 0!==this.#r.ttl&&this.#b.setTTL(this.#r.ttl),void 0!==this.#r.multicast_ttl&&this.#b.setMulticastTTL(this.#r.multicast_ttl),this.#b.on("error",(e=>{this.#l(i.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this.#b.on("listening",(()=>{this.#r.broadcast&&this.#b.setBroadcast(!0),this.#r.multicast_interface&&this.#b.setMulticastInterface(this.#r.multicast_interface),this.#l(i.InstanceStatus.Ok),this.emit("listening")})),this.#b.on("message",((e,t)=>this.emit("data",e,t))),this.#c=setTimeout((()=>{this.#i||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}async send(e){if(this.#i)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise(((t,r)=>{this.#b.send(e,this.#t,this.#e,(e=>{e?r(e):t()}))}))}destroy(){this.#i=!0,void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this.#b.removeAllListeners(),this.#b.close(),this.removeAllListeners()}#l(e,t){this.#o!=e&&(this.#o=e,this.emit("status_change",e,t))}}t.UDPHelper=o},4044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const n=r(1635),s=r(360),i=n.__importDefault(r(6022));t.IpcWrapper=class{#v;#w;#C;#_=1;#S=new Map;constructor(e,t,r){this.#v=e,this.#w=t,this.#C=r}async sendWithCb(e,t,r,n=0){n<=0&&(n=this.#C);const s={timeout:void 0,resolve:()=>null,reject:()=>null},o=new Promise(((e,t)=>{s.resolve=e,s.reject=t}));this.#_>268435456&&(this.#_=1);const a=this.#_++;this.#S.set(a,s),this.#w({direction:"call",name:String(e),payload:i.default.stringify(t),callbackId:a});const c=new Error("Call timed out");return s.timeout=setTimeout((()=>{s.reject(r?r():c),this.#S.delete(a)}),n),o}sendWithNoCb(e,t){this.#w({direction:"call",name:String(e),payload:i.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#v[e.name];if(!t)return void(e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!1,payload:i.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?i.default.parse(e.payload):void 0).then((t=>{e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!0,payload:i.default.stringify(t)})}),(t=>{e.callbackId&&this.#w({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):i.default.stringify(t)})}));break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#S.get(e.callbackId);if(this.#S.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const r=e.payload?i.default.parse(e.payload):void 0;if(e.success)t.resolve(r);else{let e=r;r&&"object"==typeof r&&"message"in r&&(e=new Error(r.message),r.stack&&(e.stack=r.stack)),t.reject(e)}break}default:(0,s.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},6278:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.substituteEscapeCharacters=t.parseEscapeCharacters=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const n=r(1635);n.__exportStar(r(9077),t),n.__exportStar(r(2018),t),n.__exportStar(r(4581),t);var s=r(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return s.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return s.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return s.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return s.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return s.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return s.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return s.assertNever}}),Object.defineProperty(t,"parseEscapeCharacters",{enumerable:!0,get:function(){return s.parseEscapeCharacters}}),Object.defineProperty(t,"substituteEscapeCharacters",{enumerable:!0,get:function(){return s.substituteEscapeCharacters}}),n.__exportStar(r(6160),t);var i=r(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return i.runEntrypoint}})},4289:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const n=r(2593);function s(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#E;#A;#I;#k;#O=new Map;#P=new Map;constructor(e,t,r,n){this.#E=e,this.#A=t,this.#I=r,this.#k=n}async handleExecuteAction(e){const t=this.#O.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:(t,r)=>{this.#I({customVariableId:t,value:r,controlId:e.action.controlId})}};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},r)}handleUpdateActions(e){for(const[t,r]of Object.entries(e)){const e=this.#P.get(t);if(e){const t=this.#O.get(e.actionId);if(t?.unsubscribe){const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(s(e),r)).catch((t=>{this.#k("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!r||r.disabled)this.#P.delete(t);else{this.#P.set(t,r);const e=this.#O.get(r.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#E({text:e,controlId:r.controlId,actionInstanceId:r.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(e.subscribe(s(r),t)).catch((e=>{this.#k("error",`Action subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}))}}}}async handleLearnAction(e){const t=this.#O.get(e.action.actionId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during learn")}};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},r)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#O.clear();for(const[r,s]of Object.entries(e))s&&(t.push({id:r,name:s.name,description:s.description,options:(0,n.serializeIsVisibleFn)(s.options),hasLearn:!!s.learn,learnTimeout:s.learnTimeout,hasLifecycleFunctions:!!s.subscribe||!!s.unsubscribe}),this.#O.set(r,s));this.#A({actions:t})}subscribeActions(e){let t=Array.from(this.#P.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.actionId))));for(const e of t){const t=this.#O.get(e.actionId);if(t?.subscribe){const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during subscribe")}};Promise.resolve(t.subscribe(s(e),r)).catch((t=>{this.#k("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeActions(e){let t=Array.from(this.#P.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.actionId))));for(const e of t){const t=this.#O.get(e.actionId);if(t&&t.unsubscribe){const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(s(e),r)).catch((t=>{this.#k("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeIsVisibleFn=function(e){return(e??[]).map((e=>"isVisibleExpression"in e&&"string"==typeof e.isVisibleExpression?{...e,isVisibleFnType:"expression",isVisibleFn:e.isVisibleExpression,isVisible:void 0,isVisibleExpression:void 0}:"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisibleFnType:"function",isVisible:void 0,isVisibleExpression:void 0}:{...e,isVisible:void 0,isVisibleFn:void 0,isVisibleFnType:void 0,isVisibleExpression:void 0}))},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},8039:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const n=r(1635),s=r(2593),i=n.__importDefault(r(7e3));function o(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#E;#T;#N;#k;#R=new Map;#x=new Map;#D=new Map;#F=new Map;#L;get parseVariablesContext(){return this.#L}constructor(e,t,r,n){this.#E=e,this.#T=t,this.#N=r,this.#k=n}getDefinitionIds(){return Array.from(this.#R.keys())}getInstanceIds(){return Array.from(this.#x.keys())}handleUpdateFeedbacks(e){for(const[t,r]of Object.entries(e)){const e=this.#x.get(t);if(e){const t=this.#R.get(e.feedbackId);if(t?.unsubscribe){const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(o(t.type,e),r)).catch((t=>{this.#k("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!r||r.disabled)this.#x.delete(t);else{this.#x.set(t,{...r,referencedVariables:null});const e=this.#R.get(r.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#E({text:e,controlId:r.controlId,actionInstanceId:void 0,feedbackInstanceId:r.id})).text};Promise.resolve(e.subscribe(o(e.type,r),t)).catch((e=>{this.#k("error",`Feedback subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}))}this.#B(t)}}}async handleLearnFeedback(e){const t=this.#R.get(e.feedback.feedbackId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},r)}}return{options:void 0}}handleVariablesChanged(e){if(!e.variablesIds.length)return;const t=new Set(e.variablesIds);for(const t of this.#F.values())for(const r of e.variablesIds)t.changedVariables.add(r);const r=new Set;for(const e of this.#x.values())if(!this.#F.has(e.id)&&e.referencedVariables)for(const n of e.referencedVariables)if(t.has(n)){r.add(e.id);break}for(const e of r)setImmediate((()=>{this.#B(e)}))}#B(e){const t=this.#F.get(e);if(t)return void(t.needsRecheck=!0);const r=this.#x.get(e);if(!r)return;const n=r,s={needsRecheck:!1,changedVariables:new Set};this.#F.set(e,s),Promise.resolve().then((async()=>{const t=this.#R.get(n.feedbackId);let r;const s=new Set;if(t){this.#L=`Feedback ${n.feedbackId} (${e})`;const i={parseVariablesInString:async t=>{const r=await this.#E({text:t,controlId:n.controlId,actionInstanceId:void 0,feedbackInstanceId:e});if(r.variableIds&&r.variableIds.length)for(const e of r.variableIds)s.add(e);return r.text}};r="boolean"===t.type?t.callback({...o("boolean",n),type:"boolean"},i):t.callback({...o("advanced",n),type:"advanced",image:n.image},i),this.#L=void 0}const i=await r;this.#D.set(e,{id:e,controlId:n.controlId,value:i}),this.#M(),n.referencedVariables=s.size>0?Array.from(s):null})).catch((e=>{console.error(`Feedback check failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)})).finally((()=>{this.#L=void 0,this.#F.delete(e);let t=!1;if(n.referencedVariables)for(const e of n.referencedVariables)if(s.changedVariables.has(e)){t=!0;break}(t||s.needsRecheck)&&setImmediate((()=>{this.#B(e)}))}))}#M=(0,i.default)((()=>{const e=this.#D;this.#D=new Map,e.size>0&&this.#T({values:Array.from(e.values())})}),{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#R.clear();for(const[r,n]of Object.entries(e))n&&(t.push({id:r,name:n.name,description:n.description,options:(0,s.serializeIsVisibleFn)(n.options),type:n.type,defaultStyle:"boolean"===n.type?n.defaultStyle:void 0,hasLearn:!!n.learn,learnTimeout:n.learnTimeout,showInvert:"boolean"===n.type&&n.showInvert}),this.#R.set(r,n));this.#N({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,r]of this.#x.entries())this.#R.get(r.feedbackId)&&(0===t.size||t.has(r.feedbackId))&&this.#B(e)}checkFeedbacksById(e){for(const t of e)this.#B(t)}subscribeFeedbacks(e){let t=Array.from(this.#x.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.feedbackId))));for(const e of t){const t=this.#R.get(e.feedbackId);if(t?.subscribe){const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.subscribe(o(t.type,e),r)).catch((t=>{this.#k("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeFeedbacks(e){let t=Array.from(this.#x.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.feedbackId))));for(const e of t){const t=this.#R.get(e.feedbackId);if(t&&t.unsubscribe){const r={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(o(t.type,e),r)).catch((t=>{this.#k("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},1706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=function(e,t,r,i,o,a){const c=new Map,u=e=>{let t=c.get(e);return t||(t={actions:[],feedbacks:[],config:!1},c.set(e,t)),t};for(const t of Object.values(e)){const e=t?.upgradeIndex??r;t&&"number"==typeof e&&u(e).actions.push(t.id)}for(const e of Object.values(t)){const t=e?.upgradeIndex??r;e&&"number"==typeof t&&u(t).feedbacks.push(e.id)}if(!a)for(let e=r??-1;e<i.length;e++)u(e).config=!0;const l={},d={};let h;if(c.size>0){const a=Array.from(c.keys()).sort(),u=Math.min(...a,r??-1)+1,p=[],f=[],m=i.length;for(let r=u;r<m;r++){const a=c.get(r-1);a&&(p.push(...a.actions),f.push(...a.feedbacks));const u=!!a?.config;if(!u&&0===p.length&&0===f.length)continue;const m=h??o,g=(0,i[r])({currentConfig:s(m)},{config:u?m:null,actions:p.map((t=>{const r=e[t];if(r)return(0,n.literal)({id:r.id,controlId:r.controlId,actionId:r.actionId,options:void 0!==r.options?s(r.options):{}})})).filter((e=>!!e)),feedbacks:f.map((e=>{const r=t[e];if(r)return(0,n.literal)({id:r.id,controlId:r.controlId,feedbackId:r.feedbackId,options:void 0!==r.options?s(r.options):{},isInverted:r.isInverted})})).filter((e=>!!e))});u&&g.updatedConfig&&(h=g.updatedConfig);for(const t of g.updatedActions)if(t){const r=e[t.id];r&&(r.actionId=t.actionId,r.options=t.options,d[t.id]=r)}for(const e of g.updatedFeedbacks)if(e){const r=t[e.id];r&&(r.feedbackId=e.feedbackId,r.options=e.options,l[e.id]={...r,style:l[e.id]?.style??e.style,isInverted:e.isInverted??!1})}}for(const[t,r]of Object.entries(e))d[t]||"number"!=typeof r?.upgradeIndex||(d[t]=r);for(const[e,r]of Object.entries(t))l[e]||"number"!=typeof r?.upgradeIndex||(l[e]=r)}return{updatedActions:d,updatedFeedbacks:l,updatedConfig:h}};const n=r(360);function s(e){return JSON.parse(JSON.stringify(e))}},9077:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=function(e,t){if(!t){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'")}if(e.legacyIds.includes(e.id))throw new Error(`Manifest contains itself '${e.id}' in legacyIds`);if(!(0,n.default)(e)){const e=n.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}};const n=r(1635).__importDefault(r(7281))},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1649:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const n=r(1635),s=r(360),i=n.__importDefault(r(3290)),o=r(2593),a=r(1706),c=r(8039),u=r(4044),l=r(4289),d=r(2365);t.InstanceBase=class{#U;#j;id;#V=new i.default({concurrency:1});#q=!1;#$=!1;#W={};#z;#H;#Q=new Map;#G=new Map;#J=new Map;#r;#K;get instanceOptions(){return this.#r}get label(){return this.#K}constructor(e){if(!(0,o.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#r={disableVariableValidation:!1},this.#U=new u.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:this._handleVariablesChanged.bind(this),sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},(e=>{process.send(e)}),5e3),process.on("message",(e=>{this.#U.receivedMessage(e)})),this.#z=new l.ActionManager((async e=>this.#U.sendWithCb("parseVariablesInString",e)),(e=>this.#U.sendWithNoCb("setActionDefinitions",e)),(e=>this.#U.sendWithNoCb("setCustomVariable",e)),this.log.bind(this)),this.#H=new c.FeedbackManager((async e=>this.#U.sendWithCb("parseVariablesInString",e)),(e=>this.#U.sendWithNoCb("updateFeedbackValues",e)),(e=>this.#U.sendWithNoCb("setFeedbackDefinitions",e)),this.log.bind(this)),this.#j=e.upgradeScripts,this.id=e.id,this.#K=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#V.add((async()=>{if(this.#q)throw new Error("Already initialized");const t=e.actions,r=e.feedbacks;if(this.#W=e.config,this.#K=e.label,e.isFirstInit){const t={},r=this.getConfigFields();for(const e of r)"default"in e&&(t[e.id]=e.default);this.#W=t,this.saveConfig(this.#W),e.lastUpgradeIndex=this.#j.length-1}const{updatedActions:n,updatedFeedbacks:s,updatedConfig:i}=(0,a.runThroughUpgradeScripts)(t,r,e.lastUpgradeIndex,this.#j,this.#W,!1);this.#W=i??this.#W;const o=this.#U.sendWithCb("upgradedItems",{updatedActions:n,updatedFeedbacks:s});try{await this.init(this.#W,!!e.isFirstInit),this.#q=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}finally{await o}return setImmediate((()=>{this._handleUpdateActions({actions:t},!0).catch((e=>{this.log("error",`Receive actions failed: ${e}`)})),this._handleUpdateFeedbacks({feedbacks:r},!0).catch((e=>{this.log("error",`Receive feedbacks failed: ${e}`)}))})),{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#j.length-1,updatedConfig:this.#W}}))}async _handleDestroy(){await this.#V.add((async()=>{if(!this.#q)throw new Error("Not initialized");await this.destroy(),this.#q=!1}))}async _handleConfigUpdateAndLabel(e){await this.#V.add((async()=>{if(!this.#q)throw new Error("Not initialized");this.#K=e.label,this.#W=e.config,await this.configUpdated(this.#W)}))}async _handleExecuteAction(e){return this.#z.handleExecuteAction(e)}async _handleUpdateFeedbacks(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)({},e.feedbacks,null,this.#j,this.#W,!0);this.#U.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded feedbacks: ${e}`)}))}this.#H.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)(e.actions,{},null,this.#j,this.#W,!0);this.#U.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded actions: ${e}`)}))}this.#z.handleUpdateActions(e.actions)}async _handleGetConfigFields(e){return{fields:(0,o.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#z.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#H.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#$)return}else if(!this.#$)return;if(!this.handleStartStopRecordActions)throw this.#$=!1,new Error("Recording actions is not supported by this module!");this.#$=e.recording,this.handleStartStopRecordActions(this.#$)}async _handleVariablesChanged(e){this.#H.handleVariablesChanged(e)}async _handleSharedUdpSocketMessage(e){for(const t of this.#Q.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#Q.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e){this.#W=e,this.#U.sendWithNoCb("saveConfig",{config:e})}setActionDefinitions(e){this.#z.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#H.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[r,n]of Object.entries(e))n&&t.push({...n,id:r});this.#U.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],r=[];this.#G.clear();for(const n of e)t.push({id:n.variableId,name:n.name}),this.#G.set(n.variableId,n),this.#J.has(n.variableId)||(this.#J.set(n.variableId,""),r.push({id:n.variableId,value:""}));if(!this.#r.disableVariableValidation){const e=new Set(this.#G.keys());for(const t of this.#J.keys())e.has(t)||(this.#J.delete(t),r.push({id:t,value:void 0}))}this.#U.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:r})}setVariableValues(e){const t=[];for(const[r,n]of Object.entries(e))this.#r.disableVariableValidation?(void 0===n?this.#J.delete(r):this.#J.set(r,n),t.push({id:r,value:n})):this.#G.has(r)?(this.#J.set(r,n??""),t.push({id:r,value:n??""})):t.push({id:r,value:void 0});this.#U.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#J.get(e)}async parseVariablesInString(e){const t=this.#H.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),(await this.#U.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text}checkFeedbacks(...e){this.#H.checkFeedbacks(e)}checkFeedbacksById(...e){this.#H.checkFeedbacksById(e)}subscribeActions(...e){this.#z.subscribeActions(e)}unsubscribeActions(...e){this.#z.unsubscribeActions(e)}subscribeFeedbacks(...e){this.#H.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#H.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#$)throw new Error("Not currently recording actions");this.#U.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}oscSend(e,t,r,n){this.#U.sendWithNoCb("send-osc",(0,s.literal)({host:e,port:t,path:r,args:n}))}updateStatus(e,t){this.#U.sendWithNoCb("set-status",(0,s.literal)({status:e,message:t??null}))}log(e,t){this.#U.sendWithNoCb("log-message",(0,s.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const r="string"==typeof e?{type:e}:e,n=new d.SharedUdpSocketImpl(this.#U,this.#Q,r);return t&&n.on("message",t),n}}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1400:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(r||(t.InstanceStatus=r={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(n||(t.Regex=n={}))},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1635);n.__exportStar(r(3730),t),n.__exportStar(r(1649),t),n.__exportStar(r(7386),t),n.__exportStar(r(1400),t),n.__exportStar(r(8983),t),n.__exportStar(r(8104),t),n.__exportStar(r(3258),t),n.__exportStar(r(131),t),n.__exportStar(r(3371),t),n.__exportStar(r(9786),t),n.__exportStar(r(6132),t)},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2365:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const n=r(1635).__importDefault(r(228)),s=r(360);class i extends n.default{#U;#Y;#r;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#m&&"object"==typeof this.#m?this.#m:void 0}#m="pending";constructor(e,t,r){super(),this.#U=e,this.#Y=t,this.#r={...r}}bind(e,t,r){if(this.#m&&"object"==typeof this.#m)throw new Error("Socket is already bound");switch(this.#m){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,s.assertNever)(this.#m),new Error("Invalid socket state")}this.#m="binding",r&&this.on("listening",r),this.#U.sendWithCb("sharedUdpSocketJoin",{family:this.#r.type,portNumber:e}).then((t=>{this.#m={portNumber:e,handleId:t},this.#Y.set(t,this),this.emit("listening")}),(e=>{this.#m="closed",this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}close(e){if(this.#m&&"object"==typeof this.#m);else switch(this.#m){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,s.assertNever)(this.#m),new Error("Invalid socket state")}const t=this.#m.handleId;this.#m="closed",e&&this.on("close",e),this.#U.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then((()=>{this.#Y.delete(t),this.emit("close")}),(e=>{this.#Y.delete(t),this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}send(e,t,r,n,s,i){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof r){if("number"!=typeof n||"string"!=typeof s)throw new Error("Invalid arguments");if(void 0!==i&&"function"!=typeof i)throw new Error("Invalid arguments");const o=this.#X(e,t,r);this.#Z(o,n,s,i)}else{if("string"!=typeof r)throw new Error("Invalid arguments");{if(void 0!==n&&"function"!=typeof n)throw new Error("Invalid arguments");const s=this.#X(e,0,void 0);this.#Z(s,t,r,n)}}}#X(e,t,r){let n;if("string"==typeof e)n=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))n=e;else{if(Array.isArray(e))return Buffer.from(e);n=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return n.subarray(t,void 0!==r?r+t:void 0)}#Z(e,t,r,n){if(!this.#m||"object"!=typeof this.#m)throw new Error("Socket is not open");this.#U.sendWithCb("sharedUdpSocketSend",{handleId:this.#m.handleId,message:e,address:r,port:t}).then((()=>{n?.()}),(e=>{this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#m="fatalError";const t=this.boundState;t&&this.#Y.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=i},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyUpgradeScript=void 0,t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,r)=>{const n=[];for(const t of r.feedbacks){let r=e[t.feedbackId];if(!0===r&&(r={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),r){t.style||(t.style={});for(const[e,s]of Object.entries(r))void 0!==t.options[e]&&(t.style[s]=t.options[e],delete t.options[e],n.push(t))}}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:n}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,r)=>{const n=[];for(const t of r.feedbacks){const r=e[t.feedbackId];if("string"!=typeof r)continue;const s=t.options[r];void 0!==s&&(delete t.options[r],t.isInverted="true"===s||!0===s||Number(s)>0,n.push(t))}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:n}}},t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedActions:[],updatedFeedbacks:[]})},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,r,n){let s=(255&e)<<16|(255&t)<<8|255&r;return n&&n>=0&&n<1&&(s+=16777216*Math.round(255*(1-n))),s},t.splitRgb=s,t.splitHsl=function(e){const t=s(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=s(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=s(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()},t.parseEscapeCharacters=function(e){return e.replaceAll("\\n","\n").replaceAll("\\r","\r").replaceAll("\\t","\t").replaceAll("\\f","\f").replaceAll("\\v","\v").replaceAll("\\b","\b").replaceAll("\\\\","\\").replaceAll("\\x00","\0").replaceAll("\\x01","").replaceAll("\\x02","").replaceAll("\\x03","")},t.substituteEscapeCharacters=function(e){return e.replaceAll("\n","\\n").replaceAll("\r","\\r").replaceAll("\t","\\t").replaceAll("\f","\\f").replaceAll("\v","\\v").replaceAll("\b","\\b").replaceAll("\\","\\\\").replaceAll("\0","\\x00").replaceAll("","\\x01").replaceAll("","\\x02").replaceAll("","\\x03")};const n=r(6284);function s(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,n.colord)(e).isValid()){const t=(0,n.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}},7281:(e,t,r)=>{"use strict";e.exports=a,e.exports.default=a;const n={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},isPrerelease:{type:"boolean",description:"Is this a pre-release version"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"},url:{type:"string"}},required:["name"],additionalProperties:!1}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18 or node22",enum:["node18","node22"]},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"},permissions:{type:"object",description:"Permissions required by the module. This is used to inform the user of the permissions required by the module.\nNote: this requires the node22 or newer runtime",properties:{"worker-threads":{type:"boolean",description:"Enable if the module uses worker threads"},"child-process":{type:"boolean",description:"Enable if the module uses child processes"},"native-addons":{type:"boolean",description:"Enable if the module uses native addons"},filesystem:{type:"boolean",description:"Enable if the module requires read/write access to the filesystem"}},additionalProperties:!1}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}}}},required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]}}},s={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]},i=r(7169).A,o=new RegExp("","u");function a(e,{instancePath:t="",parentData:r,parentDataProperty:c,rootData:u=e}={}){let l=null,d=0;if(0===d){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.id&&(r="id")||void 0===e.name&&(r="name")||void 0===e.shortname&&(r="shortname")||void 0===e.description&&(r="description")||void 0===e.version&&(r="version")||void 0===e.license&&(r="license")||void 0===e.repository&&(r="repository")||void 0===e.bugs&&(r="bugs")||void 0===e.maintainers&&(r="maintainers")||void 0===e.legacyIds&&(r="legacyIds")||void 0===e.runtime&&(r="runtime")||void 0===e.manufacturer&&(r="manufacturer")||void 0===e.products&&(r="products")||void 0===e.keywords&&(r="keywords"))return a.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;if(void 0!==e.$schema){const r=d;if("string"!=typeof e.$schema)return a.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var h=r===d}else h=!0;if(h){if(void 0!==e.id){const r=d;if("string"!=typeof e.id)return a.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.name){const r=d;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.shortname){const r=d;if("string"!=typeof e.shortname)return a.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.description){const r=d;if("string"!=typeof e.description)return a.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.version){const r=d;if("string"!=typeof e.version)return a.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.isPrerelease){const r=d;if("boolean"!=typeof e.isPrerelease)return a.errors=[{instancePath:t+"/isPrerelease",schemaPath:"#/properties/isPrerelease/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.license){const r=d;if("string"!=typeof e.license)return a.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.repository){const r=d;if("string"!=typeof e.repository)return a.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.bugs){const r=d;if("string"!=typeof e.bugs)return a.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.maintainers){let r=e.maintainers;const n=d;if(d===n){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var p=!0;const e=r.length;for(let n=0;n<e;n++){let e=r[n];const s=d;if(d===s){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/maintainers/"+n,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.name&&(r="name"))return a.errors=[{instancePath:t+"/maintainers/"+n,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;{const r=d;for(const r in e)if("name"!==r&&"email"!==r&&"github"!==r&&"url"!==r)return a.errors=[{instancePath:t+"/maintainers/"+n,schemaPath:"#/properties/maintainers/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===d){if(void 0!==e.name){const r=d;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/maintainers/"+n+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=r===d}else f=!0;if(f){if(void 0!==e.email){const r=d;if("string"!=typeof e.email)return a.errors=[{instancePath:t+"/maintainers/"+n+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.github){const r=d;if("string"!=typeof e.github)return a.errors=[{instancePath:t+"/maintainers/"+n+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f)if(void 0!==e.url){const r=d;if("string"!=typeof e.url)return a.errors=[{instancePath:t+"/maintainers/"+n+"/url",schemaPath:"#/properties/maintainers/items/properties/url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0}}}}}}if(!(p=s===d))break}if(p){let e,n=r.length;if(n>1)for(;n--;)for(e=n;e--;)if(i(r[n],r[e]))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1}}}h=n===d}else h=!0;if(h){if(void 0!==e.legacyIds){let r=e.legacyIds;const n=d;if(d===n){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var m=!0;const e=r.length;for(let n=0;n<e;n++){const e=d;if("string"!=typeof r[n])return a.errors=[{instancePath:t+"/legacyIds/"+n,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(m=e===d))break}if(m){let e,n=r.length;if(n>1){const s={};for(;n--;){let i=r[n];if("string"==typeof i){if("number"==typeof s[i])return e=s[i],a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;s[i]=n}}}}}}h=n===d}else h=!0;if(h){if(void 0!==e.runtime){let r=e.runtime;const s=d;if(d===s){if(!r||"object"!=typeof r||Array.isArray(r))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===r.type&&(e="type")||void 0===r.api&&(e="api")||void 0===r.apiVersion&&(e="apiVersion")||void 0===r.entrypoint&&(e="entrypoint"))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==r.type){let e=r.type;const s=d;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("node18"!==e&&"node22"!==e)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/enum",keyword:"enum",params:{allowedValues:n.properties.runtime.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var g=s===d}else g=!0;if(g){if(void 0!==r.api){let e=r.api;const s=d;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:n.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;g=s===d}else g=!0;if(g){if(void 0!==r.apiVersion){const e=d;if("string"!=typeof r.apiVersion)return a.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===d}else g=!0;if(g){if(void 0!==r.entrypoint){const e=d;if("string"!=typeof r.entrypoint)return a.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===d}else g=!0;if(g)if(void 0!==r.permissions){let e=r.permissions;const n=d;if(d===n){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const r=d;for(const r in e)if("worker-threads"!==r&&"child-process"!==r&&"native-addons"!==r&&"filesystem"!==r)return a.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===d){if(void 0!==e["worker-threads"]){const r=d;if("boolean"!=typeof e["worker-threads"])return a.errors=[{instancePath:t+"/runtime/permissions/worker-threads",schemaPath:"#/properties/runtime/properties/permissions/properties/worker-threads/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var y=r===d}else y=!0;if(y){if(void 0!==e["child-process"]){const r=d;if("boolean"!=typeof e["child-process"])return a.errors=[{instancePath:t+"/runtime/permissions/child-process",schemaPath:"#/properties/runtime/properties/permissions/properties/child-process/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;y=r===d}else y=!0;if(y){if(void 0!==e["native-addons"]){const r=d;if("boolean"!=typeof e["native-addons"])return a.errors=[{instancePath:t+"/runtime/permissions/native-addons",schemaPath:"#/properties/runtime/properties/permissions/properties/native-addons/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;y=r===d}else y=!0;if(y)if(void 0!==e.filesystem){const r=d;if("boolean"!=typeof e.filesystem)return a.errors=[{instancePath:t+"/runtime/permissions/filesystem",schemaPath:"#/properties/runtime/properties/permissions/properties/filesystem/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;y=r===d}else y=!0}}}}}g=n===d}else g=!0}}}}}h=s===d}else h=!0;if(h){if(void 0!==e.manufacturer){const r=d;if("string"!=typeof e.manufacturer)return a.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===d}else h=!0;if(h){if(void 0!==e.products){let r=e.products;const n=d;if(d===n){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(r.length<1)return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var b=!0;const e=r.length;for(let n=0;n<e;n++){const e=d;if("string"!=typeof r[n])return a.errors=[{instancePath:t+"/products/"+n,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(b=e===d))break}if(b){let e,n=r.length;if(n>1){const s={};for(;n--;){let i=r[n];if("string"==typeof i){if("number"==typeof s[i])return e=s[i],a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;s[i]=n}}}}}}h=n===d}else h=!0;if(h){if(void 0!==e.keywords){let r=e.keywords;const n=d;if(d===n){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var v=!0;const e=r.length;for(let n=0;n<e;n++){const e=d;if("string"!=typeof r[n])return a.errors=[{instancePath:t+"/keywords/"+n,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(v=e===d))break}if(v){let e,n=r.length;if(n>1){const s={};for(;n--;){let i=r[n];if("string"==typeof i){if("number"==typeof s[i])return e=s[i],a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;s[i]=n}}}}}}h=n===d}else h=!0;if(h)if(void 0!==e.bonjourQueries){let r=e.bonjourQueries;const n=d;if(d===n){if(!r||"object"!=typeof r||Array.isArray(r))return a.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(const e in r)if(o.test(e)){let n=r[e];const i=d,c=d;let u=!1,h=null;const p=d;if(d==d)if(n&&"object"==typeof n&&!Array.isArray(n)){let r;if(void 0===n.type&&(r="type")||void 0===n.protocol&&(r="protocol")){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===l?l=[n]:l.push(n),d++}else{if(void 0!==n.type){const r=d;if("string"!=typeof n.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}var w=r===d}else w=!0;if(w){if(void 0!==n.protocol){let r=n.protocol;const i=d;if("string"!=typeof r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}if("tcp"!==r&&"udp"!==r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:s.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===l?l=[r]:l.push(r),d++}w=i===d}else w=!0;if(w){if(void 0!==n.port){let r=n.port;const s=d;if("number"!=typeof r||!isFinite(r)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===l?l=[r]:l.push(r),d++}w=s===d}else w=!0;if(w)if(void 0!==n.txt){let r=n.txt;const s=d;if(d===s)if(r&&"object"==typeof r&&!Array.isArray(r)){for(const n in r)if(o.test(n)){const s=d;if("string"!=typeof r[n]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+n.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}if(s!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),d++}w=s===d}else w=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),d++}p===d&&(u=!0,h=0);const f=d;if(d===f)if(Array.isArray(n)){const r=n.length;for(let i=0;i<r;i++){let r=n[i];const a=d;if(d==d)if(r&&"object"==typeof r&&!Array.isArray(r)){let n;if(void 0===r.type&&(n="type")||void 0===r.protocol&&(n="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"};null===l?l=[r]:l.push(r),d++}else{if(void 0!==r.type){const n=d;if("string"!=typeof r.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}var C=n===d}else C=!0;if(C){if(void 0!==r.protocol){let n=r.protocol;const o=d;if("string"!=typeof n){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}if("tcp"!==n&&"udp"!==n){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:s.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===l?l=[r]:l.push(r),d++}C=o===d}else C=!0;if(C){if(void 0!==r.port){let n=r.port;const s=d;if("number"!=typeof n||!isFinite(n)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===l?l=[r]:l.push(r),d++}C=s===d}else C=!0;if(C)if(void 0!==r.txt){let n=r.txt;const s=d;if(d===s)if(n&&"object"==typeof n&&!Array.isArray(n)){for(const r in n)if(o.test(r)){const s=d;if("string"!=typeof n[r]){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[n]:l.push(n),d++}if(s!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),d++}C=s===d}else C=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),d++}if(a!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===l?l=[r]:l.push(r),d++}var _;if((_=f===d)&&u?(u=!1,h=[h,1]):_&&(u=!0,h=1),!u){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:h},message:"must match exactly one schema in oneOf"};return null===l?l=[r]:l.push(r),d++,a.errors=l,!1}if(d=c,null!==l&&(c?l.length=c:l=null),i!==d)break}}h=n===d}else h=!0}}}}}}}}}}}}}}}}}return a.errors=l,0===d}},7e3:(e,t,r)=>{"use strict";const n=r(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:r=0,maxWait:s=0,before:i=!1,after:o=!0}=t;if(!i&&!o)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let a,c,u;const l=function(...t){const n=this,l=i&&!a;return clearTimeout(a),a=setTimeout((()=>{a=void 0,c&&(clearTimeout(c),c=void 0),o&&(u=e.apply(n,t))}),r),s>0&&!c&&o&&(c=setTimeout((()=>{c=void 0,a&&(clearTimeout(a),a=void 0),u=e.apply(n,t)}),s)),l&&(u=e.apply(n,t)),u};return n(l,e),l.cancel=()=>{a&&(clearTimeout(a),a=void 0),c&&(clearTimeout(c),c=void 0)},l}},1635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>F,__assign:()=>i,__asyncDelegator:()=>A,__asyncGenerator:()=>E,__asyncValues:()=>I,__await:()=>S,__awaiter:()=>f,__classPrivateFieldGet:()=>R,__classPrivateFieldIn:()=>D,__classPrivateFieldSet:()=>x,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>B,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>s,__generator:()=>m,__importDefault:()=>N,__importStar:()=>T,__makeTemplateObject:()=>k,__metadata:()=>p,__param:()=>c,__propKey:()=>d,__read:()=>v,__rest:()=>o,__rewriteRelativeImportExtension:()=>M,__runInitializers:()=>l,__setFunctionName:()=>h,__spread:()=>w,__spreadArray:()=>_,__spreadArrays:()=>C,__values:()=>b,default:()=>U});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},i.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r}function a(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,s,i){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var m in n)f[m]="access"===m?{}:n[m];for(var m in n.access)f.access[m]=n.access[m];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(e||null))};var g=(0,r[p])("accessor"===c?{get:d.get,set:d.set}:d[u],f);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=o(g.get))&&(d.get=a),(a=o(g.set))&&(d.set=a),(a=o(g.init))&&s.unshift(a)}else(a=o(g))&&("field"===c?s.unshift(a):d[u]=a)}l&&Object.defineProperty(l,n.name,d),h=!0}function l(e,t,r){for(var n=arguments.length>2,s=0;s<t.length;s++)r=n?t[s].call(e,r):t[s].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))}function m(e,t){var r,n,s,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(i=0)),i;)try{if(r=1,n&&(s=2&a[0]?n.return:a[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;switch(n=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((s=(s=i.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){i.label=a[1];break}if(6===a[0]&&i.label<s[1]){i.label=s[1],s=a;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(a);break}s[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,s,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return o}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),s=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function _(e,t,r){if(r||2===arguments.length)for(var n,s=0,i=t.length;s<i;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),i=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",(function(e){return function(t){return Promise.resolve(t).then(e,u)}})),n[Symbol.asyncIterator]=function(){return this},n;function o(e,t){s[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))},t&&(n[e]=t(n[e])))}function a(e,t){try{(r=s[e](t)).value instanceof S?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function A(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,s){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:s?s(t):t}:s}}function I(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,s){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,s,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},P=function(e){return P=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},P(e)};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=P(e),n=0;n<r.length;n++)"default"!==r[n]&&g(t,e,r[n]);return O(t,e),t}function N(e){return e&&e.__esModule?e:{default:e}}function R(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function F(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(s=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var L="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function B(e){function t(t){e.error=e.hasError?new L(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return function s(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(s);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(s,(function(e){return t(e),s()}))}else n|=1}catch(e){t(e)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function M(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(e,r,n,s,i){return r?t?".jsx":".js":!n||s&&i?n+s+"."+i.toLowerCase()+"js":e})):e}const U={__extends:s,__assign:i,__rest:o,__decorate:a,__param:c,__esDecorate:u,__runInitializers:l,__propKey:d,__setFunctionName:h,__metadata:p,__awaiter:f,__generator:m,__createBinding:g,__exportStar:y,__values:b,__read:v,__spread:w,__spreadArrays:C,__spreadArray:_,__await:S,__asyncGenerator:E,__asyncDelegator:A,__asyncValues:I,__makeTemplateObject:k,__importStar:T,__importDefault:N,__classPrivateFieldGet:R,__classPrivateFieldSet:x,__classPrivateFieldIn:D,__addDisposableResource:F,__disposeResources:B,__rewriteRelativeImportExtension:M}},3325:e=>{"use strict";e.exports={rE:"1.3.4"}}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e=r(6278);function t(){let e='You can also use "current", "selected", "previous", "next" or "all"';return{play:{name:"Play",options:[],callback:()=>{this.sendCommand("play")}},toggle_play:{name:"Pause / Resume",options:[],callback:()=>{this.sendCommand("togglePlay")}},stop:{name:"Pause",options:[],callback:()=>{this.sendCommand("stop")}},panic:{name:"Panic",options:[],callback:()=>{this.sendCommand("panic")}},rewind:{name:"Rewind",options:[],callback:()=>{this.sendCommand("rewind")}},jump_prev:{name:"Jump to previous cue",options:[],callback:()=>{this.sendCommand("jumpToPrevCue")}},jump_next:{name:"Jump to next cue",options:[],callback:()=>{this.sendCommand("jumpToNextCue")}},jump_selected:{name:"Jump to selected cue",options:[],callback:()=>{this.sendCommand("jumpToSelectedCue")}},select_prev:{name:"Select previous cue",options:[],callback:()=>{this.sendCommand("selectPrevCue")}},select_next:{name:"Select next cue",options:[],callback:()=>{this.sendCommand("selectNextCue")}},goto_30:{name:"Goto 30",options:[],callback:()=>{this.sendCommand("goto30")}},goto_20:{name:"Goto 20",options:[],callback:()=>{this.sendCommand("goto20")}},goto_10:{name:"Goto 10",options:[],callback:()=>{this.sendCommand("goto10")}},play_select:{name:"Play Selected Cue",options:[{type:"checkbox",label:"Force Cut",tooltip:"Plays cue with an instant cut, regardless of whether a transition is enabled",id:"forceCut",default:!1}],callback:e=>{e.options.forceCut?this.sendCommand("playSelectedCueForceCut"):this.sendCommand("playSelectedCue")}},fullscreenToggle:{name:"Toggle Fullscreen",options:[],callback:()=>{this.sendCommand("toggleFullscreen")}},fullscreenOn:{name:"Fullscreen On",options:[],callback:()=>{this.sendCommand("fullscreenOn")}},fullscreenOff:{name:"Fullscreen Off",options:[],callback:()=>{this.sendCommand("fullscreenOff")}},plLoopToggle:{name:"Toggle Playlist Loop",options:[],callback:()=>{this.sendCommand("toggleLoop")}},plLoopOn:{name:"Playlist Loop On",options:[],callback:()=>{this.sendCommand("loopOn")}},plLoopOff:{name:"Playlist Loop Off",options:[],callback:()=>{this.sendCommand("loopOff")}},plTransToggle:{name:"Toggle Playlist Transition on Play",options:[],callback:()=>{this.sendCommand("toggleTransitionOnPlay")}},plTransOff:{name:"Transition on Play Off",options:[],callback:()=>{this.sendCommand("transitionOnPlayOff")}},plTransOn:{name:"Transition on Play On",options:[],callback:()=>{this.sendCommand("transitionOnPlayOn")}},resendOSCFeedback:{name:"Resend OSC feedback",options:[],callback:()=>{this.sendCommand("resendOSCFeedback")}},jump_cue:{name:"Jump to specific cue",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/jump`)}},jumpCueName:{name:"Jump to cue with name",options:[{type:"textinput",useVariables:!0,label:"Cue Name",id:"string"}],callback:async(e,t)=>{const r=await t.parseVariablesInString(e.options.string);this.sendCommand("jumpToCueWithName",r)}},select_cue:{name:"Select Cue",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/select`)}},play_cue:{name:"Play cue with number / ID",options:[{type:"textinput",useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"1"},{type:"checkbox",label:"Force Cut",tooltip:"Plays cue with an instant cut, regardless of whether a transition is enabled",id:"forceCut",default:!1}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cuenumber);e.options.forceCut?this.sendCommand("playCueWithCueIDForceCut",r):this.sendCommand("playCueWithCueID",r)}},playCueIndex:{name:"Play cue at index",options:[{type:"textinput",tooltip:"Must be a number between 1 and 999",useVariables:!0,label:"Cue index",id:"index",default:"1"},{type:"checkbox",label:"Force Cut",tooltip:"Plays cue with an instant cut, regardless of whether a transition is enabled",id:"forceCut",default:!1}],callback:async(e,t)=>{let r=await t.parseVariablesInString(e.options.index);r=parseInt(r),isNaN(r)||r<1||r>999?this.log("warn","Index must be a number between 1 and 999"):e.options.forceCut?this.sendCommand("playCueAtIndexForceCut",r,"i"):this.sendCommand("playCueAtIndex",r,"i")}},playCueName:{name:"Play cue with name",options:[{type:"textinput",useVariables:!0,label:"Cue Name",id:"string"},{type:"checkbox",label:"Force Cut",tooltip:"Plays cue with an instant cut, regardless of whether a transition is enabled",id:"forceCut",default:!1}],callback:async(e,t)=>{const r=await t.parseVariablesInString(e.options.string);e.options.forceCut?this.sendCommand("playCueWithNameForceCut",r):this.sendCommand("playCueWithName",r)}},audioOn:{name:"Cue Audio On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/audioOn`)}},audioOff:{name:"Cue Audio Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/audioOff`)}},toggleAudio:{name:"Toggle Cue Audio",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/toggleAudio`)}},toggleFadeIn:{name:"Toggle Fade In",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/toggleFadeIn`)}},fadeInOn:{name:"Fade In On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/fadeInOn`)}},fadeInOff:{name:"Fade In Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/fadeInOff`)}},toggleFadeOut:{name:"Toggle Fade Out",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/toggleFadeOut`)}},fadeOutOn:{name:"Fade Out On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/fadeOutOn`)}},fadeOutOff:{name:"Fade Out Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/fadeOutOff`)}},toggleGoto:{name:"Toggle Goto Cue after End",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/toggleGoto`)}},gotoOn:{name:"Goto after End On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/gotoOn`)}},gotoOff:{name:"Goto after End Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/gotoOff`)}},setGotoToCueID:{name:"Set Goto after End Cue",description:"Requires Mitti 2.2.8",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"textinput",useVariables:!0,label:"Goto Cue number or ID",id:"gotoCue",default:"2"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/setGotoToCueID`,`${await this.conformCueID(t,e.options.gotoCue)}`)}},toggleLoop:{name:"Toggle Loop",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/toggleLoop`)}},loopOn:{name:"Loop On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/loopOn`)}},loopOff:{name:"Loop Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/loopOff`)}},togglePauseAtBeginning:{name:"Toggle Pause At Beginning",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/togglePauseAtBeginning`)}},pauseAtBeginningOn:{name:"Pause At Beginning On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/pauseAtBeginningOn`)}},pauseAtBeginningOff:{name:"Pause At Beginning Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/pauseAtBeginningOff`)}},togglePauseAtEnd:{name:"Toggle Pause At End",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/togglePauseAtEnd`)}},pauseAtEndOn:{name:"Pause At End On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/pauseAtEndOn`)}},pauseAtEndOff:{name:"Pause At End Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/pauseAtEndOff`)}},toggleTransition:{name:"Toggle Transition",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/toggleTransition`)}},transitionOn:{name:"Transition On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/transitionOn`)}},transitionOff:{name:"Transition Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/transitionOff`)}},toggleVideoFx:{name:"Toggle VideoFx",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/toggleVideoFx`)}},videoFxOn:{name:"VideoFx On",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/videoFxOn`)}},videoFxOff:{name:"VideoFx Off",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/videoFxOff`)}},scale:{name:"Cue Scale",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Scale (%)",id:"value",default:100,min:0,max:200,isVisible:e=>!e.splitScale},{type:"checkbox",label:"Scale H/V Separately",id:"splitScale",default:!1},{type:"number",label:"Scale H (%)",id:"valueH",default:100,min:0,max:200,isVisible:e=>e.splitScale},{type:"number",label:"Scale V (%)",id:"valueV",default:100,min:0,max:200,isVisible:e=>e.splitScale}],callback:async(e,t)=>{let r=await this.conformCueID(t,e.options.cuenumber);e.options.splitScale?(this.sendCommand(`${r}/scaleHAsPercent`,e.options.valueH),this.sendCommand(`${r}/scaleVAsPercent`,e.options.valueV)):this.sendCommand(`${r}/scaleAsPercent`,e.options.value)}},position:{name:"Cue Position",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"textinput",label:"Position X (pixels, optional)",id:"valueX"},{type:"textinput",label:"Position Y (pixels, optional)",id:"valueY"}],callback:async(e,t)=>{e.options.valueX&&this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/posXAsPixels`,e.options.valueX),e.options.valueY&&this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/posYAsPixels`,e.options.valueY)}},crop:{name:"Cue Crop",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"textinput",label:"Crop Left (pixels, optional)",id:"valueLeft"},{type:"textinput",label:"Crop Right (pixels, optional)",id:"valueRight"},{type:"textinput",label:"Crop Top (pixels, optional)",id:"valueTop"},{type:"textinput",label:"Crop Bottom (pixels, optional)",id:"valueBottom"}],callback:async(e,t)=>{e.options.valueLeft&&this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/cropLeftAsPixels`,e.options.valueLeft),e.options.valueRight&&this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/cropRightAsPixels`,e.options.valueRight),e.options.valueTop&&this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/cropTopAsPixels`,e.options.valueTop),e.options.valueBottom&&this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/cropBottomAsPixels`,e.options.valueBottom)}},rotation:{name:"Cue Rotation",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Degrees (°)",id:"value",default:0,min:-180,max:180}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/rotateAsDegrees`,e.options.value)}},hue:{name:"Cue Hue",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Degrees (°)",id:"value",default:0,min:-180,max:180}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/hueAsDegrees`,e.options.value)}},saturation:{name:"Cue Saturation",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Saturation (%)",id:"value",default:0,min:-100,max:100}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/saturationAsPercent`,e.options.value)}},vibrance:{name:"Cue Vibrance",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Vibrance (%)",id:"value",default:0,min:-100,max:100}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/vibranceAsPercent`,e.options.value)}},brightness:{name:"Cue Brightness",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Brightness (%)",id:"value",default:0,min:-100,max:100}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/brightnessAsPercent`,e.options.value)}},contrast:{name:"Cue Contrast",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Contrast (%)",id:"value",default:0,min:-100,max:100}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/contrastAsPercent`,e.options.value)}},opacity:{name:"Cue Opacity",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Opacity (%)",id:"value",default:100,min:0,max:100}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/opacityAsPercent`,e.options.value)}},volume:{name:"Set Cue Volume to Value",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Volume (db, -60 to 12)",id:"value",default:0,min:-60,max:12}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/volumeAsDecibels`,parseFloat(e.options.value))}},adjustVolume:{name:"Adjust Current Cue Volume",options:[{type:"number",label:"Adjustment Amount (dB)",id:"value",default:1}],callback:async e=>{if(void 0!==this.states.currentCueVolume){let t=this.states.currentCueVolume+parseFloat(e.options.value);t<-60&&(t=-60),t>12&&(t=12),this.sendCommand("current/volumeAsDecibels",t)}}},mainFader:{name:"Master Fader",description:"Requires Mitti 2.2.0",options:[{type:"dropdown",label:"Mode",id:"mode",default:"auto",choices:[{id:"auto",label:"Auto-Fade"},{id:"custom",label:"Custom Value"}]},{type:"number",label:"Fade Value (0 to 100)",id:"value",default:0,min:0,max:100,isVisible:e=>"custom"===e.mode}],callback:e=>{"auto"==e.options.mode?this.sendCommand("autoFade"):this.sendCommand("mainFader",parseFloat(e.options.value/100))}},playhead:{name:"Scrub Playhead by Percent",options:[{type:"number",label:"Adjustment Amount (-100% to 100%)",id:"value",default:1,min:-100,max:100,range:!0,step:1}],callback:e=>{let t=100*(this.states.playhead?this.states.playhead:0)+e.options.value;t=parseFloat(t/100),t<0&&(t=0),t>1&&(t=1),this.sendCommand("playhead",t)}},scrubPlayhead:{name:"Scrub Playhead with Timecode",description:"Requires Mitti 2.8.9",options:[{type:"textinput",label:"Timecode Adjustment",tooltip:"Use + or - to move forward or backward, using the format hh:mm:ss:frames. Ex. +01:00 moves forward 1 seconds",id:"value",default:"+01:00",useVariables:!0}],callback:async(e,t)=>{const r=await t.parseVariablesInString(e.options.value);this.sendCommand("playheadScrub",r)}},playbackSpeed:{name:"Set Cue Playback Speed",options:[{type:"textinput",tooltip:e,useVariables:!0,label:"Cue number or ID",id:"cuenumber",default:"current"},{type:"number",label:"Speed as Percentage (1% to 1200%)",id:"value",default:100,min:1,max:1200,range:!0,step:10}],callback:async(e,t)=>{this.sendCommand(`${await this.conformCueID(t,e.options.cuenumber)}/playbackSpeed`,e.options.value)}},toggleVideoOutputs:{name:"Toggle Video Outputs",description:"Requires Mitti 2.8.0",options:[],callback:()=>{this.sendCommand("toggleVideoOutputs")}},videoOutputsOn:{name:"Video Outputs On",description:"Requires Mitti 2.8.0",options:[],callback:()=>{this.sendCommand("videoOutputsOn")}},videoOutputsOff:{name:"Video Outputs Off",description:"Requires Mitti 2.8.0",options:[],callback:()=>{this.sendCommand("videoOutputsOff")}},toggleAudioOutputs:{name:"Toggle Audio Outputs",description:"Requires Mitti 2.8.9",options:[],callback:()=>{this.sendCommand("toggleAudio")}},audioOutputsOn:{name:"Audio Outputs On",description:"Requires Mitti 2.8.9",options:[],callback:()=>{this.sendCommand("unmuteAudio")}},audioOutputsOff:{name:"Audio Outputs Off",description:"Requires Mitti 2.8.9",options:[],callback:()=>{this.sendCommand("muteAudio")}},setInFromPlayhead:{name:"Set In from Playhead",description:"Requires Mitti 2.8.7",options:[],callback:async()=>{this.sendCommand("setInFromPlayhead")}},setOutFromPlayhead:{name:"Set Out from Playhead",description:"Requires Mitti 2.8.7",options:[],callback:async()=>{this.sendCommand("setOutFromPlayhead")}}}}function n(){const t=(0,e.combineRgb)(255,255,255),r=(0,e.combineRgb)(0,0,0),n=(0,e.combineRgb)(200,0,0),s=(0,e.combineRgb)(0,200,0),i=(0,e.combineRgb)(255,102,0),o=(0,e.combineRgb)(73,165,231),a=(0,e.combineRgb)(77,77,77);let c={playlistGraphicsHeader:{category:"Playlist Actions",name:"Transport Control - Icons",type:"text"},playSelected:{type:"button",category:"Playlist Actions",name:"Play Selected",options:{},style:{png64:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAYAAAATBx+NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFgklEQVR4nO2be2wURRzHvzOzO1tKuttCqQpIoEYeVYto4j8m6h8mGo0haKIJaiAqgmKURFsKhNBARI3xEaP8ocZA0OgfAkZoUw2kJhoeVoFSCyRi1fDoPfZKw9GW7tzM+AdeJVpou/fYvZPP5ZLL7e3Mbz/3m53H7hKtNa5yeWjQAYSdq4JGwPC7o2mamDp1KqIfRushsUCVqwnsLNtXsaRisdYaWmswxsAYgxACjDForSGlBCEEhBAopWAYBrTWUEqBEAKtNSilQ781TRMAIIQY+iylRPrUQCkFpRRSyqE6tNYQQsB1XUgpgxFECEFsU+wHMUvcmZqWuhhsD53p7nQXaKW3Tnxo4gsZRRYSfDcxsoNsEXP+kQMAaoLC4LxBW12nlvds7+k8035mYVaiDBD/56BpeExMF8NuSk1OwZvn1RgRY3NkW+RL33WEAN+CRLWwrrRdWxpejWeKavGI2+ye7t7bvdJvXUHiP4NGuaeqUPDmepPhYWN8W7wVAApp7OVfEMGYjjJVnaJijrgn0ZLoiX8ff6NQJPkX5OP4VJmCV+tV6PG63m1yO33XnUcCGSjKayW8W70a9zu3L7oz+lmYsynQkbSYKUrlFLkw3hw/ETkSWR5kLJcj8KmGrJTwar0bWIK9G98V3x62bApcUBoxUxip6akFiaZEtPtA99qwiAqNIABQ5QrePK8KGo3xb+IHgo4HCJmgNHKKpOJmcUeiNdEb2R35IMhYQikojZgtHOWo56O7okfTM/18E2pBACCvkfBqvTluq9sfa4ptzbek0AtKI2aJcXKKfCK2K9YVPRzN21JKwQgCADlRwpvrzaC99J1EU+IrIPfzuoISlEbcKIzUjNT8RHMiFv0xui6XdRG//wAdoEqP0yTL8YwZdoZplmCHKu+vvD0XS64FmUGXIidL4t3i3RbfE++N7I68n/UK0sbH+ib9REGH68W6mebt/BeksHjSpElDi/+ZvAu+iQ0HP84HtdCbRa1YlulJvOCb2HB4sz0LpVjK9rPGTMsqSkEAIKoF+AW+ItNyirKJXYpGZjEWbQZli+IVpIDSltJkpsX4vvQcZohHwNs5SJI0ZlpW0WUQPUtR0loyaB431zsrnLczLa9oMogIAvOYCaPT2CdqxUtVS6vaUiQ18o4jUBSCWJyBt/Meco685bzsbKSUZu3ICloQ6SPgHRzGCWNPeUP5vVpfnHNkk8IUJAGzywTfz09pS9c5K50vCM3NkmzBCaJJCqvNUuwk+6RsVdkSACA0d+PVwhGUAsxfTfBDvEOX6gZ7td2soUFIbgfzBSGI9lBYh61+epp+5DQ4KyilUFB5qTvUgsgAAe/kMI+aB/of6F9a9XhVO2H5nf6FU5ACjD8MlOwtcUmSbLBftd+zV9nQJP/XxUIniPZR8J85zGPmDnuD/TAhJOtd91gIjyAJmL+bsPZbpzTT9WXryz7PZe80WkIhiCYpeBtXxkljs7PGeVrr3PdOoyVYQZd03cpW9c4apwVAaOQAAQqiZymsg9YAPUk/tlfbL1JKEdQNClci74JI6uKsm3fwtoG7BpZVPVl1MN8xjAX/gny0AuYy8EP8HAbwml1nv27DDrSHGg3+BY1hIEv6CKwOC6yLfWu/Yt+XftonbM1pOPw/7XOBEF06wgH+Peu22qw/tdRr7ZX2ViBcJ+GR8P+82G+mNzhhkF9uO01S8J+4MrqMT8sbyxdlehNBUPhfk46hhbnsP1+TFAE/xjHu63GduIAHnXXOokLKmH/jO4Ocp5z5yS3JTjFL1MjrJaABFmPg7byfJugmu8GuA3K7VpMPfAtSSqHy2cqbks8l62gfvVuZajzrZUfOP3r+TecZ55SfXi6M+L70/H+h6K6LZZurgkbgL2eb8eCICuUqAAAAAElFTkSuQmCC",pngalignment:"center:center",size:"18",color:t,bgcolor:r},steps:[{down:[{actionId:"play_select"}],up:[]}],feedbacks:[]},playPlaylist:{type:"button",category:"Playlist Actions",name:"Play Playlist",options:{},style:{png64:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAYAAAATBx+NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGklEQVR4nO2bv2sUQRTHPxuiCFGiIipCQEsjEcFCEUQEFcHSQkhpAv4FRokpVPyBgrWNoIWCioiFUSRNiKCFIhixMAbUdBHRoOYXhjyLTQgkl3tv797t7d3OZ1g47t7M2/nuzNuZt7eRiBBYnoZqn0DWCQIpNFqMIiKAvcBVoA3iLzLIOHAXuABMWyoISogREfVA2IswjtRMeYzQiIB2aH2PLEE6IhoA9luuSIY4CPRrRtoIssagnUa7LHHAoxGrQLMezlJmyqMRq0AvPJylTJ9HI1aBzgKfPRymRA/wzqMha5AG2Ax0APuAVR7OK8AX4Anw1FpBC9JJBKpLvO5iuSUIpBAEUggCKQSBFIJACqZ0xxwbgJPEe5ysroO+AvdxWkUD5nRHC8Knqicx7KXLkurwTHfcA9rdrko67ALea0ZeC8WjRrssccSjEatASWJVVmjyaMQq0KCHs5QZ8GjEKtAZYMbDYUr0Ai89Gkqymz8MdJPtpxq/gYfA5bnPKpVId6y3OK4SU8BEkgohH6QQ8kFlEgRSCAIpBIEUgkAKSbcQe4DtVHYdNEq8yPtTQR92jOmOlQi3U0xXfETYYUxZbERosqY3kqY7rAL1pCjOfBlEWKN0sBvhJ8IwQns1BRqpgkCCcKxI57Yi/Ftk34ew21Mga5Bea7TzZlOR31az9CZzCHgNXAeaPU7AKtB3D2cl8K3Ib7MU/lvOCuA08BY4UfYZGKdYZxWmVx/xzWG56dFaYIoVKs8R2kqdYlaBIoRzCGMpCDOD0IuwpYg4SQQShL8I1xCakwqUdDffAmyjcilYAX4AHwy2rcRJ+STnMkz836EHCw6V/htHUBaPJCNocXnE3DrL6y5WbxwHXgGnNMNaTpiVMsUWMybIumIGeR1B86j9z7NAk8BFzSivAj0jfnPghmZYi09My2GI+IWcO9YKeRFoErgJXAJ+JamYB4H6WdibJaaeY9AI0En81k9J4kBtj6AGCl/gaeAWcJ5421IWtSzQBCzZSPUDXcAbNy81vBcD4QrCKMIQQkcpbbjs5vNMPQdpF4JACv8BuE1Hc5jPTUQAAAAASUVORK5CYII=",pngalignment:"center:center",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"play"}],up:[]}],feedbacks:[]},pause:{type:"button",category:"Playlist Actions",name:"Pause",options:{},style:{png64:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAYAAAATBx+NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEGklEQVR4nO2bT2hcRRjAf293k22Shka6CaVUbLwURGwg9Nxjz2oLevJaD7npJRja5lYQcvBei4eCQtDqwZ5y8SJLt8WkUNvNZkvYvGjLmrgx2X3/5vOQCFET583uhO3K/GDZy7xvvvm9ebNvlm88EcFxOJluJ/Cyk7Mf0ssdEFeABCS2ED8DeED+H/EBFBDvflt6NESk489uHAZFuLS0xPfPntHY3kaFIbK9japW+e3RI74U4aIIx9rPlYwIZx8/ZvbpU1Y3N4njGAlDxPdpFYv8WK3yvggjInhWxmYjiAjHRLjq+/wSBKiDmjSbJL5PVYQPROhvU86blQrf1usESv27jzBEraywUavxiQgnbUiyJehircavaZqurbEswlsi6dc/ETIbG4z4Pl80GsS6PlZX2VxZ4aoNQRYWaS9XLvNhocBomtYjI4z7Pm9jtv5lkoQLnsfl4WGyusanT3Oi0WAa6DPo4+COOw0A5Pr6uJTP46VpPDBAZmuL90ql9IJKJYZ8n3dGRxlI0z6bhfPneRX0MnXYECRjY5xI29jzoFDg9a2t9OtQpcKgUlzIdjxcc6y8Bw0MpJs9fzE4aPZ6EUXkh4Y4aZaVHawI8oz0ACBxTOr3lFwO8TyUUQeWNghWHjHTZJLErH0+j0B6ofvoWFNXthpxjIqi9MknCRLHGGq1Q1dmUBQhpoLCkHa2Kb05g6IIFQTpkw9DVBAQmPTR02tQGCKtlpmgZpPINDEbdGsNMlLaaqGCgLCNrnrzEdvbvKZOfmcHoqh3F2lj2lnUlTJ7D7JFTwgCUKrzx6UdeuYvV1u/Sqb0jKBu4QRpcII0OEEanCANTpAGJ0iDE6TBCdLgBGlwgjQ4QRqcIA1OkAYnSIMTpMEJ0uAEaXCCNDhBGpwgDU6QBidIgxOkoSsleG2U7LV1jQ26JcjoijDEEzG7xhZWBIWGhSntDFbErObZtA7yMKwIajTMKi9MKzX6+0mUYsfkmmYTeFnqg5484UXatpub8OABpfX19AVRx4/zR7PJD6ur6XMqFtuujP0bNgQlvs9X1Wq6WXH/Pk0RPrt+PX1B1NQU4ZkzfF0s8vvezPhPlpeRhQV+snI+zdJpn7N37vDz+vrBR6H2jirJw4dE164x306eV66QvXWLjxYW2Gk2D0+lXEZmZymfOsUbNsZmRRDAxgYTt2+zuLhIvH8ASiH1OnLvHq2ZGb7p9IbevMmnd++y9fw5av+ZsSBASiWS6WkqhQKTtm6+Z1yiegDe3u+8CK/MzPDx2BiXJyd5bXycvkqFoFikXKvx+dwccx13Bty4wbvDw0xNTDB57hxDtRpJsciLpSW+m59ntl5nbTcfC2OzEeSQ0Bl21zgFcgT1hZ63Fz+72wfJUdShHaGg/wduL6bBCdLwJ2gdQLcfM6oxAAAAAElFTkSuQmCC",pngalignment:"center:center",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"stop"}],up:[]}],feedbacks:[]},jumpPrevious:{type:"button",category:"Playlist Actions",name:"Jump to previous",options:{},style:{png64:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAYAAAATBx+NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGA0lEQVR4nO2aX2hbVRzHv79zc5Obm6RJaptttHPV2VqGgu8Kw4ftQcZEHYMhOodsiA9ue5AhKDjG9qII7mHKXjYfROsfEGT6KIoT1nUSWlr7h7bYtDS7hKZp/jW5957jw5pZ1zQ3yV1uIuQDl8Al95cfn/zOuff8ziUhBNpsD2t2Aq1OW5AFbUEWtAVZ0BZkQVuQBW1BFrjsXHzz5k309fUd7+npuQCgAEDO5XJ/rq6uvh0IBOL1xFQUBZIkgYgA4P5nrQghUCgUkM/nEQ6H64oB2BRERIcVRbkCQC2dk2V5jxAibhjGWSIq1BKPsdYraFuCgsHghVAopG4+53K5IIQ4Njc39zWA36qJI4SAJEno7e2FqqrWF1RmNwA3gASAlN1gtgTt2bOnQ5Kk/5wjIqiq2rG2tvYEqhRkmiaCwWDdw2mDHgD7AZwB4AMwTkTXiehnAHWvp2wJUlXVKBvU5RLBYJBXGycUCoExBhvrwh4A13BPkBsAiGhfsVg8YJrmKQDf1hvY1qDnvLwDIQQ454JzjmoOr9e7bawq8h8EcBXAAWzIKeH1ekOapp2rJ3AJWxVkF845VFWFEKKe6pEBnAdwCsAj5b7gcrkQDoeftJNj0wRxzuFyufDgHFYlLwA4AeCI1Re7u7tt9XOaIkgIAVmWsXPnTuTz+Vqq53EAzwP4GECoUfltpimCDMNAZ2cn/H4/stlstZc9DeDLjU/HcPzJTAgBn88Hv98Pwyh7EyzHfgBfwWE5QBMqqDS8VFVFsVi0+roC4DKAFwFEGp5cGRwVJISA2+1GV1eXVfUQgLdwbzI+5Ehy2+CoICKC2+22WnMxAGcBXCQijzOZbY/jQywSiYBzXlaSEGIAwEkieoeI3Fuvdh5HBXV0dIBzvt2a61lFUa5KkrTP5prsoeKYoNKC9EE4552mab4XDoePBgKBR1tJDuCQIM45uru7t1SOEOK5QCDwQSAQOOjz+eyu5huCYxXk8XggSRKEEGCMIZvNHiKiK5FIZLcsy06lUTOOCCIi5PN5mKYJAOCcPwbgfKvLARwSxBhDIpEotUHAGHuqv7//mYfQPWw4jg2xUu8HAEzTdAshWq8BXQZHkizNO6UDwF+aps3quu7Ez9vCsX9RURT4/X74/X4Eg8HJZDJ5aWpqKl2al1oVxwSV5p+NYcZlWb4Wj8dPRqPR8VQqZacf3VAcE/RgpRCRkCRpaGFh4aXh4eFvYrFYoRWrydGJslyVENGMrusnUqnUmeHh4fl0Ou1kSpY4Kmi7CpEkKef3+z+fnp4+cufOnZ8WFhacTKsijt9qK20Vud3uP7PZ7Gu3bt16f2xsLF1Dx7FhNKXlWgmXy7VSLBYvLS0tvT4xMfFHJpNxKLPyNEWQaZoVF6aMMcEY+yGZTB6KRqNfLC0t6XVuLNqmKU+z1W4UElHSNM03l5eXT09NTTVlAm+KIM45dF2vqr1BRCYRfba4uPjy6Ojojbt37zqQ4b80rYJkWa76hQUiAhFFDcN4dWxs7PTo6Ggil8s5kGkTX8GTJAmqqta09cwYSxWLxcuzs7NHZ2Zmfk8kEg3McOM3G/4L27B5AVsLjDFIkvRLJpN5ZWRk5KOJiYn1Sk/gjLG6Nv/vX2/nYrtwzrFjx477ncZqISIwxrRcLndueXn5jcnJyem1tbWy8efn521NWrYEVfr3N+YNy4MxBo+n7u0v4fF4hjRNO3j79u2hWCy2XmqhFAoFjI+Pp5PJ5MV6gwM2G2aGYUhu99btKyJihUKh6l6qz+ez9QInEf2t6/rxaDR6zDCMw4qi9HHOZ03THOrt7f2u7sCwKSgWi7G9e/duOb++vm4C0KodNrquY2VlxfIBshKMsQKA6yMjI9+vrKxEBgYGFgcHBwt2d0psCYrH4592dXV9snm/a3V1FZqm/bhr165fa0nOMAz09/fDzp2JiKAoStrn86XLVXY92BJkmublTCbjCQaDHwLQ0+k05ubmbhiG8W44HK7pFVyv1wtd16Fpmp2UHjrUqp28VuF/sbPQTNqCLGgLsqAtyIK2IAvagixoC7LgHzSOecpjgD+IAAAAAElFTkSuQmCC",pngalignment:"center:center",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"jump_prev"}],up:[]}],feedbacks:[]},jumpNext:{type:"button",category:"Playlist Actions",name:"Jump to next",options:{},style:{png64:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAYAAAATBx+NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF7ElEQVR4nO2bX2hbVRzHv+fc3HuTm3vzr03rQB21topzIL44mODTBHUvg4H4NhEffBJhMIQ5lOlgTph/YMpQZIIdTEG3oa8yGL4NfJg0TbOkps3aZqVp/i7JveccH2qkZm2T3HT33mG+kJfTc3753U/OPef3+51TIoTAQFuLuu2A1zUA1EEDQB00ANRBA0AdNADUQQNAHeTrZ3ChUEAgEICqqiCE2LLRisOEEGCMoV6v27JTLpcfikQi5zRNexaACUDN5XLvzc3NXdi/f78tm0CfgO6HhBDgnPc6RhVCnJBl+dDGdr/ff44QUgBwxa4/OwUoDGAYQBPAvF0jhBA0Gg0sLCyAMdbLrHxudHT0NZ/vv48TiUS0cDh8Em4BIut6CcARAHsAVAF8CuAagJxNm7AsC8ViEZIkdTvs8bGxsVA7UEmSsHv37pAdP1rqCxBj7HCz2TyvqmpkQ/O3WAf0OmxAEkIgHo9jaGgIa2tr3Q7jPp9v06RS0zSrVx82qq9dLJ/PHwsEApG2ZgXAAQDnATxp5zs45wgEAuCcd/sRWyXdva5n7eoLUDQafaL9vd+glwFcB/AhALkXu0IICCHg9/v7fsB+1RegeDzeqVYyBOBdAFNYB9aTJEmCz+dzFZJTgeJhAN8DeAPAY90MEEJAVVXs2rULsizDrbqVk5F0BMDXAH4GsLebAZxz6LqOUCgEy+prrbUtN1KNvQAuAnihm86WZUHXdQSDQVdmkVu52B4Al7C+0/m368g5h6Zprr1mbiarIwDeBPADgLcAbBk2W5aF4eFhKIriOCTXczFCyEEhxAEAGoCzADbdsiilUBTF8bXIE+UOQohKCDkF4LQQYnKzPpxzjIyMOOyZRwABACFEkSTpqN/v/wnApvUJzjlCob5Sq57lGUDAeqJqGMZT0Wh0ijF2hnMea+8TDofBGHPMJ08BAtYhRaPRR2Ox2FHDMC4KIZ5v/3s8HncsuvYcIGAdgq7rGB4efrHRaExVq9WDkiSBUgpJkqCqqmO+eBJQS7IsIxqNPmJZ1gelUmmsVquhWq3i7t27tku8vcr1bb6TNE2DruvPzM7OPs05z1BKQQhxLHD0PCAAEEJQxpgCAIwxUOrcxPc8INM0kc/nbwGYboGhlDoWUXsaEGMMMzMz5bW1tVPhcDjRgsI5dyyi9iQgIQRKpRJSqdSfhULhpGEYlwCI1tbuZD7mOUCMMeRyucbMzMzlSqVyPBKJzLbvWE4Gip4CVC6XcfPmzYyu6x+bpvkdIaTW3sfpbN4zcVA2m8WNGzd+TSaTh3Vd/0qSpHvgAM7OHsADM8iyLExPT5cTicRpTdO+VBRl9X4d4diRq4AqlQrS6fTvt2/fPtNsNi+HQqFt3x83KoquAOKcY3Fx0cxkMlOMsXcopYXtgj9CCBhj/w9A5XIZCwsLmWq1eoYxdp4Q0nFRaR0kuiFHAS0vLyOVSv1Sq9WOx2KxP7pJOAkhME2zl4sMOypHANVqNaRSqZV8Pn9SluULhJBiN3CEEKCUunpweN8BraysIJfLXU+n0ydUVf2tl1qOJEnQNA2EkAcTEKV0y3n/Tx5Vz2azXxiG8YkkSfles3BKKSilD+7ZfCaTWd7M+VKphEQikVxcXDxSq9WOUUrzvRS4hBCQJAmjo6Ou3+7o9xLnR9Vq9ezk5KShqipM08TS0lI9mUxeppQeU1X1L7u2VVXdkbpPvzb6vYL3TSaTKWaz2VcppeP1en3O5/NdkWX5ot/vb9i1SylFMBjs5carTAjZlIRlWZKiKHZd6RsQZFn+MZFIXE0mkw/HYrH8vn37ynZ/tVZAuLq6Csuyul6YCSH5er3OQqHQPc8zPz9Px8fHbfkD7NAupihKIxgM3vL7/X0V003TxMTEBMLhMLa5uXaPhBDX8vn8VUVRDkUikX/bi8UilpaWPnMd0E6pdXJqGEavFcPinTt33k6n082JiYlXDMMAALlSqbzPGPu8H5/I4D8Ot5dn6kFe1QBQBw0AddAAUAcNAHXQAFAHDQB10N9m3oDFK0F4TAAAAABJRU5ErkJggg==",pngalignment:"center:center",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"jump_next"}],up:[]}],feedbacks:[]},pauseResume:{type:"button",category:"Playlist Actions",name:"Pause / Resume",options:{},style:{png64:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAYAAAATBx+NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEpklEQVR4nO2aT28bRRjGn5mddYydP1aICFRJLVe0UaSoUosEB07wDbgg8QF6ipB6QUgcuHAAiRNfgIoDQhx6I1WhEKtpSxWQogYiAk0ICYHUponrTepkbc/My4EiJf63HnvXa9D+rD1k993nfffxeDIzO4yIENEcHnYB/U5kkAeRQR5EBnkQGeRBZJAHkUEeRAZ58J8w6OFDdlAuswOtGbkuc/J59qgbvVyO5V2XOQCjSoU5uRzbbhbLakfSdt7+TI7LlwAkQNjhDndUSr3STUGdUiiwpeFhTAkBDWDw2KX9SgUiFqOkqebjx2xvcBACwPBxvXIZ+wMDNFl3AxGdOEDYAJ34lCBxW2yJW7WxQR7b23i3VMJei5Cq4yBvolko4BERjppcLheLeFB7stFPLFPzdwIWXpan5aR1YN02/cY6JZHAxXgciRYhIpnEgYlmKoUcgHiTy7GREYzWnjTpg9J6SL/ANNsWD8RNk8I6IZXCIOdNHwYAYFkYMtFkzPN5Y7UnTDvpODgm1HNqipf5or1lf2N4f9twDrudMEPZOgP8TvAv4zRAL8q0zFj71vcdarSkzVUYGUTu43T7bz6jh/UMr/JlkRO3fKnIjLJhvLGhfoyD4mTTefWsOmsVrSUf9AAARGinDbmGsi3jG7VaYZigFeM6pYeYZEu8yKHG1EUftRtCBJcxo1sOTXP4PZJOQOCCHtNnmGLL9pb9pc/6JyAy/smYtrjAphojsHBepuVZsSsC6cQBgDFjgyqmOYKei2XUmDrDXf6jvWnP+S3ewfsGbXpDLyaroxSnGZmW0/yA+9aJd0hfGvQPDBkaohle5Uv2lv11z/J2Sa+XO2yy6YJMyzPWvrXW49wdEdZ6UEYP6wlGbMP6y7+xUxCEuWAWB0NGP6PTvMqXYpsx3ztxP/BzoNgpo2TTqJyU7UxOe07fLLmSRdNh19CIvjEIgBV2AY3oJ4O2wi6gEf1gkAJwV/wuAlt864awO+kdfsTvqKfU6zgdciVNCMugQwALYkesV09V3wyphrYIw6AV7vDrakS9hVMhZDeklwY5TLEFsS5WKlOVd3qYtyt6ZdAPfJdn1Zi6jKkeZfSJoA36AxJz9prtVqYrlwPOFQhBGaRAuGH9aS3ICfk++nKM3B5BGLTKSuyOTupLmAhAvcf4OVCsApiz1+2rOqkv+agbKn61oFVe4lmVVLN43ifFPqHbFuSwKrsr7ovrKqlmfakoWIyft5sWtGLtWQvyaTmLc12oNKGdF4Jt7NaoxXjRvhOD8kyzrFgThcpUJbBWc3SEXDwOcH+n0y0N0hquVbPoYpJeAfjKylkfa67fCNIcANjcxK6U+KVFyGGh0PJ6HXt70Gj++tl1HNRvEGuwBa9YswWPQNhgJfZpL7fgLS7itXv38B0Rfm4UojXmO9FVCtkml240OtnIoJsn9icSvhCb4r1emnP8WF7Gt0S4SoT1J/sLfzo8xJVr1/B2J3rz8/jAdfE5EX59oreqFD7JZvFqo/i6Xa6x+7EPq+eqvwHgvMgtlVIfmTTj/xt1BkWcpB+WXPuayCAPIoM8iAzyIDLIg8ggDyKDPIgM8uBvpT6a+TZm4bEAAAAASUVORK5CYII=",pngalignment:"center:center",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggle_play"}],up:[]}],feedbacks:[{feedbackId:"playStatus",options:{playPause:"Playing"},style:{bgcolor:(0,e.combineRgb)(0,255,0)}},{feedbackId:"playStatus",options:{playPause:"Paused"},style:{bgcolor:(0,e.combineRgb)(255,255,0)}}]},playlistTextHeader:{category:"Playlist Actions",name:"Transport Control - Text",type:"text"},playSelectedText:{type:"button",category:"Playlist Actions",name:"Play Selected",options:{},style:{text:"Play Selected",size:"14",color:t,bgcolor:s},steps:[{down:[{actionId:"play_select"}]}],feedbacks:[]},playPlaylistText:{type:"button",category:"Playlist Actions",name:"Play Playlist",options:{},style:{text:"Play Playlist",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"play"}],up:[]}],feedbacks:[]},pauseText:{type:"button",category:"Playlist Actions",name:"Pause",options:{},style:{text:"Pause",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"stop"}],up:[]}],feedbacks:[]},pauseResumeText:{type:"button",category:"Playlist Actions",name:"Pause / Resume",options:{},style:{text:"Pause / Resume",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggle_play"}],up:[]}],feedbacks:[]},rewindText:{type:"button",category:"Playlist Actions",name:"Rewind",options:{},style:{text:"Rewind",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"rewind"}],up:[]}],feedbacks:[]},panic:{type:"button",category:"Playlist Actions",name:"Panic",options:{},style:{text:"Panic",size:"14",color:t,bgcolor:n},steps:[{down:[{actionId:"panic"}],up:[]}],feedbacks:[]},goTo30:{type:"button",category:"Playlist Actions",name:"Goto 30",options:{},style:{text:"Goto\\n30",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"goto_30"}],up:[]}],feedbacks:[]},goTo20:{type:"button",category:"Playlist Actions",name:"Goto 20",options:{},style:{text:"Goto\\n20",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"goto_20"}],up:[]}],feedbacks:[]},goTo10:{type:"button",category:"Playlist Actions",name:"Goto 10",options:{},style:{text:"Goto\\n10",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"goto_10"}],up:[]}],feedbacks:[]},scrubPlayheadRotary:{type:"button",category:"Playlist Actions",name:"Scrub Playhead - Rotary Knob",options:{rotaryActions:!0},style:{text:"Scrub Playhead- Rotary Knob",size:"12",color:t,bgcolor:r},steps:[{down:[{actionId:"scrubPlayhead",options:{value:"+01:00"}}],up:[],rotate_left:[{actionId:"scrubPlayhead",options:{value:"-01:00"}}],rotate_right:[{actionId:"scrubPlayhead",options:{value:"+01:00"}}]}],feedbacks:[]},scrubPlayheadMinusOne:{type:"button",category:"Playlist Actions",name:"SCRUB -1 Seconds",options:{},style:{text:"SCRUB\n-1\nSeconds",size:"12",color:t,bgcolor:r},steps:[{down:[{actionId:"scrubPlayhead",options:{value:"-01:00"}}],up:[]}],feedbacks:[]},scrubPlayheadPlusOne:{type:"button",category:"Playlist Actions",name:"SCRUB +1 Seconds",options:{},style:{text:"SCRUB\n+1\nSeconds",size:"12",color:t,bgcolor:r},steps:[{down:[{actionId:"scrubPlayhead",options:{value:"+01:00"}}],up:[]}],feedbacks:[]},playlistTextMainHeader:{category:"Playlist Actions",name:"Playlist Settings",type:"text"},togglePlaylistLoop:{type:"button",category:"Playlist Actions",name:"Toggle Playlist Loop",options:{},style:{text:"Toggle\\nPlaylist\\nLoop",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"plLoopToggle"}],up:[]}],feedbacks:[]},playlistLoopOn:{type:"button",category:"Playlist Actions",name:"Playlist Loop On",options:{},style:{text:"Playlist\\nLoop\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"plLoopOn"}],up:[]}],feedbacks:[]},playlistLoopOff:{type:"button",category:"Playlist Actions",name:"Playlist Loop Off",options:{},style:{text:"Playlist\\nLoop\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"plLoopOff"}],up:[]}],feedbacks:[]},toggleTransitionOnPlay:{type:"button",category:"Playlist Actions",name:"Toggle Transition on Play",options:{},style:{text:"Toggle\\nTransition",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"plTransToggle"}],up:[]}],feedbacks:[]},transitionOnPlayOff:{type:"button",category:"Playlist Actions",name:"Transition on Play Off",options:{},style:{text:"Playlist\\nTransition\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"plTransOff"}],up:[]}],feedbacks:[]},transitionOnPlayOn:{type:"button",category:"Playlist Actions",name:"Transition on Play On",options:{},style:{text:"Playlist\\nTransition\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"plTransOn"}],up:[]}],feedbacks:[]},playlistTextCueNavHeader:{category:"Playlist Actions",name:"Cue Navigation",type:"text"},jumpPreviousText:{type:"button",category:"Playlist Actions",name:"Jump to previous",options:{},style:{text:"Jump to previous",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"jump_prev"}],up:[]}],feedbacks:[]},jumpNextText:{type:"button",category:"Playlist Actions",name:"Jump to next",options:{},style:{text:"Jump to next",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"jump_next"}],up:[]}],feedbacks:[]},jumpSelected:{type:"button",category:"Playlist Actions",name:"Jump to selected",options:{},style:{text:"Jump\\nSelected",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"jump_selected"}],up:[]}],feedbacks:[]},selectPrevious:{type:"button",category:"Playlist Actions",name:"Select previous",options:{},style:{text:"Select\\nPrevious",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"select_prev"}],up:[]}],feedbacks:[]},selectNext:{type:"button",category:"Playlist Actions",name:"Select next",options:{},style:{text:"Select\\nNext",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"select_next"}],up:[]}],feedbacks:[]},playCue:{type:"button",category:"Cue Actions",name:"Play Cue",options:{},style:{text:"Play\\nCue\\n(Number)",size:"14",color:t,bgcolor:s},steps:[{down:[{actionId:"play_cue",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},jumpToCueWithNamePlay:{type:"button",category:"Cue Actions",name:"Jump to cue with (name) and Play",options:{},style:{text:"Play\\nCue\\n(Name)",size:"14",color:t,bgcolor:s},steps:[{down:[{actionId:"playCueName",options:{string:""}}],up:[]}],feedbacks:[]},jumpToCueWithName:{type:"button",category:"Cue Actions",name:"Jump to cue with name",options:{},style:{text:"Jump\\nCue\\n(Name)",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"jumpCueName",options:{string:""}}],up:[]}],feedbacks:[]},jumpToSpecificCue:{type:"button",category:"Cue Actions",name:"Jump to specific cue",options:{},style:{text:"Jump\\nCue\\n(Number)",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"jump_cue",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},selectCue:{type:"button",category:"Cue Actions",name:"Select cue",options:{},style:{text:"Select\\nCue\\n(Number)",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"select_cue",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},currentPlaybackHeader:{category:"Current Cue Actions",name:"Cue Playback Options",type:"text"},toggleFadeIn:{type:"button",category:"Current Cue Actions",name:"Toggle Fade In",options:{},style:{text:"Toggle\\nFade\\nIn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggleFadeIn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},fadeInOn:{type:"button",category:"Current Cue Actions",name:"Fade In On",options:{},style:{text:"Fade\\nIn\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"fadeInOn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},fadeInOff:{type:"button",category:"Current Cue Actions",name:"Fade In Off",options:{},style:{text:"Fade\\nIn\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"fadeInOff",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},toggleFadeOut:{type:"button",category:"Current Cue Actions",name:"Toggle Fade Out",options:{},style:{text:"Toggle\\nFade\\nOut",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggleFadeOut",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},fadeOutOn:{type:"button",category:"Current Cue Actions",name:"Fade Out On",options:{},style:{text:"Fade\\nOut\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"fadeOutOn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},fadeOutOff:{type:"button",category:"Current Cue Actions",name:"Fade Out Off",options:{},style:{text:"Fade\\nOut\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"fadeOutOff",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},toggleLoop:{type:"button",category:"Current Cue Actions",name:"Toggle Loop",options:{},style:{text:"Toggle\\nLoop",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggleLoop",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},loopOn:{type:"button",category:"Current Cue Actions",name:"Loop On",options:{},style:{text:"Loop\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"loopOn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},loopOff:{type:"button",category:"Current Cue Actions",name:"Loop Off",options:{},style:{text:"Loop\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"loopOff",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},togglePauseAtBeginning:{type:"button",category:"Current Cue Actions",name:"Toggle Pause at Beginning",options:{},style:{text:"Toggle\\nPause\\nBeginning",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"togglePauseAtBeginning",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},pauseAtBeginningOn:{type:"button",category:"Current Cue Actions",name:"Pause At Beginning On",options:{},style:{text:"Pause\\nBeginning\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"pauseAtBeginningOn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},pauseAtBeginningOff:{type:"button",category:"Current Cue Actions",name:"Pause At Beginning Off",options:{},style:{text:"Pause\\nBeginning\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"pauseAtBeginningOff",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},togglePauseAtEnd:{type:"button",category:"Current Cue Actions",name:"Toggle Pause at End",options:{},style:{text:"Toggle\\nPause\\nEnd",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"togglePauseAtEnd",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},pauseAtEndOn:{type:"button",category:"Current Cue Actions",name:"Pause At End On",options:{},style:{text:"Pause\\nEnd\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"pauseAtEndOn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},pauseAtEndOff:{type:"button",category:"Current Cue Actions",name:"Pause At End Off",options:{},style:{text:"Pause\\nEnd\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"pauseAtEndOff",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},toggleTransition:{type:"button",category:"Current Cue Actions",name:"Toggle Transition",options:{},style:{text:"Toggle\\nTransition",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggleTransition",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},transitionOn:{type:"button",category:"Current Cue Actions",name:"Transition On",options:{},style:{text:"Transition\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"transitionOn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},transitionOff:{type:"button",category:"Current Cue Actions",name:"Transition Off",options:{},style:{text:"Transition\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"transitionOff",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},toggleVideoFX:{type:"button",category:"Current Cue Actions",name:"Toggle VideoFx",options:{},style:{text:"Toggle\\nVideoFx",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggleVideoFx",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},videoFXOn:{type:"button",category:"Current Cue Actions",name:"VideoFx On",options:{},style:{text:"VideoFx\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"videoFxOn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},videoFXOff:{type:"button",category:"Current Cue Actions",name:"VideoFx Off",options:{},style:{text:"VideoFx\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"videoFxOff",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},currentInOutHeader:{category:"Current Cue Actions",name:"Cue In / Out",type:"text"},setInFromPlayhead:{type:"button",category:"Current Cue Actions",name:"Set In From Playhead",options:{},style:{text:"Set IN From Playhead",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"setInFromPlayhead",options:{}}],up:[]}],feedbacks:[{feedbackId:"inFromPlayheadEnabled",options:{},isInverted:!0,style:{bgcolor:a}}]},setOutFromPlayhead:{type:"button",category:"Current Cue Actions",name:"Set Out From Playhead",options:{},style:{text:"Set OUT From Playhead",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"setOutFromPlayhead",options:{}}],up:[]}],feedbacks:[{feedbackId:"outFromPlayheadEnabled",options:{},isInverted:!0,style:{bgcolor:a}}]},currentCueVolumeHeader:{category:"Current Cue Actions",name:"Cue Audio / Volume",type:"text"},toggleAudio:{type:"button",category:"Current Cue Actions",name:"Toggle Audio",options:{},style:{text:"Toggle\\nAudio",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggleAudio",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},audioOn:{type:"button",category:"Current Cue Actions",name:"Audio On",options:{},style:{text:"Audio\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"audioOn",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},audioOff:{type:"button",category:"Current Cue Actions",name:"Audio Off",options:{},style:{text:"Audio\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"audioOff",options:{cuenumber:"current"}}],up:[]}],feedbacks:[]},currentCueVolumeRotary:{type:"button",category:"Current Cue Actions",name:"Cue Volume - Rotary Knob",options:{rotaryActions:!0},style:{text:"Cue Volume - Rotary Knob",size:"12",color:t,bgcolor:r},steps:[{down:[{actionId:"volume",options:{cuenumber:"current",value:0}}],up:[],rotate_left:[{actionId:"adjustVolume",options:{value:"-1"}}],rotate_right:[{actionId:"adjustVolume",options:{value:"1"}}]}],feedbacks:[]},currentCueVolumeMinusOne:{type:"button",category:"Current Cue Actions",name:"Current Cue -1 dB",options:{},style:{text:"Current Cue\n -1 dB",size:"12",color:t,bgcolor:r},steps:[{down:[{actionId:"adjustVolume",options:{value:"-1"}}],up:[]}],feedbacks:[]},currentCueVolumePlusOne:{type:"button",category:"Current Cue Actions",name:"Current Cue +1 dB",options:{},style:{text:"Current Cue\n +1 dB",size:"12",color:t,bgcolor:r},steps:[{down:[{actionId:"adjustVolume",options:{value:"1"}}],up:[]}],feedbacks:[]},currentCueStatus:{type:"button",category:"Playlist Status",name:"Current Cue",options:{},style:{text:"Current:\\n$(mitti:currentCueName)",size:"auto",color:t,bgcolor:r},steps:[{}],feedbacks:[]},previousCueStatus:{type:"button",category:"Playlist Status",name:"Previous Cue",options:{},style:{text:"Prev:\\n$(mitti:previousCueName)",size:"auto",color:t,bgcolor:r},steps:[{}],feedbacks:[]},nextCueStatus:{type:"button",category:"Playlist Status",name:"Next Cue",options:{},style:{text:"Next:\\n$(mitti:nextCueName)",size:"auto",color:t,bgcolor:r},steps:[{}],feedbacks:[]},playStauts:{type:"button",category:"Playlist Status",name:"Play Status",options:{},style:{text:"$(mitti:playStatus)",size:"18",color:t,bgcolor:r},steps:[{}],feedbacks:[{feedbackId:"playStatus",options:{playPause:"Playing"},style:{bgcolor:s,color:t}}]},currentCueTRT:{type:"button",category:"Playlist Status",name:"Current Cue - Total Run Time",options:{},style:{text:"TRT:\\n$(mitti:currentCueTRT)",size:"14",color:t,bgcolor:r},steps:[{}],feedbacks:[]},currentCueTimeRemaining:{type:"button",category:"Playlist Status",name:"Current Cue - Time Remaining",options:{},style:{text:"Remaining$(mitti:cueTimeLeft)",size:"14",color:t,bgcolor:r},steps:[{}],feedbacks:[{feedbackId:"timeRemaining",options:{time:10},style:{bgcolor:i}},{feedbackId:"timeRemaining",options:{time:5},style:{bgcolor:n}},{feedbackId:"timeRemaining",options:{time:4},style:{bgcolor:r}},{feedbackId:"timeRemaining",options:{time:3},style:{bgcolor:n}},{feedbackId:"timeRemaining",options:{time:2},style:{bgcolor:r}},{feedbackId:"timeRemaining",options:{time:1},style:{bgcolor:n}},{feedbackId:"timeRemaining",options:{time:0},style:{bgcolor:r}}]},videoOutputHeader:{category:"Outputs",name:"Video Outputs",type:"text"},videoOutputsActive:{type:"button",category:"Outputs",name:"Video Outputs Active",options:{},style:{text:"Video Outputs:\\n$(mitti:video_outputs)",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggleVideoOutputs",options:{}}],up:[]}],feedbacks:[{feedbackId:"videoOutputs",options:{},style:{bgcolor:s,color:t}},{feedbackId:"videoOutputs",options:{},isInverted:!0,style:{bgcolor:i,color:t}}]},videoOutputsOn:{type:"button",category:"Outputs",name:"Video Outputs On",options:{},style:{text:"ENABLE\\nVideo Outputs",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"videoOutputsOn",options:{}}],up:[]}],feedbacks:[{feedbackId:"videoOutputs",options:{},style:{bgcolor:a}}]},videoOutputsOff:{type:"button",category:"Outputs",name:"Video Outputs Off",options:{},style:{text:"DISABLE\\nVideo Outputs",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"videoOutputsOff",options:{}}],up:[]}],feedbacks:[{feedbackId:"videoOutputs",options:{},isInverted:!0,style:{bgcolor:a}}]},toggleFullscreen:{type:"button",category:"Outputs",name:"Toggle Fullscreen",options:{},style:{text:"Toggle\\nFullscreen",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"fullscreenToggle"}],up:[]}],feedbacks:[]},fullscreenOn:{type:"button",category:"Outputs",name:"Fullscreen On",options:{},style:{text:"Fullscreen\\nOn",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"fullscreenOn"}],up:[]}],feedbacks:[]},fullscreenOff:{type:"button",category:"Outputs",name:"Fullscreen Off",options:{},style:{text:"Fullscreen\\nOff",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"fullscreenOff"}],up:[]}],feedbacks:[]},audioOutputHeader:{category:"Outputs",name:"Audio Outputs",type:"text"},audioOutputsActive:{type:"button",category:"Outputs",name:"Audio Outputs Active",options:{},style:{text:"Audio Outputs:\\n$(mitti:audio_outputs)",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"toggleAudioOutputs",options:{}}],up:[]}],feedbacks:[{feedbackId:"audioOutputs",options:{},style:{bgcolor:s,color:t}},{feedbackId:"audioOutputs",options:{},isInverted:!0,style:{bgcolor:i,color:t}}]},audioOutputsOn:{type:"button",category:"Outputs",name:"Audio Outputs On",options:{},style:{text:"ENABLE\\nAudio Outputs",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"audioOutputsOn",options:{}}],up:[]}],feedbacks:[{feedbackId:"audioOutputs",options:{},style:{bgcolor:a}}]},audioOutputsOff:{type:"button",category:"Outputs",name:"Audio Outputs Off",options:{},style:{text:"DISABLE\\nAudio Outputs",size:"14",color:t,bgcolor:r},steps:[{down:[{actionId:"audioOutputsOff",options:{}}],up:[]}],feedbacks:[{feedbackId:"audioOutputs",options:{},isInverted:!0,style:{bgcolor:a}}]}};for(let e in this.cues)c[`playCueID_${e}`]={type:"button",category:"Play Cue by ID",name:`Play Cue ${e}`,options:{},style:{text:`Play\\n$(mitti:cue_${e}_cueName)`,size:"auto",color:t,bgcolor:r},steps:[{down:[{actionId:"play_cue",options:{cuenumber:`${e}`}}],up:[]}],feedbacks:[{feedbackId:"selectedCueID",options:{cueID:`${e}`},style:{bgcolor:a}},{feedbackId:"activeCueID",options:{cueID:`${e}`},style:{bgcolor:o}},{feedbackId:"playingCueID",options:{cueID:`${e}`},style:{bgcolor:s}}]};return c}function s(){const e=[];e.push({name:"Name of the playing cue",variableId:"currentCueName"}),e.push({name:"Cue ID of the playing cue",variableId:"currentCueID"}),e.push({name:"Previous cue in playlist",variableId:"previousCueName"}),e.push({name:"Next cue in playlist",variableId:"nextCueName"}),e.push({name:"Name of currently selected cue",variableId:"selectedCueName"}),e.push({name:"Cue ID of the currently selected cue",variableId:"selectedCueID"}),e.push({name:"Play/ Pause Status",variableId:"playStatus"}),e.push({name:"Time remaining for current cue, will shorten to -MM:SS if less than 1 hour",variableId:"cueTimeLeft"}),e.push({name:"Time remaining for current cue, will always show full -HH:MM:SS timecode",variableId:"cueTimeLeft_hhmmss"}),e.push({name:"Time remaining for current cue (hours)",variableId:"cueTimeLeft_h"}),e.push({name:"Time remaining for current cue (minutes)",variableId:"cueTimeLeft_m"}),e.push({name:"Time remaining for current cue (seconds)",variableId:"cueTimeLeft_s"}),e.push({name:"Time elapsed for current cue, will shorten to -MM:SS if less than 1 hour",variableId:"cueTimeElapsed"}),e.push({name:"Time elapsed for current cue, will always show full -HH:MM:SS timecode",variableId:"cueTimeElapsed_hhmmss"}),e.push({name:"Time elapsed for current cue (hours)",variableId:"cueTimeElapsed_h"}),e.push({name:"Time elapsed for current cue (minutes)",variableId:"cueTimeElapsed_m"}),e.push({name:"Time elapsed for current cue (seconds)",variableId:"cueTimeElapsed_s"}),e.push({name:"Total run time (TRT) for current cue, will shorten to MM:SS if less than 1 hour",variableId:"currentCueTRT"}),e.push({name:"Total run time (TRT) for current cue, will always show full HH:MM:SS timecode",variableId:"currentCueTRT_hhmmss"}),e.push({name:"Total run time (TRT) for current cue (hours)",variableId:"currentCueTRT_h"}),e.push({name:"Total run time (TRT) for current cue (minutes)",variableId:"currentCueTRT_m"}),e.push({name:"Total run time (TRT) for current cue (seconds)",variableId:"currentCueTRT_s"}),e.push({name:"Audio mute status for current cue",variableId:"currentCueAudio"}),e.push({name:"Audio volume for current cue in dB",variableId:"currentCueVolume"}),e.push({name:"Pause At Beginning status for current cue",variableId:"currentCuePauseAtBeginning"}),e.push({name:"Pause At End status for current cue",variableId:"currentCuePauseAtEnd"}),e.push({name:"Fade In status for current cue",variableId:"currentCueFadeIn"}),e.push({name:"Fade Out status for current cue",variableId:"currentCueFadeOut"}),e.push({name:"Loop status for current cue",variableId:"currentCueLoop"}),e.push({name:"Transition status for current cue",variableId:"currentCueTransition"}),e.push({name:"Goto status for current cue",variableId:"currentCueGoto"}),e.push({name:"Current status of video outputs",variableId:"video_outputs"}),e.push({name:"Current status of audio outputs",variableId:"audio_outputs"}),this.setVariableValues({currentCueName:"None",currentCueID:"None",previousCueName:"None",nextCueName:"None",selectedCueName:"None",selectedCueID:"None",playStatus:"Paused",cueTimeLeft:"-00:00:00",cueTimeLeft_hhmmss:"-00:00:00",cueTimeLeft_h:"00",cueTimeLeft_m:"00",cueTimeLeft_s:"00",cueTimeElapsed:"-00:00:00",cueTimeElapsed_hhmmss:"-00:00:00",cueTimeElapsed_h:"00",cueTimeElapsed_m:"00",cueTimeElapsed_s:"00",currentCueTRT:"00:00:00",currentCueTRT_hhmmss:"00:00:00",currentCueTRT_h:"00",currentCueTRT_m:"00",currentCueTRT_s:"00",currentCueAudio:"",currentCuePauseAtBeginning:"",currentCuePauseAtEnd:"",currentCueFadeIn:"",currentCueFadeOut:"",currentCueLoop:"",currentCueTransition:"",currentCueGoto:"",video_outputs:this.states?.videoOutputs?"Active":"Off",audio_outputs:this.states?.audioOutputs?"Active":"Off"});for(let t in this.cues){let r=this.cues[t];e.push({name:`Cue ${t} - Name`,variableId:`cue_${t}_cueName`}),this.setVariableValues({[`cue_${t}_cueName`]:r?.cueName})}return e}function i(){const t={},r=(0,e.combineRgb)(0,200,0),n=(0,e.combineRgb)(255,102,0),s=(0,e.combineRgb)(73,165,231),i=(0,e.combineRgb)(77,77,77);return t.playStatus={type:"boolean",name:"Play/Pause Status",description:"Change style based on Play/Pause status",defaultStyle:{bgcolor:r},options:[{type:"dropdown",label:"Status",id:"playPause",default:"Playing",choices:[{id:"Playing",label:"Playing"},{id:"Paused",label:"Paused"}]}],callback:e=>this.states.playing===e.options.playPause},t.playingCueName={type:"boolean",name:"Cue Name - Playing",description:"Change style based on play status of cue name",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue Name",id:"cueName",default:""}],callback:async(e,t)=>{const r=await t.parseVariablesInString(e.options.cueName);return"Playing"==this.states.playing&&this.states.currentCueName==r}},t.activeCueName={type:"boolean",name:"Cue Name - Active",description:"Change style based on active status of cue name",defaultStyle:{bgcolor:s},options:[{type:"textinput",useVariables:!0,label:"Cue Name",id:"cueName",default:""}],callback:async(e,t)=>{const r=await t.parseVariablesInString(e.options.cueName);return this.states.currentCueName==r}},t.selectedCueName={type:"boolean",name:"Cue Name - Selected",description:"Change style based on selected status of cue name",defaultStyle:{bgcolor:i},options:[{type:"textinput",useVariables:!0,label:"Cue Name",id:"cueName",default:""}],callback:async(e,t)=>{const r=await t.parseVariablesInString(e.options.cueName);return this.states.selectedCueName==r}},t.playingCueID={type:"boolean",name:"Cue ID - Playing",description:"Change style based on play status of cue ID. Requires Mitti 2.1.0",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return"Playing"==this.states.playing&&this.states.currentCueID==r}},t.activeCueID={type:"boolean",name:"Cue ID - Active",description:"Change style based on active status of cue ID. Requires Mitti 2.1.0",defaultStyle:{bgcolor:s},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.states.currentCueID==r}},t.selectedCueID={type:"boolean",name:"Cue ID - Selected",description:"Change style based on selected status of cue ID. Requires Mitti 2.1.0",defaultStyle:{bgcolor:i},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.states.selectedCueID==r}},t.cueAudioStatus={type:"boolean",name:"Cue ID - Audio Enabled",description:"Change style if audio is enabled on a cue",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.cues[r]?.toggleAudio>0}},t.cuePauseAtBeginningStatus={type:"boolean",name:"Cue ID - Pause At Beginning Enabled",description:"Change style if pause at beginning is enabled on a cue",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.cues[r]?.togglePauseAtBeginning>0}},t.cuePauseAtEndStatus={type:"boolean",name:"Cue ID - Pause At End Enabled",description:"Change style if pause at end is enabled on a cue",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.cues[r]?.togglePauseAtEnd>0}},t.cueFadeInStatus={type:"boolean",name:"Cue ID - Fade In Enabled",description:"Change style if fade in is enabled on a cue",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.cues[r]?.toggleFadeIn>0}},t.cueFadeOutStatus={type:"boolean",name:"Cue ID - Fade Out Enabled",description:"Change style if fade out is enabled on a cue",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.cues[r]?.toggleFadeOut>0}},t.cueLoopStatus={type:"boolean",name:"Cue ID - Loop Enabled",description:"Change style if loop is enabled on a cue",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.cues[r]?.toggleLoop>0}},t.cueTransitionStatus={type:"boolean",name:"Cue ID - Transition Enabled",description:"Change style if transition is enabled on a cue",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.cues[r]?.toggleTransition>0}},t.cueGotoStatus={type:"boolean",name:"Cue ID - Goto Enabled",description:"Change style if goto is enabled on a cue",defaultStyle:{bgcolor:r},options:[{type:"textinput",useVariables:!0,label:"Cue ID",id:"cueID",default:""}],callback:async(e,t)=>{const r=await this.conformCueID(t,e.options.cueID);return this.cues[r]?.toggleGoto>0}},t.timeRemaining={type:"boolean",name:"Time Remaining on Playing Cue",description:"Change style if the time remaining of playing cue is less than selected amount",defaultStyle:{bgcolor:n},options:[{type:"number",label:"Seconds Remaining",id:"time",default:10,min:0}],callback:e=>this.states.timeRemaining<=e.options.time},t.videoOutputs={type:"boolean",name:"Video Outputs Active",description:"Change style if the video outputs are active",defaultStyle:{bgcolor:r},options:[],callback:()=>this.states.videoOutputs},t.audioOutputs={type:"boolean",name:"Audio Outputs Active",description:"Change style if the audio outputs are active",defaultStyle:{bgcolor:r},options:[],callback:()=>this.states.audioOutputs},t.inFromPlayheadEnabled={type:"boolean",name:"Set In from Playhead Available",description:'Change style if it is currently possible to use the "Set In from Playhead" action',defaultStyle:{bgcolor:r},options:[],callback:()=>this.states.inFromPlayheadEnabled},t.outFromPlayheadEnabled={type:"boolean",name:"Set Out from Playhead Available",description:'Change style if it is currently possible to use the "Set Out from Playhead" action',defaultStyle:{bgcolor:r},options:[],callback:()=>this.states.outFromPlayheadEnabled},t}const o=[(0,e.CreateConvertToBooleanFeedbackUpgradeScript)({playStatus:!0}),function(e,t){let r={updatedConfig:null,updatedActions:[],updatedFeedbacks:[]};for(const e of t.actions)"scale"===e.actionId&&(e.options.splitScale=!1,e.options.valueH=100,e.options.valueV=100,r.updatedActions.push(e));return r},function(e,t){let r={updatedConfig:null,updatedActions:[],updatedFeedbacks:[]};if(t.config){let e=t.config;void 0!==e.feedbackAlert&&null!==e.feedbackAlert||(e.feedbackAlert=!1,r.updatedConfig=e)}return r},function(e,t){let r={updatedConfig:null,updatedActions:[],updatedFeedbacks:[]};for(const e of t.actions)"play_select"!==e.actionId&&"play_cue"!==e.actionId&&"playCueName"!==e.actionId||e.options.forceCut||(e.options.forceCut=!1,r.updatedActions.push(e));return r}];var a=r(9562),c=r(8318);class u extends e.InstanceBase{constructor(e){super(e)}async init(t){this.config=t,this.connection={ip:null,connected:null,testService:null,testTimeout:null,lastPong:null,bonjourResponder:null,bonjourService:null},this.parseIpAndPort(),this.updateStatus(e.InstanceStatus.Connecting),this.initActions(),this.initPresets(),this.initVariables(),this.initFeedbacks(),this.connection.ip?this.initOSC():this.updateStatus(e.InstanceStatus.BadConfig,"Unable to determine IP Address")}getConfigFields(){return[{type:"bonjour-device",id:"bonjourHost",label:"Mitti Connection",tooltip:'This dropdown attempts to discover active Mitti instances on the network. You can also select "Manual" to enter a custom IP address.',width:10},{type:"static-text",id:"hostFiller",width:10,label:"",isVisible:e=>!!e.bonjourHost,value:""},{type:"textinput",id:"host",label:"IP Address",tooltip:"The IP address of the computer running Mitti",default:"127.0.0.1",width:10,regex:e.Regex.IP,isVisible:e=>!e.bonjourHost},{type:"textinput",id:"feedbackPort",label:"Feedback Port",width:4,tooltip:"The port designated for Feedback in the OSC/UDP Controls tab in Mitti",default:51001,regex:e.Regex.PORT},{type:"checkbox",id:"feedbackAlert",label:"Feedback Alert",tooltip:'If enabled, the module status will change to "Error" if not receiving responses from Mitti. Disable if you wish to use the module without feedback.',default:!0}]}async configUpdated(t){this.config=t,this.parseIpAndPort(),this.updateStatus(e.InstanceStatus.Connecting),this.connection.ip?(this.initPresets(),this.initVariables(),this.initFeedbacks(),this.initOSC()):this.updateStatus(e.InstanceStatus.BadConfig,"Unable to determine IP Address")}async destroy(){this.listener&&this.listener.close(),this.stopTestService(),this.stopBonjourService(),this.cues={}}initVariables(){const e=s.bind(this)();this.setVariableDefinitions(e)}initFeedbacks(){const e=i.bind(this)();this.setFeedbackDefinitions(e)}initPresets(){const e=n.bind(this)();this.setPresetDefinitions(e)}initActions(){const e=t.bind(this)();this.setActionDefinitions(e)}parseIpAndPort(){const e=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;if(this.config.bonjourHost){const[t,r]=this.config.bonjourHost.split(":"),n=Number(r);t.match(e)&&!isNaN(n)&&(this.connection.ip=t)}else this.config.host&&this.config.host.match(e)&&(this.connection.ip=this.config.host);return null}sendCommand(e,t,r){t||0===t?this.oscSend(this.connection.ip,51e3,`/mitti/${e}`,[{type:r??"s",value:t}]):this.oscSend(this.connection.ip,51e3,`/mitti/${e}`,[])}async conformCueID(e,t){let r=await e.parseVariablesInString(t);return r?.match(/^(current|selected|previous|next|all)$/)||(r=r.toUpperCase().slice(0,6)),r}initOSC(){this.cues={},this.states={},this.listener&&this.listener.close();const t=isNaN(parseInt(this.config.feedbackPort))?51001:this.config.feedbackPort;this.listener=new a.UDPPort({localAddress:"0.0.0.0",localPort:t,broadcast:!0,metadata:!0}),this.listener.open(),this.listener.on("ready",(()=>{this.updateStatus(e.InstanceStatus.Ok),this.connection.connected=!0,this.sendCommand("resendOSCFeedback"),this.config.feedbackAlert?this.startTestService():this.stopTestService(),this.startBonjourService()})),this.listener.on("error",(t=>{this.connection.connected=!1,"EADDRINUSE"==t.code?(this.log("error",`Error: Selected feedback port ${t.message.split(":")[1]} is already in use.`),this.updateStatus(e.InstanceStatus.BadConfig,"Feedback port conflict")):(this.log("error",`Error: ${t.message}`),this.updateStatus(e.InstanceStatus.BadConfig,"Feedback Unavailable"))})),this.listener.on("message",(e=>{let t=e.address,r=e?.args[0]?.value;if(t.match(/(^\/mitti\/current\/)/i)){let t=e.address.match(/(\/mitti\/current\/)(\S*)/i)[2];this.processCueUpdate("current",t,r)}else if(t.match(/(^\/mitti\/\S*\/)/i)){let t=e.address.match(/(\/mitti\/)(\S*)(\/)(\S*)/i),n=t[2],s=t[4];"previous"!==n&&"next"!==n&&"current"!==n&&this.processCueUpdate(n,s,r)}else t=t.replace("/mitti/",""),this.processListenerUpdate(t,r)}))}testConnection(){this.connection.testService=setInterval((()=>{this.sendCommand("ping"),this.connection.testTimeout=setTimeout((()=>{Date.now()-4e3>this.connection.lastPong?!0===this.connection.connected&&(this.connection.connected=!1,this.updateStatus(e.InstanceStatus.ConnectionFailure,"Feedback Unavailable"),this.log("error","Feedback unavailable, unable to receive response from Mitti. Check you OSC Feedback settings in both Mitti and Companion.")):!1===this.connection.connected&&(this.connection.connected=!0,this.updateStatus(e.InstanceStatus.Ok),this.log("info","Connected to Mitti"))}),2e3)}),4e3)}startTestService(){this.stopTestService(),this.log("debug","Starting Connection Test"),this.testConnection()}stopTestService(){this.connection.testService&&(this.log("debug","Stopping Connection Test"),clearInterval(this.connection.testService),this.connection.testService=null),this.connection.testTimeout&&(clearTimeout(this.connection.testTimeout),this.connection.testTimeout=null)}startBonjourService(){this.stopBonjourService(),this.connection.bonjourResponder=c.getResponder();const e=isNaN(parseInt(this.config.feedbackPort))?51001:this.config.feedbackPort,t=`Companion-Mitti-Module:${e}`;if(this.connection.bonjourResponder)try{this.connection.bonjourService=this.connection.bonjourResponder.createService({name:t,type:"osc",protocol:"udp",port:e}),this.connection.bonjourService.advertise().then((()=>{this.log("debug",`Bonjour advertised as ${t}`)})).catch((e=>{this.log("debug",`Bonjour error: ${e}`)}))}catch(e){this.log("error",`Error advertising Bonjour discovery service: ${e}`)}}stopBonjourService(){this.connection.bonjourService&&this.connection.bonjourService.destroy().then((()=>{this.log("debug","Bonjour advertisement destroyed"),this.connection.bonjourResponder&&this.connection.bonjourResponder.shutdown().then((()=>{this.log("debug","Bonjour responder destroyed")}))}))}processListenerUpdate(e,t){switch(e){case"currentCueName":case"currentCueVolume":this.states.currentCueName=t,this.setVariableValues({currentCueName:"-"!=t?t:"None"}),this.checkFeedbacks("playingCueName","playingCueID","activeCueName");break;case"currentCueID":this.states.currentCueID=t,this.setVariableValues({currentCueID:"-"!=t?t:"None"}),this.checkFeedbacks("playingCueName","playingCueID","activeCueID");break;case"previousCueName":this.setVariableValues({previousCueName:"-"!=t?t:"None"});break;case"nextCueName":this.setVariableValues({nextCueName:"-"!=t?t:"None"});break;case"selectedCueName":this.states.selectedCueName=t,this.setVariableValues({selectedCueName:"-"!=t?t:"None"}),this.checkFeedbacks("selectedCueName");break;case"selectedCueID":this.states.selectedCueID=t,this.setVariableValues({selectedCueID:"-"!=t?t:"None"}),this.checkFeedbacks("selectedCueID");break;case"cueTimeLeft":{let e=t.match(/^-(?<hh>\d\d):(?<mm>\d\d):(?<ss>\d\d)/i);if(e){let t=e?.groups?.hh,r=e?.groups?.mm,n=e?.groups?.ss,s=`-${"00"==t?"":t+":"}${r}:${n}`,i=`-${t}:${r}:${n}`;this.setVariableValues({cueTimeLeft:s,cueTimeLeft_hhmmss:i,cueTimeLeft_h:t,cueTimeLeft_m:r,cueTimeLeft_s:n}),this.states.timeRemaining=120*parseInt(t)+60*parseInt(r)+parseInt(n),this.checkFeedbacks("timeRemaining")}}break;case"cueTimeElapsed":{let e=t.match(/^(?<hh>\d\d):(?<mm>\d\d):(?<ss>\d\d)/i);if(e){let t=e?.groups?.hh,r=e?.groups?.mm,n=e?.groups?.ss,s=`${"00"==t?"":r+":"}${r}:${n}`,i=`${t}:${r}:${n}`;this.setVariableValues({cueTimeElapsed:s,cueTimeElapsed_hhmmss:i,cueTimeElapsed_h:t,cueTimeElapsed_m:r,cueTimeElapsed_s:n})}}break;case"currentCueTRT":{let e=t.match(/^(?<hh>\d\d):(?<mm>\d\d):(?<ss>\d\d)/i);if(e){let t=e?.groups?.hh,r=e?.groups?.mm,n=e?.groups?.ss,s=`${"00"==t?"":t+":"}${r}:${n}`,i=`${t}:${r}:${n}`;this.setVariableValues({currentCueTRT:s,currentCueTRT_hhmmss:i,currentCueTRT_h:t,currentCueTRT_m:r,currentCueTRT_s:n})}}break;case"togglePlay":this.states.playing=0===t?"Paused":"Playing",this.setVariableValues({playStatus:this.states.playing}),this.checkFeedbacks("playStatus","playingCueName","playingCueID");break;case"playhead":this.states.playhead=t;break;case"toggleVideoOutputs":this.states.videoOutputs=1==t,this.setVariableValues({video_outputs:this.states.videoOutputs?"Active":"Off"}),this.checkFeedbacks("videoOutputs");break;case"toggleAudio":this.states.audioOutputs=1==t,this.setVariableValues({audio_outputs:this.states.audioOutputs?"Active":"Off"}),this.checkFeedbacks("audioOutputs");break;case"inFromPlayheadEnabled":this.states.inFromPlayheadEnabled=1==t,this.checkFeedbacks("inFromPlayheadEnabled");break;case"outFromPlayheadEnabled":this.states.outFromPlayheadEnabled=1==t,this.checkFeedbacks("outFromPlayheadEnabled");break;case"pong":this.connection.lastPong=Date.now()}}processCueUpdate(e,t,r){if("current"===e)t.match(/^toggle/)?(r="Audio"===t?r>0?"Unmuted":"Muted":r>0?"On":"Off",t=`currentCue${t=t.replace("toggle","")}`):("VolumeAsDecibels"===(t=t.charAt(0).toUpperCase()+t.slice(1))&&(this.states.currentCueVolume=r,t="Volume",r=Math.round(100*r)/100),t=`currentCue${t}`),this.setVariableValues({[`${t}`]:r});else if(this.cues[e]?.cueName||0==e||"cueName"!==t)if(this.cues[e]&&0!=e&&"deleted"===t)delete this.cues[e],this.initVariables(),this.initPresets();else switch(this.cues[e]||(this.cues[e]={}),this.cues[e][t]=r,t){case"cueName":this.setVariableValues({[`cue_${e}_cueName`]:r});break;case"toggleAudio":this.checkFeedbacks("cueAudioStatus");break;case"togglePauseAtBeginning":this.checkFeedbacks("cuePauseAtBeginningStatus");break;case"togglePauseAtEnd":this.checkFeedbacks("cuePauseAtEndStatus");break;case"toggleFadeIn":this.checkFeedbacks("cueFadeInStatus");break;case"toggleFadeOut":this.checkFeedbacks("cueFadeOutStatus");break;case"toggleLoop":this.checkFeedbacks("cueLoopStatus");break;case"toggleTransition":this.checkFeedbacks("cueTransitionStatus");break;case"toggleGoto":this.checkFeedbacks("cueGotoStatus")}else this.cues[e]||(this.cues[e]={}),this.cues[e][t]=r,this.initVariables(),this.initPresets(),this.setVariableValues({[`cue_${e}_cueName`]:r})}}(0,e.runEntrypoint)(u,o)})()})();