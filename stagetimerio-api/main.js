/*! For license information please see main.js.LICENSE.txt */
(()=>{var e,t,r={7169:(e,t,r)=>{"use strict";const n=r(2017);n.code='require("ajv/dist/runtime/equal").default',t.A=n},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r={grad:.9,turn:360,rad:360/(2*Math.PI)},n=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},i=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},s=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},o=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},a=function(e){return{r:s(e.r,0,255),g:s(e.g,0,255),b:s(e.b,0,255),a:s(e.a)}},c=function(e){return{r:i(e.r),g:i(e.g),b:i(e.b),a:i(e.a,3)}},u=/^#([0-9a-f]{3,8})$/i,l=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,r=e.g,n=e.b,i=e.a,s=Math.max(t,r,n),o=s-Math.min(t,r,n),a=o?s===t?(r-n)/o:s===r?2+(n-t)/o:4+(t-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},h=function(e){var t=e.h,r=e.s,n=e.v,i=e.a;t=t/360*6,r/=100,n/=100;var s=Math.floor(t),o=n*(1-r),a=n*(1-(t-s)*r),c=n*(1-(1-t+s)*r),u=s%6;return{r:255*[n,a,o,o,c,n][u],g:255*[c,n,n,a,o,o][u],b:255*[o,o,c,n,n,a][u],a:i}},p=function(e){return{h:o(e.h),s:s(e.s,0,100),l:s(e.l,0,100),a:s(e.a)}},f=function(e){return{h:i(e.h),s:i(e.s),l:i(e.l),a:i(e.a,3)}},m=function(e){return h((r=(t=e).s,{h:t.h,s:(r*=((n=t.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:t.a}));var t,r,n},g=function(e){return{h:(t=d(e)).h,s:(i=(200-(r=t.s))*(n=t.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,r,n,i},y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,T={string:[[function(e){var t=u.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?i(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?i(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=w.exec(e)||v.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=y.exec(e)||b.exec(e);if(!t)return null;var n,i,s=p({h:(n=t[1],i=t[2],void 0===i&&(i="deg"),Number(n)*(r[i]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return m(s)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,i=e.b,s=e.a,o=void 0===s?1:s;return n(t)&&n(r)&&n(i)?a({r:Number(t),g:Number(r),b:Number(i),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,r=e.s,i=e.l,s=e.a,o=void 0===s?1:s;if(!n(t)||!n(r)||!n(i))return null;var a=p({h:Number(t),s:Number(r),l:Number(i),a:Number(o)});return m(a)},"hsl"],[function(e){var t=e.h,r=e.s,i=e.v,a=e.a,c=void 0===a?1:a;if(!n(t)||!n(r)||!n(i))return null;var u=function(e){return{h:o(e.h),s:s(e.s,0,100),v:s(e.v,0,100),a:s(e.a)}}({h:Number(t),s:Number(r),v:Number(i),a:Number(c)});return h(u)},"hsv"]]},_=function(e,t){for(var r=0;r<t.length;r++){var n=t[r][0](e);if(n)return[n,t[r][1]]}return[null,void 0]},A=function(e){return"string"==typeof e?_(e.trim(),T.string):"object"==typeof e&&null!==e?_(e,T.object):[null,void 0]},k=function(e,t){var r=g(e);return{h:r.h,s:s(r.s+100*t,0,100),l:r.l,a:r.a}},S=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},E=function(e,t){var r=g(e);return{h:r.h,s:r.s,l:s(r.l+100*t,0,100),a:r.a}},x=function(){function e(e){this.parsed=A(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return i(S(this.rgba),2)},e.prototype.isDark=function(){return S(this.rgba)<.5},e.prototype.isLight=function(){return S(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=c(this.rgba)).r,r=e.g,n=e.b,o=(s=e.a)<1?l(i(255*s)):"","#"+l(t)+l(r)+l(n)+o;var e,t,r,n,s,o},e.prototype.toRgb=function(){return c(this.rgba)},e.prototype.toRgbString=function(){return t=(e=c(this.rgba)).r,r=e.g,n=e.b,(i=e.a)<1?"rgba("+t+", "+r+", "+n+", "+i+")":"rgb("+t+", "+r+", "+n+")";var e,t,r,n,i},e.prototype.toHsl=function(){return f(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=f(g(this.rgba))).h,r=e.s,n=e.l,(i=e.a)<1?"hsla("+t+", "+r+"%, "+n+"%, "+i+")":"hsl("+t+", "+r+"%, "+n+"%)";var e,t,r,n,i},e.prototype.toHsv=function(){return e=d(this.rgba),{h:i(e.h),s:i(e.s),v:i(e.v),a:i(e.a,3)};var e},e.prototype.invert=function(){return C({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),C(k(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),C(k(this.rgba,-e))},e.prototype.grayscale=function(){return C(k(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),C(E(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),C(E(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?C({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):i(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?C({h:e,s:t.s,l:t.l,a:t.a}):i(t.h)},e.prototype.isEqual=function(e){return this.toHex()===C(e).toHex()},e}(),C=function(e){return e instanceof x?e:new x(e)},O=[];t.Colord=x,t.colord=C,t.extend=function(e){e.forEach((function(e){O.indexOf(e)<0&&(e(x,T),O.push(e))}))},t.getFormat=function(e){return A(e)[1]},t.random=function(){return new x({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},7833:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(736)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},736:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,s,o=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),s=i-(r||i);n.diff=s,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";o++;const s=t.formatters[i];if("function"==typeof s){const t=e[o];r=s.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,s=t.enabled(e)),s),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(6585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},5753:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(7833):e.exports=r(6033)},6033:(e,t,r)=>{const n=r(9637),i=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(i.formatWithOptions(t.inspectOpts,...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),s=`  ${i};1m${n} [0m`;r[0]=s+r[0].split("\n").join("\n"+s),r.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=i.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(736)(t);const{formatters:s}=e.exports;s.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===n(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var i=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=i,t.convertMapToObject=function(e){return Array.from(e).reduce((function(e,t){var n,i,s=(i=2,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,s=[],o=!0,a=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(s.push(n.value),!t||s.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(a)throw i}}return s}}(n,i)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(n,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=s[0],a=s[1];return e[o]=a,e}),{})},t.isArguments=function(e){return null!=e&&i(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var s={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=s,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(s.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var r=Object.create(null),n=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},i=0;i<64;i++)r[n(i)]=i;var s=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],r=0;r<e;r++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},o={encode:function(e){if("string"==typeof e){var t=e;e=s(t.length);for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[r]=i}}for(var o=[],a=null,c=null,u=null,l=null,d=0;d<e.length;d++)switch(d%3){case 0:a=e[d]>>2&63,c=(3&e[d])<<4;break;case 1:c|=e[d]>>4&15,u=(15&e[d])<<2;break;case 2:u|=e[d]>>6&3,l=63&e[d],o.push(n(a)),o.push(n(c)),o.push(n(u)),o.push(n(l)),a=null,c=null,u=null,l=null}return null!=a&&(o.push(n(a)),o.push(n(c)),null==u?o.push("="):o.push(n(u)),null==l&&o.push("=")),o.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var n,i=s(t),o=null,a=null,c=null,u=0,l=0;l<e.length;l++){var d="="===(n=e.charAt(l))?-1:r[n];switch(l%4){case 0:if(d<0)throw new Error("invalid base64 string");o=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");o|=d>>4,i[u++]=o,a=(15&d)<<4;break;case 2:d>=0&&(a|=d>>2,i[u++]=a,c=(3&d)<<6);break;case 3:d>=0&&(i[u++]=c|d)}}return i},newBinary:s};t.Base64=o},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function e(t,i,s,o,a){var c=i[t];switch(r(c)){case"string":return n(c);case"number":return isFinite(c)?String(c):"null";case"boolean":return String(c);case"object":if(!c)return"null";var u,l=o+s,d=[];if(Array.isArray(c)||{}.hasOwnProperty.call(c,"callee")){for(var h=c.length,p=0;p<h;p+=1)d[p]=e(p,c,s,l,a)||"null";return u=0===d.length?"[]":l?"[\n"+l+d.join(",\n"+l)+"\n"+o+"]":"["+d.join(",")+"]"}var f=Object.keys(c);return a&&(f=f.sort()),f.forEach((function(t){(u=e(t,c,s,l,a))&&d.push(n(t)+(l?": ":":")+u)})),u=0===d.length?"{}":l?"{\n"+l+d.join(",\n"+l)+"\n"+o+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var r=Object.assign({indent:"",canonical:!1},t);if(!0===r.indent)r.indent="  ";else if("number"==typeof r.indent){for(var n="",s=0;s<r.indent;s++)n+=" ";r.indent=n}return i("",{"":e},r.indent,"",r.canonical)},e.exports=t.default}],r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,n),s.exports}var i={};!function(){var e=i,t=n(2).Base64,r=n(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var s=n(1),o={};e.EJSON=o;var a=new Map;o.addType=function(e,t){if(a.has(e))throw new Error("Type ".concat(e," already present"));a.set(e,t)};var c=[{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$date")&&1===(0,s.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$regexp")&&(0,s.hasOwn)(e,"$flags")&&2===(0,s.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$InfNaN")&&1===(0,s.lengthOf)(e)},matchObject:s.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$binary")&&1===(0,s.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,s.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$escape")&&1===(0,s.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var r=(0,s.lengthOf)(e);1!==r&&2!==r||(t=c.some((function(t){return t.matchJSONValue(e)})))}return t},toJSONValue:function(e){var t={};return(0,s.keysOf)(e).forEach((function(r){t[r]=o.toJSONValue(e[r])})),{$escape:t}},fromJSONValue:function(e){var t={};return(0,s.keysOf)(e.$escape).forEach((function(r){t[r]=o.fromJSONValue(e.$escape[r])})),t}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$type")&&(0,s.hasOwn)(e,"$value")&&2===(0,s.lengthOf)(e)},matchObject:function(e){return o._isCustomType(e)},toJSONValue:function(e){var t=r._noYieldsAllowed((function(){return e.toJSONValue()}));return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!a.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var n=a.get(t);return r._noYieldsAllowed((function(){return n(e.$value)}))}}];o._isCustomType=function(e){return e&&(0,s.isFunction)(e.toJSONValue)&&(0,s.isFunction)(e.typeName)&&a.has(e.typeName())},o._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?a:(0,s.convertMapToObject)(a)},o._getConverters=function(){return c};var u=function(e){for(var t=0;t<c.length;t++){var r=c[t];if(r.matchObject(e))return r.toJSONValue(e)}},l=function e(t){if(null===t)return null;var r=u(t);return void 0!==r?r:(0,s.isObject)(t)?((0,s.keysOf)(t).forEach((function(r){var n=t[r];if((0,s.isObject)(n)||void 0===n||(0,s.isInfOrNaN)(n)){var i=u(n);i?t[r]=i:e(n)}})),t):t};o._adjustTypesToJSONValue=l,o.toJSONValue=function(e){var t=u(e);if(void 0!==t)return t;var r=e;return(0,s.isObject)(e)&&(r=o.clone(e),l(r)),r};var d=function(e){if((0,s.isObject)(e)&&null!==e){var t=(0,s.keysOf)(e);if(t.length<=2&&t.every((function(e){return"string"==typeof e&&"$"===e.substr(0,1)})))for(var r=0;r<c.length;r++){var n=c[r];if(n.matchJSONValue(e))return n.fromJSONValue(e)}}return e},h=function e(t){if(null===t)return null;var r=d(t);return r!==t?r:(0,s.isObject)(t)?((0,s.keysOf)(t).forEach((function(r){var n=t[r];if((0,s.isObject)(n)){var i=d(n);if(n!==i)return void(t[r]=i);e(n)}})),t):t};o._adjustTypesFromJSONValue=h,o.fromJSONValue=function(e){var t=d(e);return t===e&&(0,s.isObject)(e)&&(t=o.clone(e),h(t)),t},o.stringify=(0,s.handleError)((function(e,t){var r=o.toJSONValue(e);return t&&(t.canonical||t.indent)?n(4)(r,t):JSON.stringify(r)})),o.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return o.fromJSONValue(JSON.parse(e))},o.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},o.equals=function(e,t,r){var n,i=!(!r||!r.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,s.isObject)(e)||!(0,s.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(o.isBinary(e)&&o.isBinary(t)){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}if((0,s.isFunction)(e.equals))return e.equals(t,r);if((0,s.isFunction)(t.equals))return t.equals(e,r);var a,c=Array.isArray(e),u=Array.isArray(t);if(c!==u)return!1;if(c&&u){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(!o.equals(e[n],t[n],r))return!1;return!0}switch(o._isCustomType(e)+o._isCustomType(t)){case 1:return!1;case 2:return o.equals(o.toJSONValue(e),o.toJSONValue(t))}var l=(0,s.keysOf)(e),d=(0,s.keysOf)(t);return i?(n=0,a=l.every((function(i){return!(n>=d.length||i!==d[n]||!o.equals(e[i],t[d[n]],r)||(n++,0))}))):(n=0,a=l.every((function(i){return!!(0,s.hasOwn)(t,i)&&!!o.equals(e[i],t[i],r)&&(n++,!0)}))),a&&n===d.length},o.clone=function(e){var t;if(!(0,s.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(o.isBinary(e)){t=o.newBinary(e.length);for(var r=0;r<e.length;r++)t[r]=e[r];return t}return Array.isArray(e)?e.map(o.clone):(0,s.isArguments)(e)?Array.from(e).map(o.clone):(0,s.isFunction)(e.clone)?e.clone():o._isCustomType(e)?o.fromJSONValue(o.clone(o.toJSONValue(e)),!0):(t={},(0,s.keysOf)(e).forEach((function(r){t[r]=o.clone(e[r])})),t)},o.newBinary=t.newBinary}(),e.exports=i.EJSON}()},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,n,s,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,s||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,s,o){var a=r?r+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,s),!0;case 6:return l.fn.call(l.context,t,n,i,s,o),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,i);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||o(this,s);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||i&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},2017:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,s;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=n;0!=i--;){var o=s[i];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}},5884:e=>{"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return-1!==n&&(-1===i||n<i)}},4865:e=>{"use strict";const t=(e,t,n,i)=>{if("length"===n||"prototype"===n)return;if("arguments"===n||"caller"===n)return;const s=Object.getOwnPropertyDescriptor(e,n),o=Object.getOwnPropertyDescriptor(t,n);!r(s,o)&&i||Object.defineProperty(e,n,o)},r=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},n=(e,t)=>`/* Wrapped ${e}*/\n${t}`,i=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),s=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,r,{ignoreNonConfigurable:o=!1}={})=>{const{name:a}=e;for(const n of Reflect.ownKeys(r))t(e,r,n,o);return((e,t)=>{const r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)})(e,r),((e,t,r)=>{const o=""===r?"":`with ${r.trim()}() `,a=n.bind(null,o,t.toString());Object.defineProperty(a,"name",s),Object.defineProperty(e,"toString",{...i,value:a})})(e,r,a),e}},6585:e=>{var t=1e3,r=60*t,n=60*r,i=24*n,s=7*i;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,a){a=a||{};var c,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*s;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(c=e,(u=Math.abs(c))>=i?o(c,u,i,"day"):u>=n?o(c,u,n,"hour"):u>=r?o(c,u,r,"minute"):u>=t?o(c,u,t,"second"):c+" ms"):function(e){var s=Math.abs(e);return s>=i?Math.round(e/i)+"d":s>=n?Math.round(e/n)+"h":s>=r?Math.round(e/r)+"m":s>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},3290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(228),i=r(7685),s=r(4774),o=()=>{},a=new i.TimeoutError;t.default=class extends n{constructor(e){var t,r,n,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=o,this._resolveIdle=o,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:s.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=o,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=o,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((r,n)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const s=void 0===this._timeout&&void 0===t.timeout?e():i.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&n(a)}));r(await s)}catch(e){n(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let n=0,i=e.length;for(;i>0;){const s=i/2|0;let o=n+s;r(e[o],t)<=0?(n=++o,i-=s+1):i=s}return n}},4774:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const i=n.default(this._queue,r,((e,t)=>t.priority-e.priority));this._queue.splice(i,0,r)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},7685:(e,t,r)=>{"use strict";const n=r(4617);class i extends Error{constructor(e){super(e),this.name="TimeoutError"}}const s=(e,t,r)=>new Promise(((s,o)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void s(e);const a=setTimeout((()=>{if("function"==typeof r){try{s(r())}catch(e){o(e)}return}const n=r instanceof Error?r:new i("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),o(n)}),t);n(e.then(s,o),(()=>{clearTimeout(a)}))}));e.exports=s,e.exports.default=s,e.exports.TimeoutError=i},7687:(e,t,r)=>{"use strict";const n=r(857),i=r(9637),s=r(5884),{env:o}=process;let a;function c(e,t={}){return 0!==(r=function(e,{streamIsTTY:t,sniffFlags:r=!0}={}){const i=function(){if("FORCE_COLOR"in o)return"true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(Number.parseInt(o.FORCE_COLOR,10),3)}();void 0!==i&&(a=i);const c=r?a:i;if(0===c)return 0;if(r){if(s("color=16m")||s("color=full")||s("color=truecolor"))return 3;if(s("color=256"))return 2}if(e&&!t&&void 0===c)return 0;const u=c||0;if("dumb"===o.TERM)return u;if("win32"===process.platform){const e=n.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some((e=>e in o))||"codeship"===o.CI_NAME?1:u;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=Number.parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:u}(e,{streamIsTTY:e&&e.isTTY,...t}))&&{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3};var r}s("no-color")||s("no-colors")||s("color=false")||s("color=never")?a=0:(s("color")||s("colors")||s("color=true")||s("color=always"))&&(a=1),e.exports={supportsColor:c,stdout:c({isTTY:i.isatty(1)}),stderr:c({isTTY:i.isatty(2)})}},3338:(e,t,r)=>{"use strict";const{EMPTY_BUFFER:n}=r(2614),i=Buffer[Symbol.species];function s(e,t,r,n,i){for(let s=0;s<i;s++)r[n+s]=e[s]^t[3&s]}function o(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}if(e.exports={concat:function(e,t){if(0===e.length)return n;if(1===e.length)return e[0];const r=Buffer.allocUnsafe(t);let s=0;for(let t=0;t<e.length;t++){const n=e[t];r.set(n,s),s+=n.length}return s<t?new i(r.buffer,r.byteOffset,s):r},mask:s,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let r;return t instanceof ArrayBuffer?r=new i(t):ArrayBuffer.isView(t)?r=new i(t.buffer,t.byteOffset,t.byteLength):(r=Buffer.from(t),e.readOnly=!1),r},unmask:o},!process.env.WS_NO_BUFFER_UTIL)try{const t=r(Object(function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()));e.exports.mask=function(e,r,n,i,o){o<48?s(e,r,n,i,o):t.mask(e,r,n,i,o)},e.exports.unmask=function(e,r){e.length<32?o(e,r):t.unmask(e,r)}}catch(e){}},2614:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},597:(e,t,r)=>{"use strict";const{kForOnEventAttribute:n,kListener:i}=r(2614),s=Symbol("kCode"),o=Symbol("kData"),a=Symbol("kError"),c=Symbol("kMessage"),u=Symbol("kReason"),l=Symbol("kTarget"),d=Symbol("kType"),h=Symbol("kWasClean");class p{constructor(e){this[l]=null,this[d]=e}get target(){return this[l]}get type(){return this[d]}}Object.defineProperty(p.prototype,"target",{enumerable:!0}),Object.defineProperty(p.prototype,"type",{enumerable:!0});class f extends p{constructor(e,t={}){super(e),this[s]=void 0===t.code?0:t.code,this[u]=void 0===t.reason?"":t.reason,this[h]=void 0!==t.wasClean&&t.wasClean}get code(){return this[s]}get reason(){return this[u]}get wasClean(){return this[h]}}Object.defineProperty(f.prototype,"code",{enumerable:!0}),Object.defineProperty(f.prototype,"reason",{enumerable:!0}),Object.defineProperty(f.prototype,"wasClean",{enumerable:!0});class m extends p{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[c]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[c]}}Object.defineProperty(m.prototype,"error",{enumerable:!0}),Object.defineProperty(m.prototype,"message",{enumerable:!0});class g extends p{constructor(e,t={}){super(e),this[o]=void 0===t.data?null:t.data}get data(){return this[o]}}Object.defineProperty(g.prototype,"data",{enumerable:!0});const y={addEventListener(e,t,r={}){for(const s of this.listeners(e))if(!r[n]&&s[i]===t&&!s[n])return;let s;if("message"===e)s=function(e,r){const n=new g("message",{data:r?e:e.toString()});n[l]=this,b(t,this,n)};else if("close"===e)s=function(e,r){const n=new f("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});n[l]=this,b(t,this,n)};else if("error"===e)s=function(e){const r=new m("error",{error:e,message:e.message});r[l]=this,b(t,this,r)};else{if("open"!==e)return;s=function(){const e=new p("open");e[l]=this,b(t,this,e)}}s[n]=!!r[n],s[i]=t,r.once?this.once(e,s):this.on(e,s)},removeEventListener(e,t){for(const r of this.listeners(e))if(r[i]===t&&!r[n]){this.removeListener(e,r);break}}};function b(e,t,r){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}e.exports={CloseEvent:f,ErrorEvent:m,Event:p,EventTarget:y,MessageEvent:g}},5926:(e,t,r)=>{"use strict";const{tokenChars:n}=r(5880);function i(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}e.exports={format:function(e){return Object.keys(e).map((t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map((e=>[t].concat(Object.keys(e).map((t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let r,s,o=Object.create(null),a=!1,c=!1,u=!1,l=-1,d=-1,h=-1,p=0;for(;p<e.length;p++)if(d=e.charCodeAt(p),void 0===r)if(-1===h&&1===n[d])-1===l&&(l=p);else if(0===p||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${p}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);const n=e.slice(l,h);44===d?(i(t,n,o),o=Object.create(null)):r=n,l=h=-1}}else-1===h&&-1!==l&&(h=p);else if(void 0===s)if(-1===h&&1===n[d])-1===l&&(l=p);else if(32===d||9===d)-1===h&&-1!==l&&(h=p);else if(59===d||44===d){if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p),i(o,e.slice(l,h),!0),44===d&&(i(t,r,o),o=Object.create(null),r=void 0),l=h=-1}else{if(61!==d||-1===l||-1!==h)throw new SyntaxError(`Unexpected character at index ${p}`);s=e.slice(l,p),l=h=-1}else if(c){if(1!==n[d])throw new SyntaxError(`Unexpected character at index ${p}`);-1===l?l=p:a||(a=!0),c=!1}else if(u)if(1===n[d])-1===l&&(l=p);else if(34===d&&-1!==l)u=!1,h=p;else{if(92!==d)throw new SyntaxError(`Unexpected character at index ${p}`);c=!0}else if(34===d&&61===e.charCodeAt(p-1))u=!0;else if(-1===h&&1===n[d])-1===l&&(l=p);else if(-1===l||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${p}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);let n=e.slice(l,h);a&&(n=n.replace(/\\/g,""),a=!1),i(o,s,n),44===d&&(i(t,r,o),o=Object.create(null),r=void 0),s=void 0,l=h=-1}}else-1===h&&(h=p);if(-1===l||u||32===d||9===d)throw new SyntaxError("Unexpected end of input");-1===h&&(h=p);const f=e.slice(l,h);return void 0===r?i(t,f,o):(void 0===s?i(o,f,!0):i(o,s,a?f.replace(/\\/g,""):f),i(t,r,o)),t}}},4759:e=>{"use strict";const t=Symbol("kDone"),r=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[r]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[r]()}[r](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},2971:(e,t,r)=>{"use strict";const n=r(3106),i=r(3338),s=r(4759),{kStatusCode:o}=r(2614),a=Buffer[Symbol.species],c=Buffer.from([0,0,255,255]),u=Symbol("permessage-deflate"),l=Symbol("total-length"),d=Symbol("callback"),h=Symbol("buffers"),p=Symbol("error");let f;function m(e){this[h].push(e),this[l]+=e.length}function g(e){this[l]+=e.length,this[u]._maxPayload<1||this[l]<=this[u]._maxPayload?this[h].push(e):(this[p]=new RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][o]=1009,this.removeListener("data",g),this.reset())}function y(e){this[u]._inflate=null,e[o]=1007,this[d](e)}e.exports=class{constructor(e,t,r){if(this._maxPayload=0|r,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!f){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;f=new s(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[d];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,r=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!r)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:!0!==r.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete r.client_max_window_bits,r}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let r=e[t];if(r.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){const e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){const e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==r)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}e[t]=r}))})),e}decompress(e,t,r){f.add((n=>{this._decompress(e,t,((e,t)=>{n(),r(e,t)}))}))}compress(e,t,r){f.add((n=>{this._compress(e,t,((e,t)=>{n(),r(e,t)}))}))}_decompress(e,t,r){const s=this._isServer?"client":"server";if(!this._inflate){const e=`${s}_max_window_bits`,t="number"!=typeof this.params[e]?n.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=n.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[u]=this,this._inflate[l]=0,this._inflate[h]=[],this._inflate.on("error",y),this._inflate.on("data",g)}this._inflate[d]=r,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush((()=>{const e=this._inflate[p];if(e)return this._inflate.close(),this._inflate=null,void r(e);const n=i.concat(this._inflate[h],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[h]=[],t&&this.params[`${s}_no_context_takeover`]&&this._inflate.reset()),r(null,n)}))}_compress(e,t,r){const s=this._isServer?"server":"client";if(!this._deflate){const e=`${s}_max_window_bits`,t="number"!=typeof this.params[e]?n.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=n.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[l]=0,this._deflate[h]=[],this._deflate.on("data",m)}this._deflate[d]=r,this._deflate.write(e),this._deflate.flush(n.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=i.concat(this._deflate[h],this._deflate[l]);t&&(e=new a(e.buffer,e.byteOffset,e.length-4)),this._deflate[d]=null,this._deflate[l]=0,this._deflate[h]=[],t&&this.params[`${s}_no_context_takeover`]&&this._deflate.reset(),r(null,e)}))}}},6286:(e,t,r)=>{"use strict";const{Writable:n}=r(2203),i=r(2971),{BINARY_TYPES:s,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:c}=r(2614),{concat:u,toArrayBuffer:l,unmask:d}=r(3338),{isValidStatusCode:h,isValidUTF8:p}=r(5880),f=Buffer[Symbol.species];e.exports=class extends n{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||s[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new f(t.buffer,t.byteOffset+e,t.length-e),new f(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const r=this._buffers[0],n=t.length-e;e>=r.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),n),this._buffers[0]=new f(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)return void(this._loop=!1);const t=this.consume(2);if(48&t[0])return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));const r=!(64&~t[0]);if(!r||this._extensions[i.extensionName]){if(this._fin=!(128&~t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(r)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=r}else{if(!(this._opcode>7&&this._opcode<11))return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(r)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=!(128&~t[1]),this._isServer){if(!this._masked)return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}else e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){if(this._bufferedBytes<8)return void(this._loop=!1);const t=this.consume(8),r=t.readUInt32BE(0);r>Math.pow(2,21)-1?e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=r*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e))}haveLength(e){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&d(t,this._mask)}if(this._opcode>7)this.controlMessage(t,e);else{if(this._compressed)return this._state=5,void this.decompress(t,e);t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,((e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0){const e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void t(e)}this._fragments.push(r)}this.dataMessage(t),0===this._state&&this.startLoop(t)}))}dataMessage(e){if(!this._fin)return void(this._state=0);const t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?u(r,t):"arraybuffer"===this._binaryType?l(u(r,t)):r,this._allowSynchronousEvents?(this.emit("message",n,!0),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",n,!0),this._state=0,this.startLoop(e)})))}else{const n=u(r,t);if(!this._skipUTF8Validation&&!p(n)){const t=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(t)}5===this._state||this._allowSynchronousEvents?(this.emit("message",n,!1),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",n,!1),this._state=0,this.startLoop(e)})))}}controlMessage(e,t){if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate((()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)})));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,o),this.end();else{const r=e.readUInt16BE(0);if(!h(r)){const e=this.createError(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(e)}const n=new f(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!p(n)){const e=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(e)}this._loop=!1,this.emit("conclude",r,n),this.end()}this._state=0}}createError(e,t,r,n,i){this._loop=!1,this._errored=!0;const s=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(s,this.createError),s.code=i,s[a]=n,s}}},914:(e,t,r)=>{"use strict";const{Duplex:n}=r(2203),{randomFillSync:i}=r(6982),s=r(2971),{EMPTY_BUFFER:o}=r(2614),{isValidStatusCode:a}=r(5880),{mask:c,toBuffer:u}=r(3338),l=Symbol("kByteLength"),d=Buffer.alloc(4),h=8192;let p,f=h;class m{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let r,n,s=!1,o=2,a=!1;t.mask&&(r=t.maskBuffer||d,t.generateMask?t.generateMask(r):(f===h&&(void 0===p&&(p=Buffer.alloc(h)),i(p,0,h),f=0),r[0]=p[f++],r[1]=p[f++],r[2]=p[f++],r[3]=p[f++]),a=!(r[0]|r[1]|r[2]|r[3]),o=6),"string"==typeof e?n=t.mask&&!a||void 0===t[l]?(e=Buffer.from(e)).length:t[l]:(n=e.length,s=t.mask&&t.readOnly&&!a);let u=n;n>=65536?(o+=8,u=127):n>125&&(o+=2,u=126);const m=Buffer.allocUnsafe(s?n+o:o);return m[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(m[0]|=64),m[1]=u,126===u?m.writeUInt16BE(n,2):127===u&&(m[2]=m[3]=0,m.writeUIntBE(n,4,6)),t.mask?(m[1]|=128,m[o-4]=r[0],m[o-3]=r[1],m[o-2]=r[2],m[o-1]=r[3],a?[m,e]:s?(c(e,r,m,o,n),[m]):(c(e,r,e,0,n),[m,e])):[m,e]}close(e,t,r,n){let i;if(void 0===e)i=o;else{if("number"!=typeof e||!a(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const r=Buffer.byteLength(t);if(r>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+r),i.writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0)}const s={[l]:i.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,i,!1,s,n]):this.sendFrame(m.frame(i,s),n)}ping(e,t,r){let n,i;if("string"==typeof e?(n=Buffer.byteLength(e),i=!1):(n=(e=u(e)).length,i=u.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");const s={[l]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(m.frame(e,s),r)}pong(e,t,r){let n,i;if("string"==typeof e?(n=Buffer.byteLength(e),i=!1):(n=(e=u(e)).length,i=u.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");const s={[l]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(m.frame(e,s),r)}send(e,t,r){const n=this._extensions[s.extensionName];let i,o,a=t.binary?2:1,c=t.compress;if("string"==typeof e?(i=Buffer.byteLength(e),o=!1):(i=(e=u(e)).length,o=u.readOnly),this._firstFragment?(this._firstFragment=!1,c&&n&&n.params[n._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(c=i>=n._threshold),this._compress=c):(c=!1,a=0),t.fin&&(this._firstFragment=!0),n){const n={[l]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:o,rsv1:c};this._deflating?this.enqueue([this.dispatch,e,this._compress,n,r]):this.dispatch(e,this._compress,n,r)}else this.sendFrame(m.frame(e,{[l]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:o,rsv1:!1}),r)}dispatch(e,t,r,n){if(!t)return void this.sendFrame(m.frame(e,r),n);const i=this._extensions[s.extensionName];this._bufferedBytes+=r[l],this._deflating=!0,i.compress(e,r.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof n&&n(e);for(let t=0;t<this._queue.length;t++){const r=this._queue[t],n=r[r.length-1];"function"==typeof n&&n(e)}}else this._bufferedBytes-=r[l],this._deflating=!1,r.readOnly=!1,this.sendFrame(m.frame(t,r),n),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][l],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][l],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=m},3719:(e,t,r)=>{"use strict";const{Duplex:n}=r(2203);function i(e){e.emit("close")}function s(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let r=!0;const a=new n({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t,r){const n=!r&&a._readableState.objectMode?t.toString():t;a.push(n)||e.pause()})),e.once("error",(function(e){a.destroyed||(r=!1,a.destroy(e))})),e.once("close",(function(){a.destroyed||a.push(null)})),a._destroy=function(t,n){if(e.readyState===e.CLOSED)return n(t),void process.nextTick(i,a);let s=!1;e.once("error",(function(e){s=!0,n(e)})),e.once("close",(function(){s||n(t),process.nextTick(i,a)})),r&&e.terminate()},a._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){a._final(t)}))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,r,n){e.readyState!==e.CONNECTING?e.send(t,n):e.once("open",(function(){a._write(t,r,n)}))},a.on("end",s),a.on("error",o),a}},8237:(e,t,r)=>{"use strict";const{tokenChars:n}=r(5880);e.exports={parse:function(e){const t=new Set;let r=-1,i=-1,s=0;for(;s<e.length;s++){const o=e.charCodeAt(s);if(-1===i&&1===n[o])-1===r&&(r=s);else if(0===s||32!==o&&9!==o){if(44!==o)throw new SyntaxError(`Unexpected character at index ${s}`);{if(-1===r)throw new SyntaxError(`Unexpected character at index ${s}`);-1===i&&(i=s);const n=e.slice(r,i);if(t.has(n))throw new SyntaxError(`The "${n}" subprotocol is duplicated`);t.add(n),r=i=-1}}else-1===i&&-1!==r&&(i=s)}if(-1===r||-1!==i)throw new SyntaxError("Unexpected end of input");const o=e.slice(r,s);if(t.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}},5880:(e,t,r)=>{"use strict";const{isUtf8:n}=r(181);function i(e){const t=e.length;let r=0;for(;r<t;)if(128&e[r])if(192==(224&e[r])){if(r+1===t||128!=(192&e[r+1])||192==(254&e[r]))return!1;r+=2}else if(224==(240&e[r])){if(r+2>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||224===e[r]&&128==(224&e[r+1])||237===e[r]&&160==(224&e[r+1]))return!1;r+=3}else{if(240!=(248&e[r]))return!1;if(r+3>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||128!=(192&e[r+3])||240===e[r]&&128==(240&e[r+1])||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}else r++;return!0}if(e.exports={isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:i,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},n)e.exports.isValidUTF8=function(e){return e.length<24?i(e):n(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const t=r(Object(function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}()));e.exports.isValidUTF8=function(e){return e.length<32?i(e):t(e)}}catch(e){}},1722:(e,t,r)=>{"use strict";const n=r(4434),i=r(8611),{Duplex:s}=r(2203),{createHash:o}=r(6982),a=r(5926),c=r(2971),u=r(8237),l=r(1060),{GUID:d,kWebSocket:h}=r(2614),p=/^[+/0-9A-Za-z]{22}==$/;function f(e){e._state=2,e.emit("close")}function m(){this.destroy()}function g(e,t,r,n){r=r||i.STATUS_CODES[t],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r\n`+Object.keys(n).map((e=>`${e}: ${n[e]}`)).join("\r\n")+"\r\n\r\n"+r)}function y(e,t,r,n,i){if(e.listenerCount("wsClientError")){const n=new Error(i);Error.captureStackTrace(n,y),e.emit("wsClientError",n,r,t)}else g(r,n,i)}e.exports=class extends n{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:l,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer(((e,t)=>{const r=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const r of Object.keys(t))e.on(r,t[r]);return function(){for(const r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,n)=>{this.handleUpgrade(t,r,n,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(f,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(f,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{f(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,n){t.on("error",m);const i=e.headers["sec-websocket-key"],s=e.headers.upgrade,o=+e.headers["sec-websocket-version"];if("GET"!==e.method)return void y(this,e,t,405,"Invalid HTTP method");if(void 0===s||"websocket"!==s.toLowerCase())return void y(this,e,t,400,"Invalid Upgrade header");if(void 0===i||!p.test(i))return void y(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");if(8!==o&&13!==o)return void y(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");if(!this.shouldHandle(e))return void g(t,400);const l=e.headers["sec-websocket-protocol"];let d=new Set;if(void 0!==l)try{d=u.parse(l)}catch(r){return void y(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}const h=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==h){const r=new c(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const e=a.parse(h);e[c.extensionName]&&(r.accept(e[c.extensionName]),f[c.extensionName]=r)}catch(r){return void y(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){const s={origin:e.headers[8===o?"sec-websocket-origin":"origin"],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(s,((s,o,a,c)=>{if(!s)return g(t,o||401,a,c);this.completeUpgrade(f,i,d,e,t,r,n)}));if(!this.options.verifyClient(s))return g(t,401)}this.completeUpgrade(f,i,d,e,t,r,n)}completeUpgrade(e,t,r,n,i,s,u){if(!i.readable||!i.writable)return i.destroy();if(i[h])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return g(i,503);const l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${o("sha1").update(t+d).digest("base64")}`],p=new this.options.WebSocket(null,void 0,this.options);if(r.size){const e=this.options.handleProtocols?this.options.handleProtocols(r,n):r.values().next().value;e&&(l.push(`Sec-WebSocket-Protocol: ${e}`),p._protocol=e)}if(e[c.extensionName]){const t=e[c.extensionName].params,r=a.format({[c.extensionName]:[t]});l.push(`Sec-WebSocket-Extensions: ${r}`),p._extensions=e}this.emit("headers",l,n),i.write(l.concat("\r\n").join("\r\n")),i.removeListener("error",m),p.setSocket(i,s,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(p),p.on("close",(()=>{this.clients.delete(p),this._shouldEmitClose&&!this.clients.size&&process.nextTick(f,this)}))),u(p,n)}}},1060:(e,t,r)=>{"use strict";const n=r(4434),i=r(5692),s=r(8611),o=r(9278),a=r(4756),{randomBytes:c,createHash:u}=r(6982),{Duplex:l,Readable:d}=r(2203),{URL:h}=r(7016),p=r(2971),f=r(6286),m=r(914),{BINARY_TYPES:g,EMPTY_BUFFER:y,GUID:b,kForOnEventAttribute:w,kListener:v,kStatusCode:T,kWebSocket:_,NOOP:A}=r(2614),{EventTarget:{addEventListener:k,removeEventListener:S}}=r(597),{format:E,parse:x}=r(5926),{toBuffer:C}=r(3338),O=Symbol("kAborted"),I=[8,13],N=["CONNECTING","OPEN","CLOSING","CLOSED"],D=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class M extends n{constructor(e,t,r){super(),this._binaryType=g[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=y,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=M.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(r=t,t=[]):t=[t]),P(this,e,t,r)):(this._autoPong=r.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){g.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){const n=new f({allowSynchronousEvents:r.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation});this._sender=new m(e,this._extensions,r.generateMask),this._receiver=n,this._socket=e,n[_]=this,e[_]=this,n.on("conclude",L),n.on("drain",V),n.on("error",H),n.on("message",W),n.on("ping",Y),n.on("pong",z),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",G),e.on("data",Q),e.on("end",K),e.on("error",J),this._readyState=M.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=M.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[p.extensionName]&&this._extensions[p.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=M.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==M.CLOSED)if(this.readyState!==M.CONNECTING)this.readyState!==M.CLOSING?(this._readyState=M.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";j(this,this._req,e)}}pause(){this.readyState!==M.CONNECTING&&this.readyState!==M.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===M.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===M.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||y,t,r)):B(this,e,r)}pong(e,t,r){if(this.readyState===M.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===M.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||y,t,r)):B(this,e,r)}resume(){this.readyState!==M.CONNECTING&&this.readyState!==M.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===M.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==M.OPEN)return void B(this,e,r);const n={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[p.extensionName]||(n.compress=!1),this._sender.send(e||y,n,r)}terminate(){if(this.readyState!==M.CLOSED)if(this.readyState!==M.CONNECTING)this._socket&&(this._readyState=M.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";j(this,this._req,e)}}}function P(e,t,r,n){const o={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:I[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(e._autoPong=o.autoPong,!I.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${I.join(", ")})`);let a;if(t instanceof h)a=t;else try{a=new h(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),e._url=a.href;const l="wss:"===a.protocol,d="ws+unix:"===a.protocol;let f;if("ws:"===a.protocol||l||d?d&&!a.pathname?f="The URL's pathname is empty":a.hash&&(f="The URL contains a fragment identifier"):f='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',f){const t=new SyntaxError(f);if(0===e._redirects)throw t;return void R(e,t)}const m=l?443:80,g=c(16).toString("base64"),y=l?i.request:s.request,w=new Set;let v,T;if(o.createConnection=o.createConnection||(l?U:F),o.defaultPort=o.defaultPort||m,o.port=a.port||m,o.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":g,Connection:"Upgrade",Upgrade:"websocket"},o.path=a.pathname+a.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(v=new p(!0!==o.perMessageDeflate?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=E({[p.extensionName]:v.offer()})),r.length){for(const e of r){if("string"!=typeof e||!D.test(e)||w.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");w.add(e)}o.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(a.username||a.password)&&(o.auth=`${a.username}:${a.password}`),d){const e=o.path.split(":");o.socketPath=e[0],o.path=e[1]}if(o.followRedirects){if(0===e._redirects){e._originalIpc=d,e._originalSecure=l,e._originalHostOrSocketPath=d?o.socketPath:a.host;const t=n&&n.headers;if(n={...n,headers:{}},t)for(const[e,r]of Object.entries(t))n.headers[e.toLowerCase()]=r}else if(0===e.listenerCount("redirect")){const t=d?!!e._originalIpc&&o.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&a.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!l)&&(delete o.headers.authorization,delete o.headers.cookie,t||delete o.headers.host,o.auth=void 0)}o.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")),T=e._req=y(o),e._redirects&&e.emit("redirect",e.url,T)}else T=e._req=y(o);o.timeout&&T.on("timeout",(()=>{j(e,T,"Opening handshake has timed out")})),T.on("error",(t=>{null===T||T[O]||(T=e._req=null,R(e,t))})),T.on("response",(i=>{const s=i.headers.location,a=i.statusCode;if(s&&o.followRedirects&&a>=300&&a<400){if(++e._redirects>o.maxRedirects)return void j(e,T,"Maximum redirects exceeded");let i;T.abort();try{i=new h(s,t)}catch(t){const r=new SyntaxError(`Invalid URL: ${s}`);return void R(e,r)}P(e,i,r,n)}else e.emit("unexpected-response",T,i)||j(e,T,`Unexpected server response: ${i.statusCode}`)})),T.on("upgrade",((t,r,n)=>{if(e.emit("upgrade",t),e.readyState!==M.CONNECTING)return;T=e._req=null;const i=t.headers.upgrade;if(void 0===i||"websocket"!==i.toLowerCase())return void j(e,r,"Invalid Upgrade header");const s=u("sha1").update(g+b).digest("base64");if(t.headers["sec-websocket-accept"]!==s)return void j(e,r,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"];let c;if(void 0!==a?w.size?w.has(a)||(c="Server sent an invalid subprotocol"):c="Server sent a subprotocol but none was requested":w.size&&(c="Server sent no subprotocol"),c)return void j(e,r,c);a&&(e._protocol=a);const l=t.headers["sec-websocket-extensions"];if(void 0!==l){if(!v)return void j(e,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");let t;try{t=x(l)}catch(t){return void j(e,r,"Invalid Sec-WebSocket-Extensions header")}const n=Object.keys(t);if(1!==n.length||n[0]!==p.extensionName)return void j(e,r,"Server indicated an extension that was not requested");try{v.accept(t[p.extensionName])}catch(t){return void j(e,r,"Invalid Sec-WebSocket-Extensions header")}e._extensions[p.extensionName]=v}e.setSocket(r,n,{allowSynchronousEvents:o.allowSynchronousEvents,generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})})),o.finishRequest?o.finishRequest(T,e):T.end()}function R(e,t){e._readyState=M.CLOSING,e.emit("error",t),e.emitClose()}function F(e){return e.path=e.socketPath,o.connect(e)}function U(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=o.isIP(e.host)?"":e.host),a.connect(e)}function j(e,t,r){e._readyState=M.CLOSING;const n=new Error(r);Error.captureStackTrace(n,j),t.setHeader?(t[O]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(R,e,n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function B(e,t,r){if(t){const r=C(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${N[e.readyState]})`);process.nextTick(r,t)}}function L(e,t){const r=this[_];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[_]&&(r._socket.removeListener("data",Q),process.nextTick($,r._socket),1005===e?r.close():r.close(e,t))}function V(){const e=this[_];e.isPaused||e._socket.resume()}function H(e){const t=this[_];void 0!==t._socket[_]&&(t._socket.removeListener("data",Q),process.nextTick($,t._socket),t.close(e[T])),t.emit("error",e)}function q(){this[_].emitClose()}function W(e,t){this[_].emit("message",e,t)}function Y(e){const t=this[_];t._autoPong&&t.pong(e,!this._isServer,A),t.emit("ping",e)}function z(e){this[_].emit("pong",e)}function $(e){e.resume()}function G(){const e=this[_];let t;this.removeListener("close",G),this.removeListener("data",Q),this.removeListener("end",K),e._readyState=M.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[_]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",q),e._receiver.on("finish",q))}function Q(e){this[_]._receiver.write(e)||this.pause()}function K(){const e=this[_];e._readyState=M.CLOSING,e._receiver.end(),this.end()}function J(){const e=this[_];this.removeListener("error",J),this.on("error",A),e&&(e._readyState=M.CLOSING,this.destroy())}Object.defineProperty(M,"CONNECTING",{enumerable:!0,value:N.indexOf("CONNECTING")}),Object.defineProperty(M.prototype,"CONNECTING",{enumerable:!0,value:N.indexOf("CONNECTING")}),Object.defineProperty(M,"OPEN",{enumerable:!0,value:N.indexOf("OPEN")}),Object.defineProperty(M.prototype,"OPEN",{enumerable:!0,value:N.indexOf("OPEN")}),Object.defineProperty(M,"CLOSING",{enumerable:!0,value:N.indexOf("CLOSING")}),Object.defineProperty(M.prototype,"CLOSING",{enumerable:!0,value:N.indexOf("CLOSING")}),Object.defineProperty(M,"CLOSED",{enumerable:!0,value:N.indexOf("CLOSED")}),Object.defineProperty(M.prototype,"CLOSED",{enumerable:!0,value:N.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(M.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(M.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[w])return t[v];return null},set(t){for(const t of this.listeners(e))if(t[w]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[w]:!0})}})})),M.prototype.addEventListener=k,M.prototype.removeEventListener=S,e.exports=M},5480:(e,t,r)=>{var n=r(9896),i=r(7016),s=r(5317).spawn;function o(e){"use strict";e=e||{};var t,o,a=this,c=r(8611),u=r(5692),l={},d=!1,h={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},p=Object.assign({},h),f=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],m=["TRACE","TRACK","CONNECT"],g=!1,y=!1,b=!1,w={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.open=function(e,t,r,n,i){if(this.abort(),y=!1,b=!1,!function(e){return e&&-1===m.indexOf(e)}(e))throw new Error("SecurityError: Request method not allowed");l={method:e,url:t.toString(),async:"boolean"!=typeof r||r,user:n||null,password:i||null},v(this.OPENED)},this.setDisableHeaderCheck=function(e){d=e},this.setRequestHeader=function(e,t){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!function(e){return d||e&&-1===f.indexOf(e.toLowerCase())}(e))return console.warn('Refused to set unsafe header "'+e+'"'),!1;if(g)throw new Error("INVALID_STATE_ERR: send flag is true");return p[e]=t,!0},this.getResponseHeader=function(e){return"string"==typeof e&&this.readyState>this.OPENED&&o.headers[e.toLowerCase()]&&!y?o.headers[e.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||y)return"";var e="";for(var t in o.headers)"set-cookie"!==t&&"set-cookie2"!==t&&(e+=t+": "+o.headers[t]+"\r\n");return e.substr(0,e.length-2)},this.getRequestHeader=function(e){return"string"==typeof e&&p[e]?p[e]:""},this.send=function(r){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(g)throw new Error("INVALID_STATE_ERR: send has already been called");var d,h=!1,f=!1,m=i.parse(l.url);switch(m.protocol){case"https:":h=!0;case"http:":d=m.hostname;break;case"file:":f=!0;break;case void 0:case"":d="localhost";break;default:throw new Error("Protocol not supported.")}if(f){if("GET"!==l.method)throw new Error("XMLHttpRequest: Only GET method is supported");if(l.async)n.readFile(unescape(m.pathname),"utf8",(function(e,t){e?a.handleError(e,e.errno||-1):(a.status=200,a.responseText=t,v(a.DONE))}));else try{this.responseText=n.readFileSync(unescape(m.pathname),"utf8"),this.status=200,v(a.DONE)}catch(e){this.handleError(e,e.errno||-1)}}else{var b=m.port||(h?443:80),w=m.pathname+(m.search?m.search:"");if(p.Host=d,h&&443===b||80===b||(p.Host+=":"+m.port),l.user){void 0===l.password&&(l.password="");var T=new Buffer(l.user+":"+l.password);p.Authorization="Basic "+T.toString("base64")}"GET"===l.method||"HEAD"===l.method?r=null:r?(p["Content-Length"]=Buffer.isBuffer(r)?r.length:Buffer.byteLength(r),p["Content-Type"]||(p["Content-Type"]="text/plain;charset=UTF-8")):"POST"===l.method&&(p["Content-Length"]=0);var _=e.agent||!1,A={host:d,port:b,path:w,method:l.method,headers:p,agent:_};if(h&&(A.pfx=e.pfx,A.key=e.key,A.passphrase=e.passphrase,A.cert=e.cert,A.ca=e.ca,A.ciphers=e.ciphers,A.rejectUnauthorized=!1!==e.rejectUnauthorized),y=!1,l.async){var k=h?u.request:c.request;g=!0,a.dispatchEvent("readystatechange");var S=function(r){if(302===(o=r).statusCode||303===o.statusCode||307===o.statusCode){l.url=o.headers.location;var n=i.parse(l.url);d=n.hostname;var s={hostname:n.hostname,port:n.port,path:n.path,method:303===o.statusCode?"GET":l.method,headers:p};return h&&(s.pfx=e.pfx,s.key=e.key,s.passphrase=e.passphrase,s.cert=e.cert,s.ca=e.ca,s.ciphers=e.ciphers,s.rejectUnauthorized=!1!==e.rejectUnauthorized),void(t=k(s,S).on("error",E)).end()}o&&o.setEncoding&&o.setEncoding("utf8"),v(a.HEADERS_RECEIVED),a.status=o.statusCode,o.on("data",(function(e){e&&(a.responseText+=e),g&&v(a.LOADING)})),o.on("end",(function(){g&&(g=!1,v(a.DONE))})),o.on("error",(function(e){a.handleError(e)}))},E=function(e){a.handleError(e)};t=k(A,S).on("error",E),e.autoUnref&&t.on("socket",(e=>{e.unref()})),r&&t.write(r),t.end(),a.dispatchEvent("loadstart")}else{var x=".node-xmlhttprequest-content-"+process.pid,C=".node-xmlhttprequest-sync-"+process.pid;n.writeFileSync(C,"","utf8");for(var O="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(h?"s":"")+".request;var options = "+JSON.stringify(A)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+x+"', 'NODE-XMLHTTPREQUEST-STATUS:' + response.statusCode + ',' + responseText, 'utf8');fs.unlinkSync('"+C+"');});response.on('error', function(error) {fs.writeFileSync('"+x+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+C+"');});}).on('error', function(error) {fs.writeFileSync('"+x+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+C+"');});"+(r?"req.write('"+JSON.stringify(r).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",I=s(process.argv[0],["-e",O]);n.existsSync(C););if(a.responseText=n.readFileSync(x,"utf8"),I.stdin.end(),n.unlinkSync(x),a.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var N=a.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,"");a.handleError(N,503)}else a.status=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1"),a.responseText=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"),v(a.DONE)}}},this.handleError=function(e,t){this.status=t||0,this.statusText=e,this.responseText=e.stack,y=!0,v(this.DONE)},this.abort=function(){t&&(t.abort(),t=null),p=Object.assign({},h),this.responseText="",this.responseXML="",y=b=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!g||this.readyState===this.DONE||(g=!1,v(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(e,t){e in w||(w[e]=[]),w[e].push(t)},this.removeEventListener=function(e,t){e in w&&(w[e]=w[e].filter((function(e){return e!==t})))},this.dispatchEvent=function(e){if("function"==typeof a["on"+e]&&(this.readyState===this.DONE?setImmediate((function(){a["on"+e]()})):a["on"+e]()),e in w)for(let t=0,r=w[e].length;t<r;t++)this.readyState===this.DONE?setImmediate((function(){w[e][t].call(a)})):w[e][t].call(a)};var v=function(e){if(!(a.readyState===e||a.readyState===a.UNSENT&&b)&&(a.readyState=e,(l.async||a.readyState<a.OPENED||a.readyState===a.DONE)&&a.dispatchEvent("readystatechange"),a.readyState===a.DONE)){let e;e=b?"abort":y?"error":"load",a.dispatchEvent(e),a.dispatchEvent("loadend")}}}e.exports=o,o.XMLHttpRequest=o},181:e=>{"use strict";e.exports=require("buffer")},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},7194:e=>{"use strict";e.exports=require("dgram")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},1943:e=>{"use strict";e.exports=require("fs/promises")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},9278:e=>{"use strict";e.exports=require("net")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},4756:e=>{"use strict";e.exports=require("tls")},9637:e=>{"use strict";e.exports=require("tty")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},3106:e=>{"use strict";e.exports=require("zlib")},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=void 0;const n=r(1635),i=r(9967),s=n.__importDefault(r(1943)),o=r(360),a=r(4044),c=n.__importDefault(r(6928));let u,l=!1;t.runEntrypoint=function(e,t){Promise.resolve().then((async()=>{if(l)throw new Error("runEntrypoint can only be called once");l=!0;const r=process.env.MODULE_MANIFEST;if(!r)throw new Error("Module initialise is missing MODULE_MANIFEST");const n=await s.default.readFile(r),d=JSON.parse(n.toString());if(d.runtime?.api!==i.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!d.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let h=d.runtime.apiVersion;if("0.0.0"===h)try{const e=await s.default.readFile(c.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(h=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const p=process.env.CONNECTION_ID;if("string"!=typeof p||!p)throw new Error("Module initialise is missing CONNECTION_ID");const f=process.env.VERIFICATION_TOKEN;if("string"!=typeof f||!f)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const m=new a.IpcWrapper({},(e=>{process.send(e)}),5e3);process.once("message",(e=>{m.receivedMessage(e)})),u=new e((0,o.literal)({id:p,upgradeScripts:t,_isInstanceBaseProps:!0})),m.sendWithCb("register",{apiVersion:h,connectionId:p,verificationToken:f}).then((()=>{console.log("Module-host accepted registration")}),(e=>{console.error("Module registration failed",e),process.exit(11)}))})).catch((e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)}))}},6160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var n=r(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return n.TCPHelper}});var i=r(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return i.TelnetHelper}});var s=r(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return s.UDPHelper}})},8895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const n=r(1635).__importDefault(r(9278)),i=r(228),s=r(1400);class o extends i.EventEmitter{#e;#t;_socket;#r;#n=!1;#i=!1;#s=!1;#o;#a;#c;get isConnected(){return this.#n}get isConnecting(){return this.#i}get isDestroyed(){return this.#s}constructor(e,t,r){super(),this.#e=e,this.#t=t,this.#r={reconnect_interval:2e3,reconnect:!0,...r},this._socket=new n.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",(e=>{this.#i=!1,this.#n=!1,this.#r.reconnect&&this.#u(),this.#l(s.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this._socket.on("ready",(()=>{this.#n=!0,this.#i=!1,this.#l(s.InstanceStatus.Ok),this.emit("connect")})),this._socket.on("end",(()=>{this.#n=!1,this.#l(s.InstanceStatus.Disconnected),!this.#i&&this.#r.reconnect&&this.#u(),this.emit("end")})),this._socket.on("data",(e=>this.emit("data",e))),this._socket.on("drain",(()=>this.emit("drain"))),setImmediate((()=>{this.#s||this.connect()})),this.#c=setTimeout((()=>{this.#c=void 0,this.#s||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}connect(){if(this.#s)throw new Error("Cannot connect destroyed socket");return!this.#i&&(this.#i=!0,this._socket.connect(this.#t,this.#e),!0)}async send(e){if(this.#s||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#n)return!1;try{return new Promise(((t,r)=>{this._socket.write(e,(e=>{e?r(e):t(!0)}))}))}catch(e){this.#n=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#l(s.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#s=!0,void 0!==this.#a&&(clearTimeout(this.#a),this.#a=void 0),void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#u(){void 0!==this.#a&&clearTimeout(this.#a),this.#a=setTimeout((()=>{this.#a=void 0,this.#l(s.InstanceStatus.Connecting),this.connect()}),this.#r.reconnect_interval)}#l(e,t){this.#o!=e&&(this.#o=e,this.emit("status_change",e,t))}}t.TCPHelper=o},1118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const n=r(1635).__importDefault(r(228)),i=r(2203),s=r(8895);class o extends n.default{#d;#h;#c;get isConnected(){return this.#d.isConnected}get isConnecting(){return this.#d.isConnecting}get isDestroyed(){return this.#d.isDestroyed}constructor(e,t,r){super(),this.#d=new s.TCPHelper(e,t,r),this.#h=new a,this.#d._socket.pipe(this.#h),this.#d.on("connect",(()=>this.emit("connect"))),this.#d.on("end",(()=>this.emit("end"))),this.#d.on("error",(e=>this.emit("error",e))),this.#d.on("status_change",((e,t)=>this.emit("status_change",e,t))),this.#h.on("iac",((e,t)=>this.emit("iac",e,t))),this.#h.on("sb",(e=>this.emit("sb",e))),this.#h.on("data",(e=>this.emit("data",e))),this.#h.on("drain",(()=>this.emit("drain"))),this.#c=setTimeout((()=>{this.#c=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)}),5e3)}connect(){return this.#d.connect()}async send(e){return this.#d.send(e)}destroy(){this.#d.destroy(),void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this.#h.removeAllListeners(),this.#h.destroy()}}t.TelnetHelper=o;class a extends i.Transform{#p;#f;#m;constructor(e){super(e),this.#p=Buffer.alloc(0),this.#f=Buffer.alloc(0),this.#m=0}_transform(e,t,r){for(let t=0;t<e.length;++t)this.#g(e[t]);const n=this.#y();n.length&&this.push(n),r()}#g(e){if(0===this.#m){if(255===e)return void(this.#m=255);this.#p=Buffer.concat([this.#p,Buffer.from([e])])}else if(255===this.#m)switch(e){case 250:case 251:case 252:case 253:case 254:this.#m=e;break;default:this.#m=0}else{if(this.#m>=251&&this.#m<=254){let t;switch(this.#m){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#m=0)}if(250===this.#m){if(240===e)return this.emit("sb",this.#f),this.#m=0,void(this.#f=Buffer.alloc(0));this.#f=Buffer.concat([this.#f,Buffer.from([e])])}}}#y(){const e=this.#p;return this.#p=Buffer.alloc(0),e}}},6259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const n=r(1635).__importDefault(r(7194)),i=r(228),s=r(1400);class o extends i.EventEmitter{#e;#t;#b;#r;#s=!1;#o;#c;get isDestroyed(){return this.#s}constructor(e,t,r){super(),this.#e=e,this.#t=t,this.#r={...r},this.#b=n.default.createSocket("udp4");try{this.#b.bind(this.#r.bind_port||0,this.#r.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#r.bind_ip||"0.0.0.0"}:${this.#r.bind_port||0}`)}this.#r.broadcast&&this.#b.setBroadcast(!0),void 0!==this.#r.ttl&&this.#b.setTTL(this.#r.ttl),void 0!==this.#r.multicast_ttl&&this.#b.setMulticastTTL(this.#r.multicast_ttl),this.#b.on("error",(e=>{this.#l(s.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this.#b.on("listening",(()=>{this.#r.multicast_interface&&this.#b.setMulticastInterface(this.#r.multicast_interface),this.#l(s.InstanceStatus.Ok),this.emit("listening")})),this.#b.on("message",(e=>this.emit("data",e))),this.#c=setTimeout((()=>{this.#s||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}async send(e){if(this.#s)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise(((t,r)=>{this.#b.send(e,this.#t,this.#e,(e=>{e?r(e):t()}))}))}destroy(){this.#s=!0,void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this.#b.removeAllListeners(),this.#b.close(),this.removeAllListeners()}#l(e,t){this.#o!=e&&(this.#o=e,this.emit("status_change",e,t))}}t.UDPHelper=o},4044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const n=r(1635),i=r(360),s=n.__importDefault(r(6022));t.IpcWrapper=class{#w;#v;#T;#_=1;#A=new Map;constructor(e,t,r){this.#w=e,this.#v=t,this.#T=r}async sendWithCb(e,t,r,n=0){n<=0&&(n=this.#T);const i={timeout:void 0,resolve:()=>null,reject:()=>null},o=new Promise(((e,t)=>{i.resolve=e,i.reject=t}));this.#_>268435456&&(this.#_=1);const a=this.#_++;this.#A.set(a,i),this.#v({direction:"call",name:String(e),payload:s.default.stringify(t),callbackId:a});const c=new Error("Call timed out");return i.timeout=setTimeout((()=>{i.reject(r?r():c),this.#A.delete(a)}),n),o}sendWithNoCb(e,t){this.#v({direction:"call",name:String(e),payload:s.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#w[e.name];if(!t)return void(e.callbackId&&this.#v({direction:"response",callbackId:e.callbackId,success:!1,payload:s.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?s.default.parse(e.payload):void 0).then((t=>{e.callbackId&&this.#v({direction:"response",callbackId:e.callbackId,success:!0,payload:s.default.stringify(t)})}),(t=>{e.callbackId&&this.#v({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):s.default.stringify(t)})}));break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#A.get(e.callbackId);if(this.#A.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const r=e.payload?s.default.parse(e.payload):void 0;if(e.success)t.resolve(r);else{let e=r;r&&"object"==typeof r&&"message"in r&&(e=new Error(r.message),r.stack&&(e.stack=r.stack)),t.reject(e)}break}default:(0,i.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},6278:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const n=r(1635);n.__exportStar(r(9077),t),n.__exportStar(r(2018),t),n.__exportStar(r(4581),t);var i=r(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return i.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return i.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return i.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return i.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return i.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return i.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return i.assertNever}}),n.__exportStar(r(6160),t);var s=r(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return s.runEntrypoint}})},4289:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const n=r(2593);function i(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#k;#S;#E;#x=new Map;#C=new Map;constructor(e,t,r){this.#k=e,this.#S=t,this.#E=r}async handleExecuteAction(e){const t=this.#x.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},r)}handleUpdateActions(e){for(const[t,r]of Object.entries(e)){const e=this.#C.get(t);if(e){const t=this.#x.get(e.actionId);if(t?.unsubscribe){const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(i(e),r)).catch((t=>{this.#E("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!r||r.disabled)this.#C.delete(t);else{this.#C.set(t,r);const e=this.#x.get(r.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#k({text:e,controlId:r.controlId,actionInstanceId:r.id,feedbackInstanceId:void 0})).text};Promise.resolve(e.subscribe(i(r),t)).catch((e=>{this.#E("error",`Action subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}))}}}}async handleLearnAction(e){const t=this.#x.get(e.action.actionId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},r)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#x.clear();for(const[r,i]of Object.entries(e))i&&(t.push({id:r,name:i.name,description:i.description,options:(0,n.serializeIsVisibleFn)(i.options),hasLearn:!!i.learn,learnTimeout:i.learnTimeout}),this.#x.set(r,i));this.#S({actions:t})}_getAllActions(){return Array.from(this.#C.values()).map((e=>({id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options})))}subscribeActions(e){let t=Array.from(this.#C.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.actionId))));for(const e of t){const t=this.#x.get(e.actionId);if(t?.subscribe){const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.subscribe(i(e),r)).catch((t=>{this.#E("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeActions(e){let t=Array.from(this.#C.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.actionId))));for(const e of t){const t=this.#x.get(e.actionId);if(t&&t.unsubscribe){const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(i(e),r)).catch((t=>{this.#E("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInstanceBaseProps=t.serializeIsVisibleFn=void 0,t.serializeIsVisibleFn=function(e){return(e??[]).map((e=>"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisible:void 0}:{...e,isVisibleFn:void 0}))},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},8039:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const n=r(1635),i=r(2593),s=n.__importDefault(r(7e3));function o(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#k;#O;#I;#E;#N=new Map;#D=new Map;#M=new Map;#P=new Map;#R;get parseVariablesContext(){return this.#R}constructor(e,t,r,n){this.#k=e,this.#O=t,this.#I=r,this.#E=n}getDefinitionIds(){return Array.from(this.#N.keys())}getInstanceIds(){return Array.from(this.#D.keys())}handleUpdateFeedbacks(e){for(const[t,r]of Object.entries(e)){const e=this.#D.get(t);if(e){const t=this.#N.get(e.feedbackId);if(t?.unsubscribe){const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(o(t.type,e),r)).catch((t=>{this.#E("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!r||r.disabled)this.#D.delete(t);else{this.#D.set(t,{...r,referencedVariables:null});const e=this.#N.get(r.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#k({text:e,controlId:r.controlId,actionInstanceId:void 0,feedbackInstanceId:r.id})).text};Promise.resolve(e.subscribe(o(e.type,r),t)).catch((e=>{this.#E("error",`Feedback subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}))}this.#F(t)}}}async handleLearnFeedback(e){const t=this.#N.get(e.feedback.feedbackId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},r)}}return{options:void 0}}handleVariablesChanged(e){if(!e.variablesIds.length)return;const t=new Set(e.variablesIds);for(const t of this.#P.values())for(const r of e.variablesIds)t.changedVariables.add(r);const r=new Set;for(const e of this.#D.values())if(!this.#P.has(e.id)&&e.referencedVariables)for(const n of e.referencedVariables)if(t.has(n)){r.add(e.id);break}for(const e of r)setImmediate((()=>{this.#F(e)}))}#F(e){const t=this.#P.get(e);if(t)return void(t.needsRecheck=!0);const r=this.#D.get(e);if(!r)return;const n=r,i={needsRecheck:!1,changedVariables:new Set};this.#P.set(e,i),Promise.resolve().then((async()=>{const t=this.#N.get(n.feedbackId);let r;const i=new Set;if(t){this.#R=`Feedback ${n.feedbackId} (${e})`;const s={parseVariablesInString:async t=>{const r=await this.#k({text:t,controlId:n.controlId,actionInstanceId:void 0,feedbackInstanceId:e});if(r.variableIds&&r.variableIds.length)for(const e of r.variableIds)i.add(e);return r.text}};r="boolean"===t.type?t.callback({...o("boolean",n),type:"boolean"},s):t.callback({...o("advanced",n),type:"advanced",image:n.image},s),this.#R=void 0}const s=await r;this.#M.set(e,{id:e,controlId:n.controlId,value:s}),this.#U(),n.referencedVariables=i.size>0?Array.from(i):null})).catch((e=>{console.error(`Feedback check failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)})).finally((()=>{this.#R=void 0,this.#P.delete(e);let t=!1;if(n.referencedVariables)for(const e of n.referencedVariables)if(i.changedVariables.has(e)){t=!0;break}(t||i.needsRecheck)&&setImmediate((()=>{this.#F(e)}))}))}#U=(0,s.default)((()=>{const e=this.#M;this.#M=new Map,e.size>0&&this.#O({values:Array.from(e.values())})}),{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#N.clear();for(const[r,n]of Object.entries(e))n&&(t.push({id:r,name:n.name,description:n.description,options:(0,i.serializeIsVisibleFn)(n.options),type:n.type,defaultStyle:"boolean"===n.type?n.defaultStyle:void 0,hasLearn:!!n.learn,learnTimeout:n.learnTimeout,showInvert:"boolean"===n.type&&n.showInvert}),this.#N.set(r,n));this.#I({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,r]of this.#D.entries())this.#N.get(r.feedbackId)&&(0===t.size||t.has(r.feedbackId))&&this.#F(e)}checkFeedbacksById(e){for(const t of e)this.#F(t)}_getAllFeedbacks(){return Array.from(this.#D.values()).map((e=>({id:e.id,feedbackId:e.feedbackId,controlId:e.controlId,options:e.options})))}subscribeFeedbacks(e){let t=Array.from(this.#D.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.feedbackId))));for(const e of t){const t=this.#N.get(e.feedbackId);if(t?.subscribe){const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.subscribe(o(t.type,e),r)).catch((t=>{this.#E("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeFeedbacks(e){let t=Array.from(this.#D.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.feedbackId))));for(const e of t){const t=this.#N.get(e.feedbackId);if(t&&t.unsubscribe){const r={parseVariablesInString:async t=>(await this.#k({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(o(t.type,e),r)).catch((t=>{this.#E("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},1706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=void 0;const n=r(360);function i(e){return JSON.parse(JSON.stringify(e))}t.runThroughUpgradeScripts=function(e,t,r,s,o,a){const c=new Map,u=e=>{let t=c.get(e);return t||(t={actions:[],feedbacks:[],config:!1},c.set(e,t)),t};for(const t of Object.values(e)){const e=t?.upgradeIndex??r;t&&"number"==typeof e&&u(e).actions.push(t.id)}for(const e of Object.values(t)){const t=e?.upgradeIndex??r;e&&"number"==typeof t&&u(t).feedbacks.push(e.id)}if(!a)for(let e=r??-1;e<s.length;e++)u(e).config=!0;const l={},d={};let h;if(c.size>0){const a=Array.from(c.keys()).sort(),u=Math.min(...a,r??-1)+1,p=[],f=[],m=s.length;for(let r=u;r<m;r++){const a=c.get(r-1);a&&(p.push(...a.actions),f.push(...a.feedbacks));const u=!!a?.config;if(!u&&0===p.length&&0===f.length)continue;const m=h??o,g=(0,s[r])({currentConfig:i(m)},{config:u?m:null,actions:p.map((t=>{const r=e[t];if(r)return(0,n.literal)({id:r.id,controlId:r.controlId,actionId:r.actionId,options:void 0!==r.options?i(r.options):{}})})).filter((e=>!!e)),feedbacks:f.map((e=>{const r=t[e];if(r)return(0,n.literal)({id:r.id,controlId:r.controlId,feedbackId:r.feedbackId,options:void 0!==r.options?i(r.options):{},isInverted:r.isInverted})})).filter((e=>!!e))});u&&g.updatedConfig&&(h=g.updatedConfig);for(const t of g.updatedActions)if(t){const r=e[t.id];r&&(r.actionId=t.actionId,r.options=t.options,d[t.id]=r)}for(const e of g.updatedFeedbacks)if(e){const r=t[e.id];r&&(r.feedbackId=e.feedbackId,r.options=e.options,l[e.id]={...r,style:l[e.id]?.style??e.style,isInverted:e.isInverted??!1})}}for(const[t,r]of Object.entries(e))d[t]||"number"!=typeof r?.upgradeIndex||(d[t]=r);for(const[e,r]of Object.entries(t))l[e]||"number"!=typeof r?.upgradeIndex||(l[e]=r)}return{updatedActions:d,updatedFeedbacks:l,updatedConfig:h}}},9077:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=void 0;const n=r(1635).__importDefault(r(7281));t.validateManifest=function(e){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'");if(!(0,n.default)(e)){const e=n.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}}},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1649:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const n=r(1635),i=r(360),s=n.__importDefault(r(3290)),o=r(2593),a=r(1706),c=r(8039),u=r(4044),l=r(4289),d=r(2365);t.InstanceBase=class{#j;#B;id;#L=new s.default({concurrency:1});#V=!1;#H=!1;#q={};#W;#Y;#z=new Map;#$=new Map;#G=new Map;#r;#Q;get instanceOptions(){return this.#r}get label(){return this.#Q}constructor(e){if(!(0,o.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#r={disableVariableValidation:!1},this.#j=new u.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:this._handleVariablesChanged.bind(this),sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},(e=>{process.send(e)}),5e3),process.on("message",(e=>{this.#j.receivedMessage(e)})),this.#W=new l.ActionManager((async e=>this.#j.sendWithCb("parseVariablesInString",e)),(e=>this.#j.sendWithNoCb("setActionDefinitions",e)),this.log.bind(this)),this.#Y=new c.FeedbackManager((async e=>this.#j.sendWithCb("parseVariablesInString",e)),(e=>this.#j.sendWithNoCb("updateFeedbackValues",e)),(e=>this.#j.sendWithNoCb("setFeedbackDefinitions",e)),this.log.bind(this)),this.#B=e.upgradeScripts,this.id=e.id,this.#Q=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#L.add((async()=>{if(this.#V)throw new Error("Already initialized");const t=e.actions,r=e.feedbacks;if(this.#q=e.config,this.#Q=e.label,e.isFirstInit){const t={},r=this.getConfigFields();for(const e of r)"default"in e&&(t[e.id]=e.default);this.#q=t,this.saveConfig(this.#q),e.lastUpgradeIndex=this.#B.length-1}const{updatedActions:n,updatedFeedbacks:i,updatedConfig:s}=(0,a.runThroughUpgradeScripts)(t,r,e.lastUpgradeIndex,this.#B,this.#q,!1);this.#q=s??this.#q;const o=this.#j.sendWithCb("upgradedItems",{updatedActions:n,updatedFeedbacks:i});try{await this.init(this.#q,!!e.isFirstInit),this.#V=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}finally{await o}return setImmediate((()=>{this._handleUpdateActions({actions:t},!0).catch((e=>{this.log("error",`Receive actions failed: ${e}`)})),this._handleUpdateFeedbacks({feedbacks:r},!0).catch((e=>{this.log("error",`Receive feedbacks failed: ${e}`)}))})),{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#B.length-1,updatedConfig:this.#q}}))}async _handleDestroy(){await this.#L.add((async()=>{if(!this.#V)throw new Error("Not initialized");await this.destroy(),this.#V=!1}))}async _handleConfigUpdateAndLabel(e){await this.#L.add((async()=>{if(!this.#V)throw new Error("Not initialized");this.#Q=e.label,this.#q=e.config,await this.configUpdated(this.#q)}))}async _handleExecuteAction(e){return this.#W.handleExecuteAction(e)}async _handleUpdateFeedbacks(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)({},e.feedbacks,null,this.#B,this.#q,!0);this.#j.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded feedbacks: ${e}`)}))}this.#Y.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)(e.actions,{},null,this.#B,this.#q,!0);this.#j.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded actions: ${e}`)}))}this.#W.handleUpdateActions(e.actions)}async _handleGetConfigFields(e){return{fields:(0,o.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#W.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#Y.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#H)return}else if(!this.#H)return;if(!this.handleStartStopRecordActions)throw this.#H=!1,new Error("Recording actions is not supported by this module!");this.#H=e.recording,this.handleStartStopRecordActions(this.#H)}async _handleVariablesChanged(e){this.#Y.handleVariablesChanged(e)}async _handleSharedUdpSocketMessage(e){for(const t of this.#z.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#z.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e){this.#q=e,this.#j.sendWithNoCb("saveConfig",{config:e})}setActionDefinitions(e){this.#W.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#Y.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[r,n]of Object.entries(e))n&&t.push({...n,id:r});this.#j.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],r=[];this.#$.clear();for(const n of e)t.push({id:n.variableId,name:n.name}),this.#$.set(n.variableId,n),this.#G.has(n.variableId)||(this.#G.set(n.variableId,""),r.push({id:n.variableId,value:""}));if(!this.#r.disableVariableValidation){const e=new Set(this.#$.keys());for(const t of this.#G.keys())e.has(t)||(this.#G.delete(t),r.push({id:t,value:void 0}))}this.#j.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:r})}setVariableValues(e){const t=[];for(const[r,n]of Object.entries(e))this.#r.disableVariableValidation?(void 0===n?this.#G.delete(r):this.#G.set(r,n),t.push({id:r,value:n})):this.#$.has(r)?(this.#G.set(r,n??""),t.push({id:r,value:n??""})):t.push({id:r,value:void 0});this.#j.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#G.get(e)}async parseVariablesInString(e){const t=this.#Y.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),(await this.#j.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text}checkFeedbacks(...e){this.#Y.checkFeedbacks(e)}checkFeedbacksById(...e){this.#Y.checkFeedbacksById(e)}_getAllActions(){return this.#W._getAllActions()}subscribeActions(...e){this.#W.subscribeActions(e)}unsubscribeActions(...e){this.#W.unsubscribeActions(e)}_getAllFeedbacks(){return this.#Y._getAllFeedbacks()}subscribeFeedbacks(...e){this.#Y.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#Y.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#H)throw new Error("Not currently recording actions");this.#j.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}setCustomVariableValue(e,t){this.#j.sendWithNoCb("setCustomVariable",{customVariableId:e,value:t})}oscSend(e,t,r,n){this.#j.sendWithNoCb("send-osc",(0,i.literal)({host:e,port:t,path:r,args:n}))}updateStatus(e,t){this.#j.sendWithNoCb("set-status",(0,i.literal)({status:e,message:t??null}))}log(e,t){this.#j.sendWithNoCb("log-message",(0,i.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const r="string"==typeof e?{type:e}:e,n=new d.SharedUdpSocketImpl(this.#j,this.#z,r);return t&&n.on("message",t),n}}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1400:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(r||(t.InstanceStatus=r={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(n||(t.Regex=n={}))},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1635);n.__exportStar(r(3730),t),n.__exportStar(r(1649),t),n.__exportStar(r(7386),t),n.__exportStar(r(1400),t),n.__exportStar(r(8983),t),n.__exportStar(r(8104),t),n.__exportStar(r(3258),t),n.__exportStar(r(131),t),n.__exportStar(r(3371),t),n.__exportStar(r(9786),t),n.__exportStar(r(6132),t)},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2365:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const n=r(1635).__importDefault(r(228)),i=r(360);class s extends n.default{#j;#K;#r;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#m&&"object"==typeof this.#m?this.#m:void 0}#m="pending";constructor(e,t,r){super(),this.#j=e,this.#K=t,this.#r={...r}}bind(e,t,r){if(this.#m&&"object"==typeof this.#m)throw new Error("Socket is already bound");switch(this.#m){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,i.assertNever)(this.#m),new Error("Invalid socket state")}this.#m="binding",r&&this.on("listening",r),this.#j.sendWithCb("sharedUdpSocketJoin",{family:this.#r.type,portNumber:e}).then((t=>{this.#m={portNumber:e,handleId:t},this.#K.set(t,this),this.emit("listening")}),(e=>{this.#m="closed",this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}close(e){if(this.#m&&"object"==typeof this.#m);else switch(this.#m){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,i.assertNever)(this.#m),new Error("Invalid socket state")}const t=this.#m.handleId;this.#m="closed",e&&this.on("close",e),this.#j.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then((()=>{this.#K.delete(t),this.emit("close")}),(e=>{this.#K.delete(t),this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}send(e,t,r,n,i,s){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof r){if("number"!=typeof n||"string"!=typeof i)throw new Error("Invalid arguments");if(void 0!==s&&"number"!=typeof s)throw new Error("Invalid arguments");const o=this.#J(e,t,r);this.#Z(o,n,i,s)}else{if("string"!=typeof r)throw new Error("Invalid arguments");{if(void 0!==n&&"function"!=typeof n)throw new Error("Invalid arguments");const i=this.#J(e,0,void 0);this.#Z(i,t,r,n)}}}#J(e,t,r){let n;if("string"==typeof e)n=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))n=e;else{if(Array.isArray(e))return Buffer.from(e);n=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return n.subarray(t,void 0!==r?r+t:void 0)}#Z(e,t,r,n){if(!this.#m||"object"!=typeof this.#m)throw new Error("Socket is not open");this.#j.sendWithCb("sharedUdpSocketSend",{handleId:this.#m.handleId,message:e,address:r,port:t}).then((()=>{n?.()}),(e=>{this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#m="fatalError";const t=this.boundState;t&&this.#K.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=s},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=t.CreateConvertToBooleanFeedbackUpgradeScript=t.EmptyUpgradeScript=void 0,t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}),t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,r)=>{const n=[];for(const t of r.feedbacks){let r=e[t.feedbackId];if(!0===r&&(r={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),r){t.style||(t.style={});for(const[e,i]of Object.entries(r))void 0!==t.options[e]&&(t.style[i]=t.options[e],delete t.options[e],n.push(t))}}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:n}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,r)=>{const n=[];for(const t of r.feedbacks){const r=e[t.feedbackId];if("string"!=typeof r)continue;const i=t.options[r];void 0!==i&&(delete t.options[r],t.isInverted="true"===i||!0===i||Number(i)>0,n.push(t))}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:n}}}},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.assertNever=t.literal=void 0;const n=r(6284);function i(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,n.colord)(e).isValid()){const t=(0,n.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,r,n){let i=(255&e)<<16|(255&t)<<8|255&r;return n&&n>=0&&n<1&&(i+=16777216*Math.round(255*(1-n))),i},t.splitRgb=i,t.splitHsl=function(e){const t=i(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=i(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=i(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()}},7281:(e,t,r)=>{"use strict";e.exports=c,e.exports.default=c;const n={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"}},required:["name"]}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18"},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}},additionalProperties:!1}},additionalProperties:!1,required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1}}},i={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1},s=Object.prototype.hasOwnProperty,o=r(7169).A,a=new RegExp("","u");function c(e,{instancePath:t="",parentData:r,parentDataProperty:u,rootData:l=e}={}){let d=null,h=0;if(0===h){if(!e||"object"!=typeof e||Array.isArray(e))return c.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.id&&(r="id")||void 0===e.name&&(r="name")||void 0===e.shortname&&(r="shortname")||void 0===e.description&&(r="description")||void 0===e.version&&(r="version")||void 0===e.license&&(r="license")||void 0===e.repository&&(r="repository")||void 0===e.bugs&&(r="bugs")||void 0===e.maintainers&&(r="maintainers")||void 0===e.legacyIds&&(r="legacyIds")||void 0===e.runtime&&(r="runtime")||void 0===e.manufacturer&&(r="manufacturer")||void 0===e.products&&(r="products")||void 0===e.keywords&&(r="keywords"))return c.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;{const r=h;for(const r in e)if(!s.call(n.properties,r))return c.errors=[{instancePath:t,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===h){if(void 0!==e.$schema){const r=h;if("string"!=typeof e.$schema)return c.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var p=r===h}else p=!0;if(p){if(void 0!==e.id){const r=h;if("string"!=typeof e.id)return c.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.name){const r=h;if("string"!=typeof e.name)return c.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.shortname){const r=h;if("string"!=typeof e.shortname)return c.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.description){const r=h;if("string"!=typeof e.description)return c.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.version){const r=h;if("string"!=typeof e.version)return c.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.license){const r=h;if("string"!=typeof e.license)return c.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.repository){const r=h;if("string"!=typeof e.repository)return c.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.bugs){const r=h;if("string"!=typeof e.bugs)return c.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.maintainers){let r=e.maintainers;const n=h;if(h===n){if(!Array.isArray(r))return c.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var f=!0;const e=r.length;for(let n=0;n<e;n++){let e=r[n];const i=h;if(h===i){if(!e||"object"!=typeof e||Array.isArray(e))return c.errors=[{instancePath:t+"/maintainers/"+n,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.name&&(r="name"))return c.errors=[{instancePath:t+"/maintainers/"+n,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;if(void 0!==e.name){const r=h;if("string"!=typeof e.name)return c.errors=[{instancePath:t+"/maintainers/"+n+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var m=r===h}else m=!0;if(m){if(void 0!==e.email){const r=h;if("string"!=typeof e.email)return c.errors=[{instancePath:t+"/maintainers/"+n+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===h}else m=!0;if(m)if(void 0!==e.github){const r=h;if("string"!=typeof e.github)return c.errors=[{instancePath:t+"/maintainers/"+n+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=r===h}else m=!0}}}if(!(f=i===h))break}if(f){let e,n=r.length;if(n>1)for(;n--;)for(e=n;e--;)if(o(r[n],r[e]))return c.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1}}}p=n===h}else p=!0;if(p){if(void 0!==e.legacyIds){let r=e.legacyIds;const n=h;if(h===n){if(!Array.isArray(r))return c.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var g=!0;const e=r.length;for(let n=0;n<e;n++){const e=h;if("string"!=typeof r[n])return c.errors=[{instancePath:t+"/legacyIds/"+n,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(g=e===h))break}if(g){let e,n=r.length;if(n>1){const i={};for(;n--;){let s=r[n];if("string"==typeof s){if("number"==typeof i[s])return e=i[s],c.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;i[s]=n}}}}}}p=n===h}else p=!0;if(p){if(void 0!==e.runtime){let r=e.runtime;const i=h;if(h===i){if(!r||"object"!=typeof r||Array.isArray(r))return c.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===r.type&&(e="type")||void 0===r.api&&(e="api")||void 0===r.apiVersion&&(e="apiVersion")||void 0===r.entrypoint&&(e="entrypoint"))return c.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==r.type){const e=h;if("string"!=typeof r.type)return c.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=e===h}else y=!0;if(y){if(void 0!==r.api){let e=r.api;const i=h;if("string"!=typeof e)return c.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return c.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:n.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;y=i===h}else y=!0;if(y){if(void 0!==r.apiVersion){const e=h;if("string"!=typeof r.apiVersion)return c.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;y=e===h}else y=!0;if(y)if(void 0!==r.entrypoint){const e=h;if("string"!=typeof r.entrypoint)return c.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;y=e===h}else y=!0}}}}p=i===h}else p=!0;if(p){if(void 0!==e.manufacturer){const r=h;if("string"!=typeof e.manufacturer)return c.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===h}else p=!0;if(p){if(void 0!==e.products){let r=e.products;const n=h;if(h===n){if(!Array.isArray(r))return c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(r.length<1)return c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var b=!0;const e=r.length;for(let n=0;n<e;n++){const e=h;if("string"!=typeof r[n])return c.errors=[{instancePath:t+"/products/"+n,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(b=e===h))break}if(b){let e,n=r.length;if(n>1){const i={};for(;n--;){let s=r[n];if("string"==typeof s){if("number"==typeof i[s])return e=i[s],c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;i[s]=n}}}}}}p=n===h}else p=!0;if(p){if(void 0!==e.keywords){let r=e.keywords;const n=h;if(h===n){if(!Array.isArray(r))return c.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var w=!0;const e=r.length;for(let n=0;n<e;n++){const e=h;if("string"!=typeof r[n])return c.errors=[{instancePath:t+"/keywords/"+n,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(w=e===h))break}if(w){let e,n=r.length;if(n>1){const i={};for(;n--;){let s=r[n];if("string"==typeof s){if("number"==typeof i[s])return e=i[s],c.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;i[s]=n}}}}}}p=n===h}else p=!0;if(p)if(void 0!==e.bonjourQueries){let r=e.bonjourQueries;const n=h;if(h===n){if(!r||"object"!=typeof r||Array.isArray(r))return c.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const e=h;for(const e in r)if(!a.test(e))return c.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"}],!1;if(e===h)for(const e in r)if(a.test(e)){let n=r[e];const s=h,o=h;let u=!1,l=null;const p=h;if(h==h)if(n&&"object"==typeof n&&!Array.isArray(n)){let r;if(void 0===n.type&&(r="type")||void 0===n.protocol&&(r="protocol")){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===d?d=[n]:d.push(n),h++}else{const r=h;for(const r in n)if("type"!==r&&"protocol"!==r&&"txt"!==r){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===d?d=[n]:d.push(n),h++;break}if(r===h){if(void 0!==n.type){const r=h;if("string"!=typeof n.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),h++}var v=r===h}else v=!0;if(v){if(void 0!==n.protocol){let r=n.protocol;const s=h;if("string"!=typeof r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),h++}if("tcp"!==r&&"udp"!==r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===d?d=[r]:d.push(r),h++}v=s===h}else v=!0;if(v)if(void 0!==n.txt){let r=n.txt;const i=h;if(h===i)if(r&&"object"==typeof r&&!Array.isArray(r)){const n=h;for(const n in r)if(!a.test(n)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"};null===d?d=[r]:d.push(r),h++;break}if(n===h)for(const n in r)if(a.test(n)){const i=h;if("string"!=typeof r[n]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+n.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),h++}if(i!==h)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[r]:d.push(r),h++}v=i===h}else v=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[r]:d.push(r),h++}p===h&&(u=!0,l=0);const f=h;if(h===f)if(Array.isArray(n)){const r=n.length;for(let s=0;s<r;s++){let r=n[s];const o=h;if(h==h)if(r&&"object"==typeof r&&!Array.isArray(r)){let n;if(void 0===r.type&&(n="type")||void 0===r.protocol&&(n="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"};null===d?d=[r]:d.push(r),h++}else{const n=h;for(const n in r)if("type"!==n&&"protocol"!==n&&"txt"!==n){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s,schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"};null===d?d=[r]:d.push(r),h++;break}if(n===h){if(void 0!==r.type){const n=h;if("string"!=typeof r.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),h++}var T=n===h}else T=!0;if(T){if(void 0!==r.protocol){let n=r.protocol;const o=h;if("string"!=typeof n){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[r]:d.push(r),h++}if("tcp"!==n&&"udp"!==n){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===d?d=[r]:d.push(r),h++}T=o===h}else T=!0;if(T)if(void 0!==r.txt){let n=r.txt;const i=h;if(h===i)if(n&&"object"==typeof n&&!Array.isArray(n)){const r=h;for(const r in n)if(!a.test(r)){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===d?d=[n]:d.push(n),h++;break}if(r===h)for(const r in n)if(a.test(r)){const i=h;if("string"!=typeof n[r]){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),h++}if(i!==h)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[r]:d.push(r),h++}T=i===h}else T=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[r]:d.push(r),h++}if(o!==h)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===d?d=[r]:d.push(r),h++}var _;if((_=f===h)&&u?(u=!1,l=[l,1]):_&&(u=!0,l=1),!u){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf"};return null===d?d=[r]:d.push(r),h++,c.errors=d,!1}if(h=o,null!==d&&(o?d.length=o:d=null),s!==h)break}}}p=n===h}else p=!0}}}}}}}}}}}}}}}}}}return c.errors=d,0===h}},7e3:(e,t,r)=>{"use strict";const n=r(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:r=0,maxWait:i=0,before:s=!1,after:o=!0}=t;if(!s&&!o)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let a,c,u;const l=function(...t){const n=this,l=s&&!a;return clearTimeout(a),a=setTimeout((()=>{a=void 0,c&&(clearTimeout(c),c=void 0),o&&(u=e.apply(n,t))}),r),i>0&&!c&&o&&(c=setTimeout((()=>{c=void 0,a&&(clearTimeout(a),a=void 0),u=e.apply(n,t)}),i)),l&&(u=e.apply(n,t)),u};return n(l,e),l.cancel=()=>{a&&(clearTimeout(a),a=void 0),c&&(clearTimeout(c),c=void 0)},l}},1635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>P,__assign:()=>s,__asyncDelegator:()=>S,__asyncGenerator:()=>k,__asyncValues:()=>E,__await:()=>A,__awaiter:()=>f,__classPrivateFieldGet:()=>N,__classPrivateFieldIn:()=>M,__classPrivateFieldSet:()=>D,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>F,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>i,__generator:()=>m,__importDefault:()=>I,__importStar:()=>O,__makeTemplateObject:()=>x,__metadata:()=>p,__param:()=>c,__propKey:()=>d,__read:()=>w,__rest:()=>o,__runInitializers:()=>l,__setFunctionName:()=>h,__spread:()=>v,__spreadArray:()=>_,__spreadArrays:()=>T,__values:()=>b,default:()=>U});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,i,s){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var m in n)f[m]="access"===m?{}:n[m];for(var m in n.access)f.access[m]=n.access[m];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(e||null))};var g=(0,r[p])("accessor"===c?{get:d.get,set:d.set}:d[u],f);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=o(g.get))&&(d.get=a),(a=o(g.set))&&(d.set=a),(a=o(g.init))&&i.unshift(a)}else(a=o(g))&&("field"===c?i.unshift(a):d[u]=a)}l&&Object.defineProperty(l,n.name,d),h=!0}function l(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))}function m(e,t){var r,n,i,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function T(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function _(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function A(e){return this instanceof A?(this.v=e,this):new A(e)}function k(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",(function(e){return function(t){return Promise.resolve(t).then(e,u)}})),n[Symbol.asyncIterator]=function(){return this},n;function o(e,t){i[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||a(e,t)}))},t&&(n[e]=t(n[e])))}function a(e,t){try{(r=i[e](t)).value instanceof A?Promise.resolve(r.value.v).then(c,u):l(s[0][2],r)}catch(e){l(s[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function S(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:A(e[n](t)),done:!1}:i?i(t):t}:i}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var C=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return C(t,e),t}function I(e){return e&&e.__esModule?e:{default:e}}function N(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function D(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function P(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var R="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function F(e){function t(t){e.error=e.hasError?new R(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return function i(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(i,(function(e){return t(e),i()}))}else n|=1}catch(e){t(e)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}const U={__extends:i,__assign:s,__rest:o,__decorate:a,__param:c,__metadata:p,__awaiter:f,__generator:m,__createBinding:g,__exportStar:y,__values:b,__read:w,__spread:v,__spreadArrays:T,__spreadArray:_,__await:A,__asyncGenerator:k,__asyncDelegator:S,__asyncValues:E,__makeTemplateObject:x,__importStar:O,__importDefault:I,__classPrivateFieldGet:N,__classPrivateFieldSet:D,__classPrivateFieldIn:M,__addDisposableResource:P,__disposeResources:F}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return r[e](s,s.exports,i),s.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var s=Object.create(null);i.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,i.d(s,o),s},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};i.r(e),i.d(e,{Decoder:()=>Fi,Encoder:()=>Pi,PacketType:()=>Mi,protocol:()=>Di});var t=i(6278);function r(e=0,{ceil:t=!0}={}){const r=e<0?1:0,n=Math.abs(Math.floor(e%1e3))||0,i=t?Math.ceil:Math.floor,s=1e3*Math.abs(i(e/1e3));return{negative:r,days:Math.floor(s/864e5)||0,hours:Math.floor(s%864e5/36e5)||0,minutes:Math.floor(s%36e5/6e4)||0,seconds:Math.floor(s%6e4/1e3)||0,decimals:Math.floor(n/100)}}function n(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}let s={};function o(){return s}const a={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function c(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const u={date:c({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:c({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:c({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},l={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function d(e){return(t,r)=>{let n;if("formatting"===(r?.context?String(r.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,i=r?.width?String(r.width):t;n=e.formattingValues[i]||e.formattingValues[t]}else{const t=e.defaultWidth,i=r?.width?String(r.width):e.defaultWidth;n=e.values[i]||e.values[t]}return n[e.argumentCallback?e.argumentCallback(t):t]}}function h(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const o=s[0],a=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(a)?function(e,t){for(let t=0;t<e.length;t++)if(e[t].test(o))return t}(a):function(e,t){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t].test(o))return t}(a);let u;return u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u,{value:u,rest:t.slice(o.length)}}}var p;const f={code:"en-US",formatDistance:(e,t,r)=>{let n;const i=a[e];return n="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n},formatLong:u,formatRelative:(e,t,r,n)=>l[e],localize:{ordinalNumber:(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:d({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:d({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:d({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:d({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:d({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(p={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const r=e.match(p.matchPattern);if(!r)return null;const n=r[0],i=e.match(p.parsePattern);if(!i)return null;let s=p.valueCallback?p.valueCallback(i[0]):i[0];return s=t.valueCallback?t.valueCallback(s):s,{value:s,rest:e.slice(n.length)}}),era:h({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:h({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:h({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:h({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:h({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function m(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):"number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?new Date(e):new Date(NaN)}const g=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},y=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},b={p:y,P:(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return g(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",g(n,t)).replace("{{time}}",y(i,t))}},w=/^D+$/,v=/^Y+$/,T=["D","DD","YY","YYYY"];function _(e){return w.test(e)}function A(e){return v.test(e)}function k(e,t,r){const n=function(e,t,r){const n="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,r);if(console.warn(n),T.includes(e))throw new RangeError(n)}class S{subPriority=0;validate(e,t){return!0}}class E extends S{constructor(e,t,r,n,i){super(),this.value=e,this.validateValue=t,this.setValue=r,this.priority=n,i&&(this.subPriority=i)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,r){return this.setValue(e,t,this.value,r)}}class x extends S{priority=10;subPriority=-1;set(e,t){return t.timestampIsSet?e:n(e,function(e,t){const r=t instanceof Date?n(t,0):new t(0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}(e,Date))}}class C{run(e,t,r,n){const i=this.parse(e,t,r,n);return i?{setter:new E(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(e,t,r){return!0}}Math.pow(10,8);const O=6048e5,I=864e5,N=6e4,D=36e5,M=/^(1[0-2]|0?\d)/,P=/^(3[0-1]|[0-2]?\d)/,R=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,F=/^(5[0-3]|[0-4]?\d)/,U=/^(2[0-3]|[0-1]?\d)/,j=/^(2[0-4]|[0-1]?\d)/,B=/^(1[0-1]|0?\d)/,L=/^(1[0-2]|0?\d)/,V=/^[0-5]?\d/,H=/^[0-5]?\d/,q=/^\d/,W=/^\d{1,2}/,Y=/^\d{1,3}/,z=/^\d{1,4}/,$=/^-?\d+/,G=/^-?\d/,Q=/^-?\d{1,2}/,K=/^-?\d{1,3}/,J=/^-?\d{1,4}/,Z=/^([+-])(\d{2})(\d{2})?|Z/,X=/^([+-])(\d{2})(\d{2})|Z/,ee=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,te=/^([+-])(\d{2}):(\d{2})|Z/,re=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function ne(e,t){return e?{value:t(e.value),rest:e.rest}:e}function ie(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function se(e,t){const r=t.match(e);if(!r)return null;if("Z"===r[0])return{value:0,rest:t.slice(1)};const n="+"===r[1]?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(i*D+s*N+1e3*o),rest:t.slice(r[0].length)}}function oe(e){return ie($,e)}function ae(e,t){switch(e){case 1:return ie(q,t);case 2:return ie(W,t);case 3:return ie(Y,t);case 4:return ie(z,t);default:return ie(new RegExp("^\\d{1,"+e+"}"),t)}}function ce(e,t){switch(e){case 1:return ie(G,t);case 2:return ie(Q,t);case 3:return ie(K,t);case 4:return ie(J,t);default:return ie(new RegExp("^-?\\d{1,"+e+"}"),t)}}function ue(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function le(e,t){const r=t>0,n=r?t:1-t;let i;if(n<=50)i=e||100;else{const t=n+50;i=e+100*Math.trunc(t/100)-(e>=t%100?100:0)}return r?i:1-i}function de(e){return e%400==0||e%4==0&&e%100!=0}function he(e,t){const r=o(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=m(e),s=i.getDay(),a=(s<n?7:0)+s-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function pe(e,t){const r=m(e),i=r.getFullYear(),s=o(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,c=n(e,0);c.setFullYear(i+1,0,a),c.setHours(0,0,0,0);const u=he(c,t),l=n(e,0);l.setFullYear(i,0,a),l.setHours(0,0,0,0);const d=he(l,t);return r.getTime()>=u.getTime()?i+1:r.getTime()>=d.getTime()?i:i-1}function fe(e){return he(e,{weekStartsOn:1})}function me(e,t){const r=m(e),i=+he(r,t)-+function(e,t){const r=o(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=pe(e,t),a=n(e,0);return a.setFullYear(s,0,i),a.setHours(0,0,0,0),he(a,t)}(r,t);return Math.round(i/O)+1}function ge(e){const t=m(e),r=t.getFullYear(),i=n(e,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const s=fe(i),o=n(e,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const a=fe(o);return t.getTime()>=s.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function ye(e){const t=m(e),r=+fe(t)-+function(e){const t=ge(e),r=n(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),fe(r)}(t);return Math.round(r/O)+1}const be=[31,28,31,30,31,30,31,31,30,31,30,31],we=[31,29,31,30,31,30,31,31,30,31,30,31];function ve(e,t){const r=m(e);return isNaN(t)?n(e,NaN):t?(r.setDate(r.getDate()+t),r):r}function Te(e,t,r){const n=o(),i=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=m(e),a=s.getDay(),c=7-i;return ve(s,t<0||t>6?t-(a+c)%7:((t%7+7)%7+c)%7-(a+c)%7)}function _e(e,t){const r=m(e);return ve(r,t-function(e){let t=m(e).getDay();return 0===t&&(t=7),t}(r))}function Ae(e){const t=m(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}const ke={G:new class extends C{priority=140;parse(e,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"});case"GGGGG":return r.era(e,{width:"narrow"});default:return r.era(e,{width:"wide"})||r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"})}}set(e,t,r){return t.era=r,e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]},y:new class extends C{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,r){const n=e=>({year:e,isTwoDigitYear:"yy"===t});switch(t){case"y":return ne(ae(4,e),n);case"yo":return ne(r.ordinalNumber(e,{unit:"year"}),n);default:return ne(ae(t.length,e),n)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r){const n=e.getFullYear();if(r.isTwoDigitYear){const t=le(r.year,n);return e.setFullYear(t,0,1),e.setHours(0,0,0,0),e}const i="era"in t&&1!==t.era?1-r.year:r.year;return e.setFullYear(i,0,1),e.setHours(0,0,0,0),e}},Y:new class extends C{priority=130;parse(e,t,r){const n=e=>({year:e,isTwoDigitYear:"YY"===t});switch(t){case"Y":return ne(ae(4,e),n);case"Yo":return ne(r.ordinalNumber(e,{unit:"year"}),n);default:return ne(ae(t.length,e),n)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r,n){const i=pe(e,n);if(r.isTwoDigitYear){const t=le(r.year,i);return e.setFullYear(t,0,n.firstWeekContainsDate),e.setHours(0,0,0,0),he(e,n)}const s="era"in t&&1!==t.era?1-r.year:r.year;return e.setFullYear(s,0,n.firstWeekContainsDate),e.setHours(0,0,0,0),he(e,n)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:new class extends C{priority=130;parse(e,t){return ce("R"===t?4:t.length,e)}set(e,t,r){const i=n(e,0);return i.setFullYear(r,0,4),i.setHours(0,0,0,0),fe(i)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:new class extends C{priority=130;parse(e,t){return ce("u"===t?4:t.length,e)}set(e,t,r){return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},Q:new class extends C{priority=120;parse(e,t,r){switch(t){case"Q":case"QQ":return ae(t.length,e);case"Qo":return r.ordinalNumber(e,{unit:"quarter"});case"QQQ":return r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(e,{width:"narrow",context:"formatting"});default:return r.quarter(e,{width:"wide",context:"formatting"})||r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth(3*(r-1),1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:new class extends C{priority=120;parse(e,t,r){switch(t){case"q":case"qq":return ae(t.length,e);case"qo":return r.ordinalNumber(e,{unit:"quarter"});case"qqq":return r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(e,{width:"narrow",context:"standalone"});default:return r.quarter(e,{width:"wide",context:"standalone"})||r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth(3*(r-1),1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:new class extends C{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,r){const n=e=>e-1;switch(t){case"M":return ne(ie(M,e),n);case"MM":return ne(ae(2,e),n);case"Mo":return ne(r.ordinalNumber(e,{unit:"month"}),n);case"MMM":return r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(e,{width:"narrow",context:"formatting"});default:return r.month(e,{width:"wide",context:"formatting"})||r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}},L:new class extends C{priority=110;parse(e,t,r){const n=e=>e-1;switch(t){case"L":return ne(ie(M,e),n);case"LL":return ne(ae(2,e),n);case"Lo":return ne(r.ordinalNumber(e,{unit:"month"}),n);case"LLL":return r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(e,{width:"narrow",context:"standalone"});default:return r.month(e,{width:"wide",context:"standalone"})||r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:new class extends C{priority=100;parse(e,t,r){switch(t){case"w":return ie(F,e);case"wo":return r.ordinalNumber(e,{unit:"week"});default:return ae(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r,n){return he(function(e,t,r){const n=m(e),i=me(n,r)-t;return n.setDate(n.getDate()-7*i),n}(e,r,n),n)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:new class extends C{priority=100;parse(e,t,r){switch(t){case"I":return ie(F,e);case"Io":return r.ordinalNumber(e,{unit:"week"});default:return ae(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r){return fe(function(e,t){const r=m(e),n=ye(r)-t;return r.setDate(r.getDate()-7*n),r}(e,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:new class extends C{priority=90;subPriority=1;parse(e,t,r){switch(t){case"d":return ie(P,e);case"do":return r.ordinalNumber(e,{unit:"date"});default:return ae(t.length,e)}}validate(e,t){const r=de(e.getFullYear()),n=e.getMonth();return r?t>=1&&t<=we[n]:t>=1&&t<=be[n]}set(e,t,r){return e.setDate(r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:new class extends C{priority=90;subpriority=1;parse(e,t,r){switch(t){case"D":case"DD":return ie(R,e);case"Do":return r.ordinalNumber(e,{unit:"date"});default:return ae(t.length,e)}}validate(e,t){return de(e.getFullYear())?t>=1&&t<=366:t>=1&&t<=365}set(e,t,r){return e.setMonth(0,r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:new class extends C{priority=90;parse(e,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,n){return(e=Te(e,r,n)).setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]},e:new class extends C{priority=90;parse(e,t,r,n){const i=e=>{const t=7*Math.floor((e-1)/7);return(e+n.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return ne(ae(t.length,e),i);case"eo":return ne(r.ordinalNumber(e,{unit:"day"}),i);case"eee":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeeee":return r.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,n){return(e=Te(e,r,n)).setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:new class extends C{priority=90;parse(e,t,r,n){const i=e=>{const t=7*Math.floor((e-1)/7);return(e+n.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return ne(ae(t.length,e),i);case"co":return ne(r.ordinalNumber(e,{unit:"day"}),i);case"ccc":return r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"ccccc":return r.day(e,{width:"narrow",context:"standalone"});case"cccccc":return r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});default:return r.day(e,{width:"wide",context:"standalone"})||r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,n){return(e=Te(e,r,n)).setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:new class extends C{priority=90;parse(e,t,r){const n=e=>0===e?7:e;switch(t){case"i":case"ii":return ae(t.length,e);case"io":return r.ordinalNumber(e,{unit:"day"});case"iii":return ne(r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),n);case"iiiii":return ne(r.day(e,{width:"narrow",context:"formatting"}),n);case"iiiiii":return ne(r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),n);default:return ne(r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),n)}}validate(e,t){return t>=1&&t<=7}set(e,t,r){return(e=_e(e,r)).setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:new class extends C{priority=80;parse(e,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(e,{width:"narrow",context:"formatting"});default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(ue(r),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]},b:new class extends C{priority=80;parse(e,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(e,{width:"narrow",context:"formatting"});default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(ue(r),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]},B:new class extends C{priority=80;parse(e,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(e,{width:"narrow",context:"formatting"});default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(ue(r),0,0,0),e}incompatibleTokens=["a","b","t","T"]},h:new class extends C{priority=70;parse(e,t,r){switch(t){case"h":return ie(L,e);case"ho":return r.ordinalNumber(e,{unit:"hour"});default:return ae(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,r){const n=e.getHours()>=12;return n&&r<12?e.setHours(r+12,0,0,0):n||12!==r?e.setHours(r,0,0,0):e.setHours(0,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]},H:new class extends C{priority=70;parse(e,t,r){switch(t){case"H":return ie(U,e);case"Ho":return r.ordinalNumber(e,{unit:"hour"});default:return ae(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,r){return e.setHours(r,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]},K:new class extends C{priority=70;parse(e,t,r){switch(t){case"K":return ie(B,e);case"Ko":return r.ordinalNumber(e,{unit:"hour"});default:return ae(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.getHours()>=12&&r<12?e.setHours(r+12,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]},k:new class extends C{priority=70;parse(e,t,r){switch(t){case"k":return ie(j,e);case"ko":return r.ordinalNumber(e,{unit:"hour"});default:return ae(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,r){const n=r<=24?r%24:r;return e.setHours(n,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]},m:new class extends C{priority=60;parse(e,t,r){switch(t){case"m":return ie(V,e);case"mo":return r.ordinalNumber(e,{unit:"minute"});default:return ae(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setMinutes(r,0,0),e}incompatibleTokens=["t","T"]},s:new class extends C{priority=50;parse(e,t,r){switch(t){case"s":return ie(H,e);case"so":return r.ordinalNumber(e,{unit:"second"});default:return ae(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setSeconds(r,0),e}incompatibleTokens=["t","T"]},S:new class extends C{priority=30;parse(e,t){return ne(ae(t.length,e),(e=>Math.trunc(e*Math.pow(10,3-t.length))))}set(e,t,r){return e.setMilliseconds(r),e}incompatibleTokens=["t","T"]},X:new class extends C{priority=10;parse(e,t){switch(t){case"X":return se(Z,e);case"XX":return se(X,e);case"XXXX":return se(ee,e);case"XXXXX":return se(re,e);default:return se(te,e)}}set(e,t,r){return t.timestampIsSet?e:n(e,e.getTime()-Ae(e)-r)}incompatibleTokens=["t","T","x"]},x:new class extends C{priority=10;parse(e,t){switch(t){case"x":return se(Z,e);case"xx":return se(X,e);case"xxxx":return se(ee,e);case"xxxxx":return se(re,e);default:return se(te,e)}}set(e,t,r){return t.timestampIsSet?e:n(e,e.getTime()-Ae(e)-r)}incompatibleTokens=["t","T","X"]},t:new class extends C{priority=40;parse(e){return oe(e)}set(e,t,r){return[n(e,1e3*r),{timestampIsSet:!0}]}incompatibleTokens="*"},T:new class extends C{priority=20;parse(e){return oe(e)}set(e,t,r){return[n(e,r),{timestampIsSet:!0}]}incompatibleTokens="*"}},Se=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ee=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,xe=/^'([^]*?)'?$/,Ce=/''/g,Oe=/\S/,Ie=/[a-zA-Z]/;function Ne(e,t,r,i){const s=Object.assign({},o()),a=i?.locale??s.locale??f,c=i?.firstWeekContainsDate??i?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,u=i?.weekStartsOn??i?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(""===t)return""===e?m(r):n(r,NaN);const l={firstWeekContainsDate:c,weekStartsOn:u,locale:a},d=[new x],h=t.match(Ee).map((e=>{const t=e[0];return t in b?(0,b[t])(e,a.formatLong):e})).join("").match(Se),p=[];for(let s of h){!i?.useAdditionalWeekYearTokens&&A(s)&&k(s,t,e),!i?.useAdditionalDayOfYearTokens&&_(s)&&k(s,t,e);const o=s[0],c=ke[o];if(c){const{incompatibleTokens:t}=c;if(Array.isArray(t)){const e=p.find((e=>t.includes(e.token)||e.token===o));if(e)throw new RangeError(`The format string mustn't contain \`${e.fullToken}\` and \`${s}\` at the same time`)}else if("*"===c.incompatibleTokens&&p.length>0)throw new RangeError(`The format string mustn't contain \`${s}\` and any other token at the same time`);p.push({token:o,fullToken:s});const i=c.run(e,s,a.match,l);if(!i)return n(r,NaN);d.push(i.setter),e=i.rest}else{if(o.match(Ie))throw new RangeError("Format string contains an unescaped latin alphabet character `"+o+"`");if("''"===s?s="'":"'"===o&&(s=s.match(xe)[1].replace(Ce,"'")),0!==e.indexOf(s))return n(r,NaN);e=e.slice(s.length)}}if(e.length>0&&Oe.test(e))return n(r,NaN);const g=d.map((e=>e.priority)).sort(((e,t)=>t-e)).filter(((e,t,r)=>r.indexOf(e)===t)).map((e=>d.filter((t=>t.priority===e)).sort(((e,t)=>t.subPriority-e.subPriority)))).map((e=>e[0]));let y=m(r);if(isNaN(y.getTime()))return n(r,NaN);const w={};for(const e of g){if(!e.validate(y,l))return n(r,NaN);const t=e.set(y,w,l);Array.isArray(t)?(y=t[0],Object.assign(w,t[1])):y=t}return n(r,y)}const De={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Me=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Pe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Re=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Fe(e){return e?parseInt(e):1}function Ue(e){return e&&parseFloat(e.replace(",","."))||0}const je=[31,null,31,30,31,30,31,31,30,31,30,31];function Be(e){return e%400==0||e%4==0&&e%100!=0}const Le={year:0,month:1,day:2,hour:3,minute:4,second:5},Ve={};function He(e,t,r,n,i,s,o){const a=new Date(0);return a.setUTCFullYear(e,t,r),a.setUTCHours(n,i,s,o),a}const qe=36e5,We=6e4,Ye={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function ze(e,t,r){if(!e)return 0;let n,i,s=Ye.timezoneZ.exec(e);if(s)return 0;if(s=Ye.timezoneHH.exec(e),s)return n=parseInt(s[1],10),Ge(n)?-n*qe:NaN;if(s=Ye.timezoneHHMM.exec(e),s){n=parseInt(s[2],10);const e=parseInt(s[3],10);return Ge(n,e)?(i=Math.abs(n)*qe+e*We,"+"===s[1]?-i:i):NaN}if(function(e){if(Qe[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),Qe[e]=!0,!0}catch(e){return!1}}(e)){t=new Date(t||Date.now());const n=r?t:function(e){return He(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}(t),i=$e(n,e),s=r?i:function(e,t,r){let n=e.getTime()-t;const i=$e(new Date(n),r);if(t===i)return t;n-=i-t;const s=$e(new Date(n),r);return i===s?i:Math.max(i,s)}(t,i,e);return-s}return NaN}function $e(e,t){const r=function(e,t){const r=function(e){if(!Ve[e]){const t=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r="06/25/2014, 00:00:00"===t||"‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00"===t;Ve[e]=r?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return Ve[e]}(t);return"formatToParts"in r?function(e,t){try{const r=e.formatToParts(t),n=[];for(let e=0;e<r.length;e++){const t=Le[r[e].type];void 0!==t&&(n[t]=parseInt(r[e].value,10))}return n}catch(e){if(e instanceof RangeError)return[NaN];throw e}}(r,e):function(e,t){const r=e.format(t),n=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[parseInt(n[3],10),parseInt(n[1],10),parseInt(n[2],10),parseInt(n[4],10),parseInt(n[5],10),parseInt(n[6],10)]}(r,e)}(e,t),n=He(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime();let i=e.getTime();const s=i%1e3;return i-=s>=0?s:1e3+s,n-i}function Ge(e,t){return-23<=e&&e<=23&&(null==t||0<=t&&t<=59)}const Qe={};function Ke(e,t){return-ze(e,t)}function Je(e,t){return n(e,+m(e)+t)}function Ze(e){return e instanceof Date&&!isNaN(e)}function Xe(e,t=void 0){if("boolean"==typeof e)return null;if([null,void 0].includes(e))return null;if(Ze(e))return new Date(e);if("string"==typeof e){if(/^(\d{4})-(\d{2})-(\d{2})$/.test(e)){const i=Ne(e,"yyyy-MM-dd",new Date);if(!t)return i;const s=(r=i,n=-i.getTimezoneOffset(),Je(r,n*N));return Je(s,Ke(t,s))}if(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})$/.test(e))return Ne(e,"yyyy-MM-dd'T'HH:mm:ss",new Date)}var r,n;const i=new Date(e);if(Ze(i))return i;if("string"==typeof e){const t=function(e,t){const r=t?.additionalDigits??2,n=function(e){const t={},r=e.split(De.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],De.timeZoneDelimiter.test(t.date)&&(t.date=e.split(De.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const e=De.timezone.exec(n);e?(t.time=n.replace(e[1],""),t.timezone=e[1]):t.time=n}return t}(e);let i;if(n.date){const e=function(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:null===s?i:100*s,restDateString:e.slice((n[1]||n[2]).length)}}(n.date,r);i=function(e,t){if(null===t)return new Date(NaN);const r=e.match(Me);if(!r)return new Date(NaN);const n=!!r[4],i=Fe(r[1]),s=Fe(r[2])-1,o=Fe(r[3]),a=Fe(r[4]),c=Fe(r[5])-1;if(n)return function(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}(0,a,c)?function(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const i=7*(t-1)+r+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+i),n}(t,a,c):new Date(NaN);{const e=new Date(0);return function(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(je[t]||(Be(e)?29:28))}(t,s,o)&&function(e,t){return t>=1&&t<=(Be(e)?366:365)}(t,i)?(e.setUTCFullYear(t,s,Math.max(i,o)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const s=i.getTime();let o,a=0;if(n.time&&(a=function(e){const t=e.match(Pe);if(!t)return NaN;const r=Ue(t[1]),n=Ue(t[2]),i=Ue(t[3]);return function(e,t,r){return 24===e?0===t&&0===r:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}(r,n,i)?r*D+n*N+1e3*i:NaN}(n.time),isNaN(a)))return new Date(NaN);if(!n.timezone){const e=new Date(s+a),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return o=function(e){if("Z"===e)return 0;const t=e.match(Re);if(!t)return 0;const r="+"===t[1]?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return function(e,t){return t>=0&&t<=59}(0,i)?r*(n*D+i*N):NaN}(n.timezone),isNaN(o)?new Date(NaN):new Date(s+a+o)}(e);if(Ze(t))return t}return null}const et={"Acre Time":"ACT","Afghanistan Time":"AFT","Alaska Daylight Time":"AKDT","Alaska Standard Time":"AKST","Alma-Ata Time":"ALMT","Alpha Time Zone":"A","Amazon Summer Time":"AMST","Amazon Time":"AMT","Anadyr Summer Time":"ANAST","Anadyr Time":"ANAT","Anywhere on Earth":"AoE","Apia Time":"WST","Aqtobe Time":"AQTT","Arabia Daylight Time":"ADT","Arabia Standard Time":"AST","Arabian Time":"AST","Argentina Time":"ART","Armenia Summer Time":"AMST","Armenia Time":"AMT","Atlantic Daylight Time":"ADT","Atlantic Standard Time":"AST","Atlantic Time":"AT","Australian Central Daylight Time":"ACDT","Australian Central Standard Time":"ACST","Australian Central Time":"ACT","Australian Central Western Standard Time":"ACWST","Australian Eastern Daylight Time":"AEDT","Australian Eastern Standard Time":"AEST","Australian Eastern Time":"AET","Australian Western Daylight Time":"AWDT","Australian Western Standard Time":"AWST","Azerbaijan Summer Time":"AZST","Azerbaijan Time":"AZT","Azores Summer Time":"AZOST","Azores Time":"AZOT","Bangladesh Standard Time":"BST","Bhutan Time":"BTT","Bolivia Time":"BOT","Bougainville Standard Time":"BST","Brasilia Time":"BRT","Brasília Summer Time":"BRST","Brasília Time":"BRT","Bravo Time Zone":"B","British Summer Time":"BST","Brunei Darussalam Time":"BNT","Cape Verde Time":"CVT","Casey Time":"CAST","Cayman Islands Daylight Saving Time":"CIDST","Cayman Islands Standard Time":"CIST","Central Africa Time":"CAT","Central Daylight Time":"CDT","Central European Summer Time":"CEST","Central European Time":"CET","Central Indonesia Time":"WITA","Central Indonesian Time":"WITA","Central Standard Time":"CST","Central Time":"CT","Chamorro Standard Time":"ChST","Charlie Time Zone":"C","Chatham Island Daylight Time":"CHADT","Chatham Island Standard Time":"CHAST","Chatham Time":"CHAST","Chile Standard Time":"CLT","Chile Summer Time":"CLST","China Standard Time":"CST","Choibalsan Summer Time":"CHOST","Choibalsan Time":"CHOT","Christmas Island Time":"CXT","Chuuk Time":"CHUT","Cocos Islands Time":"CCT","Colombia Time":"COT","Cook Island Time":"CKT","Cook Islands Time":"CKT","Coordinated Universal Time":"UTC","Cuba Daylight Time":"CDT","Cuba Standard Time":"CST","Davis Time":"DAVT","Delta Time Zone":"D","Dumont-d'Urville Time":"DDUT","Dumont-d’Urville Time":"DDUT","East Africa Time":"EAT","East Greenland Time":"EGT","East Kazakhstan Time":"ALMT","East Timor Time":"TLT","Easter Island Standard Time":"EAST","Easter Island Summer Time":"EASST","Eastern Africa Time":"EAT","Eastern Daylight Time":"EDT","Eastern European Summer Time":"EEST","Eastern European Time":"EET","Eastern Greenland Summer Time":"EGST","Eastern Indonesia Time":"WIT","Eastern Indonesian Time":"WIT","Eastern Standard Time":"EST","Eastern Time":"ET","Echo Time Zone":"E","Ecuador Time":"ECT","Falkland Island Time":"FKT","Falkland Islands Summer Time":"FKST","Falkland Islands Time":"FKST","Fernando de Noronha Time":"FNT","Fiji Summer Time":"FJST","Fiji Time":"FJT","Foxtrot Time Zone":"F","French Guiana Time":"GFT","French Southern & Antarctic Time":"FSAT","French Southern and Antarctic Time":"TFT","Further-Eastern European Time":"FET","Galapagos Time":"GALT","Gambier Time":"GAMT","Georgia Standard Time":"GET","Gilbert Island Time":"GILT","Gilbert Islands Time":"GILT","Golf Time Zone":"G","Greenwich Mean Time":"GMT","Gulf Standard Time":"GST","Guyana Time":"GYT","Hawaii Standard Time":"HST","Hawaii-Aleutian Daylight Time":"HDT","Hawaii-Aleutian Standard Time":"HAST","Hong Kong Time":"HKT","Hotel Time Zone":"H","Hovd Summer Time":"HOVST","Hovd Time":"HOVT","India Standard Time":"IST","India Time Zone":"I","Indian Chagos Time":"IOT","Indian Ocean Time":"IOT","Indochina Time":"ICT","Iran Daylight Time":"IRDT","Iran Standard Time":"IRST","Irish Standard Time":"IST","Irkutsk Summer Time":"IRKST","Irkutsk Time":"IRKT","Israel Daylight Time":"IDT","Israel Standard Time":"IST","Japan Standard Time":"JST","Kamchatka Summer Time":"PETST","Kamchatka Time":"PETT","Kilo Time Zone":"K","Korea Standard Time":"KST","Korean Time":"KST","Kosrae Time":"KOST","Krasnoyarsk Summer Time":"KRAST","Krasnoyarsk Time":"KRAT","Kuybyshev Time":"KUYT","Kyrgyzstan Time":"KGT","Lima Time Zone":"L","Line Islands Time":"LINT","Lord Howe Daylight Time":"LHDT","Lord Howe Standard Time":"LHST","Magadan Summer Time":"MAGST","Magadan Time":"MAGT","Malaysia Time":"MYT","Maldives Time":"MVT","Marquesas Time":"MART","Marshall Islands Time":"MHT","Mauritius Time":"MUT","Mawson Time":"MAWT","Mike Time Zone":"M","Moscow Daylight Time":"MSD","Moscow Standard Time":"MSK","Mountain Daylight Time":"MDT","Mountain Standard Time":"MST","Mountain Time":"MT","Myanmar Time":"MMT","Nauru Time":"NRT","Nepal Time":"NPT","New Caledonia Time":"NCT","New Zealand Daylight Time":"NZDT","New Zealand Standard Time":"NZST","Newfoundland Daylight Time":"NDT","Newfoundland Standard Time":"NST","Niue Time":"NUT","Norfolk Daylight Time":"NFDT","Norfolk Island Time":"NFT","Norfolk Time":"NFT","November Time Zone":"N","Novosibirsk Summer Time":"NOVST","Novosibirsk Time":"NOVT","Omsk Standard Time":"OMST","Omsk Summer Time":"OMSST","Oral Time":"ORAT","Oscar Time Zone":"O","Pacific Daylight Time":"PDT","Pacific Standard Time":"PST","Pacific Time":"PT","Pakistan Standard Time":"PKT","Palau Time":"PWT","Papa Time Zone":"P","Papua New Guinea Time":"PGT","Paraguay Summer Time":"PYST","Paraguay Time":"PYT","Peru Time":"PET","Petropavlovsk-Kamchatski Time":"PETT","Philippine Time":"PHT","Phoenix Island Time":"PHOT","Phoenix Islands Time":"PHOT","Pierre & Miquelon Daylight Time":"PMDT","Pierre & Miquelon Standard Time":"PMST","Pitcairn Standard Time":"PST","Pohnpei Standard Time":"PONT","Pyongyang Time":"PYT","Quebec Time Zone":"Q","Qyzylorda Time":"QYZT","Reunion Time":"RET","Romeo Time Zone":"R","Rothera Time":"ROTT","Réunion Time":"RET","Sakhalin Time":"SAKT","Samara Time":"SAMT","Samoa Standard Time":"SST","Seychelles Time":"SCT","Sierra Time Zone":"S","Singapore Time":"SGT","Solomon Islands Time":"SBT","South Africa Standard Time":"SAST","South Georgia Time":"GST","Srednekolymsk Time":"SRET","St. Pierre & Miquelon Time":"PM","Suriname Time":"SRT","Syowa Time":"SYOT","Tahiti Time":"TAHT","Taipei Time":"TWT","Tajikistan Time":"TJT","Tango Time Zone":"T","Tokelau Time":"TKT","Tonga Summer Time":"TOST","Tonga Time":"TOT","Turkey Time":"TRT","Turkmenistan Time":"TMT","Tuvalu Time":"TVT","Ulaanbaatar Summer Time":"ULAST","Ulaanbaatar Time":"ULAT","Uniform Time Zone":"U","Uruguay Summer Time":"UYST","Uruguay Time":"UYT","Uzbekistan Time":"UZT","Vanuatu Time":"VUT","Venezuela Time":"VET","Venezuelan Standard Time":"VET","Victor Time Zone":"V","Vladivostok Summer Time":"VLAST","Vladivostok Time":"VLAT","Vostok Time":"VOST","Wake Island Time":"WAKT","Wake Time":"WAKT","Wallis & Futuna Time":"WFT","Wallis and Futuna Time":"WFT","West Africa Summer Time":"WAST","West Africa Time":"WAT","West Greenland Time":"WGT","West Kazakhstan Time":"AQTT","West Samoa Time":"WST","Western Argentine Summer Time":"WARST","Western European Summer Time":"WEST","Western European Time":"WET","Western Greenland Summer Time":"WGST","Western Indonesia Time":"WIB","Western Indonesian Time":"WIB","Western Sahara Standard Time":"WT","Western Sahara Summer Time":"WST","Whiskey Time Zone":"W","X-ray Time Zone":"X","Yakutsk Summer Time":"YAKST","Yakutsk Time":"YAKT","Yankee Time Zone":"Y","Yap Time":"YAPT","Yekaterinburg Summer Time":"YEKST","Yekaterinburg Time":"YEKT","Yukon Time":"YT","Zulu Time Zone":"Z"};function tt(e,t="long",r=new Date){if(!e)return"";const n={timeZone:e},i=Array.isArray(t)?t:[t];for(let t of i)switch(t){case"city":const t=e.split("/");return`${t[0]} / ${t.pop()}`.replace(/_/g," ");case"long":return n.timeZoneName="long",new Intl.DateTimeFormat("en-US",n).format(r).split(", ")[1];case"abbr":n.timeZoneName="long";const i=new Intl.DateTimeFormat("en-US",n).format(r).split(", ")[1],s=et[i]||et[i.replace("Standard ","")];if(s)return s;break;case"offset":let o="";try{n.timeZoneName="longOffset",o=new Intl.DateTimeFormat("en-US",n).format(r).split(", ")[1]}catch{n.timeZoneName="short",o=new Intl.DateTimeFormat("en-US",n).format(r).split(", ")[1]}return"GMT"===o?"GMT+00:00":o;default:throw new Error("Format option must be one of 'city', 'long', 'abbr' or 'offset'")}return""}function rt(e){const t=m(e);return t.setHours(0,0,0,0),t}function nt(e){const t=m(e);return function(e,t){const r=rt(e),n=rt(t),i=+r-Ae(r),s=+n-Ae(n);return Math.round((i-s)/I)}(t,function(e){const t=m(e),r=n(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}(t))+1}function it(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const st={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return it("yy"===t?n%100:n,t.length)},M(e,t){const r=e.getMonth();return"M"===t?String(r+1):it(r+1,2)},d:(e,t)=>it(e.getDate(),t.length),a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return"am"===r?"a.m.":"p.m."}},h:(e,t)=>it(e.getHours()%12||12,t.length),H:(e,t)=>it(e.getHours(),t.length),m:(e,t)=>it(e.getMinutes(),t.length),s:(e,t)=>it(e.getSeconds(),t.length),S(e,t){const r=t.length,n=e.getMilliseconds();return it(Math.trunc(n*Math.pow(10,r-3)),t.length)}},ot={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if("yo"===t){const t=e.getFullYear(),n=t>0?t:1-t;return r.ordinalNumber(n,{unit:"year"})}return st.y(e,t)},Y:function(e,t,r,n){const i=pe(e,n),s=i>0?i:1-i;return"YY"===t?it(s%100,2):"Yo"===t?r.ordinalNumber(s,{unit:"year"}):it(s,t.length)},R:function(e,t){return it(ge(e),t.length)},u:function(e,t){return it(e.getFullYear(),t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return it(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return it(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return st.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return it(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=me(e,n);return"wo"===t?r.ordinalNumber(i,{unit:"week"}):it(i,t.length)},I:function(e,t,r){const n=ye(e);return"Io"===t?r.ordinalNumber(n,{unit:"week"}):it(n,t.length)},d:function(e,t,r){return"do"===t?r.ordinalNumber(e.getDate(),{unit:"date"}):st.d(e,t)},D:function(e,t,r){const n=nt(e);return"Do"===t?r.ordinalNumber(n,{unit:"dayOfYear"}):it(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return it(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return it(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=0===n?7:n;switch(t){case"i":return String(i);case"ii":return it(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(i=12===n?"noon":0===n?"midnight":n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(i=n>=17?"evening":n>=12?"afternoon":n>=4?"morning":"night",t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),r.ordinalNumber(t,{unit:"hour"})}return st.h(e,t)},H:function(e,t,r){return"Ho"===t?r.ordinalNumber(e.getHours(),{unit:"hour"}):st.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return"Ko"===t?r.ordinalNumber(n,{unit:"hour"}):it(n,t.length)},k:function(e,t,r){let n=e.getHours();return 0===n&&(n=24),"ko"===t?r.ordinalNumber(n,{unit:"hour"}):it(n,t.length)},m:function(e,t,r){return"mo"===t?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):st.m(e,t)},s:function(e,t,r){return"so"===t?r.ordinalNumber(e.getSeconds(),{unit:"second"}):st.s(e,t)},S:function(e,t){return st.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(0===n)return"Z";switch(t){case"X":return ct(n);case"XXXX":case"XX":return ut(n);default:return ut(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return ct(n);case"xxxx":case"xx":return ut(n);default:return ut(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+at(n,":");default:return"GMT"+ut(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+at(n,":");default:return"GMT"+ut(n,":")}},t:function(e,t,r){return it(Math.trunc(e.getTime()/1e3),t.length)},T:function(e,t,r){return it(e.getTime(),t.length)}};function at(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return 0===s?r+String(i):r+String(i)+t+it(s,2)}function ct(e,t){return e%60==0?(e>0?"-":"+")+it(Math.abs(e)/60,2):ut(e,t)}function ut(e,t=""){const r=e>0?"-":"+",n=Math.abs(e);return r+it(Math.trunc(n/60),2)+t+it(n%60,2)}function lt(e){if(!(t=e,t instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)||"number"==typeof e))return!1;var t;const r=m(e);return!isNaN(Number(r))}const dt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ht=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,pt=/^'([^]*?)'?$/,ft=/''/g,mt=/[a-zA-Z]/;function gt(e){const t=e.match(pt);return t?t[1].replace(ft,"'"):e}function yt(e,t,r){const n=function(e,t,r){return new Intl.DateTimeFormat(r?[r.code,"en-US"]:void 0,{timeZone:t,timeZoneName:e})}(e,r.timeZone,r.locale);return"formatToParts"in n?function(e,t){const r=e.formatToParts(t);for(let e=r.length-1;e>=0;--e)if("timeZoneName"===r[e].type)return r[e].value}(n,t):function(e,t){const r=e.format(t).replace(/\u200E/g,""),n=/ [\w-+ ]+$/.exec(r);return n?n[0].substr(1):""}(n,t)}const bt={X:function(e,t,r){const n=wt(r.timeZone,e);if(0===n)return"Z";switch(t){case"X":return _t(n);case"XXXX":case"XX":return Tt(n);default:return Tt(n,":")}},x:function(e,t,r){const n=wt(r.timeZone,e);switch(t){case"x":return _t(n);case"xxxx":case"xx":return Tt(n);default:return Tt(n,":")}},O:function(e,t,r){const n=wt(r.timeZone,e);switch(t){case"O":case"OO":case"OOO":return"GMT"+function(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.floor(n/60),s=n%60;return 0===s?r+String(i):r+String(i)+t+vt(s,2)}(n,":");default:return"GMT"+Tt(n,":")}},z:function(e,t,r){switch(t){case"z":case"zz":case"zzz":return yt("short",e,r);default:return yt("long",e,r)}}};function wt(e,t){const r=e?ze(e,t,!0)/6e4:t?.getTimezoneOffset()??0;if(Number.isNaN(r))throw new RangeError("Invalid time zone specified: "+e);return r}function vt(e,t){const r=e<0?"-":"";let n=Math.abs(e).toString();for(;n.length<t;)n="0"+n;return r+n}function Tt(e,t=""){const r=e>0?"-":"+",n=Math.abs(e);return r+vt(Math.floor(n/60),2)+t+vt(Math.floor(n%60),2)}function _t(e,t){return e%60==0?(e>0?"-":"+")+vt(Math.abs(e)/60,2):Tt(e,t)}function At(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+e-+t}const kt=36e5,St=6e4,Et=2,xt={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/};function Ct(e,t={}){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);const r=null==t.additionalDigits?Et:Number(t.additionalDigits);if(2!==r&&1!==r&&0!==r)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());if("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))return new Date(e);if("[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);const n=function(e){const t={};let r,n=xt.dateTimePattern.exec(e);if(n?(t.date=n[1],r=n[3]):(n=xt.datePattern.exec(e),n?(t.date=n[1],r=n[2]):(t.date=null,r=e)),r){const e=xt.timeZone.exec(r);e?(t.time=r.replace(e[1],""),t.timeZone=e[1].trim()):t.time=r}return t}(e),{year:i,restDateString:s}=function(e,t){if(e){const r=xt.YYY[t],n=xt.YYYYY[t];let i=xt.YYYY.exec(e)||n.exec(e);if(i){const t=i[1];return{year:parseInt(t,10),restDateString:e.slice(t.length)}}if(i=xt.YY.exec(e)||r.exec(e),i){const t=i[1];return{year:100*parseInt(t,10),restDateString:e.slice(t.length)}}}return{year:null}}(n.date,r),o=function(e,t){if(null===t)return null;let r,n,i;if(!e||!e.length)return r=new Date(0),r.setUTCFullYear(t),r;let s=xt.MM.exec(e);if(s)return r=new Date(0),n=parseInt(s[1],10)-1,Mt(t,n)?(r.setUTCFullYear(t,n),r):new Date(NaN);if(s=xt.DDD.exec(e),s){r=new Date(0);const e=parseInt(s[1],10);return function(e,t){if(t<1)return!1;const r=Dt(e);return!(r&&t>366)&&!(!r&&t>365)}(t,e)?(r.setUTCFullYear(t,0,e),r):new Date(NaN)}if(s=xt.MMDD.exec(e),s){r=new Date(0),n=parseInt(s[1],10)-1;const e=parseInt(s[2],10);return Mt(t,n,e)?(r.setUTCFullYear(t,n,e),r):new Date(NaN)}if(s=xt.Www.exec(e),s)return i=parseInt(s[1],10)-1,Pt(i)?Ot(t,i):new Date(NaN);if(s=xt.WwwD.exec(e),s){i=parseInt(s[1],10)-1;const e=parseInt(s[2],10)-1;return Pt(i,e)?Ot(t,i,e):new Date(NaN)}return null}(s,i);if(null===o||isNaN(o.getTime()))return new Date(NaN);if(o){const e=o.getTime();let r,i=0;if(n.time&&(i=function(e){let t,r,n=xt.HH.exec(e);if(n)return t=parseFloat(n[1].replace(",",".")),Rt(t)?t%24*kt:NaN;if(n=xt.HHMM.exec(e),n)return t=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),Rt(t,r)?t%24*kt+r*St:NaN;if(n=xt.HHMMSS.exec(e),n){t=parseInt(n[1],10),r=parseInt(n[2],10);const e=parseFloat(n[3].replace(",","."));return Rt(t,r,e)?t%24*kt+r*St+1e3*e:NaN}return null}(n.time),null===i||isNaN(i)))return new Date(NaN);if(n.timeZone||t.timeZone){if(r=ze(n.timeZone||t.timeZone,new Date(e+i)),isNaN(r))return new Date(NaN)}else r=At(new Date(e+i)),r=At(new Date(e+i+r));return new Date(e+i+r)}return new Date(NaN)}function Ot(e,t,r){t=t||0,r=r||0;const n=new Date(0);n.setUTCFullYear(e,0,4);const i=7*t+r+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+i),n}const It=[31,28,31,30,31,30,31,31,30,31,30,31],Nt=[31,29,31,30,31,30,31,31,30,31,30,31];function Dt(e){return e%400==0||e%4==0&&e%100!=0}function Mt(e,t,r){if(t<0||t>11)return!1;if(null!=r){if(r<1)return!1;const n=Dt(e);if(n&&r>Nt[t])return!1;if(!n&&r>It[t])return!1}return!0}function Pt(e,t){return!(e<0||e>52||null!=t&&(t<0||t>6))}function Rt(e,t,r){return!(e<0||e>=25||null!=t&&(t<0||t>=60)||null!=r&&(r<0||r>=60))}const Ft=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function Ut(e,t,r,n){return function(e,t,r={}){const n=(t=String(t)).match(Ft);if(n){const i=Ct(r.originalDate||e,r);t=n.reduce((function(e,t){if("'"===t[0])return e;const n=e.indexOf(t),s="'"===e[n-1],o=e.replace(t,"'"+bt[t[0]](i,t,r)+"'");return s?o.substring(0,n-1)+o.substring(n+1):o}),t)}return function(e,t,r){const n=o(),i=r?.locale??n.locale??f,s=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=m(e);if(!lt(c))throw new RangeError("Invalid time value");let u=t.match(ht).map((e=>{const t=e[0];return"p"===t||"P"===t?(0,b[t])(e,i.formatLong):e})).join("").match(dt).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:gt(e)};if(ot[t])return{isToken:!0,value:e};if(t.match(mt))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));i.localize.preprocessor&&(u=i.localize.preprocessor(c,u));const l={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return u.map((n=>{if(!n.isToken)return n.value;const s=n.value;return(!r?.useAdditionalWeekYearTokens&&A(s)||!r?.useAdditionalDayOfYearTokens&&_(s))&&k(s,t,String(e)),(0,ot[s[0]])(c,s,i.localize,l)})).join("")}(e,t,r)}(function(e,t,r){const n=ze(t,e=Ct(e,r),!0),i=new Date(e.getTime()-n),s=new Date(0);return s.setFullYear(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()),s.setHours(i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()),s}(e,t,{timeZone:(n={...n,timeZone:t,originalDate:e}).timeZone}),r,n)}function jt(e,{timezone:t="UTC",format:r="24h",seconds:n="always",leadingZero:i=!1}={}){if(!(e instanceof Date))throw new Error("`date` must be an instance of Date");let s={"24h":i?"HH:mm":"H:mm","12h":i?"hh:mm":"h:mm","12h_a":i?"hh:mm a":"h:mm a"}[r];return("always"===n||"nonzero"===n&&0!==function(e){return m(e).getSeconds()}(e))&&(s=s.replace(":mm",":mm:ss")),Ut(e,t,s)}Intl?.DateTimeFormat()?.resolvedOptions();const Bt="HHHMMSS",Lt=e=>Math.floor(e%10),Vt=e=>Math.floor(e/10%10),Ht=e=>Math.floor(e/100%10),qt=e=>Math.floor(e/1e3%10);function Wt(e,{format:t=Bt,overtimePrefix:r="+"}={}){const n=e.days+e.hours+e.minutes+e.seconds===0,i=t.includes("D"),s=t.includes("H"),o=t.includes("M"),a=t.includes("S"),c=t.includes("F"),u=t.includes("L"),l=[];!e.negative||!c&&n||l.push(r);let d=e.days;!s&&!o&&!a&&e.hours+e.minutes+e.seconds&&(d+=1),!i||!d&&(s||o||a)||(d>100&&l.push(Ht(d)),d>10&&l.push(Vt(d)),l.push(Lt(d)),u?l.push("d"," "):l.push(":"));let h=e.hours+(i?0:24*d);!o&&!a&&e.minutes+e.seconds&&(h+=1),s&&(h||d||!o&&!a)&&(h>=100&&!i&&(h>1e3&&l.push(qt(h)),l.push(Ht(h))),(h>=10||i&&!u&&d>0)&&l.push(Vt(h)),l.push(Lt(h)),u?l.push("h"," "):l.push(":"));let p=e.minutes+(s?0:60*h);!a&&e.seconds&&(p+=1),o&&((p||h)&&(p>=100&&!s&&(p>1e3&&l.push(qt(p)),l.push(Ht(p))),(p>=10||!u&&h>0)&&l.push(Vt(p))),l.push(Lt(p)),u?l.push("m"," "):l.push(":"));const f=e.seconds+(o?0:60*p);return a&&(f>=100&&!o&&(f>1e3&&l.push(qt(f)),l.push(Ht(f))),l.push(Vt(f)),l.push(Lt(f)),u&&l.push("s")),c&&(l.push("."),l.push(Lt(e.decimals))),l}Symbol.toStringTag,Symbol.toStringTag;const Yt="HHHMMSS",zt={DHHMMSS:(Symbol.toStringTag,"DHHMMSS"),DHHMMSSF:"DHHMMSSF",HHHMMSS:Yt,HHHMMSSF:"HHHMMSSF",MMMSS:"MMMSS",MMMSSF:"MMMSSF",SSS:"SSS",SSSF:"SSSF",L_D:"L_D",L_DH:"L_DH",L_DHM:"L_DHM",L_DHMS:"L_DHMS",L_HMS:"L_HMS",L_MS:"L_MS",L_S:"L_S"},$t=Yt,Gt=(Symbol.toStringTag,Symbol.toStringTag,Symbol.toStringTag,Symbol.toStringTag,Symbol.toStringTag,"COUNTDOWN"),Qt="COUNTUP",Kt="COUNTDOWN_TOD",Jt="COUNTUP_TOD",Zt="HIDDEN",Xt={COUNTDOWN:Gt,COUNTUP:Qt,TOD:"TOD",COUNTDOWN_TOD:Kt,COUNTUP_TOD:Jt,HIDDEN:Zt},er={...Xt},tr=Object.freeze(Object.defineProperty({__proto__:null,COUNTDOWN:Gt,COUNTDOWN_TOD:Kt,COUNTUP:Qt,COUNTUP_TOD:Jt,HIDDEN:Zt,TOD:"TOD",appearances:Xt,default:er},Symbol.toStringTag,{value:"Module"})),rr=(Symbol.toStringTag,Symbol.toStringTag,"COUNTDOWN"),nr="COUNTUP",ir="COUNTDOWN_TOD",sr="COUNTUP_TOD",or=(Symbol.toStringTag,Symbol.toStringTag,Symbol.toStringTag,"AUTO"),ar="H:mm:ss",cr="H:mm",ur="h:mm:ss aa",lr="h:mm aa",dr="h:mm:ss",hr="h:mm";Symbol.toStringTag,Symbol.toStringTag,Symbol.toStringTag,Symbol.toStringTag;function pr(e){return[{id:0,label:"(Default)"},...Object.entries(e).map((([e,t])=>({id:e,label:t})))]}function fr(e){return String(e).padStart(2,"0")}function mr(e){const t=`${e.negative?"+":""}${e.hours+24*e.days}`,r=fr(e.minutes),n=fr(e.seconds);return{human:`${t}:${r}:${n}`,hhh:t,mm:r,ss:n}}function gr(e,t){let r;return e.start_time&&(r=function(e,{timezone:t,after:r,now:n}={}){if(void 0!==r&&!(r instanceof Date))throw new Error("The `after` argument must be undefined or an instance of Date.");if(void 0!==n&&!(n instanceof Date))throw new Error("The `now` argument must be undefined or an instance of Date.");const i=function(e,t){if(void 0!==t&&!(t instanceof Date))throw new Error("The 2nd argument must be undefined or an instance of date.");const r=t||new Date,n=e?Ke(e,r):0,i=Je(r,n);return i.setUTCHours(0,0,0,0),Je(i,-n)}(t,n);let s=function(e,t,r){const n=Xe(e),i=Xe(t),s=r||"UTC";if(!Ze(n))return null;if(!Ze(i))return n;const o=Je(n,Ke(s,n)),a=Je(i,Ke(s,i));let c=new Date(o);return c.setUTCFullYear(a.getUTCFullYear()),c.setUTCMonth(a.getUTCMonth()),c.setUTCDate(a.getUTCDate()),Je(c,-Ke(s,c))}(Xe(e,t),r&&r>i?r:i,t);return s<r&&(s=ve(s,1)),s}(e.start_time,{timezone:t})),e.start_time_uses_date&&(r=Xe(e.start_time,t)),r}function yr(e){if("string"!=typeof e||!e)return;const[t,r,n]=e.split(":");return function({hours:e=0,minutes:t=0,seconds:r=0}={}){return 36e5*e+6e4*t+1e3*r}({hours:t,minutes:r,seconds:n})}function br(e){return 50*Math.floor(e/50)}Symbol.toStringTag;const wr=/^[A-Z0-9]{8}$/,vr=/^[a-f0-9-]{32}$/,Tr=/^https?:\/\/.*(\/v1\/)$/,_r={roomId:"",apiKey:"",apiUrl:""},Ar=[{type:"static-text",width:12,id:"info",label:"Information",value:'\n    Remotely control <a href="https://stagetimer.io/" target="_blank">Stagetimer.io</a> using Companion.<br><br>\n    Requires a Stagetimer.io account on a <b>paid plan</b> (<i>Pro</i> or <i>Premium</i>).<br><br>\n    Enter your <b>Room ID</b> and <b>API key</b> below to get started.<br>\n    You can generate an API key on the controller page.\n    '},{type:"textinput",width:4,id:"roomId",label:"Room ID",regex:wr.toString(),required:!0,default:"YOUR-ID"},{type:"textinput",width:8,id:"apiKey",label:"API Key",regex:vr.toString(),required:!0,default:"YOUR-KEY"},{type:"textinput",width:12,id:"apiUrl",label:"API URL",regex:Tr.toString(),required:!0,default:"https://api.stagetimer.io/v1/"}],kr=pr({white:"white",green:"green",red:"red"}),Sr="COUNTDOWN",Er="COUNTUP",xr="TOD",Cr="COUNTDOWN_TOD",Or="COUNTUP_TOD",Ir="HIDDEN",Nr={[Sr]:"Countdown",[Er]:"Count Up",[xr]:"Time of Day",[Cr]:"C/D + ToD",[Or]:"C/U + ToD",[Ir]:"Hidden"},Dr=pr(Nr),Mr={DURATION:"DURATION",FINISH_TIME:"FINISH_TIME"},Pr=pr(Mr),Rr={MANUAL:"MANUAL",LINKED:"LINKED",SCHEDULED:"SCHEDULED"},Fr=pr(Rr),Ur={black:(0,t.combineRgb)(0,0,0),white:(0,t.combineRgb)(255,255,255),green:(0,t.combineRgb)(0,255,0),red:(0,t.combineRgb)(250,42,42),yellow:(0,t.combineRgb)(255,169,0),lightGreen:(0,t.combineRgb)(127,252,127),lightRed:(0,t.combineRgb)(255,166,166),lightGray:(0,t.combineRgb)(180,180,180),lightBlue:(0,t.combineRgb)(127,213,252)},jr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOVBMVEUAAAD///////////////////////////////////////////////////////////////////////8KOjVvAAAAEnRSTlMAECAwQFBgcH+Aj5Cfr8DP3+8H0QoWAAAAkklEQVRYw+2VQQ7CMAwEm1KgaaHE8//HcgGJiGPmgITnASOvbK2nKUlGWSNus2bbANrF0gUAPKQBebMWVeck5gNhJXSsro52VnWjib90tKuqgzarOthcHdXVxU/rdlW3m6s4FvFQQj3jezErYBErIGoRC+ow63M0Z6+ryut5Pcbj5DzGOnxqPXuEkzNJkiRJ/pMnMJAdaP3cKN8AAAAASUVORK5CYII=",Br="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6BAMAAADsN3L5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAFVBMVEUAAAD///////////////////////9Iz20EAAAABnRSTlMAf4CPkO9T4O/6AAAASklEQVRIx2NgGAWEgWhaWlowEo0DMKeBgAKcxgVYwfIBcBoXYAPLJ8DpUXWj6kbV0U4dsfmSCSzvAKdxAlegdBASPQpGwSgYzAAAZ4iCBcCPC08AAAAASUVORK5CYII=",Lr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAQAAAC0EKdBAAABDklEQVR4Ae3YF6DEQBDG8XV6Tut0TnGKU5zitE7ntE5xitM6jdO4/F+da21fn8D8jq5/20sKGxFCYGBPQwFQVvYMyQc7CtmeMSPcIkwe4QSQ13hkGnfZp/4V74QZpUcZPcJdEiqFwkLj3Ogbrp4PADIVMEr2CqfnwQwjglm9wt3t9GQUMzmE68QbMOIVDoSndBMVM6T/gHJt6NbdPv0HZtaLR+lM2QAteeo0rKbtofAhwn0Ny5abVfqrhBN2/anETX8SdsOEkbQtZAQz+UwUwnhn4VKMeM5hld15MLfNpmHmlLBQKFTEcZt+3nAdyuTe5e9oZO/pQrhFmLdzHbGiACjtl64jQgghhBBCCCGEZ325sImA3YOqAAAAAElFTkSuQmCC",Vr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6BAMAAADsN3L5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAALVBMVEUAAAD///////////////////////////////////////////////////////+hSKubAAAADnRSTlMAECAwX2B/gJ+gr8/f7+JXqNEAAACNSURBVEjHY2AYBUQAnndPwTTLHQe86vjePQfTee8uEKOO7d27B8SoyyNOHcc7otQx9hGnTvodUeqY9hGnTucdUeqYzhGnzuYdUepe3SNOHQwMVnWvifTHc9t31A1nYuONAWIgEelKm0h1jOuIU8fASaQ6hjoi1bETqQ5o4AGiyg3WswGjhegoGAWDHQAAVOC9PWOv8FAAAAAASUVORK5CYII=",Hr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6BAMAAADsN3L5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAALVBMVEUAAAD///////////////////////////////////////////////////////+hSKubAAAADnRSTlMAECAwX2B/gJ+gr8/f7+JXqNEAAACKSURBVEjHY2AYBUQAljsOYDru3QG86njePQPTde8e4FXH9+5dApHqnhGp7l0DkepeCRCn7t0mItW9USBO3btDRKp7o0CcuneXiVT3dh9x6oBgUKt7u444dYepG85ExttrItPBRuLS1Usi0+kE4tL9cyLzUQEx6nghxhFUx3o2gKhyYxSMglEwCAAAqoW942zpZV4AAAAASUVORK5CYII=",qr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMAECAwQFBgcICQn6Cwv8DP3+Dvv0cgUAAAAJ1JREFUGBntwcGSgjAURNEmE2NAkYz3//91wAGrcGell+8cheCQGrs2qF/mLavflUOTwchhksGdQ5bBwq7J4cluksHAIcsgs3vmf+py4UNRj8qHoh43zpq6zJwVdfnlZFIfzpL61MfLwssoj8KmJXnc2BSZLKyaTBKbH5lcWE1yGVklucxAlcsANNlkoMimwiKfGZJ8rlSFEEII4Xt/66gShOCllwcAAAAASUVORK5CYII=",Wr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAP1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////9Du/pqAAAAFHRSTlMAECAwQFBgcH+Aj5CfoK+wv8/f7/yCZEUAAADfSURBVBgZ7cHRkoIwEATAyV4kRpCDcf7/W29RUPTlqlgf042mCUik4c6oFROOukjMWGQ9ZRxFuTNc0YY4zCg3GtBrMyCgl6PhV5uMiKJFmbUiYozaGxBko3YywqqebvkBEZn60CHCZr3rEFO1R0R1N710CDNqMyBmSADSVStDTL1iUXXX40t+KHfBt9gkNxu+pcoxI84y3IlyZ4SddIYzyo2GoF4aDUDq5WiImSQVLIoWBRFJEvFglLsgIEvqsLJRjobDqjTjpcoRh02SYSdT6nFYUcUbIxOapmmapvnHHye0F8UklMnjAAAAAElFTkSuQmCC",Yr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMAECAwQFBgcH+Aj5CfoLC/z9/vtr8TOgAAAKdJREFUGBntwct2AiEUBMDmIQwhDEL//7/GCBq3OdPLWwVjRFzud8gckwwQ8YNkgUiYJAdEwuRDgoYffBgQafz1DY3Ipxs0Tj4FSHguHhI3Lg4ShYuHROMSIdG5ZEg0Lh0SlZuDQuZWoOC5TQ+Fzq1DIfPlgIAbfDkgEPn2BYHKt5FwXeOfkTyuKvw0ey+4JA1+qg4XpcFt1giBkOt5thwdjDHGGPMPP86rESH39+l5AAAAAElFTkSuQmCC",zr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAP1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////9Du/pqAAAAFHRSTlMAECAwQFBgcH+Aj5CfoK+wv8/f7/yCZEUAAAD4SURBVFjD7ZXBkoMgEAUBUVRi1KH//1v3QCKbXFLlzJG+cemqB28G5zqd+3iR0A7pOHW6FSS+ZHOBQacTgNk554IAizJsEIBncLEAor+9DCBjAZgMXiPxRkxetwYGHjZtCc+qG63qtwCQzOocW2NsAp8ARzBQTeEKLINet1fJVGwCH//njIdX6ra3xG8AEizmrF1gmQzGrEoGfWPCa8jqBR4AZ9C9BU1SGxMNlkqVjMrAXq4lNX8s1bsjy6fPZ11jcvNVSdLtmK35SmqBV93Kq6xtqd4OPMl34EX3gTRhzeuiQFb0eUh537cU/fUriXedTqfT6XR+8Ae+ExfsQGxVnAAAAABJRU5ErkJggg==",$r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOVBMVEUAAAD///////////////////////////////////////////////////////////////////////8KOjVvAAAAEnRSTlMAECAwQFBgcICQn6Cvv8DP3+/6FJslAAAAzElEQVRYw+3V2w6DIBRE0cNFRLQK8/8f2yqYtIlNWpzHs98McUUFQUTT7jVmXLaFHi3ga2MHtyFeD0TkDg74f+RnLsS9gcTZ+tEK6+nm6rE4WaicK0yuaQTONq24mcAFpKaJTONtLgJL0xjLONYF54TJOaFyict97C53OM/leBuUuR4wXdwDi68d02rahR8S1g7u/E1x3O3ezqFie84eO697286NBXltTV3amcdqEjAZznHrkTNKEGFxr5PaCpFjvWid4SCapmmapvX0BPnlE5sWA4rIAAAAAElFTkSuQmCC",Gr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAP1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////9Du/pqAAAAFHRSTlMAECAwQFBgcH+Aj5CfoK+/wM/f702OQ14AAAEcSURBVFjD7ZbbEoMgDEQJKNR6h/z/t7YQrKW10zHxkX1TJmfcsASVqqpiC7zXynk81GrP4u6Ivsefcidx9F3d8WKH/iROJ96kj1cRT3cvWfU7z3ZRLRenXNElTU0LbFw2fM9PI/H4OKWnd8OTFBf3MPJSzEyQ41STDN9eNAHulgyvETK3T1owowSH8244bqp5pscJcLnIkk8jivFbESVmgItwCsbyiAhxuYHBXoBzFLstMVJcQxA9p8mpLzG7H5GGj4PyRZsNAws349SQTDlUB1wYuO2YYqo2sWtA90fQrAE1LlFrxLlAsXOsq6eYKrjAgNjDwVBl4bzfI/wxVDm4LW9FYgS4Hr6Gas/FmWC/byUP9c+rqqqqqqrqrx5WNhsy/NzpFQAAAABJRU5ErkJggg==",Qr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMAECBAUGBwf4CQn6Cwv8DP0N/vGoQcGAAAARFJREFUWMPtlstuhDAMRZ2Ex4SZTBqf///XLkIZKEiVTHbNXUUgH2xzsRHp6mqmETTF0Ar3AIAyNsNpBfpGuEXCE9DBThn8HifiC2Dmef2pbcXVqq31FphWcAiuniIkszvy+WqC0ZqcFxnzsTgPxUILtV+u/HLbCyx+jmtYgMUdHxMNuAT1MB3d6/SqpX/qE5WA+XMjowYcvDf/Acmd0jbiZIDNglbcvkUReNwrdh/lXrz9RdoGo1z4MdptfNLTZmNRuBge1o9MpsvhYR4Bkg/urZqtyVX7zieaeXzKCKRdtE93hrvIoMCyvsi6em7tRl8ANKWUFSDfXYxjYZNODZZsiG8F/Wr3U9HV1dXV1fVP9A0dvxCm3WkvCAAAAABJRU5ErkJggg==",Kr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAARVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////9SnXPCAAAAFnRSTlMAECAwQFBgcH+AkJ+gr7C/wM/Q3+Dvlll16gAAAT1JREFUWMPtll1vwyAMRS+U0nx0I4z6/P+fuofQrlorTXLyttwnhOQTXzB2pEOHdlMGK1PaCzcCQMu74WwFxp1ws9IVsLOfco7POCk2wM2LdvfWcatrr98Glw5OKayrCYq7OurrboHsTe6NrwjNQ0v38/qlT/DU89TD8keZoxSGWnL/zOTAFZCkATOKVLH1ZoK9O9I/1aOMGIyUaCFhQVLFHDhYJCWaNDGOTNKN00/aftzIfGWUbiQ3bjV7z25as0tus2tUgKBCzhRFCI+0nYVSqFdaDMZcmf2F0ss4LtBO0qnBEiVdfWUs648s9KcWw5ZHpsvb5uFuAaow/N4bvMlJ0V54w4b2qQyUp+hYtjR36WzA3C9yHT2bZmNsAFZKqQZQtw7G3HjILjsM2TQtBva130/FoUOHDh069E/0DUb+Fu6sLuw3AAAAAElFTkSuQmCC",Jr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA8UExURQAAAP///////////////////////////////////////////////////////////////////////////9hJaBMAAAATdFJOUwAQIEBQYHB/gJCfoLC/wM/Q3+8ahBwYAAABDklEQVRYw+2Wy27EIAxFDeRRkjIpPv//r10kJLSTqhpA6qLclRXJR75g7Ih0dTXTCBq8a4V7A4A4NsPpDrSNcIu4FdChnDLYHCdiI1DMs5q8HbjddanfCNMBds7skYdQ3B3b89cAY2lxp6/Fm3QCEEtoLp3XHp89/J7FL8hnae5r7AtwAeQOZ/TuSH9VyjLOuQkm5w7ihhbg4JFMJy1PZb+OWy+cr8DdmDUVZvOs/CrOsv+0UX5q47WsjUWvR2b8WvvIZLodHsUjQDaYv3+bS4sTsfrEmyvGp4xAyLJtqBnuIoMCy3GR++qp2o02AmgIYVOArXYxjvF6szo1WLLOPxT0o91PRVdXV1dX1z/RJ1OeEd1SZ8kDAAAAAElFTkSuQmCC",Zr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6BAMAAADsN3L5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAALVBMVEUAAAD///////////////////////////////////////////////////////+hSKubAAAADnRSTlMAECAwQGBwkKC/wM/f7/7VrqgAAABrSURBVEjHY2AYBYRBzjsE2IpbGes7ZJCAUx03iroDONXxoah7MKpuVN2gVMeJom4BTnXM95CUvVXAnZE0Vq1aDVTyZhUQFOHPmixAdYVEZGGguqsMRKl7rUCcukKiig7mq6PF5ygYBUMEAACZJi4Vt/I3cwAAAABJRU5ErkJggg==",Xr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAP1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////9Du/pqAAAAFHRSTlMAECAwQFBgcH+Aj5CfoK+/wM/f702OQ14AAADcSURBVFjD7dbRDoIwDAXQu6JDRWTr+v/f6gOaMBEIXR97P+AkbZq7AR6POoGZ0LP8TY5nuYcID7KZ/iTHshs+ydGBd3p7gy2H3pbbHVhzLfQy5YC7LYcLm3E3AKBsxclEmwNrOOEOAGIx4kRuGxej5OQZAITRihP+u0A1JyUCQMdG3HeBkxUneTVwEyd8AYArt3DVdPXFJAXXVef7JABhLtVCqoIaU0op5eXF9Kqnp2qVmRvColQfjVyJdakytXCZfkuVG7jPoMtSHbRcV+L6VeLgPy+Px+PxeA7zBmxuLz3gMRqIAAAAAElFTkSuQmCC",en="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA6CAMAAAApx5/4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA2UExURQAAAP////////////////////////////////////////////////////////////////////FjxvwAAAARdFJOUwAQIDBAYHB/gI+QoL/Az9/vODCOcwAAAJVJREFUWMPt1dsKhCAUheGlox2cPPT+LzvUFDSRENsNwbD+qxL8QBQ2wFhbXZ4vS16i+blaJ+BSncsC7rh/AMLxv5FzgCP3MBfckgHM+jE0cvdWn+L638OOfCj/xY1Ar8idE3BTXYsC7lVqWrGS2WPfcWmfGTluBZG2t11pMDrjduWKB/S4ZKHIaR30e8MejDHGGJP0AY9hJJdzc693AAAAAElFTkSuQmCC";let tn={};const rn={isRunning:"isRunning",isStopped:"isStopped",isOnTime:"isOnTime",isOverTime:"isOverTime",isWarningYellow:"isYellowPhase",isWarningRed:"isRedPhase",isFlashing:"isFlashing",blackoutEnabled:"blackoutEnabled",focusEnabled:"focusEnabled",messageIsShowing:"messageIsShowing"};const nn={roomId:"roomId",roomName:"roomName",roomTimezone:"roomTimezone",timeDisplay:"timeDisplay",timeDisplayHours:"timeDisplayHours",timeDisplayMinutes:"timeDisplayMinutes",timeDisplaySeconds:"timeDisplaySeconds",currentTimerRemaining:"currentTimerRemaining",currentTimerRemainingAsMs:"currentTimerRemainingAsMs",currentTimerRemainingHours:"currentTimerRemainingHours",currentTimerRemainingMinutes:"currentTimerRemainingMinutes",currentTimerRemainingSeconds:"currentTimerRemainingSeconds",currentTimerId:"currentTimerId",currentTimerName:"currentTimerName",currentTimerSpeaker:"currentTimerSpeaker",currentTimerNotes:"currentTimerNotes",currentTimerAppearance:"currentTimerAppearance",currentTimerStartTime12h:"currentTimerStartTime12h",currentTimerStartTime24h:"currentTimerStartTime24h",currentTimerDuration:"currentTimerDuration",currentTimerDurationAsMs:"currentTimerDurationAsMs",nextTimerId:"nextTimerId",nextTimerName:"nextTimerName",nextTimerSpeaker:"nextTimerSpeaker",nextTimerNotes:"nextTimerNotes",nextTimerAppearance:"nextTimerAppearance",nextTimerStartTime12h:"nextTimerStartTime12h",nextTimerStartTime24h:"nextTimerStartTime24h",nextTimerDuration:"nextTimerDuration",nextTimerDurationAsMs:"nextTimerDurationAsMs"},sn=[{variableId:nn.roomId,name:"Room ID"},{variableId:nn.roomName,name:"Room name"},{variableId:nn.roomTimezone,name:"Room timezone"},{variableId:nn.timeDisplay,name:"Formatted timer display"},{variableId:nn.timeDisplayHours,name:"Formatted timer display (hours)"},{variableId:nn.timeDisplayMinutes,name:"Formatted timer display (minutes)"},{variableId:nn.timeDisplaySeconds,name:"Formatted timer display (seconds)"},{variableId:nn.currentTimerRemaining,name:"Remaining time"},{variableId:nn.currentTimerRemainingAsMs,name:"Remaining time (ms)"},{variableId:nn.currentTimerRemainingHours,name:"Remaining time (hours)"},{variableId:nn.currentTimerRemainingMinutes,name:"Remaining time (minutes)"},{variableId:nn.currentTimerRemainingSeconds,name:"Remaining time (seconds)"},{variableId:nn.currentTimerId,name:"Current timer ID"},{variableId:nn.currentTimerName,name:"Current timer name"},{variableId:nn.currentTimerSpeaker,name:"Current timer speaker"},{variableId:nn.currentTimerNotes,name:"Current timer notes"},{variableId:nn.currentTimerAppearance,name:"Current timer appearance"},{variableId:nn.currentTimerStartTime12h,name:"Current timer start (12h format, event time zone)"},{variableId:nn.currentTimerStartTime24h,name:"Current timer start (24h format, event time zone)"},{variableId:nn.currentTimerDuration,name:"Current timer duration"},{variableId:nn.currentTimerDurationAsMs,name:"Current timer duration (ms)"},{variableId:nn.nextTimerId,name:"Next timer ID"},{variableId:nn.nextTimerName,name:"Next timer name"},{variableId:nn.nextTimerSpeaker,name:"Next timer speaker"},{variableId:nn.nextTimerNotes,name:"Next timer notes"},{variableId:nn.nextTimerAppearance,name:"Next timer appearance"},{variableId:nn.nextTimerStartTime12h,name:"Next timer start (12h format, event time zone)"},{variableId:nn.nextTimerStartTime24h,name:"Next timer start (24h format, event time zone)"},{variableId:nn.nextTimerDuration,name:"Next timer duration"},{variableId:nn.nextTimerDurationAsMs,name:"Next timer duration (ms)"}];let on=null;function an(){null===on&&(on=setInterval(pn.bind(this),250))}function cn(){null!==on&&clearInterval(on),on=null}const un={default:"default",yellow:"yellow",red:"red",zero:"zero",negative:"negative"};function ln(e,t=0,r=0){return e<0?un.negative:e<=0?un.zero:e<=1e3*r?un.red:e<=1e3*t?un.yellow:un.default}const dn={room:{roomId:void 0,roomName:void 0,roomBlackout:!1,roomFocus:!1,roomTimezone:"UTC"},viewer:{isFlashing:!1},playback_status:{currentTimerId:"",isRunning:!1,kickoff:0,deadline:0,lastStop:0,phase:void 0},current_timer:{name:"",speaker:"",notes:"",duration:"",appearance:"",wrap_up_yellow:0,wrap_up_red:0,start_time:"",start_time_uses_date:""},next_timer:{name:"",speaker:"",notes:"",duration:"",appearance:"",wrap_up_yellow:0,wrap_up_red:0,start_time:"",start_time_uses_date:""},message:{showing:!1,text:"",color:"",bold:!1,uppercase:!1}};function hn(e){const t=this,r={...t.state.room,...e},n=r.roomTimezone!==t.state.room.roomTimezone;t.state.room=r,t.setVariableValues({[nn.roomId]:r.roomId,[nn.roomName]:r.roomName,[nn.roomTimezone]:tt(r.roomTimezone,"abbr")||"Auto"}),t.checkFeedbacks(rn.blackoutEnabled,rn.focusEnabled),n&&(fn.call(t),mn.call(t))}function pn(e){const t=this,n=function(e){const t=Date.now()-e.serverTimeDiff,n=e.deadline?e.deadline-e.kickoff:6e4;let i;i=e.deadline?e.isRunning?e.deadline-t:e.deadline-e.lastStop:6e4,i>n&&(i=n);const s=1e3*Math.ceil(n/1e3),o=mr(r(s)),a=1e3*Math.ceil(i/1e3),c=mr(r(a));return{...e,totalAsMs:s,totalAsHuman:o.human,remainingAsMs:a,remainingAsHuman:c.human,remainingHours:c.hhh,remainingMinutes:c.mm,remainingSeconds:c.ss}}(e||t.state.playback_status);n.phase=ln(n.remainingAsMs??0,t.state.current_timer.wrap_up_yellow,t.state.current_timer.wrap_up_red),t.state.playback_status=n,n.isRunning?an.call(this):cn.call(this);const i=t.state.room?.roomTimezone||"UTC",s=function(e,{appearance:t=tr.COUNTDOWN,timezone:n="UTC"}={}){let i,s,o="";switch(t){case tr.HIDDEN:break;case tr.TOD:o=jt(new Date,{timezone:n});break;case tr.COUNTUP:case tr.COUNTUP_TOD:i=br(e.totalAsMs-e.remainingAsMs),s=r(i,{ceil:!1}),o=Wt(s).join("");break;case tr.COUNTDOWN:case tr.COUNTDOWN_TOD:default:i=br(e.remainingAsMs),s=r(i,{ceil:!0}),o=Wt(s).join("")}const[a,c,u]=o.split(":").reverse();return{display:o,displayHours:u||"0",displayMinutes:c||"00",displaySeconds:a||"00"}}(n,{appearance:t.state.current_timer.appearance,timezone:i});t.setVariableValues({[nn.timeDisplay]:s.display,[nn.timeDisplayHours]:s.displayHours,[nn.timeDisplayMinutes]:s.displayMinutes,[nn.timeDisplaySeconds]:s.displaySeconds,[nn.currentTimerRemaining]:n.remainingAsHuman,[nn.currentTimerRemainingAsMs]:n.remainingAsMs,[nn.currentTimerRemainingHours]:n.remainingHours,[nn.currentTimerRemainingMinutes]:n.remainingMinutes,[nn.currentTimerRemainingSeconds]:n.remainingSeconds}),t.checkFeedbacks(rn.isRunning,rn.isStopped,rn.isOnTime,rn.isOverTime,rn.isWarningYellow,rn.isWarningRed)}function fn(e){const t=this,r={...t.state.current_timer,...e},n=r.appearance!==t.state.current_timer.appearance;t.state.current_timer=r,t.state.playback_status.phase=ln(t.state.playback_status.remainingAsMs??0,t.state.current_timer.wrap_up_yellow,t.state.current_timer.wrap_up_red);const i=t.state.room?.roomTimezone||"UTC",s=gr(r,i);t.setVariableValues({[nn.currentTimerId]:r._id,[nn.currentTimerName]:r.name,[nn.currentTimerNotes]:r.notes,[nn.currentTimerSpeaker]:r.speaker,[nn.currentTimerDuration]:r.duration,[nn.currentTimerDurationAsMs]:yr(r.duration),[nn.currentTimerAppearance]:Nr[r.appearance],[nn.currentTimerStartTime12h]:s?jt(s,{timezone:i,format:"12h"}):"",[nn.currentTimerStartTime24h]:s?jt(s,{timezone:i,format:"24h"}):""}),t.checkFeedbacks(rn.isWarningYellow,rn.isWarningRed),n&&!t.state.playback_status.isRunning&&pn.call(t)}function mn(e){const t=this,r={...t.state.next_timer,...e};t.state.next_timer=r;const n=t.state.room?.roomTimezone||"UTC",i=gr(r,n);t.setVariableValues({[nn.nextTimerId]:r._id,[nn.nextTimerName]:r.name,[nn.nextTimerNotes]:r.notes,[nn.nextTimerSpeaker]:r.speaker,[nn.nextTimerDuration]:r.duration,[nn.nextTimerDurationAsMs]:yr(r.duration),[nn.nextTimerAppearance]:Nr[r.appearance],[nn.nextTimerStartTime12h]:i?jt(i,{timezone:n,format:"12h"}):"",[nn.nextTimerStartTime24h]:i?jt(i,{timezone:n,format:"24h"}):""})}function gn(e){const t=this;t.state.message={...t.state.message,...e},t.checkFeedbacks(rn.messageIsShowing)}function yn(e){const t=this;let r=!1;e>0&&(r=!0,setTimeout((()=>{t.state.viewer.isFlashing=!1,t.checkFeedbacks(rn.isFlashing)}),1e3*e)),t.state.viewer.isFlashing=r,t.checkFeedbacks(rn.isFlashing)}class bn extends Error{get name(){return this.constructor.name}}class wn extends Error{constructor(e){super(`${e.status} ${e.statusText}`)}get name(){return this.constructor.name}}class vn extends Error{get name(){return this.constructor.name}}class Tn{constructor(e){return this.apiUrl=e.apiUrl,this.apiKey=e.apiKey,this.roomId=e.roomId,this}async send(e="",t={}){try{const r={room_id:this.roomId,api_key:this.apiKey,...t};let n="";n=new URLSearchParams(r).toString(),n=n&&`?${n}`;const i=`${this.apiUrl}${e}${n}`,s=await fetch(i,{signal:AbortSignal.timeout(4900)});if(!s.ok){const e=await s.json().catch((()=>{throw new wn(s)}));throw new vn(e.message)}return await s.json()}catch(e){if(!(e instanceof Error))throw new Error;switch(e.name){case"TimeoutError":throw new bn("Request took longer than 5s and timed out");case"TypeError":throw new bn("There is a problem with the connection");default:throw e}}}}const _n=Object.create(null);_n.open="0",_n.close="1",_n.ping="2",_n.pong="3",_n.message="4",_n.upgrade="5",_n.noop="6";const An=Object.create(null);Object.keys(_n).forEach((e=>{An[_n[e]]=e}));const kn={type:"error",data:"parser error"},Sn=({type:e,data:t},r,n)=>t instanceof ArrayBuffer||ArrayBuffer.isView(t)?n(r?t:"b"+En(t,!0).toString("base64")):n(_n[e]+(t||"")),En=(e,t)=>Buffer.isBuffer(e)||e instanceof Uint8Array&&!t?e:e instanceof ArrayBuffer?Buffer.from(e):Buffer.from(e.buffer,e.byteOffset,e.byteLength);let xn;const Cn=(e,t)=>{if("string"!=typeof e)return{type:"message",data:On(e,t)};const r=e.charAt(0);if("b"===r){const r=Buffer.from(e.substring(1),"base64");return{type:"message",data:On(r,t)}}return An[r]?e.length>1?{type:An[r],data:e.substring(1)}:{type:An[r]}:kn},On=(e,t)=>"arraybuffer"===t?e instanceof ArrayBuffer?e:Buffer.isBuffer(e)?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):e.buffer:Buffer.isBuffer(e)?e:Buffer.from(e),In=String.fromCharCode(30);let Nn;function Dn(e){return e.reduce(((e,t)=>e+t.length),0)}function Mn(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let i=0;i<t;i++)r[i]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function Pn(e){if(e)return function(e){for(var t in Pn.prototype)e[t]=Pn.prototype[t];return e}(e)}Pn.prototype.on=Pn.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Pn.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},Pn.prototype.off=Pn.prototype.removeListener=Pn.prototype.removeAllListeners=Pn.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},Pn.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t)}return this},Pn.prototype.emitReserved=Pn.prototype.emit,Pn.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Pn.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Rn=global;function Fn(e,...t){return t.reduce(((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t)),{})}const Un=Rn.setTimeout,jn=Rn.clearTimeout;function Bn(e,t){t.useNativeTimers?(e.setTimeoutFn=Un.bind(Rn),e.clearTimeoutFn=jn.bind(Rn)):(e.setTimeoutFn=Rn.setTimeout.bind(Rn),e.clearTimeoutFn=Rn.clearTimeout.bind(Rn))}var Ln=i(5753);const Vn=Ln("engine.io-client:transport");class Hn extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class qn extends Pn{constructor(e){super(),this.writable=!1,Bn(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new Hn(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):Vn("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Cn(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}const Wn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Yn=64,zn={};let $n,Gn=0,Qn=0;function Kn(e){let t="";do{t=Wn[e%Yn]+t,e=Math.floor(e/Yn)}while(e>0);return t}function Jn(){const e=Kn(+new Date);return e!==$n?(Gn=0,$n=e):e+"."+Kn(Gn++)}for(;Qn<Yn;Qn++)zn[Wn[Qn]]=Qn;var Zn=i(5480);const Xn=Zn||i.t(Zn,2);class ei{constructor(){this.cookies=new Map}parseCookies(e){const t=e.getResponseHeader("set-cookie");t&&t.forEach((e=>{const t=function(e){const t=e.split("; "),r=t[0].indexOf("=");if(-1===r)return;const n=t[0].substring(0,r).trim();if(!n.length)return;let i=t[0].substring(r+1).trim();34===i.charCodeAt(0)&&(i=i.slice(1,-1));const s={name:n,value:i};for(let e=1;e<t.length;e++){const r=t[e].split("=");if(2!==r.length)continue;const n=r[0].trim(),i=r[1].trim();switch(n){case"Expires":s.expires=new Date(i);break;case"Max-Age":const e=new Date;e.setUTCSeconds(e.getUTCSeconds()+parseInt(i,10)),s.expires=e}}return s}(e);t&&this.cookies.set(t.name,t)}))}addCookies(e){const t=[];this.cookies.forEach(((e,r)=>{var n;(null===(n=e.expires)||void 0===n?void 0:n.getTime())<Date.now()?this.cookies.delete(r):t.push(`${r}=${e.value}`)})),t.length&&(e.setDisableHeaderCheck(!0),e.setRequestHeader("cookie",t.join("; ")))}}const ti=Ln("engine.io-client:polling");function ri(){}const ni=null!=new Xn({xdomain:!1}).responseType;class ii extends Pn{constructor(e,t){super(),Bn(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=Fn(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const r=this.xhr=new Xn(t);try{ti("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&r.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{r.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{var e;3===r.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(r)),4===r.readyState&&(200===r.status||1223===r.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof r.status?r.status:0)}),0))},ti("xhr data %s",this.data),r.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=ii.requestsCount++,ii.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=ri,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete ii.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}function si(){for(let e in ii.requests)ii.requests.hasOwnProperty(e)&&ii.requests[e].abort()}ii.requestsCount=0,ii.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",si):"function"==typeof addEventListener&&addEventListener("onpagehide"in Rn?"pagehide":"unload",si,!1)),i(3719),i(6286),i(914);var oi=i(1060);i(1722);const ai=oi,ci=process.nextTick,ui=Ln("engine.io-client:websocket"),li="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),di=Ln("engine.io-client:webtransport"),hi={websocket:class extends qn{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=li?{}:Fn(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=new ai(e,t,r)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;Sn(r,this.supportsBinary,(e=>{const t={};r.options&&(t.compress=r.options.compress),this.opts.perMessageDeflate&&("string"==typeof e?Buffer.byteLength(e):e.length)<this.opts.perMessageDeflate.threshold&&(t.compress=!1);try{this.ws.send(e,t)}catch(e){ui("websocket closed before onclose event")}n&&ci((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Jn()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!ai}},webtransport:class extends qn{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{di("transport closed gracefully"),this.onClose()})).catch((e=>{di("transport closed due to %s",e),this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=function(e,t){Nn||(Nn=new TextDecoder);const r=[];let n=0,i=-1,s=!1;return new TransformStream({transform(o,a){for(r.push(o);;){if(0===n){if(Dn(r)<1)break;const e=Mn(r,1);s=!(128&~e[0]),i=127&e[0],n=i<126?3:126===i?1:2}else if(1===n){if(Dn(r)<2)break;const e=Mn(r,2);i=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),n=3}else if(2===n){if(Dn(r)<8)break;const e=Mn(r,8),t=new DataView(e.buffer,e.byteOffset,e.length),s=t.getUint32(0);if(s>Math.pow(2,21)-1){a.enqueue(kn);break}i=s*Math.pow(2,32)+t.getUint32(4),n=3}else{if(Dn(r)<i)break;const e=Mn(r,i);a.enqueue(Cn(s?e:Nn.decode(e),t)),n=0}if(0===i||i>e){a.enqueue(kn);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),n=new TransformStream({transform(e,t){!function(e,t){if(e.data instanceof ArrayBuffer||ArrayBuffer.isView(e.data))return t(En(e.data,!1));Sn(e,!0,(e=>{xn||(xn=new TextEncoder),t(xn.encode(e))}))}(e,(r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,n)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(n))}e.data&&"string"!=typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(r)}))}});n.readable.pipeTo(e.writable),this.writer=n.writable.getWriter();const i=()=>{r.read().then((({done:e,value:t})=>{e?di("session is closed"):(di("received chunk: %o",t),this.onPacket(t),i())})).catch((e=>{di("an error occurred while reading: %s",e)}))};i();const s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this.writer.write(s).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;this.writer.write(r).then((()=>{n&&ci((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}},polling:class extends qn{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port}const t=e&&e.forceBase64;this.supportsBinary=ni&&!t,this.opts.withCredentials&&(this.cookieJar=new ei)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{ti("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(ti("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){ti("pre-pause polling complete"),--e||t()}))),this.writable||(ti("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){ti("pre-pause writing complete"),--e||t()})))}else t()}poll(){ti("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){ti("polling got data %s",e),((e,t)=>{const r=e.split(In),n=[];for(let e=0;e<r.length;e++){const i=Cn(r[e],t);if(n.push(i),"error"===i.type)break}return n})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this.poll():ti('ignoring poll - transport state "%s"',this.readyState))}doClose(){const e=()=>{ti("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(ti("transport open - closing"),e()):(ti("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,((e,t)=>{const r=e.length,n=new Array(r);let i=0;e.forEach(((e,s)=>{Sn(e,!1,(e=>{n[s]=e,++i===r&&t(n.join(In))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=Jn()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new ii(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){ti("xhr poll");const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},pi=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fi=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function mi(e){if(e.length>2e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let i=pi.exec(e||""),s={},o=14;for(;o--;)s[fi[o]]=i[o]||"";return-1!=r&&-1!=n&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){const r=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1),"/"==t.slice(-1)&&r.splice(r.length-1,1),r}(0,s.path),s.queryKey=function(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}(0,s.query),s}const gi=Ln("engine.io-client:socket");class yi extends Pn{constructor(e,t={}){super(),this.binaryType="nodebuffer",this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=mi(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=mi(t.host).host),Bn(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let e=0,n=r.length;e<n;e++){let n=r[e].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){gi('creating transport "%s"',e);const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return gi("options: %j",r),new hi[e](r)}open(){let e;if(this.opts.rememberUpgrade&&yi.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return gi("error while creating transport: %s",e),this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){gi("setting transport %s",e.name),this.transport&&(gi("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){gi('probing transport "%s"',e);let t=this.createTransport(e),r=!1;yi.priorWebsocketSuccess=!1;const n=()=>{r||(gi('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(n=>{if(!r)if("pong"===n.type&&"probe"===n.data){if(gi('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;yi.priorWebsocketSuccess="websocket"===t.name,gi('pausing current transport "%s"',this.transport.name),this.transport.pause((()=>{r||"closed"!==this.readyState&&(gi("changing transport and sending upgrade packet"),u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{gi('probe transport "%s" failed',e);const r=new Error("probe error");r.transport=t.name,this.emitReserved("upgradeError",r)}})))};function i(){r||(r=!0,u(),t.close(),t=null)}const s=r=>{const n=new Error("probe error: "+r);n.transport=t.name,i(),gi('probe transport "%s" failed because of error: %s',e,r),this.emitReserved("upgradeError",n)};function o(){s("transport closed")}function a(){s("socket closed")}function c(e){t&&e.name!==t.name&&(gi('"%s" works - aborting "%s"',e.name,t.name),i())}const u=()=>{t.removeListener("open",n),t.removeListener("error",s),t.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};t.once("open",n),t.once("error",s),t.once("close",o),this.once("close",a),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{r||t.open()}),200):t.open()}onOpen(){if(gi("socket open"),this.readyState="open",yi.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){gi("starting upgrade probes");let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(gi('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}else gi('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();gi("flushing %d packets in socket",e.length),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){const n=this.writeBuffer[r].data;if(n&&(e+="string"==typeof(t=n)?function(e){let t=0,r=0;for(let n=0,i=e.length;n<i;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(t):Math.ceil(1.33*(t.byteLength||t.size))),r>0&&e>this.maxPayload)return gi("only send %d out of %d packets",r,this.writeBuffer.length),this.writeBuffer.slice(0,r);e+=2}var t;return gi("payload size is %d (max: %d)",e,this.maxPayload),this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;const i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this.onClose("forced close"),gi("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?r():e()})):this.upgrading?r():e()),this}onError(e){gi("socket error %j",e),yi.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(gi('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}yi.protocol=4,yi.protocol;const bi=Ln("socket.io-client:url"),wi="function"==typeof ArrayBuffer,vi=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Ti=Object.prototype.toString,_i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Ti.call(Blob),Ai="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Ti.call(File);function ki(e){return wi&&(e instanceof ArrayBuffer||vi(e))||_i&&e instanceof Blob||Ai&&e instanceof File}function Si(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)if(Si(e[t]))return!0;return!1}if(ki(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return Si(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&Si(e[t]))return!0;return!1}function Ei(e){const t=[],r=e.data,n=e;return n.data=xi(r,t),n.attachments=t.length,{packet:n,buffers:t}}function xi(e,t){if(!e)return e;if(ki(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=xi(e[n],t);return r}if("object"==typeof e&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=xi(e[n],t));return r}return e}function Ci(e,t){return e.data=Oi(e.data,t),delete e.attachments,e}function Oi(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Oi(e[r],t);else if("object"==typeof e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Oi(e[r],t));return e}const Ii=Ln("socket.io-parser"),Ni=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Di=5;var Mi;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Mi||(Mi={}));class Pi{constructor(e){this.replacer=e}encode(e){return Ii("encoding packet %j",e),e.type!==Mi.EVENT&&e.type!==Mi.ACK||!Si(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Mi.EVENT?Mi.BINARY_EVENT:Mi.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==Mi.BINARY_EVENT&&e.type!==Mi.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),Ii("encoded %j as %s",e,t),t}encodeAsBinary(e){const t=Ei(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}function Ri(e){return"[object Object]"===Object.prototype.toString.call(e)}class Fi extends Pn{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===Mi.BINARY_EVENT;r||t.type===Mi.BINARY_ACK?(t.type=r?Mi.EVENT:Mi.ACK,this.reconstructor=new Ui(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!ki(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(void 0===Mi[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Mi.BINARY_EVENT||r.type===Mi.BINARY_ACK){const n=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(n,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){const n=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);r.nsp=e.substring(n,t)}else r.nsp="/";const n=e.charAt(t+1);if(""!==n&&Number(n)==n){const n=t+1;for(;++t;){const r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){const n=this.tryParse(e.substr(t));if(!Fi.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return Ii("decoded %s as %j",e,r),r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case Mi.CONNECT:return Ri(t);case Mi.DISCONNECT:return void 0===t;case Mi.CONNECT_ERROR:return"string"==typeof t||Ri(t);case Mi.EVENT:case Mi.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===Ni.indexOf(t[0]));case Mi.ACK:case Mi.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ui{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Ci(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function ji(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const Bi=Ln("socket.io-client:socket"),Li=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Vi extends Pn{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ji(e,"open",this.onopen.bind(this)),ji(e,"packet",this.onpacket.bind(this)),ji(e,"error",this.onerror.bind(this)),ji(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Li.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const r={type:Mi.EVENT,data:t,options:{}};if(r.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++;Bi("emitting packet with ack id %d",e);const n=t.pop();this._registerAckCallback(e,n),r.id=e}const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||n&&this.connected?this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r):Bi("discard packet as the transport is not currently writable"),this.flags={},this}_registerAckCallback(e,t){var r;const n=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0===n)return void(this.acks[e]=t);const i=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&(Bi("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(t,1));Bi("event with ack id %d has timed out after %d ms",e,n),t.call(this,new Error("operation has timed out"))}),n),s=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,e)};s.withError=!0,this.acks[e]=s}emitWithAck(e,...t){return new Promise(((r,n)=>{const i=(e,t)=>e?n(e):r(t);i.withError=!0,t.push(i),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...n)=>{if(r===this._queue[0])return null!==e?r.tryCount>this._opts.retries&&(Bi("packet [%d] is discarded after %d tries",r.id,r.tryCount),this._queue.shift(),t&&t(e)):(Bi("packet [%d] was successfully sent",r.id),this._queue.shift(),t&&t(null,...n)),r.pending=!1,this._drainQueue()})),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(Bi("draining queue"),!this.connected||0===this._queue.length)return;const t=this._queue[0];!t.pending||e?(t.pending=!0,t.tryCount++,Bi("sending packet [%d] (try n°%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)):Bi("packet [%d] has already been sent and is waiting for an ack",t.id)}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){Bi("transport is open - connecting"),"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Mi.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){Bi("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((e=>{if(!this.sendBuffer.some((t=>String(t.id)===e))){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}}))}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Mi.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Mi.EVENT:case Mi.BINARY_EVENT:this.onevent(e);break;case Mi.ACK:case Mi.BINARY_ACK:this.onack(e);break;case Mi.DISCONNECT:this.ondisconnect();break;case Mi.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];Bi("emitting event %j",t),null!=e.id&&(Bi("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...n){r||(r=!0,Bi("sending ack %j",n),t.packet({type:Mi.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];"function"==typeof t?(delete this.acks[e.id],Bi("calling ack %s with %j",e.id,e.data),t.withError&&e.data.unshift(null),t.apply(this,e.data)):Bi("bad ack %s",e.id)}onconnect(e,t){Bi("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){Bi("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(Bi("performing disconnect (%s)",this.nsp),this.packet({type:Mi.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function Hi(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Hi.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=1&Math.floor(10*t)?e+r:e-r}return 0|Math.min(e,this.max)},Hi.prototype.reset=function(){this.attempts=0},Hi.prototype.setMin=function(e){this.ms=e},Hi.prototype.setMax=function(e){this.max=e},Hi.prototype.setJitter=function(e){this.jitter=e};const qi=Ln("socket.io-client:manager");class Wi extends Pn{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(r=t,t=void 0),(r=r||{}).path=r.path||"/socket.io",this.opts=r,Bn(this,r),this.reconnection(!1!==r.reconnection),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=r.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Hi({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==r.timeout?2e4:r.timeout),this._readyState="closed",this.uri=t;const i=r.parser||e;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==r.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(qi("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;qi("opening %s",this.uri),this.engine=new yi(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=ji(t,"open",(function(){r.onopen(),e&&e()})),i=t=>{qi("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},s=ji(t,"error",i);if(!1!==this._timeout){const e=this._timeout;qi("connect attempt will timeout after %d",e);const r=this.setTimeoutFn((()=>{qi("connect attempt timed out after %d",e),n(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&r.unref(),this.subs.push((()=>{this.clearTimeoutFn(r)}))}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){qi("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ji(e,"ping",this.onping.bind(this)),ji(e,"data",this.ondata.bind(this)),ji(e,"error",this.onerror.bind(this)),ji(e,"close",this.onclose.bind(this)),ji(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){ci((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){qi("error",e),this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new Vi(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const e of t)if(this.nsps[e].active)return void qi("socket %s is still active, skipping close",e);this._close()}_packet(e){qi("writing packet %j",e);const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){qi("cleanup"),this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){qi("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){qi("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)qi("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();qi("will wait %dms before reconnect attempt",t),this._reconnecting=!0;const r=this.setTimeoutFn((()=>{e.skipReconnect||(qi("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(qi("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):(qi("reconnect success"),e.onreconnect())})))}),t);this.opts.autoUnref&&r.unref(),this.subs.push((()=>{this.clearTimeoutFn(r)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Yi=Ln("socket.io-client"),zi={};function $i(e,t){"object"==typeof e&&(t=e,e=void 0);const r=function(e,t="",r){let n=e;r=r||"undefined"!=typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(bi("protocol-less url %s",e),e=void 0!==r?r.protocol+"//"+e:"https://"+e),bi("parse %s",e),n=mi(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),n=r.source,i=r.id,s=r.path,o=zi[i]&&s in zi[i].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||o?(Yi("ignoring socket cache for %s",n),a=new Wi(n,t)):(zi[i]||(Yi("new io instance for %s",n),zi[i]=new Wi(n,t)),a=zi[i]),r.query&&!t.query&&(t.query=r.queryKey),a.socket(r.path,t)}Object.assign($i,{Manager:Wi,Socket:Vi,io:$i,connect:$i});const Gi={test_auth:"test_auth",get_status:"get_status",get_room:"get_room",start:"start",stop:"stop",start_or_stop:"start_or_stop",reset:"reset",next:"next",previous:"previous",add_time:"add_time",subtract_time:"subtract_time",start_flashing:"start_flashing",stop_flashing:"stop_flashing",enable_blackout:"enable_blackout",disable_blackout:"disable_blackout",toggle_blackout:"toggle_blackout",enable_focus:"enable_focus",disable_focus:"disable_focus",toggle_focus:"toggle_focus",start_timer:"start_timer",stop_timer:"stop_timer",start_or_stop_timer:"start_or_stop_timer",reset_timer:"reset_timer",get_timer:"get_timer",create_timer:"create_timer",show_or_hide_message:"show_or_hide_message",show_message:"show_message",hide_message:"hide_message",create_message:"create_message"},Qi={autostart:[{id:"autostart",type:"checkbox",label:"Autostart",default:!1,tooltip:"Set to `true` to automatically start the timer after the action is triggered."}],amount:[{id:"amount",type:"textinput",label:"Amount",default:"1m",required:!0,tooltip:"An amount of time specified by a number followed by a divison of time. Eg. `5s` for 5 seconds, `10m` for 10 minutes, etc."}],count:[{id:"count",type:"number",label:"Count",default:3,min:1,max:999,tooltip:"Number of times to repeat the action. Accepted numbers: 1 - 999."}],timer:[{id:"index",type:"number",label:"Timer index",default:1,min:1,max:99,tooltip:"Index of a timer to target in a room. Note: Index is not zero-based, it starts at 1. Example: To target the second timer from the top, set `index=2`."},{id:"timer_id",type:"textinput",label:"Timer ID",tooltip:"The ID of the timer you want to target."}],timerCreate:[{id:"name",type:"textinput",label:"Name",tooltip:"Name of the timer."},{id:"speaker",type:"textinput",label:"Speaker",tooltip:"Used to identify speakers."},{id:"notes",type:"textinput",label:"Notes",tooltip:"Notes related to the timer or speaker."},{id:"hours",type:"number",label:"Hours",default:0,required:!1,min:0,max:999,tooltip:"Duration (hours)."},{id:"minutes",type:"number",label:"Minutes",default:10,required:!1,min:0,max:59,tooltip:"Duration (minutes)."},{id:"seconds",type:"number",label:"Seconds",default:0,required:!1,min:0,max:59,tooltip:"Duration (seconds)."},{id:"wrap_up_yellow",type:"number",label:"Wrap up, yellow",default:60,required:!1,min:0,max:9999,tooltip:"Yellow wrap-up time (in seconds from the end)."},{id:"wrap_up_red",type:"number",label:"Wrap up, red",default:15,required:!1,min:0,max:9999,tooltip:"Red wrap-up time (in seconds from the end)."},{id:"advanced",type:"static-text",label:"Advanced options:",value:"The settings below are for advanced timer configuration."},{id:"appearance",type:"dropdown",label:"Timer appearance",tooltip:`Defines how the timer is displayed. See the "Timer Appearances" page in the docs. Default: ${Sr}`,choices:Dr,default:0},{id:"type",type:"dropdown",label:"Timer type",tooltip:`Defines the type of timer, ie. how runtime length is handled. See the "Timer Types" page in the docs. Default: ${Mr.DURATION}`,choices:Pr,default:0},{id:"trigger",type:"dropdown",label:"Timer trigger",tooltip:`Defines how the timer is triggered (started). See the "Timer Triggers" page in the docs. Default: ${Rr.MANUAL}`,choices:Fr,default:0},{id:"start_time",type:"textinput",label:"Start time",tooltip:"Set a hard start time for this cue. Required when `trigger=LINKED` and `trigger=SCHEDULED`, but optional for `trigger=MANUAL`"},{id:"start_time_uses_date",type:"checkbox",label:"Start time uses date",default:!1,tooltip:"Determines if the date-part of `start_time` is being used. If `true`, then the the full date is used (e.g. 11 am on Oct 6). But if `false`, the start date is interpreted as today and the date part ignored (e.g. 11 am today)."},{id:"finish_time",type:"textinput",label:"Finish time",tooltip:"Finish time for the cue. Required when `type=FINISH_TIME`, otherwise ignored."},{id:"finish_time_uses_date",type:"checkbox",label:"Finish time uses date",default:!1,tooltip:"Determines if the date-part of `finish_time` is being used. If `true`, then the the full date is used (e.g. 11 am on Oct 6). But if `false`, the start date is interpreted as today and the date part ignored (e.g. 11 am today)."}],message:[{id:"index",type:"number",label:"Message index",default:"",min:1,max:99,tooltip:"Index of a message to target in a room. Note: Index is not zero-based, it starts at 1. Example: To target the second message from the top, set `index=2`. Leave blank to target active or first message."},{id:"message_id",type:"textinput",label:"Message ID",tooltip:"The ID of the message you want to target."}],messageCreate:[{id:"text",type:"textinput",label:"Message text",tooltip:"Text content of the message."},{id:"color",type:"dropdown",label:"Text color",tooltip:"Choose a text color for the message. Default: white",choices:kr,default:0},{id:"bold",type:"checkbox",label:"Bold text",default:!1,tooltip:"Check to make the message text bold."},{id:"uppercase",type:"checkbox",label:"Uppercase text",default:!1,tooltip:"Check to make the message text uppercase."}]};function Ki(e){const t=Ji.bind(e),r={[Gi.start]:{name:"Transport: Start",description:"Start or resume the highlighted timer",options:[],callback:t},[Gi.stop]:{name:"Transport: Stop",description:"Stop the highlighted timer",options:[],callback:t},[Gi.start_or_stop]:{name:"Transport: Start/stop",description:"Start/stop the highlighted timer",options:[],callback:t},[Gi.reset]:{name:"Transport: Reset",description:"Reset or restart the highlighted timer",options:Qi.autostart,callback:t},[Gi.next]:{name:"Transport: Next",description:"Highlight the next timer in the list",options:Qi.autostart,callback:t},[Gi.previous]:{name:"Transport: Previous",description:"Reset the highlighted timer in the room if it is running. If the highlighted timer is not running, highlight the previous timer in the list. Optionally, you can automatically start the previous timer once it's highlighted.",options:Qi.autostart,callback:t},[Gi.add_time]:{name:"Transport: Add time",description:"Add an amount of time to the highlighted timer in the room.",options:Qi.amount,callback:t},[Gi.subtract_time]:{name:"Transport: Subtract time",description:"Subtract an amount of time from the highlighted timer in the room.",options:Qi.amount,callback:t},[Gi.start_flashing]:{name:"Viewer: Flash the screen",description:"Flashes the screen in the room. Can be used to grab the attention of speakers.",options:Qi.count,callback:t},[Gi.stop_flashing]:{name:"Viewer: Stop flashing",description:"Stops any flashing timers and message on the screen.",options:[],callback:t},[Gi.enable_blackout]:{name:"Viewer: Enable blackout mode",description:"Enable blackout mode in the room",options:[],callback:t},[Gi.disable_blackout]:{name:"Viewer: Disable blackout mode",description:"Disable blackout mode in the room",options:[],callback:t},[Gi.toggle_blackout]:{name:"Viewer: Toggle blackout mode",description:"Toggle (enable/disable) blackout mode in the room",options:[],callback:t},[Gi.enable_focus]:{name:"Viewer: Enable focus mode",description:"Enable focus mode in the room",options:[],callback:t},[Gi.disable_focus]:{name:"Viewer: Disable focus mode",description:"Disable focus mode in the room",options:[],callback:t},[Gi.toggle_focus]:{name:"Viewer: Toggle focus mode",description:"Toggle (enable/disable) focus mode in the room",options:[],callback:t},[Gi.start_timer]:{name:"Timer: Start",description:"Start or resume a specific timer in the room",options:Qi.timer,callback:t},[Gi.stop_timer]:{name:"Timer: Stop",description:"Stop a specific timer in the room",options:Qi.timer,callback:t},[Gi.start_or_stop_timer]:{name:"Timer: Toggle playback",description:"Toggle (start/stop) a specific timer in the room",options:Qi.timer,callback:t},[Gi.reset_timer]:{name:"Timer: Reset",description:"Reset a specific timer to original duration",options:Qi.timer,callback:t},[Gi.create_timer]:{name:"Timer: Create new timer",description:"Create a new timer in the room",options:Qi.timerCreate,callback:t},[Gi.show_message]:{name:"Message: Show",description:"Show a message in the room",options:Qi.message,callback:t},[Gi.hide_message]:{name:"Message: Hide",description:"Hide a message in the room",options:Qi.message,callback:t},[Gi.show_or_hide_message]:{name:"Message: Toggle visibility",description:"Show/hide a message in the room",options:Qi.message,callback:t},[Gi.create_message]:{name:"Message: Create new message",description:"Create a new message in the room",options:Qi.messageCreate,callback:t},[Gi.test_auth]:{name:"Utility: Test auth",description:"Test connection and authentication",options:[],callback:t},[Gi.get_status]:{name:"Utility: Get status",description:"Get playback status of the room",options:[],callback:t},[Gi.get_room]:{name:"Utility: Get room",description:"Get status of the room",options:[],callback:t}};e.setActionDefinitions(r)}async function Ji({actionId:e,options:t}){const r=this;if(r.log("debug",`Action: ${e}`),e in Gi==0)throw new Error("Not a valid actionId");if(!r.apiClient)throw new Error("API client not ready");const n=function(e){return Object.fromEntries(Object.entries(e).filter((([e,t])=>t)))}(t);try{const{message:t}=await r.apiClient.send(e,n);r.log("debug",`API response: ${t}`)}catch(e){if(!(e instanceof Error))throw new Error;r.log("error",e.toString())}}let Zi=null;function Xi(){Zi&&Zi.disconnect()}function es(e){if(!e||!e.config)throw Error("Module instance required");const{apiUrl:r,roomId:n,apiKey:i}=e.config,s=new URL(r);Xi(),e.log("info","Connecting to Stagetimer.io..."),e.updateStatus(t.InstanceStatus.Connecting),Zi=$i(s.origin,{path:s.pathname+"socket.io",auth:{room_id:n,api_key:i},reconnectionAttempts:5,reconnectionDelayMax:1e4}),Zi.on("connect",(()=>{if(e.log("info","Connected!"),e.updateStatus(t.InstanceStatus.Ok),!e.apiClient)throw Error("API client not ready");e.apiClient.send(Gi.get_room,{}).then((({data:t})=>{const{_id:r,name:n,blackout:i,focus_message:s,timezone:o}=t;hn.call(e,{roomId:r,roomName:n,roomBlackout:i,roomFocus:s,roomTimezone:o})})).catch((t=>{e.log("error",t.toString())})),e.apiClient.send(Gi.get_status,{}).then((({data:t})=>{const{timer_id:r,running:n,start:i,finish:s,pause:o,server_time:a}=t,c=Date.now()-a;return e.log("debug",`Difference between system and server time: ${c}ms`),pn.call(e,{currentTimerId:r,isRunning:n,kickoff:i,deadline:s,lastStop:o,serverTimeDiff:c}),r})).then((t=>{ts.call(e,t)})).catch((t=>{e.log("error",t.toString())}))})),Zi.on("connect_error",(r=>{e.log("warn",`Failed to connect! (${r.message})`),e.updateStatus(t.InstanceStatus.ConnectionFailure)})),Zi.on("disconnect",(r=>{"io client disconnect"!==r&&(e.log("warn",`Disconnected! Reason: ${r}`),e.updateStatus(t.InstanceStatus.Disconnected))})),Zi.on("error",(r=>{e.log("error",`Unexpected error: ${r.message}`),e.updateStatus(t.InstanceStatus.UnknownError)})),Zi.io.on("reconnect_attempt",(r=>{e.log("warn",`Reconnecting... (Attempt #${r})`),e.updateStatus(t.InstanceStatus.Connecting)})),Zi.io.on("reconnect",(r=>{e.log("info",`Reconnected on attempt #${r}!`),e.updateStatus(t.InstanceStatus.Ok)})),Zi.io.on("reconnect_failed",(()=>{e.log("error","Unable to connect to Stagetimer.io!"),e.updateStatus(t.InstanceStatus.ConnectionFailure)})),Zi.io.on("error",(t=>{e.log("debug",`[Socket manager] Unexpected error: ${t}`)})),Zi.on("playback_status",(t=>{e.log("debug",`Event: 'playback_status' ${JSON.stringify(t)}`);const{timer_id:r,running:n,start:i,finish:s,pause:o,server_time:a}=t,c=Date.now()-a;e.log("debug",`Difference between system and server time: ${c}ms`),pn.call(e,{currentTimerId:r,isRunning:n,kickoff:i,deadline:s,lastStop:o,serverTimeDiff:c}),ts.call(e,r)})),Zi.on("room",(t=>{e.log("debug",`Event: 'room' ${JSON.stringify(t)}`);const{blackout:r,focus_message:n,timezone:i}=t;hn.call(e,{roomBlackout:r,roomFocus:n,roomTimezone:i})})),Zi.on("current_timer",(t=>{if(e.log("debug",`Event: 'current_timer' ${JSON.stringify(t)}`),!t)return fn.call(e,{});const{_id:r,name:n,speaker:i,notes:s,duration:o,appearance:a,wrap_up_yellow:c,wrap_up_red:u,start_time:l,start_time_uses_date:d}=t;fn.call(e,{_id:r,name:n,speaker:i,notes:s,duration:o,appearance:a,wrap_up_yellow:c,wrap_up_red:u,start_time:l,start_time_uses_date:d})})),Zi.on("next_timer",(t=>{if(e.log("debug",`Event: 'next_timer' ${JSON.stringify(t)}`),!t)return mn.call(e,{});const{_id:r,name:n,speaker:i,notes:s,duration:o,appearance:a,wrap_up_yellow:c,wrap_up_red:u,start_time:l,start_time_uses_date:d}=t;mn.call(e,{_id:r,name:n,speaker:i,notes:s,duration:o,appearance:a,wrap_up_yellow:c,wrap_up_red:u,start_time:l,start_time_uses_date:d})})),Zi.on("message",(t=>{e.log("debug",`Event: 'message' ${JSON.stringify(t)}`);const{showing:r,text:n,color:i,bold:s,uppercase:o}=t;gn.call(e,{showing:r,text:n,color:i,bold:s,uppercase:o})})),Zi.on("flash",(t=>{e.log("debug",`Event: 'flash' ${JSON.stringify(t)}`);const{count:r}=t;yn.call(e,r)})),Zi.connect()}function ts(e){const t=this;if(!t.apiClient)throw Error("API client not ready");t.apiClient.send(Gi.get_timer,{timer_id:e}).then((({data:e})=>{const{_id:t,name:r,speaker:n,notes:i,duration:s,appearance:o,wrap_up_yellow:a,wrap_up_red:c}=e;fn.call(this,{_id:t,name:r,speaker:n,notes:i,duration:s,appearance:o,wrap_up_yellow:a,wrap_up_red:c})})).catch((e=>{t.log("error",e.toString())}))}let rs={};function ns(e,t){return{feedbackId:e,options:{},style:{...tn[e].defaultStyle,...t}}}class is extends t.InstanceBase{config=_r;state=dn;apiClient=null;async init(e){await this.configure(e)}async configUpdated(e){await this.configure(e)}async configure(e){try{!function(e){if(wr.test(e.roomId)&&vr.test(e.apiKey)&&Tr.test(e.apiUrl))return!0;throw new Error("Bad configuration! Please review module settings and try again.")}(e)}catch(e){this.updateStatus(t.InstanceStatus.BadConfig),e instanceof Error&&this.log("error",e.message)}this.config=e,this.apiClient=new Tn(e);try{es(this),Ki(this),(r=this).setFeedbackDefinitions(function(e){return tn={[rn.isRunning]:{name:"Playback running",type:"boolean",defaultStyle:{bgcolor:Ur.red,color:Ur.white},options:[],callback:t=>e.state.playback_status.isRunning},[rn.isStopped]:{name:"Playback stopped",type:"boolean",defaultStyle:{bgcolor:Ur.red,color:Ur.white},options:[],callback:t=>!e.state.playback_status.isRunning},[rn.isOnTime]:{name:"Timer is running and on time",type:"boolean",defaultStyle:{color:Ur.green},options:[],callback:t=>{let{phase:r,isRunning:n}=e.state.playback_status;return r==un.default&&n}},[rn.isOverTime]:{name:"Timer is over time",type:"boolean",defaultStyle:{color:Ur.red},options:[],callback:t=>{let{phase:r}=e.state.playback_status;return r==un.negative||r==un.zero}},[rn.isWarningYellow]:{name:"Timer is showing yellow wrap-up warning",type:"boolean",defaultStyle:{color:Ur.yellow},options:[],callback:t=>{let{phase:r}=e.state.playback_status;return r==un.yellow}},[rn.isWarningRed]:{name:"Timer is showing red wrap-up warning",type:"boolean",defaultStyle:{color:Ur.red},options:[],callback:t=>{let{phase:r}=e.state.playback_status;return r==un.red}},[rn.isFlashing]:{name:"Flashing",type:"boolean",defaultStyle:{bgcolor:Ur.red,color:Ur.white},options:[],callback:t=>e.state.viewer.isFlashing},[rn.blackoutEnabled]:{name:"Blackout mode",type:"boolean",defaultStyle:{bgcolor:Ur.red,color:Ur.white},options:[],callback:t=>e.state.room.roomBlackout},[rn.focusEnabled]:{name:"Focus mode",type:"boolean",defaultStyle:{bgcolor:Ur.red,color:Ur.white},options:[],callback:t=>e.state.room.roomFocus},[rn.messageIsShowing]:{name:"Message showing",type:"boolean",defaultStyle:{bgcolor:Ur.red,color:Ur.white},options:[],callback:t=>e.state.message.showing}},tn}(r)),this.setVariableDefinitions(sn),function(e){e.setPresetDefinitions(function(){const e={Transport:[{name:"Start/stop toggle",actionId:Gi.start_or_stop,style:{size:"14",text:"Start/stop",alignment:"center:bottom",png64:jr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isRunning,{png64:Br})]},{name:"Start",actionId:Gi.start,style:{size:"14",text:"Start",alignment:"center:bottom",png64:jr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isRunning)]},{name:"Stop",actionId:Gi.stop,style:{size:"14",text:"Stop",alignment:"center:bottom",png64:Br,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isStopped)]},{name:"Reset",actionId:Gi.reset,style:{size:"14",text:"Reset",alignment:"center:bottom",png64:Lr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black}},{name:"Previous",actionId:Gi.previous,style:{size:"14",text:"Previous",alignment:"center:bottom",png64:Vr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black}},{name:"Next",actionId:Gi.next,style:{size:"14",text:"Next",alignment:"center:bottom",png64:Hr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black}},{name:"+1min",actionId:Gi.add_time,actionOptions:{amount:"1m"},style:{size:"24",text:"+1min",alignment:"center:center",color:Ur.lightGreen,bgcolor:Ur.black}},{name:"-1m",actionId:Gi.subtract_time,actionOptions:{amount:"1m"},style:{size:"24",text:"-1m",alignment:"center:center",color:Ur.lightRed,bgcolor:Ur.black}},{name:"+30s",actionId:Gi.add_time,actionOptions:{amount:"30s"},style:{size:"24",text:"+30s",alignment:"center:center",color:Ur.lightGreen,bgcolor:Ur.black}},{name:"-30s",actionId:Gi.subtract_time,actionOptions:{amount:"30s"},style:{size:"24",text:"-30s",alignment:"center:center",color:Ur.lightRed,bgcolor:Ur.black}},{name:"+5min",actionId:Gi.add_time,actionOptions:{amount:"5m"},style:{size:"24",text:"+5min",alignment:"center:center",color:Ur.lightGreen,bgcolor:Ur.black}},{name:"-5m",actionId:Gi.subtract_time,actionOptions:{amount:"5m"},style:{size:"24",text:"-5m",alignment:"center:center",color:Ur.lightRed,bgcolor:Ur.black}}],Viewer:[{name:"Time display",actionId:"",style:{size:"auto",text:`$(stagetimer:${nn.timeDisplay})`,color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isOnTime),ns(rn.isOverTime),ns(rn.isWarningYellow),ns(rn.isWarningRed)]},{name:"Time display (hours)",actionId:"",style:{size:"auto",text:`\n$(stagetimer:${nn.timeDisplayHours})`,color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isOnTime),ns(rn.isOverTime),ns(rn.isWarningYellow),ns(rn.isWarningRed)]},{name:"Time display (minutes)",actionId:"",style:{size:"auto",text:`\n$(stagetimer:${nn.timeDisplayMinutes})`,color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isOnTime),ns(rn.isOverTime),ns(rn.isWarningYellow),ns(rn.isWarningRed)]},{name:"Time display (seconds)",actionId:"",style:{size:"auto",text:`\n$(stagetimer:${nn.timeDisplaySeconds})`,color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isOnTime),ns(rn.isOverTime),ns(rn.isWarningYellow),ns(rn.isWarningRed)]},{name:"Wrap-up indicator",actionId:"",style:{size:"18",text:"Ready",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isOnTime,{text:"On time"}),ns(rn.isOverTime,{text:"Over time!"}),ns(rn.isWarningYellow,{text:"Wrap up.."}),ns(rn.isWarningRed,{text:"Wrap up!"})]},{name:"Timer appearance",actionId:"",style:{size:"auto",text:`$(stagetimer:${nn.currentTimerAppearance})`,color:Ur.lightBlue,bgcolor:Ur.black}},{name:"Timer name",actionId:"",style:{size:"auto",text:`$(stagetimer:${nn.currentTimerName})`,color:Ur.lightBlue,bgcolor:Ur.black}},{name:"Speaker",actionId:"",style:{size:"auto",text:`Speaker: $(stagetimer:${nn.currentTimerSpeaker})`,color:Ur.lightBlue,bgcolor:Ur.black}},{name:"Timezone",actionId:"",style:{size:"auto",text:`$(stagetimer:${nn.roomTimezone})`,color:Ur.lightGray,bgcolor:Ur.black}},{name:"Start flashing",actionId:Gi.start_flashing,actionOptions:{count:3},style:{size:"14",text:"Flash x3",alignment:"center:bottom",png64:qr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isFlashing)]},{name:"Stop flashing",actionId:Gi.stop_flashing,style:{size:"14",text:"Flash off",alignment:"center:bottom",png64:Wr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.isFlashing)]},{name:"Toggle blackout mode",actionId:Gi.toggle_blackout,style:{size:"14",text:"Blackout",alignment:"center:bottom",png64:Yr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.blackoutEnabled,{png64:zr})]},{name:"Toggle focus mode",actionId:Gi.toggle_focus,style:{size:"14",text:"Focus",alignment:"center:bottom",png64:$r,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.focusEnabled,{png64:Gr})]}],Timer:[{name:"Reset a timer",actionId:Gi.reset_timer,actionOptions:{index:1},style:{size:"14",text:"Reset",alignment:"center:bottom",png64:Kr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[]},{name:"Start a timer",actionId:Gi.start_timer,actionOptions:{index:2},style:{size:"14",text:"Start #2",alignment:"center:bottom",png64:Qr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[]},{name:"Stop a timer",actionId:Gi.stop_timer,actionOptions:{index:2},style:{size:"14",text:"Stop #2",alignment:"center:bottom",png64:Qr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[]},{name:"Create timer",actionId:Gi.create_timer,actionOptions:{hours:0,minutes:10,seconds:0,wrap_up_yellow:60,wrap_up_red:15,appearance:0,type:0,trigger:0},style:{size:"14",text:"Create",alignment:"center:bottom",png64:Jr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[]}],Message:[{name:"Show/hide message",actionId:Gi.show_or_hide_message,actionOptions:{index:""},style:{size:"14",text:"Toggle",alignment:"center:bottom",png64:Zr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[ns(rn.messageIsShowing,{png64:Xr})]},{name:"Show message",actionId:Gi.show_message,actionOptions:{index:""},style:{size:"14",text:"Show",alignment:"center:bottom",png64:Zr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[]},{name:"Hide message",actionId:Gi.hide_message,actionOptions:{index:""},style:{size:"14",text:"Hide",alignment:"center:bottom",png64:Xr,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[]},{name:"Create message",actionId:Gi.create_message,actionOptions:{color:0},style:{size:"14",text:"Create",alignment:"center:bottom",png64:en,pngalignment:"center:top",color:Ur.white,bgcolor:Ur.black},feedbacks:[]}]};for(const[t,r]of Object.entries(e))for(const e of r)rs[e.name]={type:"button",category:t,name:e.name,steps:e.steps||[{down:e.actionId?[{actionId:e.actionId,options:e.actionOptions||{}}]:[],up:[]}],style:e.style||{size:"auto",text:e.name,color:Ur.white,bgcolor:Ur.black},feedbacks:e.feedbacks||[]};return rs}())}(this)}catch(e){if(e instanceof Error)throw new Error(`Failed to start. Error: ${e.message}`)}var r}getConfigFields(){return Ar}async destroy(){Xi()}}(0,t.runEntrypoint)(is,[])})()})();