/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={7169:(e,t,n)=>{"use strict";const s=n(2017);s.code='require("ajv/dist/runtime/equal").default',t.A=s},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n={grad:.9,turn:360,rad:360/(2*Math.PI)},s=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},i=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n+0},r=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e>t?e:t},o=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},a=function(e){return{r:r(e.r,0,255),g:r(e.g,0,255),b:r(e.b,0,255),a:r(e.a)}},c=function(e){return{r:i(e.r),g:i(e.g),b:i(e.b),a:i(e.a,3)}},l=/^#([0-9a-f]{3,8})$/i,u=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,n=e.g,s=e.b,i=e.a,r=Math.max(t,n,s),o=r-Math.min(t,n,s),a=o?r===t?(n-s)/o:r===n?2+(s-t)/o:4+(t-n)/o:0;return{h:60*(a<0?a+6:a),s:r?o/r*100:0,v:r/255*100,a:i}},h=function(e){var t=e.h,n=e.s,s=e.v,i=e.a;t=t/360*6,n/=100,s/=100;var r=Math.floor(t),o=s*(1-n),a=s*(1-(t-r)*n),c=s*(1-(1-t+r)*n),l=r%6;return{r:255*[s,a,o,o,c,s][l],g:255*[c,s,s,a,o,o][l],b:255*[o,o,c,s,s,a][l],a:i}},p=function(e){return{h:o(e.h),s:r(e.s,0,100),l:r(e.l,0,100),a:r(e.a)}},f=function(e){return{h:i(e.h),s:i(e.s),l:i(e.l),a:i(e.a,3)}},b=function(e){return h((n=(t=e).s,{h:t.h,s:(n*=((s=t.l)<50?s:100-s)/100)>0?2*n/(s+n)*100:0,v:s+n,a:t.a}));var t,n,s},g=function(e){return{h:(t=d(e)).h,s:(i=(200-(n=t.s))*(s=t.v)/100)>0&&i<200?n*s/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,n,s,i},m=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,x={string:[[function(e){var t=l.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?i(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?i(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=v.exec(e)||_.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=m.exec(e)||y.exec(e);if(!t)return null;var s,i,r=p({h:(s=t[1],i=t[2],void 0===i&&(i="deg"),Number(s)*(n[i]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return b(r)},"hsl"]],object:[[function(e){var t=e.r,n=e.g,i=e.b,r=e.a,o=void 0===r?1:r;return s(t)&&s(n)&&s(i)?a({r:Number(t),g:Number(n),b:Number(i),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,n=e.s,i=e.l,r=e.a,o=void 0===r?1:r;if(!s(t)||!s(n)||!s(i))return null;var a=p({h:Number(t),s:Number(n),l:Number(i),a:Number(o)});return b(a)},"hsl"],[function(e){var t=e.h,n=e.s,i=e.v,a=e.a,c=void 0===a?1:a;if(!s(t)||!s(n)||!s(i))return null;var l=function(e){return{h:o(e.h),s:r(e.s,0,100),v:r(e.v,0,100),a:r(e.a)}}({h:Number(t),s:Number(n),v:Number(i),a:Number(c)});return h(l)},"hsv"]]},S=function(e,t){for(var n=0;n<t.length;n++){var s=t[n][0](e);if(s)return[s,t[n][1]]}return[null,void 0]},k=function(e){return"string"==typeof e?S(e.trim(),x.string):"object"==typeof e&&null!==e?S(e,x.object):[null,void 0]},I=function(e,t){var n=g(e);return{h:n.h,s:r(n.s+100*t,0,100),l:n.l,a:n.a}},w=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},E=function(e,t){var n=g(e);return{h:n.h,s:n.s,l:r(n.l+100*t,0,100),a:n.a}},O=function(){function e(e){this.parsed=k(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return i(w(this.rgba),2)},e.prototype.isDark=function(){return w(this.rgba)<.5},e.prototype.isLight=function(){return w(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=c(this.rgba)).r,n=e.g,s=e.b,o=(r=e.a)<1?u(i(255*r)):"","#"+u(t)+u(n)+u(s)+o;var e,t,n,s,r,o},e.prototype.toRgb=function(){return c(this.rgba)},e.prototype.toRgbString=function(){return t=(e=c(this.rgba)).r,n=e.g,s=e.b,(i=e.a)<1?"rgba("+t+", "+n+", "+s+", "+i+")":"rgb("+t+", "+n+", "+s+")";var e,t,n,s,i},e.prototype.toHsl=function(){return f(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=f(g(this.rgba))).h,n=e.s,s=e.l,(i=e.a)<1?"hsla("+t+", "+n+"%, "+s+"%, "+i+")":"hsl("+t+", "+n+"%, "+s+"%)";var e,t,n,s,i},e.prototype.toHsv=function(){return e=d(this.rgba),{h:i(e.h),s:i(e.s),v:i(e.v),a:i(e.a,3)};var e},e.prototype.invert=function(){return C({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),C(I(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),C(I(this.rgba,-e))},e.prototype.grayscale=function(){return C(I(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),C(E(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),C(E(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?C({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):i(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?C({h:e,s:t.s,l:t.l,a:t.a}):i(t.h)},e.prototype.isEqual=function(e){return this.toHex()===C(e).toHex()},e}(),C=function(e){return e instanceof O?e:new O(e)},T=[];t.Colord=O,t.colord=C,t.extend=function(e){e.forEach((function(e){T.indexOf(e)<0&&(e(O,x),T.push(e))}))},t.getFormat=function(e){return k(e)[1]},t.random=function(){return new O({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},7833:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let s=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(s++,"%c"===e&&(i=s))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(736)(t);const{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},736:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,r,o=null;function a(...e){if(!a.enabled)return;const s=a,i=Number(new Date),r=i-(n||i);s.diff=r,s.prev=n,s.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";o++;const r=t.formatters[i];if("function"==typeof r){const t=e[o];n=r.call(s,t),e.splice(o,1),o--}return n})),t.formatArgs.call(s,e),(s.log||t.log).apply(s,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=s,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,r=t.enabled(e)),r),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function s(e,n){const s=t(this.namespace+(void 0===n?":":n)+e);return s.log=this.log,s}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const s=("string"==typeof e?e:"").split(/[\s,]+/),i=s.length;for(n=0;n<i;n++)s[n]&&("-"===(e=s[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,s;for(n=0,s=t.skips.length;n<s;n++)if(t.skips[n].test(e))return!1;for(n=0,s=t.names.length;n<s;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(6585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},5753:(e,t,n)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=n(7833):e.exports=n(6033)},6033:(e,t,n)=>{const s=n(9637),i=n(9023);t.init=function(e){e.inspectOpts={};const n=Object.keys(t.inspectOpts);for(let s=0;s<n.length;s++)e.inspectOpts[n[s]]=t.inspectOpts[n[s]]},t.log=function(...e){return process.stderr.write(i.formatWithOptions(t.inspectOpts,...e)+"\n")},t.formatArgs=function(n){const{namespace:s,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),r=`  ${i};1m${s} [0m`;n[0]=r+n[0].split("\n").join("\n"+r),n.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+s+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):s.isatty(process.stderr.fd)},t.destroy=i.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=n(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const n=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let s=process.env[t];return s=!!/^(yes|on|true|enabled)$/i.test(s)||!/^(no|off|false|disabled)$/i.test(s)&&("null"===s?null:Number(s)),e[n]=s,e}),{}),e.exports=n(736)(t);const{formatters:r}=e.exports;r.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},r.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===s(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var i=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=i,t.convertMapToObject=function(e){return Array.from(e).reduce((function(e,t){var s=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var s,i,r=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(s=n.next()).done)&&(r.push(s.value),!t||r.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),i=s[0],r=s[1];return e[i]=r,e}),{})},t.isArguments=function(e){return null!=e&&i(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var r={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=r,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(r.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var n=Object.create(null),s=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},i=0;i<64;i++)n[s(i)]=i;var r=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],n=0;n<e;n++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},o={encode:function(e){if("string"==typeof e){var t=e;e=r(t.length);for(var n=0;n<t.length;n++){var i=t.charCodeAt(n);if(i>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[n]=i}}for(var o=[],a=null,c=null,l=null,u=null,d=0;d<e.length;d++)switch(d%3){case 0:a=e[d]>>2&63,c=(3&e[d])<<4;break;case 1:c|=e[d]>>4&15,l=(15&e[d])<<2;break;case 2:l|=e[d]>>6&3,u=63&e[d],o.push(s(a)),o.push(s(c)),o.push(s(l)),o.push(s(u)),a=null,c=null,l=null,u=null}return null!=a&&(o.push(s(a)),o.push(s(c)),null==l?o.push("="):o.push(s(l)),null==u&&o.push("=")),o.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var s,i=r(t),o=null,a=null,c=null,l=0,u=0;u<e.length;u++){var d="="===(s=e.charAt(u))?-1:n[s];switch(u%4){case 0:if(d<0)throw new Error("invalid base64 string");o=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");o|=d>>4,i[l++]=o,a=(15&d)<<4;break;case 2:d>=0&&(a|=d>>2,i[l++]=a,c=(3&d)<<6);break;case 3:d>=0&&(i[l++]=c|d)}}return i},newBinary:r};t.Base64=o},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function s(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function e(t,i,r,o,a){var c=i[t];switch(n(c)){case"string":return s(c);case"number":return isFinite(c)?String(c):"null";case"boolean":return String(c);case"object":if(!c)return"null";var l,u=o+r,d=[];if(Array.isArray(c)||{}.hasOwnProperty.call(c,"callee")){for(var h=c.length,p=0;p<h;p+=1)d[p]=e(p,c,r,u,a)||"null";return l=0===d.length?"[]":u?"[\n"+u+d.join(",\n"+u)+"\n"+o+"]":"["+d.join(",")+"]"}var f=Object.keys(c);return a&&(f=f.sort()),f.forEach((function(t){(l=e(t,c,r,u,a))&&d.push(s(t)+(u?": ":":")+l)})),l=0===d.length?"{}":u?"{\n"+u+d.join(",\n"+u)+"\n"+o+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var n=Object.assign({indent:"",canonical:!1},t);if(!0===n.indent)n.indent="  ";else if("number"==typeof n.indent){for(var s="",r=0;r<n.indent;r++)s+=" ";n.indent=s}return i("",{"":e},n.indent,"",n.canonical)},e.exports=t.default}],n={};function s(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,s),r.exports}var i={};!function(){var e=i,t=s(2).Base64,n=s(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var r=s(1),o={};e.EJSON=o;var a=new Map;o.addType=function(e,t){if(a.has(e))throw new Error("Type ".concat(e," already present"));a.set(e,t)};var c=[{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$date")&&1===(0,r.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$regexp")&&(0,r.hasOwn)(e,"$flags")&&2===(0,r.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$InfNaN")&&1===(0,r.lengthOf)(e)},matchObject:r.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$binary")&&1===(0,r.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,r.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$escape")&&1===(0,r.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var n=(0,r.lengthOf)(e);1!==n&&2!==n||(t=c.some((function(t){return t.matchJSONValue(e)})))}return t},toJSONValue:function(e){var t={};return(0,r.keysOf)(e).forEach((function(n){t[n]=o.toJSONValue(e[n])})),{$escape:t}},fromJSONValue:function(e){var t={};return(0,r.keysOf)(e.$escape).forEach((function(n){t[n]=o.fromJSONValue(e.$escape[n])})),t}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$type")&&(0,r.hasOwn)(e,"$value")&&2===(0,r.lengthOf)(e)},matchObject:function(e){return o._isCustomType(e)},toJSONValue:function(e){var t=n._noYieldsAllowed((function(){return e.toJSONValue()}));return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!a.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var s=a.get(t);return n._noYieldsAllowed((function(){return s(e.$value)}))}}];o._isCustomType=function(e){return e&&(0,r.isFunction)(e.toJSONValue)&&(0,r.isFunction)(e.typeName)&&a.has(e.typeName())},o._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?a:(0,r.convertMapToObject)(a)},o._getConverters=function(){return c};var l=function(e){for(var t=0;t<c.length;t++){var n=c[t];if(n.matchObject(e))return n.toJSONValue(e)}},u=function e(t){if(null===t)return null;var n=l(t);return void 0!==n?n:(0,r.isObject)(t)?((0,r.keysOf)(t).forEach((function(n){var s=t[n];if((0,r.isObject)(s)||void 0===s||(0,r.isInfOrNaN)(s)){var i=l(s);i?t[n]=i:e(s)}})),t):t};o._adjustTypesToJSONValue=u,o.toJSONValue=function(e){var t=l(e);if(void 0!==t)return t;var n=e;return(0,r.isObject)(e)&&(n=o.clone(e),u(n)),n};var d=function(e){if((0,r.isObject)(e)&&null!==e){var t=(0,r.keysOf)(e);if(t.length<=2&&t.every((function(e){return"string"==typeof e&&"$"===e.substr(0,1)})))for(var n=0;n<c.length;n++){var s=c[n];if(s.matchJSONValue(e))return s.fromJSONValue(e)}}return e},h=function e(t){if(null===t)return null;var n=d(t);return n!==t?n:(0,r.isObject)(t)?((0,r.keysOf)(t).forEach((function(n){var s=t[n];if((0,r.isObject)(s)){var i=d(s);if(s!==i)return void(t[n]=i);e(s)}})),t):t};o._adjustTypesFromJSONValue=h,o.fromJSONValue=function(e){var t=d(e);return t===e&&(0,r.isObject)(e)&&(t=o.clone(e),h(t)),t},o.stringify=(0,r.handleError)((function(e,t){var n=o.toJSONValue(e);return t&&(t.canonical||t.indent)?s(4)(n,t):JSON.stringify(n)})),o.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return o.fromJSONValue(JSON.parse(e))},o.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},o.equals=function(e,t,n){var s,i=!(!n||!n.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,r.isObject)(e)||!(0,r.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(o.isBinary(e)&&o.isBinary(t)){if(e.length!==t.length)return!1;for(s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0}if((0,r.isFunction)(e.equals))return e.equals(t,n);if((0,r.isFunction)(t.equals))return t.equals(e,n);var a,c=Array.isArray(e),l=Array.isArray(t);if(c!==l)return!1;if(c&&l){if(e.length!==t.length)return!1;for(s=0;s<e.length;s++)if(!o.equals(e[s],t[s],n))return!1;return!0}switch(o._isCustomType(e)+o._isCustomType(t)){case 1:return!1;case 2:return o.equals(o.toJSONValue(e),o.toJSONValue(t))}var u=(0,r.keysOf)(e),d=(0,r.keysOf)(t);return i?(s=0,a=u.every((function(i){return!(s>=d.length||i!==d[s]||!o.equals(e[i],t[d[s]],n)||(s++,0))}))):(s=0,a=u.every((function(i){return!!(0,r.hasOwn)(t,i)&&!!o.equals(e[i],t[i],n)&&(s++,!0)}))),a&&s===d.length},o.clone=function(e){var t;if(!(0,r.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(o.isBinary(e)){t=o.newBinary(e.length);for(var n=0;n<e.length;n++)t[n]=e[n];return t}return Array.isArray(e)?e.map(o.clone):(0,r.isArguments)(e)?Array.from(e).map(o.clone):(0,r.isFunction)(e.clone)?e.clone():o._isCustomType(e)?o.fromJSONValue(o.clone(o.toJSONValue(e)),!0):(t={},(0,r.keysOf)(e).forEach((function(n){t[n]=o.clone(e[n])})),t)},o.newBinary=t.newBinary}(),e.exports=i.EJSON}()},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function s(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,s,r,o){if("function"!=typeof s)throw new TypeError("The listener must be a function");var a=new i(s,r||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new s:delete e._events[t]}function a(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,s,i=[];if(0===this._eventsCount)return i;for(s in e=this._events)t.call(e,s)&&i.push(n?s.slice(1):s);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,s=this._events[t];if(!s)return[];if(s.fn)return[s.fn];for(var i=0,r=s.length,o=new Array(r);i<r;i++)o[i]=s[i].fn;return o},a.prototype.listenerCount=function(e){var t=n?n+e:e,s=this._events[t];return s?s.fn?1:s.length:0},a.prototype.emit=function(e,t,s,i,r,o){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,s),!0;case 4:return u.fn.call(u.context,t,s,i),!0;case 5:return u.fn.call(u.context,t,s,i,r),!0;case 6:return u.fn.call(u.context,t,s,i,r,o),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,s);break;case 4:u[l].fn.call(u[l].context,t,s,i);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,s,i){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return o(this,r),this;var a=this._events[r];if(a.fn)a.fn!==t||i&&!a.once||s&&a.context!==s||o(this,r);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||s&&a[c].context!==s)&&l.push(a[c]);l.length?this._events[r]=1===l.length?l[0]:l:o(this,r)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},2017:e=>{"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var s,i,r;if(Array.isArray(t)){if((s=t.length)!=n.length)return!1;for(i=s;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((s=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=s;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=s;0!=i--;){var o=r[i];if(!e(t[o],n[o]))return!1}return!0}return t!=t&&n!=n}},5884:e=>{"use strict";e.exports=(e,t=process.argv)=>{const n=e.startsWith("-")?"":1===e.length?"-":"--",s=t.indexOf(n+e),i=t.indexOf("--");return-1!==s&&(-1===i||s<i)}},4865:e=>{"use strict";const t=(e,t,s,i)=>{if("length"===s||"prototype"===s)return;if("arguments"===s||"caller"===s)return;const r=Object.getOwnPropertyDescriptor(e,s),o=Object.getOwnPropertyDescriptor(t,s);!n(r,o)&&i||Object.defineProperty(e,s,o)},n=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},s=(e,t)=>`/* Wrapped ${e}*/\n${t}`,i=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),r=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,n,{ignoreNonConfigurable:o=!1}={})=>{const{name:a}=e;for(const s of Reflect.ownKeys(n))t(e,n,s,o);return((e,t)=>{const n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,n)})(e,n),((e,t,n)=>{const o=""===n?"":`with ${n.trim()}() `,a=s.bind(null,o,t.toString());Object.defineProperty(a,"name",r),Object.defineProperty(e,"toString",{...i,value:a})})(e,n,a),e}},6585:e=>{var t=1e3,n=60*t,s=60*n,i=24*s,r=7*i;function o(e,t,n,s){var i=t>=1.5*n;return Math.round(e/n)+" "+s+(i?"s":"")}e.exports=function(e,a){a=a||{};var c,l,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*r;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*s;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===u&&isFinite(e))return a.long?(c=e,(l=Math.abs(c))>=i?o(c,l,i,"day"):l>=s?o(c,l,s,"hour"):l>=n?o(c,l,n,"minute"):l>=t?o(c,l,t,"second"):c+" ms"):function(e){var r=Math.abs(e);return r>=i?Math.round(e/i)+"d":r>=s?Math.round(e/s)+"h":r>=n?Math.round(e/n)+"m":r>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},3290:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(228),i=n(7685),r=n(4774),o=()=>{},a=new i.TimeoutError;t.default=class extends s{constructor(e){var t,n,s,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=o,this._resolveIdle=o,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:r.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(s=e.interval)||void 0===s?void 0:s.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=o,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=o,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((n,s)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const r=void 0===this._timeout&&void 0===t.timeout?e():i.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&s(a)}));n(await r)}catch(e){s(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){let s=0,i=e.length;for(;i>0;){const r=i/2|0;let o=s+r;n(e[o],t)<=0?(s=++o,i-=r+1):i=r}return s}},4774:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const n={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(n);const i=s.default(this._queue,n,((e,t)=>t.priority-e.priority));this._queue.splice(i,0,n)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},7685:(e,t,n)=>{"use strict";const s=n(4617);class i extends Error{constructor(e){super(e),this.name="TimeoutError"}}const r=(e,t,n)=>new Promise(((r,o)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void r(e);const a=setTimeout((()=>{if("function"==typeof n){try{r(n())}catch(e){o(e)}return}const s=n instanceof Error?n:new i("string"==typeof n?n:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),o(s)}),t);s(e.then(r,o),(()=>{clearTimeout(a)}))}));e.exports=r,e.exports.default=r,e.exports.TimeoutError=i},7687:(e,t,n)=>{"use strict";const s=n(857),i=n(9637),r=n(5884),{env:o}=process;let a;function c(e,t={}){return 0!==(n=function(e,{streamIsTTY:t,sniffFlags:n=!0}={}){const i=function(){if("FORCE_COLOR"in o)return"true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(Number.parseInt(o.FORCE_COLOR,10),3)}();void 0!==i&&(a=i);const c=n?a:i;if(0===c)return 0;if(n){if(r("color=16m")||r("color=full")||r("color=truecolor"))return 3;if(r("color=256"))return 2}if(e&&!t&&void 0===c)return 0;const l=c||0;if("dumb"===o.TERM)return l;if("win32"===process.platform){const e=s.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some((e=>e in o))||"codeship"===o.CI_NAME?1:l;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=Number.parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:l}(e,{streamIsTTY:e&&e.isTTY,...t}))&&{level:n,hasBasic:!0,has256:n>=2,has16m:n>=3};var n}r("no-color")||r("no-colors")||r("color=false")||r("color=never")?a=0:(r("color")||r("colors")||r("color=true")||r("color=always"))&&(a=1),e.exports={supportsColor:c,stdout:c({isTTY:i.isatty(1)}),stderr:c({isTTY:i.isatty(2)})}},7699:(e,t,n)=>{"use strict";const s=n(1060);s.createWebSocketStream=n(3719),s.Server=n(1722),s.Receiver=n(6286),s.Sender=n(914),s.WebSocket=s,s.WebSocketServer=s.Server,e.exports=s},3338:(e,t,n)=>{"use strict";const{EMPTY_BUFFER:s}=n(2614),i=Buffer[Symbol.species];function r(e,t,n,s,i){for(let r=0;r<i;r++)n[s+r]=e[r]^t[3&r]}function o(e,t){for(let n=0;n<e.length;n++)e[n]^=t[3&n]}if(e.exports={concat:function(e,t){if(0===e.length)return s;if(1===e.length)return e[0];const n=Buffer.allocUnsafe(t);let r=0;for(let t=0;t<e.length;t++){const s=e[t];n.set(s,r),r+=s.length}return r<t?new i(n.buffer,n.byteOffset,r):n},mask:r,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let n;return t instanceof ArrayBuffer?n=new i(t):ArrayBuffer.isView(t)?n=new i(t.buffer,t.byteOffset,t.byteLength):(n=Buffer.from(t),e.readOnly=!1),n},unmask:o},!process.env.WS_NO_BUFFER_UTIL)try{const t=n(Object(function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()));e.exports.mask=function(e,n,s,i,o){o<48?r(e,n,s,i,o):t.mask(e,n,s,i,o)},e.exports.unmask=function(e,n){e.length<32?o(e,n):t.unmask(e,n)}}catch(e){}},2614:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},597:(e,t,n)=>{"use strict";const{kForOnEventAttribute:s,kListener:i}=n(2614),r=Symbol("kCode"),o=Symbol("kData"),a=Symbol("kError"),c=Symbol("kMessage"),l=Symbol("kReason"),u=Symbol("kTarget"),d=Symbol("kType"),h=Symbol("kWasClean");class p{constructor(e){this[u]=null,this[d]=e}get target(){return this[u]}get type(){return this[d]}}Object.defineProperty(p.prototype,"target",{enumerable:!0}),Object.defineProperty(p.prototype,"type",{enumerable:!0});class f extends p{constructor(e,t={}){super(e),this[r]=void 0===t.code?0:t.code,this[l]=void 0===t.reason?"":t.reason,this[h]=void 0!==t.wasClean&&t.wasClean}get code(){return this[r]}get reason(){return this[l]}get wasClean(){return this[h]}}Object.defineProperty(f.prototype,"code",{enumerable:!0}),Object.defineProperty(f.prototype,"reason",{enumerable:!0}),Object.defineProperty(f.prototype,"wasClean",{enumerable:!0});class b extends p{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[c]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[c]}}Object.defineProperty(b.prototype,"error",{enumerable:!0}),Object.defineProperty(b.prototype,"message",{enumerable:!0});class g extends p{constructor(e,t={}){super(e),this[o]=void 0===t.data?null:t.data}get data(){return this[o]}}Object.defineProperty(g.prototype,"data",{enumerable:!0});const m={addEventListener(e,t,n={}){for(const r of this.listeners(e))if(!n[s]&&r[i]===t&&!r[s])return;let r;if("message"===e)r=function(e,n){const s=new g("message",{data:n?e:e.toString()});s[u]=this,y(t,this,s)};else if("close"===e)r=function(e,n){const s=new f("close",{code:e,reason:n.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});s[u]=this,y(t,this,s)};else if("error"===e)r=function(e){const n=new b("error",{error:e,message:e.message});n[u]=this,y(t,this,n)};else{if("open"!==e)return;r=function(){const e=new p("open");e[u]=this,y(t,this,e)}}r[s]=!!n[s],r[i]=t,n.once?this.once(e,r):this.on(e,r)},removeEventListener(e,t){for(const n of this.listeners(e))if(n[i]===t&&!n[s]){this.removeListener(e,n);break}}};function y(e,t,n){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,n):e.call(t,n)}e.exports={CloseEvent:f,ErrorEvent:b,Event:p,EventTarget:m,MessageEvent:g}},5926:(e,t,n)=>{"use strict";const{tokenChars:s}=n(5880);function i(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}e.exports={format:function(e){return Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>[t].concat(Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let n,r,o=Object.create(null),a=!1,c=!1,l=!1,u=-1,d=-1,h=-1,p=0;for(;p<e.length;p++)if(d=e.charCodeAt(p),void 0===n)if(-1===h&&1===s[d])-1===u&&(u=p);else if(0===p||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${p}`);{if(-1===u)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);const s=e.slice(u,h);44===d?(i(t,s,o),o=Object.create(null)):n=s,u=h=-1}}else-1===h&&-1!==u&&(h=p);else if(void 0===r)if(-1===h&&1===s[d])-1===u&&(u=p);else if(32===d||9===d)-1===h&&-1!==u&&(h=p);else if(59===d||44===d){if(-1===u)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p),i(o,e.slice(u,h),!0),44===d&&(i(t,n,o),o=Object.create(null),n=void 0),u=h=-1}else{if(61!==d||-1===u||-1!==h)throw new SyntaxError(`Unexpected character at index ${p}`);r=e.slice(u,p),u=h=-1}else if(c){if(1!==s[d])throw new SyntaxError(`Unexpected character at index ${p}`);-1===u?u=p:a||(a=!0),c=!1}else if(l)if(1===s[d])-1===u&&(u=p);else if(34===d&&-1!==u)l=!1,h=p;else{if(92!==d)throw new SyntaxError(`Unexpected character at index ${p}`);c=!0}else if(34===d&&61===e.charCodeAt(p-1))l=!0;else if(-1===h&&1===s[d])-1===u&&(u=p);else if(-1===u||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${p}`);{if(-1===u)throw new SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);let s=e.slice(u,h);a&&(s=s.replace(/\\/g,""),a=!1),i(o,r,s),44===d&&(i(t,n,o),o=Object.create(null),n=void 0),r=void 0,u=h=-1}}else-1===h&&(h=p);if(-1===u||l||32===d||9===d)throw new SyntaxError("Unexpected end of input");-1===h&&(h=p);const f=e.slice(u,h);return void 0===n?i(t,f,o):(void 0===r?i(o,f,!0):i(o,r,a?f.replace(/\\/g,""):f),i(t,n,o)),t}}},4759:e=>{"use strict";const t=Symbol("kDone"),n=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[n]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[n]()}[n](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},2971:(e,t,n)=>{"use strict";const s=n(3106),i=n(3338),r=n(4759),{kStatusCode:o}=n(2614),a=Buffer[Symbol.species],c=Buffer.from([0,0,255,255]),l=Symbol("permessage-deflate"),u=Symbol("total-length"),d=Symbol("callback"),h=Symbol("buffers"),p=Symbol("error");let f;function b(e){this[h].push(e),this[u]+=e.length}function g(e){this[u]+=e.length,this[l]._maxPayload<1||this[u]<=this[l]._maxPayload?this[h].push(e):(this[p]=new RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][o]=1009,this.removeListener("data",g),this.reset())}function m(e){this[l]._inflate=null,e[o]=1007,this[d](e)}e.exports=class{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!f){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;f=new r(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[d];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,n=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n}))})),e}decompress(e,t,n){f.add((s=>{this._decompress(e,t,((e,t)=>{s(),n(e,t)}))}))}compress(e,t,n){f.add((s=>{this._compress(e,t,((e,t)=>{s(),n(e,t)}))}))}_decompress(e,t,n){const r=this._isServer?"client":"server";if(!this._inflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?s.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=s.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[l]=this,this._inflate[u]=0,this._inflate[h]=[],this._inflate.on("error",m),this._inflate.on("data",g)}this._inflate[d]=n,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush((()=>{const e=this._inflate[p];if(e)return this._inflate.close(),this._inflate=null,void n(e);const s=i.concat(this._inflate[h],this._inflate[u]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[u]=0,this._inflate[h]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),n(null,s)}))}_compress(e,t,n){const r=this._isServer?"server":"client";if(!this._deflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?s.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=s.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[u]=0,this._deflate[h]=[],this._deflate.on("data",b)}this._deflate[d]=n,this._deflate.write(e),this._deflate.flush(s.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=i.concat(this._deflate[h],this._deflate[u]);t&&(e=new a(e.buffer,e.byteOffset,e.length-4)),this._deflate[d]=null,this._deflate[u]=0,this._deflate[h]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),n(null,e)}))}}},6286:(e,t,n)=>{"use strict";const{Writable:s}=n(2203),i=n(2971),{BINARY_TYPES:r,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:c}=n(2614),{concat:l,toArrayBuffer:u,unmask:d}=n(3338),{isValidStatusCode:h,isValidUTF8:p}=n(5880),f=Buffer[Symbol.species];e.exports=class extends s{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||r[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,n){if(8===this._opcode&&0==this._state)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new f(t.buffer,t.byteOffset+e,t.length-e),new f(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0],s=t.length-e;e>=n.length?t.set(this._buffers.shift(),s):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),s),this._buffers[0]=new f(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return t}startLoop(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)return void(this._loop=!1);const t=this.consume(2);if(48&t[0])return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));const n=!(64&~t[0]);if(!n||this._extensions[i.extensionName]){if(this._fin=!(128&~t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(n)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=n}else{if(!(this._opcode>7&&this._opcode<11))return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(n)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=!(128&~t[1]),this._isServer){if(!this._masked)return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}else e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){if(this._bufferedBytes<8)return void(this._loop=!1);const t=this.consume(8),n=t.readUInt32BE(0);n>Math.pow(2,21)-1?e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e))}haveLength(e){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&d(t,this._mask)}if(this._opcode>7)this.controlMessage(t,e);else{if(this._compressed)return this._state=5,void this.decompress(t,e);t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,((e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0){const e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void t(e)}this._fragments.push(n)}this.dataMessage(t),0===this._state&&this.startLoop(t)}))}dataMessage(e){if(!this._fin)return void(this._state=0);const t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let s;s="nodebuffer"===this._binaryType?l(n,t):"arraybuffer"===this._binaryType?u(l(n,t)):n,this._allowSynchronousEvents?(this.emit("message",s,!0),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",s,!0),this._state=0,this.startLoop(e)})))}else{const s=l(n,t);if(!this._skipUTF8Validation&&!p(s)){const t=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(t)}5===this._state||this._allowSynchronousEvents?(this.emit("message",s,!1),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",s,!1),this._state=0,this.startLoop(e)})))}}controlMessage(e,t){if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate((()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)})));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,o),this.end();else{const n=e.readUInt16BE(0);if(!h(n)){const e=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(e)}const s=new f(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!p(s)){const e=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(e)}this._loop=!1,this.emit("conclude",n,s),this.end()}this._state=0}}createError(e,t,n,s,i){this._loop=!1,this._errored=!0;const r=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(r,this.createError),r.code=i,r[a]=s,r}}},914:(e,t,n)=>{"use strict";const{Duplex:s}=n(2203),{randomFillSync:i}=n(6982),r=n(2971),{EMPTY_BUFFER:o}=n(2614),{isValidStatusCode:a}=n(5880),{mask:c,toBuffer:l}=n(3338),u=Symbol("kByteLength"),d=Buffer.alloc(4),h=8192;let p,f=h;class b{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let n,s,r=!1,o=2,a=!1;t.mask&&(n=t.maskBuffer||d,t.generateMask?t.generateMask(n):(f===h&&(void 0===p&&(p=Buffer.alloc(h)),i(p,0,h),f=0),n[0]=p[f++],n[1]=p[f++],n[2]=p[f++],n[3]=p[f++]),a=!(n[0]|n[1]|n[2]|n[3]),o=6),"string"==typeof e?s=t.mask&&!a||void 0===t[u]?(e=Buffer.from(e)).length:t[u]:(s=e.length,r=t.mask&&t.readOnly&&!a);let l=s;s>=65536?(o+=8,l=127):s>125&&(o+=2,l=126);const b=Buffer.allocUnsafe(r?s+o:o);return b[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(b[0]|=64),b[1]=l,126===l?b.writeUInt16BE(s,2):127===l&&(b[2]=b[3]=0,b.writeUIntBE(s,4,6)),t.mask?(b[1]|=128,b[o-4]=n[0],b[o-3]=n[1],b[o-2]=n[2],b[o-1]=n[3],a?[b,e]:r?(c(e,n,b,o,s),[b]):(c(e,n,e,0,s),[b,e])):[b,e]}close(e,t,n,s){let i;if(void 0===e)i=o;else{if("number"!=typeof e||!a(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const n=Buffer.byteLength(t);if(n>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+n),i.writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0)}const r={[u]:i.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,i,!1,r,s]):this.sendFrame(b.frame(i,r),s)}ping(e,t,n){let s,i;if("string"==typeof e?(s=Buffer.byteLength(e),i=!1):(s=(e=l(e)).length,i=l.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");const r={[u]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,r,n]):this.sendFrame(b.frame(e,r),n)}pong(e,t,n){let s,i;if("string"==typeof e?(s=Buffer.byteLength(e),i=!1):(s=(e=l(e)).length,i=l.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");const r={[u]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,r,n]):this.sendFrame(b.frame(e,r),n)}send(e,t,n){const s=this._extensions[r.extensionName];let i,o,a=t.binary?2:1,c=t.compress;if("string"==typeof e?(i=Buffer.byteLength(e),o=!1):(i=(e=l(e)).length,o=l.readOnly),this._firstFragment?(this._firstFragment=!1,c&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(c=i>=s._threshold),this._compress=c):(c=!1,a=0),t.fin&&(this._firstFragment=!0),s){const s={[u]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:o,rsv1:c};this._deflating?this.enqueue([this.dispatch,e,this._compress,s,n]):this.dispatch(e,this._compress,s,n)}else this.sendFrame(b.frame(e,{[u]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:o,rsv1:!1}),n)}dispatch(e,t,n,s){if(!t)return void this.sendFrame(b.frame(e,n),s);const i=this._extensions[r.extensionName];this._bufferedBytes+=n[u],this._deflating=!0,i.compress(e,n.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof s&&s(e);for(let t=0;t<this._queue.length;t++){const n=this._queue[t],s=n[n.length-1];"function"==typeof s&&s(e)}}else this._bufferedBytes-=n[u],this._deflating=!1,n.readOnly=!1,this.sendFrame(b.frame(t,n),s),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][u],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][u],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=b},3719:(e,t,n)=>{"use strict";const{Duplex:s}=n(2203);function i(e){e.emit("close")}function r(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let n=!0;const a=new s({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t,n){const s=!n&&a._readableState.objectMode?t.toString():t;a.push(s)||e.pause()})),e.once("error",(function(e){a.destroyed||(n=!1,a.destroy(e))})),e.once("close",(function(){a.destroyed||a.push(null)})),a._destroy=function(t,s){if(e.readyState===e.CLOSED)return s(t),void process.nextTick(i,a);let r=!1;e.once("error",(function(e){r=!0,s(e)})),e.once("close",(function(){r||s(t),process.nextTick(i,a)})),n&&e.terminate()},a._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){a._final(t)}))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,n,s){e.readyState!==e.CONNECTING?e.send(t,s):e.once("open",(function(){a._write(t,n,s)}))},a.on("end",r),a.on("error",o),a}},8237:(e,t,n)=>{"use strict";const{tokenChars:s}=n(5880);e.exports={parse:function(e){const t=new Set;let n=-1,i=-1,r=0;for(;r<e.length;r++){const o=e.charCodeAt(r);if(-1===i&&1===s[o])-1===n&&(n=r);else if(0===r||32!==o&&9!==o){if(44!==o)throw new SyntaxError(`Unexpected character at index ${r}`);{if(-1===n)throw new SyntaxError(`Unexpected character at index ${r}`);-1===i&&(i=r);const s=e.slice(n,i);if(t.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);t.add(s),n=i=-1}}else-1===i&&-1!==n&&(i=r)}if(-1===n||-1!==i)throw new SyntaxError("Unexpected end of input");const o=e.slice(n,r);if(t.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}},5880:(e,t,n)=>{"use strict";const{isUtf8:s}=n(181);function i(e){const t=e.length;let n=0;for(;n<t;)if(128&e[n])if(192==(224&e[n])){if(n+1===t||128!=(192&e[n+1])||192==(254&e[n]))return!1;n+=2}else if(224==(240&e[n])){if(n+2>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||224===e[n]&&128==(224&e[n+1])||237===e[n]&&160==(224&e[n+1]))return!1;n+=3}else{if(240!=(248&e[n]))return!1;if(n+3>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||128!=(192&e[n+3])||240===e[n]&&128==(240&e[n+1])||244===e[n]&&e[n+1]>143||e[n]>244)return!1;n+=4}else n++;return!0}if(e.exports={isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:i,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},s)e.exports.isValidUTF8=function(e){return e.length<24?i(e):s(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const t=n(Object(function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}()));e.exports.isValidUTF8=function(e){return e.length<32?i(e):t(e)}}catch(e){}},1722:(e,t,n)=>{"use strict";const s=n(4434),i=n(8611),{Duplex:r}=n(2203),{createHash:o}=n(6982),a=n(5926),c=n(2971),l=n(8237),u=n(1060),{GUID:d,kWebSocket:h}=n(2614),p=/^[+/0-9A-Za-z]{22}==$/;function f(e){e._state=2,e.emit("close")}function b(){this.destroy()}function g(e,t,n,s){n=n||i.STATUS_CODES[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n),...s},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r\n`+Object.keys(s).map((e=>`${e}: ${s[e]}`)).join("\r\n")+"\r\n\r\n"+n)}function m(e,t,n,s,i){if(e.listenerCount("wsClientError")){const s=new Error(i);Error.captureStackTrace(s,m),e.emit("wsClientError",s,n,t)}else g(n,s,i)}e.exports=class extends s{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:u,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer(((e,t)=>{const n=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,n,s)=>{this.handleUpgrade(t,n,s,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(f,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(f,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{f(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,s){t.on("error",b);const i=e.headers["sec-websocket-key"],r=e.headers.upgrade,o=+e.headers["sec-websocket-version"];if("GET"!==e.method)return void m(this,e,t,405,"Invalid HTTP method");if(void 0===r||"websocket"!==r.toLowerCase())return void m(this,e,t,400,"Invalid Upgrade header");if(void 0===i||!p.test(i))return void m(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");if(8!==o&&13!==o)return void m(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");if(!this.shouldHandle(e))return void g(t,400);const u=e.headers["sec-websocket-protocol"];let d=new Set;if(void 0!==u)try{d=l.parse(u)}catch(n){return void m(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}const h=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==h){const n=new c(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const e=a.parse(h);e[c.extensionName]&&(n.accept(e[c.extensionName]),f[c.extensionName]=n)}catch(n){return void m(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){const r={origin:e.headers[8===o?"sec-websocket-origin":"origin"],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(r,((r,o,a,c)=>{if(!r)return g(t,o||401,a,c);this.completeUpgrade(f,i,d,e,t,n,s)}));if(!this.options.verifyClient(r))return g(t,401)}this.completeUpgrade(f,i,d,e,t,n,s)}completeUpgrade(e,t,n,s,i,r,l){if(!i.readable||!i.writable)return i.destroy();if(i[h])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return g(i,503);const u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${o("sha1").update(t+d).digest("base64")}`],p=new this.options.WebSocket(null,void 0,this.options);if(n.size){const e=this.options.handleProtocols?this.options.handleProtocols(n,s):n.values().next().value;e&&(u.push(`Sec-WebSocket-Protocol: ${e}`),p._protocol=e)}if(e[c.extensionName]){const t=e[c.extensionName].params,n=a.format({[c.extensionName]:[t]});u.push(`Sec-WebSocket-Extensions: ${n}`),p._extensions=e}this.emit("headers",u,s),i.write(u.concat("\r\n").join("\r\n")),i.removeListener("error",b),p.setSocket(i,r,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(p),p.on("close",(()=>{this.clients.delete(p),this._shouldEmitClose&&!this.clients.size&&process.nextTick(f,this)}))),l(p,s)}}},1060:(e,t,n)=>{"use strict";const s=n(4434),i=n(5692),r=n(8611),o=n(9278),a=n(4756),{randomBytes:c,createHash:l}=n(6982),{Duplex:u,Readable:d}=n(2203),{URL:h}=n(7016),p=n(2971),f=n(6286),b=n(914),{BINARY_TYPES:g,EMPTY_BUFFER:m,GUID:y,kForOnEventAttribute:v,kListener:_,kStatusCode:x,kWebSocket:S,NOOP:k}=n(2614),{EventTarget:{addEventListener:I,removeEventListener:w}}=n(597),{format:E,parse:O}=n(5926),{toBuffer:C}=n(3338),T=Symbol("kAborted"),P=[8,13],N=["CONNECTING","OPEN","CLOSING","CLOSED"],R=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class A extends s{constructor(e,t,n){super(),this._binaryType=g[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=m,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=A.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(n=t,t=[]):t=[t]),M(this,e,t,n)):(this._autoPong=n.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){g.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){const s=new f({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new b(e,this._extensions,n.generateMask),this._receiver=s,this._socket=e,s[S]=this,e[S]=this,s.on("conclude",F),s.on("drain",$),s.on("error",U),s.on("message",q),s.on("ping",G),s.on("pong",W),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Y),e.on("data",J),e.on("end",K),e.on("error",Q),this._readyState=A.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=A.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[p.extensionName]&&this._extensions[p.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=A.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==A.CLOSED)if(this.readyState!==A.CONNECTING)this.readyState!==A.CLOSING?(this._readyState=A.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";V(this,this._req,e)}}pause(){this.readyState!==A.CONNECTING&&this.readyState!==A.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===A.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===A.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||m,t,n)):j(this,e,n)}pong(e,t,n){if(this.readyState===A.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===A.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||m,t,n)):j(this,e,n)}resume(){this.readyState!==A.CONNECTING&&this.readyState!==A.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===A.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(n=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==A.OPEN)return void j(this,e,n);const s={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[p.extensionName]||(s.compress=!1),this._sender.send(e||m,s,n)}terminate(){if(this.readyState!==A.CLOSED)if(this.readyState!==A.CONNECTING)this._socket&&(this._readyState=A.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";V(this,this._req,e)}}}function M(e,t,n,s){const o={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:P[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...s,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(e._autoPong=o.autoPong,!P.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${P.join(", ")})`);let a;if(t instanceof h)a=t;else try{a=new h(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),e._url=a.href;const u="wss:"===a.protocol,d="ws+unix:"===a.protocol;let f;if("ws:"===a.protocol||u||d?d&&!a.pathname?f="The URL's pathname is empty":a.hash&&(f="The URL contains a fragment identifier"):f='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',f){const t=new SyntaxError(f);if(0===e._redirects)throw t;return void L(e,t)}const b=u?443:80,g=c(16).toString("base64"),m=u?i.request:r.request,v=new Set;let _,x;if(o.createConnection=o.createConnection||(u?B:D),o.defaultPort=o.defaultPort||b,o.port=a.port||b,o.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":g,Connection:"Upgrade",Upgrade:"websocket"},o.path=a.pathname+a.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(_=new p(!0!==o.perMessageDeflate?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=E({[p.extensionName]:_.offer()})),n.length){for(const e of n){if("string"!=typeof e||!R.test(e)||v.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");v.add(e)}o.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(a.username||a.password)&&(o.auth=`${a.username}:${a.password}`),d){const e=o.path.split(":");o.socketPath=e[0],o.path=e[1]}if(o.followRedirects){if(0===e._redirects){e._originalIpc=d,e._originalSecure=u,e._originalHostOrSocketPath=d?o.socketPath:a.host;const t=s&&s.headers;if(s={...s,headers:{}},t)for(const[e,n]of Object.entries(t))s.headers[e.toLowerCase()]=n}else if(0===e.listenerCount("redirect")){const t=d?!!e._originalIpc&&o.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&a.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!u)&&(delete o.headers.authorization,delete o.headers.cookie,t||delete o.headers.host,o.auth=void 0)}o.auth&&!s.headers.authorization&&(s.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")),x=e._req=m(o),e._redirects&&e.emit("redirect",e.url,x)}else x=e._req=m(o);o.timeout&&x.on("timeout",(()=>{V(e,x,"Opening handshake has timed out")})),x.on("error",(t=>{null===x||x[T]||(x=e._req=null,L(e,t))})),x.on("response",(i=>{const r=i.headers.location,a=i.statusCode;if(r&&o.followRedirects&&a>=300&&a<400){if(++e._redirects>o.maxRedirects)return void V(e,x,"Maximum redirects exceeded");let i;x.abort();try{i=new h(r,t)}catch(t){const n=new SyntaxError(`Invalid URL: ${r}`);return void L(e,n)}M(e,i,n,s)}else e.emit("unexpected-response",x,i)||V(e,x,`Unexpected server response: ${i.statusCode}`)})),x.on("upgrade",((t,n,s)=>{if(e.emit("upgrade",t),e.readyState!==A.CONNECTING)return;x=e._req=null;const i=t.headers.upgrade;if(void 0===i||"websocket"!==i.toLowerCase())return void V(e,n,"Invalid Upgrade header");const r=l("sha1").update(g+y).digest("base64");if(t.headers["sec-websocket-accept"]!==r)return void V(e,n,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"];let c;if(void 0!==a?v.size?v.has(a)||(c="Server sent an invalid subprotocol"):c="Server sent a subprotocol but none was requested":v.size&&(c="Server sent no subprotocol"),c)return void V(e,n,c);a&&(e._protocol=a);const u=t.headers["sec-websocket-extensions"];if(void 0!==u){if(!_)return void V(e,n,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");let t;try{t=O(u)}catch(t){return void V(e,n,"Invalid Sec-WebSocket-Extensions header")}const s=Object.keys(t);if(1!==s.length||s[0]!==p.extensionName)return void V(e,n,"Server indicated an extension that was not requested");try{_.accept(t[p.extensionName])}catch(t){return void V(e,n,"Invalid Sec-WebSocket-Extensions header")}e._extensions[p.extensionName]=_}e.setSocket(n,s,{allowSynchronousEvents:o.allowSynchronousEvents,generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})})),o.finishRequest?o.finishRequest(x,e):x.end()}function L(e,t){e._readyState=A.CLOSING,e.emit("error",t),e.emitClose()}function D(e){return e.path=e.socketPath,o.connect(e)}function B(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=o.isIP(e.host)?"":e.host),a.connect(e)}function V(e,t,n){e._readyState=A.CLOSING;const s=new Error(n);Error.captureStackTrace(s,V),t.setHeader?(t[T]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(L,e,s)):(t.destroy(s),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function j(e,t,n){if(t){const n=C(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}if(n){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${N[e.readyState]})`);process.nextTick(n,t)}}function F(e,t){const n=this[S];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,void 0!==n._socket[S]&&(n._socket.removeListener("data",J),process.nextTick(z,n._socket),1005===e?n.close():n.close(e,t))}function $(){const e=this[S];e.isPaused||e._socket.resume()}function U(e){const t=this[S];void 0!==t._socket[S]&&(t._socket.removeListener("data",J),process.nextTick(z,t._socket),t.close(e[x])),t.emit("error",e)}function H(){this[S].emitClose()}function q(e,t){this[S].emit("message",e,t)}function G(e){const t=this[S];t._autoPong&&t.pong(e,!this._isServer,k),t.emit("ping",e)}function W(e){this[S].emit("pong",e)}function z(e){e.resume()}function Y(){const e=this[S];let t;this.removeListener("close",Y),this.removeListener("data",J),this.removeListener("end",K),e._readyState=A.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[S]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",H),e._receiver.on("finish",H))}function J(e){this[S]._receiver.write(e)||this.pause()}function K(){const e=this[S];e._readyState=A.CLOSING,e._receiver.end(),this.end()}function Q(){const e=this[S];this.removeListener("error",Q),this.on("error",k),e&&(e._readyState=A.CLOSING,this.destroy())}Object.defineProperty(A,"CONNECTING",{enumerable:!0,value:N.indexOf("CONNECTING")}),Object.defineProperty(A.prototype,"CONNECTING",{enumerable:!0,value:N.indexOf("CONNECTING")}),Object.defineProperty(A,"OPEN",{enumerable:!0,value:N.indexOf("OPEN")}),Object.defineProperty(A.prototype,"OPEN",{enumerable:!0,value:N.indexOf("OPEN")}),Object.defineProperty(A,"CLOSING",{enumerable:!0,value:N.indexOf("CLOSING")}),Object.defineProperty(A.prototype,"CLOSING",{enumerable:!0,value:N.indexOf("CLOSING")}),Object.defineProperty(A,"CLOSED",{enumerable:!0,value:N.indexOf("CLOSED")}),Object.defineProperty(A.prototype,"CLOSED",{enumerable:!0,value:N.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(A.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(A.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[v])return t[_];return null},set(t){for(const t of this.listeners(e))if(t[v]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[v]:!0})}})})),A.prototype.addEventListener=I,A.prototype.removeEventListener=w,e.exports=A},5480:(e,t,n)=>{var s=n(9896),i=n(7016),r=n(5317).spawn;function o(e){"use strict";e=e||{};var t,o,a=this,c=n(8611),l=n(5692),u={},d=!1,h={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},p=Object.assign({},h),f=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],b=["TRACE","TRACK","CONNECT"],g=!1,m=!1,y=!1,v={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.open=function(e,t,n,s,i){if(this.abort(),m=!1,y=!1,!function(e){return e&&-1===b.indexOf(e)}(e))throw new Error("SecurityError: Request method not allowed");u={method:e,url:t.toString(),async:"boolean"!=typeof n||n,user:s||null,password:i||null},_(this.OPENED)},this.setDisableHeaderCheck=function(e){d=e},this.setRequestHeader=function(e,t){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!function(e){return d||e&&-1===f.indexOf(e.toLowerCase())}(e))return console.warn('Refused to set unsafe header "'+e+'"'),!1;if(g)throw new Error("INVALID_STATE_ERR: send flag is true");return p[e]=t,!0},this.getResponseHeader=function(e){return"string"==typeof e&&this.readyState>this.OPENED&&o.headers[e.toLowerCase()]&&!m?o.headers[e.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||m)return"";var e="";for(var t in o.headers)"set-cookie"!==t&&"set-cookie2"!==t&&(e+=t+": "+o.headers[t]+"\r\n");return e.substr(0,e.length-2)},this.getRequestHeader=function(e){return"string"==typeof e&&p[e]?p[e]:""},this.send=function(n){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(g)throw new Error("INVALID_STATE_ERR: send has already been called");var d,h=!1,f=!1,b=i.parse(u.url);switch(b.protocol){case"https:":h=!0;case"http:":d=b.hostname;break;case"file:":f=!0;break;case void 0:case"":d="localhost";break;default:throw new Error("Protocol not supported.")}if(f){if("GET"!==u.method)throw new Error("XMLHttpRequest: Only GET method is supported");if(u.async)s.readFile(unescape(b.pathname),"utf8",(function(e,t){e?a.handleError(e,e.errno||-1):(a.status=200,a.responseText=t,_(a.DONE))}));else try{this.responseText=s.readFileSync(unescape(b.pathname),"utf8"),this.status=200,_(a.DONE)}catch(e){this.handleError(e,e.errno||-1)}}else{var y=b.port||(h?443:80),v=b.pathname+(b.search?b.search:"");if(p.Host=d,h&&443===y||80===y||(p.Host+=":"+b.port),u.user){void 0===u.password&&(u.password="");var x=new Buffer(u.user+":"+u.password);p.Authorization="Basic "+x.toString("base64")}"GET"===u.method||"HEAD"===u.method?n=null:n?(p["Content-Length"]=Buffer.isBuffer(n)?n.length:Buffer.byteLength(n),p["Content-Type"]||(p["Content-Type"]="text/plain;charset=UTF-8")):"POST"===u.method&&(p["Content-Length"]=0);var S=e.agent||!1,k={host:d,port:y,path:v,method:u.method,headers:p,agent:S};if(h&&(k.pfx=e.pfx,k.key=e.key,k.passphrase=e.passphrase,k.cert=e.cert,k.ca=e.ca,k.ciphers=e.ciphers,k.rejectUnauthorized=!1!==e.rejectUnauthorized),m=!1,u.async){var I=h?l.request:c.request;g=!0,a.dispatchEvent("readystatechange");var w=function(n){if(302===(o=n).statusCode||303===o.statusCode||307===o.statusCode){u.url=o.headers.location;var s=i.parse(u.url);d=s.hostname;var r={hostname:s.hostname,port:s.port,path:s.path,method:303===o.statusCode?"GET":u.method,headers:p};return h&&(r.pfx=e.pfx,r.key=e.key,r.passphrase=e.passphrase,r.cert=e.cert,r.ca=e.ca,r.ciphers=e.ciphers,r.rejectUnauthorized=!1!==e.rejectUnauthorized),void(t=I(r,w).on("error",E)).end()}o&&o.setEncoding&&o.setEncoding("utf8"),_(a.HEADERS_RECEIVED),a.status=o.statusCode,o.on("data",(function(e){e&&(a.responseText+=e),g&&_(a.LOADING)})),o.on("end",(function(){g&&(g=!1,_(a.DONE))})),o.on("error",(function(e){a.handleError(e)}))},E=function(e){a.handleError(e)};t=I(k,w).on("error",E),e.autoUnref&&t.on("socket",(e=>{e.unref()})),n&&t.write(n),t.end(),a.dispatchEvent("loadstart")}else{var O=".node-xmlhttprequest-content-"+process.pid,C=".node-xmlhttprequest-sync-"+process.pid;s.writeFileSync(C,"","utf8");for(var T="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(h?"s":"")+".request;var options = "+JSON.stringify(k)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+O+"', 'NODE-XMLHTTPREQUEST-STATUS:' + response.statusCode + ',' + responseText, 'utf8');fs.unlinkSync('"+C+"');});response.on('error', function(error) {fs.writeFileSync('"+O+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+C+"');});}).on('error', function(error) {fs.writeFileSync('"+O+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+C+"');});"+(n?"req.write('"+JSON.stringify(n).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",P=r(process.argv[0],["-e",T]);s.existsSync(C););if(a.responseText=s.readFileSync(O,"utf8"),P.stdin.end(),s.unlinkSync(O),a.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var N=a.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,"");a.handleError(N,503)}else a.status=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1"),a.responseText=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"),_(a.DONE)}}},this.handleError=function(e,t){this.status=t||0,this.statusText=e,this.responseText=e.stack,m=!0,_(this.DONE)},this.abort=function(){t&&(t.abort(),t=null),p=Object.assign({},h),this.responseText="",this.responseXML="",m=y=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!g||this.readyState===this.DONE||(g=!1,_(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(e,t){e in v||(v[e]=[]),v[e].push(t)},this.removeEventListener=function(e,t){e in v&&(v[e]=v[e].filter((function(e){return e!==t})))},this.dispatchEvent=function(e){if("function"==typeof a["on"+e]&&(this.readyState===this.DONE?setImmediate((function(){a["on"+e]()})):a["on"+e]()),e in v)for(let t=0,n=v[e].length;t<n;t++)this.readyState===this.DONE?setImmediate((function(){v[e][t].call(a)})):v[e][t].call(a)};var _=function(e){if(!(a.readyState===e||a.readyState===a.UNSENT&&y)&&(a.readyState=e,(u.async||a.readyState<a.OPENED||a.readyState===a.DONE)&&a.dispatchEvent("readystatechange"),a.readyState===a.DONE)){let e;e=y?"abort":m?"error":"load",a.dispatchEvent(e),a.dispatchEvent("loadend")}}}e.exports=o,o.XMLHttpRequest=o},9367:e=>{e.exports={initActions:function(){let e=this,t={};e.config.useAsSurface&&(e.config.hapticWhenPressed&&(t.enableHapticFeedback={name:"Surface Settings - Enable/Disable Haptic Feedback",options:[{type:"dropdown",label:"Enable Haptic Feedback",id:"enable",default:"On",choices:[{id:"On",label:"On"},{id:"Off",label:"Off"}]}],callback:async t=>{e.config.hapticWhenPressed="On"==t.options.enable,e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setHapticFeedback={name:"Surface Settings - Set Haptic Properties per Button",description:"Change the haptic feedback settings for a specific button on the controller.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"checkbox",label:"Enable Haptic Feedback",id:"enable",default:!0},{type:"dropdown",label:"Haptic Feedback Type",id:"type",default:e.CHOICES_HAPTIC_TYPES[0].id,choices:e.CHOICES_HAPTIC_TYPES},{type:"textinput",label:"Haptic Feedback Duration (in ms)",id:"duration",default:"500",useVariables:!0},{type:"textinput",label:"Haptic Feedback Start Delay (in ms)",id:"startDelay",default:"0",useVariables:!0},{type:"textinput",label:"Haptic Feedback Strong Magnitude (0.0-1.0)",id:"strongMagnitude",default:"0.5",useVariables:!0},{type:"textinput",label:"Haptic Feedback Weak Magnitude (0.0-1.0)",id:"weakMagnitude",default:"0.5",useVariables:!0},{type:"textinput",label:"Haptic Feedback Left Trigger (0.0-1.0)",id:"leftTrigger",default:"0.5",useVariables:!0,isVisible:e=>"trigger-rumble"==e.type},{type:"textinput",label:"Haptic Feedback Right Trigger (0.0-1.0)",id:"rightTrigger",default:"0.5",useVariables:!0,isVisible:e=>"trigger-rumble"==e.type}],callback:async t=>{let n=parseInt(t.options.button);if(t.options.enable){let n=t.options.type,s=await e.parseVariablesInString(t.options.duration),i=await e.parseVariablesInString(t.options.startDelay),r=await e.parseVariablesInString(t.options.strongMagnitude),o=await e.parseVariablesInString(t.options.weakMagnitude),a=await e.parseVariablesInString(t.options.leftTrigger),c=await e.parseVariablesInString(t.options.rightTrigger);s=parseInt(s),(s<0||isNaN(s))&&(s=0),i=parseInt(i),(i<0||isNaN(i))&&(i=0),r=parseFloat(r),(r<0||r>1||isNaN(r))&&(r=.5),o=parseFloat(o),(o<0||o>1||isNaN(o))&&(o=.5),a=parseFloat(a),(a<0||a>1||isNaN(a))&&(a=.5),c=parseFloat(c),(c<0||c>1||isNaN(c))&&(c=.5);let l={duration:s,startDelay:i,strongMagnitude:r,weakMagnitude:o};"trigger-rumble"==n&&(l.leftTrigger=a,l.rightTrigger=c)}else type="none",params={};let s=e.MAPPING?.buttons.find((e=>e.buttonIndex===n));s&&(s.hapticType=type,s.hapticParams=params),s||e.MAPPING?.buttons.push({buttonIndex:n,hapticType:type,hapticParams:params}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}}),t.setButtonPressThreshold={name:"Surface Settings - Set Button Press Threshold",description:"Change the percentage of variance in the button that must be met to trigger a button *PRESS*.",options:[{type:"textinput",label:"Button Press Threshold (%)",id:"threshold",default:"50",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.threshold);n.includes("%")&&(n=n.replace("%","")),n=parseInt(n),isNaN(n)&&(n=100),e.config.buttonPressThreshold=Math.abs(n),e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setButtonReleaseThreshold={name:"Surface Settings - Set Button Release Threshold",description:"Change the percentage of variance in the button that must be met to trigger a button *RELEASE*.",options:[{type:"textinput",label:"Button Release Threshold (%)",id:"threshold",default:"50",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.threshold);n.includes("%")&&(n=n.replace("%","")),n=parseInt(n),isNaN(n)&&(n=0),e.config.buttonReleaseThreshold=Math.abs(n),e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.buttonType={name:"Surface Settings - Set Button Type",description:"Change the button type for a specific button on the controller.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"dropdown",label:"Button Type",id:"type",default:"button",choices:[{id:"button",label:"Button"},{id:"trigger",label:"Trigger"}]}],callback:async t=>{let n=parseInt(t.options.button),s=t.options.type,i=e.MAPPING?.buttons.find((e=>e.buttonIndex===n));i&&(i.buttonType=s),i||e.MAPPING?.buttons.push({buttonIndex:n,buttonType:s}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setButtonDebounceByButton={name:"Surface Settings - Set Button Debounce (By Button)",description:"Change the amount of time in milliseconds that must pass before another press of the same button can be registered again.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"textinput",label:"Button Debounce (in ms)",id:"debounce",default:"50",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.debounce);n=parseInt(n),(n<0||isNaN(n))&&(n=0);let s=e.MAPPING?.buttons.find((e=>e.buttonIndex===button));s&&(s.debounce=n),s||e.MAPPING?.buttons.push({buttonIndex:button,debounce:n}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setButtonDebounce={name:"Surface Settings - Set Button Debounce (Global)",description:"Change the amount of time in milliseconds that must pass before another press of the same button can be registered again.",options:[{type:"textinput",label:"Button Debounce (in ms)",id:"debounce",default:"50",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.debounce);n=parseInt(n),(n<0||isNaN(n))&&(n=0),e.config.buttonDebounce=n,e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setAxisDeadzones={name:"Surface Settings - Set Axis Deadzones",description:"Change the range of the joystick/axis movement that is ignored.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"textinput",label:"Axis Deadzone Negative (Negative Value between -1 and 0)",id:"deadzone_neg",default:"0",useVariables:!0},{type:"textinput",label:"Axis Deadzone Positive (Positive Value between 0 and 1)",id:"deadzone_pos",default:"0",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.deadzone_neg),s=await e.parseVariablesInString(t.options.deadzone_pos);n=-1*parseFloat(n),s=parseFloat(s),isNaN(n)&&(n=0),isNaN(s)&&(s=0);let i=parseInt(t.options.axis),r=e.MAPPING?.axes.find((e=>e.axisIndex===i));r&&(r.axisNegDeadzone=n,r.axisPosDeadzone=s),r||e.MAPPING?.axes.push({axisIndex:i,axisNegDeadzone:n,axisPosDeadzone:s}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setAxisMovementAsButtonPress={name:"Surface Settings - Set Axis Movement as Button Press",description:"Allow axis movement can be interpreted as a surface button press.",options:[{type:"dropdown",label:"Use Axis Movement as Button Press",id:"movement",default:"Off",choices:[{id:"Off",label:"Off"},{id:"On",label:"On"}]}],callback:async t=>{e.config.axisMovementAsButtonPress="On"==t.options.movement,e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setAxisMovementPressThreshold={name:"Surface Settings - Set Axis Movement Press Threshold",description:"Change the percentage of variance in the axis in order for a button to be *PRESSED* or *RELEASED*.",options:[{type:"textinput",label:"Axis Movement Press Threshold (%)",id:"threshold",default:"5",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.threshold);n.includes("%")&&(n=n.replace("%","")),n=parseInt(n),isNaN(n)&&(n=100),e.config.axisMovementThreshold=Math.abs(n),e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setAxisHaptic={name:"Surface Settings - Set Axis Haptic Properties Per Axis",description:"Change the haptic feedback settings for a specific axis on the controller.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"checkbox",label:"Enable Haptic Feedback",id:"enable",default:!0},{type:"dropdown",label:"Haptic Feedback Type",id:"type",default:e.CHOICES_HAPTIC_TYPES[0].id,choices:e.CHOICES_HAPTIC_TYPES},{type:"textinput",label:"Haptic Feedback Duration (in ms)",id:"duration",default:"500",useVariables:!0},{type:"textinput",label:"Haptic Feedback Start Delay (in ms)",id:"startDelay",default:"0",useVariables:!0},{type:"textinput",label:"Haptic Feedback Strong Magnitude (0.0-1.0)",id:"strongMagnitude",default:"0.5",useVariables:!0},{type:"textinput",label:"Haptic Feedback Weak Magnitude (0.0-1.0)",id:"weakMagnitude",default:"0.5",useVariables:!0},{type:"textinput",label:"Haptic Feedback Left Trigger (0.0-1.0)",id:"leftTrigger",default:"0.5",useVariables:!0,isVisible:e=>"trigger-rumble"==e.type},{type:"textinput",label:"Haptic Feedback Right Trigger (0.0-1.0)",id:"rightTrigger",default:"0.5",useVariables:!0,isVisible:e=>"trigger-rumble"==e.type}],callback:async t=>{let n=parseInt(t.options.axis);if(t.options.enable){let n=t.options.type,s=await e.parseVariablesInString(t.options.duration),i=await e.parseVariablesInString(t.options.startDelay),r=await e.parseVariablesInString(t.options.strongMagnitude),o=await e.parseVariablesInString(t.options.weakMagnitude),a=await e.parseVariablesInString(t.options.leftTrigger),c=await e.parseVariablesInString(t.options.rightTrigger);s=parseInt(s),(s<0||isNaN(s))&&(s=0),i=parseInt(i),(i<0||isNaN(i))&&(i=0),r=parseFloat(r),(r<0||r>1||isNaN(r))&&(r=.5),o=parseFloat(o),(o<0||o>1||isNaN(o))&&(o=.5),a=parseFloat(a),(a<0||a>1||isNaN(a))&&(a=.5),c=parseFloat(c),(c<0||c>1||isNaN(c))&&(c=.5);let l={duration:s,startDelay:i,strongMagnitude:r,weakMagnitude:o};"trigger-rumble"==n&&(l.leftTrigger=a,l.rightTrigger=c)}else type="none",params={};let s=e.MAPPING?.axes.find((e=>e.axisIndex===n));s&&(s.hapticType=type,s.hapticParams=params),s||e.MAPPING?.axes.push({axisIndex:n,hapticType:type,hapticParams:params}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}}),t.invertButtonPress={name:"Button Settings - Invert Button Press",description:"Invert the button press behavior for a specific button on the controller.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"dropdown",label:"Invert Button Press",id:"invert",default:"Off",choices:[{id:"Off",label:"Off"},{id:"On",label:"On"}]},{type:"checkbox",label:"Invert Affects Button Press Percentage",description:"If enabled, the button press percentage will be inverted as well, which will affect how the surface behaves. If disabled, only the display value will be affected.",id:"invertPercentage",default:!1,isVisible:e=>"On"==e.invert}],callback:async t=>{e.CONTROLLER.uuid;let n=parseInt(t.options.button),s="On"==t.options.invert,i=t.options.invertPercentage,r=!0,o=e.MAPPING?.buttons.find((e=>e.buttonIndex===n));o&&(o.buttonInverted==s&&(r=!1),o.buttonInverted=s,o.invertPercentage=i),o||e.MAPPING?.buttons.push({buttonIndex:n,buttonInverted:s,invertPercentage:i});let a=n,c=(e.CONTROLLER.buttons[a].pressed,e.CONTROLLER.buttons[a].touched,e.CONTROLLER.buttons[a].val),l=e.CONTROLLER.buttons[a].pct;r&&(c=1-c,l=100-l),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.invertButtonPressToggle={name:"Button Settings - Invert Button Press (Toggle)",description:"Toggle the button press behavior for a specific button on the controller.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS}],callback:async t=>{e.CONTROLLER.uuid;let n=parseInt(t.options.button),s=e.MAPPING?.buttons.find((e=>e.buttonIndex===n));s&&(s.buttonInverted=!s.buttonInverted||!1),s||e.MAPPING?.buttons.push({buttonIndex:n,buttonInverted:!1,invertPercentage:!1});let i=n,r=(e.CONTROLLER.buttons[i].pressed,e.CONTROLLER.buttons[i].touched,e.CONTROLLER.buttons[i].val),o=e.CONTROLLER.buttons[i].pct;r=1-r,o=100-o,e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setButtonRangeDisplay={name:"Button Settings - Set Button Range Display",description:"Change the display range of the minimum and maximum values of the button.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"textinput",label:"Button Range Display Min",id:"range_min",default:"0",useVariables:!0},{type:"textinput",label:"Button Range Display Max",id:"range_max",default:"100",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.range_min),s=await e.parseVariablesInString(t.options.range_max);if(n=parseInt(n),s=parseInt(s),(isNaN(n)||isNaN(s))&&(n=0,s=100),n>s){let e=n;n=s,s=e}let i=parseInt(t.options.button);e.config.verbose&&e.log("info",`Setting Button Range Display for ${i} to ${n} - ${s}`),console.log("self.MAPPING",e.MAPPING);let r=e.MAPPING.buttons.find((e=>e.buttonIndex===i));console.log("buttonObj",r),r&&(r.buttonRangeMin=n,r.buttonRangeMax=s),r||(console.log("no buttonObj, creating one"),e.MAPPING.buttons.push({buttonIndex:i,buttonRangeMin:n,buttonRangeMax:s})),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setAxisRangeDisplay={name:"Axis - Set Axis Range Display",description:"Change the display range of the minimum and maximum values of the axes.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"textinput",label:"Axis Range Display Min",id:"range_min",default:"0",useVariables:!0},{type:"textinput",label:"Axis Range Display Max",id:"range_max",default:"100",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.range_min),s=await e.parseVariablesInString(t.options.range_max);if(n=parseInt(n),s=parseInt(s),(isNaN(n)||isNaN(s))&&(n=0,s=100),n>s){let e=n;n=s,s=e}let i=parseInt(t.options.axis);e.config.verbose&&e.log("info",`Setting Axis Range Display for ${i} to ${n} - ${s}`);let r=e.MAPPING?.axes.find((e=>e.axisIndex===i));r&&(r.axisRangeMin=n,r.axisRangeMax=s),r||e.MAPPING?.axes.push({axisIndex:i,axisRangeMin:n,axisRangeMax:s}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setAxisType={name:"Controller - Set Axis Type",description:"Used to tell the module whether this is an X or Y axis, which informs the variable outputs.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"dropdown",label:"Axis Type",id:"type",default:"x",choices:[{id:"x",label:"X Axis"},{id:"y",label:"Y Axis"}]}],callback:async t=>{let n=parseInt(t.options.axis),s=t.options.type,i=e.MAPPING?.axes.find((e=>e.axisIndex===n));i&&(i.axisType=s),i||e.MAPPING?.axes.push({axisIndex:n,axisType:s}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.axisInvert={name:"Axis - Invert Axis",description:"Used to invert a specific axis so that negative movement becomes positive, etc.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"dropdown",label:"Invert Axis",id:"invert",default:"Off",choices:[{id:"Off",label:"Off"},{id:"On",label:"On"}]},{type:"checkbox",label:"Invert Affects Axis Press Percentage",description:"If enabled, the axis press percentage will be inverted as well, which will affect how the surface behaves. If disabled, only the display value will be affected.",id:"invertPercentage",default:!1,isVisible:e=>"On"==e.invert}],callback:async t=>{let n=parseInt(t.options.axis),s="On"==t.options.invert,i=t.options.invertPercentage,r=e.MAPPING?.axes.find((e=>e.axisIndex===n));r&&(r.axisInverted=s,r.invertPercentage=s),r||e.MAPPING?.axes.push({axisIndex:n,axisInverted:s,invertPercentage:i}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.axisInvertToggle={name:"Axis - Invert Axis (Toggle)",description:"Toggle the axis inversion for a specific axis on the controller.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES}],callback:async t=>{let n=parseInt(t.options.axis),s=e.MAPPING?.axes.find((e=>e.axisIndex===n));s&&(s.axisInverted=!s.axisInverted||!1,s.invertPercentage=!0),s||e.MAPPING?.axes.push({axisIndex:n,axisInverted:!1,invertPercentage:!1}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.controllerLock={name:"Controller - Lock/Unlock Controller",description:"Locks the controller so that no further input is accepted.",options:[{type:"dropdown",label:"Lock Controller",id:"lock",default:"Lock",choices:[{id:"Lock",label:"Lock"},{id:"Unlock",label:"Unlock"}]}],callback:async t=>{let n="Lock"==t.options.lock;n?e.log("info","Controller is now locked. No further input will be accepted."):e.log("info","Controller is now unlocked. Input will be accepted."),e.LOCKED=n,e.checkFeedbacks("controllerLocked"),e.setVariableValues({controller_locked:e.LOCKED?"Locked":"Unlocked"})}},t.sendHaptic={name:"Controller - Send Haptic Feedback Now",description:"Sends a Haptic Feedback command (with type, intensity and duration) to the Controller.",options:[{type:"dropdown",label:"Haptic Feedback Type",id:"type",default:e.CHOICES_HAPTIC_TYPES[0].id,choices:e.CHOICES_HAPTIC_TYPES},{type:"textinput",label:"Haptic Feedback Duration (in ms)",id:"duration",default:"500",useVariables:!0},{type:"textinput",label:"Haptic Feedback Start Delay (in ms)",id:"startDelay",default:"0",useVariables:!0},{type:"textinput",label:"Haptic Feedback Strong Magnitude (0.0-1.0)",id:"strongMagnitude",default:"0.5",useVariables:!0},{type:"textinput",label:"Haptic Feedback Weak Magnitude (0.0-1.0)",id:"weakMagnitude",default:"0.5",useVariables:!0},{type:"textinput",label:"Haptic Feedback Left Trigger (0.0-1.0)",id:"leftTrigger",default:"0.5",useVariables:!0,isVisible:e=>"trigger-rumble"==e.type},{type:"textinput",label:"Haptic Feedback Right Trigger (0.0-1.0)",id:"rightTrigger",default:"0.5",useVariables:!0,isVisible:e=>"trigger-rumble"==e.type}],callback:async t=>{let n=t.options.type,s=await e.parseVariablesInString(t.options.duration),i=await e.parseVariablesInString(t.options.startDelay),r=await e.parseVariablesInString(t.options.strongMagnitude),o=await e.parseVariablesInString(t.options.weakMagnitude),a=await e.parseVariablesInString(t.options.leftTrigger),c=await e.parseVariablesInString(t.options.rightTrigger);s=parseInt(s),(s<0||isNaN(s))&&(s=0),i=parseInt(i),(i<0||isNaN(i))&&(i=0),r=parseFloat(r),(r<0||r>1||isNaN(r))&&(r=.5),o=parseFloat(o),(o<0||o>1||isNaN(o))&&(o=.5),a=parseFloat(a),(a<0||a>1||isNaN(a))&&(a=.5),c=parseFloat(c),(c<0||c>1||isNaN(c))&&(c=.5);let l={duration:s,startDelay:i,strongMagnitude:r,weakMagnitude:o};"trigger-rumble"==n&&(l.leftTrigger=a,l.rightTrigger=c),e.socket.emit("haptic",e.CONTROLLER.uuid,n,l)}},t.setButtonMapping={name:"Controller - Set Button Mapping",description:"Change the button name and id for a specific button on the controller.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"textinput",label:"Button Name",id:"name",default:"Button 1",useVariables:!0},{type:"textinput",label:"Button ID",id:"id",default:"btn1",useVariables:!0}],callback:async t=>{let n=parseInt(t.options.button),s=await e.parseVariablesInString(t.options.name),i=await e.parseVariablesInString(t.options.id),r=e.MAPPING?.buttons.find((e=>e.buttonIndex===n));r&&(r.buttonName=s,r.buttonId=i),r||e.MAPPING?.buttons.push({buttonIndex:n,buttonName:s,buttonId:i}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setAxisMapping={name:"Controller - Set Axis Mapping",description:"Change the axis name and id for a specific axis on the controller.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"textinput",label:"Axis Name",id:"name",default:"Axis 1",useVariables:!0},{type:"textinput",label:"Axis ID",id:"id",default:"axis1",useVariables:!0}],callback:async t=>{let n=parseInt(t.options.axis),s=await e.parseVariablesInString(t.options.name),i=await e.parseVariablesInString(t.options.id),r=e.MAPPING?.axes.find((e=>e.axisIndex===n));r&&(r.axisName=s,r.axisId=i),r||e.MAPPING?.axes.push({axisIndex:n,axisName:s,axisId:i}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.onDisconnectButton={name:"Other Settings - Button Behavior On Disconnect",description:"Change the behavior of the specific button when the controller is disconnected.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"dropdown",label:"On Disconnect",id:"disconnect",default:"hold",choices:[{id:"reset",label:"Reset Value to 0"},{id:"hold",label:"Hold Last Values"},{id:"custom",label:"Custom Value"}]},{type:"textinput",label:"Custom Value",id:"customValue",default:"0",useVariables:!0,isVisible:e=>"custom"==e.disconnect},{type:"dropdown",label:"Button on Surface Behavior",id:"buttonBehavior",default:"pressed",choices:[{id:"pressed",label:"Be Pressed"},{id:"released",label:"Be Released"}]}],callback:async t=>{let n=parseInt(t.options.button),s=t.options.disconnect,i=await e.parseVariablesInString(t.options.customValue),r=t.options.buttonBehavior,o=e.MAPPING?.buttons.find((e=>e.buttonIndex===n));o&&(o.disconnectBehavior=s,o.disconnectCustomValue=i,o.buttonBehavior=r),o||e.MAPPING?.buttons.push({buttonIndex:n,disconnectBehavior:s,disconnectCustomValue:i,buttonBehavior:r}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.onDisconnectAxis={name:"Other Settings - Axis Behavior On Disconnect",description:"Change the behavior of the specific axis when the controller is disconnected.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"dropdown",label:"On Disconnect",id:"disconnect",default:"hold",choices:[{id:"reset",label:"Reset Value to 0"},{id:"hold",label:"Hold Last Values"},{id:"custom",label:"Custom Value"}]},{type:"textinput",label:"Custom Value",id:"customValue",default:"0",useVariables:!0,isVisible:e=>"custom"==e.disconnect},{type:"dropdown",label:"Axis on Surface Behavior",id:"axisBehavior",default:"pressed",choices:[{id:"pressed",label:"Be Pressed"},{id:"released",label:"Be Released"}]}],callback:async t=>{let n=parseInt(t.options.axis),s=t.options.disconnect,i=await e.parseVariablesInString(t.options.customValue),r=e.MAPPING?.axes.find((e=>e.axisIndex===n));r&&(r.disconnectBehavior=s,r.disconnectCustomValue=i,r.axisBehavior=t.options.axisBehavior),r||e.MAPPING?.axes.push({axisIndex:n,disconnectBehavior:s,disconnectCustomValue:i,axisBehavior:t.options.axisBehavior}),e.config.MAPPING=e.MAPPING,e.config.buttonMapping="custom",e.saveConfig(e.config),e.checkFeedbacks(),e.checkVariables()}},t.setButtonValue={name:"Other Settings - Set Button Value",description:"Set the value of a specific button on the controller. This can be useful if the button is not behaving as expected.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"textinput",label:"Value",id:"value",default:"0",useVariables:!0}],callback:async t=>{let n=e.CONTROLLER.uuid,s=parseInt(t.options.button),i=Number(await e.parseVariablesInString(t.options.value));isNaN(i)&&(i=0),i<0&&(i=0),i>1&&(i=1);let r=100*i,o=i>0,a=i>0;n&&(e.log("debug",`Setting Button ${s} to ${i} (${r}%)`),e.processButtonEvent(n,s,o,a,i,r,!0))}},t.setButtonPercent={name:"Other Settings - Set Button Percent",description:"Set the percentage of a specific button on the controller. This can be useful if the button is not behaving as expected.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS},{type:"textinput",label:"Percent",id:"percent",default:"0",useVariables:!0}],callback:async t=>{let n=e.CONTROLLER.uuid,s=parseInt(t.options.button),i=Number(await e.parseVariablesInString(t.options.percent));isNaN(i)&&(i=0),i<0&&(i=0),i>100&&(i=100);let r=i/100,o=i>0,a=i>0;n&&(e.log("debug",`Setting Button ${s} to ${r} (${i}%)`),e.processButtonEvent(n,s,o,a,r,i,!0))}},t.releaseButtonValueHold={name:"Other Settings - Release Button Value Hold",description:"Release a specific button from holding its value and let the controller handle it normally.",options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS}],callback:async t=>{let n=e.CONTROLLER.uuid,s=parseInt(t.options.button);n&&(e.log("debug",`Releasing Button Value ${s}`),e.processButtonEvent(n,s,!1,!1,0,0,!1))}},t.setAxisValue={name:"Other Settings - Set Axis Value",description:"Set the value of a specific axis on the controller. This can be useful if the axis is not behaving as expected.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"textinput",label:"Value",id:"value",default:"0",useVariables:!0}],callback:async t=>{let n=e.CONTROLLER.uuid,s=parseInt(t.options.axis),i=Number(await e.parseVariablesInString(t.options.value));isNaN(i)&&(i=0),i<-1&&(i=-1),i>1&&(i=1);let r=!1;0!=i&&(r=!0),n&&(e.log("debug",`Setting Axis ${s} to ${i}`),e.processAxisEvent(n,s,r,i,!0))}},t.setAxisPercent={name:"Other Settings - Set Axis Percent",description:"Set the percentage of a specific axis on the controller. This can be useful if the axis is not behaving as expected.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES},{type:"textinput",label:"Percent",id:"percent",default:"0",useVariables:!0}],callback:async t=>{let n=e.CONTROLLER.uuid,s=parseInt(t.options.axis),i=Number(await e.parseVariablesInString(t.options.percent));isNaN(i)&&(i=0),i<-100&&(i=-100),i>100&&(i=100);let r=i/100,o=!1;0!=r&&(o=!0),n&&(e.log("debug",`Setting Axis ${s} to ${r} (${i}%)`),e.processAxisEvent(n,s,o,r,!0))}},t.releaseAxisValueHold={name:"Other Settings - Release Axis Value Hold",description:"Release a specific axis from holding its value and let the controller handle it normally.",options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES}],callback:async t=>{let n=e.CONTROLLER.uuid,s=parseInt(t.options.axis);n&&(e.log("debug",`Releasing Axis Value ${s}`),e.processAxisEvent(n,s,!1,0,!1))}},t.loadCustomMapping={name:"Other Settings - Load Custom Mapping",description:"Load a custom button/axis mapping from a file.",options:[{type:"textinput",label:"File Path",id:"path",default:"",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.path);n&&(e.loadCustomMapping(n),e.config.buttonMapping="custom-file",e.config.customFile=n,e.saveConfig(e.config))}},t.saveCustomMapping={name:"Other Settings - Save Custom Mapping",description:"Save the current custom button/axis mapping to a file.",options:[{type:"textinput",label:"File Path",id:"path",default:"",useVariables:!0}],callback:async t=>{let n=await e.parseVariablesInString(t.options.path);n&&e.saveCustomMapping(n)}},t.relaunch={name:"Other Settings - Relaunch gamepad-io",description:"Relaunch the gamepad-io application.",callback:async t=>{e.relaunchApp()}},this.setActionDefinitions(t)}}},6672:(e,t,n)=>{const{InstanceStatus:s}=n(6278),i=n(8007);e.exports={initConnection:function(){let e=this;e.log("info","Initializing connection to gamepad-io..."),e.CompanionSatellite_Close(),e.CONTROLLER_SURFACE_UUID=void 0,e.config.host&&(e.config.port=8809,e.log("info",`Opening connection to gamepad-io: ${e.config.host}:${e.config.port}`),e.updateStatus(s.Connecting),e.socket=i.connect("http://"+e.config.host+":"+e.config.port,{reconnection:!0}),e.log("info","Connecting to gamepad-io..."),e.STATUS.information="Connecting to gamepad-io",e.checkVariables(),e.socket.on("connect",(function(){e.log("info","Connected to gamepad-io. Retrieving data."),e.updateStatus(s.Connecting,"Connected, Waiting for Controller Data..."),e.CONNECTED=!0,e.getConfigFields(),e.STATUS.information="Connected",e.sendCommand("version",null,null),e.sendCommand("controllers"),e.checkFeedbacks(),e.checkVariables()})),e.socket.on("disconnect",(function(){e.updateStatus(s.Disconnected),e.log("error","Disconnected from gamepad-io."),e.CONNECTED=!1,e.STATUS.information="Disconnected",e.STATUS.controllers=[],e.resetValues(),e.getConfigFields(),e.CompanionSatellite_Close(),e.CONTROLLER_SURFACE_UUID=void 0,e.initVariables(),e.checkFeedbacks(),e.checkVariables(),e.log("info","Attempting to reconnect in 5 seconds..."),e.RECONNECT_INTERVAL=setTimeout((function(){e.init(e.config)}),5e3)})),e.socket.on("version",(function(t){e.STATUS.version=t;let n={};n.version=t,e.setVariableValues(n)})),e.socket.on("controllers",(function(t){e.processControllers(t)})),e.socket.on("button_event",(function(t,n,s,i,r,o){e.processButtonEvent(t,n,s,i,r,o)})),e.socket.on("axis_event",(function(t,n,s,i){e.processAxisEvent(t,n,s,i)})),e.socket.on("error",(function(t){e.updateStatus(s.Disconnected),e.log("error","Error from gamepad-io: "+t),e.CompanionSatellite_Close(),e.CONTROLLER_SURFACE_UUID=void 0,e.checkFeedbacks(),e.checkVariables(),e.log("info","Attempting to reconnect in 5 seconds..."),e.RECONNECT_INTERVAL=setTimeout((function(){e.initConnection()}),5e3)})))},processControllers:function(e){let t=this;try{let n=!1;if(e.length!==t.STATUS.controllers.length)n=!0;else{for(let s=0;s<e.length;s++){let i=e[s];if(void 0===t.STATUS.controllers.find((e=>e.uuid===i.uuid))){n=!0;break}}if(!1===n)for(let s=0;s<t.STATUS.controllers.length;s++){let i=t.STATUS.controllers[s];if(void 0===e.find((e=>e.uuid===i.uuid))){n=!0;break}}}if(!n)return void t.log("debug","No change in controllers detected.");if(t.config.verbose&&t.log("debug","Controllers changed. Re-running controller choice logic."),t.STATUS.controllers=e,t.rebuildChoices(),t.getConfigFields(),t.initActions(),t.initFeedbacks(),t.initVariables(),t.initPresets(),0===e.length)t.updateStatus(s.Connecting,"No controllers detected. Press a button on a gamepad to detect all connected gamepads.");else{let n=t.config.controller,i=e.find((e=>e.uuid===n));void 0===n?(t.log("warn","No controller selected. Please select a controller in the configuration."),t.updateStatus(s.Connecting,"No controller selected. Please select a controller in the configuration."),t.loadSurfaceSettings()):void 0===i?(t.log("warn","Previously selected controller not found. Please select a new controller in the configuration."),t.updateStatus(s.Connecting,"Previously selected controller not found. Please select a controller in the configuration.")):(t.log("info","Controller detected: "+i.id),void 0!==t.CONTROLLER&&t.CONTROLLER?.uuid!==i.uuid&&(t.config.verbose&&t.log("debug","Leaving room for previous controller: "+t.CONTROLLER.uuid),t.socket.emit("leave_room",t.CONTROLLER.uuid)),t.CONTROLLER=i,t.CONTROLLER.name=t.CONTROLLER.id.split("(")[0].trim(),t.updateStatus(s.Ok),t.checkFeedbacks("controllerConnected"),t.config.verbose&&t.log("info","Subscribing to controller events for: "+t.CONTROLLER.uuid),t.socket.emit("join_room",t.CONTROLLER.uuid),void 0===t.config.buttonMapping&&(t.log("info","No button mapping selected. Defaulting to Generic."),t.config.buttonMapping="generic",t.saveConfig(t.config)),t.loadButtonMapping(),t.rebuildChoices(),t.initActions(),t.initFeedbacks(),t.initVariables(),t.initPresets(),t.config.useAsSurface&&(t.loadSurfaceSettings(),t.config.verbose&&t.log("debug","Using as Surface. Opening connection to Companion Satellite API."),t.CONTROLLER_SURFACE_UUID!==t.CONTROLLER.uuid?(t.config.verbose&&t.log("debug","Controller Surface UUID has changed. Restarting Satellite Connection."),t.initSurface()):t.config.verbose&&t.log("debug","Controller Surface UUID has not changed. Not restarting Satellite Connection."),t.CONTROLLER_SURFACE_UUID=t.CONTROLLER.uuid))}t.checkFeedbacks(),t.checkVariables()}catch(e){t.log("error",String(e))}},processButtonEvent:function(e,t,n,s,i,r,o=null){let a=this;try{if(a.CONTROLLER){if(a.CONTROLLER.uuid===e&&0==a.LOCKED){if(null==o){if(!0===a.CONTROLLER.buttons[t].buttonHold)return void(a.config.verbose&&a.log("debug",`Button ${t} is set to hold. Ignoring event.`));o=!1}a.CONTROLLER.buttons[t].buttonHold=o,a.CONTROLLER.buttons[t].pressed=n,a.CONTROLLER.buttons[t].touched=s,a.CONTROLLER.buttons[t].val=i,a.CONTROLLER.buttons[t].pct=r;let{buttonDisplayValue:c,buttonRangeMin:l,buttonRangeMax:u}=a.calculateButtonDisplayValue(t,i),d=t,h=a.MAPPING?.buttons.find((e=>e.buttonIndex===t));if(h&&(buttonInverted=h.buttonInverted,buttonInverted&&h.invertPercentage&&(r=100-r)),parseInt(r)>=a.config.buttonPressThreshold)if(a.LAST_BUTTON_PRESSED!==t||-1===a.LAST_BUTTON_PRESSED){a.config.useAsSurface&&a.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${e} KEY=${d} PRESSED=true`),a.LAST_BUTTON_PRESSED=t,1==a.config.hapticWhenPressed&&a.sendHapticFeedback(e,"button",t),void 0!==a.DEBOUNCE_TIMER&&clearTimeout(a.DEBOUNCE_TIMER);let n=a.config.buttonDebounce;h&&void 0!==h.debounce&&(n=h.debounce),a.DEBOUNCE_TIMER=setTimeout((function(){a.LAST_BUTTON_PRESSED=-1,a.DEBOUNCE_TIMER=void 0}),n)}else a.config.verbose&&a.log("debug",`Button ${t} pressed, but debounce timer (${a.config.buttonDebounce}ms) is active.`);else parseInt(r)<=a.config.buttonReleaseThreshold&&a.config.useAsSurface&&a.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${e} KEY=${d} PRESSED=false`);let p=t;h&&(p=h.buttonId||t);let f={};f[`button_${p}_pressed`]=n?"True":"False",f[`button_${p}_touched`]=s?"True":"False",f[`button_${p}_val`]=i,f[`button_${p}_val_abs`]=Math.abs(i),f[`button_${p}_val_display`]=c,f[`button_${p}_val_display_abs`]=Math.abs(c),f[`button_${p}_pct`]=r,f[`button_${p}_pct_abs`]=Math.abs(r),f[`button_${p}_range_display_min`]=l,f[`button_${p}_range_display_max`]=u,f[`button_${p}_hold`]=o?"True":"False",a.setVariableValues(f)}a.checkFeedbacks()}}catch(e){a.log("error",String(e))}},calculateButtonDisplayValue:function(e,t){let n=this,s=t,i=0,r=1;if(void 0!==n.config.buttonRangeMinDefault&&(i=n.config.buttonRangeMinDefault),void 0!==n.config.buttonRangeMaxDefault&&(r=n.config.buttonRangeMaxDefault),n.MAPPING){let s=n.MAPPING.buttons.find((t=>t.buttonIndex===e));console.log(s),s?.buttonInverted&&(t=1-t),s&&void 0!==s.buttonRangeMin&&void 0!==s.buttonRangeMax&&(i=Number(s.buttonRangeMin),r=Number(s.buttonRangeMax))}let o=Number(t);return s=Math.round(i+o*(r-i)),n.CONTROLLER.buttons[e].buttonDisplayValue=s,{buttonDisplayValue:s,buttonRangeMin:i,buttonRangeMax:r}},processAxisEvent:function(e,t,n,s,i=null){let r=this;try{if(r.CONTROLLER){if(r.CONTROLLER.uuid===e&&0==r.LOCKED){if(null===i){if(!0===r.CONTROLLER.axes[t].axisHold)return void(r.config.verbose&&r.log("debug",`Axis ${t} is set to hold. Ignoring event.`));i=!1}let o;r.CONTROLLER.axes[t].axisHold=i,r.CONTROLLER.axes[t].pressed=n,r.CONTROLLER.axes[t].axis=s,r.MAPPING&&(o=r.MAPPING.axes.find((e=>e.axisIndex===t)));let a=-.1,c=.1;o&&(a=Number(o.axisNegDeadzone),c=Number(o.axisPosDeadzone));let l=!1;s>a&&s<c&&(s=0,l=!0,r.log("info",`Axis ${t} is in the deadzone. Setting to 0.`));let u=Number(s),{axisDisplayValue:d,axisRangeMin:h,axisRangeMax:p}=r.calculateAxisDisplayValue(t,u),f="Center";if(u<0){if(f="Negative",r.MAPPING){let e=r.MAPPING.axes.find((e=>e.axisIndex===t));void 0!==e&&void 0!==e?.axisType&&(f="x"===e.axisType.toLowerCase()?"Left":"Up")}}else if(u>0){if(f="Positive",r.MAPPING){let e=r.MAPPING.axes.find((e=>e.axisIndex===t));void 0!==e&&void 0!==e?.axisType&&(f="x"===e.axisType.toLowerCase()?"Right":"Down")}}else if(0===u&&(f="Neutral",r.MAPPING)){let e=r.MAPPING.axes.find((e=>e.axisIndex===t));void 0!==e&&void 0!==e?.axisType&&(f="Center")}r.CONTROLLER.axes[t].direction=f;let b=t;o&&(b=o.axisId||t),o&&(axisInverted=o.axisInverted,axisInverted&&o.invertPercentage&&(axisPct=100-axisPct));let g={};if(g[`axis_${b}_pressed`]=n?"True":"False",g[`axis_${b}_val`]=u,g[`axis_${b}_val_abs`]=Math.abs(u),g[`axis_${b}_val_display`]=d,g[`axis_${b}_val_display_abs`]=Math.abs(d),g[`axis_${b}_pct`]=axisPct+"%",g[`axis_${b}_pct_abs`]=Math.abs(axisPct)+"%",g[`axis_${b}_direction`]=f,g[`axis_${b}_range_display_min`]=h,g[`axis_${b}_range_display_max`]=p,g[`axis_${b}_hold`]=i?"True":"False",r.setVariableValues(g),r.config.axisMovementAsButtonPress){let n=r.CONTROLLER.buttons.length+2*t,s=r.CONTROLLER.buttons.length+1+2*t,i=Number(r.config.axisMovementPressThreshold),o=Math.abs(axisPct);l||(o<100-i?axisPct<0?r.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${e} KEY=${n} PRESSED=false`):axisPct>0&&r.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${e} KEY=${s} PRESSED=false`):axisPct<0?(r.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${e} KEY=${n} PRESSED=true`),1==r.config.hapticWhenPressed&&r.sendHapticFeedback(e,"axis",n)):axisPct>0&&(r.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${e} KEY=${s} PRESSED=true`),1==r.config.hapticWhenPressed&&r.sendHapticFeedback(e,"axis",s)))}}r.checkFeedbacks()}}catch(e){r.log("error",String(e))}},calculateAxisDisplayValue:function(e,t){let n=this,s=-1,i=1;n.MAPPING&&(axisObj=n.MAPPING.axes.find((t=>t.axisIndex===e))),axisObj&&(axisObj?.axisInverted&&(t*=-1),s=axisObj.axisRangeMin,i=axisObj.axisRangeMax),axisPct=Math.round(100*t);let r=(i-s)/2,o=Math.round(t*r);return n.CONTROLLER.axes[e].axisDisplayValue=o,{axisDisplayValue:o,axisRangeMin:s,axisRangeMax:i}},rebuildChoices:function(){let e=this;if(e.config.verbose&&e.log("debug","Rebuilding Choices for Controller, Buttons, and Axes."),e.STATUS.controllers.length>0){e.CHOICES_CONTROLLERS=[],e.CHOICES_CONTROLLERS.push({id:void 0,label:"(select a controller)"});for(let t=0;t<e.STATUS.controllers.length;t++){let n=e.STATUS.controllers[t],s=n.id.split("(")[0].trim();s=`${s} (Buttons: ${n.buttons.length}, Axes: ${n.axes.length})`,1==n.inUse&&(s="IN USE: "+s),e.CHOICES_CONTROLLERS.push({id:n.uuid,label:s})}}else e.CHOICES_CONTROLLERS=[{id:void 0,label:"(no controllers detected)"}];if(e.CONTROLLER){if(e.CONTROLLER.buttons.length>0){e.CHOICES_BUTTONS=[];for(let t=0;t<e.CONTROLLER.buttons.length;t++){let n="Button "+t;if(e.MAPPING){let s=e.MAPPING.buttons.find((e=>e.buttonIndex===t));s&&(n=s.buttonName||"Button "+t)}e.CHOICES_BUTTONS.push({id:t,label:n})}}else e.CHOICES_BUTTONS=[{id:"0",label:"No Buttons Available"}];if(e.CONTROLLER.axes.length>0){e.CHOICES_AXES=[];for(let t=0;t<e.CONTROLLER.axes.length;t++){let n="Axis "+t;if(e.MAPPING){let s=e.MAPPING.axes.find((e=>e.axisIndex===t));s&&(n=s.axisName||"Axis "+t)}e.CHOICES_AXES.push({id:t.toString(),label:n})}}else e.CHOICES_AXES=[{id:"0",label:"No Axes Available"}]}},loadButtonMapping:function(){let e=this;if("generic"==e.config.buttonMapping)return e.log("info","Loading Generic Button Mapping."),void(e.MAPPING={buttons:[],axes:[]});if("custom"==e.config.buttonMapping)e.log("info","Loading Custom Button Mapping."),e.MAPPING=e.config.MAPPING,null==e.MAPPING&&(e.MAPPING={buttons:[],axes:[]});else if(void 0!==e.config.buttonMapping)if(e.log("info",`Loading Button Mapping: ${e.config.buttonMapping}`),"custom-file"===e.config.buttonMapping)this.loadCustomMapping(this.config.customFile);else try{e.MAPPING=n(1184)(`./${e.config.buttonMapping}.json`)}catch(t){e.log("error",`Error loading button mapping: ${t}`),e.MAPPING={buttons:[],axes:[]},e.config.buttonMapping="generic"}void 0===e.config.buttonRangeMinDefault&&(e.config.buttonRangeMinDefault=0),void 0===e.config.buttonRangeMaxDefault&&(e.config.buttonRangeMaxDefault=1);for(let t=0;t<e.CONTROLLER.buttons.length;t++){let n=e.CONTROLLER.buttons[t],s=e.MAPPING?.buttons.find((e=>e.buttonIndex===n.buttonIndex));s&&(void 0===s.disconnectBehavior&&(e.logVerbose("info",`Button ${n.buttonIndex} missing disconnectBehavior. Setting to reset.`),s.disconnectBehavior="reset"),void 0===s.buttonRangeMin&&(e.logVerbose("info",`Button ${n.buttonIndex} missing buttonRangeMin. Setting to Config default of ${e.config.buttonRangeMinDefault}.`),s.buttonRangeMin=e.config.buttonRangeMinDefault),void 0===s.buttonRangeMax&&(e.logVerbose("info",`Button ${n.buttonIndex} missing buttonRangeMax. Setting to Config default of ${e.config.buttonRangeMaxDefault}.`),s.buttonRangeMax=e.config.buttonRangeMaxDefault),void 0===s.buttonType&&(e.logVerbose("info",`Button ${n.buttonIndex} missing buttonType. Setting to type: button.`),s.buttonType="button"),void 0===s.buttonInverted&&(e.logVerbose("info",`Button ${n.buttonIndex} missing buttonInverted. Setting to false.`),s.buttonInverted=!1),void 0===s.hapticType&&(e.logVerbose("info",`Button ${n.buttonIndex} missing hapticType. Setting to dual-rumble.`),s.hapticType="dual-rumble"),void 0===s.hapticParams&&(e.logVerbose("info",`Button ${n.buttonIndex} missing hapticParams. Setting to default values.`),s.hapticParams={duration:.1,startDelay:0,strongMagnitude:1,weakMagnitude:.5}))}void 0===e.config.axisDeadzoneNegDefault&&(e.config.axisDeadzoneNegDefault=-.1),void 0===e.config.axisDeadzonePosDefault&&(e.config.axisDeadzonePosDefault=.1),void 0===e.config.axisRangeMinDefault&&(e.config.axisRangeMinDefault=-1),void 0===e.config.axisRangeMaxDefault&&(e.config.axisRangeMaxDefault=1);for(let t=0;t<e.CONTROLLER.axes.length;t++){let n=e.CONTROLLER.axes[t],s=e.MAPPING?.axes.find((e=>e.axisIndex===n.axisIndex));s&&(void 0===s.disconnectBehavior&&(e.logVerbose("info",`Axis ${n.axisIndex} missing disconnectBehavior. Setting to reset.`),s.disconnectBehavior="reset"),void 0===s.axisNegDeadzone&&(e.logVerbose("info",`Axis ${n.axisIndex} missing axisNegDeadzone. Setting to default of ${e.config.axisDeadzoneNegDefault}.`),s.axisNegDeadzone=e.config.axisDeadzoneNegDefault),void 0===s.axisPosDeadzone&&(e.logVerbose("info",`Axis ${n.axisIndex} missing axisPosDeadzone. Setting to default of ${e.config.axisDeadzonePosDefault}.`),s.axisPosDeadzone=e.config.axisDeadzonePosDefault),void 0===s.axisInverted&&(e.logVerbose("info",`Axis ${n.axisIndex} missing axisInverted. Setting to false.`),s.axisInverted=!1),void 0===s.axisRangeMin&&(e.logVerbose("info",`Axis ${n.axisIndex} missing axisRangeMin. Setting to Config default of ${e.config.axisRangeMinDefault}.`),s.axisRangeMin=e.config.axisRangeMinDefault),void 0===s.axisRangeMax&&(e.logVerbose("info",`Axis ${n.axisIndex} missing axisRangeMax. Setting to Config default of ${e.config.axisRangeMaxDefault}.`),s.axisRangeMax=e.config.axisRangeMaxDefault),void 0===s.axisType&&(e.logVerbose("info",`Axis ${n.axisIndex} missing axisType. Setting to type: x.`),s.axisType="x"))}e.config.MAPPING=e.MAPPING,e.saveConfig(e.config)},loadCustomMapping:function(e){let t=this;try{t.log("info",`Loading Custom Button Mapping from: ${e}`),t.MAPPING=n(6589)(e),t.config.MAPPING=t.MAPPING,t.saveConfig(t.config)}catch(e){t.log("error",`Error loading custom button mapping: ${e}`),t.MAPPING=void 0,t.config.buttonMapping="generic"}},saveCustomMapping:function(e){let t=this,s=n(9896);try{t.log("info",`Saving Custom Button Mapping to: ${e}`),s.writeFileSync(e,JSON.stringify(t.MAPPING,null,2))}catch(e){t.log("error",`Error saving custom button mapping: ${e}`)}},loadSurfaceSettings:function(){let e=this;void 0===e.config.host_companion&&(e.config.host_companion="127.0.0.1"),void 0===e.config.port_companion&&(e.config.port_companion=16622),void 0===e.config.hapticWhenPressed&&(e.config.hapticWhenPressed=!1),void 0===e.config.buttonPressThreshold&&(e.config.buttonPressThreshold=100),e.config.buttonPressThreshold=Math.abs(Number(e.config.buttonPressThreshold)),void 0===e.config.buttonReleaseThreshold&&(e.config.buttonReleaseThreshold=0),e.config.buttonReleaseThreshold=Math.abs(Number(e.config.buttonReleaseThreshold)),void 0===e.config.buttonDebounce&&(e.config.buttonDebounce=50),e.config.buttonDebounce=Math.abs(Number(e.config.buttonDebounce)),void 0===e.config.axisMovementAsButtonPress&&(e.config.axisMovementAsButtonPress=!1),void 0===e.config.axisMovementPressThreshold&&(e.config.axisMovementPressThreshold=5),e.config.axisMovementPressThreshold=Math.abs(Number(e.config.axisMovementPressThreshold)),e.saveConfig(e.config)},sendHapticFeedback:function(e,t,n){let s,i,r=this,o="none";"button"===t?i=r.MAPPING?.buttons.find((e=>e.buttonIndex===n)):"axis"===t&&(i=r.MAPPING?.axes.find((e=>e.axisIndex===n))),i&&(o=i.hapticType||"none",s=i.hapticParams),void 0===s&&(s={duration:100,startDelay:0,strongMagnitude:1,weakMagnitude:.5},"trigger-rumble"===o&&(s.leftTrigger=.5,s.rightTrigger=.5)),"none"!==o&&r.config.hapticWhenPressed&&(r.config.verbose&&r.log("info",`Sending Haptic Feedback: ${o} from Button ${n}`),r.socket.emit("haptic",r.CONTROLLER.uuid,o,s))},resetValues:function(){let e=this;if(e.LAST_BUTTON_PRESSED=-1,clearInterval(e.DEBOUNCE_TIMER),e.DEBOUNCE_TIMER=void 0,e.CONTROLLER){for(let t=0;t<e.CONTROLLER.buttons.length;t++){let n=e.CONTROLLER.buttons[t],s=e.MAPPING?.buttons.find((e=>e.buttonIndex===n.buttonIndex));if(s&&"reset"===s.disconnectBehavior)e.CONTROLLER.buttons[t].pressed=!1,e.CONTROLLER.buttons[t].touched=!1,e.CONTROLLER.buttons[t].val=0,e.CONTROLLER.buttons[t].pct=0,e.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${controller.uuid} KEY=${n.buttonIndex} PRESSED=false`);else if(s&&"hold"===s.disconnectBehavior);else if(s&&"custom"===s.disconnectBehavior){let i=s.disconnectCustomValue,r=s.buttonBehavior;"released"===r?(e.CONTROLLER.buttons[t].pressed=!1,e.CONTROLLER.buttons[t].touched=!1,e.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${controller.uuid} KEY=${n.buttonIndex} PRESSED=false`)):"pressed"===r&&(e.CONTROLLER.buttons[t].pressed=!0,e.CONTROLLER.buttons[t].touched=!0,e.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${controller.uuid} KEY=${n.buttonIndex} PRESSED=true`)),e.CONTROLLER.buttons[t].val=i,e.CONTROLLER.buttons[t].pct=100*i}let{buttonDisplayValue:i,buttonRangeMin:r,buttonRangeMax:o}=e.calculateButtonDisplayValue(t,e.CONTROLLER.buttons[t].val);e.CONTROLLER.buttons[t].buttonDisplayValue=i,e.checkVariables()}for(let t=0;t<e.CONTROLLER.axes.length;t++){let n=e.CONTROLLER.axes[t],s=e.MAPPING?.axes.find((e=>e.axisIndex===n.axisIndex));if(s&&"reset"===s?.disconnectBehavior)e.CONTROLLER.axes[t].pressed=!1,e.CONTROLLER.axes[t].axis=0,e.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${controller.uuid} KEY=${n.axisIndex} PRESSED=false`);else if(s&&"hold"===s?.disconnectBehavior);else if(s&&"custom"===s?.disconnectBehavior){let i=s.disconnectCustomValue,r=s.axisBehavior;"released"===r?(e.CONTROLLER.axes[t].pressed=!1,e.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${controller.uuid} KEY=${n.axisIndex} PRESSED=false`)):"pressed"===r&&(e.CONTROLLER.axes[t].pressed=!0,e.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${controller.uuid} KEY=${n.axisIndex} PRESSED=true`)),e.CONTROLLER.axes[t].axis=i}let{axisDisplayValue:i,axisRangeMin:r,axisRangeMax:o}=e.calculateAxisDisplayValue(t,e.CONTROLLER.axes[t].axis);e.CONTROLLER.axes[t].axisDisplayValue=i,e.checkVariables()}}},relaunchApp:function(){this.log("info","Relaunching gamepad-io application."),this.sendCommand("relaunch")},sendCommand:function(e,t=null,n=null){let s=this;s.config.verbose&&s.log("info","Sending: "+e),void 0!==s.socket?null!==t?null!==n?s.socket.emit(e,t,n):s.socket.emit(e,t):s.socket.emit(e):(debug("Unable to send: Not connected to gamepad-io."),s.config.verbose&&s.log("warn","Unable to send: Not connected to gamepad-io."))},logVerbose:function(e,t){this.config.verbose&&this.log(e,t)}}},8384:(e,t,n)=>{const{Regex:s}=n(6278);e.exports={getConfigFields(){let e=this,t=[];return t.push({type:"static-text",id:"info",label:"Information",width:12,value:'This module allows you to use a gamepad as a controller surface for Companion. Must be used in conjunction with the gamepad-io software, available at <a href="http://github.com/josephdadams/gamepad-io">http://github.com/josephdadams/gamepad-io</a>.'}),t.push({type:"static-text",id:"info-start",label:"Getting Started",width:12,value:'To get started, download the gamepad-io software from the link above and follow the installation instructions. Once you have the software installed, you can connect to it by entering the host address below and clicking "Save".<br /><br />\n\t\t\tOnce connected, you can press a button on your gamepad to have it detected by gamepad-io. Once detected, you can return to this configuration page to configure the controller and buttons. You can use multiple gamepads with gamepad-io by using separate instances of this module.'}),t.push({type:"textinput",id:"host",label:"gamepad-io Host",width:3,default:"127.0.0.1",regex:s.IP}),t.push({type:"static-text",id:"hr1",width:12,label:"",value:"<hr />"}),1==e.CONNECTED?e.STATUS.controllers.length>0?(t.push({type:"dropdown",id:"controller",label:"Controller",width:3,default:e.CHOICES_CONTROLLERS[0].id,choices:e.CHOICES_CONTROLLERS}),t.push({type:"static-text",id:"info-buttonmapping",width:12,label:"Button Mapping",value:'The button mapping is the layout of the controller buttons and the way they are labeled in Variables and throughout the module when in use. By default, the buttons are labeled as Button 0, Button 1, etc. If you know the type of controller you are using, you can select it from the dropdown below.<br /><br />\n\t\t\t\t\tIf your controller is not listed, you can submit a pull request to the <a href="http://github.com/bitfocus/companion/companion-module-josephadams-gamepadio">Companion Module repository</a> to add it.'}),t.push({type:"dropdown",id:"buttonMapping",label:"Button Mapping",width:12,default:"generic",choices:e.CHOICES_BUTTONMAPPING}),t.push({type:"textinput",id:"customFile",label:"Custom Mapping File Path",width:4,filetype:"json",isVisible:e=>"custom-file"==e.buttonMapping}),t.push({type:"static-text",id:"info-customfile",width:8,label:"Custom Mapping File",value:"If you have a custom mapping file, you can upload it here. The file should be in JSON format and contain the button and axis mappings for your controller. You can find examples in the mappings folder of the gamepad-io module repository.",isVisible:e=>"custom-file"==e.buttonMapping}),t.push({type:"static-text",id:"info-hr1",width:12,label:"",value:"<hr />"}),t.push({type:"checkbox",id:"useAsSurface",label:"Use controller as a Companion Satellite Surface",width:12,default:!0}),t.push({type:"textinput",id:"host_companion",label:"Companion Satellite Host",width:3,default:"127.0.0.1",isVisible:e=>1==e.useAsSurface}),t.push({type:"textinput",id:"port_companion",label:"Companion Satellite Port",width:3,default:16622,isVisible:e=>1==e.useAsSurface}),t.push({type:"static-text",id:"info-hr2",width:12,label:"Button Settings",value:"<hr />",isVisible:e=>1==e.useAsSurface}),t.push({type:"checkbox",id:"hapticWhenPressed",label:"Haptic Feedback when Button Pressed (Experimental)",width:4,default:!1,isVisible:e=>1==e.useAsSurface}),t.push({type:"static-text",id:"info-haptic",width:8,label:"Haptic Feedback",value:"Haptic feedback will cause the controller to vibrate when a button is pressed. This is useful for tactile feedback when pressing buttons. You can set the type and other parameters in Actions per button.",isVisible:e=>1==e.useAsSurface}),t.push({type:"textinput",id:"buttonPressThreshold",label:"Button Press Threshold (%)",width:4,default:10,isVisible:e=>1==e.useAsSurface}),t.push({type:"static-text",id:"info-buttonpressthreshold",width:8,label:"Button Press Threshold",value:"The button press threshold is the percentage of variance in the button that must be met to trigger a button <b>PRESS</b>. This is useful for buttons that may not fully reach 100% or if you want to trigger them early.",isVisible:e=>1==e.useAsSurface}),t.push({type:"textinput",id:"buttonReleaseThreshold",label:"Button Release Threshold (%)",width:4,default:10,isVisible:e=>1==e.useAsSurface}),t.push({type:"static-text",id:"info-buttonreleasethreshold",width:8,label:"Button Release Threshold",value:"The button release threshold is the percentage of variance in the button that must be met to trigger a button <b>RELEASE</b>. This is useful for buttons that may not fully reach 0% or if you want to trigger them early.",isVisible:e=>1==e.useAsSurface}),t.push({type:"textinput",id:"buttonDebounce",label:"Button Debounce (in ms)",width:4,default:50,isVisible:e=>1==e.useAsSurface}),t.push({type:"static-text",id:"info-debounce",width:8,label:"Button Debounce",value:"The debounce is the amount of time in milliseconds that must pass before the button can be pressed again. This is useful for buttons that are sensitive and may register multiple presses in a short amount of time.",isVisible:e=>1==e.useAsSurface}),t.push({type:"textinput",id:"buttonRangeMinDefault",label:"Button Range Minimum",width:3,default:0}),t.push({type:"textinput",id:"buttonRangeMaxDefault",label:"Button Range Maximum",width:3,default:500}),t.push({type:"static-text",id:"info-buttonrange",width:6,label:"Button Range Display Defaults",value:"The display range is the minimum and maximum values to actually display/use in variables. This is useful for changing the range of a button to a different value than the default 0 to 1."}),t.push({type:"static-text",id:"info-hr2",width:12,label:"Axis Settings",value:"<hr />",isVisible:e=>1==e.useAsSurface}),t.push({type:"checkbox",id:"axisMovementAsButtonPress",label:"Use Axis Movement as Button Press",width:4,default:!1,isVisible:e=>1==e.useAsSurface}),t.push({type:"static-text",id:"info-axismovement",width:8,label:"Axis Movement as Button Press",value:"This option will allow you to use the movement of the axis as a button press. This is useful for joysticks that are not used for movement but rather for triggering actions. If enabled, all axes on the controller will each occupy two buttons on the surface, one for positive movement and one for negative movement.",isVisible:e=>1==e.useAsSurface}),t.push({type:"textinput",id:"axisMovementPressThreshold",label:"Axis Movement Threshold (%)",width:4,default:10,isVisible:e=>1==e.axisMovementAsButtonPress}),t.push({type:"static-text",id:"info-axismovementthreshold",width:8,label:"Axis Movement Threshold",value:"The axis movement threshold is the percentage of variance in the axis that must be met to trigger a button <b>PRESS</b> or <b>RELEASE. This is useful for joysticks that may not fully reach 100%. So, for example, if set to 10, the joystick must be within 90-100% to trigger a press, or 0-10% to trigger a release.",isVisible:e=>1==e.axisMovementAsButtonPress}),t.push({type:"textinput",id:"axisDeadzoneNegDefault",label:"Axis Deadzone Negative Default",width:3,default:-3,isVisible:e=>1==e.useAsSurface}),t.push({type:"textinput",id:"axisDeadzonePosDefault",label:"Axis Deadzone Positive Default",width:3,default:3,isVisible:e=>1==e.useAsSurface}),t.push({type:"static-text",id:"info-axisdeadzone",width:6,label:"Axis Deadzone Defaults",value:"The axis deadzone is the percentage of variance in the axis that will be ignored. This is useful for joysticks that may not fully reach 0% or 100% and will prevent unwanted button presses. These are the default values that will be applied if you have not set them individually per-axis in Actions.",isVisible:e=>1==e.useAsSurface}),t.push({type:"textinput",id:"axisRangeMinDefault",label:"Axis Range Default Minimum",width:3,default:-100}),t.push({type:"textinput",id:"axisRangeMaxDefault",label:"Axis Range Default Maximum",width:3,default:100}),t.push({type:"static-text",id:"info-axisrange",width:6,label:"Axis Range Display Defaults",value:"The display range is the minimum and maximum values to actually display/use in variables. This is useful for changing the range of an axis to a different value than the default -1 to 1. These are the default values that will be applied if you have not set them individually per-axis in Actions."})):t.push({type:"static-text",id:"info-nocontrollers",width:12,label:"",value:"<b>No controllers detected. Press a button on a gamepad for it to be detected by gamepad-io. Then return to this configuration page.</b>"}):t.push({type:"static-text",id:"info-notconnected",width:12,label:"",value:'<b>Not connected to gamepad-io. Make sure the software is running, enter the host address and click "Save" to connect, and then return to this configuration page.</b>'}),t.push({type:"static-text",id:"hr2",width:12,label:"",value:"<hr />"}),t.push({type:"static-text",id:"info-verbose",label:"Verbose Logging",width:12,value:"Enabling this option will put more detail in the log, which can be useful for troubleshooting purposes."}),t.push({type:"checkbox",id:"verbose",label:"Enable Verbose Logging",width:3,default:!1}),t}}},5521:e=>{e.exports={CONNECTED:!1,CONTROLLER:void 0,STATUS:{information:"",version:"",controllers:[]},LAST_BUTTON_PRESSED:-1,DEBOUNCE_TIMER:void 0,MAPPING:{axes:[],buttons:[]},RECONNECT_INTERVAL:void 0,LOCKED:!1,CHOICES_CONTROLLERS:[{id:"0",label:"Controller 1"}],CHOICES_BUTTONS:[{id:"0",label:"Button 1"}],CHOICES_AXES:[{id:"0",label:"Axis 1"}],CHOICES_HAPTIC_TYPES:[{id:"dual-rumble",label:"Dual Rumble"},{id:"trigger-rumble",label:"Trigger Rumble"}]}},8404:(e,t,n)=>{const{combineRgb:s}=n(6278);e.exports={initFeedbacks:function(){let e=this,t={};const n=s(255,255,255),r=s(255,0,0);t.controllerConnected={type:"boolean",name:"Controller Connected",description:"If a controller is connected, change the color of the button",defaultStyle:{color:n,bgcolor:r},callback:async function(){if(e.CONTROLLER)return!0}},t.controllerLocked={type:"boolean",name:"Controller Locked",description:"If the controller is locked by Companion, change the color of the button",defaultStyle:{color:n,bgcolor:r},callback:async function(){return e.LOCKED}},t.buttonPressed={type:"boolean",name:"Controller Button is Pressed",description:"If the controller button is pressed, change the color of the button",defaultStyle:{color:n,bgcolor:r},options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS}],callback:async function(t){t.options;let n=e.CONTROLLER;if(!n)return!1;let s=n.buttons[parseInt(t.options.button)];return s&&s.pressed||!1}},t.buttonTouched={type:"boolean",name:"Controller Button is Touched",description:"If the controller button is touched, change the color of the button",defaultStyle:{color:n,bgcolor:r},options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS}],callback:async function(t){t.options;let n=e.CONTROLLER;if(!n)return!1;let s=n.buttons[parseInt(t.options.button)];return s&&s.touched||!1}},t.buttonInverted={type:"boolean",name:"Controller Button is Inverted",description:"If the controller button is inverted, change the color of the button",defaultStyle:{color:n,bgcolor:r},options:[{type:"dropdown",label:"Button",id:"button",default:e.CHOICES_BUTTONS[0].id,choices:e.CHOICES_BUTTONS}],callback:async function(t){if(t.options,!e.CONTROLLER)return!1;let n=e.MAPPING?.buttons.find((e=>e.buttonIndex===i));return!!n&&n.buttonInverted}},t.axisInverted={type:"boolean",name:"Controller Axis is Inverted",description:"If the controller axis is inverted, change the color of the button",defaultStyle:{color:n,bgcolor:r},options:[{type:"dropdown",label:"Axis",id:"axis",default:e.CHOICES_AXES[0].id,choices:e.CHOICES_AXES}],callback:async function(t){if(t.options,!e.CONTROLLER)return!1;let n=e.MAPPING?.axes.find((e=>e.axisIndex===axis));return!!n&&n.axisInverted}},e.setFeedbackDefinitions(t)}}},4963:e=>{e.exports={CHOICES_BUTTONMAPPING:[{id:void 0,label:"(select a button mapping)"},{id:"generic",label:"Generic"},{id:"custom",label:"Custom (Start with Generic, then use Actions to define each Button Name, variableId, etc.)"},{id:"custom-file",label:"Custom (Load from File)"},{id:"xbox360",label:"XBox 360"},{id:"xboxone",label:"XBox One"},{id:"ps4",label:"PS4"}]}},1184:(e,t,n)=>{var s={"./generic.json":1356,"./ps4.json":3562,"./xbox360.json":1157,"./xboxone.json":9978};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=r,e.exports=i,i.id=1184},1632:(e,t,n)=>{const{combineRgb:s}=n(6278);e.exports={initPresets:function(){s(255,255,255),s(255,0,0),this.setPresetDefinitions([])}}},799:(e,t,n)=>{const{TCPHelper:s}=n(6278);e.exports={initSurface(){let e=this;e.CompanionSatellite_Close(),void 0===e.config.host_companion&&(e.config.host_companion="127.0.0.1"),void 0===e.config.port_companion&&(e.config.port_companion=16622),e.config.host_companion&&(e.log("info",`Opening Connection to Companion Satellite API: ${e.config.host_companion}:${e.config.port_companion}`),e.SOCKET_COMPANION=new s(e.config.host_companion,e.config.port_companion),e.SOCKET_COMPANION.on("error",(t=>{e.log("error","Network error with Companion Satellite API: "+t.message)})),e.SOCKET_COMPANION.on("connect",(()=>{e.log("info","Connected to Companion Satellite API")})),e.receiveBuffer="",e.SOCKET_COMPANION.on("data",(function(t){let n;for(e.receiveBuffer+=t.toString();-1!==(n=e.receiveBuffer.indexOf("\n"));){const t=e.receiveBuffer.slice(0,n).trim();e.receiveBuffer=e.receiveBuffer.slice(n+1);try{e.processCompanionData(t)}catch(e){console.error(e)}}})))},CompanionSatellite_Close(){let e=this;void 0!==e.SOCKET_COMPANION&&(e.sendCompanionSatelliteCommand(`REMOVE-DEVICE DEVICEID=${e.CONTROLLER.uuid}`),e.sendCompanionSatelliteCommand("QUIT"),e.SOCKET_COMPANION.destroy(),delete e.SOCKET_COMPANION),clearInterval(e.COMPANION_PING_INTERVAL)},processCompanionData(e){let t=this;try{let n=String(e).trim().split("\n");for(let e=0;e<n.length;e++){let s=n[e].split(" "),i=s[0];if("BEGIN"!=i)"ADD-DEVICE"!=i||("OK"==s[1]?t.startCompanionSatellitePing():t.log("error","Error adding device to Companion Satellite API: "+s[1]));else{let e=t.CONTROLLER;t.sendCompanionSatelliteCommand(`ADD-DEVICE DEVICEID=${e.uuid} PRODUCT_NAME="gamepad-io: ${e.id}" BITMAPS=false COLORS=false TEXT=false`)}}}catch(e){t.log("error","Error processing Companion Satellite API data: "+e.toString()),console.log(e)}},startCompanionSatellitePing(){let e=this;e.COMPANION_PING_INTERVAL=setInterval((function(){e.sendCompanionSatelliteCommand("PING")}),100)},sendCompanionSatelliteCommand(e){let t=this;void 0!==t.SOCKET_COMPANION&&t.SOCKET_COMPANION.isConnected&&(t.config.verbose&&"PING"!==e&&t.log("debug","Sending Companion Satellite API Command: "+e),t.SOCKET_COMPANION.send(e+"\n"))}}},3487:e=>{e.exports=[function(e,t){return{updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}}]},7969:e=>{e.exports={initVariables:function(){let e=this,t=[];if(t.push({variableId:"connected",name:"Connected to gamepad-io"}),t.push({variableId:"information",name:"Information"}),t.push({variableId:"version",name:"gamepad-io Version"}),t.push({variableId:"use_as_surface",name:"Use as Surface On/Off"}),e.config.useAsSurface&&(t.push({variableId:"haptic_when_pressed",name:"Haptic When Button Pressed"}),t.push({variableId:"button_press_threshold",name:"Button Press Threshold (%)"}),t.push({variableId:"button_release_threshold",name:"Button Release Threshold (%)"}),t.push({variableId:"button_debounce",name:"Button Debounce (ms)"}),t.push({variableId:"axis_button_press",name:"Axis will Button Press"}),t.push({variableId:"axis_movement_threshold",name:"Axis Movement Threshold (%)"})),t.push({variableId:"controller_connected",name:"Controller Connected"}),e.CONTROLLER){if(t.push({variableId:"controller_locked",name:"Controller Locked"}),t.push({variableId:"controller_uuid",name:"Controller UUID"}),t.push({variableId:"controller_id",name:"Controller ID"}),t.push({variableId:"controller_name",name:"Controller Name"}),t.push({variableId:"controller_total_buttons",name:"Controller Total Buttons"}),t.push({variableId:"controller_total_axes",name:"Controller Total Axes"}),e.CONTROLLER.buttons)for(let n=0;n<e.CONTROLLER.buttons.length;n++){let s=n,i=n,r=e.MAPPING?.buttons.find((e=>e.buttonIndex===n));r&&(s=r.buttonId||r.buttonIndex,i=r.buttonName||r.buttonIndex),t.push({variableId:`button_${s}_pressed`,name:`Button ${i} Pressed`}),t.push({variableId:`button_${s}_touched`,name:`Button ${i} Touched`}),t.push({variableId:`button_${s}_val`,name:`Button ${i} Raw Value`}),t.push({variableId:`button_${s}_val_abs`,name:`Button ${i} Raw Value Absolute`}),t.push({variableId:`button_${s}_val_display`,name:`Button ${i} Display Value`}),t.push({variableId:`button_${s}_val_display_abs`,name:`Button ${i} Display Value Absolute`}),t.push({variableId:`button_${s}_pct`,name:`Button ${i} Percent`}),t.push({variableId:`button_${s}_pct_abs`,name:`Button ${i} Percent Absolute`}),t.push({variableId:`button_${s}_type`,name:`Button ${i} Type`}),t.push({variableId:`button_${s}_inverted`,name:`Button ${i} Inverted`}),t.push({variableId:`button_${s}_range_display_min`,name:`Button ${i} Range Display Min`}),t.push({variableId:`button_${s}_range_display_max`,name:`Button ${i} Range Display Max`}),t.push({variableId:`button_${s}_hold`,name:`Button ${i} Value On Hold`})}if(e.CONTROLLER.axes)for(let n=0;n<e.CONTROLLER.axes.length;n++){let s=n,i=n,r=e.MAPPING?.axes.find((e=>e.axisIndex===n));r&&(s=r.axisId||r.axisIndex,i=r.axisName||r.axisIndex),t.push({variableId:`axis_${s}_pressed`,name:`Axis ${i} Pressed`}),t.push({variableId:`axis_${s}_val`,name:`Axis ${i} Raw Value`}),t.push({variableId:`axis_${s}_val_abs`,name:`Axis ${i} Raw Value Absolute`}),t.push({variableId:`axis_${s}_val_display`,name:`Axis ${i} Display Value`}),t.push({variableId:`axis_${s}_val_display_abs`,name:`Axis ${i} Display Value Absolute`}),t.push({variableId:`axis_${s}_pct`,name:`Axis ${i} Percent`}),t.push({variableId:`axis_${s}_pct_abs`,name:`Axis ${i} Percent Absolute`}),t.push({variableId:`axis_${s}_direction`,name:`Axis ${i} Current Direction`}),t.push({variableId:`axis_${s}_type`,name:`Axis ${i} Type`}),t.push({variableId:`axis_${s}_inverted`,name:`Axis ${i} Inverted`}),t.push({variableId:`axis_${s}_range_display_min`,name:`Axis ${i} Range Display Min`}),t.push({variableId:`axis_${s}_range_display_max`,name:`Axis ${i} Range Display Max`}),t.push({variableId:`axis_${s}_neg_deadzone`,name:`Axis ${i} Negative Deadzone`}),t.push({variableId:`axis_${s}_pos_deadzone`,name:`Axis ${i} Positive Deadzone`}),t.push({variableId:`axis_${s}_hold`,name:`Axis ${i} Value On Hold`})}}e.setVariableDefinitions(t)},checkVariables:function(){let e=this;try{let t={};t.connected=e.CONNECTED?"True":"False",t.information=e.STATUS.information,t.version=e.STATUS.version,t.use_as_surface=e.config.useAsSurface?"On":"Off",t.controller_connected=e.CONTROLLER?"True":"False",e.config.useAsSurface&&(t.haptic_when_pressed=e.config.hapticWhenPressed?"On":"Off",t.button_press_threshold=e.config.buttonPressThreshold+"%",t.button_release_threshold=e.config.buttonReleaseThreshold+"%",t.button_debounce=e.config.buttonDebounce,t.axis_button_press=e.config.axisMovementAsButtonPress?"On":"Off",t.axis_movement_threshold=e.config.axisMovementPressThreshold+"%");let n=e.CONTROLLER;if(n){t.controller_locked=e.LOCKED?"Locked":"Unlocked",t.controller_uuid=n.uuid,t.controller_id=n.id,t.controller_name=n.name,t.controller_total_buttons=n.buttons.length,t.controller_total_axes=n.axes.length;for(let n=0;n<e.CONTROLLER.buttons.length;n++){let s=n,i=n,r="Button",o=!1,a=0,c=1,l=e.MAPPING?.buttons.find((e=>e.buttonIndex===n));l&&(s=l.buttonId||l.buttonIndex,i=l.buttonName||l.buttonIndex,r="trigger"==l.buttonType?"Trigger":"Button",o=l.buttonInverted,a=l.buttonRangeMin,c=l.buttonRangeMax),t[`button_${s}_pressed`]=e.CONTROLLER.buttons[n].pressed?"True":"False",t[`button_${s}_touched`]=e.CONTROLLER.buttons[n].touched?"True":"False",t[`button_${s}_val`]=e.CONTROLLER.buttons[n].val||"0",t[`button_${s}_val_abs`]=Math.abs(e.CONTROLLER.buttons[n].val||0),t[`button_${s}_val_display`]=e.CONTROLLER.buttons[n].buttonDisplayValue||"0",t[`button_${s}_val_display_abs`]=Math.abs(e.CONTROLLER.buttons[n].buttonDisplayValue||0),t[`button_${s}_pct`]=e.CONTROLLER.buttons[n].pct||"0",t[`button_${s}_pct_abs`]=Math.abs(e.CONTROLLER.buttons[n].pct||0),t[`button_${s}_type`]=r||"Button",t[`button_${s}_inverted`]=o?"On":"Off",t[`button_${s}_range_display_min`]=a,t[`button_${s}_range_display_max`]=c,t[`button_${s}_hold`]=e.CONTROLLER.buttons[n].buttonHold?"True":"False"}for(let n=0;n<e.CONTROLLER.axes.length;n++){let s=n,i=n,r="unknown",o=!1,a=-1,c=1,l=0,u=0,d=e.MAPPING?.axes.find((e=>e.axisIndex===n));d&&(s=d.axisId||d.axisIndex,i=d.axisName||d.axisIndex,r=d.axisType||"",o=d.axisInverted||!1,a=d.axisRangeMin||-1,c=d.axisRangeMax||1,l=d.axisNegDeadzone||0,u=d.axisPosDeadzone||0),t[`axis_${s}_pressed`]=e.CONTROLLER.axes[n].pressed?"True":"False",t[`axis_${s}_val`]=e.CONTROLLER.axes[n].axis||"0",t[`axis_${s}_val_abs`]=Math.abs(e.CONTROLLER.axes[n].axis||0),t[`axis_${s}_val_display`]=e.CONTROLLER.axes[n].axisDisplayValue||"0",t[`axis_${s}_val_display_abs`]=Math.abs(e.CONTROLLER.axes[n].axisDisplayValue||0),t[`axis_${s}_pct`]=(e.CONTROLLER.axes[n].pct||0)+"%",t[`axis_${s}_pct_abs`]=Math.abs(e.CONTROLLER.axes[n].pct||0)+"%",t[`axis_${s}_direction`]=e.CONTROLLER.axes[n].direction||"",t[`axis_${s}_type`]=r,t[`axis_${s}_inverted`]=o?"On":"Off",t[`axis_${s}_range_display_min`]=a,t[`axis_${s}_range_display_max`]=c,t[`axis_${s}_neg_deadzone`]=l,t[`axis_${s}_pos_deadzone`]=u,t[`axis_${s}_hold`]=e.CONTROLLER.axes[n].axisHold?"True":"False"}}e.setVariableValues(t)}catch(t){e.log("error","Error setting Variables: "+String(t))}}}},6589:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=6589,e.exports=t},181:e=>{"use strict";e.exports=require("buffer")},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},7194:e=>{"use strict";e.exports=require("dgram")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},1943:e=>{"use strict";e.exports=require("fs/promises")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},9278:e=>{"use strict";e.exports=require("net")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},4756:e=>{"use strict";e.exports=require("tls")},9637:e=>{"use strict";e.exports=require("tty")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},3106:e=>{"use strict";e.exports=require("zlib")},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4326:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=void 0;const s=n(1635),i=n(9967),r=s.__importDefault(n(1943)),o=n(360),a=n(4044),c=s.__importDefault(n(6928));let l,u=!1;t.runEntrypoint=function(e,t){Promise.resolve().then((async()=>{if(u)throw new Error("runEntrypoint can only be called once");u=!0;const n=process.env.MODULE_MANIFEST;if(!n)throw new Error("Module initialise is missing MODULE_MANIFEST");const s=await r.default.readFile(n),d=JSON.parse(s.toString());if(d.runtime?.api!==i.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!d.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let h=d.runtime.apiVersion;if("0.0.0"===h)try{const e=await r.default.readFile(c.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(h=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const p=process.env.CONNECTION_ID;if("string"!=typeof p||!p)throw new Error("Module initialise is missing CONNECTION_ID");const f=process.env.VERIFICATION_TOKEN;if("string"!=typeof f||!f)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const b=new a.IpcWrapper({},(e=>{process.send(e)}),5e3);process.once("message",(e=>{b.receivedMessage(e)})),l=new e((0,o.literal)({id:p,upgradeScripts:t,_isInstanceBaseProps:!0})),b.sendWithCb("register",{apiVersion:h,connectionId:p,verificationToken:f}).then((()=>{console.log("Module-host accepted registration")}),(e=>{console.error("Module registration failed",e),process.exit(11)}))})).catch((e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)}))}},6160:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var s=n(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return s.TCPHelper}});var i=n(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return i.TelnetHelper}});var r=n(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return r.UDPHelper}})},8895:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const s=n(1635).__importDefault(n(9278)),i=n(228),r=n(1400);class o extends i.EventEmitter{#e;#t;_socket;#n;#s=!1;#i=!1;#r=!1;#o;#a;#c;get isConnected(){return this.#s}get isConnecting(){return this.#i}get isDestroyed(){return this.#r}constructor(e,t,n){super(),this.#e=e,this.#t=t,this.#n={reconnect_interval:2e3,reconnect:!0,...n},this._socket=new s.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",(e=>{this.#i=!1,this.#s=!1,this.#n.reconnect&&this.#l(),this.#u(r.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this._socket.on("ready",(()=>{this.#s=!0,this.#i=!1,this.#u(r.InstanceStatus.Ok),this.emit("connect")})),this._socket.on("end",(()=>{this.#s=!1,this.#u(r.InstanceStatus.Disconnected),!this.#i&&this.#n.reconnect&&this.#l(),this.emit("end")})),this._socket.on("data",(e=>this.emit("data",e))),this._socket.on("drain",(()=>this.emit("drain"))),setImmediate((()=>{this.#r||this.connect()})),this.#c=setTimeout((()=>{this.#c=void 0,this.#r||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}connect(){if(this.#r)throw new Error("Cannot connect destroyed socket");return!this.#i&&(this.#i=!0,this._socket.connect(this.#t,this.#e),!0)}async send(e){if(this.#r||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#s)return!1;try{return new Promise(((t,n)=>{this._socket.write(e,(e=>{e?n(e):t(!0)}))}))}catch(e){this.#s=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#u(r.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#r=!0,void 0!==this.#a&&(clearTimeout(this.#a),this.#a=void 0),void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#l(){void 0!==this.#a&&clearTimeout(this.#a),this.#a=setTimeout((()=>{this.#a=void 0,this.#u(r.InstanceStatus.Connecting),this.connect()}),this.#n.reconnect_interval)}#u(e,t){this.#o!=e&&(this.#o=e,this.emit("status_change",e,t))}}t.TCPHelper=o},1118:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const s=n(1635).__importDefault(n(228)),i=n(2203),r=n(8895);class o extends s.default{#d;#h;#c;get isConnected(){return this.#d.isConnected}get isConnecting(){return this.#d.isConnecting}get isDestroyed(){return this.#d.isDestroyed}constructor(e,t,n){super(),this.#d=new r.TCPHelper(e,t,n),this.#h=new a,this.#d._socket.pipe(this.#h),this.#d.on("connect",(()=>this.emit("connect"))),this.#d.on("end",(()=>this.emit("end"))),this.#d.on("error",(e=>this.emit("error",e))),this.#d.on("status_change",((e,t)=>this.emit("status_change",e,t))),this.#h.on("iac",((e,t)=>this.emit("iac",e,t))),this.#h.on("sb",(e=>this.emit("sb",e))),this.#h.on("data",(e=>this.emit("data",e))),this.#h.on("drain",(()=>this.emit("drain"))),this.#c=setTimeout((()=>{this.#c=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)}),5e3)}connect(){return this.#d.connect()}async send(e){return this.#d.send(e)}destroy(){this.#d.destroy(),void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this.#h.removeAllListeners(),this.#h.destroy()}}t.TelnetHelper=o;class a extends i.Transform{#p;#f;#b;constructor(e){super(e),this.#p=Buffer.alloc(0),this.#f=Buffer.alloc(0),this.#b=0}_transform(e,t,n){for(let t=0;t<e.length;++t)this.#g(e[t]);const s=this.#m();s.length&&this.push(s),n()}#g(e){if(0===this.#b){if(255===e)return void(this.#b=255);this.#p=Buffer.concat([this.#p,Buffer.from([e])])}else if(255===this.#b)switch(e){case 250:case 251:case 252:case 253:case 254:this.#b=e;break;default:this.#b=0}else{if(this.#b>=251&&this.#b<=254){let t;switch(this.#b){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#b=0)}if(250===this.#b){if(240===e)return this.emit("sb",this.#f),this.#b=0,void(this.#f=Buffer.alloc(0));this.#f=Buffer.concat([this.#f,Buffer.from([e])])}}}#m(){const e=this.#p;return this.#p=Buffer.alloc(0),e}}},6259:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const s=n(1635).__importDefault(n(7194)),i=n(228),r=n(1400);class o extends i.EventEmitter{#e;#t;#y;#n;#r=!1;#o;#c;get isDestroyed(){return this.#r}constructor(e,t,n){super(),this.#e=e,this.#t=t,this.#n={...n},this.#y=s.default.createSocket("udp4");try{this.#y.bind(this.#n.bind_port||0,this.#n.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#n.bind_ip||"0.0.0.0"}:${this.#n.bind_port||0}`)}this.#n.broadcast&&this.#y.setBroadcast(!0),void 0!==this.#n.ttl&&this.#y.setTTL(this.#n.ttl),void 0!==this.#n.multicast_ttl&&this.#y.setMulticastTTL(this.#n.multicast_ttl),this.#y.on("error",(e=>{this.#u(r.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this.#y.on("listening",(()=>{this.#n.multicast_interface&&this.#y.setMulticastInterface(this.#n.multicast_interface),this.#u(r.InstanceStatus.Ok),this.emit("listening")})),this.#y.on("message",(e=>this.emit("data",e))),this.#c=setTimeout((()=>{this.#r||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}async send(e){if(this.#r)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise(((t,n)=>{this.#y.send(e,this.#t,this.#e,(e=>{e?n(e):t()}))}))}destroy(){this.#r=!0,void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this.#y.removeAllListeners(),this.#y.close(),this.removeAllListeners()}#u(e,t){this.#o!=e&&(this.#o=e,this.emit("status_change",e,t))}}t.UDPHelper=o},4044:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const s=n(1635),i=n(360),r=s.__importDefault(n(6022));t.IpcWrapper=class{#v;#_;#x;#S=1;#k=new Map;constructor(e,t,n){this.#v=e,this.#_=t,this.#x=n}async sendWithCb(e,t,n,s=0){s<=0&&(s=this.#x);const i={timeout:void 0,resolve:()=>null,reject:()=>null},o=new Promise(((e,t)=>{i.resolve=e,i.reject=t}));this.#S>268435456&&(this.#S=1);const a=this.#S++;this.#k.set(a,i),this.#_({direction:"call",name:String(e),payload:r.default.stringify(t),callbackId:a});const c=new Error("Call timed out");return i.timeout=setTimeout((()=>{i.reject(n?n():c),this.#k.delete(a)}),s),o}sendWithNoCb(e,t){this.#_({direction:"call",name:String(e),payload:r.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#v[e.name];if(!t)return void(e.callbackId&&this.#_({direction:"response",callbackId:e.callbackId,success:!1,payload:r.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?r.default.parse(e.payload):void 0).then((t=>{e.callbackId&&this.#_({direction:"response",callbackId:e.callbackId,success:!0,payload:r.default.stringify(t)})}),(t=>{e.callbackId&&this.#_({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):r.default.stringify(t)})}));break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#k.get(e.callbackId);if(this.#k.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const n=e.payload?r.default.parse(e.payload):void 0;if(e.success)t.resolve(n);else{let e=n;n&&"object"==typeof n&&"message"in n&&(e=new Error(n.message),n.stack&&(e.stack=n.stack)),t.reject(e)}break}default:(0,i.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},6278:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const s=n(1635);s.__exportStar(n(9077),t),s.__exportStar(n(2018),t),s.__exportStar(n(4581),t);var i=n(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return i.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return i.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return i.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return i.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return i.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return i.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return i.assertNever}}),s.__exportStar(n(6160),t);var r=n(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return r.runEntrypoint}})},4289:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const s=n(2593);function i(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#I;#w;#E;#O=new Map;#C=new Map;constructor(e,t,n){this.#I=e,this.#w=t,this.#E=n}async handleExecuteAction(e){const t=this.#O.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},n)}handleUpdateActions(e){for(const[t,n]of Object.entries(e)){const e=this.#C.get(t);if(e){const t=this.#O.get(e.actionId);if(t?.unsubscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(i(e),n)).catch((t=>{this.#E("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!n||n.disabled)this.#C.delete(t);else{this.#C.set(t,n);const e=this.#O.get(n.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#I({text:e,controlId:n.controlId,actionInstanceId:n.id,feedbackInstanceId:void 0})).text};Promise.resolve(e.subscribe(i(n),t)).catch((e=>{this.#E("error",`Action subscribe failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)}))}}}}async handleLearnAction(e){const t=this.#O.get(e.action.actionId);if(t&&t.learn){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},n)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#O.clear();for(const[n,i]of Object.entries(e))i&&(t.push({id:n,name:i.name,description:i.description,options:(0,s.serializeIsVisibleFn)(i.options),hasLearn:!!i.learn,learnTimeout:i.learnTimeout}),this.#O.set(n,i));this.#w({actions:t})}_getAllActions(){return Array.from(this.#C.values()).map((e=>({id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options})))}subscribeActions(e){let t=Array.from(this.#C.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.actionId))));for(const e of t){const t=this.#O.get(e.actionId);if(t?.subscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.subscribe(i(e),n)).catch((t=>{this.#E("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeActions(e){let t=Array.from(this.#C.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.actionId))));for(const e of t){const t=this.#O.get(e.actionId);if(t&&t.unsubscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(i(e),n)).catch((t=>{this.#E("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInstanceBaseProps=t.serializeIsVisibleFn=void 0,t.serializeIsVisibleFn=function(e){return(e??[]).map((e=>"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisible:void 0}:{...e,isVisibleFn:void 0}))},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},8039:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const s=n(1635),i=n(2593),r=s.__importDefault(n(7e3));function o(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#I;#T;#P;#E;#N=new Map;#R=new Map;#A=new Map;#M=new Map;#L;get parseVariablesContext(){return this.#L}constructor(e,t,n,s){this.#I=e,this.#T=t,this.#P=n,this.#E=s}getDefinitionIds(){return Array.from(this.#N.keys())}getInstanceIds(){return Array.from(this.#R.keys())}handleUpdateFeedbacks(e){for(const[t,n]of Object.entries(e)){const e=this.#R.get(t);if(e){const t=this.#N.get(e.feedbackId);if(t?.unsubscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(o(t.type,e),n)).catch((t=>{this.#E("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!n||n.disabled)this.#R.delete(t);else{this.#R.set(t,{...n,referencedVariables:null});const e=this.#N.get(n.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#I({text:e,controlId:n.controlId,actionInstanceId:void 0,feedbackInstanceId:n.id})).text};Promise.resolve(e.subscribe(o(e.type,n),t)).catch((e=>{this.#E("error",`Feedback subscribe failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)}))}this.#D(t)}}}async handleLearnFeedback(e){const t=this.#N.get(e.feedback.feedbackId);if(t&&t.learn){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},n)}}return{options:void 0}}handleVariablesChanged(e){if(!e.variablesIds.length)return;const t=new Set(e.variablesIds);for(const t of this.#M.values())for(const n of e.variablesIds)t.changedVariables.add(n);const n=new Set;for(const e of this.#R.values())if(!this.#M.has(e.id)&&e.referencedVariables)for(const s of e.referencedVariables)if(t.has(s)){n.add(e.id);break}for(const e of n)setImmediate((()=>{this.#D(e)}))}#D(e){const t=this.#M.get(e);if(t)return void(t.needsRecheck=!0);const n=this.#R.get(e);if(!n)return;const s=n,i={needsRecheck:!1,changedVariables:new Set};this.#M.set(e,i),Promise.resolve().then((async()=>{const t=this.#N.get(s.feedbackId);let n;const i=new Set;if(t){this.#L=`Feedback ${s.feedbackId} (${e})`;const r={parseVariablesInString:async t=>{const n=await this.#I({text:t,controlId:s.controlId,actionInstanceId:void 0,feedbackInstanceId:e});if(n.variableIds&&n.variableIds.length)for(const e of n.variableIds)i.add(e);return n.text}};n="boolean"===t.type?t.callback({...o("boolean",s),type:"boolean"},r):t.callback({...o("advanced",s),type:"advanced",image:s.image},r),this.#L=void 0}const r=await n;this.#A.set(e,{id:e,controlId:s.controlId,value:r}),this.#B(),s.referencedVariables=i.size>0?Array.from(i):null})).catch((e=>{console.error(`Feedback check failed: ${JSON.stringify(s)} - ${e?.message??e} ${e?.stack}`)})).finally((()=>{this.#L=void 0,this.#M.delete(e);let t=!1;if(s.referencedVariables)for(const e of s.referencedVariables)if(i.changedVariables.has(e)){t=!0;break}(t||i.needsRecheck)&&setImmediate((()=>{this.#D(e)}))}))}#B=(0,r.default)((()=>{const e=this.#A;this.#A=new Map,e.size>0&&this.#T({values:Array.from(e.values())})}),{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#N.clear();for(const[n,s]of Object.entries(e))s&&(t.push({id:n,name:s.name,description:s.description,options:(0,i.serializeIsVisibleFn)(s.options),type:s.type,defaultStyle:"boolean"===s.type?s.defaultStyle:void 0,hasLearn:!!s.learn,learnTimeout:s.learnTimeout,showInvert:"boolean"===s.type&&s.showInvert}),this.#N.set(n,s));this.#P({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,n]of this.#R.entries())this.#N.get(n.feedbackId)&&(0===t.size||t.has(n.feedbackId))&&this.#D(e)}checkFeedbacksById(e){for(const t of e)this.#D(t)}_getAllFeedbacks(){return Array.from(this.#R.values()).map((e=>({id:e.id,feedbackId:e.feedbackId,controlId:e.controlId,options:e.options})))}subscribeFeedbacks(e){let t=Array.from(this.#R.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.feedbackId))));for(const e of t){const t=this.#N.get(e.feedbackId);if(t?.subscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.subscribe(o(t.type,e),n)).catch((t=>{this.#E("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeFeedbacks(e){let t=Array.from(this.#R.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.feedbackId))));for(const e of t){const t=this.#N.get(e.feedbackId);if(t&&t.unsubscribe){const n={parseVariablesInString:async t=>(await this.#I({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(o(t.type,e),n)).catch((t=>{this.#E("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},1706:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=void 0;const s=n(360);function i(e){return JSON.parse(JSON.stringify(e))}t.runThroughUpgradeScripts=function(e,t,n,r,o,a){const c=new Map,l=e=>{let t=c.get(e);return t||(t={actions:[],feedbacks:[],config:!1},c.set(e,t)),t};for(const t of Object.values(e)){const e=t?.upgradeIndex??n;t&&"number"==typeof e&&l(e).actions.push(t.id)}for(const e of Object.values(t)){const t=e?.upgradeIndex??n;e&&"number"==typeof t&&l(t).feedbacks.push(e.id)}if(!a)for(let e=n??-1;e<r.length;e++)l(e).config=!0;const u={},d={};let h;if(c.size>0){const a=Array.from(c.keys()).sort(),l=Math.min(...a,n??-1)+1,p=[],f=[],b=r.length;for(let n=l;n<b;n++){const a=c.get(n-1);a&&(p.push(...a.actions),f.push(...a.feedbacks));const l=!!a?.config;if(!l&&0===p.length&&0===f.length)continue;const b=h??o,g=(0,r[n])({currentConfig:i(b)},{config:l?b:null,actions:p.map((t=>{const n=e[t];if(n)return(0,s.literal)({id:n.id,controlId:n.controlId,actionId:n.actionId,options:void 0!==n.options?i(n.options):{}})})).filter((e=>!!e)),feedbacks:f.map((e=>{const n=t[e];if(n)return(0,s.literal)({id:n.id,controlId:n.controlId,feedbackId:n.feedbackId,options:void 0!==n.options?i(n.options):{},isInverted:n.isInverted})})).filter((e=>!!e))});l&&g.updatedConfig&&(h=g.updatedConfig);for(const t of g.updatedActions)if(t){const n=e[t.id];n&&(n.actionId=t.actionId,n.options=t.options,d[t.id]=n)}for(const e of g.updatedFeedbacks)if(e){const n=t[e.id];n&&(n.feedbackId=e.feedbackId,n.options=e.options,u[e.id]={...n,style:u[e.id]?.style??e.style,isInverted:e.isInverted??!1})}}for(const[t,n]of Object.entries(e))d[t]||"number"!=typeof n?.upgradeIndex||(d[t]=n);for(const[e,n]of Object.entries(t))u[e]||"number"!=typeof n?.upgradeIndex||(u[e]=n)}return{updatedActions:d,updatedFeedbacks:u,updatedConfig:h}}},9077:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=void 0;const s=n(1635).__importDefault(n(7281));t.validateManifest=function(e){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'");if(!(0,s.default)(e)){const e=s.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}}},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1649:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const s=n(1635),i=n(360),r=s.__importDefault(n(3290)),o=n(2593),a=n(1706),c=n(8039),l=n(4044),u=n(4289),d=n(2365);t.InstanceBase=class{#V;#j;id;#F=new r.default({concurrency:1});#$=!1;#U=!1;#H={};#q;#G;#W=new Map;#z=new Map;#Y=new Map;#n;#J;get instanceOptions(){return this.#n}get label(){return this.#J}constructor(e){if(!(0,o.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#n={disableVariableValidation:!1},this.#V=new l.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:this._handleVariablesChanged.bind(this),sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},(e=>{process.send(e)}),5e3),process.on("message",(e=>{this.#V.receivedMessage(e)})),this.#q=new u.ActionManager((async e=>this.#V.sendWithCb("parseVariablesInString",e)),(e=>this.#V.sendWithNoCb("setActionDefinitions",e)),this.log.bind(this)),this.#G=new c.FeedbackManager((async e=>this.#V.sendWithCb("parseVariablesInString",e)),(e=>this.#V.sendWithNoCb("updateFeedbackValues",e)),(e=>this.#V.sendWithNoCb("setFeedbackDefinitions",e)),this.log.bind(this)),this.#j=e.upgradeScripts,this.id=e.id,this.#J=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#F.add((async()=>{if(this.#$)throw new Error("Already initialized");const t=e.actions,n=e.feedbacks;if(this.#H=e.config,this.#J=e.label,e.isFirstInit){const t={},n=this.getConfigFields();for(const e of n)"default"in e&&(t[e.id]=e.default);this.#H=t,this.saveConfig(this.#H),e.lastUpgradeIndex=this.#j.length-1}const{updatedActions:s,updatedFeedbacks:i,updatedConfig:r}=(0,a.runThroughUpgradeScripts)(t,n,e.lastUpgradeIndex,this.#j,this.#H,!1);this.#H=r??this.#H;const o=this.#V.sendWithCb("upgradedItems",{updatedActions:s,updatedFeedbacks:i});try{await this.init(this.#H,!!e.isFirstInit),this.#$=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}finally{await o}return setImmediate((()=>{this._handleUpdateActions({actions:t},!0).catch((e=>{this.log("error",`Receive actions failed: ${e}`)})),this._handleUpdateFeedbacks({feedbacks:n},!0).catch((e=>{this.log("error",`Receive feedbacks failed: ${e}`)}))})),{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#j.length-1,updatedConfig:this.#H}}))}async _handleDestroy(){await this.#F.add((async()=>{if(!this.#$)throw new Error("Not initialized");await this.destroy(),this.#$=!1}))}async _handleConfigUpdateAndLabel(e){await this.#F.add((async()=>{if(!this.#$)throw new Error("Not initialized");this.#J=e.label,this.#H=e.config,await this.configUpdated(this.#H)}))}async _handleExecuteAction(e){return this.#q.handleExecuteAction(e)}async _handleUpdateFeedbacks(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)({},e.feedbacks,null,this.#j,this.#H,!0);this.#V.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded feedbacks: ${e}`)}))}this.#G.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)(e.actions,{},null,this.#j,this.#H,!0);this.#V.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded actions: ${e}`)}))}this.#q.handleUpdateActions(e.actions)}async _handleGetConfigFields(e){return{fields:(0,o.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#q.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#G.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#U)return}else if(!this.#U)return;if(!this.handleStartStopRecordActions)throw this.#U=!1,new Error("Recording actions is not supported by this module!");this.#U=e.recording,this.handleStartStopRecordActions(this.#U)}async _handleVariablesChanged(e){this.#G.handleVariablesChanged(e)}async _handleSharedUdpSocketMessage(e){for(const t of this.#W.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#W.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e){this.#H=e,this.#V.sendWithNoCb("saveConfig",{config:e})}setActionDefinitions(e){this.#q.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#G.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[n,s]of Object.entries(e))s&&t.push({...s,id:n});this.#V.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],n=[];this.#z.clear();for(const s of e)t.push({id:s.variableId,name:s.name}),this.#z.set(s.variableId,s),this.#Y.has(s.variableId)||(this.#Y.set(s.variableId,""),n.push({id:s.variableId,value:""}));if(!this.#n.disableVariableValidation){const e=new Set(this.#z.keys());for(const t of this.#Y.keys())e.has(t)||(this.#Y.delete(t),n.push({id:t,value:void 0}))}this.#V.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:n})}setVariableValues(e){const t=[];for(const[n,s]of Object.entries(e))this.#n.disableVariableValidation?(void 0===s?this.#Y.delete(n):this.#Y.set(n,s),t.push({id:n,value:s})):this.#z.has(n)?(this.#Y.set(n,s??""),t.push({id:n,value:s??""})):t.push({id:n,value:void 0});this.#V.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#Y.get(e)}async parseVariablesInString(e){const t=this.#G.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),(await this.#V.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text}checkFeedbacks(...e){this.#G.checkFeedbacks(e)}checkFeedbacksById(...e){this.#G.checkFeedbacksById(e)}_getAllActions(){return this.#q._getAllActions()}subscribeActions(...e){this.#q.subscribeActions(e)}unsubscribeActions(...e){this.#q.unsubscribeActions(e)}_getAllFeedbacks(){return this.#G._getAllFeedbacks()}subscribeFeedbacks(...e){this.#G.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#G.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#U)throw new Error("Not currently recording actions");this.#V.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}setCustomVariableValue(e,t){this.#V.sendWithNoCb("setCustomVariable",{customVariableId:e,value:t})}oscSend(e,t,n,s){this.#V.sendWithNoCb("send-osc",(0,i.literal)({host:e,port:t,path:n,args:s}))}updateStatus(e,t){this.#V.sendWithNoCb("set-status",(0,i.literal)({status:e,message:t??null}))}log(e,t){this.#V.sendWithNoCb("log-message",(0,i.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const n="string"==typeof e?{type:e}:e,s=new d.SharedUdpSocketImpl(this.#V,this.#W,n);return t&&s.on("message",t),s}}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1400:(e,t)=>{"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(n||(t.InstanceStatus=n={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(s||(t.Regex=s={}))},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2018:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1635);s.__exportStar(n(3730),t),s.__exportStar(n(1649),t),s.__exportStar(n(7386),t),s.__exportStar(n(1400),t),s.__exportStar(n(8983),t),s.__exportStar(n(8104),t),s.__exportStar(n(3258),t),s.__exportStar(n(131),t),s.__exportStar(n(3371),t),s.__exportStar(n(9786),t),s.__exportStar(n(6132),t)},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2365:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const s=n(1635).__importDefault(n(228)),i=n(360);class r extends s.default{#V;#K;#n;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#b&&"object"==typeof this.#b?this.#b:void 0}#b="pending";constructor(e,t,n){super(),this.#V=e,this.#K=t,this.#n={...n}}bind(e,t,n){if(this.#b&&"object"==typeof this.#b)throw new Error("Socket is already bound");switch(this.#b){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,i.assertNever)(this.#b),new Error("Invalid socket state")}this.#b="binding",n&&this.on("listening",n),this.#V.sendWithCb("sharedUdpSocketJoin",{family:this.#n.type,portNumber:e}).then((t=>{this.#b={portNumber:e,handleId:t},this.#K.set(t,this),this.emit("listening")}),(e=>{this.#b="closed",this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}close(e){if(this.#b&&"object"==typeof this.#b);else switch(this.#b){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,i.assertNever)(this.#b),new Error("Invalid socket state")}const t=this.#b.handleId;this.#b="closed",e&&this.on("close",e),this.#V.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then((()=>{this.#K.delete(t),this.emit("close")}),(e=>{this.#K.delete(t),this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}send(e,t,n,s,i,r){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof n){if("number"!=typeof s||"string"!=typeof i)throw new Error("Invalid arguments");if(void 0!==r&&"number"!=typeof r)throw new Error("Invalid arguments");const o=this.#Q(e,t,n);this.#X(o,s,i,r)}else{if("string"!=typeof n)throw new Error("Invalid arguments");{if(void 0!==s&&"function"!=typeof s)throw new Error("Invalid arguments");const i=this.#Q(e,0,void 0);this.#X(i,t,n,s)}}}#Q(e,t,n){let s;if("string"==typeof e)s=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))s=e;else{if(Array.isArray(e))return Buffer.from(e);s=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return s.subarray(t,void 0!==n?n+t:void 0)}#X(e,t,n,s){if(!this.#b||"object"!=typeof this.#b)throw new Error("Socket is not open");this.#V.sendWithCb("sharedUdpSocketSend",{handleId:this.#b.handleId,message:e,address:n,port:t}).then((()=>{s?.()}),(e=>{this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#b="fatalError";const t=this.boundState;t&&this.#K.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=r},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=t.CreateConvertToBooleanFeedbackUpgradeScript=t.EmptyUpgradeScript=void 0,t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}),t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,n)=>{const s=[];for(const t of n.feedbacks){let n=e[t.feedbackId];if(!0===n&&(n={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),n){t.style||(t.style={});for(const[e,i]of Object.entries(n))void 0!==t.options[e]&&(t.style[i]=t.options[e],delete t.options[e],s.push(t))}}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:s}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,n)=>{const s=[];for(const t of n.feedbacks){const n=e[t.feedbackId];if("string"!=typeof n)continue;const i=t.options[n];void 0!==i&&(delete t.options[n],t.isInverted="true"===i||!0===i||Number(i)>0,s.push(t))}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:s}}}},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},360:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.assertNever=t.literal=void 0;const s=n(6284);function i(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,s.colord)(e).isValid()){const t=(0,s.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,n,s){let i=(255&e)<<16|(255&t)<<8|255&n;return s&&s>=0&&s<1&&(i+=16777216*Math.round(255*(1-s))),i},t.splitRgb=i,t.splitHsl=function(e){const t=i(e);return(0,s.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=i(e);return(0,s.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=i(e);return(0,s.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()}},7281:(e,t,n)=>{"use strict";e.exports=c,e.exports.default=c;const s={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"}},required:["name"]}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18"},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}},additionalProperties:!1}},additionalProperties:!1,required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1}}},i={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1},r=Object.prototype.hasOwnProperty,o=n(7169).A,a=new RegExp("","u");function c(e,{instancePath:t="",parentData:n,parentDataProperty:l,rootData:u=e}={}){let d=null,h=0;if(0===h){if(!e||"object"!=typeof e||Array.isArray(e))return c.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let n;if(void 0===e.id&&(n="id")||void 0===e.name&&(n="name")||void 0===e.shortname&&(n="shortname")||void 0===e.description&&(n="description")||void 0===e.version&&(n="version")||void 0===e.license&&(n="license")||void 0===e.repository&&(n="repository")||void 0===e.bugs&&(n="bugs")||void 0===e.maintainers&&(n="maintainers")||void 0===e.legacyIds&&(n="legacyIds")||void 0===e.runtime&&(n="runtime")||void 0===e.manufacturer&&(n="manufacturer")||void 0===e.products&&(n="products")||void 0===e.keywords&&(n="keywords"))return c.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"}],!1;{const n=h;for(const n in e)if(!r.call(s.properties,n))return c.errors=[{instancePath:t,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"}],!1;if(n===h){if(void 0!==e.$schema){const n=h;if("string"!=typeof e.$schema)return c.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var p=n===h}else p=!0;if(p){if(void 0!==e.id){const n=h;if("string"!=typeof e.id)return c.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.name){const n=h;if("string"!=typeof e.name)return c.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.shortname){const n=h;if("string"!=typeof e.shortname)return c.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.description){const n=h;if("string"!=typeof e.description)return c.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.version){const n=h;if("string"!=typeof e.version)return c.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.license){const n=h;if("string"!=typeof e.license)return c.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.repository){const n=h;if("string"!=typeof e.repository)return c.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.bugs){const n=h;if("string"!=typeof e.bugs)return c.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.maintainers){let n=e.maintainers;const s=h;if(h===s){if(!Array.isArray(n))return c.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var f=!0;const e=n.length;for(let s=0;s<e;s++){let e=n[s];const i=h;if(h===i){if(!e||"object"!=typeof e||Array.isArray(e))return c.errors=[{instancePath:t+"/maintainers/"+s,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let n;if(void 0===e.name&&(n="name"))return c.errors=[{instancePath:t+"/maintainers/"+s,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"}],!1;if(void 0!==e.name){const n=h;if("string"!=typeof e.name)return c.errors=[{instancePath:t+"/maintainers/"+s+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var b=n===h}else b=!0;if(b){if(void 0!==e.email){const n=h;if("string"!=typeof e.email)return c.errors=[{instancePath:t+"/maintainers/"+s+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=n===h}else b=!0;if(b)if(void 0!==e.github){const n=h;if("string"!=typeof e.github)return c.errors=[{instancePath:t+"/maintainers/"+s+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=n===h}else b=!0}}}if(!(f=i===h))break}if(f){let e,s=n.length;if(s>1)for(;s--;)for(e=s;e--;)if(o(n[s],n[e]))return c.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"}],!1}}}p=s===h}else p=!0;if(p){if(void 0!==e.legacyIds){let n=e.legacyIds;const s=h;if(h===s){if(!Array.isArray(n))return c.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var g=!0;const e=n.length;for(let s=0;s<e;s++){const e=h;if("string"!=typeof n[s])return c.errors=[{instancePath:t+"/legacyIds/"+s,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(g=e===h))break}if(g){let e,s=n.length;if(s>1){const i={};for(;s--;){let r=n[s];if("string"==typeof r){if("number"==typeof i[r])return e=i[r],c.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"}],!1;i[r]=s}}}}}}p=s===h}else p=!0;if(p){if(void 0!==e.runtime){let n=e.runtime;const i=h;if(h===i){if(!n||"object"!=typeof n||Array.isArray(n))return c.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===n.type&&(e="type")||void 0===n.api&&(e="api")||void 0===n.apiVersion&&(e="apiVersion")||void 0===n.entrypoint&&(e="entrypoint"))return c.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==n.type){const e=h;if("string"!=typeof n.type)return c.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var m=e===h}else m=!0;if(m){if(void 0!==n.api){let e=n.api;const i=h;if("string"!=typeof e)return c.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return c.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:s.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;m=i===h}else m=!0;if(m){if(void 0!==n.apiVersion){const e=h;if("string"!=typeof n.apiVersion)return c.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=e===h}else m=!0;if(m)if(void 0!==n.entrypoint){const e=h;if("string"!=typeof n.entrypoint)return c.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;m=e===h}else m=!0}}}}p=i===h}else p=!0;if(p){if(void 0!==e.manufacturer){const n=h;if("string"!=typeof e.manufacturer)return c.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=n===h}else p=!0;if(p){if(void 0!==e.products){let n=e.products;const s=h;if(h===s){if(!Array.isArray(n))return c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(n.length<1)return c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var y=!0;const e=n.length;for(let s=0;s<e;s++){const e=h;if("string"!=typeof n[s])return c.errors=[{instancePath:t+"/products/"+s,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(y=e===h))break}if(y){let e,s=n.length;if(s>1){const i={};for(;s--;){let r=n[s];if("string"==typeof r){if("number"==typeof i[r])return e=i[r],c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"}],!1;i[r]=s}}}}}}p=s===h}else p=!0;if(p){if(void 0!==e.keywords){let n=e.keywords;const s=h;if(h===s){if(!Array.isArray(n))return c.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var v=!0;const e=n.length;for(let s=0;s<e;s++){const e=h;if("string"!=typeof n[s])return c.errors=[{instancePath:t+"/keywords/"+s,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(v=e===h))break}if(v){let e,s=n.length;if(s>1){const i={};for(;s--;){let r=n[s];if("string"==typeof r){if("number"==typeof i[r])return e=i[r],c.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"}],!1;i[r]=s}}}}}}p=s===h}else p=!0;if(p)if(void 0!==e.bonjourQueries){let n=e.bonjourQueries;const s=h;if(h===s){if(!n||"object"!=typeof n||Array.isArray(n))return c.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const e=h;for(const e in n)if(!a.test(e))return c.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"}],!1;if(e===h)for(const e in n)if(a.test(e)){let s=n[e];const r=h,o=h;let l=!1,u=null;const p=h;if(h==h)if(s&&"object"==typeof s&&!Array.isArray(s)){let n;if(void 0===s.type&&(n="type")||void 0===s.protocol&&(n="protocol")){const s={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"};null===d?d=[s]:d.push(s),h++}else{const n=h;for(const n in s)if("type"!==n&&"protocol"!==n&&"txt"!==n){const s={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"};null===d?d=[s]:d.push(s),h++;break}if(n===h){if(void 0!==s.type){const n=h;if("string"!=typeof s.type){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),h++}var _=n===h}else _=!0;if(_){if(void 0!==s.protocol){let n=s.protocol;const r=h;if("string"!=typeof n){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),h++}if("tcp"!==n&&"udp"!==n){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===d?d=[n]:d.push(n),h++}_=r===h}else _=!0;if(_)if(void 0!==s.txt){let n=s.txt;const i=h;if(h===i)if(n&&"object"==typeof n&&!Array.isArray(n)){const s=h;for(const s in n)if(!a.test(s)){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:s},message:"must NOT have additional properties"};null===d?d=[n]:d.push(n),h++;break}if(s===h)for(const s in n)if(a.test(s)){const i=h;if("string"!=typeof n[s]){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+s.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),h++}if(i!==h)break}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[n]:d.push(n),h++}_=i===h}else _=!0}}}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[n]:d.push(n),h++}p===h&&(l=!0,u=0);const f=h;if(h===f)if(Array.isArray(s)){const n=s.length;for(let r=0;r<n;r++){let n=s[r];const o=h;if(h==h)if(n&&"object"==typeof n&&!Array.isArray(n)){let s;if(void 0===n.type&&(s="type")||void 0===n.protocol&&(s="protocol")){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:s},message:"must have required property '"+s+"'"};null===d?d=[n]:d.push(n),h++}else{const s=h;for(const s in n)if("type"!==s&&"protocol"!==s&&"txt"!==s){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r,schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:s},message:"must NOT have additional properties"};null===d?d=[n]:d.push(n),h++;break}if(s===h){if(void 0!==n.type){const s=h;if("string"!=typeof n.type){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),h++}var x=s===h}else x=!0;if(x){if(void 0!==n.protocol){let s=n.protocol;const o=h;if("string"!=typeof s){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[n]:d.push(n),h++}if("tcp"!==s&&"udp"!==s){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===d?d=[n]:d.push(n),h++}x=o===h}else x=!0;if(x)if(void 0!==n.txt){let s=n.txt;const i=h;if(h===i)if(s&&"object"==typeof s&&!Array.isArray(s)){const n=h;for(const n in s)if(!a.test(n)){const s={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"};null===d?d=[s]:d.push(s),h++;break}if(n===h)for(const n in s)if(a.test(n)){const i=h;if("string"!=typeof s[n]){const s={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r+"/txt/"+n.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===d?d=[s]:d.push(s),h++}if(i!==h)break}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[n]:d.push(n),h++}x=i===h}else x=!0}}}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+r,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===d?d=[n]:d.push(n),h++}if(o!==h)break}}else{const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===d?d=[n]:d.push(n),h++}var S;if((S=f===h)&&l?(l=!1,u=[u,1]):S&&(l=!0,u=1),!l){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:u},message:"must match exactly one schema in oneOf"};return null===d?d=[n]:d.push(n),h++,c.errors=d,!1}if(h=o,null!==d&&(o?d.length=o:d=null),r!==h)break}}}p=s===h}else p=!0}}}}}}}}}}}}}}}}}}return c.errors=d,0===h}},7e3:(e,t,n)=>{"use strict";const s=n(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:n=0,maxWait:i=0,before:r=!1,after:o=!0}=t;if(!r&&!o)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let a,c,l;const u=function(...t){const s=this,u=r&&!a;return clearTimeout(a),a=setTimeout((()=>{a=void 0,c&&(clearTimeout(c),c=void 0),o&&(l=e.apply(s,t))}),n),i>0&&!c&&o&&(c=setTimeout((()=>{c=void 0,a&&(clearTimeout(a),a=void 0),l=e.apply(s,t)}),i)),u&&(l=e.apply(s,t)),l};return s(u,e),u.cancel=()=>{a&&(clearTimeout(a),a=void 0),c&&(clearTimeout(c),c=void 0)},u}},8661:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=void 0,t.encode=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){let t={},n=e.split("&");for(let e=0,s=n.length;e<s;e++){let s=n[e].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},1015:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;const n=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,s=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.parse=function(e){if(e.length>2e3)throw"URI too long";const t=e,i=e.indexOf("["),r=e.indexOf("]");-1!=i&&-1!=r&&(e=e.substring(0,i)+e.substring(i,r).replace(/:/g,";")+e.substring(r,e.length));let o=n.exec(e||""),a={},c=14;for(;c--;)a[s[c]]=o[c]||"";return-1!=i&&-1!=r&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){const n=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1),"/"==t.slice(-1)&&n.splice(n.length-1,1),n}(0,a.path),a.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,s){t&&(n[t]=s)})),n}(0,a.query),a}},732:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yeast=t.decode=t.encode=void 0;const n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s={};let i,r=0,o=0;function a(e){let t="";do{t=n[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}for(t.encode=a,t.decode=function(e){let t=0;for(o=0;o<e.length;o++)t=64*t+s[e.charAt(o)];return t},t.yeast=function(){const e=a(+new Date);return e!==i?(r=0,i=e):e+"."+a(r++)};o<64;o++)s[n[o]]=o},3517:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThisShim=void 0,t.globalThisShim=global},4956:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextTick=t.parse=t.installTimerFunctions=t.transports=t.TransportError=t.Transport=t.protocol=t.Socket=void 0;const s=n(8223);Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return s.Socket}}),t.protocol=s.Socket.protocol;var i=n(4689);Object.defineProperty(t,"Transport",{enumerable:!0,get:function(){return i.Transport}}),Object.defineProperty(t,"TransportError",{enumerable:!0,get:function(){return i.TransportError}});var r=n(9419);Object.defineProperty(t,"transports",{enumerable:!0,get:function(){return r.transports}});var o=n(5374);Object.defineProperty(t,"installTimerFunctions",{enumerable:!0,get:function(){return o.installTimerFunctions}});var a=n(1015);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return a.parse}});var c=n(3449);Object.defineProperty(t,"nextTick",{enumerable:!0,get:function(){return c.nextTick}})},8223:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;const i=n(9419),r=n(5374),o=n(8661),a=n(1015),c=s(n(5753)),l=n(4454),u=n(6376),d=n(3449),h=(0,c.default)("engine.io-client:socket");class p extends l.Emitter{constructor(e,t={}){super(),this.binaryType=d.defaultBinaryType,this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=(0,a.parse)(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=(0,a.parse)(t.host).host),(0,r.installTimerFunctions)(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=(0,o.decode)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){h('creating transport "%s"',e);const t=Object.assign({},this.opts.query);t.EIO=u.protocol,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return h("options: %j",n),new i.transports[e](n)}open(){let e;if(this.opts.rememberUpgrade&&p.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return h("error while creating transport: %s",e),this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){h("setting transport %s",e.name),this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){h('probing transport "%s"',e);let t=this.createTransport(e),n=!1;p.priorWebsocketSuccess=!1;const s=()=>{n||(h('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(s=>{if(!n)if("pong"===s.type&&"probe"===s.data){if(h('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;p.priorWebsocketSuccess="websocket"===t.name,h('pausing current transport "%s"',this.transport.name),this.transport.pause((()=>{n||"closed"!==this.readyState&&(h("changing transport and sending upgrade packet"),l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{h('probe transport "%s" failed',e);const n=new Error("probe error");n.transport=t.name,this.emitReserved("upgradeError",n)}})))};function i(){n||(n=!0,l(),t.close(),t=null)}const r=n=>{const s=new Error("probe error: "+n);s.transport=t.name,i(),h('probe transport "%s" failed because of error: %s',e,n),this.emitReserved("upgradeError",s)};function o(){r("transport closed")}function a(){r("socket closed")}function c(e){t&&e.name!==t.name&&(h('"%s" works - aborting "%s"',e.name,t.name),i())}const l=()=>{t.removeListener("open",s),t.removeListener("error",r),t.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};t.once("open",s),t.once("error",r),t.once("close",o),this.once("close",a),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{n||t.open()}),200):t.open()}onOpen(){if(h("socket open"),this.readyState="open",p.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){h("starting upgrade probes");let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(h('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}else h('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();h("flushing %d packets in socket",e.length),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const n=this.writeBuffer[t].data;if(n&&(e+=(0,r.byteLength)(n)),t>0&&e>this.maxPayload)return h("only send %d out of %d packets",t,this.writeBuffer.length),this.writeBuffer.slice(0,t);e+=2}return h("payload size is %d (max: %d)",e,this.maxPayload),this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,s){if("function"==typeof t&&(s=t,t=void 0),"function"==typeof n&&(s=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){const e=()=>{this.onClose("forced close"),h("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}onError(e){h("socket error %j",e),p.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(h('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const s=e.length;for(;n<s;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}t.Socket=p,p.protocol=u.protocol},4689:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=t.TransportError=void 0;const i=n(6376),r=n(4454),o=n(5374),a=s(n(5753)),c=n(8661),l=(0,a.default)("engine.io-client:transport");class u extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}t.TransportError=u;class d extends r.Emitter{constructor(e){super(),this.writable=!1,(0,o.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new u(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):l("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=(0,i.decodePacket)(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=(0,c.encode)(e);return t.length?"?"+t:""}}t.Transport=d},9419:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transports=void 0;const s=n(528),i=n(8716),r=n(4480);t.transports={websocket:i.WS,webtransport:r.WT,polling:s.Polling}},528:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.Polling=void 0;const i=n(4689),r=s(n(5753)),o=n(732),a=n(6376),c=n(8849),l=n(4454),u=n(5374),d=n(3517),h=(0,r.default)("engine.io-client:polling");function p(){}const f=null!=new c.XHR({xdomain:!1}).responseType;class b extends i.Transport{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port}const t=e&&e.forceBase64;this.supportsBinary=f&&!t,this.opts.withCredentials&&(this.cookieJar=(0,c.createCookieJar)())}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{h("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(h("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){h("pre-pause polling complete"),--e||t()}))),this.writable||(h("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){h("pre-pause writing complete"),--e||t()})))}else t()}poll(){h("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){h("polling got data %s",e),(0,a.decodePayload)(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this.poll():h('ignoring poll - transport state "%s"',this.readyState))}doClose(){const e=()=>{h("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(h("transport open - closing"),e()):(h("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,(0,a.encodePayload)(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,o.yeast)()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new g(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){h("xhr poll");const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}t.Polling=b;class g extends l.Emitter{constructor(e,t){super(),(0,u.installTimerFunctions)(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=(0,u.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const n=this.xhr=new c.XHR(t);try{h("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof n.status?n.status:0)}),0))},h("xhr data %s",this.data),n.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=g.requestsCount++,g.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=p,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete g.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(t.Request=g,g.requestsCount=0,g.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",m);else if("function"==typeof addEventListener){const e="onpagehide"in d.globalThisShim?"pagehide":"unload";addEventListener(e,m,!1)}function m(){for(let e in g.requests)g.requests.hasOwnProperty(e)&&g.requests[e].abort()}},3449:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.nextTick=t.defaultBinaryType=t.usingBrowserWebSocket=t.WebSocket=void 0;const i=s(n(7699));t.WebSocket=i.default,t.usingBrowserWebSocket=!1,t.defaultBinaryType="nodebuffer",t.nextTick=process.nextTick},8716:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WS=void 0;const i=n(4689),r=n(732),o=n(5374),a=n(3449),c=s(n(5753)),l=n(6376),u=(0,c.default)("engine.io-client:websocket"),d="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class h extends i.Transport{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=d?{}:(0,o.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=a.usingBrowserWebSocket&&!d?t?new a.WebSocket(e,t):new a.WebSocket(e):new a.WebSocket(e,t,n)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],s=t===e.length-1;(0,l.encodePacket)(n,this.supportsBinary,(e=>{const t={};!a.usingBrowserWebSocket&&(n.options&&(t.compress=n.options.compress),this.opts.perMessageDeflate)&&("string"==typeof e?Buffer.byteLength(e):e.length)<this.opts.perMessageDeflate.threshold&&(t.compress=!1);try{a.usingBrowserWebSocket?this.ws.send(e):this.ws.send(e,t)}catch(e){u("websocket closed before onclose event")}s&&(0,a.nextTick)((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,r.yeast)()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!a.WebSocket}}t.WS=h},4480:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WT=void 0;const i=n(4689),r=n(3449),o=n(6376),a=(0,s(n(5753)).default)("engine.io-client:webtransport");class c extends i.Transport{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{a("transport closed gracefully"),this.onClose()})).catch((e=>{a("transport closed due to %s",e),this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=(0,o.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),s=(0,o.createPacketEncoderStream)();s.readable.pipeTo(e.writable),this.writer=s.writable.getWriter();const i=()=>{n.read().then((({done:e,value:t})=>{e?a("session is closed"):(a("received chunk: %o",t),this.onPacket(t),i())})).catch((e=>{a("an error occurred while reading: %s",e)}))};i();const r={type:"open"};this.query.sid&&(r.data=`{"sid":"${this.query.sid}"}`),this.writer.write(r).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],s=t===e.length-1;this.writer.write(n).then((()=>{s&&(0,r.nextTick)((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}}t.WT=c},8849:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CookieJar=t.parse=t.createCookieJar=t.XHR=void 0;const o=r(n(5480));function a(e){const t=e.split("; "),n=t[0].indexOf("=");if(-1===n)return;const s=t[0].substring(0,n).trim();if(!s.length)return;let i=t[0].substring(n+1).trim();34===i.charCodeAt(0)&&(i=i.slice(1,-1));const r={name:s,value:i};for(let e=1;e<t.length;e++){const n=t[e].split("=");if(2!==n.length)continue;const s=n[0].trim(),i=n[1].trim();switch(s){case"Expires":r.expires=new Date(i);break;case"Max-Age":const e=new Date;e.setUTCSeconds(e.getUTCSeconds()+parseInt(i,10)),r.expires=e}}return r}t.XHR=o.default||o,t.createCookieJar=function(){return new c},t.parse=a;class c{constructor(){this.cookies=new Map}parseCookies(e){const t=e.getResponseHeader("set-cookie");t&&t.forEach((e=>{const t=a(e);t&&this.cookies.set(t.name,t)}))}addCookies(e){const t=[];this.cookies.forEach(((e,n)=>{var s;(null===(s=e.expires)||void 0===s?void 0:s.getTime())<Date.now()?this.cookies.delete(n):t.push(`${n}=${e.value}`)})),t.length&&(e.setDisableHeaderCheck(!0),e.setRequestHeader("cookie",t.join("; ")))}}t.CookieJar=c},5374:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.byteLength=t.installTimerFunctions=t.pick=void 0;const s=n(3517);t.pick=function(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})};const i=s.globalThisShim.setTimeout,r=s.globalThisShim.clearTimeout;t.installTimerFunctions=function(e,t){t.useNativeTimers?(e.setTimeoutFn=i.bind(s.globalThisShim),e.clearTimeoutFn=r.bind(s.globalThisShim)):(e.setTimeoutFn=s.globalThisShim.setTimeout.bind(s.globalThisShim),e.clearTimeoutFn=s.globalThisShim.clearTimeout.bind(s.globalThisShim))},t.byteLength=function(e){return"string"==typeof e?function(e){let t=0,n=0;for(let s=0,i=e.length;s<i;s++)t=e.charCodeAt(s),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(s++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))}},2046:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERROR_PACKET=t.PACKET_TYPES_REVERSE=t.PACKET_TYPES=void 0;const n=Object.create(null);t.PACKET_TYPES=n,n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";const s=Object.create(null);t.PACKET_TYPES_REVERSE=s,Object.keys(n).forEach((e=>{s[n[e]]=e})),t.ERROR_PACKET={type:"error",data:"parser error"}},7696:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodePacket=void 0;const s=n(2046);t.decodePacket=(e,t)=>{if("string"!=typeof e)return{type:"message",data:i(e,t)};const n=e.charAt(0);if("b"===n){const n=Buffer.from(e.substring(1),"base64");return{type:"message",data:i(n,t)}}return s.PACKET_TYPES_REVERSE[n]?e.length>1?{type:s.PACKET_TYPES_REVERSE[n],data:e.substring(1)}:{type:s.PACKET_TYPES_REVERSE[n]}:s.ERROR_PACKET};const i=(e,t)=>"arraybuffer"===t?e instanceof ArrayBuffer?e:Buffer.isBuffer(e)?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):e.buffer:Buffer.isBuffer(e)?e:Buffer.from(e)},3944:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodePacket=void 0,t.encodePacketToBinary=function(e,n){if(e.data instanceof ArrayBuffer||ArrayBuffer.isView(e.data))return n(i(e.data,!1));(0,t.encodePacket)(e,!0,(e=>{r||(r=new TextEncoder),n(r.encode(e))}))};const s=n(2046);t.encodePacket=({type:e,data:t},n,r)=>t instanceof ArrayBuffer||ArrayBuffer.isView(t)?r(n?t:"b"+i(t,!0).toString("base64")):r(s.PACKET_TYPES[e]+(t||""));const i=(e,t)=>Buffer.isBuffer(e)||e instanceof Uint8Array&&!t?e:e instanceof ArrayBuffer?Buffer.from(e):Buffer.from(e.buffer,e.byteOffset,e.byteLength);let r},6376:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodePayload=t.decodePacket=t.encodePayload=t.encodePacket=t.protocol=void 0,t.createPacketEncoderStream=function(){return new TransformStream({transform(e,t){(0,s.encodePacketToBinary)(e,(n=>{const s=n.length;let i;if(s<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,s);else if(s<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,s)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(s))}e.data&&"string"!=typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(n)}))}})},t.createPacketDecoderStream=function(e,t){a||(a=new TextDecoder);const n=[];let s=0,o=-1,u=!1;return new TransformStream({transform(d,h){for(n.push(d);;){if(0===s){if(c(n)<1)break;const e=l(n,1);u=!(128&~e[0]),o=127&e[0],s=o<126?3:126===o?1:2}else if(1===s){if(c(n)<2)break;const e=l(n,2);o=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),s=3}else if(2===s){if(c(n)<8)break;const e=l(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),i=t.getUint32(0);if(i>Math.pow(2,21)-1){h.enqueue(r.ERROR_PACKET);break}o=i*Math.pow(2,32)+t.getUint32(4),s=3}else{if(c(n)<o)break;const e=l(n,o);h.enqueue((0,i.decodePacket)(u?e:a.decode(e),t)),s=0}if(0===o||o>e){h.enqueue(r.ERROR_PACKET);break}}}})};const s=n(3944);Object.defineProperty(t,"encodePacket",{enumerable:!0,get:function(){return s.encodePacket}});const i=n(7696);Object.defineProperty(t,"decodePacket",{enumerable:!0,get:function(){return i.decodePacket}});const r=n(2046),o=String.fromCharCode(30);let a;function c(e){return e.reduce(((e,t)=>e+t.length),0)}function l(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let s=0;for(let i=0;i<t;i++)n[i]=e[0][s++],s===e[0].length&&(e.shift(),s=0);return e.length&&s<e[0].length&&(e[0]=e[0].slice(s)),n}t.encodePayload=(e,t)=>{const n=e.length,i=new Array(n);let r=0;e.forEach(((e,a)=>{(0,s.encodePacket)(e,!1,(e=>{i[a]=e,++r===n&&t(i.join(o))}))}))},t.decodePayload=(e,t)=>{const n=e.split(o),s=[];for(let e=0;e<n.length;e++){const r=(0,i.decodePacket)(n[e],t);if(s.push(r),"error"===r.type)break}return s},t.protocol=4},7743:(e,t)=>{"use strict";function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Object.defineProperty(t,"__esModule",{value:!0}),t.Backoff=void 0,t.Backoff=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=1&Math.floor(10*t)?e+n:e-n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},8007:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.connect=t.io=t.Socket=t.Manager=t.protocol=void 0;const i=n(6894),r=n(3776);Object.defineProperty(t,"Manager",{enumerable:!0,get:function(){return r.Manager}});const o=n(6214);Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return o.Socket}});const a=s(n(5753)).default("socket.io-client"),c={};function l(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};const n=i.url(e,t.path||"/socket.io"),s=n.source,o=n.id,l=n.path,u=c[o]&&l in c[o].nsps;let d;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(a("ignoring socket cache for %s",s),d=new r.Manager(s,t)):(c[o]||(a("new io instance for %s",s),c[o]=new r.Manager(s,t)),d=c[o]),n.query&&!t.query&&(t.query=n.queryKey),d.socket(n.path,t)}t.io=l,t.connect=l,t.default=l,Object.assign(l,{Manager:r.Manager,Socket:o.Socket,io:l,connect:l});var u=n(4627);Object.defineProperty(t,"protocol",{enumerable:!0,get:function(){return u.protocol}}),e.exports=l},3776:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;const a=n(4956),c=n(6214),l=r(n(4627)),u=n(5942),d=n(7743),h=n(4454),p=o(n(5753)).default("socket.io-client:manager");class f extends h.Emitter{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,a.installTimerFunctions(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new d.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const s=t.parser||l;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(p("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=new a.Socket(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=u.on(t,"open",(function(){n.onopen(),e&&e()})),i=t=>{p("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},r=u.on(t,"error",i);if(!1!==this._timeout){const e=this._timeout;p("connect attempt will timeout after %d",e);const n=this.setTimeoutFn((()=>{p("connect attempt timed out after %d",e),s(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(s),this.subs.push(r),this}connect(e){return this.open(e)}onopen(){p("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(u.on(e,"ping",this.onping.bind(this)),u.on(e,"data",this.ondata.bind(this)),u.on(e,"error",this.onerror.bind(this)),u.on(e,"close",this.onclose.bind(this)),u.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){a.nextTick((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){p("error",e),this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new c.Socket(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t)if(this.nsps[e].active)return void p("socket %s is still active, skipping close",e);this._close()}_packet(e){p("writing packet %j",e);const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){p("cleanup"),this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){p("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){p("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();p("will wait %dms before reconnect attempt",t),this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(p("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(p("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):(p("reconnect success"),e.onreconnect())})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}t.Manager=f},5942:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.on=void 0,t.on=function(e,t,n){return e.on(t,n),function(){e.off(t,n)}}},6214:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;const i=n(4627),r=n(5942),o=n(4454),a=s(n(5753)).default("socket.io-client:socket"),c=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class l extends o.Emitter{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[r.on(e,"open",this.onopen.bind(this)),r.on(e,"packet",this.onpacket.bind(this)),r.on(e,"error",this.onerror.bind(this)),r.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(c.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:i.PacketType.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++;a("emitting packet with ack id %d",e);const s=t.pop();this._registerAckCallback(e,s),n.id=e}const s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||s&&this.connected?this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n):a("discard packet as the transport is not currently writable"),this.flags={},this}_registerAckCallback(e,t){var n;const s=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===s)return void(this.acks[e]=t);const i=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&(a("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(t,1));a("event with ack id %d has timed out after %d ms",e,s),t.call(this,new Error("operation has timed out"))}),s),r=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,e)};r.withError=!0,this.acks[e]=r}emitWithAck(e,...t){return new Promise(((n,s)=>{const i=(e,t)=>e?s(e):n(t);i.withError=!0,t.push(i),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...s)=>{if(n===this._queue[0])return null!==e?n.tryCount>this._opts.retries&&(a("packet [%d] is discarded after %d tries",n.id,n.tryCount),this._queue.shift(),t&&t(e)):(a("packet [%d] was successfully sent",n.id),this._queue.shift(),t&&t(null,...s)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(a("draining queue"),!this.connected||0===this._queue.length)return;const t=this._queue[0];!t.pending||e?(t.pending=!0,t.tryCount++,a("sending packet [%d] (try n°%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)):a("packet [%d] has already been sent and is waiting for an ack",t.id)}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){a("transport is open - connecting"),"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:i.PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){a("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((e=>{if(!this.sendBuffer.some((t=>String(t.id)===e))){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}}))}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case i.PacketType.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case i.PacketType.EVENT:case i.PacketType.BINARY_EVENT:this.onevent(e);break;case i.PacketType.ACK:case i.PacketType.BINARY_ACK:this.onack(e);break;case i.PacketType.DISCONNECT:this.ondisconnect();break;case i.PacketType.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];a("emitting event %j",t),null!=e.id&&(a("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...s){n||(n=!0,a("sending ack %j",s),t.packet({type:i.PacketType.ACK,id:e,data:s}))}}onack(e){const t=this.acks[e.id];"function"==typeof t?(delete this.acks[e.id],a("calling ack %s with %j",e.id,e.data),t.withError&&e.data.unshift(null),t.apply(this,e.data)):a("bad ack %s",e.id)}onconnect(e,t){a("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){a("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(a("performing disconnect (%s)",this.nsp),this.packet({type:i.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}t.Socket=l},6894:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.url=void 0;const i=n(4956),r=s(n(5753)).default("socket.io-client:url");t.url=function(e,t="",n){let s=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(r("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),r("parse %s",e),s=i.parse(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const o=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+o+":"+s.port+t,s.href=s.protocol+"://"+o+(n&&n.port===s.port?"":":"+s.port),s}},4926:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reconstructPacket=t.deconstructPacket=void 0;const s=n(9133);function i(e,t){if(!e)return e;if((0,s.isBinary)(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=i(e[s],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=i(e[s],t));return n}return e}function r(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=r(e[n],t);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=r(e[n],t));return e}t.deconstructPacket=function(e){const t=[],n=e.data,s=e;return s.data=i(n,t),s.attachments=t.length,{packet:s,buffers:t}},t.reconstructPacket=function(e,t){return e.data=r(e.data,t),delete e.attachments,e}},4627:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Decoder=t.Encoder=t.PacketType=t.protocol=void 0;const s=n(4454),i=n(4926),r=n(9133),o=(0,n(5753).default)("socket.io-parser"),a=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var c;function l(e){return"[object Object]"===Object.prototype.toString.call(e)}t.protocol=5,function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(c=t.PacketType||(t.PacketType={})),t.Encoder=class{constructor(e){this.replacer=e}encode(e){return o("encoding packet %j",e),e.type!==c.EVENT&&e.type!==c.ACK||!(0,r.hasBinary)(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===c.EVENT?c.BINARY_EVENT:c.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==c.BINARY_EVENT&&e.type!==c.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),o("encoded %j as %s",e,t),t}encodeAsBinary(e){const t=(0,i.deconstructPacket)(e),n=this.encodeAsString(t.packet),s=t.buffers;return s.unshift(n),s}};class u extends s.Emitter{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===c.BINARY_EVENT;n||t.type===c.BINARY_ACK?(t.type=n?c.EVENT:c.ACK,this.reconstructor=new d(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!(0,r.isBinary)(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===c[n.type])throw new Error("unknown packet type "+n.type);if(n.type===c.BINARY_EVENT||n.type===c.BINARY_ACK){const s=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(s,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const s=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);n.nsp=e.substring(s,t)}else n.nsp="/";const s=e.charAt(t+1);if(""!==s&&Number(s)==s){const s=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(!u.isPayloadValid(n.type,s))throw new Error("invalid payload");n.data=s}return o("decoded %s as %j",e,n),n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case c.CONNECT:return l(t);case c.DISCONNECT:return void 0===t;case c.CONNECT_ERROR:return"string"==typeof t||l(t);case c.EVENT:case c.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===a.indexOf(t[0]));case c.ACK:case c.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}t.Decoder=u;class d{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=(0,i.reconstructPacket)(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},9133:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasBinary=t.isBinary=void 0;const n="function"==typeof ArrayBuffer,s=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),r="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);function o(e){return n&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||i&&e instanceof Blob||r&&e instanceof File}t.isBinary=o,t.hasBinary=function e(t,n){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let n=0,s=t.length;n<s;n++)if(e(t[n]))return!0;return!1}if(o(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return!0;return!1}},4454:(e,t,n)=>{"use strict";function s(e){if(e)return function(e){for(var t in s.prototype)e[t]=s.prototype[t];return e}(e)}n.r(t),n.d(t,{Emitter:()=>s}),s.prototype.on=s.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},s.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},s.prototype.off=s.prototype.removeListener=s.prototype.removeAllListeners=s.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,s=this._callbacks["$"+e];if(!s)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<s.length;i++)if((n=s[i])===t||n.fn===t){s.splice(i,1);break}return 0===s.length&&delete this._callbacks["$"+e],this},s.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(n){s=0;for(var i=(n=n.slice(0)).length;s<i;++s)n[s].apply(this,t)}return this},s.prototype.emitReserved=s.prototype.emit,s.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},s.prototype.hasListeners=function(e){return!!this.listeners(e).length}},1635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>M,__assign:()=>r,__asyncDelegator:()=>w,__asyncGenerator:()=>I,__asyncValues:()=>E,__await:()=>k,__awaiter:()=>f,__classPrivateFieldGet:()=>N,__classPrivateFieldIn:()=>A,__classPrivateFieldSet:()=>R,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>D,__esDecorate:()=>l,__exportStar:()=>m,__extends:()=>i,__generator:()=>b,__importDefault:()=>P,__importStar:()=>T,__makeTemplateObject:()=>O,__metadata:()=>p,__param:()=>c,__propKey:()=>d,__read:()=>v,__rest:()=>o,__runInitializers:()=>u,__setFunctionName:()=>h,__spread:()=>_,__spreadArray:()=>S,__spreadArrays:()=>x,__values:()=>y,default:()=>B});var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},s(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}function a(e,t,n,s){var i,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t){return function(n,s){t(n,s,e)}}function l(e,t,n,s,i,r){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=s.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?s.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,s.name):{}),h=!1,p=n.length-1;p>=0;p--){var f={};for(var b in s)f[b]="access"===b?{}:s[b];for(var b in s.access)f.access[b]=s.access[b];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");r.push(o(e||null))};var g=(0,n[p])("accessor"===c?{get:d.get,set:d.set}:d[l],f);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=o(g.get))&&(d.get=a),(a=o(g.set))&&(d.set=a),(a=o(g.init))&&i.unshift(a)}else(a=o(g))&&("field"===c?i.unshift(a):d[l]=a)}u&&Object.defineProperty(u,s.name,d),h=!0}function u(e,t,n){for(var s=arguments.length>2,i=0;i<t.length;i++)n=s?t[i].call(e,n):t[i].call(e);return s?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((s=s.apply(e,t||[])).next())}))}function b(e,t){var n,s,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(r=0)),r;)try{if(n=1,s&&(i=2&a[0]?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],s=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g=Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]};function m(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var s,i,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=r.next()).done;)o.push(s.value)}catch(e){i={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function x(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var s=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,a=r.length;o<a;o++,i++)s[i]=r[o];return s}function S(e,t,n){if(n||2===arguments.length)for(var s,i=0,r=t.length;i<r;i++)!s&&i in t||(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return e.concat(s||Array.prototype.slice.call(t))}function k(e){return this instanceof k?(this.v=e,this):new k(e)}function I(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=n.apply(e,t||[]),r=[];return s=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",(function(e){return function(t){return Promise.resolve(t).then(e,l)}})),s[Symbol.asyncIterator]=function(){return this},s;function o(e,t){i[e]&&(s[e]=function(t){return new Promise((function(n,s){r.push([e,t,n,s])>1||a(e,t)}))},t&&(s[e]=t(s[e])))}function a(e,t){try{(n=i[e](t)).value instanceof k?Promise.resolve(n.value.v).then(c,l):u(r[0][2],n)}catch(e){u(r[0][3],e)}var n}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}function w(e){var t,n;return t={},s("next"),s("throw",(function(e){throw e})),s("return"),t[Symbol.iterator]=function(){return this},t;function s(s,i){t[s]=e[s]?function(t){return(n=!n)?{value:k(e[s](t)),done:!1}:i?i(t):t}:i}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=y(e),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(n){t[n]=e[n]&&function(t){return new Promise((function(s,i){!function(e,t,n,s){Promise.resolve(s).then((function(t){e({value:t,done:n})}),t)}(s,i,(t=e[n](t)).done,t.value)}))}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var C=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return C(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function N(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)}function R(e,t,n,s,i){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?i.call(e,n):i?i.value=n:t.set(e,n),n}function A(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function M(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var s,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(void 0===s){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],n&&(i=s)}if("function"!=typeof s)throw new TypeError("Object not disposable.");i&&(s=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:s,async:n})}else n&&e.stack.push({async:!0});return t}var L="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var s=new Error(n);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function D(e){function t(t){e.error=e.hasError?new L(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var n,s=0;return function i(){for(;n=e.stack.pop();)try{if(!n.async&&1===s)return s=0,e.stack.push(n),Promise.resolve().then(i);if(n.dispose){var r=n.dispose.call(n.value);if(n.async)return s|=2,Promise.resolve(r).then(i,(function(e){return t(e),i()}))}else s|=1}catch(e){t(e)}if(1===s)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}const B={__extends:i,__assign:r,__rest:o,__decorate:a,__param:c,__metadata:p,__awaiter:f,__generator:b,__createBinding:g,__exportStar:m,__values:y,__read:v,__spread:_,__spreadArrays:x,__spreadArray:S,__await:k,__asyncGenerator:I,__asyncDelegator:w,__asyncValues:E,__makeTemplateObject:O,__importStar:T,__importDefault:P,__classPrivateFieldGet:N,__classPrivateFieldSet:R,__classPrivateFieldIn:A,__addDisposableResource:M,__disposeResources:D}},1356:e=>{"use strict";e.exports=JSON.parse('{"name":"Generic Controller","description":"For a generic controller, the buttons are unknown, so they will be labeled generically. Button 0 on the controller will be referred to as Button 0 in the module, etc."}')},3562:e=>{"use strict";e.exports=JSON.parse('{"name":"PS4 Controller","description":"Standard PS4 Controller Mapping.","buttons":[{"buttonIndex":0,"buttonType":"button","buttonId":"cross","buttonName":"Cross","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":1,"buttonId":"circle","buttonType":"button","buttonName":"Circle","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":2,"buttonId":"square","buttonType":"button","buttonName":"Square","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":3,"buttonId":"triangle","buttonType":"button","buttonName":"Triangle","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":4,"buttonId":"l1","buttonType":"button","buttonName":"Left 1 - Button","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":5,"buttonId":"r1","buttonType":"button","buttonName":"Right 1 - Button","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":6,"buttonId":"l2","buttonType":"trigger","buttonName":"Left 2 - Trigger","hapticType":"trigger-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":7,"buttonId":"r2","buttonName":"Right 2 - Trigger","buttonType":"trigger","hapticType":"trigger-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":8,"buttonId":"share","buttonType":"button","buttonName":"Share"},{"buttonIndex":9,"buttonId":"options","buttonType":"button","buttonName":"Options"},{"buttonIndex":10,"buttonId":"l3","buttonType":"button","buttonName":"Left 3 - Stick Button"},{"buttonIndex":11,"buttonId":"r3","buttonType":"button","buttonName":"Right 3 - Stick Button"},{"buttonIndex":12,"buttonId":"up","buttonType":"button","buttonName":"Up"},{"buttonIndex":13,"buttonId":"down","buttonType":"button","buttonName":"Down"},{"buttonIndex":14,"buttonId":"left","buttonType":"button","buttonName":"Left"},{"buttonIndex":15,"buttonId":"right","buttonType":"button","buttonName":"Right"},{"buttonIndex":16,"buttonId":"ps","buttonType":"button","buttonName":"PS Button"},{"buttonIndex":17,"buttonId":"touchpad","buttonType":"button","buttonName":"Touchpad"}],"axes":[{"axisIndex":0,"axisId":"lsx","axisName":"Left Stick X","axisType":"x","axisInverted":false},{"axisIndex":1,"axisId":"lsy","axisName":"Left Stick Y","axisType":"y","axisInverted":false},{"axisIndex":2,"axisId":"rsx","axisName":"Right Stick X","axisType":"x","axisInverted":false},{"axisIndex":3,"axisId":"rsy","axisName":"Right Stick Y","axisType":"y","axisInverted":false}]}')},1157:e=>{"use strict";e.exports=JSON.parse('{"name":"XBox 360 Controller","description":"Standard XBox 360 Controller Mapping.","buttons":[{"buttonIndex":0,"buttonId":"a","buttonType":"button","buttonName":"A","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":1,"buttonId":"b","buttonType":"button","buttonName":"B","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":2,"buttonId":"x","buttonType":"button","buttonName":"X","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":3,"buttonId":"y","buttonType":"button","buttonName":"Y","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":4,"buttonId":"lb","buttonType":"button","buttonName":"Left Button","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":5,"buttonId":"rb","buttonType":"button","buttonName":"Right Button","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":6,"buttonId":"lt","buttonType":"trigger","buttonName":"Left Trigger","hapticType":"trigger-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":7,"buttonId":"rt","buttonType":"trigger","buttonName":"Right Trigger","hapticType":"trigger-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":8,"buttonId":"select","buttonType":"button","buttonName":"Select"},{"buttonIndex":9,"buttonId":"start","buttonType":"button","buttonName":"Start"},{"buttonIndex":10,"buttonId":"ls","buttonType":"button","buttonName":"Left Stick"},{"buttonIndex":11,"buttonId":"rs","buttonType":"button","buttonName":"Right Stick"},{"buttonIndex":12,"buttonId":"up","buttonType":"button","buttonName":"Up"},{"buttonIndex":13,"buttonId":"down","buttonType":"button","buttonName":"Down"},{"buttonIndex":14,"buttonId":"left","buttonType":"button","buttonName":"Left"},{"buttonIndex":15,"buttonId":"right","buttonType":"button","buttonName":"Right"},{"buttonIndex":16,"buttonId":"xbox","buttonType":"button","buttonName":"XBox Button"}],"axes":[{"axisIndex":0,"axisId":"lsx","axisName":"Left Stick X","axisType":"x","axisInverted":false},{"axisIndex":1,"axisId":"lsy","axisName":"Left Stick Y","axisType":"y","axisInverted":false},{"axisIndex":2,"axisId":"rsx","axisName":"Right Stick X","axisType":"x","axisInverted":false},{"axisIndex":3,"axisId":"rsy","axisName":"Right Stick Y","axisType":"y","axisInverted":false}]}')},9978:e=>{"use strict";e.exports=JSON.parse('{"name":"XBox One Controller","description":"Standard XBox One Controller Mapping.","buttons":[{"buttonIndex":0,"buttonId":"a","buttonType":"button","buttonName":"A","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":1,"buttonId":"b","buttonType":"button","buttonName":"B","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":2,"buttonId":"x","buttonType":"button","buttonName":"X","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":3,"buttonId":"y","buttonType":"button","buttonName":"Y","hapticType":"dual-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":4,"buttonId":"lb","buttonType":"button","buttonName":"Left Button"},{"buttonIndex":5,"buttonId":"rb","buttonType":"button","buttonName":"Right Button"},{"buttonIndex":6,"buttonId":"lt","buttonType":"trigger","buttonName":"Left Trigger","hapticType":"trigger-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":7,"buttonId":"rt","buttonType":"trigger","buttonName":"Right Trigger","hapticType":"trigger-rumble","hapticParams":{"duration":0.1,"startDelay":0,"strongMagnitude":1,"weakMagnitude":0.5}},{"buttonIndex":8,"buttonId":"select","buttonType":"button","buttonName":"Select"},{"buttonIndex":9,"buttonId":"start","buttonType":"button","buttonName":"Start"},{"buttonIndex":10,"buttonId":"ls","buttonType":"button","buttonName":"Left Stick"},{"buttonIndex":11,"buttonId":"rs","buttonType":"button","buttonName":"Right Stick"},{"buttonIndex":12,"buttonId":"up","buttonType":"button","buttonName":"Up"},{"buttonIndex":13,"buttonId":"down","buttonType":"button","buttonName":"Down"},{"buttonIndex":14,"buttonId":"left","buttonType":"button","buttonName":"Left"},{"buttonIndex":15,"buttonId":"right","buttonType":"button","buttonName":"Right"},{"buttonIndex":16,"buttonId":"xbox","buttonType":"button","buttonName":"XBox Button"}],"axes":[{"axisIndex":0,"axisId":"lsx","axisName":"Left Stick X","axisType":"x","axisInverted":false},{"axisIndex":1,"axisId":"lsy","axisName":"Left Stick Y","axisType":"y","axisInverted":false},{"axisIndex":2,"axisId":"rsx","axisName":"Right Stick X","axisType":"x","axisInverted":false},{"axisIndex":3,"axisId":"rsy","axisName":"Right Stick Y","axisType":"y","axisInverted":false}]}')}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const{InstanceBase:s,InstanceStatus:r,runEntrypoint:o}=n(6278),a=n(3487),c=n(8384),l=n(9367),u=n(8404),d=n(7969),h=n(1632),p=n(5521),f=n(4963),b=n(6672),g=n(799);o(class extends s{constructor(e){super(e),Object.assign(this,{...c,...l,...u,...d,...h,...p,...f,...b,...g}),this.STATUS={information:"",version:"",controlStatus:!1,controllers:[]},this.receiveBuffer=""}async destroy(){this.config.useAsSurface&&(this.CompanionSatellite_Close(),this.CONTROLLER_SURFACE_UUID=void 0),this.CONNECTED=!1,this.CONTROLLER=void 0,this.STATUS={information:"",version:"",controllers:[]},this.LAST_BUTTON_PRESSED=-1,this.DEBOUNCE_TIMER=void 0,this.MAPPING={axes:[],buttons:[]},this.RECONNECT_INTERVAL=void 0,this.LOCKED=!1,this.receiveBuffer=""}async init(e){this.updateStatus(r.Connecting),this.configUpdated(e)}async configUpdated(e){this.config=e,this.config.verbose&&this.log("info","Verbose mode enabled. Log entries will contain detailed information."),this.updateStatus(r.Connecting),this.initConnection(),this.initActions(),this.initFeedbacks(),this.initVariables(),this.initPresets(),this.checkFeedbacks(),this.checkVariables()}},a)})();