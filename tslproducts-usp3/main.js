/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={131(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},181(e){"use strict";e.exports=require("buffer")},228(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||e,s),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var u,c,l=this._events[a],p=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),p){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,s),!0}for(c=1,u=new Array(p-1);c<p;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),p){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,i);break;default:if(!u)for(h=1,u=new Array(p-1);h<p;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==t||i&&!a[u].once||n&&a[u].context!==n)&&c.push(a[u]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},360(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,r,n){let i=(255&e)<<16|(255&t)<<8|255&r;return n&&n>=0&&n<1&&(i+=16777216*Math.round(255*(1-n))),i},t.splitRgb=i,t.splitHsl=function(e){const t=i(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=i(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=i(e);return(0,n.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()},t.parseEscapeCharacters=function(e){return e.replaceAll("\\n","\n").replaceAll("\\r","\r").replaceAll("\\t","\t").replaceAll("\\f","\f").replaceAll("\\v","\v").replaceAll("\\b","\b").replaceAll("\\\\","\\").replaceAll("\\x00","\0").replaceAll("\\x01","").replaceAll("\\x02","").replaceAll("\\x03","")},t.substituteEscapeCharacters=function(e){return e.replaceAll("\n","\\n").replaceAll("\r","\\r").replaceAll("\t","\\t").replaceAll("\f","\\f").replaceAll("\v","\\v").replaceAll("\b","\\b").replaceAll("\\","\\\\").replaceAll("\0","\\x00").replaceAll("","\\x01").replaceAll("","\\x02").replaceAll("","\\x03")};const n=r(6284);function i(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,n.colord)(e).isValid()){const t=(0,n.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}},382(e,t,r){(function(){var t,n={}.hasOwnProperty;t=r(6286),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,e),t.prototype.document=function(e,t){var r,n,i,o,s;for(t=this.filterOptions(t),o="",n=0,i=(s=e.children).length;n<i;n++)r=s[n],o+=this.writeChildNode(r,t,0);return t.pretty&&o.slice(-t.newline.length)===t.newline&&(o=o.slice(0,-t.newline.length)),o},t}(t)}).call(this)},400(e,t,r){(function(){var t,n,i,o,s,a,u,c,l,p,h,d,f,m,g,y,b,v,w,I,_,E,O,S={}.hasOwnProperty;O=r(9241),_=O.isObject,I=O.isFunction,E=O.isPlainObject,w=O.getValue,t=r(1737),d=r(1933),f=r(3906),o=r(2691),s=r(2679),g=r(1268),v=r(2535),m=r(5915),p=r(4130),h=r(6376),a=r(4111),c=r(5529),u=r(7696),l=r(8012),i=r(4238),b=r(3976),y=r(382),n=r(8753),e.exports=function(){function e(e,r,n){var i;this.name="?xml",this.type=t.Document,e||(e={}),i={},e.writer?E(e.writer)&&(i=e.writer,e.writer=new y):e.writer=new y,this.options=e,this.writer=e.writer,this.writerOptions=this.writer.filterOptions(i),this.stringify=new b(e),this.onDataCallback=r||function(){},this.onEndCallback=n||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return e.prototype.createChildNode=function(e){var r,n,i,o,s,a,u,c;switch(e.type){case t.CData:this.cdata(e.value);break;case t.Comment:this.comment(e.value);break;case t.Element:for(n in i={},u=e.attribs)S.call(u,n)&&(r=u[n],i[n]=r.value);this.node(e.name,i);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(e.value);break;case t.Text:this.text(e.value);break;case t.ProcessingInstruction:this.instruction(e.target,e.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+e.constructor.name)}for(s=0,a=(c=e.children).length;s<a;s++)o=c[s],this.createChildNode(o),o.type===t.Element&&this.up();return this},e.prototype.dummy=function(){return this},e.prototype.node=function(e,t,r){var n;if(null==e)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(e));return this.openCurrent(),e=w(e),null==t&&(t={}),t=w(t),_(t)||(r=(n=[t,r])[0],t=n[1]),this.currentNode=new f(this,e,t),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=r&&this.text(r),this},e.prototype.element=function(e,r,n){var i,o,s,a,u,c;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(e)||_(e)||I(e))for(a=this.options.noValidation,this.options.noValidation=!0,(c=new d(this.options).element("TEMP_ROOT")).element(e),this.options.noValidation=a,o=0,s=(u=c.children).length;o<s;o++)i=u[o],this.createChildNode(i),i.type===t.Element&&this.up();else this.node(e,r,n);return this},e.prototype.attribute=function(e,t){var r,n;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(e));if(null!=e&&(e=w(e)),_(e))for(r in e)S.call(e,r)&&(n=e[r],this.attribute(r,n));else I(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.currentNode.attribs[e]=new i(this,e,""):null!=t&&(this.currentNode.attribs[e]=new i(this,e,t));return this},e.prototype.text=function(e){var t;return this.openCurrent(),t=new v(this,e),this.onData(this.writer.text(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.cdata=function(e){var t;return this.openCurrent(),t=new o(this,e),this.onData(this.writer.cdata(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.comment=function(e){var t;return this.openCurrent(),t=new s(this,e),this.onData(this.writer.comment(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.raw=function(e){var t;return this.openCurrent(),t=new g(this,e),this.onData(this.writer.raw(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.instruction=function(e,t){var r,n,i,o,s;if(this.openCurrent(),null!=e&&(e=w(e)),null!=t&&(t=w(t)),Array.isArray(e))for(r=0,o=e.length;r<o;r++)n=e[r],this.instruction(n);else if(_(e))for(n in e)S.call(e,n)&&(i=e[n],this.instruction(n,i));else I(t)&&(t=t.apply()),s=new m(this,e,t),this.onData(this.writer.processingInstruction(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},e.prototype.declaration=function(e,t,r){var n;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return n=new p(this,e,t,r),this.onData(this.writer.declaration(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.doctype=function(e,t,r){if(this.openCurrent(),null==e)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new h(this,t,r),this.currentNode.rootNodeName=e,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},e.prototype.dtdElement=function(e,t){var r;return this.openCurrent(),r=new u(this,e,t),this.onData(this.writer.dtdElement(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.attList=function(e,t,r,n,i){var o;return this.openCurrent(),o=new a(this,e,t,r,n,i),this.onData(this.writer.dtdAttList(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.entity=function(e,t){var r;return this.openCurrent(),r=new c(this,!1,e,t),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.pEntity=function(e,t){var r;return this.openCurrent(),r=new c(this,!0,e,t),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.notation=function(e,t){var r;return this.openCurrent(),r=new l(this,e,t),this.onData(this.writer.dtdNotation(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},e.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},e.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},e.prototype.openNode=function(e){var r,i,o,s;if(!e.isOpen){if(this.root||0!==this.currentLevel||e.type!==t.Element||(this.root=e),i="",e.type===t.Element){for(o in this.writerOptions.state=n.OpenTag,i=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<"+e.name,s=e.attribs)S.call(s,o)&&(r=s[o],i+=this.writer.attribute(r,this.writerOptions,this.currentLevel));i+=(e.children?">":"/>")+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=n.InsideTag}else this.writerOptions.state=n.OpenTag,i=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+e.rootNodeName,e.pubID&&e.sysID?i+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(i+=' SYSTEM "'+e.sysID+'"'),e.children?(i+=" [",this.writerOptions.state=n.InsideTag):(this.writerOptions.state=n.CloseTag,i+=">"),i+=this.writer.endline(e,this.writerOptions,this.currentLevel);return this.onData(i,this.currentLevel),e.isOpen=!0}},e.prototype.closeNode=function(e){var r;if(!e.isClosed)return"",this.writerOptions.state=n.CloseTag,r=e.type===t.Element?this.writer.indent(e,this.writerOptions,this.currentLevel)+"</"+e.name+">"+this.writer.endline(e,this.writerOptions,this.currentLevel):this.writer.indent(e,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=n.None,this.onData(r,this.currentLevel),e.isClosed=!0},e.prototype.onData=function(e,t){return this.documentStarted=!0,this.onDataCallback(e,t+1)},e.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},e.prototype.debugInfo=function(e){return null==e?"":"node: <"+e+">"},e.prototype.ele=function(){return this.element.apply(this,arguments)},e.prototype.nod=function(e,t,r){return this.node(e,t,r)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.dec=function(e,t,r){return this.declaration(e,t,r)},e.prototype.dtd=function(e,t,r){return this.doctype(e,t,r)},e.prototype.e=function(e,t,r){return this.element(e,t,r)},e.prototype.n=function(e,t,r){return this.node(e,t,r)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.ent=function(e,t){return this.entity(e,t)},e.prototype.pent=function(e,t){return this.pEntity(e,t)},e.prototype.not=function(e,t){return this.notation(e,t)},e}()}).call(this)},468(e,t,r){(function(){var t,n,i,o,s,a,u,c,l,p,h,d,f,m,g,y,b,v={}.hasOwnProperty;b=r(9241),y=b.isObject,g=b.isFunction,m=b.isEmpty,f=b.getValue,c=null,i=null,o=null,s=null,a=null,h=null,d=null,p=null,u=null,n=null,l=null,t=null,e.exports=function(){function e(e){this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,c||(c=r(3906),i=r(2691),o=r(2679),s=r(4130),a=r(6376),h=r(1268),d=r(2535),p=r(5915),u=r(1218),n=r(1737),l=r(6684),r(4797),t=r(4923))}return Object.defineProperty(e.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new l(this.children)),this.childNodeList}}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e-1]||null}}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e+1]||null}}),Object.defineProperty(e.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(e.prototype,"textContent",{get:function(){var e,t,r,i,o;if(this.nodeType===n.Element||this.nodeType===n.DocumentFragment){for(o="",t=0,r=(i=this.children).length;t<r;t++)(e=i[t]).textContent&&(o+=e.textContent);return o}return null},set:function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),e.prototype.setParent=function(e){var t,r,n,i,o;for(this.parent=e,e&&(this.options=e.options,this.stringify=e.stringify),o=[],r=0,n=(i=this.children).length;r<n;r++)t=i[r],o.push(t.setParent(this));return o},e.prototype.element=function(e,t,r){var n,i,o,s,a,u,c,l,p,h,d;if(u=null,null===t&&null==r&&(t=(p=[{},null])[0],r=p[1]),null==t&&(t={}),t=f(t),y(t)||(r=(h=[t,r])[0],t=h[1]),null!=e&&(e=f(e)),Array.isArray(e))for(o=0,c=e.length;o<c;o++)i=e[o],u=this.element(i);else if(g(e))u=this.element(e.apply());else if(y(e)){for(a in e)if(v.call(e,a))if(d=e[a],g(d)&&(d=d.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))u=this.attribute(a.substr(this.stringify.convertAttKey.length),d);else if(!this.options.separateArrayItems&&Array.isArray(d)&&m(d))u=this.dummy();else if(y(d)&&m(d))u=this.element(a);else if(this.options.keepNullNodes||null!=d)if(!this.options.separateArrayItems&&Array.isArray(d))for(s=0,l=d.length;s<l;s++)i=d[s],(n={})[a]=i,u=this.element(n);else y(d)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?u=this.element(d):(u=this.element(a)).element(d):u=this.element(a,d);else u=this.dummy()}else u=this.options.keepNullNodes||null!==r?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===e.indexOf(this.stringify.convertTextKey)?this.text(r):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===e.indexOf(this.stringify.convertCDataKey)?this.cdata(r):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===e.indexOf(this.stringify.convertCommentKey)?this.comment(r):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===e.indexOf(this.stringify.convertRawKey)?this.raw(r):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===e.indexOf(this.stringify.convertPIKey)?this.instruction(e.substr(this.stringify.convertPIKey.length),r):this.node(e,t,r):this.dummy();if(null==u)throw new Error("Could not create any elements with: "+e+". "+this.debugInfo());return u},e.prototype.insertBefore=function(e,t,r){var n,i,o,s,a;if(null!=e?e.type:void 0)return s=t,(o=e).setParent(this),s?(i=children.indexOf(s),a=children.splice(i),children.push(o),Array.prototype.push.apply(children,a)):children.push(o),o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return i=this.parent.children.indexOf(this),a=this.parent.children.splice(i),n=this.parent.element(e,t,r),Array.prototype.push.apply(this.parent.children,a),n},e.prototype.insertAfter=function(e,t,r){var n,i,o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return i=this.parent.children.indexOf(this),o=this.parent.children.splice(i+1),n=this.parent.element(e,t,r),Array.prototype.push.apply(this.parent.children,o),n},e.prototype.remove=function(){var e;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return e=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[e,e-e+1].concat([])),this.parent},e.prototype.node=function(e,t,r){var n,i;return null!=e&&(e=f(e)),t||(t={}),t=f(t),y(t)||(r=(i=[t,r])[0],t=i[1]),n=new c(this,e,t),null!=r&&n.text(r),this.children.push(n),n},e.prototype.text=function(e){var t;return y(e)&&this.element(e),t=new d(this,e),this.children.push(t),this},e.prototype.cdata=function(e){var t;return t=new i(this,e),this.children.push(t),this},e.prototype.comment=function(e){var t;return t=new o(this,e),this.children.push(t),this},e.prototype.commentBefore=function(e){var t,r;return t=this.parent.children.indexOf(this),r=this.parent.children.splice(t),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,r),this},e.prototype.commentAfter=function(e){var t,r;return t=this.parent.children.indexOf(this),r=this.parent.children.splice(t+1),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,r),this},e.prototype.raw=function(e){var t;return t=new h(this,e),this.children.push(t),this},e.prototype.dummy=function(){return new u(this)},e.prototype.instruction=function(e,t){var r,n,i,o,s;if(null!=e&&(e=f(e)),null!=t&&(t=f(t)),Array.isArray(e))for(o=0,s=e.length;o<s;o++)r=e[o],this.instruction(r);else if(y(e))for(r in e)v.call(e,r)&&(n=e[r],this.instruction(r,n));else g(t)&&(t=t.apply()),i=new p(this,e,t),this.children.push(i);return this},e.prototype.instructionBefore=function(e,t){var r,n;return r=this.parent.children.indexOf(this),n=this.parent.children.splice(r),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,n),this},e.prototype.instructionAfter=function(e,t){var r,n;return r=this.parent.children.indexOf(this),n=this.parent.children.splice(r+1),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,n),this},e.prototype.declaration=function(e,t,r){var i,o;return i=this.document(),o=new s(i,e,t,r),0===i.children.length?i.children.unshift(o):i.children[0].type===n.Declaration?i.children[0]=o:i.children.unshift(o),i.root()||i},e.prototype.dtd=function(e,t){var r,i,o,s,u,c,l,p,h;for(r=this.document(),i=new a(r,e,t),o=s=0,c=(p=r.children).length;s<c;o=++s)if(p[o].type===n.DocType)return r.children[o]=i,i;for(o=u=0,l=(h=r.children).length;u<l;o=++u)if(h[o].isRoot)return r.children.splice(o,0,i),i;return r.children.push(i),i},e.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},e.prototype.root=function(){var e;for(e=this;e;){if(e.type===n.Document)return e.rootObject;if(e.isRoot)return e;e=e.parent}},e.prototype.document=function(){var e;for(e=this;e;){if(e.type===n.Document)return e;e=e.parent}},e.prototype.end=function(e){return this.document().end(e)},e.prototype.prev=function(){var e;if((e=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[e-1]},e.prototype.next=function(){var e;if(-1===(e=this.parent.children.indexOf(this))||e===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[e+1]},e.prototype.importDocument=function(e){var t;return(t=e.root().clone()).parent=this,t.isRoot=!1,this.children.push(t),this},e.prototype.debugInfo=function(e){var t,r;return null!=(e=e||this.name)||(null!=(t=this.parent)?t.name:void 0)?null==e?"parent: <"+this.parent.name+">":(null!=(r=this.parent)?r.name:void 0)?"node: <"+e+">, parent: <"+this.parent.name+">":"node: <"+e+">":""},e.prototype.ele=function(e,t,r){return this.element(e,t,r)},e.prototype.nod=function(e,t,r){return this.node(e,t,r)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.doc=function(){return this.document()},e.prototype.dec=function(e,t,r){return this.declaration(e,t,r)},e.prototype.e=function(e,t,r){return this.element(e,t,r)},e.prototype.n=function(e,t,r){return this.node(e,t,r)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.u=function(){return this.up()},e.prototype.importXMLBuilder=function(e){return this.importDocument(e)},e.prototype.replaceChild=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.removeChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.hasChildNodes=function(){return 0!==this.children.length},e.prototype.cloneNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isSupported=function(e,t){return!0},e.prototype.hasAttributes=function(){return 0!==this.attribs.length},e.prototype.compareDocumentPosition=function(e){var r,n;return(r=this)===e?0:this.document()!==e.document()?(n=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?n|=t.Preceding:n|=t.Following,n):r.isAncestor(e)?t.Contains|t.Preceding:r.isDescendant(e)?t.Contains|t.Following:r.isPreceding(e)?t.Preceding:t.Following},e.prototype.isSameNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupPrefix=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isDefaultNamespace=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupNamespaceURI=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(e){var t,r,n;if(e.nodeType!==this.nodeType)return!1;if(e.children.length!==this.children.length)return!1;for(t=r=0,n=this.children.length-1;0<=n?r<=n:r>=n;t=0<=n?++r:--r)if(!this.children[t].isEqualNode(e.children[t]))return!1;return!0},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.setUserData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.getUserData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.contains=function(e){return!!e&&(e===this||this.isDescendant(e))},e.prototype.isDescendant=function(e){var t,r,n,i;for(r=0,n=(i=this.children).length;r<n;r++){if(e===(t=i[r]))return!0;if(t.isDescendant(e))return!0}return!1},e.prototype.isAncestor=function(e){return e.isDescendant(this)},e.prototype.isPreceding=function(e){var t,r;return t=this.treePosition(e),r=this.treePosition(this),-1!==t&&-1!==r&&t<r},e.prototype.isFollowing=function(e){var t,r;return t=this.treePosition(e),r=this.treePosition(this),-1!==t&&-1!==r&&t>r},e.prototype.treePosition=function(e){var t,r;return r=0,t=!1,this.foreachTreeNode(this.document(),(function(n){if(r++,!t&&n===e)return t=!0})),t?r:-1},e.prototype.foreachTreeNode=function(e,t){var r,n,i,o,s;for(e||(e=this.document()),n=0,i=(o=e.children).length;n<i;n++){if(s=t(r=o[n]))return s;if(s=this.foreachTreeNode(r,t))return s}},e}()}).call(this)},736(e,t,r){"use strict";e.exports=function(e){function t(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){var r;function s(){if(s.enabled){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var o=s,a=Number(new Date),u=a-(r||a);o.diff=u,o.prev=r,o.curr=a,r=a,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return e;c++;var i=n.formatters[r];if("function"==typeof i){var s=t[c];e=i.call(o,s),t.splice(c,1),c--}return e})),n.formatArgs.call(o,t),(o.log||n.log).apply(o,t)}}return s.namespace=e,s.enabled=n.enabled(e),s.useColors=n.useColors(),s.color=t(e),s.destroy=i,s.extend=o,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function i(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function o(e,t){return n(this.namespace+(void 0===t?":":t)+e)}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var o=n.instances[t];o.enabled=n.enabled(o.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=r(8e3),Object.keys(e).forEach((function(t){n[t]=e[t]})),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}},857(e){"use strict";e.exports=require("os")},1084(e,t,r){const{InstanceStatus:n,TCPHelper:i}=r(6278),o=r(5879).K;e.exports={getClosestUSPColor(e){let t=this;function r(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,r,n){return t+t+r+r+n+n}));let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}return function(e){let n,i=Number.POSITIVE_INFINITY,o=0;return t.COLORS.forEach(((t,s)=>{var a,u;void 0!==t.hex&&(a=r(e),u=r(t.hex),n=Math.sqrt(Math.pow(a.r-u.r,2)+Math.pow(a.g-u.g,2)+Math.pow(a.b-u.b,2)),n<i&&(i=n,o=s))})),t.COLORS[o]}(e)},initUSP(){let e=this;""!==e.config.host_usp&&(1==e.config.auto_configure&&!0!==e.config.already_configured||1==e.config.rerun_configuration?e.autoConfigurePanel():(e.log("info","USP3 panel already configured, skipping auto-configuration."),e.initUSP_Connection()))},autoConfigurePanel:async function(){let e=this;e.log("info","Attempting to auto-configure USP3 panel...");let t="";try{let r=e.config.host_usp.split("."),i=r[0]+"."+r[1]+"."+r[2]+".",o=(await e.parseVariablesInString("$(internal:all_ip)")).split("\\n");for(let e=0;e<o.length;e++){let r=o[e];if(r.startsWith(i)){t=r;break}}if(""==t){for(let e=0;e<o.length;e++){let r=o[e];if(0==r.startsWith("0.0.0")&&0==r.startsWith("127.0.0")){t=r;break}}if(""==t)return e.log("error","Could not find a suitable IP for Companion to use as a satellite surface. Turn off Auto-Configure and manually configure the panel."),void e.updateStatus(n.ConnectionFailure);e.log("info","Using IP "+t+" for Companion while auto configuring the panel.")}}catch(t){return e.log("error","Error finding network interfaces: "+t),void e.updateStatus(n.Error)}e.log("info","Configuring Remote Device Assignment Page...");try{let r="";r+=`r${e.config.usp_device_id}c0=Bitfocus+Companion`,r+=`&r${e.config.usp_device_id}c1=14`,r+=`&r${e.config.usp_device_id}c5=${t}`,r+=`&r${e.config.usp_device_id}c7=4`;let n={data:r,headers:{"Content-Type":"application/x-www-form-urlencoded"}};(new o).post("http://"+e.config.host_usp+"/rd_list.htm",n,(function(t,r){e.log("info","Remote Device Assignment Page configured successfully! Now configuring Tally Assignment Page..."),e.autoConfigurePanelSwitches.bind(e)()})).on("error",(function(t){e.log("error","Error auto configuring USP3 panel: "+t)}))}catch(t){return e.log("error","Error configuring Remote Device Assignment Page: "+t),void e.updateStatus(n.Error)}},autoConfigurePanelSwitches:function(){let e=this;e.log("info","Configuring Tally Assignment Page...");try{let t="";for(let e=0;e<16;e++)""!==t&&(t+="&"),t+=`r${5*e}c1=2`,t+="&",t+=`r${5*e}c2=12`,t+="&",t+=`r${5*e}c4=0`;let r={data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}};(new o).post("http://"+e.config.host_usp+"/tally.htm",r,(function(t,r){e.config.already_configured=!0,e.saveConfig(e.config),e.log("info","USP3 panel auto-configured successfully!"),e.initUSP_Connection()})).on("error",(function(t){e.log("error","Error auto configuring USP panel: "+t)}))}catch(t){return e.log("error","Error configuring Tally Assignment Page: "+t),void e.updateStatus(n.Error)}},initUSP_Connection(){let e=this;try{void 0!==e.SOCKET_USP&&(e.SOCKET_USP.destroy(),delete e.SOCKET_USP),void 0===e.config.port_usp&&(e.config.port_usp=50001),e.config.host_usp&&(e.log("info",`Opening Connection to USP3: ${e.config.host_usp}:${e.config.port_usp}`),e.SOCKET_USP=new i(e.config.host_usp,e.config.port_usp),e.SOCKET_USP.on("error",(t=>{e.log("error","Network error with USP3: "+t.message),e.updateStatus(n.ConnectionFailure),clearInterval(e.USP_INTERVAL),e.SOCKET_USP.destroy(),e.SOCKET_USP,e.DATA.uspConnected=!1,e.checkVariables(),e.log("warn","Connection lost. Attempting to reconnect to USP3 in 5 seconds..."),setTimeout((()=>{e.updateStatus(n.Connecting,"Attempting to Reconnect to Panel..."),e.log("info","Attempting to reconnect to USP3."),e.initUSP_Connection()}),5e3)})),e.SOCKET_USP.on("connect",(()=>{e.log("info",`Connected to USP3 Panel at ${e.config.host_usp}:${e.config.port_usp}`),e.getUSPInformation(),e.initUSPPolling(),1==e.config.use_as_surface&&this.initCompanionSatellite(),e.updateStatus(n.Ok),e.DATA.uspConnected=!0,e.checkVariables()})),e.SOCKET_USP.on("data",(t=>{let r=t.toString("utf8");e.processUSPData(r)})),e.SOCKET_USP.on("close",(()=>{e.updateStatus(n.Warning,"Connection to USP3 lost"),e.DATA.uspConnected=!1,e.checkVariables(),clearInterval(e.USP_INTERVAL),setTimeout((()=>{e.initUSP_Connection()}),5e3)})))}catch(t){e.log("error","Error opening connection to USP3: "+t),e.updateStatus(n.Error)}},processUSPData(e){let t=this;t.log("debug","Received TCP Data from USP3: "+e);try{let r=e.split("\n");for(let e=0;e<r.length;e++)if(r[e].indexOf(",")>-1){let n=r[e].split(",");for(let e=0;e<n.length;e++)n[e].indexOf("COL")>-1?t.processUSP_COLData(n[e]):n[e].indexOf("KEY")>-1||n[e].indexOf("KYP")>-1?t.processUSP_KeyData(n[e]):n[e].indexOf("GPI")>-1?t.processUSP_GPIData(n[e]):n[e].indexOf("GPO")>-1?t.processUSP_GPOData(n[e]):n[e].indexOf("MEM")>-1?t.processUSP_MEMData(n[e]):console.log("Unknown USP3 response: "+n[e])}else r[e].indexOf("COL")>-1?t.processUSP_COLData(r[e]):r[e].indexOf("KEY")>-1||r[e].indexOf("KYP")>-1?t.processUSP_KeyData(r[e]):r[e].indexOf("GPI")>-1?t.processUSP_GPIData(r[e]):r[e].indexOf("GPO")>-1?t.processUSP_GPOData(r[e]):r[e].indexOf("MEM")>-1&&t.processUSP_MEMData(r[e])}catch(e){t.log("error","Error processing USP3 data: "+e.toString())}},processUSP_COLData(e){e.indexOf("ACK")>-1||e.indexOf("NAK")},processUSP_KeyData(e){let t=this;if(!(e.indexOf("ACK")>-1||e.indexOf("NAK")>-1))try{let r=e.substring(e.indexOf("_")+1,e.lastIndexOf(":")),n="1"==e[e.length-1],i={id:r,state:n},o=!1,s=!0;for(let e=0;e<t.DATA.keyStates.length;e++)if(t.DATA.keyStates[e].id==r){t.DATA.keyStates[e].state==n&&(s=!1),t.DATA.keyStates[e].state=n,o=!0;break}o||t.DATA.keyStates.push(i),t.config.use_as_surface&&s&&(r=parseInt(r)-1,t.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${t.DEVICE_ID} KEY=${r} PRESSED=${n}`)),t.checkVariables(),t.checkFeedbacks()}catch(e){t.log("error","Error processing USP3 Key Data: "+e)}},processUSP_GPIData(e){let t=this;if(!(e.indexOf("ACK")>-1||e.indexOf("NAK")>-1))try{let r=e.substring(e.indexOf("_")+1,e.lastIndexOf(":")),n="1"==e[e.length-1],i={id:r,state:n},o=!1;for(let e=0;e<t.DATA.gpiStates.length;e++)if(t.DATA.gpiStates[e].id==r){t.DATA.gpiStates[e].state=n,o=!0;break}o||t.DATA.gpiStates.push(i),t.checkVariables(),t.checkFeedbacks()}catch(e){t.log("error","Error processing USP3 GPI Data: "+e)}},processUSP_GPOData(e){let t=this;if(!(e.indexOf("ACK")>-1))if(e.indexOf("NAK")>-1)t.log("error","Error setting GPO state.");else try{let r=e.substring(e.indexOf("_")+1,e.lastIndexOf(":")),n="1"==e[e.length-1],i={id:r,state:n},o=!1;for(let e=0;e<t.DATA.gpoStates.length;e++)if(t.DATA.gpoStates[e].id==r){t.DATA.gpoStates[e].state=n,o=!0;break}o||t.DATA.gpoStates.push(i),t.checkVariables(),t.checkFeedbacks()}catch(e){t.log("error","Error processing USP3 GPO Data: "+e)}},processUSP_MEMData(e){let t=this;if(!(e.indexOf("ACK")>-1||e.indexOf("NAK")>-1))try{let r=e.substring(e.indexOf("_")+1,e.lastIndexOf(":")),n="1"==e[e.length-1],i={id:r,state:n},o=!1;for(let e=0;e<t.DATA.memStates.length;e++)if(t.DATA.memStates[e].id==r){t.DATA.memStates[e].state=n,o=!0;break}o||t.DATA.memStates.push(i),t.checkVariables(),t.checkFeedbacks()}catch(e){t.log("error","Error processing USP3 MEM Data: "+e)}},sendUSPCommand(e){let t=this;try{void 0!==t.config.host_usp&&""!==t.config.host_usp&&void 0!==t.config.port_usp&&""!==t.config.port_usp&&(void 0!==t.SOCKET_USP&&t.SOCKET_USP.isConnected?(t.config.verbose&&t.log("debug","Sending Command to USP3: "+e),t.SOCKET_USP.send(Buffer.from(e+"\n"))):t.config.verbose&&t.log("debug","TCP Socket to USP3 not open."))}catch(e){t.log("error","Error sending command to USP3: "+e)}},getUSPInformation(){let e=this;e.SOCKET_USP.isConnected&&(e.sendUSPCommand("KEY?"),e.sendUSPCommand("GPI?"),e.sendUSPCommand("GPS?"))},initUSPPolling(){let e=this;void 0!==e.USP_INTERVAL&&(clearInterval(e.USP_INTERVAL),delete e.USP_INTERVAL),(e.config.polling||1==e.config.use_as_surface)&&(e.config.poll_interval=5e3,e.USP_INTERVAL=setInterval((()=>{e.getUSPInformation()}),e.config.poll_interval))}}},1118(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const n=r(1635).__importDefault(r(228)),i=r(2203),o=r(8895);class s extends n.default{#e;#t;#r;get isConnected(){return this.#e.isConnected}get isConnecting(){return this.#e.isConnecting}get isDestroyed(){return this.#e.isDestroyed}constructor(e,t,r){super(),this.#e=new o.TCPHelper(e,t,r),this.#t=new a,this.#e._socket.pipe(this.#t),this.#e.on("connect",(()=>this.emit("connect"))),this.#e.on("end",(()=>this.emit("end"))),this.#e.on("error",(e=>this.emit("error",e))),this.#e.on("status_change",((e,t)=>this.emit("status_change",e,t))),this.#t.on("iac",((e,t)=>this.emit("iac",e,t))),this.#t.on("sb",(e=>this.emit("sb",e))),this.#t.on("data",(e=>this.emit("data",e))),this.#t.on("drain",(()=>this.emit("drain"))),this.#r=setTimeout((()=>{this.#r=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)}),5e3)}connect(){return this.#e.connect()}async send(e){return this.#e.send(e)}destroy(){this.#e.destroy(),void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this.#t.removeAllListeners(),this.#t.destroy()}}t.TelnetHelper=s;class a extends i.Transform{#n;#i;#o;constructor(e){super(e),this.#n=Buffer.alloc(0),this.#i=Buffer.alloc(0),this.#o=0}_transform(e,t,r){for(let t=0;t<e.length;++t)this.#s(e[t]);const n=this.#a();n.length&&this.push(n),r()}#s(e){if(0===this.#o){if(255===e)return void(this.#o=255);this.#n=Buffer.concat([this.#n,Buffer.from([e])])}else if(255===this.#o)switch(e){case 250:case 251:case 252:case 253:case 254:this.#o=e;break;default:this.#o=0}else{if(this.#o>=251&&this.#o<=254){let t;switch(this.#o){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#o=0)}if(250===this.#o){if(240===e)return this.emit("sb",this.#i),this.#o=0,void(this.#i=Buffer.alloc(0));this.#i=Buffer.concat([this.#i,Buffer.from([e])])}}}#a(){const e=this.#n;return this.#n=Buffer.alloc(0),e}}},1218(e,t,r){(function(){var t,n,i={}.hasOwnProperty;n=r(468),t=r(1737),e.exports=function(e){function r(e){r.__super__.constructor.call(this,e),this.type=t.Dummy}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return""},r}(n)}).call(this)},1268(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(1737),n=r(468),e.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(n)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.raw(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},1323(e,t,r){"use strict";var n=r(9896),i=r(857),o=r(9278),s=r(6928),a=r(7500),u=r(5753),c=r(3480).mkdirp,l=u("portfinder:testPort"),p=u("portfinder:getPort"),h=u("portfinder:defaultHosts"),d={testPort:function(e,r){function n(){l("done w/ testPort(): OK",e.host,"port",e.port),e.server.removeListener("error",i),e.server.close(),r(null,e.port)}function i(i){if(l("done w/ testPort(): failed",e.host,"w/ port",e.port,"with error",i.code),e.server.removeListener("listening",n),"EADDRINUSE"!=i.code&&"EACCES"!=i.code)return r(i);var o=t.nextPort(e.port);if(o>t.highestPort)return r(new Error("No open ports available"));d.testPort({port:o,host:e.host,server:e.server},r)}r||(r=e,e={}),e.server=e.server||o.createServer((function(){})),l("entered testPort(): trying",e.host,"port",e.port),e.server.once("error",i),e.server.once("listening",n),e.host?e.server.listen(e.port,e.host):e.server.listen(e.port)}};t.basePort=8e3,t.setBasePort=function(e){t.basePort=e},t.highestPort=65535,t.setHighestPort=function(e){t.highestPort=e},t.basePath="/tmp/portfinder",t.getPort=function(e,r){if(r||(r=e,e={}),e.port=Number(e.port)||Number(t.basePort),e.host=e.host||null,e.stopPort=Number(e.stopPort)||Number(t.highestPort),!e.startPort){if(e.startPort=Number(e.port),e.startPort<0)throw Error("Provided options.startPort("+e.startPort+") is less than 0, which are cannot be bound.");if(e.stopPort<e.startPort)throw Error("Provided options.stopPort("+e.stopPort+"is less than options.startPort ("+e.startPort+")")}e.host&&-1!==t._defaultHosts.indexOf(e.host)&&t._defaultHosts.push(e.host);var n,i=[];return a.eachSeries(t._defaultHosts,(function(t,r){return p("in eachSeries() iteration callback: host is",t),d.testPort({host:t,port:e.port},(function(e,o){return e?(p("in eachSeries() iteration callback testPort() callback","with an err:",e.code),n=t,r(e)):(p("in eachSeries() iteration callback testPort() callback","with a success for port",o),i.push(o),r())}))}),(function(o){if(o){if(p("in eachSeries() result callback: err is",o),"EADDRNOTAVAIL"===o.code||"EINVAL"===o.code){if(e.host===n){var s="Provided host "+e.host+" could NOT be bound. Please provide a different host address or hostname";return r(Error(s))}var a=t._defaultHosts.indexOf(n);return t._defaultHosts.splice(a,1),t.getPort(e,r)}return r(o)}return i.sort((function(e,t){return e-t})),p("in eachSeries() result callback: openPorts is",i),i[0]===i[i.length-1]?i[0]<=e.stopPort?r(null,i[0]):(s="No open ports found in between "+e.startPort+" and "+e.stopPort,r(Error(s))):t.getPort({port:i.pop(),host:e.host,startPort:e.startPort,stopPort:e.stopPort},r)}))},t.getPortPromise=function(e){if("function"!=typeof Promise)throw Error("Native promise support is not available in this version of node.Please install a polyfill and assign Promise to global.Promise before calling this method");return e||(e={}),new Promise((function(r,n){t.getPort(e,(function(e,t){if(e)return n(e);r(t)}))}))},t.getPorts=function(e,r,n){n||(n=r,r={});var i=null;a.timesSeries(e,(function(e,n){i&&(r.port=t.nextPort(i)),t.getPort(r,(function(e,t){e?n(e):(i=t,n(null,t))}))}),n)},t.getSocket=function(e,r){function i(){n.stat(e.path,(function(n){n?"ENOENT"==n.code?r(null,e.path):r(n):(e.path=t.nextSocket(e.path),t.getSocket(e,r))}))}return r||(r=e,e={}),e.mod=e.mod||parseInt(755,8),e.path=e.path||t.basePath+".sock",e.exists?i():(o=s.dirname(e.path),void n.stat(o,(function(t,n){if(t||!n.isDirectory())return function(t){c(t,e.mod,(function(t){if(t)return r(t);e.exists=!0,i()}))}(o);e.exists=!0,i()})));var o},t.nextPort=function(e){return e+1},t.nextSocket=function(e){var t=s.dirname(e),r=s.basename(e,".sock").match(/^([a-zA-z]+)(\d*)$/i),n=parseInt(r[2]),i=r[1];return isNaN(n)&&(n=0),n+=1,s.join(t,i+n+".sock")},t._defaultHosts=function(){var e={};try{e=i.networkInterfaces()}catch(e){if("uv_interface_addresses"!==e.syscall)throw e}for(var t=Object.keys(e),r=["0.0.0.0"],n=0;n<t.length;n++)for(var o=e[t[n]],s=0;s<o.length;s++){var a=o[s];r.push(a.address)}return r.push(null),h("exports._defaultHosts is: %o",r),r}()},1400(e,t){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(r||(t.InstanceStatus=r={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(n||(t.Regex=n={}))},1632(e,t,r){const{combineRgb:n}=r(6278);e.exports={initPresets(){let e=this,t=[];if("usp3"==e.config.model){if(0==e.config.use_as_surface)for(var r=0;r<this.KEY_LIST.length;r++){let e=this.KEY_LIST[r],i={type:"button",category:"Key Press",name:e.label,style:{text:e.label,size:"12",color:n(255,255,255),bgcolor:n(0,0,0)},steps:[{down:[{actionId:"pressKey",options:{key:e.id}}],up:[]}],feedbacks:[{feedbackId:"keyState",options:{key:e.id,state:"1"},style:{bgcolor:n(255,0,0)}}]};t.push(i)}for(r=0;r<this.GPI_LIST.length;r++){let e=this.GPI_LIST[r],i={type:"button",category:"GPI States",name:e.label,style:{text:e.label,size:"12",color:n(255,255,255),bgcolor:n(0,0,0)},steps:[{down:[],up:[]}],feedbacks:[{feedbackId:"gpiState",options:{gpi:e.id,state:"1"},style:{bgcolor:n(255,0,0)}}]};t.push(i)}for(r=0;r<this.GPO_LIST.length;r++){let e=this.GPO_LIST[r],i={type:"button",category:"GPO Control - ON",name:e.label,style:{text:e.label+" ON",size:"12",color:n(255,255,255),bgcolor:n(0,0,0)},steps:[{down:[{actionId:"setGPO",options:{gpo:e.id,state:"1"}}],up:[]}],feedbacks:[{feedbackId:"gpoState",options:{gpo:e.id,state:"1"},style:{bgcolor:n(255,0,0)}}]};t.push(i)}let i={type:"button",category:"GPO Control - ON",name:"All GPO ON",style:{text:"All GPO ON",size:"12",color:n(255,255,255),bgcolor:n(0,0,0)},steps:[{down:[{actionId:"setGPOAll",options:{state:"1"}}],up:[]}],feedbacks:[]};for(t.push(i),r=0;r<this.GPO_LIST.length;r++){let e=this.GPO_LIST[r],i={type:"button",category:"GPO Control - OFF",name:e.label,style:{text:e.label+" OFF",size:"12",color:n(255,255,255),bgcolor:n(0,0,0)},steps:[{down:[{actionId:"setGPO",options:{gpo:e.id,state:"0"}}],up:[]}],feedbacks:[{feedbackId:"gpoState",options:{gpi:e.id,state:"0"},style:{bgcolor:n(255,0,0)}}]};t.push(i)}let o={type:"button",category:"GPO Control - OFF",name:"All GPO OFF",style:{text:"All GPO OFF",size:"12",color:n(255,255,255),bgcolor:n(0,0,0)},steps:[{down:[{actionId:"setGPOAll",options:{state:"0"}}],up:[]}],feedbacks:[]};t.push(o)}this.setPresetDefinitions(t)}}},1635(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>B,__assign:()=>o,__asyncDelegator:()=>S,__asyncGenerator:()=>O,__asyncValues:()=>C,__await:()=>E,__awaiter:()=>f,__classPrivateFieldGet:()=>x,__classPrivateFieldIn:()=>R,__classPrivateFieldSet:()=>k,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>L,__esDecorate:()=>c,__exportStar:()=>y,__extends:()=>i,__generator:()=>m,__importDefault:()=>D,__importStar:()=>A,__makeTemplateObject:()=>T,__metadata:()=>d,__param:()=>u,__propKey:()=>p,__read:()=>v,__rest:()=>s,__rewriteRelativeImportExtension:()=>M,__runInitializers:()=>l,__setFunctionName:()=>h,__spread:()=>w,__spreadArray:()=>_,__spreadArrays:()=>I,__values:()=>b,default:()=>U});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function u(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,i,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,u=n.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!t&&e?n.static?e:e.prototype:null,p=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),h=!1,d=r.length-1;d>=0;d--){var f={};for(var m in n)f[m]="access"===m?{}:n[m];for(var m in n.access)f.access[m]=n.access[m];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var g=(0,r[d])("accessor"===u?{get:p.get,set:p.set}:p[c],f);if("accessor"===u){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=s(g.get))&&(p.get=a),(a=s(g.set))&&(p.set=a),(a=s(g.init))&&i.unshift(a)}else(a=s(g))&&("field"===u?i.unshift(a):p[c]=a)}l&&Object.defineProperty(l,n.name,p),h=!0}function l(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))}function m(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function I(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}function _(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function O(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||a(e,t)}))},t&&(n[e]=t(n[e])))}function a(e,t){try{(r=i[e](t)).value instanceof E?Promise.resolve(r.value.v).then(u,c):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function S(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:E(e[n](t)),done:!1}:i?i(t):t}:i}}function C(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},N=function(e){return N=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},N(e)};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=N(e),n=0;n<r.length;n++)"default"!==r[n]&&g(t,e,r[n]);return P(t,e),t}function D(e){return e&&e.__esModule?e:{default:e}}function x(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function k(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function B(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var F="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function L(e){function t(t){e.error=e.hasError?new F(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return function i(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var o=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(o).then(i,(function(e){return t(e),i()}))}else n|=1}catch(e){t(e)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function M(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(e,r,n,i,o){return r?t?".jsx":".js":!n||i&&o?n+i+"."+o.toLowerCase()+"js":e})):e}const U={__extends:i,__assign:o,__rest:s,__decorate:a,__param:u,__esDecorate:c,__runInitializers:l,__propKey:p,__setFunctionName:h,__metadata:d,__awaiter:f,__generator:m,__createBinding:g,__exportStar:y,__values:b,__read:v,__spread:w,__spreadArrays:I,__spreadArray:_,__await:E,__asyncGenerator:O,__asyncDelegator:S,__asyncValues:C,__makeTemplateObject:T,__importStar:A,__importDefault:D,__classPrivateFieldGet:x,__classPrivateFieldSet:k,__classPrivateFieldIn:R,__addDisposableResource:B,__disposeResources:L,__rewriteRelativeImportExtension:M}},1649(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const n=r(1635),i=r(360),o=n.__importDefault(r(3290)),s=r(2593),a=r(1706),u=r(8039),c=r(4044),l=r(4289),p=r(2365);t.InstanceBase=class{#u;#c;id;#l=new o.default({concurrency:1});#p=!1;#h=!1;#d={};#f={};#m;#g;#y=new Map;#b=new Map;#v=new Map;#w;#I;get instanceOptions(){return this.#w}get label(){return this.#I}constructor(e){if(!(0,s.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#w={disableVariableValidation:!1,disableNewConfigLayout:!1},this.#u=new c.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),upgradeActionsAndFeedbacks:this._handleUpgradeActionsAndFeedbacks.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:async()=>{},sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},(e=>{process.send(e)}),5e3),process.on("message",(e=>{this.#u.receivedMessage(e)}));const t=async e=>e.text.includes("$(")?this.#u.sendWithCb("parseVariablesInString",e):{text:e.text,variableIds:void 0};this.#m=new l.ActionManager(t,(e=>this.#u.sendWithNoCb("setActionDefinitions",e)),(e=>this.#u.sendWithNoCb("setCustomVariable",e)),this.log.bind(this)),this.#g=new u.FeedbackManager(t,(e=>this.#u.sendWithNoCb("updateFeedbackValues",e)),(e=>this.#u.sendWithNoCb("setFeedbackDefinitions",e)),this.log.bind(this)),this.#c=e.upgradeScripts,this.id=e.id,this.#I=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#l.add((async()=>{if(this.#p)throw new Error("Already initialized");if(this.#d=e.config,this.#f=e.secrets,this.#I=e.label,e.isFirstInit){const t={},r={},n=this.getConfigFields();for(const e of n)"default"in e&&(e.type.startsWith("secret")?r[e.id]=e.default:t[e.id]=e.default);this.#d=t,this.#f=r,this.saveConfig(this.#d,this.#f),e.lastUpgradeIndex=this.#c.length-1}const{updatedConfig:t,updatedSecrets:r}=(0,a.runThroughUpgradeScripts)([],[],e.lastUpgradeIndex,this.#c,this.#d,this.#f,!1);this.#d=t??this.#d,this.#f=r??this.#f;try{await this.init(this.#d,!!e.isFirstInit,this.#f),this.#p=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}return{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#c.length-1,disableNewConfigLayout:this.#w.disableNewConfigLayout,updatedConfig:this.#d,updatedSecrets:this.#f}}))}async _handleDestroy(){await this.#l.add((async()=>{if(!this.#p)throw new Error("Not initialized");await this.destroy(),this.#p=!1}))}async _handleConfigUpdateAndLabel(e){await this.#l.add((async()=>{if(!this.#p)throw new Error("Not initialized");this.#I=e.label,this.#d=e.config,this.#f=e.secrets,await this.configUpdated(this.#d,this.#f)}))}async _handleExecuteAction(e){return this.#m.handleExecuteAction(e)}async _handleUpdateFeedbacks(e){this.#g.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e){this.#m.handleUpdateActions(e.actions)}async _handleUpgradeActionsAndFeedbacks(e){return(0,a.runThroughUpgradeScripts)(e.actions,e.feedbacks,null,this.#c,this.#d,this.#f,!0)}async _handleGetConfigFields(e){return{fields:(0,s.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#m.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#g.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#h)return}else if(!this.#h)return;if(!this.handleStartStopRecordActions)throw this.#h=!1,new Error("Recording actions is not supported by this module!");this.#h=e.recording,this.handleStartStopRecordActions(this.#h)}async _handleSharedUdpSocketMessage(e){for(const t of this.#y.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#y.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e,t){e&&(this.#d=e),t&&(this.#f=t),this.#u.sendWithNoCb("saveConfig",{config:e,secrets:t})}setActionDefinitions(e){this.#m.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#g.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[r,n]of Object.entries(e))n&&t.push({...n,id:r});this.#u.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],r=[];this.#b.clear();for(const n of e)t.push({id:n.variableId,name:n.name}),this.#b.set(n.variableId,n),this.#v.has(n.variableId)||(this.#v.set(n.variableId,""),r.push({id:n.variableId,value:""}));if(!this.#w.disableVariableValidation){const e=new Set(this.#b.keys());for(const t of this.#v.keys())e.has(t)||(this.#v.delete(t),r.push({id:t,value:void 0}))}this.#u.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:r})}setVariableValues(e){const t=[];for(const[r,n]of Object.entries(e))this.#w.disableVariableValidation?(void 0===n?this.#v.delete(r):this.#v.set(r,n),t.push({id:r,value:n})):this.#b.has(r)?(this.#v.set(r,n??""),t.push({id:r,value:n??""})):t.push({id:r,value:void 0});this.#u.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#v.get(e)}async parseVariablesInString(e){const t=this.#g.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),e.includes("$(")?(await this.#u.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text:e}checkFeedbacks(...e){this.#g.checkFeedbacks(e)}checkFeedbacksById(...e){this.#g.checkFeedbacksById(e)}subscribeActions(...e){this.#m.subscribeActions(e)}unsubscribeActions(...e){this.#m.unsubscribeActions(e)}subscribeFeedbacks(...e){this.#g.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#g.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#h)throw new Error("Not currently recording actions");this.#u.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}oscSend(e,t,r,n){this.#u.sendWithNoCb("send-osc",(0,i.literal)({host:e,port:t,path:r,args:n}))}updateStatus(e,t){this.#u.sendWithNoCb("set-status",(0,i.literal)({status:e,message:t??null}))}log(e,t){this.#u.sendWithNoCb("log-message",(0,i.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const r="string"==typeof e?{type:e}:e,n=new p.SharedUdpSocketImpl(this.#u,this.#y,r);return t&&n.on("message",t),n}}},1706(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=function(e,t,r,o,s,a,u){const c=new Map,l=e=>{let t=c.get(e);return t||(t={actions:[],feedbacks:[],config:!1},c.set(e,t)),t};for(const t of e){const e=t?.upgradeIndex??r;t&&"number"==typeof e&&l(e).actions.push(t.id)}for(const e of t){const t=e?.upgradeIndex??r;e&&"number"==typeof t&&l(t).feedbacks.push(e.id)}if(!u)for(let e=r??-1;e<o.length;e++)l(e).config=!0;const p=Object.fromEntries(e.map((e=>[e.id,e]))),h=Object.fromEntries(t.map((e=>[e.id,e]))),d={},f={};let m,g;if(c.size>0){const e=Array.from(c.keys()).sort(),t=Math.min(...e,r??-1)+1,u=[],l=[],y=o.length;for(let e=t;e<y;e++){const t=c.get(e-1);t&&(u.push(...t.actions),l.push(...t.feedbacks));const r=!!t?.config;if(!r&&0===u.length&&0===l.length)continue;const y=m??s,b=g??a,v=(0,o[e])({currentConfig:i(y)},{config:r?y:null,secrets:r?b:null,actions:u.map((e=>{const t=p[e];if(t)return(0,n.literal)({id:t.id,controlId:t.controlId,actionId:t.actionId,options:void 0!==t.options?i(t.options):{}})})).filter((e=>!!e)),feedbacks:l.map((e=>{const t=h[e];if(t)return(0,n.literal)({id:t.id,controlId:t.controlId,feedbackId:t.feedbackId,options:void 0!==t.options?i(t.options):{},isInverted:t.isInverted})})).filter((e=>!!e))});r&&v.updatedConfig&&(m=v.updatedConfig),r&&v.updatedSecrets&&(g=v.updatedSecrets);for(const t of v.updatedActions)if(t){const r=p[t.id];r&&(r.actionId=t.actionId,r.options=t.options,r.upgradeIndex=e,f[t.id]=r)}for(const t of v.updatedFeedbacks)if(t){const r=h[t.id];r&&(r.feedbackId=t.feedbackId,r.options=t.options,r.upgradeIndex=e,d[t.id]={...r,style:d[t.id]?.style??t.style,isInverted:t.isInverted??!1})}}for(const[e,t]of Object.entries(p))f[e]||"number"!=typeof t?.upgradeIndex||(f[e]=t);for(const[e,t]of Object.entries(h))d[e]||"number"!=typeof t?.upgradeIndex||(d[e]=t)}return{updatedActions:Object.values(f),updatedFeedbacks:Object.values(d),updatedConfig:m,updatedSecrets:g,latestUpgradeIndex:o.length-1}};const n=r(360);function i(e){return JSON.parse(JSON.stringify(e))}},1725(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(181),i={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};function o(e){return"number"==typeof e&&isFinite(e)&&function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}(e)}function s(e,t){if("number"!=typeof e)throw new Error(t?i.INVALID_OFFSET_NON_NUMBER:i.INVALID_LENGTH_NON_NUMBER);if(!o(e)||e<0)throw new Error(t?i.INVALID_OFFSET:i.INVALID_LENGTH)}t.ERRORS=i,t.checkEncoding=function(e){if(!n.Buffer.isEncoding(e))throw new Error(i.INVALID_ENCODING)},t.isFiniteInteger=o,t.checkLengthValue=function(e){s(e,!1)},t.checkOffsetValue=function(e){s(e,!0)},t.checkTargetOffset=function(e,t){if(e<0||e>t.length)throw new Error(i.INVALID_TARGET_OFFSET)},t.bigIntAndBufferInt64Check=function(e){if("undefined"==typeof BigInt)throw new Error("Platform does not support JS BigInt type.");if(void 0===n.Buffer.prototype[e])throw new Error(`Platform does not support Buffer.prototype.${e}.`)}},1737(e){(function(){e.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},1912(e,t,r){(function(){"use strict";var e,n,i,o,s,a,u,c,l,p=function(e,t){return function(){return e.apply(t,arguments)}},h={}.hasOwnProperty;c=r(4043),i=r(4434),e=r(3177),u=r(2114),l=r(3557).setImmediate,n=r(6465).defaults,o=function(e){return"object"==typeof e&&null!=e&&0===Object.keys(e).length},s=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e},a=function(e,t,r){var n,i;for(n=0,i=e.length;n<i;n++)t=(0,e[n])(t,r);return t},t.Parser=function(r){function i(e){var r,i,o;if(this.parseStringPromise=p(this.parseStringPromise,this),this.parseString=p(this.parseString,this),this.reset=p(this.reset,this),this.assignOrPush=p(this.assignOrPush,this),this.processAsync=p(this.processAsync,this),!(this instanceof t.Parser))return new t.Parser(e);for(r in this.options={},i=n[.2])h.call(i,r)&&(o=i[r],this.options[r]=o);for(r in e)h.call(e,r)&&(o=e[r],this.options[r]=o);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(u.normalize)),this.reset()}return function(e,t){for(var r in t)h.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(i,r),i.prototype.processAsync=function(){var e,t;try{return this.remaining.length<=this.options.chunkSize?(e=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(e),this.saxParser.close()):(e=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(e),l(this.processAsync))}catch(e){if(t=e,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(t)}},i.prototype.assignOrPush=function(e,t,r){if(s(t))return t in e?(e[t]instanceof Array||(e[t]=[e[t]]),e[t].push(r)):this.options.explicitArray?e[t]=[r]:e[t]=r},i.prototype.reset=function(){var e,t,r,n,i;return this.removeAllListeners(),this.saxParser=c.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(i=this,function(e){if(i.saxParser.resume(),!i.saxParser.errThrown)return i.saxParser.errThrown=!0,i.emit("error",e)}),this.saxParser.onend=function(e){return function(){if(!e.saxParser.ended)return e.saxParser.ended=!0,e.emit("end",e.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,n=[],e=this.options.attrkey,t=this.options.charkey,this.saxParser.onopentag=function(r){return function(i){var o,u,c,l,p;if((c={})[t]="",!r.options.ignoreAttrs)for(o in p=i.attributes)h.call(p,o)&&(e in c||r.options.mergeAttrs||(c[e]={}),u=r.options.attrValueProcessors?a(r.options.attrValueProcessors,i.attributes[o],o):i.attributes[o],l=r.options.attrNameProcessors?a(r.options.attrNameProcessors,o):o,s(l)&&(r.options.mergeAttrs?r.assignOrPush(c,l,u):c[e][l]=u));return c["#name"]=r.options.tagNameProcessors?a(r.options.tagNameProcessors,i.name):i.name,r.options.xmlns&&(c[r.options.xmlnskey]={uri:i.uri,local:i.local}),n.push(c)}}(this),this.saxParser.onclosetag=function(e){return function(){var r,i,u,c,l,p,d,f,m,g;if(p=n.pop(),l=p["#name"],e.options.explicitChildren&&e.options.preserveChildrenOrder||delete p["#name"],!0===p.cdata&&(r=p.cdata,delete p.cdata),m=n[n.length-1],p[t].match(/^\s*$/)&&!r?(i=p[t],delete p[t]):(e.options.trim&&(p[t]=p[t].trim()),e.options.normalize&&(p[t]=p[t].replace(/\s{2,}/g," ").trim()),p[t]=e.options.valueProcessors?a(e.options.valueProcessors,p[t],l):p[t],1===Object.keys(p).length&&t in p&&!e.EXPLICIT_CHARKEY&&(p=p[t])),o(p)&&(p="function"==typeof e.options.emptyTag?e.options.emptyTag():""!==e.options.emptyTag?e.options.emptyTag:i),null!=e.options.validator&&(g="/"+function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)c=n[e],r.push(c["#name"]);return r}().concat(l).join("/"),function(){var t;try{return p=e.options.validator(g,m&&m[l],p)}catch(r){return t=r,e.emit("error",t)}}()),e.options.explicitChildren&&!e.options.mergeAttrs&&"object"==typeof p)if(e.options.preserveChildrenOrder){if(m){for(u in m[e.options.childkey]=m[e.options.childkey]||[],d={},p)h.call(p,u)&&s(u)&&(d[u]=p[u]);m[e.options.childkey].push(d),delete p["#name"],1===Object.keys(p).length&&t in p&&!e.EXPLICIT_CHARKEY&&(p=p[t])}}else c={},e.options.attrkey in p&&(c[e.options.attrkey]=p[e.options.attrkey],delete p[e.options.attrkey]),!e.options.charsAsChildren&&e.options.charkey in p&&(c[e.options.charkey]=p[e.options.charkey],delete p[e.options.charkey]),Object.getOwnPropertyNames(p).length>0&&(c[e.options.childkey]=p),p=c;return n.length>0?e.assignOrPush(m,l,p):(e.options.explicitRoot&&(f=p,(p={})[l]=f),e.resultObject=p,e.saxParser.ended=!0,e.emit("end",e.resultObject))}}(this),r=function(e){return function(r){var i,o;if(o=n[n.length-1])return o[t]+=r,e.options.explicitChildren&&e.options.preserveChildrenOrder&&e.options.charsAsChildren&&(e.options.includeWhiteChars||""!==r.replace(/\\n/g,"").trim())&&(o[e.options.childkey]=o[e.options.childkey]||[],(i={"#name":"__text__"})[t]=r,e.options.normalize&&(i[t]=i[t].replace(/\s{2,}/g," ").trim()),o[e.options.childkey].push(i)),o}}(this),this.saxParser.ontext=r,this.saxParser.oncdata=function(e){var t;if(t=r(e))return t.cdata=!0}},i.prototype.parseString=function(t,r){var n;null!=r&&"function"==typeof r&&(this.on("end",(function(e){return this.reset(),r(null,e)})),this.on("error",(function(e){return this.reset(),r(e)})));try{return""===(t=t.toString()).trim()?(this.emit("end",null),!0):(t=e.stripBOM(t),this.options.async?(this.remaining=t,l(this.processAsync),this.saxParser):this.saxParser.write(t).close())}catch(e){if(n=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",n),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw n}},i.prototype.parseStringPromise=function(e){return new Promise((t=this,function(r,n){return t.parseString(e,(function(e,t){return e?n(e):r(t)}))}));var t},i}(i),t.parseString=function(e,r,n){var i,o;return null!=n?("function"==typeof n&&(i=n),"object"==typeof r&&(o=r)):("function"==typeof r&&(i=r),o={}),new t.Parser(o).parseString(e,i)},t.parseStringPromise=function(e,r){var n;return"object"==typeof r&&(n=r),new t.Parser(n).parseStringPromise(e)}}).call(this)},1933(e,t,r){(function(){var t,n,i,o,s,a,u,c={}.hasOwnProperty;u=r(9241).isPlainObject,i=r(7260),n=r(3074),o=r(468),t=r(1737),a=r(3976),s=r(382),e.exports=function(e){function r(e){r.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new n,e||(e={}),e.writer||(e.writer=new s),this.options=e,this.stringify=new a(e)}return function(e,t){for(var r in t)c.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"implementation",{value:new i}),Object.defineProperty(r.prototype,"doctype",{get:function(){var e,r,n,i;for(r=0,n=(i=this.children).length;r<n;r++)if((e=i[r]).type===t.DocType)return e;return null}}),Object.defineProperty(r.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(r.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(r.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(r.prototype,"origin",{get:function(){return null}}),Object.defineProperty(r.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(r.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(r.prototype,"contentType",{get:function(){return null}}),r.prototype.end=function(e){var t;return t={},e?u(e)&&(t=e,e=this.options.writer):e=this.options.writer,e.document(this,e.filterOptions(t))},r.prototype.toString=function(e){return this.options.writer.document(this,this.options.writer.filterOptions(e))},r.prototype.createElement=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTextNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createComment=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createCDATASection=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createProcessingInstruction=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttribute=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEntityReference=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.importNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createElementNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementById=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.adoptNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.renameNode=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEvent=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createNodeIterator=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTreeWalker=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(o)}).call(this)},1943(e){"use strict";e.exports=require("fs/promises")},2017(e){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var s=o[i];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r}},2018(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1635);n.__exportStar(r(3730),t),n.__exportStar(r(1649),t),n.__exportStar(r(4493),t),n.__exportStar(r(7386),t),n.__exportStar(r(1400),t),n.__exportStar(r(8983),t),n.__exportStar(r(8104),t),n.__exportStar(r(3258),t),n.__exportStar(r(131),t),n.__exportStar(r(3371),t),n.__exportStar(r(9786),t),n.__exportStar(r(6132),t)},2114(e,t){(function(){"use strict";var e;e=new RegExp(/(?!xmlns)^.*:/),t.normalize=function(e){return e.toLowerCase()},t.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},t.stripPrefix=function(t){return t.replace(e,"")},t.parseNumbers=function(e){return isNaN(e)||(e=e%1==0?parseInt(e,10):parseFloat(e)),e},t.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e="true"===e.toLowerCase()),e}}).call(this)},2203(e){"use strict";e.exports=require("stream")},2365(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const n=r(1635).__importDefault(r(228)),i=r(360);class o extends n.default{#u;#_;#w;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#o&&"object"==typeof this.#o?this.#o:void 0}#o="pending";constructor(e,t,r){super(),this.#u=e,this.#_=t,this.#w={...r}}bind(e,t,r){if(this.#o&&"object"==typeof this.#o)throw new Error("Socket is already bound");switch(this.#o){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,i.assertNever)(this.#o),new Error("Invalid socket state")}this.#o="binding",r&&this.on("listening",r),this.#u.sendWithCb("sharedUdpSocketJoin",{family:this.#w.type,portNumber:e}).then((t=>{this.#o={portNumber:e,handleId:t},this.#_.set(t,this),this.emit("listening")}),(e=>{this.#o="closed",this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}close(e){if(this.#o&&"object"==typeof this.#o);else switch(this.#o){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,i.assertNever)(this.#o),new Error("Invalid socket state")}const t=this.#o.handleId;this.#o="closed",e&&this.on("close",e),this.#u.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then((()=>{this.#_.delete(t),this.emit("close")}),(e=>{this.#_.delete(t),this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}send(e,t,r,n,i,o){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof r){if("number"!=typeof n||"string"!=typeof i)throw new Error("Invalid arguments");if(void 0!==o&&"function"!=typeof o)throw new Error("Invalid arguments");const s=this.#E(e,t,r);this.#O(s,n,i,o)}else{if("string"!=typeof r)throw new Error("Invalid arguments");{if(void 0!==n&&"function"!=typeof n)throw new Error("Invalid arguments");const i=this.#E(e,0,void 0);this.#O(i,t,r,n)}}}#E(e,t,r){let n;if("string"==typeof e)n=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))n=e;else{if(Array.isArray(e))return Buffer.from(e);n=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return n.subarray(t,void 0!==r?r+t:void 0)}#O(e,t,r,n){if(!this.#o||"object"!=typeof this.#o)throw new Error("Socket is not open");this.#u.sendWithCb("sharedUdpSocketSend",{handleId:this.#o.handleId,message:e,address:r,port:t}).then((()=>{n?.()}),(e=>{this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#o="fatalError";const t=this.boundState;t&&this.#_.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=o},2501(e,t,r){var n=function(){var e={},t=null;this.add=function(r){if(!function(e){function t(e,t){var r=!0;for(var n in t){var i=t[n].split(":");if(!e.hasOwnProperty([i[0]])||typeof e[i[0]]!==i[1]){r=!1;break}}return r}return result=t(e,["name:string","parse:function","isDefault:boolean"]),result&&!e.isDefault&&(result=t(e,["match:function"])),result}(r))throw"parser cannot be added: invalid parser definition";r.isDefault?t=r:e[r.name]=r},this.remove=function(t){if(!e[t])throw"cannot remove parser: "+t+" doesn't exists";delete e[t]},this.clean=function(){e={}},this.find=function(t){var r=e[t];if(!r)throw"cannot find parser: "+t+" doesn't exists ";return r},this.getDefault=function(){return t},this.get=function(r){var n=null;for(var i in e)if(e[i].match(r)){n=e[i];break}return null===n?t:n},this.getAll=function(){var t=[];for(var r in e)t.push(e[r]);return t}};e.exports=function(){var e=new n,t={isDefault:!1,match:function(e){var t=!1,r=e.headers["content-type"]&&e.headers["content-type"].replace(/ /g,"");if(!r)return t;for(var n=0;n<this.contentTypes.length&&!(t=this.contentTypes[n].trim().toLowerCase()===r.trim().toLowerCase());n++);return t}};return e.add(Object.assign({name:"XML",options:{explicitArray:!1},contentTypes:["application/xml","application/xml;charset=utf-8","text/xml","text/xml;charset=utf-8"],parseString:r(8805).parseString,parse:function(e,t,r){this.parseString(e.toString(),this.options,(function(e,t){r(t)}))}},t)),e.add(Object.assign({name:"JSON",contentTypes:["application/json","application/json;charset=utf-8"],isValidData:function(e){return void 0!==e&&void 0!==e.length&&e.length>0},parse:function(e,t,r){var n,i=e.toString();try{n=this.isValidData(i)?JSON.parse(i):i}catch(e){t("error","Error parsing response. response: ["+i+"], error: ["+e+"]")}r(n)}},t)),e.add({name:"DEFAULT",isDefault:!0,parse:function(e,t,r){r(e)}}),e}},2524(e,t,r){var n=r(3522);t.al=n,n.Reader,n.Writer},2527(e){(function(){e.exports=function(){function e(e){this.arr=e||[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length}}),e.prototype.item=function(e){return this.arr[e]||null},e.prototype.contains=function(e){return-1!==this.arr.indexOf(e)},e}()}).call(this)},2535(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(1737),n=r(7457),e.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(n)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"wholeText",{get:function(){var e,t,r;for(r="",t=this.previousSibling;t;)r=t.data+r,t=t.previousSibling;for(r+=this.data,e=this.nextSibling;e;)r+=e.data,e=e.nextSibling;return r}}),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.text(this,this.options.writer.filterOptions(e))},r.prototype.splitText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.replaceWholeText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(n)}).call(this)},2593(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeIsVisibleFn=function(e){return(e??[]).map((e=>"isVisibleExpression"in e&&"string"==typeof e.isVisibleExpression?{...e,isVisibleFnType:"expression",isVisibleFn:e.isVisibleExpression,isVisible:void 0,isVisibleExpression:void 0}:"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisibleFnType:"function",isVisible:void 0,isVisibleExpression:void 0}:{...e,isVisible:void 0,isVisibleFn:void 0,isVisibleFnType:void 0,isVisibleExpression:void 0}))},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},2613(e){"use strict";e.exports=require("assert")},2679(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(1737),n=r(7457),e.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(n)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.comment(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},2691(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(1737),n=r(7457),e.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(n)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.cdata(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},3074(e,t,r){(function(){var t,n;t=r(5660),n=r(2527),e.exports=function(){function e(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(e.prototype,"parameterNames",{get:function(){return new n(Object.keys(this.defaultParams))}}),e.prototype.getParameter=function(e){return this.params.hasOwnProperty(e)?this.params[e]:null},e.prototype.canSetParameter=function(e,t){return!0},e.prototype.setParameter=function(e,t){return null!=t?this.params[e]=t:delete this.params[e]},e}()}).call(this)},3106(e){"use strict";e.exports=require("zlib")},3164(e,t,r){var n=r(7016),i=n.URL,o=r(8611),s=r(5692),a=r(2203).Writable,u=r(2613),c=r(7507),l=!1;try{u(new i)}catch(e){l="ERR_INVALID_URL"===e.code}var p=["auth","host","hostname","href","path","pathname","port","protocol","query","search","hash"],h=["abort","aborted","connect","error","socket","timeout"],d=Object.create(null);h.forEach((function(e){d[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}}));var f=T("ERR_INVALID_URL","Invalid URL",TypeError),m=T("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),g=T("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded",m),y=T("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),b=T("ERR_STREAM_WRITE_AFTER_END","write after end"),v=a.prototype.destroy||_;function w(e,t){a.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(e){try{r._processResponse(e)}catch(e){r.emit("error",e instanceof m?e:new m({cause:e}))}},this._performRequest()}function I(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach((function(n){var o=n+":",s=r[o]=e[n],a=t[n]=Object.create(s);Object.defineProperties(a,{request:{value:function(e,n,s){return i&&e instanceof i?e=S(e):N(e)?e=S(E(e)):(s=n,n=O(e),e={protocol:o}),A(n)&&(s=n,n=null),(n=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,n)).nativeProtocols=r,N(n.host)||N(n.hostname)||(n.hostname="::1"),u.equal(n.protocol,o,"protocol mismatch"),c("options",n),new w(n,s)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(e,t,r){var n=a.request(e,t,r);return n.end(),n},configurable:!0,enumerable:!0,writable:!0}})})),t}function _(){}function E(e){var t;if(l)t=new i(e);else if(!N((t=O(n.parse(e))).protocol))throw new f({input:e});return t}function O(e){if(/^\[/.test(e.hostname)&&!/^\[[:0-9a-f]+\]$/i.test(e.hostname))throw new f({input:e.href||e});if(/^\[/.test(e.host)&&!/^\[[:0-9a-f]+\](:\d+)?$/i.test(e.host))throw new f({input:e.href||e});return e}function S(e,t){var r=t||{};for(var n of p)r[n]=e[n];return r.hostname.startsWith("[")&&(r.hostname=r.hostname.slice(1,-1)),""!==r.port&&(r.port=Number(r.port)),r.path=r.search?r.pathname+r.search:r.pathname,r}function C(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return null==r?void 0:String(r).trim()}function T(e,t,r){function n(r){Error.captureStackTrace(this,this.constructor),Object.assign(this,r||{}),this.code=e,this.message=this.cause?t+": "+this.cause.message:t}return n.prototype=new(r||Error),Object.defineProperties(n.prototype,{constructor:{value:n,enumerable:!1},name:{value:"Error ["+e+"]",enumerable:!1}}),n}function P(e,t){for(var r of h)e.removeListener(r,d[r]);e.on("error",_),e.destroy(t)}function N(e){return"string"==typeof e||e instanceof String}function A(e){return"function"==typeof e}w.prototype=Object.create(a.prototype),w.prototype.abort=function(){P(this._currentRequest),this._currentRequest.abort(),this.emit("abort")},w.prototype.destroy=function(e){return P(this._currentRequest,e),v.call(this,e),this},w.prototype.write=function(e,t,r){if(this._ending)throw new b;if(!(N(e)||"object"==typeof(n=e)&&"length"in n))throw new TypeError("data should be a string, Buffer or Uint8Array");var n;A(t)&&(r=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new y),this.abort()):r&&r()},w.prototype.end=function(e,t,r){if(A(e)?(r=e,e=t=null):A(t)&&(r=t,t=null),e){var n=this,i=this._currentRequest;this.write(e,t,(function(){n._ended=!0,i.end(null,null,r)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,r)},w.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},w.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},w.prototype.setTimeout=function(e,t){var r=this;function n(t){t.setTimeout(e),t.removeListener("timeout",t.destroy),t.addListener("timeout",t.destroy)}function i(t){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout((function(){r.emit("timeout"),o()}),e),n(t)}function o(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",o),r.removeListener("error",o),r.removeListener("response",o),r.removeListener("close",o),t&&r.removeListener("timeout",t),r.socket||r._currentRequest.removeListener("socket",i)}return t&&this.on("timeout",t),this.socket?i(this.socket):this._currentRequest.once("socket",i),this.on("socket",n),this.on("abort",o),this.on("error",o),this.on("response",o),this.on("close",o),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){w.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(w.prototype,e,{get:function(){return this._currentRequest[e]}})})),w.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},w.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(!t)throw new TypeError("Unsupported protocol "+e);if(this._options.agents){var r=e.slice(0,-1);this._options.agent=this._options.agents[r]}var i=this._currentRequest=t.request(this._options,this._onNativeResponse);for(var o of(i._redirectable=this,h))i.on(o,d[o]);if(this._currentUrl=/^\//.test(this._options.path)?n.format(this._options):this._options.path,this._isRedirect){var s=0,a=this,u=this._requestBodyBuffers;!function e(t){if(i===a._currentRequest)if(t)a.emit("error",t);else if(s<u.length){var r=u[s++];i.finished||i.write(r.data,r.encoding,e)}else a._ended&&i.end()}()}},w.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r,o=e.headers.location;if(!o||!1===this._options.followRedirects||t<300||t>=400)return e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),void(this._requestBodyBuffers=[]);if(P(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects)throw new g;var s=this._options.beforeRedirect;s&&(r=Object.assign({Host:e.req.getHeader("host")},this._options.headers));var a=this._options.method;((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],C(/^content-/i,this._options.headers));var p,h,d=C(/^host$/i,this._options.headers),f=E(this._currentUrl),m=d||f.host,y=/^\w+:/.test(o)?this._currentUrl:n.format(Object.assign(f,{host:m})),b=(p=o,h=y,l?new i(p,h):E(n.resolve(h,p)));if(c("redirecting to",b.href),this._isRedirect=!0,S(b,this._options),(b.protocol!==f.protocol&&"https:"!==b.protocol||b.host!==m&&!function(e,t){u(N(e)&&N(t));var r=e.length-t.length-1;return r>0&&"."===e[r]&&e.endsWith(t)}(b.host,m))&&C(/^(?:(?:proxy-)?authorization|cookie)$/i,this._options.headers),A(s)){var v={headers:e.headers,statusCode:t},w={url:y,method:a,headers:r};s(this._options,v,w),this._sanitizeOptions(this._options)}this._performRequest()},e.exports=I({http:o,https:s}),e.exports.wrap=I},3177(e,t){(function(){"use strict";t.stripBOM=function(e){return"\ufeff"===e[0]?e.substring(1):e}}).call(this)},3193(e){"use strict";e.exports=require("string_decoder")},3258(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3290(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6368),i=r(7685),o=r(4774),s=()=>{},a=new i.TimeoutError;t.default=class extends n{constructor(e){var t,r,n,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=s,this._resolveIdle=s,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=s,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=s,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((r,n)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const o=void 0===this._timeout&&void 0===t.timeout?e():i.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&n(a)}));r(await o)}catch(e){n(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},3347(e,t,r){var n=r(9896),i=function(e){var t=function(e){return Object.assign(e,{logit:!1,lastChar:"",state:"",open:!1,CurrentSymbol:"",nested:0,isComment:!1,isEqual:!1,isOID:!1,isList:!1,isString:!1,inComment:!1,inGroup:0,builder:"",ColumnIndex:0,RowIndex:0,PreviousRow:0})},r={directory:e||"",SymbolBuffer:{},StringBuffer:"",Modules:{},Objects:{},MACROS:[],CurrentObject:null,TempObject:{},CurrentClause:"",WaitFor:"",CharBuffer:{Table:{},ModuleName:{},Append:function(e){this.builder+=e},Fill:function(e,t,r){if(0!=this.builder.length){this.builder.length;var n=this.builder.toString().trim();this.builder="",this.builder.length=0,this.Table[e]?this.PreviousRow<t&&(this.RowIndex++,this.ColumnIndex=0,this.PreviousRow=t):this.Table[e]=[];var i=this.RowIndex,o=this.ColumnIndex;switch(this.Table[e][i]&&0!==o||(this.Table[e][i]=Object.defineProperty([],"line",{enumerable:!1,value:t+1})),this.isEqual=!1,n){case")":this.Table[e][i][o]=n,this.ColumnIndex++,this.logit=!1;break;case"(":this.Table[e][i][o]=n,this.ColumnIndex++,this.logit=!0;break;case"DEFINITIONS":this.ModuleName[e]=0==o?this.Table[e][i-1][o]:this.Table[e][i][o-1],this.Table[e][i][o]=n,this.ColumnIndex++;break;case"::=":this.Table[e][i][o]=n,this.ColumnIndex++,this.isEqual=!0;break;case"{":"::="!=this.Table[e][i][o-1]&&(this.isList=!0),this.Table[e][i][o]=n,this.ColumnIndex++;break;case"NOTATION":"TYPE"!=this.Table[e][i][o-1]&&"VALUE"!=this.Table[e][i][o-1]||(this.Table[e][i][o-1]+=" NOTATION");break;case"OF":"SEQUENCE"==this.Table[e][i][o-1]&&(this.Table[e][i][o-1]="SEQUENCE OF");break;case"IDENTIFIER":"OBJECT"==this.Table[e][i][o-1]&&(this.Table[e][i][o-1]="OBJECT IDENTIFIER");break;case"STRING":"OCTET"==this.Table[e][i][o-1]&&(this.Table[e][i][o-1]="OCTET STRING");break;default:this.Table[e][i][o]=n,this.ColumnIndex++}}}},Import:function(e){this.ParseModule(e.split("/")[e.split("/").length-1].split(".")[0],n.readFileSync(e).toString())},ParseModule:function(e,r){t(this.CharBuffer);for(var n=r.split("\n"),i="",o=0;null!=(i=n[o])&&o<=n.length;)this.ParseLine(e,i,o),o++},ParseLine:function(e,t,r){let n=t.length;"\r"===t[n-1]&&--n;for(var i=0;i<n;i++){var o=t.charAt(i);this.ParseChar(e,o,r,i)}this.ParseChar(e,"\n",r,n)},ParseChar:function(e,t,r,n){switch(t){case"\r":case"\n":this.CharBuffer.isString?this.CharBuffer.isString&&this.CharBuffer.isComment&&this.CharBuffer.Append(t):(this.CharBuffer.Fill(e,r,n),this.CharBuffer.isComment=!1,this.CharBuffer.inGroup=0);break;case"{":!this.CharBuffer.isComment&&this.CharBuffer.isEqual&&(this.CharBuffer.isOID=!0);case"[":case"(":this.CharBuffer.isComment||this.CharBuffer.isString||(this.CharBuffer.nested++,"("!=t&&"{"!=t||(1===this.CharBuffer.nested&&this.CharBuffer.Fill(e,r,n),this.CharBuffer.inGroup++)),this.CharBuffer.isComment||(this.CharBuffer.isOID||this.CharBuffer.nested>0)&&(!this.CharBuffer.isList||this.CharBuffer.inGroup>0)?this.CharBuffer.Append(t):(this.CharBuffer.Fill(e,r,n),this.CharBuffer.Append(t),this.CharBuffer.Fill(e,r,n));break;case"}":case"]":case")":this.CharBuffer.isComment||this.CharBuffer.isString||(this.CharBuffer.nested--,this.CharBuffer.nested<0&&(this.CharBuffer.nested=0),")"==t&&(this.CharBuffer.inGroup--,this.CharBuffer.inGroup<0&&(this.CharBuffer.inGroup=0))),this.CharBuffer.isComment||(this.CharBuffer.isOID||this.CharBuffer.nested>=0)&&(!this.CharBuffer.isList||this.CharBuffer.inGroup>=0)?this.CharBuffer.Append(t):(this.CharBuffer.Fill(e,r,n),this.CharBuffer.Append(t),this.CharBuffer.Fill(e,r,n)),"}"==t&&(this.CharBuffer.isOID=!1,this.CharBuffer.isList=!1);break;case",":case";":this.CharBuffer.isComment?this.CharBuffer.Append(t):(this.CharBuffer.Fill(e,r,n),this.CharBuffer.Append(t),this.CharBuffer.Fill(e,r,n));break;case" ":case"\t":this.CharBuffer.isComment||(this.CharBuffer.isOID||this.CharBuffer.nested>0)&&(!this.CharBuffer.isList||this.CharBuffer.inGroup>0)?this.CharBuffer.Append(t):this.CharBuffer.Fill(e,r,n);break;case"-":this.CharBuffer.Append(t),this.CharBuffer.isString||"-"!=this.CharBuffer.lastChar||(this.CharBuffer.isComment=!0,this.CharBuffer.builder=this.CharBuffer.builder.split("--")[0],this.CharBuffer.Fill(e,r,n),this.CharBuffer.builder="--");break;case'"':!this.CharBuffer.isComment||this.CharBuffer.isString||this.CharBuffer.inComment?this.CharBuffer.isComment||this.CharBuffer.isString||this.CharBuffer.inComment?this.CharBuffer.isComment&&this.CharBuffer.isString&&!this.CharBuffer.inComment?(this.CharBuffer.isComment=!1,this.CharBuffer.isString=!1,this.CharBuffer.inComment=!1):this.CharBuffer.isComment&&!this.CharBuffer.isString&&this.CharBuffer.inComment&&(this.CharBuffer.isComment=!0,this.CharBuffer.isString=!1,this.CharBuffer.inComment=!1):(this.CharBuffer.isComment=!0,this.CharBuffer.isString=!0,this.CharBuffer.inComment=!1,this.CharBuffer.Fill(e,r,n)):(this.CharBuffer.isComment=!0,this.CharBuffer.isString=!1,this.CharBuffer.inComment=!0),this.CharBuffer.isComment?this.CharBuffer.Append(t):(this.CharBuffer.Append(t),this.CharBuffer.Fill(e,r,n));break;default:this.CharBuffer.Append(t)}this.CharBuffer.lastChar=t},Serialize:function(){var e=this.CharBuffer.Table,t="";for(var r in e){t=this.CharBuffer.ModuleName[r],this.SymbolBuffer[t]=[];for(var n=!1,i=["none"],o=e[r],s=0;s<o.length;s++)for(var a=o[s],u=0;u<a.length;u++){var c=a[u],l=!0;switch(c){case"END":n=!0;break;case"::=":n=!1,i=a;break;default:c.startsWith("--")?l=!1:n=!1}l&&this.SymbolBuffer[t].push(c)}n||console.warn('[%s]: Incorrect formatting: no END statement found - last good declaration "%s" (line %s)',t,i.join(" "),i.line)}this.Compile()},Compile:function(){for(var e in this.SymbolBuffer)if(this.SymbolBuffer.hasOwnProperty(e)){this.Modules[e]||(this.Modules[e]={});for(var t=this.Modules[e],r=this.SymbolBuffer[e],n=t,i="",o=0;o<r.length;o++)switch(r[o]){case"::=":if(0==r[o+1].indexOf("{")){for(var s=o-1,a=!1;!a&&s>0;){s--;for(var u=0;u<this.MACROS.length;u++)if(r[s]==this.MACROS[u]){a=!0;break}}if("OBJECT IDENTIFIER"==r[o-1])n[r[o-2]]={},n[r[o-2]].ObjectName=r[o-2],n[r[o-2]].ModuleName=e,n[r[o-2]]["OBJECT IDENTIFIER"]=r[o+1].replace("{","").replace("}","").trim().replace(/\s+/," "),"0 0"==n[r[o-2]]["OBJECT IDENTIFIER"]?(n[r[o-2]].OID="0.0",n[r[o-2]].NameSpace="null"):this.OID(n[r[o-2]]["OBJECT IDENTIFIER"],"",r[o-2],"",(function(e,t){n[r[o-2]].OID=e,n[r[o-2]].NameSpace=t}));else{var c=r[s-1];n[c]={},n[c].ObjectName=c,n[c].ModuleName=e,n[c].MACRO=r[s];var l,p=this[r[s]],h=s,d=[];for(var f in d.push("DESCRIPTION"),p["TYPE NOTATION"])l=f,null==p["TYPE NOTATION"][f]&&(l=p[f].MACRO.replace(/"/g,"")),d.push(l);for(;h<o-1;){h++,l=r[h];var m=/\(([^)]+)\)/;if(d.indexOf(l)>-1||"REVISION"==l){var g=r[h+1].replace(/"/g,"");if(0==g.indexOf("{")){for(h++;-1==r[h].indexOf("}");)h++,g+=r[h];g="DEFVAL"==l?g.replace(/^{/,"").replace(/}$/,"").trim():g.replace("{","").replace("}","").split(",")}switch(l){case"SYNTAX":switch(g){case"BITS":case"INTEGER":case"Integer32":if(0==r[h+2].indexOf("{")){var y,b,v=g;for((g={})[v]={},h+=1;-1==r[h].indexOf("}");){h++;var w=!1;0==r[h].indexOf("(")&&r[h].length>1?(y=m.exec(r[h]),b=r[h-1],w=!0):r[h].indexOf("(")>0&&(y=m.exec(r[h]),b=r[h].split("(")[0],w=!0),b&&0==b.indexOf("{")&&(b=b.split("{")[1].trim()),w&&(g[v][y[1]]=b)}}else if(0==r[h+2].indexOf("(")){let e=g;(g={})[e]={ranges:this.GetRanges(r[h+2])}}break;case"OCTET STRING":case"DisplayString":if(r[h+2].replace(/ */g,"").startsWith("(SIZE")){let e=g;(g={})[e]={sizes:this.GetRanges(r[h+2])}}break;case"SEQUENCE OF":g+=" "+r[h+2],h+=2}n[c][l]=g;break;case"DESCRIPTION":n[c][l]||(n[c][l]=g),n[c]["REVISIONS-DESCRIPTIONS"]||(n[c]["REVISIONS-DESCRIPTIONS"]=[]),n[c]["REVISIONS-DESCRIPTIONS"].push({type:"DESCRIPTION",value:g});break;case"REVISION":n[c]["REVISIONS-DESCRIPTIONS"]||(n[c]["REVISIONS-DESCRIPTIONS"]=[]),n[c]["REVISIONS-DESCRIPTIONS"].push({type:"REVISION",value:g});break;default:n[c][l]=g}}}n[r[s-1]].ObjectName=r[s-1],n[r[s-1]].ModuleName=e,n[r[s-1]]["OBJECT IDENTIFIER"]=r[o+1].replace("{","").replace("}","").trim().replace(/\s+/," "),"0 0"==n[r[s-1]]["OBJECT IDENTIFIER"]?(n[r[s-1]].OID="0.0",n[r[s-1]].NameSpace="null"):this.OID(n[r[s-1]]["OBJECT IDENTIFIER"],"",r[s-1],"",(function(e,t){n[r[s-1]].OID=e,n[r[s-1]].NameSpace=t})),n[r[s-1]]["REVISIONS-DESCRIPTIONS"]&&1==n[r[s-1]]["REVISIONS-DESCRIPTIONS"].length&&"DESCRIPTION"==n[r[s-1]]["REVISIONS-DESCRIPTIONS"][0].type&&delete n[r[s-1]]["REVISIONS-DESCRIPTIONS"]}}else switch(r[o-1]){case"DEFINITIONS":case"OBJECT IDENTIFIER":break;case"MACRO":n=n[r[o-2]]={},i=r[o-2];break;case"VALUE NOTATION":case"TYPE NOTATION":n[r[o-1]]={};for(var I=o+1;"::="!=r[I+1]&&"END"!=r[I+1];){if(0==r[I].indexOf('"')){var _=r[I+1],E=I+1;0==r[I+2].indexOf("(")&&(_=r[I+2],E=I+2),n[r[o-1]][r[I].replace(/"/g,"")]=_,I=E}else n[r[o-1]][r[I]]=null,0==r[I+1].indexOf("(")&&(n[r[o-1]][r[I]]=r[I+1],I++);I++}"SNMPv2-SMI"==e?(n["TYPE NOTATION"].INDEX="Index",n["TYPE NOTATION"].AUGMENTS="Augments",n["TYPE NOTATION"].ACCESS="Access"):"RFC-1212"==e&&(n["TYPE NOTATION"].INDEX="Index",n["TYPE NOTATION"].ACCESS="Access");break;default:n[r[o-1]]={},n[r[o-1]].ObjectName=r[o-1],n[r[o-1]].ModuleName=e,n[r[o-1]].MACRO=r[o+1],this.BuildObject(n,r[o-1],r[o+1],o,r)}break;case"END":""!=i&&(this[i]=n,this.MACROS.push(i)),n=t,i="";break;case"IMPORTS":t.IMPORTS={};for(var O=o+1,S=[];";"!=r[O];){if("FROM"==r[O]){var C=r[O+1];this.Modules[C]||(console.log(e+": Can not find "+C+"!!!!!!!!!!!!!!!!!!!!!"),console.log(e+": Can not import ",S)),t.IMPORTS[C]=S,O++,S=[]}else","!=r[O]&&S.push(r[O]);O++}}}},GetRanges:function(e){let t=e.replace(/ */g,"").replace(/\(SIZE/,"").replace(/\)/,"").replace(/\(/,"").replace(/\)/,"").split("|"),r=[];for(let e of t)if(e.includes("..")){let t=e.split("..");r.push({min:parseInt(t[0],10),max:parseInt(t[1],10)})}else r.push({min:parseInt(e,10),max:parseInt(e,10)});return r},BuildObject:function(e,t,r,n,i){var o=i.indexOf("SYNTAX",n),s=o-n,a=o+1,u=i[a],c=i[a+1];if(this.MACROS.indexOf(r)>-1&&s<10)if("{"===c[0]){for(a++;-1==i[a].indexOf("}");)c+=i[++a].trim();c=c.replace("{","").replace("}","").split(","),e[t].SYNTAX={},e[t].SYNTAX[u]={};for(var l=0;l<c.length;l++){let r=c[l].split(/\s*\(\s*/);e[t].SYNTAX[u][r[1].replace(/\s*\)\s*$/,"")]=r[0].trimStart()}}else if("("===c[0]){const r=c.startsWith("(SIZE")?"sizes":"ranges";e[t].SYNTAX={},e[t].SYNTAX[u]={[r]:this.GetRanges(c)}}else e[t].SYNTAX=u},GetSummary:function(e){var t="";for(var r in this.Modules)if(this.Modules.hasOwnProperty(r))for(var n in this.Modules[r])this.Modules[r].hasOwnProperty(n)&&this.Modules[r][n].OID&&(t+=this.Modules[r][n].OID+" : "+n+"\r\n");e(t)},OID:function(e,t,r,n,i){let o=e.split(" "),s=o.shift(),a=o.pop();if("iso"==s){let e=["1"],s=["iso"];for(let t of o){let r=t.match(/(.*)\((.+)\)$/);e.push(r[2]),s.push(r[1])}return e.push(a),""!=t&&e.push(t),""!=n&&s.push(n),s.push(r),void i(e.join("."),s.join("."))}for(var u in t=""==t?a:[a,t].join("."),n=""==n?s:[s,n].join("."),this.Modules)if(this.Modules.hasOwnProperty(u)&&this.Modules[u][s]){this.OID(this.Modules[u][s]["OBJECT IDENTIFIER"],t,r,n,i);break}}};return t(r.CharBuffer),r};e.exports=t=i,t.MIB=i,t.native=void 0},3371(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3480(e,t,r){var n=r(6928),i=r(9896),o=parseInt("0777",8);function s(e,t,r,a){"function"==typeof t?(r=t,t={}):t&&"object"==typeof t||(t={mode:t});var u=t.mode,c=t.fs||i;void 0===u&&(u=o),a||(a=null);var l=r||function(){};e=n.resolve(e),c.mkdir(e,u,(function(r){if(!r)return l(null,a=a||e);if("ENOENT"===r.code){if(n.dirname(e)===e)return l(r);s(n.dirname(e),t,(function(r,n){r?l(r,n):s(e,t,l,n)}))}else c.stat(e,(function(e,t){e||!t.isDirectory()?l(r,a):l(null,a)}))}))}e.exports=s.mkdirp=s.mkdirP=s,s.sync=function e(t,r,s){r&&"object"==typeof r||(r={mode:r});var a=r.mode,u=r.fs||i;void 0===a&&(a=o),s||(s=null),t=n.resolve(t);try{u.mkdirSync(t,a),s=s||t}catch(i){if("ENOENT"===i.code)s=e(n.dirname(t),r,s),e(t,r,s);else{var c;try{c=u.statSync(t)}catch(e){throw i}if(!c.isDirectory())throw i}}return s}},3487(e){e.exports=[function(e,t){return{updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}}]},3522(e,t,r){var n=r(6679),i=r(5071),o=r(8779),s=r(8651);for(var a in i)i.hasOwnProperty(a)&&(t[a]=i[a]);for(var u in n)n.hasOwnProperty(u)&&(t[u]=n[u]);t.Reader=o,t.Writer=s},3557(e){"use strict";e.exports=require("timers")},3730(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3906(e,t,r){(function(){var t,n,i,o,s,a,u,c,l={}.hasOwnProperty;c=r(9241),u=c.isObject,a=c.isFunction,s=c.getValue,o=r(468),t=r(1737),n=r(4238),i=r(4797),e.exports=function(e){function r(e,n,i){var o,s,a,u;if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,null!=i&&this.attribute(i),e.type===t.Document&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this,e.children))for(s=0,a=(u=e.children).length;s<a;s++)if((o=u[s]).type===t.DocType){o.name=this.name;break}}return function(e,t){for(var r in t)l.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(r.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(r.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new i(this.attribs)),this.attributeMap}}),r.prototype.clone=function(){var e,t,r,n;for(t in(r=Object.create(this)).isRoot&&(r.documentObject=null),r.attribs={},n=this.attribs)l.call(n,t)&&(e=n[t],r.attribs[t]=e.clone());return r.children=[],this.children.forEach((function(e){var t;return(t=e.clone()).parent=r,r.children.push(t)})),r},r.prototype.attribute=function(e,t){var r,i;if(null!=e&&(e=s(e)),u(e))for(r in e)l.call(e,r)&&(i=e[r],this.attribute(r,i));else a(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.attribs[e]=new n(this,e,""):null!=t&&(this.attribs[e]=new n(this,e,t));return this},r.prototype.removeAttribute=function(e){var t,r,n;if(null==e)throw new Error("Missing attribute name. "+this.debugInfo());if(e=s(e),Array.isArray(e))for(r=0,n=e.length;r<n;r++)t=e[r],delete this.attribs[t];else delete this.attribs[e];return this},r.prototype.toString=function(e){return this.options.writer.element(this,this.options.writer.filterOptions(e))},r.prototype.att=function(e,t){return this.attribute(e,t)},r.prototype.a=function(e,t){return this.attribute(e,t)},r.prototype.getAttribute=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e].value:null},r.prototype.setAttribute=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNode=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e]:null},r.prototype.setAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNodeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNodeNS=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.hasAttribute=function(e){return this.attribs.hasOwnProperty(e)},r.prototype.hasAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttribute=function(e,t){return this.attribs.hasOwnProperty(e)?this.attribs[e].isId:t},r.prototype.setIdAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttributeNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.isEqualNode=function(e){var t,n,i;if(!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e))return!1;if(e.namespaceURI!==this.namespaceURI)return!1;if(e.prefix!==this.prefix)return!1;if(e.localName!==this.localName)return!1;if(e.attribs.length!==this.attribs.length)return!1;for(t=n=0,i=this.attribs.length-1;0<=i?n<=i:n>=i;t=0<=i?++n:--n)if(!this.attribs[t].isEqualNode(e.attribs[t]))return!1;return!0},r}(o)}).call(this)},3976(e){(function(){var t=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;e.exports=function(){function e(e){var n,i,o;for(n in this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this),e||(e={}),this.options=e,this.options.version||(this.options.version="1.0"),i=e.stringify||{})r.call(i,n)&&(o=i[n],this[n]=o)}return e.prototype.name=function(e){return this.options.noValidation?e:this.assertLegalName(""+e||"")},e.prototype.text=function(e){return this.options.noValidation?e:this.assertLegalChar(this.textEscape(""+e||""))},e.prototype.cdata=function(e){return this.options.noValidation?e:(e=(e=""+e||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(e))},e.prototype.comment=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+e);return this.assertLegalChar(e)},e.prototype.raw=function(e){return this.options.noValidation?e:""+e||""},e.prototype.attValue=function(e){return this.options.noValidation?e:this.assertLegalChar(this.attEscape(e=""+e||""))},e.prototype.insTarget=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.insValue=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return this.assertLegalChar(e)},e.prototype.xmlVersion=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e},e.prototype.xmlEncoding=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+e);return this.assertLegalChar(e)},e.prototype.xmlStandalone=function(e){return this.options.noValidation?e:e?"yes":"no"},e.prototype.dtdPubID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdSysID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdElementValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttType=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttDefault=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdEntityValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdNData=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.convertAttKey="@",e.prototype.convertPIKey="?",e.prototype.convertTextKey="#text",e.prototype.convertCDataKey="#cdata",e.prototype.convertCommentKey="#comment",e.prototype.convertRawKey="#raw",e.prototype.assertLegalChar=function(e){var t,r;if(this.options.noValidation)return e;if(t="","1.0"===this.options.version){if(t=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=e.match(t))throw new Error("Invalid character in string: "+e+" at index "+r.index)}else if("1.1"===this.options.version&&(t=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=e.match(t)))throw new Error("Invalid character in string: "+e+" at index "+r.index);return e},e.prototype.assertLegalName=function(e){var t;if(this.options.noValidation)return e;if(this.assertLegalChar(e),t=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!e.match(t))throw new Error("Invalid character in name");return e},e.prototype.textEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},e.prototype.attEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},e}()}).call(this)},4043(e,t,r){!function(e){e.parser=function(e,t){return new i(e,t)},e.SAXParser=i,e.SAXStream=s,e.createStream=function(e,t){return new s(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,r){if(!(this instanceof i))return new i(t,r);var o=this;!function(e){for(var t=0,r=n.length;t<r;t++)e[n[t]]=""}(o),o.q=o.c="",o.bufferCheckPosition=e.MAX_BUFFER_LENGTH,o.opt=r||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!t,o.noscript=!(!t&&!o.opt.noscript),o.state=O.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(p)),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),C(o,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),i.prototype={end:function(){D(this)},write:function(t){var r=this;if(this.error)throw this.error;if(r.closed)return A(r,"Cannot write after close. Assign an onready handler.");if(null===t)return D(r);"object"==typeof t&&(t=t.toString());for(var i=0,o="";o=j(t,i++),r.c=o,o;)switch(r.trackPosition&&(r.position++,"\n"===o?(r.line++,r.column=0):r.column++),r.state){case O.BEGIN:if(r.state=O.BEGIN_WHITESPACE,"\ufeff"===o)continue;U(r,o);continue;case O.BEGIN_WHITESPACE:U(r,o);continue;case O.TEXT:if(r.sawRoot&&!r.closedRoot){for(var s=i-1;o&&"<"!==o&&"&"!==o;)(o=j(t,i++))&&r.trackPosition&&(r.position++,"\n"===o?(r.line++,r.column=0):r.column++);r.textNode+=t.substring(s,i-1)}"<"!==o||r.sawRoot&&r.closedRoot&&!r.strict?(g(o)||r.sawRoot&&!r.closedRoot||x(r,"Text data outside of root node."),"&"===o?r.state=O.TEXT_ENTITY:r.textNode+=o):(r.state=O.OPEN_WAKA,r.startTagPosition=r.position);continue;case O.SCRIPT:"<"===o?r.state=O.SCRIPT_ENDING:r.script+=o;continue;case O.SCRIPT_ENDING:"/"===o?r.state=O.CLOSE_TAG:(r.script+="<"+o,r.state=O.SCRIPT);continue;case O.OPEN_WAKA:if("!"===o)r.state=O.SGML_DECL,r.sgmlDecl="";else if(g(o));else if(v(h,o))r.state=O.OPEN_TAG,r.tagName=o;else if("/"===o)r.state=O.CLOSE_TAG,r.tagName="";else if("?"===o)r.state=O.PROC_INST,r.procInstName=r.procInstBody="";else{if(x(r,"Unencoded <"),r.startTagPosition+1<r.position){var c=r.position-r.startTagPosition;o=new Array(c).join(" ")+o}r.textNode+="<"+o,r.state=O.TEXT}continue;case O.SGML_DECL:(r.sgmlDecl+o).toUpperCase()===a?(T(r,"onopencdata"),r.state=O.CDATA,r.sgmlDecl="",r.cdata=""):r.sgmlDecl+o==="--"?(r.state=O.COMMENT,r.comment="",r.sgmlDecl=""):(r.sgmlDecl+o).toUpperCase()===u?(r.state=O.DOCTYPE,(r.doctype||r.sawRoot)&&x(r,"Inappropriately located doctype declaration"),r.doctype="",r.sgmlDecl=""):">"===o?(T(r,"onsgmldeclaration",r.sgmlDecl),r.sgmlDecl="",r.state=O.TEXT):y(o)?(r.state=O.SGML_DECL_QUOTED,r.sgmlDecl+=o):r.sgmlDecl+=o;continue;case O.SGML_DECL_QUOTED:o===r.q&&(r.state=O.SGML_DECL,r.q=""),r.sgmlDecl+=o;continue;case O.DOCTYPE:">"===o?(r.state=O.TEXT,T(r,"ondoctype",r.doctype),r.doctype=!0):(r.doctype+=o,"["===o?r.state=O.DOCTYPE_DTD:y(o)&&(r.state=O.DOCTYPE_QUOTED,r.q=o));continue;case O.DOCTYPE_QUOTED:r.doctype+=o,o===r.q&&(r.q="",r.state=O.DOCTYPE);continue;case O.DOCTYPE_DTD:r.doctype+=o,"]"===o?r.state=O.DOCTYPE:y(o)&&(r.state=O.DOCTYPE_DTD_QUOTED,r.q=o);continue;case O.DOCTYPE_DTD_QUOTED:r.doctype+=o,o===r.q&&(r.state=O.DOCTYPE_DTD,r.q="");continue;case O.COMMENT:"-"===o?r.state=O.COMMENT_ENDING:r.comment+=o;continue;case O.COMMENT_ENDING:"-"===o?(r.state=O.COMMENT_ENDED,r.comment=N(r.opt,r.comment),r.comment&&T(r,"oncomment",r.comment),r.comment=""):(r.comment+="-"+o,r.state=O.COMMENT);continue;case O.COMMENT_ENDED:">"!==o?(x(r,"Malformed comment"),r.comment+="--"+o,r.state=O.COMMENT):r.state=O.TEXT;continue;case O.CDATA:"]"===o?r.state=O.CDATA_ENDING:r.cdata+=o;continue;case O.CDATA_ENDING:"]"===o?r.state=O.CDATA_ENDING_2:(r.cdata+="]"+o,r.state=O.CDATA);continue;case O.CDATA_ENDING_2:">"===o?(r.cdata&&T(r,"oncdata",r.cdata),T(r,"onclosecdata"),r.cdata="",r.state=O.TEXT):"]"===o?r.cdata+="]":(r.cdata+="]]"+o,r.state=O.CDATA);continue;case O.PROC_INST:"?"===o?r.state=O.PROC_INST_ENDING:g(o)?r.state=O.PROC_INST_BODY:r.procInstName+=o;continue;case O.PROC_INST_BODY:if(!r.procInstBody&&g(o))continue;"?"===o?r.state=O.PROC_INST_ENDING:r.procInstBody+=o;continue;case O.PROC_INST_ENDING:">"===o?(T(r,"onprocessinginstruction",{name:r.procInstName,body:r.procInstBody}),r.procInstName=r.procInstBody="",r.state=O.TEXT):(r.procInstBody+="?"+o,r.state=O.PROC_INST_BODY);continue;case O.OPEN_TAG:v(d,o)?r.tagName+=o:(k(r),">"===o?F(r):"/"===o?r.state=O.OPEN_TAG_SLASH:(g(o)||x(r,"Invalid character in tag name"),r.state=O.ATTRIB));continue;case O.OPEN_TAG_SLASH:">"===o?(F(r,!0),L(r)):(x(r,"Forward-slash in opening tag not followed by >"),r.state=O.ATTRIB);continue;case O.ATTRIB:if(g(o))continue;">"===o?F(r):"/"===o?r.state=O.OPEN_TAG_SLASH:v(h,o)?(r.attribName=o,r.attribValue="",r.state=O.ATTRIB_NAME):x(r,"Invalid attribute name");continue;case O.ATTRIB_NAME:"="===o?r.state=O.ATTRIB_VALUE:">"===o?(x(r,"Attribute without value"),r.attribValue=r.attribName,B(r),F(r)):g(o)?r.state=O.ATTRIB_NAME_SAW_WHITE:v(d,o)?r.attribName+=o:x(r,"Invalid attribute name");continue;case O.ATTRIB_NAME_SAW_WHITE:if("="===o)r.state=O.ATTRIB_VALUE;else{if(g(o))continue;x(r,"Attribute without value"),r.tag.attributes[r.attribName]="",r.attribValue="",T(r,"onattribute",{name:r.attribName,value:""}),r.attribName="",">"===o?F(r):v(h,o)?(r.attribName=o,r.state=O.ATTRIB_NAME):(x(r,"Invalid attribute name"),r.state=O.ATTRIB)}continue;case O.ATTRIB_VALUE:if(g(o))continue;y(o)?(r.q=o,r.state=O.ATTRIB_VALUE_QUOTED):(x(r,"Unquoted attribute value"),r.state=O.ATTRIB_VALUE_UNQUOTED,r.attribValue=o);continue;case O.ATTRIB_VALUE_QUOTED:if(o!==r.q){"&"===o?r.state=O.ATTRIB_VALUE_ENTITY_Q:r.attribValue+=o;continue}B(r),r.q="",r.state=O.ATTRIB_VALUE_CLOSED;continue;case O.ATTRIB_VALUE_CLOSED:g(o)?r.state=O.ATTRIB:">"===o?F(r):"/"===o?r.state=O.OPEN_TAG_SLASH:v(h,o)?(x(r,"No whitespace between attributes"),r.attribName=o,r.attribValue="",r.state=O.ATTRIB_NAME):x(r,"Invalid attribute name");continue;case O.ATTRIB_VALUE_UNQUOTED:if(!b(o)){"&"===o?r.state=O.ATTRIB_VALUE_ENTITY_U:r.attribValue+=o;continue}B(r),">"===o?F(r):r.state=O.ATTRIB;continue;case O.CLOSE_TAG:if(r.tagName)">"===o?L(r):v(d,o)?r.tagName+=o:r.script?(r.script+="</"+r.tagName,r.tagName="",r.state=O.SCRIPT):(g(o)||x(r,"Invalid tagname in closing tag"),r.state=O.CLOSE_TAG_SAW_WHITE);else{if(g(o))continue;w(h,o)?r.script?(r.script+="</"+o,r.state=O.SCRIPT):x(r,"Invalid tagname in closing tag."):r.tagName=o}continue;case O.CLOSE_TAG_SAW_WHITE:if(g(o))continue;">"===o?L(r):x(r,"Invalid characters in closing tag");continue;case O.TEXT_ENTITY:case O.ATTRIB_VALUE_ENTITY_Q:case O.ATTRIB_VALUE_ENTITY_U:var l,p;switch(r.state){case O.TEXT_ENTITY:l=O.TEXT,p="textNode";break;case O.ATTRIB_VALUE_ENTITY_Q:l=O.ATTRIB_VALUE_QUOTED,p="attribValue";break;case O.ATTRIB_VALUE_ENTITY_U:l=O.ATTRIB_VALUE_UNQUOTED,p="attribValue"}";"===o?(r[p]+=M(r),r.entity="",r.state=l):v(r.entity.length?m:f,o)?r.entity+=o:(x(r,"Invalid character in entity name"),r[p]+="&"+r.entity+o,r.entity="",r.state=l);continue;default:throw new Error(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&function(t){for(var r=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,o=0,s=n.length;o<s;o++){var a=t[n[o]].length;if(a>r)switch(n[o]){case"textNode":P(t);break;case"cdata":T(t,"oncdata",t.cdata),t.cdata="";break;case"script":T(t,"onscript",t.script),t.script="";break;default:A(t,"Max buffer length exceeded: "+n[o])}i=Math.max(i,a)}var u=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=u+t.position}(r),r},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;P(e=this),""!==e.cdata&&(T(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(T(e,"onscript",e.script),e.script="")}};try{t=r(2203).Stream}catch(e){t=function(){}}var o=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function s(e,r){if(!(this instanceof s))return new s(e,r);t.apply(this),this._parser=new i(e,r),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,o.forEach((function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(t.prototype,{constructor:{value:s}}),s.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=r(3193).StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},s.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},s.prototype.on=function(e,r){var n=this;return n._parser["on"+e]||-1===o.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),t.prototype.on.call(n,e,r)};var a="[CDATA[",u="DOCTYPE",c="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/2000/xmlns/",p={xml:c,xmlns:l},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function y(e){return'"'===e||"'"===e}function b(e){return">"===e||g(e)}function v(e,t){return e.test(t)}function w(e,t){return!v(e,t)}var I,_,E,O=0;for(var S in e.STATE={BEGIN:O++,BEGIN_WHITESPACE:O++,TEXT:O++,TEXT_ENTITY:O++,OPEN_WAKA:O++,SGML_DECL:O++,SGML_DECL_QUOTED:O++,DOCTYPE:O++,DOCTYPE_QUOTED:O++,DOCTYPE_DTD:O++,DOCTYPE_DTD_QUOTED:O++,COMMENT_STARTING:O++,COMMENT:O++,COMMENT_ENDING:O++,COMMENT_ENDED:O++,CDATA:O++,CDATA_ENDING:O++,CDATA_ENDING_2:O++,PROC_INST:O++,PROC_INST_BODY:O++,PROC_INST_ENDING:O++,OPEN_TAG:O++,OPEN_TAG_SLASH:O++,ATTRIB:O++,ATTRIB_NAME:O++,ATTRIB_NAME_SAW_WHITE:O++,ATTRIB_VALUE:O++,ATTRIB_VALUE_QUOTED:O++,ATTRIB_VALUE_CLOSED:O++,ATTRIB_VALUE_UNQUOTED:O++,ATTRIB_VALUE_ENTITY_Q:O++,ATTRIB_VALUE_ENTITY_U:O++,CLOSE_TAG:O++,CLOSE_TAG_SAW_WHITE:O++,SCRIPT:O++,SCRIPT_ENDING:O++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var r=e.ENTITIES[t],n="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=n})),e.STATE)e.STATE[e.STATE[S]]=S;function C(e,t,r){e[t]&&e[t](r)}function T(e,t,r){e.textNode&&P(e),C(e,t,r)}function P(e){e.textNode=N(e.opt,e.textNode),e.textNode&&C(e,"ontext",e.textNode),e.textNode=""}function N(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function A(e,t){return P(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,C(e,"onerror",t),e}function D(e){return e.sawRoot&&!e.closedRoot&&x(e,"Unclosed root tag"),e.state!==O.BEGIN&&e.state!==O.BEGIN_WHITESPACE&&e.state!==O.TEXT&&A(e,"Unexpected end"),P(e),e.c="",e.closed=!0,C(e,"onend"),i.call(e,e.strict,e.opt),e}function x(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&A(e,t)}function k(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,T(e,"onopentagstart",r)}function R(e,t){var r=e.indexOf(":")<0?["",e]:e.split(":"),n=r[0],i=r[1];return t&&"xmlns"===e&&(n="xmlns",i=""),{prefix:n,local:i}}function B(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=R(e.attribName,!0),r=t.prefix,n=t.local;if("xmlns"===r)if("xml"===n&&e.attribValue!==c)x(e,"xml: prefix must be bound to "+c+"\nActual: "+e.attribValue);else if("xmlns"===n&&e.attribValue!==l)x(e,"xmlns: prefix must be bound to "+l+"\nActual: "+e.attribValue);else{var i=e.tag,o=e.tags[e.tags.length-1]||e;i.ns===o.ns&&(i.ns=Object.create(o.ns)),i.ns[n]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,T(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function F(e,t){if(e.opt.xmlns){var r=e.tag,n=R(e.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(x(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=n.prefix);var i=e.tags[e.tags.length-1]||e;r.ns&&i.ns!==r.ns&&Object.keys(r.ns).forEach((function(t){T(e,"onopennamespace",{prefix:t,uri:r.ns[t]})}));for(var o=0,s=e.attribList.length;o<s;o++){var a=e.attribList[o],u=a[0],c=a[1],l=R(u,!0),p=l.prefix,h=l.local,d=""===p?"":r.ns[p]||"",f={name:u,value:c,prefix:p,local:h,uri:d};p&&"xmlns"!==p&&!d&&(x(e,"Unbound namespace prefix: "+JSON.stringify(p)),f.uri=p),e.tag.attributes[u]=f,T(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),T(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=O.TEXT:e.state=O.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function L(e){if(!e.tagName)return x(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=O.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=O.SCRIPT);T(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var n=r;t--&&e.tags[t].name!==n;)x(e,"Unexpected close tag");if(t<0)return x(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=O.TEXT);e.tagName=r;for(var i=e.tags.length;i-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,T(e,"onclosetag",e.tagName);var s={};for(var a in o.ns)s[a]=o.ns[a];var u=e.tags[e.tags.length-1]||e;e.opt.xmlns&&o.ns!==u.ns&&Object.keys(o.ns).forEach((function(t){var r=o.ns[t];T(e,"onclosenamespace",{prefix:t,uri:r})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=O.TEXT}function M(e){var t,r=e.entity,n=r.toLowerCase(),i="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[n]?e.ENTITIES[n]:("#"===(r=n).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),i=(t=parseInt(r,16)).toString(16)):(r=r.slice(1),i=(t=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==r?(x(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function U(e,t){"<"===t?(e.state=O.OPEN_WAKA,e.startTagPosition=e.position):g(t)||(x(e,"Non-whitespace before first tag."),e.textNode=t,e.state=O.TEXT)}function j(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}O=e.STATE,String.fromCodePoint||(I=String.fromCharCode,_=Math.floor,E=function(){var e,t,r=[],n=-1,i=arguments.length;if(!i)return"";for(var o="";++n<i;){var s=Number(arguments[n]);if(!isFinite(s)||s<0||s>1114111||_(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?r.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,r.push(e,t)),(n+1===i||r.length>16384)&&(o+=I.apply(null,r),r.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:E,configurable:!0,writable:!0}):String.fromCodePoint=E)}(t)},4044(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const n=r(1635),i=r(360),o=n.__importDefault(r(6022));t.IpcWrapper=class{#S;#C;#T;#P=1;#N=new Map;constructor(e,t,r){this.#S=e,this.#C=t,this.#T=r}async sendWithCb(e,t,r,n=0){n<=0&&(n=this.#T);const i={timeout:void 0,resolve:()=>null,reject:()=>null},s=new Promise(((e,t)=>{i.resolve=e,i.reject=t}));this.#P>268435456&&(this.#P=1);const a=this.#P++;this.#N.set(a,i),this.#C({direction:"call",name:String(e),payload:o.default.stringify(t),callbackId:a});const u=new Error("Call timed out");return i.timeout=setTimeout((()=>{i.reject(r?r():u),this.#N.delete(a)}),n),s}sendWithNoCb(e,t){this.#C({direction:"call",name:String(e),payload:o.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#S[e.name];if(!t)return void(e.callbackId&&this.#C({direction:"response",callbackId:e.callbackId,success:!1,payload:o.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?o.default.parse(e.payload):void 0).then((t=>{e.callbackId&&this.#C({direction:"response",callbackId:e.callbackId,success:!0,payload:o.default.stringify(t)})}),(t=>{e.callbackId&&this.#C({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):o.default.stringify(t)})}));break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#N.get(e.callbackId);if(this.#N.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const r=e.payload?o.default.parse(e.payload):void 0;if(e.success)t.resolve(r);else{let e=r;r&&"object"==typeof r&&"message"in r&&(e=new Error(r.message),r.stack&&(e.stack=r.stack)),t.reject(e)}break}default:(0,i.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},4111(e,t,r){(function(){var t,n,i={}.hasOwnProperty;n=r(468),t=r(1737),e.exports=function(e){function r(e,n,i,o,s,a){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==i)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!o)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(a&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(i),this.attributeType=this.stringify.dtdAttType(o),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=s}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},4130(e,t,r){(function(){var t,n,i,o={}.hasOwnProperty;i=r(9241).isObject,n=r(468),t=r(1737),e.exports=function(e){function r(e,n,o,s){var a;r.__super__.constructor.call(this,e),i(n)&&(n=(a=n).version,o=a.encoding,s=a.standalone),n||(n="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(n),null!=o&&(this.encoding=this.stringify.xmlEncoding(o)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}return function(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.declaration(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},4238(e,t,r){(function(){var t;t=r(1737),r(468),e.exports=function(){function e(e,r,n){if(this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==r)throw new Error("Missing attribute name. "+this.debugInfo(r));this.name=this.stringify.name(r),this.value=this.stringify.attValue(n),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(e){return this.options.writer.attribute(this,this.options.writer.filterOptions(e))},e.prototype.debugInfo=function(e){return null==(e=e||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+e+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(e){return e.namespaceURI===this.namespaceURI&&e.prefix===this.prefix&&e.localName===this.localName&&e.value===this.value},e}()}).call(this)},4289(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const n=r(2593);function i(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#A;#D;#x;#k;#R=new Map;#B=new Map;constructor(e,t,r,n){this.#A=e,this.#D=t,this.#x=r,this.#k=n}async handleExecuteAction(e){const t=this.#R.get(e.action.actionId);if(!t)return{success:!1,errorMessage:`Action definition not found for: ${e.action.actionId}`};const r={parseVariablesInString:async t=>(await this.#A({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:(t,r)=>{this.#x({customVariableId:t,value:r,controlId:e.action.controlId})}};try{return await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},r),{success:!0,errorMessage:void 0}}catch(e){return{success:!1,errorMessage:e?.message??String(e)}}}handleUpdateActions(e){for(const[t,r]of Object.entries(e)){const e=this.#B.get(t);if(e){const t=this.#R.get(e.actionId);if(t?.unsubscribe&&!t.skipUnsubscribeOnOptionsChange){const r={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(i(e),r)).catch((t=>{this.#k("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!r||r.disabled)this.#B.delete(t);else{this.#B.set(t,r);const e=this.#R.get(r.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during subscribe")}};Promise.resolve(e.subscribe(i(r),t)).catch((e=>{this.#k("error",`Action subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}))}}}}async handleLearnAction(e){const t=this.#R.get(e.action.actionId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#A({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during learn")}};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},r)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#R.clear();for(const[r,i]of Object.entries(e))i&&(t.push({id:r,name:i.name,description:i.description,options:(0,n.serializeIsVisibleFn)(i.options),optionsToIgnoreForSubscribe:i.optionsToIgnoreForSubscribe,hasLearn:!!i.learn,learnTimeout:i.learnTimeout,hasLifecycleFunctions:!!i.subscribe||!!i.unsubscribe}),this.#R.set(r,i));this.#D({actions:t})}subscribeActions(e){let t=Array.from(this.#B.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.actionId))));for(const e of t){const t=this.#R.get(e.actionId);if(t?.subscribe){const r={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during subscribe")}};Promise.resolve(t.subscribe(i(e),r)).catch((t=>{this.#k("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeActions(e){let t=Array.from(this.#B.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.actionId))));for(const e of t){const t=this.#R.get(e.actionId);if(t&&t.unsubscribe){const r={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(i(e),r)).catch((t=>{this.#k("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},4324(e,t,r){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(8048):e.exports=r(5170)},4326(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=function(e,t){Promise.resolve().then((async()=>{if(l)throw new Error("runEntrypoint can only be called once");if(l=!0,t||(t=[]),!Array.isArray(t))throw new Error("upgradeScripts must be an array");for(const e of t)if("function"!=typeof e)throw new Error("upgradeScripts must be an array of functions");const r=process.env.MODULE_MANIFEST;if(!r)throw new Error("Module initialise is missing MODULE_MANIFEST");const n=await o.default.readFile(r),p=JSON.parse(n.toString());if(p.runtime?.api!==i.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!p.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let h=p.runtime.apiVersion;if("0.0.0"===h)try{const e=await o.default.readFile(u.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(h=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const d=process.env.CONNECTION_ID;if("string"!=typeof d||!d)throw new Error("Module initialise is missing CONNECTION_ID");const f=process.env.VERIFICATION_TOKEN;if("string"!=typeof f||!f)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const m=new a.IpcWrapper({},(e=>{process.send(e)}),5e3);process.once("message",(e=>{m.receivedMessage(e)})),c=new e((0,s.literal)({id:d,upgradeScripts:t,_isInstanceBaseProps:!0})),m.sendWithCb("register",{apiVersion:h,connectionId:d,verificationToken:f}).then((()=>{console.log("Module-host accepted registration")}),(e=>{console.error("Module registration failed",e),process.exit(11)}))})).catch((e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)}))};const n=r(1635),i=r(9967),o=n.__importDefault(r(1943)),s=r(360),a=r(4044),u=n.__importDefault(r(6928));let c,l=!1},4434(e){"use strict";e.exports=require("events")},4493(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4581(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4617(e){"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},4767(e,t,r){var n=r(2524).al,i=r(7575),o=r(7194),s=r(9278),a=r(4434),u=r(9023),c=r(6982),l=r(3347),p=!1,h=-2147483648,d=2147483647,f=4294967295;function m(e){p&&console.debug(e)}function g(e){var t=[];for(var r in e)t.push(r);for(var n=0;n<t.length;n++)e[e[t[n]]]=parseInt(t[n])}var y={0:"NoError",1:"TooBig",2:"NoSuchName",3:"BadValue",4:"ReadOnly",5:"GeneralError",6:"NoAccess",7:"WrongType",8:"WrongLength",9:"WrongEncoding",10:"WrongValue",11:"NoCreation",12:"InconsistentValue",13:"ResourceUnavailable",14:"CommitFailed",15:"UndoFailed",16:"AuthorizationError",17:"NotWritable",18:"InconsistentName"};g(y);var b={1:"Boolean",2:"Integer",3:"BitString",4:"OctetString",5:"Null",6:"OID",64:"IpAddress",65:"Counter",66:"Gauge",67:"TimeTicks",68:"Opaque",70:"Counter64",128:"NoSuchObject",129:"NoSuchInstance",130:"EndOfMibView"};g(b),b.INTEGER=b.Integer,b["OCTET STRING"]=b.OctetString,b["OBJECT IDENTIFIER"]=b.OID,b.Integer32=b.Integer,b.Counter32=b.Counter,b.Gauge32=b.Gauge,b.Unsigned32=b.Gauge32;var v={160:"GetRequest",161:"GetNextRequest",162:"GetResponse",163:"SetRequest",164:"Trap",165:"GetBulkRequest",166:"InformRequest",167:"TrapV2",168:"Report"};g(v);var w={0:"ColdStart",1:"WarmStart",2:"LinkDown",3:"LinkUp",4:"AuthenticationFailure",5:"EgpNeighborLoss",6:"EnterpriseSpecific"};g(w);var I={1:"noAuthNoPriv",2:"authNoPriv",3:"authPriv"};g(I);var _={1:"none",2:"md5",3:"sha",4:"sha224",5:"sha256",6:"sha384",7:"sha512"};g(_);var E={1:"none",2:"des",4:"aes",6:"aes256b",8:"aes256r"};g(E);var O="1.3.6.1.6.3.15.1.1",S={1:"Unsupported Security Level",2:"Not In Time Window",3:"Unknown User Name",4:"Unknown Engine ID",5:"Wrong Digest (incorrect password, community or key)",6:"Decryption Error"};g(S);var C={1:"Scalar",2:"Table"};g(C);var T={1:"Open",2:"Close",3:"Register",4:"Unregister",5:"Get",6:"GetNext",7:"GetBulk",8:"TestSet",9:"CommitSet",10:"UndoSet",11:"CleanupSet",12:"Notify",13:"Ping",14:"IndexAllocate",15:"IndexDeallocate",16:"AddAgentCaps",17:"RemoveAgentCaps",18:"Response"};g(T);var P={0:"None",1:"Simple"};g(P);var N={0:"None",1:"ReadOnly",2:"ReadWrite"};g(N);var A={0:"not-accessible",1:"accessible-for-notify",2:"read-only",3:"read-write",4:"read-create"};g(A);var D={"not-accessible":"not-accessible","read-only":"read-only","read-write":"read-write","write-only":"read-write"},x={1:"active",2:"notInService",3:"notReady",4:"createAndGo",5:"createAndWait",6:"destroy"};g(x);var k={1:"EIp4AddressSize",2:"EUnknownObjectType",3:"EUnknownPduType",4:"ECouldNotDecrypt",5:"EAuthFailure",6:"EReqResOidNoMatch",8:"EOutOfOrder",9:"EVersionNoMatch",10:"ECommunityNoMatch",11:"EUnexpectedReport",12:"EResponseNotHandled",13:"EUnexpectedResponse"};function R(e,t,r){this.name="ResponseInvalidError",this.message=e,this.code=t,this.info=r,Error.captureStackTrace(this,R)}function B(e){this.name="RequestInvalidError",this.message=e,Error.captureStackTrace(this,B)}function F(e,t){this.name="RequestFailedError",this.message=e,this.status=t,Error.captureStackTrace(this,F)}function L(e){this.name="RequestTimedOutError",this.message=e,Error.captureStackTrace(this,L)}function M(e,t,r,n){this.name="ProcessingError",this.message=e,this.error=t,this.rinfo=r,this.buffer=n,Error.captureStackTrace(this,M)}function U(e){return!(e.type!=b.NoSuchObject&&e.type!=b.NoSuchInstance&&e.type!=b.EndOfMibView)}function j(e){return(b[e.type]||"NotAnError")+": "+e.oid}function V(e,t){var r={str:e,len:e.length,idx:0},n={str:t,len:t.length,idx:0},i=".".charCodeAt(0);function o(e){var t=0;if(e.idx>=e.len)return null;for(;e.idx<e.len;){var r=e.str.charCodeAt(e.idx++);if(r==i)return t;t=(t?10*t:t)+(r-48)}return t}for(;;){var s=o(r),a=o(n);if(null===s)return!0;if(null===a)return!0;if(a>s)return!0;if(a<s)return!1}}function G(e,t){var r=e.split("."),n=t.split(".");if(r.length>n.length)return!1;for(var i=0;i<r.length;i++)if(n[i]!=r[i])return!1;return!0}function q(e){var t=e.readInt();if(!Number.isInteger(t))throw new TypeError("Value read as integer "+t+" is not an integer");if(t<h||t>d)throw new RangeError("Read integer "+t+" is outside the signed 32-bit range");return t}function K(e){var t=e.readInt();if(!Number.isInteger(t))throw new TypeError("Value read as integer "+t+" is not an integer");if(t<0||t>f)throw new RangeError("Read integer "+t+" is outside the unsigned 32-bit range");return t}function z(e){return e.readString(b.Counter64,!0)}function $(e){var t=e.readString(b.IpAddress,!0);if(4!=t.length)throw new R("Length '"+t.length+"' of IP address '"+t.toString("hex")+"' is not 4",k.EIp4AddressSize);return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}function H(e,t){var r;if(t==b.Boolean)r=e.readBoolean();else if(t==b.Integer)r=q(e);else if(t==b.BitString)r=e.readBitString();else if(t==b.OctetString)r=e.readString(null,!0);else if(t==b.Null)e.readByte(),e.readByte(),r=null;else if(t==b.OID)r=e.readOID();else if(t==b.IpAddress)r=$(e);else if(t==b.Counter)r=K(e);else if(t==b.Gauge)r=K(e);else if(t==b.TimeTicks)r=K(e);else if(t==b.Opaque)r=e.readString(b.Opaque,!0);else if(t==b.Counter64)r=z(e);else if(t==b.NoSuchObject)e.readByte(),e.readByte(),r=null;else if(t==b.NoSuchInstance)e.readByte(),e.readByte(),r=null;else{if(t!=b.EndOfMibView)throw new R("Unknown type '"+t+"' in response",k.EUnknownObjectType);e.readByte(),e.readByte(),r=null}return r}function Y(e,t){for(e.readSequence();e.readSequence(),e.peek()==b.OID;){var r=e.readOID(),n=e.peek();if(null==n)break;var i=H(e,n);t.push({oid:r,type:n,value:i})}}function W(e,t,r){if(!Number.isInteger(r))throw new TypeError("Value to write as integer "+r+" is not an integer");if(r<h||r>d)throw new RangeError("Integer to write "+r+" is outside the signed 32-bit range");e.writeInt(r,t)}function J(e,t,r){if(!Number.isInteger(r))throw new TypeError("Value to write as integer "+r+" is not an integer");if(r<0||r>f)throw new RangeError("Integer to write "+r+" is outside the unsigned 32-bit range");e.writeInt(r,t)}function Q(e,t){e.writeBuffer(t,b.Counter64)}function X(e,t){e.startSequence();for(var r=0;r<t.length;r++){if(e.startSequence(),e.writeOID(t[r].oid),t[r].type&&t[r].hasOwnProperty("value")){var n=t[r].type,i=t[r].value;switch(n){case b.Boolean:e.writeBoolean(!!i);break;case b.Integer:W(e,b.Integer,i);break;case b.OctetString:"string"==typeof i?e.writeString(i):e.writeBuffer(i,b.OctetString);break;case b.Null:e.writeNull();break;case b.OID:e.writeOID(i);break;case b.IpAddress:var o=i.split(".");if(4!=o.length)throw new B("Invalid IP address '"+i+"'");e.writeBuffer(Buffer.from(o),64);break;case b.Counter:J(e,b.Counter,i);break;case b.Gauge:J(e,b.Gauge,i);break;case b.TimeTicks:J(e,b.TimeTicks,i);break;case b.Opaque:e.writeBuffer(i,b.Opaque);break;case b.Counter64:Q(e,i);break;case b.NoSuchObject:case b.NoSuchInstance:case b.EndOfMibView:e.writeByte(n),e.writeByte(0);break;default:throw new B("Unknown type '"+n+"' in request")}}else e.writeNull();e.endSequence()}e.endSequence()}g(k),u.inherits(R,Error),u.inherits(B,Error),u.inherits(F,Error),u.inherits(L,Error),u.inherits(M,Error);var Z=function(){};Z.prototype.toBuffer=function(e){e.startSequence(this.type),W(e,b.Integer,this.id),W(e,b.Integer,this.type==v.GetBulkRequest&&this.options.nonRepeaters||0),W(e,b.Integer,this.type==v.GetBulkRequest&&this.options.maxRepetitions||0),X(e,this.varbinds),e.endSequence()},Z.prototype.initializeFromVariables=function(e,t,r){this.id=e,this.varbinds=t,this.options=r||{},this.contextName=r&&r.context?r.context:""},Z.prototype.initializeFromBuffer=function(e){this.type=e.peek(),e.readSequence(),this.id=q(e),this.nonRepeaters=q(e),this.maxRepetitions=q(e),this.varbinds=[],Y(e,this.varbinds)},Z.prototype.getResponsePduForRequest=function(){var e=ue.createFromVariables(this.id,[],{});return this.contextEngineID&&(e.contextEngineID=this.contextEngineID,e.contextName=this.contextName),e},Z.createFromVariables=function(e,t,r,n){var i=new e(t,r,n);return i.id=t,i.varbinds=r,i.options=n||{},i.contextName=n&&n.context?n.context:"",i};var ee=function(){this.type=v.GetBulkRequest,ee.super_.apply(this,arguments)};u.inherits(ee,Z),ee.createFromBuffer=function(e){var t=new ee;return t.initializeFromBuffer(e),t};var te=function(){this.type=v.GetNextRequest,te.super_.apply(this,arguments)};u.inherits(te,Z),te.createFromBuffer=function(e){var t=new te;return t.initializeFromBuffer(e),t};var re=function(){this.type=v.GetRequest,re.super_.apply(this,arguments)};u.inherits(re,Z),re.createFromBuffer=function(e){var t=new re;return t.initializeFromBuffer(e),t},re.createFromVariables=function(e,t,r){var n=new re;return n.initializeFromVariables(e,t,r),n};var ne=function(){this.type=v.InformRequest,ne.super_.apply(this,arguments)};u.inherits(ne,Z),ne.createFromBuffer=function(e){var t=new ne;return t.initializeFromBuffer(e),t};var ie=function(){this.type=v.SetRequest,ie.super_.apply(this,arguments)};u.inherits(ie,Z),ie.createFromBuffer=function(e){var t=new ie;return t.initializeFromBuffer(e),t};var oe=function(){this.type=v.Trap};oe.prototype.toBuffer=function(e){e.startSequence(this.type),e.writeOID(this.enterprise),e.writeBuffer(Buffer.from(this.agentAddr.split(".")),b.IpAddress),W(e,b.Integer,this.generic),W(e,b.Integer,this.specific),J(e,b.TimeTicks,this.upTime||Math.floor(100*process.uptime())),X(e,this.varbinds),e.endSequence()},oe.createFromBuffer=function(e){var t=new oe;return e.readSequence(),t.enterprise=e.readOID(),t.agentAddr=$(e),t.generic=q(e),t.specific=q(e),t.upTime=K(e),t.varbinds=[],Y(e,t.varbinds),t},oe.createFromVariables=function(e,t,r){var n=new oe;return n.agentAddr=r.agentAddr||"127.0.0.1",n.upTime=r.upTime,"string"==typeof e?(n.generic=w.EnterpriseSpecific,n.specific=parseInt(e.match(/\.(\d+)$/)[1]),n.enterprise=e.replace(/\.(\d+)$/,"")):(n.generic=e,n.specific=0,n.enterprise="1.3.6.1.4.1"),n.varbinds=t,n};var se=function(){this.type=v.TrapV2,se.super_.apply(this,arguments)};u.inherits(se,Z),se.createFromBuffer=function(e){var t=new se;return t.initializeFromBuffer(e),t},se.createFromVariables=function(e,t,r){var n=new se;return n.initializeFromVariables(e,t,r),n};var ae=function(){};ae.prototype.toBuffer=function(e){e.startSequence(this.type),W(e,b.Integer,this.id),W(e,b.Integer,this.errorStatus||0),W(e,b.Integer,this.errorIndex||0),X(e,this.varbinds),e.endSequence()},ae.prototype.initializeFromBuffer=function(e){e.readSequence(this.type),this.id=q(e),this.errorStatus=q(e),this.errorIndex=q(e),this.varbinds=[],Y(e,this.varbinds)},ae.prototype.initializeFromVariables=function(e,t,r){this.id=e,this.varbinds=t,this.options=r||{}};var ue=function(){this.type=v.GetResponse,ue.super_.apply(this,arguments)};u.inherits(ue,ae),ue.createFromBuffer=function(e){var t=new ue;return t.initializeFromBuffer(e),t},ue.createFromVariables=function(e,t,r){var n=new ue;return n.initializeFromVariables(e,t,r),n};var ce=function(){this.type=v.Report,ce.super_.apply(this,arguments)};u.inherits(ce,ae),ce.createFromBuffer=function(e){var t=new ce;return t.initializeFromBuffer(e),t},ce.createFromVariables=function(e,t,r){var n=new ce;return n.initializeFromVariables(e,t,r),n};var le=function(e,t){var r,i,o;t&&(i=(e=new n.Reader(e.readString(n.Sequence|n.Constructor,!0))).readString(n.OctetString,!0),o=e.readString());var s=e.peek();if(s==v.GetResponse)r=ue.createFromBuffer(e);else if(s==v.Report)r=ce.createFromBuffer(e);else if(s==v.Trap)r=oe.createFromBuffer(e);else if(s==v.TrapV2)r=se.createFromBuffer(e);else if(s==v.InformRequest)r=ne.createFromBuffer(e);else if(s==v.GetRequest)r=re.createFromBuffer(e);else if(s==v.SetRequest)r=ie.createFromBuffer(e);else if(s==v.GetNextRequest)r=te.createFromBuffer(e);else{if(s!=v.GetBulkRequest)throw new R("Unknown PDU type '"+s+"' in response",k.EUnknownPduType);r=ee.createFromBuffer(e)}return t&&(r.contextEngineID=i,r.contextName=o),r.scoped=t,r},pe={HMAC_BUFFER_SIZE:1048576,algorithms:{}};pe.algorithms[_.md5]={KEY_LENGTH:16,AUTHENTICATION_CODE_LENGTH:12,CRYPTO_ALGORITHM:"md5"},pe.algorithms[_.sha]={KEY_LENGTH:20,AUTHENTICATION_CODE_LENGTH:12,CRYPTO_ALGORITHM:"sha1"},pe.algorithms[_.sha224]={KEY_LENGTH:28,AUTHENTICATION_CODE_LENGTH:16,CRYPTO_ALGORITHM:"sha224"},pe.algorithms[_.sha256]={KEY_LENGTH:32,AUTHENTICATION_CODE_LENGTH:24,CRYPTO_ALGORITHM:"sha256"},pe.algorithms[_.sha384]={KEY_LENGTH:48,AUTHENTICATION_CODE_LENGTH:32,CRYPTO_ALGORITHM:"sha384"},pe.algorithms[_.sha512]={KEY_LENGTH:64,AUTHENTICATION_CODE_LENGTH:48,CRYPTO_ALGORITHM:"sha512"},pe.authToKeyCache={},pe.computeCacheKey=function(e,t,r){return e+t+r.toString("base64")},pe.passwordToKey=function(e,t,r){var n,i,o,s,a=pe.algorithms[e].CRYPTO_ALGORITHM,u=pe.computeCacheKey(e,t,r);return void 0!==pe.authToKeyCache[u]?pe.authToKeyCache[u]:(s=Buffer.alloc(pe.HMAC_BUFFER_SIZE,t),(n=c.createHash(a)).update(s),i=n.digest(),(n=c.createHash(a)).update(i),n.update(r),n.update(i),o=n.digest(),pe.authToKeyCache[u]=o,o)},pe.getParametersLength=function(e){return pe.algorithms[e].AUTHENTICATION_CODE_LENGTH},pe.writeParameters=function(e,t,r,n,i){pe.calculateDigest(e,t,r,n).copy(i)},pe.isAuthentic=function(e,t,r,n,i){var o,s;return i.length===pe.algorithms[t].AUTHENTICATION_CODE_LENGTH&&(o=Buffer.from(i),i.fill(0),s=pe.calculateDigest(e,t,r,n),o.copy(i),s.equals(i))},pe.calculateDigest=function(e,t,r,n){var i=pe.passwordToKey(t,r,n),o=pe.algorithms[t].CRYPTO_ALGORITHM,s=c.createHmac(o,i);return s.update(e),s.digest().subarray(0,pe.algorithms[t].AUTHENTICATION_CODE_LENGTH)};var he={encryptPdu:function(e,t,r,n,i){return(0,he.algorithms[e].encryptPdu)(t,e,r,n,i)},decryptPdu:function(e,t,r,n,i,o){return(0,he.algorithms[e].decryptPdu)(t,e,r,n,i,o)},debugEncrypt:function(e,t,r,n){m("Key: "+e.toString("hex")),m("IV:  "+t.toString("hex")),m("Plain:     "+r.toString("hex")),m("Encrypted: "+n.toString("hex"))},debugDecrypt:function(e,t,r,n){m("Key: "+e.toString("hex")),m("IV:  "+t.toString("hex")),m("Encrypted: "+r.toString("hex")),m("Plain:     "+n.toString("hex"))},generateLocalizedKey:function(e,t,r,n){var i,o;return i=pe.passwordToKey(t,r,n),o=Buffer.alloc(e.KEY_LENGTH),i.copy(o,0,0,e.KEY_LENGTH),o},generateLocalizedKeyBlumenthal:function(e,t,r,n){let i,o,s,a,u,l,p;i=pe.algorithms[t].KEY_LENGTH,a=Math.ceil(e.KEY_LENGTH/i),s=Buffer.alloc(e.KEY_LENGTH),o=pe.passwordToKey(t,r,n),l=o;for(let e=0;e<a;e++)l.copy(s,e*i,0,i),e<a-1&&(p=c.createHash(pe.algorithms[t].CRYPTO_ALGORITHM),u=Buffer.alloc((e+1)*i),s.copy(u,e*i,0,(e+1)*i),p.update(u),l=p.digest());return s},generateLocalizedKeyReeder:function(e,t,r,n){let i,o,s,a,u;i=pe.algorithms[t].KEY_LENGTH,a=Math.ceil(e.KEY_LENGTH/i),s=Buffer.alloc(e.KEY_LENGTH),u=r;for(let e=0;e<a;e++)o=pe.passwordToKey(t,u,n),o.copy(s,e*i,0,i),u=o;return s},encryptPduDes:function(e,t,r,n,i){var o,s,a,u,l,p,h,d,f,m,g=he.algorithms[E.des];for(he.generateLocalizedKey(g,n,r,i.engineID),o=pe.passwordToKey(n,r,i.engineID),s=Buffer.alloc(g.KEY_LENGTH),o.copy(s,0,0,g.KEY_LENGTH),a=Buffer.alloc(g.BLOCK_LENGTH),o.copy(a,0,g.KEY_LENGTH,g.KEY_LENGTH+g.BLOCK_LENGTH),(u=Buffer.alloc(g.BLOCK_LENGTH)).fill("00000001",0,4,"hex"),u.fill(c.randomBytes(4),4,8),l=Buffer.alloc(g.BLOCK_LENGTH),p=0;p<l.length;p++)l[p]=a[p]^u[p];return e.length%g.BLOCK_LENGTH==0?d=e:(h=g.BLOCK_LENGTH*(Math.floor(e.length/g.BLOCK_LENGTH)+1),d=Buffer.alloc(h),e.copy(d,0,0,e.length)),f=(m=c.createCipheriv(g.CRYPTO_ALGORITHM,s,l)).update(d),{encryptedPdu:f=Buffer.concat([f,m.final()]),msgPrivacyParameters:u}},decryptPduDes:function(e,t,r,n,i,o){var s,a,u,l,p,h,d,f,m=he.algorithms[E.des];for(s=pe.passwordToKey(i,n,o.engineID),a=Buffer.alloc(m.KEY_LENGTH),s.copy(a,0,0,m.KEY_LENGTH),u=Buffer.alloc(m.BLOCK_LENGTH),s.copy(u,0,m.KEY_LENGTH,m.KEY_LENGTH+m.BLOCK_LENGTH),l=r,p=Buffer.alloc(m.BLOCK_LENGTH),h=0;h<p.length;h++)p[h]=u[h]^l[h];return(f=c.createDecipheriv(m.CRYPTO_ALGORITHM,a,p)).setAutoPadding(!1),d=f.update(e),Buffer.concat([d,f.final()])},generateIvAes:function(e,t,r,n){var i,o,s;return i=Buffer.alloc(e.BLOCK_LENGTH),(o=Buffer.alloc(4)).writeUInt32BE(t),(s=Buffer.alloc(4)).writeUInt32BE(r),o.copy(i,0,0,4),s.copy(i,4,0,4),n.copy(i,8,0,8),i},encryptPduAes:function(e,t,r,n,i){var o,s,a,u,l,p=he.algorithms[t];return o=(0,p.localizationAlgorithm)(p,n,r,i.engineID),s=Buffer.alloc(8).fill(c.randomBytes(8),0,8),a=he.generateIvAes(p,i.engineBoots,i.engineTime,s),l=(u=c.createCipheriv(p.CRYPTO_ALGORITHM,o,a)).update(e),{encryptedPdu:l=Buffer.concat([l,u.final()]),msgPrivacyParameters:s}},decryptPduAes:function(e,t,r,n,i,o){var s,a,u,l,p=he.algorithms[t];return s=(0,p.localizationAlgorithm)(p,i,n,o.engineID),a=he.generateIvAes(p,o.engineBoots,o.engineTime,r),l=(u=c.createDecipheriv(p.CRYPTO_ALGORITHM,s,a)).update(e),Buffer.concat([l,u.final()])},algorithms:{}};he.algorithms[E.des]={CRYPTO_ALGORITHM:"des-cbc",KEY_LENGTH:8,BLOCK_LENGTH:8,encryptPdu:he.encryptPduDes,decryptPdu:he.decryptPduDes,localizationAlgorithm:he.generateLocalizedKey},he.algorithms[E.aes]={CRYPTO_ALGORITHM:"aes-128-cfb",KEY_LENGTH:16,BLOCK_LENGTH:16,encryptPdu:he.encryptPduAes,decryptPdu:he.decryptPduAes,localizationAlgorithm:he.generateLocalizedKey},he.algorithms[E.aes256b]={CRYPTO_ALGORITHM:"aes-256-cfb",KEY_LENGTH:32,BLOCK_LENGTH:16,encryptPdu:he.encryptPduAes,decryptPdu:he.decryptPduAes,localizationAlgorithm:he.generateLocalizedKeyBlumenthal},he.algorithms[E.aes256r]={CRYPTO_ALGORITHM:"aes-256-cfb",KEY_LENGTH:32,BLOCK_LENGTH:16,encryptPdu:he.encryptPduAes,decryptPdu:he.decryptPduAes,localizationAlgorithm:he.generateLocalizedKeyReeder};var de=function(){};de.prototype.getReqId=function(){return 3==this.version?this.msgGlobalData.msgID:this.pdu.id},de.prototype.toBuffer=function(){return 3==this.version?this.toBufferV3():this.toBufferCommunity()},de.prototype.toBufferCommunity=function(){if(this.buffer)return this.buffer;var e=new n.Writer;return e.startSequence(),W(e,b.Integer,this.version),e.writeString(this.community),this.pdu.toBuffer(e),e.endSequence(),this.buffer=e.buffer,this.buffer},de.prototype.toBufferV3=function(){var e;if(this.buffer)return this.buffer;var t=new n.Writer;t.startSequence();var r=this.pdu.contextEngineID?this.pdu.contextEngineID:this.msgSecurityParameters.msgAuthoritativeEngineID;if(0==r.length?t.writeString(""):t.writeBuffer(r,n.OctetString),t.writeString(this.pdu.contextName),this.pdu.toBuffer(t),t.endSequence(),this.hasPrivacy()){var i={engineID:this.msgSecurityParameters.msgAuthoritativeEngineID,engineBoots:this.msgSecurityParameters.msgAuthoritativeEngineBoots,engineTime:this.msgSecurityParameters.msgAuthoritativeEngineTime};e=he.encryptPdu(this.user.privProtocol,t.buffer,this.user.privKey,this.user.authProtocol,i)}var o=new n.Writer;o.startSequence(),W(o,b.Integer,this.version),o.startSequence(),W(o,b.Integer,this.msgGlobalData.msgID),W(o,b.Integer,this.msgGlobalData.msgMaxSize),o.writeByte(n.OctetString),o.writeByte(1),o.writeByte(this.msgGlobalData.msgFlags),W(o,b.Integer,this.msgGlobalData.msgSecurityModel),o.endSequence(),o.startSequence(n.OctetString),o.startSequence(),0==this.msgSecurityParameters.msgAuthoritativeEngineID.length?o.writeString(""):o.writeBuffer(this.msgSecurityParameters.msgAuthoritativeEngineID,n.OctetString),W(o,b.Integer,this.msgSecurityParameters.msgAuthoritativeEngineBoots),W(o,b.Integer,this.msgSecurityParameters.msgAuthoritativeEngineTime),o.writeString(this.msgSecurityParameters.msgUserName);var s="";if(this.hasAuthentication()){var a=pe.getParametersLength(this.user.authProtocol);s=Buffer.alloc(a),o.writeBuffer(s,n.OctetString)}else o.writeString("");var u=o._offset-s.length;return this.hasPrivacy()?o.writeBuffer(e.msgPrivacyParameters,n.OctetString):o.writeString(""),u-=o._offset,o.endSequence(),o.endSequence(),u+=o._offset,this.hasPrivacy()?o.writeBuffer(e.encryptedPdu,n.OctetString):o.writeBuffer(t.buffer),u-=o._offset,o.endSequence(),u+=o._offset,this.buffer=o.buffer,this.hasAuthentication()&&(s=this.buffer.subarray(u,u+s.length),pe.writeParameters(this.buffer,this.user.authProtocol,this.user.authKey,this.msgSecurityParameters.msgAuthoritativeEngineID,s)),this.buffer},de.prototype.processIncomingSecurity=function(e,t){return!(this.hasPrivacy()&&!this.decryptPdu(e,t))&&(!(this.hasAuthentication()&&!this.isAuthenticationDisabled())||this.checkAuthentication(e,t))},de.prototype.decryptPdu=function(e,t){var r,i;try{var o={engineID:this.msgSecurityParameters.msgAuthoritativeEngineID,engineBoots:this.msgSecurityParameters.msgAuthoritativeEngineBoots,engineTime:this.msgSecurityParameters.msgAuthoritativeEngineTime};return r=he.decryptPdu(e.privProtocol,this.encryptedPdu,this.msgSecurityParameters.msgPrivacyParameters,e.privKey,e.authProtocol,o),i=new n.Reader(r),this.pdu=le(i,!0),!0}catch(e){return t(new R("Failed to decrypt PDU: "+e,k.ECouldNotDecrypt)),!1}},de.prototype.checkAuthentication=function(e,t){return!!pe.isAuthentic(this.buffer,e.authProtocol,e.authKey,this.msgSecurityParameters.msgAuthoritativeEngineID,this.msgSecurityParameters.msgAuthenticationParameters)||(t(new R("Authentication digest "+this.msgSecurityParameters.msgAuthenticationParameters.toString("hex")+" received in message does not match digest "+pe.calculateDigest(this.buffer,e.authProtocol,e.authKey,this.msgSecurityParameters.msgAuthoritativeEngineID).toString("hex")+" calculated for message",k.EAuthFailure,{user:e})),!1)},de.prototype.setMsgFlags=function(e,t){this.msgGlobalData&&void 0!==this.msgGlobalData&&null!==this.msgGlobalData&&(this.msgGlobalData.msgFlags=t?this.msgGlobalData.msgFlags|2**e:this.msgGlobalData.msgFlags&255-2**e)},de.prototype.hasAuthentication=function(){return this.msgGlobalData&&this.msgGlobalData.msgFlags&&1&this.msgGlobalData.msgFlags},de.prototype.setAuthentication=function(e){this.setMsgFlags(0,e)},de.prototype.hasPrivacy=function(){return this.msgGlobalData&&this.msgGlobalData.msgFlags&&2&this.msgGlobalData.msgFlags},de.prototype.setPrivacy=function(e){this.setMsgFlags(1,e)},de.prototype.isReportable=function(){return this.msgGlobalData&&this.msgGlobalData.msgFlags&&4&this.msgGlobalData.msgFlags},de.prototype.setReportable=function(e){this.setMsgFlags(2,e)},de.prototype.isAuthenticationDisabled=function(){return this.disableAuthentication},de.prototype.hasAuthoritativeEngineID=function(){return this.msgSecurityParameters&&this.msgSecurityParameters.msgAuthoritativeEngineID&&""!=this.msgSecurityParameters.msgAuthoritativeEngineID},de.prototype.createReportResponseMessage=function(e,t){var r={name:"",level:I.noAuthNoPriv},n={msgAuthoritativeEngineID:e.engineID,msgAuthoritativeEngineBoots:e.engineBoots,msgAuthoritativeEngineTime:e.engineTime,msgUserName:r.name,msgAuthenticationParameters:"",msgPrivacyParameters:""},i=ce.createFromVariables(this.pdu.id,[],{});i.contextName=t;var o=de.createRequestV3(r,n,i);return o.msgGlobalData.msgID=this.msgGlobalData.msgID,o},de.prototype.createResponseForRequest=function(e){return 3==this.version?this.createV3ResponseFromRequest(e):this.createCommunityResponseFromRequest(e)},de.prototype.createCommunityResponseFromRequest=function(e){return de.createCommunity(this.version,this.community,e)},de.prototype.createV3ResponseFromRequest=function(e){var t={name:this.user.name,level:this.user.level,authProtocol:this.user.authProtocol,authKey:this.user.authKey,privProtocol:this.user.privProtocol,privKey:this.user.privKey},r={msgAuthoritativeEngineID:this.msgSecurityParameters.msgAuthoritativeEngineID,msgAuthoritativeEngineBoots:this.msgSecurityParameters.msgAuthoritativeEngineBoots,msgAuthoritativeEngineTime:this.msgSecurityParameters.msgAuthoritativeEngineTime,msgUserName:this.msgSecurityParameters.msgUserName,msgAuthenticationParameters:"",msgPrivacyParameters:""},n={msgID:this.msgGlobalData.msgID,msgMaxSize:65507,msgFlags:251&this.msgGlobalData.msgFlags,msgSecurityModel:3};return de.createV3(t,n,r,e)},de.createCommunity=function(e,t,r){var n=new de;return n.version=e,n.community=t,n.pdu=r,n},de.createRequestV3=function(e,t,r){var n=e.level==I.authNoPriv||e.level==I.authPriv?1:0,i=e.level==I.authPriv?1:0,o=r.type==v.GetResponse||r.type==v.TrapV2?0:1,s={msgID:ge(),msgMaxSize:65507,msgFlags:4*o|2*i|1*n,msgSecurityModel:3};return de.createV3(e,s,t,r)},de.createV3=function(e,t,r,n){var i=new de;return i.version=3,i.user=e,i.msgGlobalData=t,i.msgSecurityParameters={msgAuthoritativeEngineID:r.msgAuthoritativeEngineID||Buffer.from(""),msgAuthoritativeEngineBoots:r.msgAuthoritativeEngineBoots||0,msgAuthoritativeEngineTime:r.msgAuthoritativeEngineTime||0,msgUserName:e.name||"",msgAuthenticationParameters:"",msgPrivacyParameters:""},i.pdu=n,i},de.createDiscoveryV3=function(e){var t={msgAuthoritativeEngineID:Buffer.from(""),msgAuthoritativeEngineBoots:0,msgAuthoritativeEngineTime:0};return de.createRequestV3({name:"",level:I.noAuthNoPriv},t,e)},de.createFromBuffer=function(e,t){var r=new n.Reader(e),i=new de;if(r.readSequence(),i.version=q(r),3!=i.version)i.community=r.readString(),i.pdu=le(r,!1);else{i.msgGlobalData={},r.readSequence(),i.msgGlobalData.msgID=q(r),i.msgGlobalData.msgMaxSize=q(r),i.msgGlobalData.msgFlags=r.readString(n.OctetString,!0)[0],i.msgGlobalData.msgSecurityModel=q(r),i.msgSecurityParameters={};var o=new n.Reader(r.readString(n.OctetString,!0));o.readSequence(),i.msgSecurityParameters.msgAuthoritativeEngineID=o.readString(n.OctetString,!0),i.msgSecurityParameters.msgAuthoritativeEngineBoots=q(o),i.msgSecurityParameters.msgAuthoritativeEngineTime=q(o),i.msgSecurityParameters.msgUserName=o.readString(),i.msgSecurityParameters.msgAuthenticationParameters=o.readString(n.OctetString,!0),i.msgSecurityParameters.msgPrivacyParameters=Buffer.from(o.readString(n.OctetString,!0)),i.hasPrivacy()?(i.encryptedPdu=r.readString(n.OctetString,!0),i.pdu=null):i.pdu=le(r,!0)}return i.buffer=e,i};var fe=function(e,t,r,n,i){this.message=t,this.responseCb=n,this.retries=e.retries,this.timeout=e.timeout,this.backoff=e.backoff,this.onResponse=e.onSimpleGetResponse,this.feedCb=r,this.port=i&&i.port?i.port:e.port,this.context=e.context};fe.prototype.getId=function(){return this.message.getReqId()};var me=function(e,t,r){this.target=e||"127.0.0.1",r=r||{},this.version=r.version?r.version:0,3==this.version?this.user=t:this.community=t||"public",this.transport=r.transport?r.transport:"udp4",this.port=r.port?r.port:161,this.trapPort=r.trapPort?r.trapPort:162,this.retries=r.retries||0==r.retries?r.retries:1,this.timeout=r.timeout?r.timeout:5e3,this.backoff=r.backoff>=1?r.backoff:1,this.sourceAddress=r.sourceAddress?r.sourceAddress:void 0,this.sourcePort=r.sourcePort?parseInt(r.sourcePort):void 0,this.idBitsSize=r.idBitsSize?parseInt(r.idBitsSize):32,this.context=r.context?r.context:"",this.backwardsGetNexts=void 0===r.backwardsGetNexts||r.backwardsGetNexts,this.reportOidMismatchErrors=void 0!==r.reportOidMismatchErrors&&r.reportOidMismatchErrors,p=r.debug,this.engine=new Ee(r.engineID),this.reqs={},this.reqCount=0,this.dgram=o.createSocket(this.transport),this.dgram.unref();var n=this;this.dgram.on("message",n.onMsg.bind(n)),this.dgram.on("close",n.onClose.bind(n)),this.dgram.on("error",n.onError.bind(n)),(this.sourceAddress||this.sourcePort)&&this.dgram.bind(this.sourcePort,this.sourceAddress)};function ge(e){return 16===e?Math.floor(1e4*Math.random())%65535:Math.floor(1e8*Math.random())%4294967295}function ye(e,t){for(var r=0,n=t.length;n>0;n--)G(e.baseOid,t[n-1].oid)||(r=1,t.pop());if(t.length>0&&e.feedCb(t),r)return!0}function be(e,t){if(t)e.responseCb(t);else if(e.error)e.responseCb(e.error);else if(e.columns.length>0){var r=e.columns.pop();this.subtree(e.rowOid+r,e.maxRepetitions,ve.bind(this,e),be.bind(this,e))}else e.responseCb(null,e.table)}function ve(e,t){for(var r=0;r<t.length;r++){if(U(t[r]))return e.error=new F(j(t[r])),!0;var n=t[r].oid.replace(e.rowOid,"");if(n&&n!=t[r].oid){var i=n.match(/^(\d+)\.(.+)$/);i&&i[1]>0&&(e.table[i[2]]||(e.table[i[2]]={}),e.table[i[2]][i[1]]=t[r].value)}}}function we(e,t){t?e.responseCb(t):e.error?e.responseCb(e.error):e.responseCb(null,e.table)}function Ie(e,t){for(var r=0;r<t.length;r++){if(U(t[r]))return e.error=new F(j(t[r])),!0;var n=t[r].oid.replace(e.rowOid,"");if(n&&n!=t[r].oid){var i=n.match(/^(\d+)\.(.+)$/);i&&i[1]>0&&(e.table[i[2]]||(e.table[i[2]]={}),e.table[i[2]][i[1]]=t[r].value)}}}function _e(e,t,r){var n,i=0;if(t){if(!(t instanceof F))return void e.doneCb(t);if(t.status!=y.NoSuchName)return void e.doneCb(t);i=1}if(r&&r.length){if(1==this.version||3==this.version){for(var o=r[0].length;o>0;o--)r[0][o-1].type==b.EndOfMibView&&(r[0].pop(),i=1);e.feedCb(r[0])&&(i=1),i||(n=r[0][r[0].length-1].oid)}else i||(e.feedCb(r)?i=1:n=r[0].oid);i?e.doneCb(null):this.walk(n,e.maxRepetitions,e.feedCb,e.doneCb,e.baseOid)}else e.doneCb(null)}u.inherits(me,a.EventEmitter),me.prototype.close=function(){return this.dgram.close(),this},me.prototype.cancelRequests=function(e){var t;for(t in this.reqs){var r=this.reqs[t];this.unregisterRequest(r.getId()),r.responseCb(e)}},me.prototype.get=function(e,t){for(var r=this.reportOidMismatchErrors,n=[],i=0;i<e.length;i++){var o={oid:e[i]};n.push(o)}return this.simpleGet(re,(function(e,t){var n=t.pdu,i=[];if(e.message.pdu.varbinds.length!=n.varbinds.length)e.responseCb(new R("Requested OIDs do not match response OIDs",k.EReqResOidNoMatch));else{for(var o=0;o<e.message.pdu.varbinds.length;o++){if(r&&e.message.pdu.varbinds[o].oid!=n.varbinds[o].oid)return void e.responseCb(new R("OID '"+e.message.pdu.varbinds[o].oid+"' in request at position '"+o+"' does not match OID '"+n.varbinds[o].oid+"' in response at position '"+o+"'",k.EReqResOidNoMatch));i.push(n.varbinds[o])}e.responseCb(null,i)}}),n,t),this},me.prototype.getBulk=function(){var e,t,r,n,i=this.reportOidMismatchErrors,o=this.backwardsGetNexts;arguments.length>=4?(e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3]):arguments.length>=3?(e=arguments[0],t=arguments[1],r=10,n=arguments[2]):(e=arguments[0],t=0,r=10,n=arguments[1]);for(var s=[],a=0;a<e.length;a++){var u={oid:e[a]};s.push(u)}var c={nonRepeaters:t,maxRepetitions:r};return this.simpleGet(ee,(function(e,r){for(var n=r.pdu,s=e.message.pdu.varbinds,a=[],u=0;u<s.length&&u<n.varbinds.length;u++){if(U(n.varbinds[u])){if(i&&s[u].oid!=n.varbinds[u].oid)return void e.responseCb(new R("OID '"+s[u].oid+"' in request at position '"+u+"' does not match OID '"+n.varbinds[u].oid+"' in response at position '"+u+"'",k.EReqResOidNoMatch))}else if(!o&&!V(s[u].oid,n.varbinds[u].oid))return void e.responseCb(new R("OID '"+s[u].oid+"' in request at positiion '"+u+"' does not precede OID '"+n.varbinds[u].oid+"' in response at position '"+u+"'",k.EOutOfOrder));u<t?a.push(n.varbinds[u]):a.push([n.varbinds[u]])}for(var c=s.length-t;u<n.varbinds.length;u++){var l=(u-t)%c+t,p=u-c,h=n.varbinds[p].oid;if(U(n.varbinds[u])){if(i&&h!=n.varbinds[u].oid)return void e.responseCb(new R("OID '"+h+"' in response at position '"+p+"' does not match OID '"+n.varbinds[u].oid+"' in response at position '"+u+"'",k.EReqResOidNoMatch))}else if(!o&&!V(h,n.varbinds[u].oid))return void e.responseCb(new R("OID '"+h+"' in response at positiion '"+p+"' does not precede OID '"+n.varbinds[u].oid+"' in response at position '"+u+"'",k.EOutOfOrder));a[l].push(n.varbinds[u])}e.responseCb(null,a)}),s,n,c),this},me.prototype.getNext=function(e,t){for(var r=this.backwardsGetNexts,n=[],i=0;i<e.length;i++){var o={oid:e[i]};n.push(o)}return this.simpleGet(te,(function(e,t){var n=t.pdu,i=[];if(e.message.pdu.varbinds.length!=n.varbinds.length)e.responseCb(new R("Requested OIDs do not match response OIDs",k.EReqResOidNoMatch));else{for(var o=0;o<e.message.pdu.varbinds.length;o++)if(U(n.varbinds[o]))i.push(n.varbinds[o]);else{if(!r&&!V(e.message.pdu.varbinds[o].oid,n.varbinds[o].oid))return void e.responseCb(new R("OID '"+e.message.pdu.varbinds[o].oid+"' in request at positiion '"+o+"' does not precede OID '"+n.varbinds[o].oid+"' in response at position '"+o+"'",k.OutOfOrder));i.push(n.varbinds[o])}e.responseCb(null,i)}}),n,t),this},me.prototype.inform=function(){var e,t,r=arguments[0],n={};if(arguments.length>=4?(e=arguments[1],n=arguments[2],t=arguments[3]):arguments.length>=3?arguments[1].constructor!=Array?(e=[],n=arguments[1],t=arguments[2]):(e=arguments[1],t=arguments[2]):(e=[],t=arguments[1]),0!=this.version){"string"!=typeof r&&(r="1.3.6.1.6.3.1.1.5."+(r+1));for(var i=[{oid:"1.3.6.1.2.1.1.3.0",type:b.TimeTicks,value:n.upTime||Math.floor(100*process.uptime())},{oid:"1.3.6.1.6.3.1.1.4.1.0",type:b.OID,value:r}],o=0;o<e.length;o++){var s={oid:e[o].oid,type:e[o].type,value:e[o].value};i.push(s)}return n.port=this.trapPort,this.simpleGet(ne,(function(e,t){var r=t.pdu,n=[];if(e.message.pdu.varbinds.length!=r.varbinds.length)e.responseCb(new R("Inform OIDs do not match response OIDs",k.EReqResOidNoMatch));else{for(var i=0;i<e.message.pdu.varbinds.length;i++){if(e.message.pdu.varbinds[i].oid!=r.varbinds[i].oid)return void e.responseCb(new R("OID '"+e.message.pdu.varbinds[i].oid+"' in inform at positiion '"+i+"' does not match OID '"+r.varbinds[i].oid+"' in response at position '"+i+"'",k.EReqResOidNoMatch));n.push(r.varbinds[i])}e.responseCb(null,n)}}),i,t,n),this}t(new B("Inform not allowed for SNMPv1"))},me.prototype.onClose=function(){this.cancelRequests(new Error("Socket forcibly closed")),this.emit("close")},me.prototype.onError=function(e){this.emit(e)},me.prototype.onMsg=function(e){try{var t=de.createFromBuffer(e)}catch(e){return void this.emit("error",e)}var r=this.unregisterRequest(t.getReqId());if(r&&t.processIncomingSecurity(this.user,r.responseCb))if(t.version!=r.message.version)r.responseCb(new R("Version in request '"+r.message.version+"' does not match version in response '"+t.version+"'",k.EVersionNoMatch));else if(t.community!=r.message.community)r.responseCb(new R("Community '"+r.message.community+"' in request does not match community '"+t.community+"' in response",k.ECommunityNoMatch));else if(t.pdu.type==v.Report)if(this.msgSecurityParameters={msgAuthoritativeEngineID:t.msgSecurityParameters.msgAuthoritativeEngineID,msgAuthoritativeEngineBoots:t.msgSecurityParameters.msgAuthoritativeEngineBoots,msgAuthoritativeEngineTime:t.msgSecurityParameters.msgAuthoritativeEngineTime},this.proxy)this.msgSecurityParameters.msgUserName=this.proxy.user.name,this.msgSecurityParameters.msgAuthenticationParameters="",this.msgSecurityParameters.msgPrivacyParameters="";else{if(!r.originalPdu||!r.allowReport)return Array.isArray(t.pdu.varbinds)&&t.pdu.varbinds[0]&&0===t.pdu.varbinds[0].oid.indexOf(O)?void this.userSecurityModelError(r,t.pdu.varbinds[0].oid):void r.responseCb(new R("Unexpected Report PDU",k.EUnexpectedReport));r.originalPdu.contextName=this.context;var n=!t.msgSecurityParameters.msgAuthoritativeEngineBoots&&!t.msgSecurityParameters.msgAuthoritativeEngineTime;this.sendV3Req(r.originalPdu,r.feedCb,r.responseCb,r.options,r.port,n)}else this.proxy?this.onProxyResponse(r,t):t.pdu.type==v.GetResponse?r.onResponse(r,t):r.responseCb(new R("Unknown PDU type '"+t.pdu.type+"' in response",k.EUnknownPduType))},me.prototype.onSimpleGetResponse=function(e,t){var r=t.pdu;if(r.errorStatus>0){var n=y[r.errorStatus]||y.GeneralError,i=y[n]||y[y.GeneralError];if(r.errorIndex<=0||r.errorIndex>r.varbinds.length)e.responseCb(new F(n,i));else{var o=new F(n+": "+r.varbinds[r.errorIndex-1].oid,i);e.responseCb(o)}}else e.feedCb(e,t)},me.prototype.registerRequest=function(e){this.reqs[e.getId()]||(this.reqs[e.getId()]=e,this.reqCount<=0&&this.dgram.ref(),this.reqCount++);var t=this;e.timer=setTimeout((function(){e.retries-- >0?t.send(e):(t.unregisterRequest(e.getId()),e.responseCb(new L("Request timed out")))}),e.timeout),e.backoff&&e.backoff>=1&&(e.timeout*=e.backoff)},me.prototype.send=function(e,t){try{var r=this,n=e.message.toBuffer();this.dgram.send(n,0,n.length,e.port,this.target,(function(n,i){n?e.responseCb(n):t?e.responseCb(null):r.registerRequest(e)}))}catch(t){e.responseCb(t)}return this},me.prototype.set=function(e,t){for(var r=this.reportOidMismatchErrors,n=[],i=0;i<e.length;i++){var o={oid:e[i].oid,type:e[i].type,value:e[i].value};n.push(o)}return this.simpleGet(ie,(function(e,t){var n=t.pdu,i=[];if(e.message.pdu.varbinds.length!=n.varbinds.length)e.responseCb(new R("Requested OIDs do not match response OIDs",k.EReqResOidNoMatch));else{for(var o=0;o<e.message.pdu.varbinds.length;o++){if(r&&e.message.pdu.varbinds[o].oid!=n.varbinds[o].oid)return void e.responseCb(new R("OID '"+e.message.pdu.varbinds[o].oid+"' in request at position '"+o+"' does not match OID '"+n.varbinds[o].oid+"' in response at position '"+o+"'",k.EReqResOidNoMatch));i.push(n.varbinds[o])}e.responseCb(null,i)}}),n,t),this},me.prototype.simpleGet=function(e,t,r,n,i){var o=ge(this.idBitsSize);i=Object.assign({},i,{context:this.context});var s,a,u=Z.createFromVariables(e,o,r,i);3==this.version?this.msgSecurityParameters?this.sendV3Req(u,t,n,i,this.port,!0):this.sendV3Discovery(u,t,n,i):(s=de.createCommunity(this.version,this.community,u),a=new fe(this,s,t,n,i),this.send(a))},me.prototype.subtree=function(){var e,t,r,n=arguments[0];arguments.length<4?(e=20,t=arguments[1],r=arguments[2]):(e=arguments[1],t=arguments[2],r=arguments[3]);var i={feedCb:t,doneCb:r,maxRepetitions:e,baseOid:n};return this.walk(n,e,ye.bind(this,i),r),this},me.prototype.tableColumns=function(){var e,t,r=arguments[0];arguments.length<4?(t=arguments[2],e=20):(e=arguments[2],t=arguments[3]);var n={responseCb:t,maxRepetitions:e,baseOid:r,rowOid:r+".1.",columns:arguments[1].slice(0),table:{}};if(n.columns.length>0){var i=n.columns.pop();this.subtree(n.rowOid+i,e,ve.bind(this,n),be.bind(this,n))}return this},me.prototype.table=function(){var e,t,r=arguments[0];arguments.length<3?(t=arguments[1],e=20):(e=arguments[1],t=arguments[2]);var n={responseCb:t,maxRepetitions:e,baseOid:r,rowOid:r+".1.",table:{}};return this.subtree(r,e,Ie.bind(this,n),we.bind(this,n)),this},me.prototype.trap=function(){var e,t,r,n,i=arguments[0],o={};arguments.length>=4?(t=arguments[1],"string"==typeof arguments[2]?o.agentAddr=arguments[2]:arguments[2].constructor!=Array&&(o=arguments[2]),r=arguments[3]):arguments.length>=3?("string"==typeof arguments[1]?(t=[],o.agentAddr=arguments[1]):arguments[1].constructor!=Array?(t=[],o=arguments[1]):(t=arguments[1],o.agentAddr=null),r=arguments[2]):(t=[],r=arguments[1]);for(var s,a=[],u=0;u<t.length;u++){var c={oid:t[u].oid,type:t[u].type,value:t[u].value};a.push(c)}var l=ge(this.idBitsSize);if(1==this.version||3==this.version?("string"!=typeof i&&(i="1.3.6.1.6.3.1.1.5."+(i+1)),a.unshift({oid:"1.3.6.1.2.1.1.3.0",type:b.TimeTicks,value:o.upTime||Math.floor(100*process.uptime())},{oid:"1.3.6.1.6.3.1.1.4.1.0",type:b.OID,value:i}),s=se.createFromVariables(l,a,o)):s=oe.createFromVariables(i,a,o),3==this.version){var p={msgAuthoritativeEngineID:this.engine.engineID,msgAuthoritativeEngineBoots:0,msgAuthoritativeEngineTime:0};n=de.createRequestV3(this.user,p,s)}else n=de.createCommunity(this.version,this.community,s);return e={id:l,message:n,responseCb:r,port:this.trapPort},this.send(e,!0),this},me.prototype.unregisterRequest=function(e){var t=this.reqs[e];return t?(delete this.reqs[e],clearTimeout(t.timer),delete t.timer,this.reqCount--,this.reqCount<=0&&this.dgram.unref(),t):null},me.prototype.walk=function(){var e,t,r,n=arguments[0];arguments.length<4?(e=20,t=arguments[1],r=arguments[2]):(e=arguments[1],t=arguments[2],r=arguments[3]);var i={maxRepetitions:e,feedCb:t,doneCb:r};return 1==this.version||3==this.version?this.getBulk([n],0,e,_e.bind(this,i)):this.getNext([n],_e.bind(this,i)),this},me.prototype.sendV3Req=function(e,t,r,n,i,o){var s=de.createRequestV3(this.user,this.msgSecurityParameters,e),a=new fe(this,s,t,r,n||{});a.port=i,a.originalPdu=e,a.allowReport=o,this.send(a)},me.prototype.sendV3Discovery=function(e,t,r,n){var i,o=(i=this.context,re.createFromVariables(ge(),[],{context:i})),s=de.createDiscoveryV3(o),a=new fe(this,s,t,r,n);a.originalPdu=e,a.allowReport=!0,this.send(a)},me.prototype.userSecurityModelError=function(e,t){var r=t.replace(O+".","").replace(/\.0$/,""),n=S[r]||"Unexpected Report PDU";e.responseCb(new R(n,k.EAuthFailure))},me.prototype.onProxyResponse=function(e,t){3==t.version?(t.pdu.contextName=this.proxy.context,t.user=e.proxiedUser,t.setAuthentication(!(e.proxiedUser.level==I.noAuthNoPriv)),t.setPrivacy(e.proxiedUser.level==I.authPriv),t.msgSecurityParameters={msgAuthoritativeEngineID:e.proxiedEngine.engineID,msgAuthoritativeEngineBoots:e.proxiedEngine.engineBoots,msgAuthoritativeEngineTime:e.proxiedEngine.engineTime,msgUserName:e.proxiedUser.name,msgAuthenticationParameters:"",msgPrivacyParameters:""},t.buffer=null,t.pdu.contextEngineID=t.msgSecurityParameters.msgAuthoritativeEngineID,t.pdu.contextName=this.proxy.context,t.pdu.id=e.proxiedPduId,this.proxy.listener.send(t,e.proxiedRinfo)):this.callback(new F("Only SNMP version 3 contexts are supported"))},me.create=function(e,t,r){var n=r&&r.version?r.version:0;if(0!=n&&1!=n)throw new R("SNMP community session requested but version '"+r.version+"' specified in options not valid",k.EVersionNoMatch);return r||(r={}),r.version=n,new me(e,t,r)},me.createV3=function(e,t,r){if(r&&r.version&&3!=r.version)throw new R("SNMPv3 session requested but version '"+r.version+"' specified in options",k.EVersionNoMatch);return r||(r={}),r.version=3,new me(e,t,r)};var Ee=function(e,t,r){e?e instanceof Buffer?this.engineID=e:(e=e.replace("0x",""),this.engineID=Buffer.from((e.toString().length%2==1?"0":"")+e.toString(),"hex")):this.generateEngineID(),this.engineBoots=0,this.engineTime=10};Ee.prototype.generateEngineID=function(){this.engineID=Buffer.alloc(17),this.engineID.fill("8000B98380","hex",0,5),this.engineID.fill(c.randomBytes(12),5,17,"hex")};var Oe=function(e,t){this.receiver=t,this.callback=t.onMsg,this.family=e.transport||"udp4",this.port=e.port||161,this.address=e.address,this.disableAuthorization=e.disableAuthorization||!1};Oe.prototype.startListening=function(){var e=this;this.dgram=o.createSocket(this.family),this.dgram.on("error",e.receiver.callback),this.dgram.bind(this.port,this.address),this.dgram.on("message",e.callback.bind(e.receiver))},Oe.prototype.send=function(e,t){var r=e.toBuffer();this.dgram.send(r,0,r.length,t.port,t.address,(function(e,t){e&&console.error("Error sending: "+e.message)}))},Oe.formatCallbackData=function(e,t){return e.contextEngineID&&(e.contextEngineID=e.contextEngineID.toString("hex")),delete e.nonRepeaters,delete e.maxRepetitions,{pdu:e,rinfo:t}},Oe.processIncoming=function(e,t,r){var n=de.createFromBuffer(e);if(3==n.version){if(n.user=t.users.filter((e=>e.name==n.msgSecurityParameters.msgUserName))[0],n.disableAuthentication=t.disableAuthorization,!n.user){if(""!=n.msgSecurityParameters.msgUserName&&!t.disableAuthorization)return void r(new F("Local user not found for message with user "+n.msgSecurityParameters.msgUserName));if(n.hasAuthentication())return void r(new F("Local user not found and message requires authentication with user "+n.msgSecurityParameters.msgUserName));n.user={name:"",level:I.noAuthNoPriv}}if((n.user.level==I.authNoPriv||n.user.level==I.authPriv)&&!n.hasAuthentication())return void r(new F("Local user "+n.msgSecurityParameters.msgUserName+" requires authentication but message does not provide it"));if(n.user.level==I.authPriv&&!n.hasPrivacy())return void r(new F("Local user "+n.msgSecurityParameters.msgUserName+" requires privacy but message does not provide it"));if(!n.processIncomingSecurity(n.user,r))return}else if(!t.communities.filter((e=>e==n.community))[0]&&!t.disableAuthorization)return void r(new F("Local community not found for message with community "+n.community));return n},Oe.prototype.close=function(){this.dgram&&this.dgram.close()};var Se=function(e){this.communities=[],this.users=[],this.disableAuthorization=e.disableAuthorization,this.accessControlModelType=e.accessControlModelType||P.None,this.accessControlModelType==P.None?this.accessControlModel=null:this.accessControlModelType==P.Simple&&(this.accessControlModel=new Ce)};Se.prototype.addCommunity=function(e){this.getCommunity(e)||(this.communities.push(e),this.accessControlModelType==P.Simple&&this.accessControlModel.setCommunityAccess(e,N.ReadOnly))},Se.prototype.getCommunity=function(e){return this.communities.filter((t=>t==e))[0]||null},Se.prototype.getCommunities=function(){return this.communities},Se.prototype.deleteCommunity=function(e){var t=this.communities.indexOf(e);t>-1&&this.communities.splice(t,1)},Se.prototype.addUser=function(e){this.getUser(e.name)&&this.deleteUser(e.name),this.users.push(e),this.accessControlModelType==P.Simple&&this.accessControlModel.setUserAccess(e.name,N.ReadOnly)},Se.prototype.getUser=function(e){return this.users.filter((t=>t.name==e))[0]||null},Se.prototype.getUsers=function(){return this.users},Se.prototype.deleteUser=function(e){var t=this.users.findIndex((t=>t.name==e));t>-1&&this.users.splice(t,1)},Se.prototype.getAccessControlModelType=function(){return this.accessControlModelType},Se.prototype.getAccessControlModel=function(){return this.accessControlModel},Se.prototype.isAccessAllowed=function(e,t,r){return!this.accessControlModel||this.accessControlModel.isAccessAllowed(e,t,r)};var Ce=function(){this.communitiesAccess=[],this.usersAccess=[]};Ce.prototype.getCommunityAccess=function(e){return this.communitiesAccess.find((t=>t.community==e))},Ce.prototype.getCommunityAccessLevel=function(e){var t=this.getCommunityAccess(e);return t?t.level:N.None},Ce.prototype.getCommunitiesAccess=function(){return this.communitiesAccess},Ce.prototype.setCommunityAccess=function(e,t){let r=this.getCommunityAccess(e);r?r.level=t:(this.communitiesAccess.push({community:e,level:t}),this.communitiesAccess.sort(((e,t)=>e.community>t.community?1:-1)))},Ce.prototype.removeCommunityAccess=function(e){this.communitiesAccess.splice(this.communitiesAccess.findIndex((t=>t.community==e)),1)},Ce.prototype.getUserAccess=function(e){return this.usersAccess.find((t=>t.userName==e))},Ce.prototype.getUserAccessLevel=function(e){var t=this.getUserAccess(e);return t?t.level:N.None},Ce.prototype.getUsersAccess=function(){return this.usersAccess},Ce.prototype.setUserAccess=function(e,t){let r=this.getUserAccess(e);r?r.level=t:(this.usersAccess.push({userName:e,level:t}),this.usersAccess.sort(((e,t)=>e.userName>t.userName?1:-1)))},Ce.prototype.removeUserAccess=function(e){this.usersAccess.splice(this.usersAccess.findIndex((t=>t.userName==e)),1)},Ce.prototype.isAccessAllowed=function(e,t,r){var n,i;switch(e){case 0:case 1:n=this.getCommunityAccessLevel(t);break;case 3:n=this.getUserAccessLevel(t)}switch(r){case v.SetRequest:i=N.ReadWrite;break;case v.GetRequest:case v.GetNextRequest:case v.GetBulkRequest:i=N.ReadOnly;break;default:i=N.None}switch(i){case N.ReadWrite:return n==N.ReadWrite;case N.ReadOnly:return n==N.ReadWrite||n==N.ReadOnly;case N.None:return!0;default:return!1}};var Te=function(e,t){p=e.debug,this.listener=new Oe(e,this),this.authorizer=new Se(e),this.engine=new Ee(e.engineID),this.engineBoots=0,this.engineTime=10,this.disableAuthorization=!1,this.callback=t,this.family=e.transport||"udp4",this.port=e.port||162,e.port=this.port,this.disableAuthorization=e.disableAuthorization||!1,this.includeAuthentication=e.includeAuthentication||!1,this.context=e&&e.context?e.context:"",this.listener=new Oe(e,this)};Te.prototype.getAuthorizer=function(){return this.authorizer},Te.prototype.onMsg=function(e,t){let r;try{r=Oe.processIncoming(e,this.authorizer,this.callback)}catch(r){return void this.callback(new M("Failure to process incoming message",r,t,e))}if(r)if(r.pdu.type!=v.GetRequest)r.pdu.type==v.Trap||r.pdu.type==v.TrapV2?this.callback(null,this.formatCallbackData(r,t)):r.pdu.type==v.InformRequest?(r.pdu.type=v.GetResponse,r.buffer=null,r.setReportable(!1),this.listener.send(r,t),r.pdu.type=v.InformRequest,this.callback(null,this.formatCallbackData(r,t))):this.callback(new B("Unexpected PDU type "+r.pdu.type+" ("+v[r.pdu.type]+")"));else{if(3!=r.version)return void this.callback(new B("Only SNMPv3 discovery GetRequests are supported"));if(r.hasAuthentication())return void this.callback(new B("Only discovery (noAuthNoPriv) GetRequests are supported but this message has authentication"));if(!r.isReportable())return void this.callback(new B("Only discovery GetRequests are supported and this message does not have the reportable flag set"));let e=r.createReportResponseMessage(this.engine,this.context);this.listener.send(e,t)}},Te.prototype.formatCallbackData=function(e,t){e.pdu.contextEngineID&&(e.pdu.contextEngineID=e.pdu.contextEngineID.toString("hex")),delete e.pdu.nonRepeaters,delete e.pdu.maxRepetitions;const r={pdu:e.pdu,rinfo:t};return this.includeAuthentication&&(e.community?r.pdu.community=e.community:e.user&&(r.pdu.user=e.user.name)),r},Te.prototype.close=function(){this.listener.close()},Te.create=function(e,t){var r=new Te(e,t);return r.listener.startListening(),r};var Pe=function(){this.parser=l()};Pe.prototype.getSyntaxTypes=function(){var e={};for(var t of(Object.assign(e,b),Object.values(this.parser.Modules)))for(var r of Object.values(t))"TEXTUAL-CONVENTION"==r.MACRO&&r.SYNTAX&&!e[r.ObjectName]&&("object"==typeof r.SYNTAX?e[r.ObjectName]=r.SYNTAX:e[r.ObjectName]=e[r.SYNTAX]);return e},Pe.prototype.loadFromFile=function(e){this.parser.Import(e),this.parser.Serialize()},Pe.prototype.getModule=function(e){return this.parser.Modules[e]},Pe.prototype.getModules=function(e){var t={};for(var r of Object.keys(this.parser.Modules))(e||-1==Pe.BASE_MODULES.indexOf(r))&&(t[r]=this.parser.Modules[r]);return t},Pe.prototype.getModuleNames=function(e){var t=[];for(var r of Object.keys(this.parser.Modules))(e||-1==Pe.BASE_MODULES.indexOf(r))&&t.push(r);return t},Pe.prototype.getProvidersForModule=function(e){var t,r,n,i,o,s,a,u=this.parser.Modules[e],c=[],l=[];if(!u)throw new ReferenceError("MIB module "+e+" not loaded");r=this.getSyntaxTypes(),n=Object.values(u);for(var p=0;p<n.length;p++){var h=(t=n[p]).SYNTAX,d=t.ACCESS,f=void 0!==t["MAX-ACCESS"]?t["MAX-ACCESS"]:d?D[d]:"not-accessible",m=t.DEFVAL;if(h)if(h=(s=Pe.getConstraintsFromSyntax(h,r)).syntax,a=s.constraints,h.startsWith("SEQUENCE OF"))for((i={tableName:t.ObjectName,type:C.Table,tableColumns:[],tableIndex:[1]}).maxAccess=A[f];i||p>=n.length;){if(!(t=n[++p])){l.push(i),i=null,p--;break}if(h=t.SYNTAX,d=t.ACCESS,f=void 0!==t["MAX-ACCESS"]?t["MAX-ACCESS"]:d?D[d]:"not-accessible",m=t.DEFVAL,h=(s=Pe.getConstraintsFromSyntax(h,r)).syntax,a=s.constraints,"SEQUENCE"==t.MACRO);else if(t["OBJECT IDENTIFIER"])if((o=t["OBJECT IDENTIFIER"].split(" ")[0])==i.tableName){if(i.name=t.ObjectName,i.oid=t.OID,t.INDEX)for(var g of(i.tableIndex=[],t.INDEX))(g=g.trim()).includes(" ")?"IMPLIED"==g.split(" ")[0]?i.tableIndex.push({columnName:g.split(" ")[1],implied:!0}):i.tableIndex.push({columnName:g.split(" ").slice(-1)[0]}):i.tableIndex.push({columnName:g});t.AUGMENTS&&(i.tableAugments=t.AUGMENTS[0].trim(),i.tableIndex=null)}else if(o==i.name){var y={number:parseInt(t["OBJECT IDENTIFIER"].split(" ")[1]),name:t.ObjectName,type:r[h],maxAccess:A[f]};a&&(y.constraints=a),m&&(y.defVal=m),"RowStatus"==h&&"IMPORTS"in u&&Array.isArray(u.IMPORTS["SNMPv2-TC"])&&u.IMPORTS["SNMPv2-TC"].includes("RowStatus")&&(y.rowStatus=!0),i.tableColumns.push(y)}else l.push(i),i=null,p--}else if("OBJECT-TYPE"==t.MACRO){let e=r[h];"object"==typeof e&&(e=r[Object.keys(e)[0]]);var b={name:t.ObjectName,type:C.Scalar,oid:t.OID,scalarType:e,maxAccess:A[f]};m&&(b.defVal=m),a&&(b.constraints=a),c.push(b)}}return c.concat(l)},Pe.prototype.loadBaseModules=function(){for(var e of Pe.BASE_MODULES)this.parser.Import(__dirname+"/lib/mibs/"+e+".mib");this.parser.Serialize()},Pe.getConstraintsFromSyntax=function(e,t){let r;if("object"==typeof t[e]&&(e=t[e]),"object"==typeof e){let t=e[Object.keys(e)[0]];t.ranges?(r={ranges:t.ranges},e=Object.keys(e)[0]):t.sizes?(r={sizes:t.sizes},e=Object.keys(e)[0]):(r={enumeration:e.INTEGER},e="INTEGER")}else r=null;return{constraints:r,syntax:e}},Pe.create=function(){var e=new Pe;return e.loadBaseModules(),e},Pe.BASE_MODULES=["RFC1155-SMI","RFC1158-MIB","RFC-1212","RFC1213-MIB","SNMPv2-SMI","SNMPv2-CONF","SNMPv2-TC","SNMPv2-MIB"];var Ne=function(e,t){this.address=e,this.oid=this.address.join("."),this.parent=t,this.children={}};Ne.prototype.child=function(e){return this.children[e]},Ne.prototype.listChildren=function(e){var t=[];return e=e||0,this.children.forEach((function(r,n){n>=e&&t.push(n)})),t.sort((function(e,t){return e-t})),t},Ne.prototype.findChildImmediatelyBefore=function(e){var t=Object.keys(this.children).sort((function(e,t){return e-t}));if(0===t.length)return null;for(var r=0;r<t.length;r++)if(e<t[r])return 0===r?null:this.children[t[r-1]];return this.children[t[t.length-1]]},Ne.prototype.isDescendant=function(e){return Ne.oidIsDescended(this.address,e)},Ne.prototype.isAncestor=function(e){return Ne.oidIsDescended(e,this.address)},Ne.prototype.getAncestorProvider=function(){return this.provider?this:this.parent?this.parent.getAncestorProvider():null},Ne.prototype.getTableColumnFromInstanceNode=function(){return this.parent&&this.parent.provider?this.address[this.address.length-1]:this.parent?this.parent.getTableColumnFromInstanceNode():null},Ne.prototype.getConstraintsFromProvider=function(){var e=this.getAncestorProvider();if(!e)return null;var t=e.provider;if(t.type==C.Scalar)return t.constraints;if(t.type==C.Table){var r=this.getTableColumnFromInstanceNode();if(!r)return null;var n=t.tableColumns.filter((e=>e.number==r))[0];return n?n.constraints:null}return null},Ne.prototype.setValue=function(e){var t,r,n,i,o=!1,s=this.getConstraintsFromProvider();if(!s)return this.value=e,!0;if(s.enumeration){if(!s.enumeration[e])return!1}else if(s.ranges){for(i of s.ranges)if(r="min"in i?i.min:Number.MIN_SAFE_INTEGER,n="max"in i?i.max:Number.MAX_SAFE_INTEGER,e>=r&&e<=n){o=!0;break}if(!o)return!1}else if(s.sizes){if(void 0===e.length)return!1;for(i of(t=e.length,s.sizes))if(r="min"in i?i.min:Number.MIN_SAFE_INTEGER,n="max"in i?i.max:Number.MAX_SAFE_INTEGER,t>=r&&t<=n){o=!0;break}if(!o)return!1}return this.value=e,!0},Ne.prototype.getInstanceNodeForTableRow=function(){var e=Object.keys(this.children).length;return 0==e?null!=this.value?this:null:1==e?this.children[0].getInstanceNodeForTableRow():e>1?null:void 0},Ne.prototype.getInstanceNodeForTableRowIndex=function(e){var t;if(0==Object.keys(this.children).length)return null!=this.value?this:null;if(0==e.length)return this.getInstanceNodeForTableRow();var r=e[0];return null==r?null:(t=e.slice(1),this.children[r]?this.children[r].getInstanceNodeForTableRowIndex(t):null)},Ne.prototype.getInstanceNodesForColumn=function(){for(var e=this,t=this,r=[];t&&(t==e||e.isAncestor(t.address));)(t=t.getNextInstanceNode())&&e.isAncestor(t.address)&&r.push(t);return r},Ne.prototype.getNextInstanceNode=function(){var e,t,r=this;if(null!=this.value)for(r=this;r;){if(e=r.address.slice(-1)[0],!(r=r.parent))return null;var n=(t=Object.keys(r.children).sort(((e,t)=>e-t))).indexOf(e.toString());if(n+1<t.length){r=r.children[t[n+1]];break}}for(;r;){if(null!=r.value)return r;if(t=Object.keys(r.children).sort(((e,t)=>e-t)),!(r=r.children[t[0]]))return null}},Ne.prototype.delete=function(){if(Object.keys(this.children)>0)throw new Error("Cannot delete non-leaf MIB node");var e=this.address.slice(-1)[0];delete this.parent.children[e],this.parent=null},Ne.prototype.pruneUpwards=function(){if(this.parent&&0==Object.keys(this.children).length){var e=this.address.splice(-1)[0].toString();delete this.parent.children[e],this.parent.pruneUpwards(),this.parent=null}},Ne.prototype.dump=function(e){var t;for(var r of(e.leavesOnly&&!e.showProviders||!this.provider?e.leavesOnly&&0!=Object.keys(this.children).length||(null!=this.value?(t=" = ",t+=e.showTypes?b[this.valueType]+": ":"",t+=e.showValues?this.value:""):t="",console.log(this.oid+t)):console.log(this.oid+" ["+C[this.provider.type]+": "+this.provider.name+"]"),Object.keys(this.children).sort(((e,t)=>e-t))))this.children[r].dump(e)},Ne.oidIsDescended=function(e,t){var r=Ae.convertOidToAddress(t),n=Ae.convertOidToAddress(e),i=!0;return!(n.length<=r.length)&&(r.forEach((function(e,t){n[t]!==r[t]&&(i=!1)})),i)};var Ae=function(){var e;this.root=new Ne([],null),this.providerNodes={},e=this.providersByOid={},this.providers=new Proxy({},{set:function(t,r,n){t[r]=n,e[n.oid]=n},deleteProperty:function(t,r){delete e[t[r].oid],delete t[r]}})};Ae.prototype.addNodesForOid=function(e){var t=Ae.convertOidToAddress(e);return this.addNodesForAddress(t)},Ae.prototype.addNodesForAddress=function(e){var t,r;for(t=this.root,r=0;r<e.length;r++)t.children.hasOwnProperty(e[r])||(t.children[e[r]]=new Ne(e.slice(0,r+1),t)),t=t.children[e[r]];return t},Ae.prototype.lookup=function(e){var t;return t=Ae.convertOidToAddress(e),this.lookupAddress(t)},Ae.prototype.lookupAddress=function(e){var t,r;for(r=this.root,t=0;t<e.length;t++){if(!r.children.hasOwnProperty(e[t]))return null;r=r.children[e[t]]}return r},Ae.prototype.getTreeNode=function(e){var t,r=Ae.convertOidToAddress(e);if(t=this.lookupAddress(r))return t;for(;r.length>0;){var n=r.pop(),i=this.lookupAddress(r);if(i){if(!(t=i.findChildImmediatelyBefore(n)))return i;for(;;){var o=Object.keys(t.children).sort(((e,t)=>e-t));if(0==o.length)return t;t=t.children[o[o.length-1]]}}}return this.root},Ae.prototype.getProviderNodeForInstance=function(e){return e.provider?null:e.getAncestorProvider()},Ae.prototype.addProviderToNode=function(e){var t=this.addNodesForOid(e.oid);return t.provider=e,e.type==C.Table&&(e.tableIndex||(e.tableIndex=[1])),this.providerNodes[e.name]=t,t},Ae.prototype.getColumnFromProvider=function(e,t){var r=null;return t.columnName?r=e.tableColumns.filter((e=>e.name==t.columnName))[0]:void 0!==t.columnNumber&&null!==t.columnNumber&&(r=e.tableColumns.filter((e=>e.number==t.columnNumber))[0]),r},Ae.prototype.populateIndexEntryFromColumn=function(e,t,r){var n=null;if(!t.columnName&&!t.columnNumber)throw new Error("Index entry "+r+": does not have either a columnName or columnNumber");if(t.foreign)n=this.getColumnFromProvider(this.providers[t.foreign],t);else if(!(n=this.getColumnFromProvider(e,t)))for(var i of Object.values(this.providers).filter((e=>e.type==C.Table)))if(n=this.getColumnFromProvider(i,t)){t.foreign=i.name;break}if(!n)throw new Error("Could not find column for index entry with column "+t.columnName);if(t.columnName&&t.columnName!=n.name)throw new Error("Index entry "+r+": Calculated column name "+n.name+"does not match supplied column name "+t.columnName);if(t.columnNumber&&t.columnNumber!=n.number)throw new Error("Index entry "+r+": Calculated column number "+n.number+" does not match supplied column number "+t.columnNumber);t.columnName||(t.columnName=n.name),t.columnNumber||(t.columnNumber=n.number),t.type=n.type},Ae.prototype.registerProvider=function(e){if(this.providers[e.name]=e,e.type==C.Table)if(e.tableAugments){if(e.tableAugments==e.name)throw new Error("Table "+e.name+" cannot augment itself");var t=this.providers[e.tableAugments];if(!t)throw new Error("Cannot find base table "+e.tableAugments+" to augment");e.tableIndex=JSON.parse(JSON.stringify(t.tableIndex)),e.tableIndex.map((e=>e.foreign=t.name))}else{e.tableIndex||(e.tableIndex=[1]);for(var r=0;r<e.tableIndex.length;r++){var n=e.tableIndex[r];"number"==typeof n?e.tableIndex[r]={columnNumber:n}:"string"==typeof n&&(e.tableIndex[r]={columnName:n}),n=e.tableIndex[r],this.populateIndexEntryFromColumn(e,n,r)}}},Ae.prototype.setScalarDefaultValue=function(e,t){this.getProvider(e).defVal=t},Ae.prototype.setTableRowDefaultValues=function(e,t){let r=this.getProvider(e).tableColumns;if(t.length!=r.length)throw new Error(`Incorrect values length: got ${t.length}; expected ${r.length}`);r.forEach(((e,r)=>{void 0!==t[r]&&(e.defVal=t[r])}))},Ae.prototype.setScalarRanges=function(e,t){this.getProvider(e).constraints={ranges:t}},Ae.prototype.setTableColumnRanges=function(e,t,r){this.getProvider(e).tableColumns[t].constraints={ranges:r}},Ae.prototype.setScalarSizes=function(e,t){this.getProvider(e).constraints={sizes:t}},Ae.prototype.setTableColumnSizes=function(e,t,r){this.getProvider(e).tableColumns[t].constraints={sizes:r}},Ae.prototype.registerProviders=function(e){for(var t of e)this.registerProvider(t)},Ae.prototype.unregisterProvider=function(e){var t=this.providerNodes[e];if(t){var r=t.parent;t.delete(),r.pruneUpwards(),delete this.providerNodes[e]}delete this.providers[e]},Ae.prototype.getProvider=function(e){return this.providers[e]},Ae.prototype.getProviders=function(){return this.providers},Ae.prototype.dumpProviders=function(){var e;for(var t of Object.values(this.providers))e=t.type==C.Scalar?b[t.scalarType]:"Columns = "+t.tableColumns.length,console.log(C[t.type]+": "+t.name+" ("+t.oid+"): "+e)},Ae.prototype.getScalarValue=function(e){var t=this.providerNodes[e];if(!t||!t.provider||t.provider.type!=C.Scalar)throw new ReferenceError("Failed to get node for registered MIB provider "+e);var r=t.address.concat([0]);if(!this.lookup(r))throw new Error("Failed created instance node for registered MIB provider "+e);return this.lookup(r).value},Ae.prototype.setScalarValue=function(e,t){var r,n,i;if(!this.providers[e])throw new ReferenceError("Provider "+e+" not registered with this MIB");if((r=this.providerNodes[e])||(r=this.addProviderToNode(this.providers[e])),i=r.provider,!r||!i||i.type!=C.Scalar)throw new ReferenceError("Could not find MIB node for registered provider "+e);var o=r.address.concat([0]);(n=this.lookup(o))||(this.addNodesForAddress(o),(n=this.lookup(o)).valueType=i.scalarType),n.value=t},Ae.prototype.getProviderNodeForTable=function(e){var t,r;if(!(t=this.providerNodes[e]))throw new ReferenceError("No MIB provider registered for "+e);if(r=t.provider,!t)throw new ReferenceError("No MIB provider definition for registered provider "+e);if(r.type!=C.Table)throw new TypeError("Registered MIB provider "+e+" is not of the correct type (is type "+C[r.type]+")");return t},Ae.prototype.getOidAddressFromValue=function(e,t){var r;switch(t.type){case b.OID:r=e.split(".");break;case b.OctetString:r=e instanceof Buffer?Array.prototype.slice.call(e):[...e].map((e=>e.charCodeAt()));break;case b.IpAddress:return e.split(".");default:return[e]}return t.implied||t.length||r.unshift(r.length),r},Ae.prototype.getTableRowInstanceFromRow=function(e,t){var r,n,i,o=[];r=e.tableIndex.filter((e=>e.foreign));for(var s=0;s<r.length;s++)i=this.getOidAddressFromValue(t[s],r[s]),o=o.concat(i);for(var a of e.tableIndex.filter((e=>!e.foreign)))n=e.tableColumns.findIndex((e=>e.number==a.columnNumber)),i=this.getOidAddressFromValue(t[r.length+n],a),o=o.concat(i);return o},Ae.getRowIndexFromOid=function(e,t){var r,n=e.split("."),i=0,o=[];for(var s of t)switch(s.type){case b.OID:i=s.implied?n.length:n.shift(),r=n.splice(0,i),o.push(r.join("."));break;case b.IpAddress:i=4,r=n.splice(0,i),o.push(r.join("."));break;case b.OctetString:i=s.implied?n.length:n.shift(),r=(r=n.splice(0,i)).map((e=>String.fromCharCode(e))).join(""),o.push(r);break;default:o.push(parseInt(n.shift()))}return o},Ae.prototype.getTableRowInstanceFromRowIndex=function(e,t){for(var r,n,i=[],o=0;o<e.tableIndex.length;o++)r=e.tableIndex[o],n=t[o],i=i.concat(this.getOidAddressFromValue(n,r));return i},Ae.prototype.addTableRow=function(e,t){var r,n,i,o,s,a;this.providers[e]&&!this.providerNodes[e]&&this.addProviderToNode(this.providers[e]),a=(n=(r=this.getProviderNodeForTable(e)).provider).tableIndex.filter((e=>e.foreign)).length,i=this.getTableRowInstanceFromRow(n,t);for(var u=0;u<n.tableColumns.length;u++){var c=n.tableColumns[u];(!n.tableIndex.some((e=>e.columnNumber==c.number))||c.maxAccess!==A["not-accessible"]&&c.maxAccess!==A["accessible-for-notify"])&&(o=r.address.concat(c.number).concat(i),this.addNodesForAddress(o),(s=this.lookup(o)).valueType=c.type,s.value=t[a+u])}},Ae.prototype.getTableColumnDefinitions=function(e){return this.getProviderNodeForTable(e).provider.tableColumns},Ae.prototype.getTableColumnCells=function(e,t,r){var n=this.providers[e].tableIndex,i=this.getProviderNodeForTable(e).children[t];if(!i)return null;var o,s=i.getInstanceNodesForColumn(),a=[],u=[];for(var c of s)o=Ae.getSubOidFromBaseOid(c.oid,i.oid),a.push(Ae.getRowIndexFromOid(o,n)),u.push(c.value);return r?[a,u]:u},Ae.prototype.getTableRowCells=function(e,t){var r,n,i,o,s,a=[],u=!1;for(var c of(r=this.providers[e],n=this.getProviderNodeForTable(e),o=this.getTableRowInstanceFromRowIndex(r,t),Object.keys(n.children)))(i=n.children[c])&&(s=i.getInstanceNodeForTableRowIndex(o))?(a.push(s.value),u=!0):a.push(null);return u?a:null},Ae.prototype.getTableCells=function(e,t,r){var n,i,o=[];for(var s of(n=this.getProviderNodeForTable(e),Object.keys(n.children)))i=this.getTableColumnCells(e,s,r),r?(o.push(...i),r=!1):o.push(i);return t?Object.keys(o[0]).map((function(e){return o.map((function(t){return t[e]}))})):o},Ae.prototype.getTableSingleCell=function(e,t,r){var n,i,o;return n=this.providers[e],i=this.getProviderNodeForTable(e),o=this.getTableRowInstanceFromRowIndex(n,r),i.children[t].getInstanceNodeForTableRowIndex(o).value},Ae.prototype.setTableSingleCell=function(e,t,r,n){var i,o,s;i=this.providers[e],o=this.getProviderNodeForTable(e),s=this.getTableRowInstanceFromRowIndex(i,r),o.children[t].getInstanceNodeForTableRowIndex(s).value=n},Ae.prototype.deleteTableRow=function(e,t){var r,n,i,o,s;for(var a of(r=this.providers[e],n=this.getProviderNodeForTable(e),i=this.getTableRowInstanceFromRowIndex(r,t),Object.keys(n.children))){if(!(o=n.children[a].getInstanceNodeForTableRowIndex(i)))throw new ReferenceError("Cannot find row for index "+t+" at registered provider "+e);s=o.parent,o.delete(),s.pruneUpwards()}return 0===Object.keys(this.providerNodes[e].children).length&&delete this.providerNodes[e],!0},Ae.prototype.dump=function(e){e||(e={});var t={leavesOnly:void 0===e.leavesOnly||e.leavesOnly,showProviders:void 0===e.showProviders||e.showProviders,showValues:void 0===e.showValues||e.showValues,showTypes:void 0===e.showTypes||e.showTypes};this.root.dump(t)},Ae.convertOidToAddress=function(e){var t,r,n;if("object"==typeof e&&u.isArray(e))t=e;else{if("string"!=typeof e)throw new TypeError("oid (string or array) is required");t=e.split(".")}if(t.length<1)throw new RangeError("object identifier is too short");for(r=[],n=0;n<t.length;n++){var i;if(""!==t[n]){if(!0===t[n]||!1===t[n])throw new TypeError("object identifier component "+t[n]+" is malformed");if(i=Number(t[n]),isNaN(i))throw new TypeError("object identifier component "+t[n]+" is malformed");if(i%1!=0)throw new TypeError("object identifier component "+t[n]+" is not an integer");if(0===n&&i>2)throw new RangeError("object identifier does not begin with 0, 1, or 2");if(1===n&&i>39)throw new RangeError("object identifier second component "+i+" exceeds encoding limit of 39");if(i<0)throw new RangeError("object identifier component "+t[n]+" is negative");if(i>d)throw new RangeError("object identifier component "+t[n]+" is too large");r.push(i)}}return r},Ae.getSubOidFromBaseOid=function(e,t){return e.substring(t.length+1)},Ae.create=function(){return new Ae};var De=function(e){this.operation=e.operation,this.address=Ae.convertOidToAddress(e.oid),this.oid=this.address.join("."),this.providerNode=e.providerNode,this.instanceNode=e.instanceNode};De.prototype.isScalar=function(){return this.providerNode&&this.providerNode.provider&&this.providerNode.provider.type==C.Scalar},De.prototype.isTabular=function(){return this.providerNode&&this.providerNode.provider&&this.providerNode.provider.type==C.Table};var xe=function(e,t,r){p=e.debug,this.listener=new Oe(e,this),this.engine=new Ee(e.engineID),this.authorizer=new Se(e),this.callback=t||function(){},this.mib=r||new Ae,this.context="",this.forwarder=new ke(this.listener,this.callback)};xe.prototype.getMib=function(){return this.mib},xe.prototype.setMib=function(e){this.mib=e},xe.prototype.getAuthorizer=function(){return this.authorizer},xe.prototype.registerProvider=function(e){this.mib.registerProvider(e)},xe.prototype.registerProviders=function(e){this.mib.registerProviders(e)},xe.prototype.unregisterProvider=function(e){this.mib.unregisterProvider(e)},xe.prototype.getProvider=function(e){return this.mib.getProvider(e)},xe.prototype.getProviders=function(){return this.mib.getProviders()},xe.prototype.scalarReadCreateHandlerInternal=function(e){let t=e.provider;if(t&&void 0!==t.defVal)return t.defVal},xe.prototype.tableRowStatusHandlerInternal=function(e){let t=e.provider,r=e.action,n=e.row,i=[],o=!1,s=Array.isArray(n)?n.slice(0):[n];return t.tableColumns.forEach((e=>{let n;n=t.tableIndex.filter((t=>e.number===t.columnNumber)),n.length>0?i.push(s.shift()):e.rowStatus?i.push(x[r]):"defVal"in e?i.push(e.defVal):(console.log("No defVal defined for column:",e),o=!0,i.push(void 0))})),o?void 0:i},xe.prototype.onMsg=function(e,t){let r;try{r=Oe.processIncoming(e,this.authorizer,this.callback)}catch(r){return void this.callback(new M("Failure to process incoming message",r,t,e))}if(r)if(3!=r.version||r.pdu.type!=v.GetRequest||r.hasAuthoritativeEngineID()||!r.isReportable())r.pdu.contextName&&""!=r.pdu.contextName?this.onProxyRequest(r,t):r.pdu.type==v.GetRequest?this.getRequest(r,t):r.pdu.type==v.SetRequest?this.setRequest(r,t):r.pdu.type==v.GetNextRequest?this.getNextRequest(r,t):r.pdu.type==v.GetBulkRequest?this.getBulkRequest(r,t):this.callback(new B("Unexpected PDU type "+r.pdu.type+" ("+v[r.pdu.type]+")"));else{let e=r.createReportResponseMessage(this.engine,this.context);this.listener.send(e,t)}},xe.prototype.castSetValue=function(e,t){switch(e){case b.Boolean:return!!t;case b.Integer:if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid Integer",t);return"number"==typeof t?t:parseInt(t,10);case b.OctetString:if(t instanceof Buffer)return t.toString();if("string"!=typeof t)throw new Error("Invalid OctetString",t);return t;case b.OID:if("string"!=typeof t||!t.match(/[0-9]+\([.][0-9]+\)+/))throw new Error("Invalid OID",t);return t;case b.Counter:case b.Counter64:return 0;case b.IpAddress:var r=t.split(".");if("string"!=typeof t||4!=r.length)throw new Error("Invalid IpAddress",t);return t;default:return t}},xe.prototype.tryCreateInstance=function(e,t){var r,n,i,o,s,a,u,c,l,p=this.mib.providersByOid,h=e.oid;for(a=Ae.convertOidToAddress(h).slice(0);a.length>0;a.pop())if(o=a.join("."),c=p[o]){if(c.type===C.Scalar){if(c.maxAccess!=A["read-create"])return;if(null===c.createHandler)return;if(l={provider:c},void 0===(i=(c.createHandler||this.scalarReadCreateHandlerInternal)(l)))return;return i=this.castSetValue(c.scalarType,i),this.mib.setScalarValue(c.name,i),{instanceNode:this.mib.lookup(h),providerType:C.Scalar}}if(s=(o=Ae.getSubOidFromBaseOid(h,c.oid)).split("."),n=parseInt(s.shift(),10),r=Ae.getRowIndexFromOid(s.join("."),c.tableIndex),u=c.tableColumns.reduce(((e,t)=>t.rowStatus?t.number:e),null),t===v.SetRequest&&"number"==typeof u&&n===u&&(e.value===x.createAndGo||e.value===x.createAndWait)&&null!==c.createHandler){if(l={provider:c,action:x[e.value],row:r},void 0===(i=(c.createHandler||this.tableRowStatusHandlerInternal)(l)))return;if(!Array.isArray(i))throw new Error("createHandler must return an array or undefined; got",i);if(i.length!=c.tableColumns.length)throw new Error("createHandler's returned array must contain a value for for each column");return i=i.map(((e,t)=>this.castSetValue(c.tableColumns[t].type,e))),this.mib.addTableRow(c.name,i),{instanceNode:this.mib.lookup(h),providerType:C.Table,action:x[e.value],rowIndex:r,row:i}}return}},xe.prototype.isAllowed=function(e,t,r){var n,i,o;switch(t.type===C.Scalar?i=t.maxAccess:(n=r.getTableColumnFromInstanceNode(),i=(o=t.tableColumns.find((e=>e.number===n)))&&o.maxAccess||A["not-accessible"]),v[e]){case"SetRequest":return i>=A["read-write"];case"GetRequest":case"GetNextRequest":case"GetBulkRequest":return i>=A["read-only"];default:return!1}},xe.prototype.request=function(e,t){var r=this,n=0,i=e.pdu,o=i.varbinds.length,s=i.getResponsePduForRequest(),a=[],u=[],c=[],l=[],p=3==e.version?e.user.name:e.community;for(let h=0;h<i.varbinds.length;h++){let d,f,m,g=this.mib.lookup(i.varbinds[h].oid);if(g||(c[h]=this.tryCreateInstance(i.varbinds[h],i.type),c[h]&&(g=c[h].instanceNode)),i.varbinds[h].oid.split(".").length<4&&(i.varbinds[h].oid="1.3.6.1"),g){if(d=this.mib.getProviderNodeForInstance(g),d&&void 0!==g.value)if(this.isAllowed(i.type,d.provider,g))if(this.authorizer.getAccessControlModelType()!=P.Simple||this.authorizer.getAccessControlModel().isAccessAllowed(e.version,p,e.pdu.type)){if(i.type===v.SetRequest&&d.provider.type==C.Table&&"number"==typeof(f=d.provider.tableColumns.reduce(((e,t)=>t.rowStatus?t.number:e),null))&&g.getTableColumnFromInstanceNode()===f)switch(m=function(e){e.done({errorStatus:y.InconsistentValue,type:b.Null,value:null})},i.varbinds[h].requestValue=this.castSetValue(i.varbinds[h].type,i.varbinds[h].value),i.varbinds[h].value){case x.active:case x.notInService:case x.destroy:break;case x.createAndGo:g.value===x.createAndGo?i.varbinds[h].value=x.active:(a[h]=new De({operation:i.type,oid:i.varbinds[h].oid}),u[h]=m);break;case x.createAndWait:g.value===x.createAndWait?i.varbinds[h].value=x.notInService:(a[h]=new De({operation:i.type,oid:i.varbinds[h].oid}),u[h]=m);break;default:a[h]=new De({operation:i.type,oid:i.varbinds[h].oid}),u[h]=m}}else a[h]=new De({operation:i.type,oid:i.varbinds[h].oid}),u[h]=function(e){e.done({errorStatus:y.NoAccess,type:b.Null,value:null})};else a[h]=new De({operation:i.type,oid:i.varbinds[h].oid}),u[h]=function(e){e.done({errorStatus:y.NoAccess,type:b.Null,value:null})};else a[h]=new De({operation:i.type,oid:i.varbinds[h].oid}),u[h]=function(e){e.done({errorStatus:y.NoError,type:b.NoSuchInstance,value:null})};i.type!==v.SetRequest||c[h]||(l[h]=g.value),u[h]||(a[h]=new De({operation:i.type,providerNode:d,instanceNode:g,oid:i.varbinds[h].oid}),i.type==v.SetRequest&&(a[h].setType=i.varbinds[h].type,a[h].setValue=i.varbinds[h].requestValue||i.varbinds[h].value),u[h]=d.provider.handler)}else a[h]=new De({operation:i.type,oid:i.varbinds[h].oid}),u[h]=function(e){e.done({errorStatus:y.NoError,type:b.NoSuchObject,value:null})};!function(u){let p;a[u].done=function(h){let f=null,m=null,w=!1,I=-1;if(p={oid:a[u].oid},h)void 0!==s.errorStatus&&s.errorStatus!=y.NoError||h.errorStatus==y.NoError||(s.errorStatus=h.errorStatus,s.errorIndex=u+1),p.type=h.type||b.Null,p.value=h.value||null,h.errorStatus!=y.NoError&&(p.errorStatus=h.errorStatus);else{let e,t,n=d?d.provider:null,o=n?n.name:null;if(d&&d.provider&&d.provider.type==C.Table&&(I=g.getTableColumnFromInstanceNode(),e=Ae.getSubOidFromBaseOid(g.oid,n.oid),t=e.split("."),t.shift(),f=Ae.getRowIndexFromOid(t.join("."),n.tableIndex),m=r.mib.getTableRowCells(o,f)),i.type==v.SetRequest){let e=n.type==C.Table?n.tableColumns.reduce(((e,t)=>t.rowStatus?t.number:e),null):null;i.varbinds[u].value===x.destroy&&"number"==typeof e&&I===e?(r.mib.deleteTableRow(o,f),w=!0):a[u].instanceNode.setValue(r.castSetValue(i.varbinds[u].type,i.varbinds[u].value))||(void 0!==s.errorStatus&&s.errorStatus!=y.NoError||(s.errorStatus=y.WrongValue,s.errorIndex=u+1),p.errorStatus=y.WrongValue)}i.type!=v.GetNextRequest&&i.type!=v.GetBulkRequest||i.varbinds[u].type!=b.EndOfMibView?p.type=a[u].instanceNode.valueType:p.type=b.EndOfMibView,p.value=a[u].instanceNode.value}d&&d.provider&&d.provider.name&&(p.providerName=d.provider.name),i.type!=v.GetNextRequest&&i.type!=v.GetNextRequest||(p.previousOid=i.varbinds[u].previousOid),i.type==v.SetRequest&&(void 0!==l[u]&&(p.oldValue=l[u]),p.requestType=i.varbinds[u].type,i.varbinds[u].requestValue?p.requestValue=r.castSetValue(i.varbinds[u].type,i.varbinds[u].requestValue):p.requestValue=r.castSetValue(i.varbinds[u].type,i.varbinds[u].value)),c[u]?p.autoCreated=!0:w&&(p.deleted=!0),d&&d.provider.type==C.Table&&(p.column=I,p.columnPosition=d.provider.tableColumns.findIndex((e=>e.number==I)),p.rowIndex=f,!w&&f&&(m=r.mib.getTableRowCells(d.provider.name,f)),p.row=m),r.setSingleVarbind(s,u,p),++n==o&&r.sendResponse.call(r,t,e,s)}}(h),u[h]?u[h](a[h]):a[h].done()}},xe.prototype.getRequest=function(e,t){this.request(e,t)},xe.prototype.setRequest=function(e,t){this.request(e,t)},xe.prototype.addGetNextVarbind=function(e,t){var r,n;try{r=this.mib.lookup(t)}catch(e){t="1.3.6.1",r=this.mib.lookup(t)}return r||(r=this.mib.getTreeNode(t)),(n=r.getNextInstanceNode())?e.push({previousOid:t,oid:n.oid,type:n.valueType,value:n.value}):e.push({previousOid:t,oid:t,type:b.EndOfMibView,value:null}),n},xe.prototype.getNextRequest=function(e,t){for(var r=e.pdu,n=r.varbinds.length,i=[],o=0;o<n;o++)this.addGetNextVarbind(i,r.varbinds[o].oid);e.pdu.varbinds=i,this.request(e,t)},xe.prototype.getBulkRequest=function(e,t){for(var r,n=e.pdu,i=n.varbinds,o=[],s=[],a=!1,u=0;u<Math.min(n.nonRepeaters,i.length);u++)this.addGetNextVarbind(o,i[u].oid);if(n.nonRepeaters<i.length){for(var c=n.nonRepeaters;c<i.length;c++)s.push(i[c].oid);for(;o.length<n.maxRepetitions&&!a;)for(var l=n.nonRepeaters;l<i.length;l++)o.length<n.maxRepetitions&&(r=this.addGetNextVarbind(o,s[l-n.nonRepeaters]))&&(s[l-n.nonRepeaters]=r.oid,r.type==b.EndOfMibView&&(a=!0))}e.pdu.varbinds=o,this.request(e,t)},xe.prototype.setSingleVarbind=function(e,t,r){e.varbinds[t]=r},xe.prototype.sendResponse=function(e,t,r){var n=t.createResponseForRequest(r);this.listener.send(n,e),this.callback(null,Oe.formatCallbackData(n.pdu,e))},xe.prototype.onProxyRequest=function(e,t){var r,n,i,o=e.pdu.contextName;if(3==e.version)if(r=this.forwarder.getProxy(o))if(r.session.msgSecurityParameters){e.msgSecurityParameters=r.session.msgSecurityParameters,e.setAuthentication(!(r.user.level==I.noAuthNoPriv)),e.setPrivacy(r.user.level==I.authPriv),i=e.user,e.user=r.user,e.buffer=null,e.pdu.contextEngineID=r.session.msgSecurityParameters.msgAuthoritativeEngineID,e.pdu.contextName="",n=e.pdu.id,e.pdu.id=ge();var s=new fe(r.session,e,null,this.callback,{},!0);s.port=r.port,s.proxiedRinfo=t,s.proxiedPduId=n,s.proxiedUser=i,s.proxiedEngine=this.engine,r.session.send(s)}else r.session.sendV3Discovery(null,null,this.callback,{});else this.callback(new F("No proxy found for message received with context "+o));else this.callback(new F("Only SNMP version 3 contexts are supported"))},xe.prototype.getForwarder=function(){return this.forwarder},xe.prototype.close=function(){this.listener.close()},xe.create=function(e,t,r){var n=new xe(e,t,r);return n.listener.startListening(),n};var ke=function(e,t){this.proxies={},this.listener=e,this.callback=t};ke.prototype.addProxy=function(e){var t={version:3,port:e.port,transport:e.transport};e.session=me.createV3(e.target,e.user,t),e.session.proxy=e,e.session.proxy.listener=this.listener,this.proxies[e.context]=e,e.session.sendV3Discovery(null,null,this.callback)},ke.prototype.deleteProxy=function(e){var t=this.proxies[e];t&&t.session&&t.session.close(),delete this.proxies[e]},ke.prototype.getProxy=function(e){return this.proxies[e]},ke.prototype.getProxies=function(){return this.proxies},ke.prototype.dumpProxies=function(){var e={};for(var t of Object.values(this.proxies))e[t.context]={context:t.context,target:t.target,user:t.user,port:t.port};console.log(JSON.stringify(e,null,2))};var Re=function(){};Re.prototype.toBuffer=function(){var e=new i.SmartBuffer;switch(this.writeHeader(e),this.pduType){case T.Open:e.writeUInt32BE(this.timeout),Re.writeOid(e,this.oid),Re.writeOctetString(e,this.descr);break;case T.Close:e.writeUInt8(5),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0);break;case T.Register:e.writeUInt8(this.timeout),e.writeUInt8(this.priority),e.writeUInt8(this.rangeSubid),e.writeUInt8(0),Re.writeOid(e,this.oid);break;case T.Unregister:e.writeUInt8(0),e.writeUInt8(this.priority),e.writeUInt8(this.rangeSubid),e.writeUInt8(0),Re.writeOid(e,this.oid);break;case T.AddAgentCaps:Re.writeOid(e,this.oid),Re.writeOctetString(e,this.descr);break;case T.RemoveAgentCaps:Re.writeOid(e,this.oid);break;case T.Notify:Re.writeVarbinds(e,this.varbinds);break;case T.Ping:break;case T.Response:e.writeUInt32BE(this.sysUpTime),e.writeUInt16BE(this.error),e.writeUInt16BE(this.index),Re.writeVarbinds(e,this.varbinds)}return e.writeUInt32BE(e.length-20,16),e.toBuffer()},Re.prototype.writeHeader=function(e){return this.flags=16|this.flags,e.writeUInt8(1),e.writeUInt8(this.pduType),e.writeUInt8(this.flags),e.writeUInt8(0),e.writeUInt32BE(this.sessionID),e.writeUInt32BE(this.transactionID),e.writeUInt32BE(this.packetID),e.writeUInt32BE(0),e},Re.prototype.readHeader=function(e){this.version=e.readUInt8(),this.pduType=e.readUInt8(),this.flags=e.readUInt8(),e.readUInt8(),this.sessionID=e.readUInt32BE(),this.transactionID=e.readUInt32BE(),this.packetID=e.readUInt32BE(),this.payloadLength=e.readUInt32BE()},Re.createFromVariables=function(e){var t=new Re;switch(t.flags=e.flags?16|e.flags:16,t.pduType=e.pduType||T.Open,t.sessionID=e.sessionID||0,t.transactionID=e.transactionID||0,t.packetID=e.packetID||++Re.packetID,t.pduType){case T.Open:t.timeout=e.timeout||0,t.oid=e.oid||null,t.descr=e.descr||null;break;case T.Close:break;case T.Register:t.timeout=e.timeout||0,t.oid=e.oid||null,t.priority=e.priority||127,t.rangeSubid=e.rangeSubid||0;break;case T.Unregister:t.oid=e.oid||null,t.priority=e.priority||127,t.rangeSubid=e.rangeSubid||0;break;case T.AddAgentCaps:t.oid=e.oid,t.descr=e.descr;break;case T.RemoveAgentCaps:t.oid=e.oid;break;case T.Notify:t.varbinds=e.varbinds;break;case T.Ping:break;case T.Response:t.sysUpTime=e.sysUpTime||0,t.error=e.error||0,t.index=e.index||0,t.varbinds=e.varbinds||null;break;default:throw new B("Unknown PDU type '"+t.pduType+"' in created PDU")}return t},Re.createFromBuffer=function(e){var t=new Re,r=i.SmartBuffer.fromBuffer(e);switch(t.readHeader(r),t.pduType){case T.Response:t.sysUpTime=r.readUInt32BE(),t.error=r.readUInt16BE(),t.index=r.readUInt16BE();break;case T.Get:case T.GetNext:t.searchRangeList=Re.readSearchRangeList(r,t.payloadLength);break;case T.GetBulk:t.nonRepeaters=r.readUInt16BE(),t.maxRepetitions=r.readUInt16BE(),t.searchRangeList=Re.readSearchRangeList(r,t.payloadLength-4);break;case T.TestSet:t.varbinds=Re.readVarbinds(r,t.payloadLength);break;case T.CommitSet:case T.UndoSet:case T.CleanupSet:break;default:throw new B("Unknown PDU type '"+t.pduType+"' in request")}return t},Re.writeOid=function(e,t,r=0){var n;if(t){var i=t.split(".").map(Number);i.length>=5&&"1.3.6.1"==i.slice(0,4).join(".")?(n=i[4],i=i.slice(5)):n=0,e.writeUInt8(i.length),e.writeUInt8(n),e.writeUInt8(r),e.writeUInt8(0);for(let t of i)e.writeUInt32BE(t)}else e.writeUInt32BE(0)},Re.writeOctetString=function(e,t){e.writeUInt32BE(t.length),e.writeString(t);var r=(4-t.length%4)%4;for(let t=0;t<r;t++)e.writeUInt8(0)},Re.writeVarBind=function(e,t){if(e.writeUInt16BE(t.type),e.writeUInt16BE(0),Re.writeOid(e,t.oid),t.type&&t.oid)switch(t.type){case b.Integer:case b.Counter:case b.Gauge:case b.TimeTicks:e.writeUInt32BE(t.value);break;case b.OctetString:case b.Opaque:Re.writeOctetString(e,t.value);break;case b.OID:Re.writeOid(e,t.value);break;case b.IpAddress:var r=t.value.split(".");if(4!=r.length)throw new B("Invalid IP address '"+t.value+"'");e.writeOctetString(e,Buffer.from(r));break;case b.Counter64:e.writeUint64(t.value);break;case b.Null:case b.EndOfMibView:case b.NoSuchObject:case b.NoSuchInstance:break;default:throw new B("Unknown type '"+t.type+"' in request")}},Re.writeVarbinds=function(e,t){if(t)for(var r=0;r<t.length;r++){var n=t[r];Re.writeVarBind(e,n)}},Re.readOid=function(e){var t=e.readUInt8(),r=e.readUInt8(),n=e.readUInt8();if(e.readUInt8(),0==t&&0==r&&0==n)return null;var i=[];i=0==r?[]:[1,3,6,1,r];for(let r=0;r<t;r++)i.push(e.readUInt32BE());return i.join(".")},Re.readSearchRange=function(e){return{start:Re.readOid(e),end:Re.readOid(e)}},Re.readSearchRangeList=function(e,t){for(var r=t,n=e.readOffset+1,i=[];r>0;)i.push(Re.readSearchRange(e)),r-=e.readOffset+1-n,n=e.readOffset+1;return i},Re.readOctetString=function(e){var t=e.readUInt32BE(),r=(4-t%4)%4,n=e.readString(t);return e.readString(r),n},Re.readVarbind=function(e){var t=e.readUInt16BE();e.readUInt16BE();var r,n=Re.readOid(e);switch(t){case b.Integer:case b.Counter:case b.Gauge:case b.TimeTicks:r=e.readUInt32BE();break;case b.OctetString:case b.IpAddress:case b.Opaque:r=Re.readOctetString(e);break;case b.OID:r=Re.readOid(e);break;case b.Counter64:r=z(e);break;case b.Null:case b.NoSuchObject:case b.NoSuchInstance:case b.EndOfMibView:r=null;break;default:throw new B("Unknown type '"+t+"' in varbind")}return{type:t,oid:n,value:r}},Re.readVarbinds=function(e,t){for(var r=t,n=e.readOffset+1,i=[];r>0;)i.push(Re.readVarbind(e)),r-=e.readOffset+1-n,n=e.readOffset+1;return i},Re.packetID=1;var Be=function(e){p=e.debug,this.mib=new Ae,this.master=e.master||"localhost",this.masterPort=e.masterPort||705,this.timeout=e.timeout||0,this.descr=e.description||"Node net-snmp AgentX sub-agent",this.sessionID=0,this.transactionID=0,this.packetID=ge(),this.requestPdus={},this.setTransactions={}};u.inherits(Be,a.EventEmitter),Be.prototype.onClose=function(){this.emit("close")},Be.prototype.onError=function(e){this.emit("error",e)},Be.prototype.getMib=function(){return this.mib},Be.prototype.connectSocket=function(){var e=this;this.socket=new s.Socket,this.socket.connect(this.masterPort,this.master,(function(){m("Connected to '"+e.master+"' on port "+e.masterPort)})),this.socket.on("data",e.onMsg.bind(e)),this.socket.on("error",e.onError.bind(e)),this.socket.on("close",e.onClose.bind(e))},Be.prototype.open=function(e){var t=Re.createFromVariables({pduType:T.Open,timeout:this.timeout,oid:this.oid,descr:this.descr});this.sendPdu(t,e)},Be.prototype.close=function(e){var t=Re.createFromVariables({pduType:T.Close,sessionID:this.sessionID});this.sendPdu(t,e)},Be.prototype.registerProvider=function(e,t){var r=Re.createFromVariables({pduType:T.Register,sessionID:this.sessionID,rangeSubid:0,timeout:5,priority:127,oid:e.oid});this.mib.registerProvider(e),this.sendPdu(r,t)},Be.prototype.unregisterProvider=function(e,t){var r=this.getProvider(e),n=Re.createFromVariables({pduType:T.Unregister,sessionID:this.sessionID,rangeSubid:0,priority:127,oid:r.oid});this.mib.unregisterProvider(e),this.sendPdu(n,t)},Be.prototype.registerProviders=function(e,t){for(var r of e)this.registerProvider(r,t)},Be.prototype.getProvider=function(e){return this.mib.getProvider(e)},Be.prototype.getProviders=function(){return this.mib.getProviders()},Be.prototype.addAgentCaps=function(e,t,r){var n=Re.createFromVariables({pduType:T.AddAgentCaps,sessionID:this.sessionID,oid:e,descr:t});this.sendPdu(n,r)},Be.prototype.removeAgentCaps=function(e,t){var r=Re.createFromVariables({pduType:T.RemoveAgentCaps,sessionID:this.sessionID,oid:e});this.sendPdu(r,t)},Be.prototype.notify=function(e,t,r){t=t||[],"string"!=typeof e&&(e="1.3.6.1.6.3.1.1.5."+(e+1));var n=[{oid:"1.3.6.1.2.1.1.3.0",type:b.TimeTicks,value:Math.floor(100*process.uptime())},{oid:"1.3.6.1.6.3.1.1.4.1.0",type:b.OID,value:e}];n=n.concat(t);var i=Re.createFromVariables({pduType:T.Notify,sessionID:this.sessionID,varbinds:n});this.sendPdu(i,r)},Be.prototype.ping=function(e){var t=Re.createFromVariables({pduType:T.Ping,sessionID:this.sessionID});this.sendPdu(t,e)},Be.prototype.sendPdu=function(e,t){m("Sending AgentX "+T[e.pduType]+" PDU"),m(e);var r=e.toBuffer();this.socket.write(r),e.pduType==T.Response||this.requestPdus[e.packetID]||(e.callback=t,this.requestPdus[e.packetID]=e)},Be.prototype.onMsg=function(e,t){var r=Re.createFromBuffer(e);switch(m("Received AgentX "+T[r.pduType]+" PDU"),m(r),r.pduType){case T.Response:this.response(r);break;case T.Get:this.getRequest(r);break;case T.GetNext:this.getNextRequest(r);break;case T.GetBulk:this.getBulkRequest(r);break;case T.TestSet:this.testSet(r);break;case T.CommitSet:this.commitSet(r);break;case T.UndoSet:this.undoSet(r);break;case T.CleanupSet:this.cleanupSet(r);break;default:throw new B("Unknown PDU type '"+r.pduType+"' in request")}},Be.prototype.response=function(e){var t=this.requestPdus[e.packetID];if(!t)throw new R("Unexpected Response PDU with packetID "+e.packetID,k.EUnexpectedResponse);switch(delete this.requestPdus[e.packetID],t.pduType){case T.Open:this.sessionID=e.sessionID;break;case T.Close:this.socket.end();break;case T.Register:case T.Unregister:case T.AddAgentCaps:case T.RemoveAgentCaps:case T.Notify:case T.Ping:break;default:throw new R("Response PDU for type '"+t.pduType+"' not handled",k.EResponseNotHandled)}t.callback&&t.callback(null,e)},Be.prototype.request=function(e,t){for(var r=this,n=0,i=t.length,o=[],s=0;s<t.length;s++){var a,u,c,l,p=t[s],h=this.mib.lookup(p.oid);h?(a=this.mib.getProviderNodeForInstance(h))?(u=new De({operation:e.pduType,providerNode:a,instanceNode:h,oid:p.oid}),e.pduType==T.TestSet&&(u.setType=p.type,u.setValue=p.value),c=a.provider.handler):(u=new De({operation:e.pduType,oid:p.oid}),c=function(e){e.done({errorStatus:y.NoError,errorIndex:0,type:b.NoSuchInstance,value:null})}):(u=new De({operation:e.pduType,oid:p.oid}),c=function(e){e.done({errorStatus:y.NoError,errorIndex:0,type:b.NoSuchObject,value:null})}),function(t){var s;u.done=function(a){a?s={oid:u.oid,type:a.type||b.Null,value:a.value||null}:(e.pduType==T.TestSet||(e.pduType==T.CommitSet?(r.setTransactions[e.transactionID].originalValue=u.instanceNode.value,u.instanceNode.value=p.value):e.pduType==T.UndoSet&&(u.instanceNode.value=r.setTransactions[e.transactionID].originalValue)),l=e.pduType!=T.GetNext&&e.pduType!=T.GetBulk||p.type!=b.EndOfMibView?u.instanceNode.valueType:b.EndOfMibView,s={oid:u.oid,type:l,value:u.instanceNode.value}),o[t]=s,++n==i&&(e.pduType==T.TestSet||e.pduType==T.CommitSet||e.pduType==T.UndoSet?r.sendSetResponse.call(r,e):r.sendGetResponse.call(r,e,o))}}(s),c?c(u):u.done()}},Be.prototype.addGetNextVarbind=function(e,t){var r,n;try{r=this.mib.lookup(t)}catch(e){t="1.3.6.1",r=this.mib.lookup(t)}return r||(r=this.mib.getTreeNode(t)),(n=r.getNextInstanceNode())?e.push({oid:n.oid,type:n.valueType,value:n.value}):e.push({oid:t,type:b.EndOfMibView,value:null}),n},Be.prototype.getRequest=function(e){for(var t=[],r=0;r<e.searchRangeList.length;r++)t.push({oid:e.searchRangeList[r].start,value:null,type:null});this.request(e,t)},Be.prototype.getNextRequest=function(e){for(var t=[],r=0;r<e.searchRangeList.length;r++)this.addGetNextVarbind(t,e.searchRangeList[r].start);this.request(e,t)},Be.prototype.getBulkRequest=function(e){for(var t,r=[],n=[],i=!1,o=0;o<e.nonRepeaters;o++)this.addGetNextVarbind(r,e.searchRangeList[o].start);for(var s=e.nonRepeaters;s<e.searchRangeList.length;s++)n.push(e.searchRangeList[s].oid);for(;r.length<e.maxRepetitions&&!i;)for(var a=e.nonRepeaters;a<e.searchRangeList.length;a++)r.length<e.maxRepetitions&&(t=this.addGetNextVarbind(r,n[a-e.nonRepeaters]))&&(n[a-e.nonRepeaters]=t.oid,t.type==b.EndOfMibView&&(i=!0));this.request(e,r)},Be.prototype.sendGetResponse=function(e,t){var r=Re.createFromVariables({pduType:T.Response,sessionID:e.sessionID,transactionID:e.transactionID,packetID:e.packetID,sysUpTime:0,error:0,index:0,varbinds:t});this.sendPdu(r,null)},Be.prototype.sendSetResponse=function(e){var t=Re.createFromVariables({pduType:T.Response,sessionID:e.sessionID,transactionID:e.transactionID,packetID:e.packetID,sysUpTime:0,error:0,index:0});this.sendPdu(t,null)},Be.prototype.testSet=function(e){this.setTransactions[e.transactionID]=e,this.request(e,e.varbinds)},Be.prototype.commitSet=function(e){if(!this.setTransactions[e.transactionID])throw new B("Unexpected CommitSet PDU with transactionID "+e.transactionID);this.request(e,this.setTransactions[e.transactionID].varbinds)},Be.prototype.undoSet=function(e){if(!this.setTransactions[e.transactionID])throw new B("Unexpected UndoSet PDU with transactionID "+e.transactionID);this.request(e,this.setTransactions[e.transactionID].varbinds)},Be.prototype.cleanupSet=function(e){if(!this.setTransactions[e.transactionID])throw new B("Unexpected CleanupSet PDU with transactionID "+e.transactionID);delete this.setTransactions[e.transactionID]},Be.create=function(e){var t=new Be(e);return t.connectSocket(),t},t.Session=me,t.createSession=me.create,t.createV3Session=me.createV3,t.createReceiver=Te.create,t.createAgent=xe.create,t.createModuleStore=Pe.create,t.createSubagent=Be.create,t.createMib=Ae.create,t.isVarbindError=U,t.varbindError=j,t.Version1=0,t.Version2c=1,t.Version3=3,t.Version={1:0,"2c":1,3:3},t.ErrorStatus=y,t.TrapType=w,t.ObjectType=b,t.PduType=v,t.AgentXPduType=T,t.MibProviderType=C,t.SecurityLevel=I,t.AuthProtocols=_,t.PrivProtocols=E,t.AccessControlModelType=P,t.AccessLevel=N,t.MaxAccess=A,t.RowStatus=x,t.ResponseInvalidCode=k,t.ResponseInvalidError=R,t.RequestInvalidError=B,t.RequestFailedError=F,t.RequestTimedOutError=L,t.ObjectParser={readInt32:q,readUint32:K,readVarbindValue:H},t.Authentication=pe,t.Encryption=he},4774(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const i=n.default(this._queue,r,((e,t)=>t.priority-e.priority));this._queue.splice(i,0,r)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},4797(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.getNamedItem=function(e){return this.nodes[e]},e.prototype.setNamedItem=function(e){var t;return t=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,t||null},e.prototype.removeNamedItem=function(e){var t;return t=this.nodes[e],delete this.nodes[e],t||null},e.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},e.prototype.getNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.removeNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},4865(e){"use strict";const t=(e,t,n,i)=>{if("length"===n||"prototype"===n)return;if("arguments"===n||"caller"===n)return;const o=Object.getOwnPropertyDescriptor(e,n),s=Object.getOwnPropertyDescriptor(t,n);!r(o,s)&&i||Object.defineProperty(e,n,s)},r=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},n=(e,t)=>`/* Wrapped ${e}*/\n${t}`,i=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),o=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,r,{ignoreNonConfigurable:s=!1}={})=>{const{name:a}=e;for(const n of Reflect.ownKeys(r))t(e,r,n,s);return((e,t)=>{const r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)})(e,r),((e,t,r)=>{const s=""===r?"":`with ${r.trim()}() `,a=n.bind(null,s,t.toString());Object.defineProperty(a,"name",o),Object.defineProperty(e,"toString",{...i,value:a})})(e,r,a),e}},4923(e){(function(){e.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},5071(e){e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},5158(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5170(e,t,r){const n=r(9637),i=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(i.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),o=`  ${i};1m${n} [0m`;r[0]=o+r[0].split("\n").join("\n"+o),r.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=i.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(5983)(t);const{formatters:o}=e.exports;o.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},5521(e){e.exports={GPI_LIST:[{id:"01",label:"GPI 1"},{id:"02",label:"GPI 2"},{id:"03",label:"GPI 3"},{id:"04",label:"GPI 4"},{id:"05",label:"GPI 5"},{id:"06",label:"GPI 6"},{id:"07",label:"GPI 7"},{id:"08",label:"GPI 8"},{id:"09",label:"GPI 9"},{id:"10",label:"GPI 10"},{id:"11",label:"GPI 11"},{id:"12",label:"GPI 12"},{id:"13",label:"GPI 13"},{id:"14",label:"GPI 14"},{id:"15",label:"GPI 15"},{id:"16",label:"GPI 16"}],GPO_LIST:[{id:"01",label:"GPO 1"},{id:"02",label:"GPO 2"},{id:"03",label:"GPO 3"},{id:"04",label:"GPO 4"},{id:"05",label:"GPO 5"},{id:"06",label:"GPO 6"},{id:"07",label:"GPO 7"},{id:"08",label:"GPO 8"},{id:"09",label:"GPO 9"},{id:"10",label:"GPO 10"},{id:"11",label:"GPO 11"},{id:"12",label:"GPO 12"},{id:"13",label:"GPO 13"},{id:"14",label:"GPO 14"},{id:"15",label:"GPO 15"},{id:"16",label:"GPO 16"}],MEM_LIST:[{id:"01",label:"MEM 1"},{id:"02",label:"MEM 2"},{id:"03",label:"MEM 3"},{id:"04",label:"MEM 4"},{id:"05",label:"MEM 5"},{id:"06",label:"MEM 6"},{id:"07",label:"MEM 7"},{id:"08",label:"MEM 8"},{id:"09",label:"MEM 9"},{id:"10",label:"MEM 10"},{id:"11",label:"MEM 11"},{id:"12",label:"MEM 12"},{id:"13",label:"MEM 13"},{id:"14",label:"MEM 14"},{id:"15",label:"MEM 15"},{id:"16",label:"MEM 16"}],KEY_LIST:[{id:"01",label:"KEY 1"},{id:"02",label:"KEY 2"},{id:"03",label:"KEY 3"},{id:"04",label:"KEY 4"},{id:"05",label:"KEY 5"},{id:"06",label:"KEY 6"},{id:"07",label:"KEY 7"},{id:"08",label:"KEY 8"},{id:"09",label:"KEY 9"},{id:"10",label:"KEY 10"},{id:"11",label:"KEY 11"},{id:"12",label:"KEY 12"},{id:"13",label:"KEY 13"},{id:"14",label:"KEY 14"},{id:"15",label:"KEY 15"},{id:"16",label:"KEY 16"}],COLORS:[{id:"00",label:"SOLID_DARK",hex:"#000000"},{id:"01",label:"SOLID_RED",hex:"#FF0000"},{id:"02",label:"SOLID_GREEN",hex:"#00FF00"},{id:"03",label:"SOLID_AMBER",hex:"#FF8000"},{id:"38",label:"SOLID_AQUA",hex:"#00FFFF"},{id:"20",label:"SOLID_BLUE",hex:"#0000FF"},{id:"32",label:"SOLID_PURPLE",hex:"#FF00FF"},{id:"26",label:"SOLID_WHITE",hex:"#FFFFFF"},{id:"04",label:"BLINKING_RED_FAST"},{id:"05",label:"BLINKING_RED_SLOW"},{id:"06",label:"BLINKING_GREEN_FAST"},{id:"07",label:"BLINKING_GREEN_SLOW"},{id:"08",label:"BLINKING_AMBER_FAST"},{id:"09",label:"BLINKING_AMBER_SLOW"},{id:"39",label:"BLINKING_AQUA_FAST"},{id:"40",label:"BLINKING_AQUA_SLOW"},{id:"21",label:"BLINKING_BLUE_FAST"},{id:"22",label:"BLINKING_BLUE_SLOW"},{id:"33",label:"BLINKING_PURPLE_FAST"},{id:"34",label:"BLINKING_PURPLE_SLOW"},{id:"27",label:"BLINKING_WHITE_FAST"},{id:"28",label:"BLINKING_WHITE_SLOW"},{id:"10",label:"SOLID_RED_DIM"},{id:"11",label:"SOLID_GREEN_DIM"},{id:"12",label:"SOLID_AMBER_DIM"},{id:"41",label:"SOLID_AQUA_DIM"},{id:"23",label:"SOLID_BLUE_DIM"},{id:"35",label:"SOLID_PURPLE_DIM"},{id:"29",label:"SOLID_WHITE_DIM"},{id:"13",label:"BLINKING_RED_FAST_DIM"},{id:"14",label:"BLINKING_RED_SLOW_DIM"},{id:"15",label:"BLINKING_GREEN_FAST_DIM"},{id:"16",label:"BLINKING_GREEN_SLOW_DIM"},{id:"17",label:"BLINKING_AMBER_FAST_DIM"},{id:"18",label:"BLINKING_AMBER_SLOW_DIM"},{id:"42",label:"BLINKING_AQUA_FAST_DIM"},{id:"43",label:"BLINKING_AQUA_SLOW_DIM"},{id:"24",label:"BLINKING_BLUE_FAST_DIM"},{id:"25",label:"BLINKING_BLUE_SLOW_DIM"},{id:"36",label:"BLINKING_PURPLE_FAST_DIM"},{id:"37",label:"BLINKING_PURPLE_SLOW_DIM"},{id:"30",label:"BLINKING_WHITE_FAST_DIM"},{id:"31",label:"BLINKING_WHITE_SLOW_DIM"}]}},5529(e,t,r){(function(){var t,n,i,o={}.hasOwnProperty;i=r(9241).isObject,n=r(468),t=r(1737),e.exports=function(e){function r(e,n,o,s){if(r.__super__.constructor.call(this,e),null==o)throw new Error("Missing DTD entity name. "+this.debugInfo(o));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(o));if(this.pe=!!n,this.name=this.stringify.name(o),this.type=t.EntityDeclaration,i(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(o));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(o));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(o))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}return function(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(e){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},5660(e){(function(){e.exports=function(){function e(){}return e.prototype.handleError=function(e){throw new Error(e)},e}()}).call(this)},5692(e){"use strict";e.exports=require("https")},5753(e,t,r){"use strict";"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(7833):e.exports=r(6033)},5879(e,t,r){var n=r(3164).http,i=r(3164).https,o=r(7016),s=r(9023),a=r(4434),u=r(3106),c=r(4324)("NRC");t.K=function(e){var t=this,n=r(2501)(),i=r(5950)(),u=new l(this,n),c=function(e,r){var n=function(e){return function(){try{return e.apply(this,arguments)}catch(e){t.emit("error",e)}}},i={parsers:{},serializers:{}};return i.parsers.add=n(e.add),i.parsers.remove=n(e.remove),i.parsers.find=n(e.find),i.parsers.getAll=n(e.getAll),i.parsers.getDefault=n(e.getDefault),i.parsers.clean=n(e.clean),i.serializers.add=n(r.add),i.serializers.remove=n(r.remove),i.serializers.find=n(r.find),i.serializers.getAll=n(r.getAll),i.serializers.getDefault=n(r.getDefault),i.serializers.clean=n(r.clean),i}(n,i),h="Content-Length";t.options=e||{},t.useProxy=!!t.options.proxy,t.useProxyTunnel=!(!t.useProxy||void 0===t.options.proxy.tunnel)&&t.options.proxy.tunnel,t.proxy=t.options.proxy,t.connection=t.options.connection||{},t.mimetypes=t.options.mimetypes||{},t.requestConfig=t.options.requestConfig||{},t.responseConfig=t.options.responseConfig||{},this.methods={},this.parsers={},this.serializers={};var d=function(){a.EventEmitter.call(this)};s.inherits(d,a.EventEmitter),d.prototype.end=function(){this._httpRequest&&this._httpRequest.end()},d.prototype.setHttpRequest=function(e){this._httpRequest=e};var f={createProxyPath:function(e){var t=e.host;return"https:"===e.protocol&&(t=-1==e.host.indexOf(":")?e.hostname+":443":e.host),t},createProxyHeaders:function(e){var r={};return t.proxy.user&&t.proxy.password&&(r["Proxy-Authorization"]="Basic "+new Buffer([t.proxy.user,t.proxy.password].join(":")).toString("base64")),t.useProxyTunnel||(r.host=e.host),r},createConnectOptions:function(e,r){p("connect URL = ",e);var n=o.parse(e),i={},s=-1==n.protocol.indexOf(":")?n.protocol:n.protocol.substring(0,n.protocol.indexOf(":")),a="http"===s?80:443;if(i={host:-1==n.host.indexOf(":")?n.host:n.host.substring(0,n.host.indexOf(":")),port:void 0===n.port?a:n.port,path:n.path,protocol:s,href:n.href},t.useProxy&&(i.agent=!1),t.options.user&&t.options.password?i.auth=[t.options.user,t.options.password].join(":"):t.options.user&&!t.options.password&&(i.auth=t.options.user+":"),t.useProxy&&(i.proxy={host:t.proxy.host,port:t.proxy.port,method:t.useProxyTunnel?"CONNECT":r,path:t.useProxyTunnel?this.createProxyPath(n):e,headers:this.createProxyHeaders(n)}),t.connection&&"object"==typeof t.connection)for(var u in t.connection)i[u]=t.connection[u];if(!t.useProxyTunnel){for(var c in i.proxy)i[c]=i.proxy[c];delete i.proxy}return i.requestConfig=t.requestConfig,i.responseConfig=t.responseConfig,i},decodeQueryFromURL:function(e){for(var t,r=o.parse(e).query.substring(1).split("&"),n={},i=0;i<r.length;i++)n[(t=r[i].split("="))[0]]=decodeURIComponent(t[1]);return n},serializeEncodeQueryFromArgs:function(e){return p("args is",e),e&&"object"!=typeof e&&t.emit("error","cannot serialize parameters: invalid type "+typeof e+" should be an object type"),function e(t,r){var n,i=[];for(n in t)if(t.hasOwnProperty(n)){var o=r?r+"["+n+"]":n,s=t[n];i.push(null!==s&&"object"==typeof s?e(s,o):encodeURIComponent(o)+"="+encodeURIComponent(s))}return i.join("&")}(e)},parsePathParameters:function(e,t){var r=t;if(!e||!e.path)return t;for(var n in e.path){var i=new RegExp("\\$\\{"+n+"\\}","i");r=r.replace(i,e.path[n])}return r},overrideClientConfig:function(e,t){function r(e){return e&&"object"==typeof e}r(t.requestConfig)&&s._extend(e.requestConfig,t.requestConfig),r(t.responseConfig)&&s._extend(e.responseConfig,t.responseConfig)},connect:function(e,r,n,o,s){o&&n&&"object"!=typeof n&&t.emit("error","args should be and object");var a,c=this.createConnectOptions(this.parsePathParameters(n,r),e);if(p("options pre connect",c),c.method=e,s.href=c.href,c.clientRequest=s,c.headers=c.headers||{},p("args = ",n),p("args.data = ",void 0!==n?n.data:void 0),"function"==typeof n)o=n,"POST"!==e&&"PUT"!==e&&"DELETE"!==e&&"PATCH"!==e||(c.headers[h]=0);else if("object"==typeof n){if(n.headers)for(var l in n.headers)n.headers.hasOwnProperty(l)&&(c.headers[l]=n.headers[l]);if(n.parameters&&Object.keys(n.parameters).length>0){var d=c.path.length,m=c.path.indexOf("?");m>=0&&m!==d-1&&t.emit("error","parameters argument cannot be used if parameters are already defined in URL "+c.path),c.path+="?"===c.path.charAt(d-1)?"":"?",c.path=c.path.concat(f.serializeEncodeQueryFromArgs(n.parameters)),p("options.path after request parameters = ",c.path)}this.overrideClientConfig(c,n),void 0===n.data||c.headers.hasOwnProperty(h)?c.headers[h]=0:i.get(c).serialize(n.data,(a=t,function(e,t){a.emit(e,t)}),(function(e){c.data=e,c.headers[h]=Buffer.byteLength(c.data,"utf8")}))}p("options post connect",c),p("FINAL SELF object  ====>",t),t.useProxy&&t.useProxyTunnel?u.proxy(c,o):u.normal(c,o)},mergeMimeTypes:function(e){if(e&&"object"==typeof e)try{e.json&&e.json instanceof Array&&e.json.length>0?n.find("JSON").contentTypes=e.json:e.xml&&e.xml instanceof Array&&e.xml.length>0&&(n.find("XML").contentTypes=e.xml)}catch(e){t.emit("error","cannot assign custom content types to parser, cause: "+e)}},createHttpMethod:function(e){return function(t,r,n){var i=new d;return f.connect(e.toUpperCase(),t,r,n,i),i}}},m=function(e,r){var n=t[r.toLowerCase()];return function(t,r){return"function"==typeof t&&(r=t,t={}),n(e,t,r)}};this.get=f.createHttpMethod("get"),this.post=f.createHttpMethod("post"),this.put=f.createHttpMethod("put"),this.delete=f.createHttpMethod("delete"),this.patch=f.createHttpMethod("patch"),this.registerMethod=function(e,t,r){this.methods[e]=new m(t,r)},this.unregisterMethod=function(e){delete this.methods[e]},this.addCustomHttpMethod=function(e){t[e.toLowerCase()]=f.createHttpMethod(e)},this.parsers=c.parsers,this.serializers=c.serializers,f.mergeMimeTypes(t.mimetypes),p("ConnectManager",u)};var l=function(e,t){this.configureRequest=function(e,t,r){t.timeout&&e.setTimeout(t.timeout,(function(){r.emit("requestTimeout",e)})),t.noDelay&&e.setNoDelay(t.noDelay),t.keepAlive&&e.setSocketKeepAlive(t.noDelay,t.keepAliveDelay||0)},this.configureResponse=function(e,t,r){t.timeout&&e.setTimeout(t.timeout,(function(){r.emit("responseTimeout",e),e.close()}))},this.configureOptions=function(e){!function(t,r){for(var n in t)r.hasOwnProperty(t[n])&&(e[t[n]]=r[t[n]])}(["followRedirects","maxRedirects"],e.requestConfig),delete e.protocol,delete e.clientRequest,delete e.requestConfig,delete e.responseConfig,p("options pre connect",e)},this.handleEnd=function(e,t,r){var n=this,i=e.headers["content-type"],o=e.headers["content-encoding"];p("content-type: ",i),p("content-encoding: ",o),void 0!==o&&o.indexOf("gzip")>=0?(p("gunzip"),u.gunzip(Buffer.concat(t),(function(t,i){n.handleResponse(e,i,r)}))):void 0!==o&&o.indexOf("deflate")>=0?(p("inflate"),u.inflate(Buffer.concat(t),(function(t,i){n.handleResponse(e,i,r)}))):(p("not compressed"),n.handleResponse(e,Buffer.concat(t),r))},this.handleResponse=function(r,n,i){t.get(r).parse(n,function(e){return function(t,r){e.emit(t,r)}}(e),(function(e){i(e,r)}))},this.prepareData=function(e){return e instanceof Buffer||"object"!=typeof e?e:JSON.stringify(e)},this.proxy=function(t,r){p("proxy options",t.proxy);var o=n.request(t.proxy),s=this;o.on("connect",(function(o,a,u){p("proxy connected",a),t.socket=a;var c=[],l="http"==t.protocol?n:i,h=t.clientRequest,d=t.requestConfig,f=t.responseConfig;s.configureOptions(t),h.options=t;var m=l.request(t,(function(t){s.configureResponse(t,f,h),t.on("data",(function(e){c.push(Buffer.from(e))})),t.on("end",(function(){s.handleEnd(t,c,r)})),t.on("error",(function(r){void 0!==h&&"object"==typeof h?(r.request=h,r.response=t,h.emit("error",r)):e.emit("error",r)}))}));s.configureRequest(m,d,h),h.setHttpRequest(m),t.data&&m.write(t.data),m.end(),m.on("error",(function(t){void 0!==h&&"object"==typeof h?(t.request=h,h.emit("error",t)):e.emit("error",t)}))})),o.on("error",(function(t){e.emit("error",t)})),o.end()},this.normal=function(t,r){var o=[],s="http"===t.protocol?n:i,a=t.clientRequest,u=t.requestConfig,c=t.responseConfig,l=this;l.configureOptions(t),a.options=t;var h=s.request(t,(function(t){l.configureResponse(t,c,a),t.on("data",(function(e){o.push(Buffer.from(e))})),t.on("end",(function(){l.handleEnd(t,o,r)})),t.on("error",(function(r){void 0!==a&&"object"==typeof a?(r.request=a,r.response=t,a.emit("error",r)):e.emit("error",r)}))}));l.configureRequest(h,u,a),p("clientRequest",a),a.setHttpRequest(h),p("options data",t.data),t.data&&h.write(t.data),h.end(),h.on("error",(function(t){void 0!==a&&"object"==typeof a?(t.request=a,a.emit("error",t)):e.emit("error",t)}))}};s.inherits(t.K,a.EventEmitter);var p=function(){if(process.env.DEBUG){var e=new Date,t=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+" [NRC CLIENT]"+arguments.callee.caller.name+" -> ",r=Array.prototype.slice.call(arguments);r.splice(0,0,t),c.apply(console,r)}}},5884(e){"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return-1!==n&&(-1===i||n<i)}},5915(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(1737),n=r(7457),e.exports=function(e){function r(e,n,i){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,i&&(this.value=this.stringify.insValue(i))}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(e))},r.prototype.isEqualNode=function(e){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.target===this.target},r}(n)}).call(this)},5950(e,t,r){var n=r(8805),i=function(){var e={},t=null;this.add=function(r){if(!function(e){function t(e,t){var r=!0;for(var n in t){var i=t[n].split(":");if(!e.hasOwnProperty([i[0]])||typeof e[i[0]]!==i[1]){r=!1;break}}return r}return result=t(e,["name:string","serialize:function","isDefault:boolean"]),result&&!e.isDefault&&(result=t(e,["match:function"])),result}(r))throw"serializer cannot be added: invalid serializer definition";r.isDefault?t=r:e[r.name]=r},this.remove=function(t){if(!e[t])throw"cannot remove serializer: "+t+" doesn't exists";delete e[t]},this.find=function(t){var r=e[t];if(!r)throw"cannot find serializer: "+t+" doesn't exists";return r},this.clean=function(){e={}},this.get=function(r){var n=null;for(var i in e)if(e[i].match(r)){n=e[i];break}return null===n?t:n},this.getAll=function(){var t=[];for(var r in e)t.push(e[r]);return t},this.getDefault=function(){return t}};e.exports=function(){var e=new i,t={isDefault:!1,match:function(e){var t=!1,r=e.headers["Content-Type"]&&e.headers["Content-Type"].replace(/ /g,"");if(!r)return t;for(var n=0;n<this.contentTypes.length&&!(t=this.contentTypes[n].trim().toLowerCase()===r.trim().toLowerCase());n++);return t}};return e.add(Object.assign({name:"XML",options:{},contentTypes:["application/xml","application/xml;charset=utf-8","text/xml","text/xml;charset=utf-8"],xmlSerializer:new n.Builder(this.options),serialize:function(e,t,r){"object"==typeof e&&(e=xmlSerializer.buildObject(e)),r(e)}},t)),e.add(Object.assign({name:"JSON",contentTypes:["application/json","application/json;charset=utf-8"],serialize:function(e,t,r){"object"==typeof e&&(e=JSON.stringify(e)),r(e)}},t)),e.add(Object.assign({name:"FORM-ENCODED",contentTypes:["application/x-www-form-urlencoded","multipart/form-data","text/plain"],encode:function(e,t){var r,n=[];for(r in e)if(e.hasOwnProperty(r)){var i=t?t+"["+r+"]":r,o=e[r];n.push(null!==o&&"object"==typeof o?serialize(o,i):encodeURIComponent(i)+"="+encodeURIComponent(o))}return n.join("&")},serialize:function(e,t,r){"object"==typeof e&&(e=this.encode(e)),r(e)}},t)),e.add({name:"DEFAULT",isDefault:!0,serialize:function(e,t,r){r(e.toString())}}),e}},5983(e,t,r){e.exports=function(e){function t(e){let r,i,o,s=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];r=o.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(6585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},6022(e){!function(){"use strict";var t=[,function(e,t){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===n(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var i=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=i,t.convertMapToObject=function(e){return Array.from(e).reduce((function(e,t){var n,i,o=(i=2,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}(n,i)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(n,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=o[0],a=o[1];return e[s]=a,e}),{})},t.isArguments=function(e){return null!=e&&i(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var o={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=o,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(o.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var r=Object.create(null),n=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},i=0;i<64;i++)r[n(i)]=i;var o=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],r=0;r<e;r++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},s={encode:function(e){if("string"==typeof e){var t=e;e=o(t.length);for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[r]=i}}for(var s=[],a=null,u=null,c=null,l=null,p=0;p<e.length;p++)switch(p%3){case 0:a=e[p]>>2&63,u=(3&e[p])<<4;break;case 1:u|=e[p]>>4&15,c=(15&e[p])<<2;break;case 2:c|=e[p]>>6&3,l=63&e[p],s.push(n(a)),s.push(n(u)),s.push(n(c)),s.push(n(l)),a=null,u=null,c=null,l=null}return null!=a&&(s.push(n(a)),s.push(n(u)),null==c?s.push("="):s.push(n(c)),null==l&&s.push("=")),s.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var n,i=o(t),s=null,a=null,u=null,c=0,l=0;l<e.length;l++){var p="="===(n=e.charAt(l))?-1:r[n];switch(l%4){case 0:if(p<0)throw new Error("invalid base64 string");s=p<<2;break;case 1:if(p<0)throw new Error("invalid base64 string");s|=p>>4,i[c++]=s,a=(15&p)<<4;break;case 2:p>=0&&(a|=p>>2,i[c++]=a,u=(3&p)<<6);break;case 3:p>=0&&(i[c++]=u|p)}}return i},newBinary:o};t.Base64=s},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function e(t,i,o,s,a){var u=i[t];switch(r(u)){case"string":return n(u);case"number":return isFinite(u)?String(u):"null";case"boolean":return String(u);case"object":if(!u)return"null";var c,l=s+o,p=[];if(Array.isArray(u)||{}.hasOwnProperty.call(u,"callee")){for(var h=u.length,d=0;d<h;d+=1)p[d]=e(d,u,o,l,a)||"null";return c=0===p.length?"[]":l?"[\n"+l+p.join(",\n"+l)+"\n"+s+"]":"["+p.join(",")+"]"}var f=Object.keys(u);return a&&(f=f.sort()),f.forEach((function(t){(c=e(t,u,o,l,a))&&p.push(n(t)+(l?": ":":")+c)})),c=0===p.length?"{}":l?"{\n"+l+p.join(",\n"+l)+"\n"+s+"}":"{"+p.join(",")+"}"}};t.default=function(e,t){var r=Object.assign({indent:"",canonical:!1},t);if(!0===r.indent)r.indent="  ";else if("number"==typeof r.indent){for(var n="",o=0;o<r.indent;o++)n+=" ";r.indent=n}return i("",{"":e},r.indent,"",r.canonical)},e.exports=t.default}],r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}var i={};!function(){var e=i,t=n(2).Base64,r=n(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var o=n(1),s={};e.EJSON=s;var a=new Map;s.addType=function(e,t){if(a.has(e))throw new Error("Type ".concat(e," already present"));a.set(e,t)};var u=[{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$date")&&1===(0,o.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$regexp")&&(0,o.hasOwn)(e,"$flags")&&2===(0,o.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$InfNaN")&&1===(0,o.lengthOf)(e)},matchObject:o.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$binary")&&1===(0,o.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,o.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$escape")&&1===(0,o.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var r=(0,o.lengthOf)(e);1!==r&&2!==r||(t=u.some((function(t){return t.matchJSONValue(e)})))}return t},toJSONValue:function(e){var t={};return(0,o.keysOf)(e).forEach((function(r){t[r]=s.toJSONValue(e[r])})),{$escape:t}},fromJSONValue:function(e){var t={};return(0,o.keysOf)(e.$escape).forEach((function(r){t[r]=s.fromJSONValue(e.$escape[r])})),t}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$type")&&(0,o.hasOwn)(e,"$value")&&2===(0,o.lengthOf)(e)},matchObject:function(e){return s._isCustomType(e)},toJSONValue:function(e){var t=r._noYieldsAllowed((function(){return e.toJSONValue()}));return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!a.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var n=a.get(t);return r._noYieldsAllowed((function(){return n(e.$value)}))}}];s._isCustomType=function(e){return e&&(0,o.isFunction)(e.toJSONValue)&&(0,o.isFunction)(e.typeName)&&a.has(e.typeName())},s._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?a:(0,o.convertMapToObject)(a)},s._getConverters=function(){return u};var c=function(e){for(var t=0;t<u.length;t++){var r=u[t];if(r.matchObject(e))return r.toJSONValue(e)}},l=function e(t){if(null===t)return null;var r=c(t);return void 0!==r?r:(0,o.isObject)(t)?((0,o.keysOf)(t).forEach((function(r){var n=t[r];if((0,o.isObject)(n)||void 0===n||(0,o.isInfOrNaN)(n)){var i=c(n);i?t[r]=i:e(n)}})),t):t};s._adjustTypesToJSONValue=l,s.toJSONValue=function(e){var t=c(e);if(void 0!==t)return t;var r=e;return(0,o.isObject)(e)&&(r=s.clone(e),l(r)),r};var p=function(e){if((0,o.isObject)(e)&&null!==e){var t=(0,o.keysOf)(e);if(t.length<=2&&t.every((function(e){return"string"==typeof e&&"$"===e.substr(0,1)})))for(var r=0;r<u.length;r++){var n=u[r];if(n.matchJSONValue(e))return n.fromJSONValue(e)}}return e},h=function e(t){if(null===t)return null;var r=p(t);return r!==t?r:(0,o.isObject)(t)?((0,o.keysOf)(t).forEach((function(r){var n=t[r];if((0,o.isObject)(n)){var i=p(n);if(n!==i)return void(t[r]=i);e(n)}})),t):t};s._adjustTypesFromJSONValue=h,s.fromJSONValue=function(e){var t=p(e);return t===e&&(0,o.isObject)(e)&&(t=s.clone(e),h(t)),t},s.stringify=(0,o.handleError)((function(e,t){var r=s.toJSONValue(e);return t&&(t.canonical||t.indent)?n(4)(r,t):JSON.stringify(r)})),s.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return s.fromJSONValue(JSON.parse(e))},s.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},s.equals=function(e,t,r){var n,i=!(!r||!r.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,o.isObject)(e)||!(0,o.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(s.isBinary(e)&&s.isBinary(t)){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}if((0,o.isFunction)(e.equals))return e.equals(t,r);if((0,o.isFunction)(t.equals))return t.equals(e,r);var a,u=Array.isArray(e),c=Array.isArray(t);if(u!==c)return!1;if(u&&c){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(!s.equals(e[n],t[n],r))return!1;return!0}switch(s._isCustomType(e)+s._isCustomType(t)){case 1:return!1;case 2:return s.equals(s.toJSONValue(e),s.toJSONValue(t))}var l=(0,o.keysOf)(e),p=(0,o.keysOf)(t);return i?(n=0,a=l.every((function(i){return!(n>=p.length||i!==p[n]||!s.equals(e[i],t[p[n]],r)||(n++,0))}))):(n=0,a=l.every((function(i){return!!(0,o.hasOwn)(t,i)&&!!s.equals(e[i],t[i],r)&&(n++,!0)}))),a&&n===p.length},s.clone=function(e){var t;if(!(0,o.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(s.isBinary(e)){t=s.newBinary(e.length);for(var r=0;r<e.length;r++)t[r]=e[r];return t}return Array.isArray(e)?e.map(s.clone):(0,o.isArguments)(e)?Array.from(e).map(s.clone):(0,o.isFunction)(e.clone)?e.clone():s._isCustomType(e)?s.fromJSONValue(s.clone(s.toJSONValue(e)),!0):(t={},(0,o.keysOf)(e).forEach((function(r){t[r]=s.clone(e[r])})),t)},s.newBinary=t.newBinary}(),e.exports=i.EJSON}()},6033(e,t,r){"use strict";var n=r(9637),i=r(9023);t.init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){return process.stderr.write(i.format.apply(i,arguments)+"\n")},t.formatArgs=function(r){var n=this.namespace;if(this.useColors){var i=this.color,o="[3"+(i<8?i:"8;5;"+i),s="  ".concat(o,";1m").concat(n," [0m");r[0]=s+r[0].split("\n").join("\n"+s),r.push(o+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var o=r(7687);o&&(o.stderr||o).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(736)(t);var s=e.exports.formatters;s.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},6132(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6160(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1635);n.__exportStar(r(8895),t),n.__exportStar(r(1118),t),n.__exportStar(r(6259),t)},6250(e,t,r){"use strict";const n=r(2017);n.code='require("ajv/dist/runtime/equal").default',t.A=n},6259(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const n=r(1635).__importDefault(r(7194)),i=r(228),o=r(1400);class s extends i.EventEmitter{#F;#L;#M;#w;#U=!1;#j;#r;get isDestroyed(){return this.#U}constructor(e,t,r){super(),this.#F=e,this.#L=t,this.#w={...r},this.#M=n.default.createSocket("udp4");try{this.#M.bind(this.#w.bind_port||0,this.#w.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#w.bind_ip||"0.0.0.0"}:${this.#w.bind_port||0}`)}void 0!==this.#w.ttl&&this.#M.setTTL(this.#w.ttl),void 0!==this.#w.multicast_ttl&&this.#M.setMulticastTTL(this.#w.multicast_ttl),this.#M.on("error",(e=>{this.#V(o.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this.#M.on("listening",(()=>{this.#w.broadcast&&this.#M.setBroadcast(!0),this.#w.multicast_interface&&this.#M.setMulticastInterface(this.#w.multicast_interface),this.#V(o.InstanceStatus.Ok),this.emit("listening")})),this.#M.on("message",((e,t)=>this.emit("data",e,t))),this.#r=setTimeout((()=>{this.#U||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#F}:${this.#L} is missing an error handler!`)}),5e3)}async send(e){if(this.#U)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise(((t,r)=>{this.#M.send(e,this.#L,this.#F,(e=>{e?r(e):t()}))}))}destroy(){this.#U=!0,void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this.#M.removeAllListeners(),this.#M.close(),this.removeAllListeners()}#V(e,t){this.#j!=e&&(this.#j=e,this.emit("status_change",e,t))}}t.UDPHelper=s},6278(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.substituteEscapeCharacters=t.parseEscapeCharacters=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const n=r(1635);n.__exportStar(r(9077),t),n.__exportStar(r(2018),t),n.__exportStar(r(4581),t),n.__exportStar(r(5158),t);var i=r(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return i.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return i.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return i.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return i.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return i.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return i.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return i.assertNever}}),Object.defineProperty(t,"parseEscapeCharacters",{enumerable:!0,get:function(){return i.parseEscapeCharacters}}),Object.defineProperty(t,"substituteEscapeCharacters",{enumerable:!0,get:function(){return i.substituteEscapeCharacters}}),n.__exportStar(r(6160),t);var o=r(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return o.runEntrypoint}})},6284(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={grad:.9,turn:360,rad:360/(2*Math.PI)},n=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},i=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},o=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},s=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},a=function(e){return{r:o(e.r,0,255),g:o(e.g,0,255),b:o(e.b,0,255),a:o(e.a)}},u=function(e){return{r:i(e.r),g:i(e.g),b:i(e.b),a:i(e.a,3)}},c=/^#([0-9a-f]{3,8})$/i,l=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},p=function(e){var t=e.r,r=e.g,n=e.b,i=e.a,o=Math.max(t,r,n),s=o-Math.min(t,r,n),a=s?o===t?(r-n)/s:o===r?2+(n-t)/s:4+(t-r)/s:0;return{h:60*(a<0?a+6:a),s:o?s/o*100:0,v:o/255*100,a:i}},h=function(e){var t=e.h,r=e.s,n=e.v,i=e.a;t=t/360*6,r/=100,n/=100;var o=Math.floor(t),s=n*(1-r),a=n*(1-(t-o)*r),u=n*(1-(1-t+o)*r),c=o%6;return{r:255*[n,a,s,s,u,n][c],g:255*[u,n,n,a,s,s][c],b:255*[s,s,u,n,n,a][c],a:i}},d=function(e){return{h:s(e.h),s:o(e.s,0,100),l:o(e.l,0,100),a:o(e.a)}},f=function(e){return{h:i(e.h),s:i(e.s),l:i(e.l),a:i(e.a,3)}},m=function(e){return h((r=(t=e).s,{h:t.h,s:(r*=((n=t.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:t.a}));var t,r,n},g=function(e){return{h:(t=p(e)).h,s:(i=(200-(r=t.s))*(n=t.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,r,n,i},y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,I={string:[[function(e){var t=c.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?i(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?i(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=v.exec(e)||w.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=y.exec(e)||b.exec(e);if(!t)return null;var n,i,o=d({h:(n=t[1],i=t[2],void 0===i&&(i="deg"),Number(n)*(r[i]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return m(o)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,i=e.b,o=e.a,s=void 0===o?1:o;return n(t)&&n(r)&&n(i)?a({r:Number(t),g:Number(r),b:Number(i),a:Number(s)}):null},"rgb"],[function(e){var t=e.h,r=e.s,i=e.l,o=e.a,s=void 0===o?1:o;if(!n(t)||!n(r)||!n(i))return null;var a=d({h:Number(t),s:Number(r),l:Number(i),a:Number(s)});return m(a)},"hsl"],[function(e){var t=e.h,r=e.s,i=e.v,a=e.a,u=void 0===a?1:a;if(!n(t)||!n(r)||!n(i))return null;var c=function(e){return{h:s(e.h),s:o(e.s,0,100),v:o(e.v,0,100),a:o(e.a)}}({h:Number(t),s:Number(r),v:Number(i),a:Number(u)});return h(c)},"hsv"]]},_=function(e,t){for(var r=0;r<t.length;r++){var n=t[r][0](e);if(n)return[n,t[r][1]]}return[null,void 0]},E=function(e){return"string"==typeof e?_(e.trim(),I.string):"object"==typeof e&&null!==e?_(e,I.object):[null,void 0]},O=function(e,t){var r=g(e);return{h:r.h,s:o(r.s+100*t,0,100),l:r.l,a:r.a}},S=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},C=function(e,t){var r=g(e);return{h:r.h,s:r.s,l:o(r.l+100*t,0,100),a:r.a}},T=function(){function e(e){this.parsed=E(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return i(S(this.rgba),2)},e.prototype.isDark=function(){return S(this.rgba)<.5},e.prototype.isLight=function(){return S(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=u(this.rgba)).r,r=e.g,n=e.b,s=(o=e.a)<1?l(i(255*o)):"","#"+l(t)+l(r)+l(n)+s;var e,t,r,n,o,s},e.prototype.toRgb=function(){return u(this.rgba)},e.prototype.toRgbString=function(){return t=(e=u(this.rgba)).r,r=e.g,n=e.b,(i=e.a)<1?"rgba("+t+", "+r+", "+n+", "+i+")":"rgb("+t+", "+r+", "+n+")";var e,t,r,n,i},e.prototype.toHsl=function(){return f(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=f(g(this.rgba))).h,r=e.s,n=e.l,(i=e.a)<1?"hsla("+t+", "+r+"%, "+n+"%, "+i+")":"hsl("+t+", "+r+"%, "+n+"%)";var e,t,r,n,i},e.prototype.toHsv=function(){return e=p(this.rgba),{h:i(e.h),s:i(e.s),v:i(e.v),a:i(e.a,3)};var e},e.prototype.invert=function(){return P({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),P(O(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),P(O(this.rgba,-e))},e.prototype.grayscale=function(){return P(O(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),P(C(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),P(C(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?P({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):i(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?P({h:e,s:t.s,l:t.l,a:t.a}):i(t.h)},e.prototype.isEqual=function(e){return this.toHex()===P(e).toHex()},e}(),P=function(e){return e instanceof T?e:new T(e)},N=[];t.Colord=T,t.colord=P,t.extend=function(e){e.forEach((function(e){N.indexOf(e)<0&&(e(T,I),N.push(e))}))},t.getFormat=function(e){return E(e)[1]},t.random=function(){return new T({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6286(e,t,r){(function(){var t,n,i,o={}.hasOwnProperty;i=r(9241).assign,t=r(1737),r(4130),r(6376),r(2691),r(2679),r(3906),r(1268),r(2535),r(5915),r(1218),r(4111),r(7696),r(5529),r(8012),n=r(8753),e.exports=function(){function e(e){var t,r,n;for(t in e||(e={}),this.options=e,r=e.writer||{})o.call(r,t)&&(n=r[t],this["_"+t]=this[t],this[t]=n)}return e.prototype.filterOptions=function(e){var t,r,o,s,a,u,c,l;return e||(e={}),e=i({},this.options,e),(t={writer:this}).pretty=e.pretty||!1,t.allowEmpty=e.allowEmpty||!1,t.indent=null!=(r=e.indent)?r:"  ",t.newline=null!=(o=e.newline)?o:"\n",t.offset=null!=(s=e.offset)?s:0,t.dontPrettyTextNodes=null!=(a=null!=(u=e.dontPrettyTextNodes)?u:e.dontprettytextnodes)?a:0,t.spaceBeforeSlash=null!=(c=null!=(l=e.spaceBeforeSlash)?l:e.spacebeforeslash)?c:"",!0===t.spaceBeforeSlash&&(t.spaceBeforeSlash=" "),t.suppressPrettyCount=0,t.user={},t.state=n.None,t},e.prototype.indent=function(e,t,r){var n;return!t.pretty||t.suppressPrettyCount?"":t.pretty&&(n=(r||0)+t.offset+1)>0?new Array(n).join(t.indent):""},e.prototype.endline=function(e,t,r){return!t.pretty||t.suppressPrettyCount?"":t.newline},e.prototype.attribute=function(e,t,r){var n;return this.openAttribute(e,t,r),n=" "+e.name+'="'+e.value+'"',this.closeAttribute(e,t,r),n},e.prototype.cdata=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<![CDATA[",t.state=n.InsideTag,i+=e.value,t.state=n.CloseTag,i+="]]>"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.comment=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"\x3c!-- ",t.state=n.InsideTag,i+=e.value,t.state=n.CloseTag,i+=" --\x3e"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.declaration=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<?xml",t.state=n.InsideTag,i+=' version="'+e.version+'"',null!=e.encoding&&(i+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(i+=' standalone="'+e.standalone+'"'),t.state=n.CloseTag,i+=t.spaceBeforeSlash+"?>",i+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.docType=function(e,t,r){var i,o,s,a,u;if(r||(r=0),this.openNode(e,t,r),t.state=n.OpenTag,a=this.indent(e,t,r),a+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?a+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(a+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(a+=" [",a+=this.endline(e,t,r),t.state=n.InsideTag,o=0,s=(u=e.children).length;o<s;o++)i=u[o],a+=this.writeChildNode(i,t,r+1);t.state=n.CloseTag,a+="]"}return t.state=n.CloseTag,a+=t.spaceBeforeSlash+">",a+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),a},e.prototype.element=function(e,r,i){var s,a,u,c,l,p,h,d,f,m,g,y,b,v;for(f in i||(i=0),m=!1,g="",this.openNode(e,r,i),r.state=n.OpenTag,g+=this.indent(e,r,i)+"<"+e.name,y=e.attribs)o.call(y,f)&&(s=y[f],g+=this.attribute(s,r,i));if(c=0===(u=e.children.length)?null:e.children[0],0===u||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))r.allowEmpty?(g+=">",r.state=n.CloseTag,g+="</"+e.name+">"+this.endline(e,r,i)):(r.state=n.CloseTag,g+=r.spaceBeforeSlash+"/>"+this.endline(e,r,i));else if(!r.pretty||1!==u||c.type!==t.Text&&c.type!==t.Raw||null==c.value){if(r.dontPrettyTextNodes)for(l=0,h=(b=e.children).length;l<h;l++)if(((a=b[l]).type===t.Text||a.type===t.Raw)&&null!=a.value){r.suppressPrettyCount++,m=!0;break}for(g+=">"+this.endline(e,r,i),r.state=n.InsideTag,p=0,d=(v=e.children).length;p<d;p++)a=v[p],g+=this.writeChildNode(a,r,i+1);r.state=n.CloseTag,g+=this.indent(e,r,i)+"</"+e.name+">",m&&r.suppressPrettyCount--,g+=this.endline(e,r,i),r.state=n.None}else g+=">",r.state=n.InsideTag,r.suppressPrettyCount++,m=!0,g+=this.writeChildNode(c,r,i+1),r.suppressPrettyCount--,m=!1,r.state=n.CloseTag,g+="</"+e.name+">"+this.endline(e,r,i);return this.closeNode(e,r,i),g},e.prototype.writeChildNode=function(e,r,n){switch(e.type){case t.CData:return this.cdata(e,r,n);case t.Comment:return this.comment(e,r,n);case t.Element:return this.element(e,r,n);case t.Raw:return this.raw(e,r,n);case t.Text:return this.text(e,r,n);case t.ProcessingInstruction:return this.processingInstruction(e,r,n);case t.Dummy:return"";case t.Declaration:return this.declaration(e,r,n);case t.DocType:return this.docType(e,r,n);case t.AttributeDeclaration:return this.dtdAttList(e,r,n);case t.ElementDeclaration:return this.dtdElement(e,r,n);case t.EntityDeclaration:return this.dtdEntity(e,r,n);case t.NotationDeclaration:return this.dtdNotation(e,r,n);default:throw new Error("Unknown XML node type: "+e.constructor.name)}},e.prototype.processingInstruction=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<?",t.state=n.InsideTag,i+=e.target,e.value&&(i+=" "+e.value),t.state=n.CloseTag,i+=t.spaceBeforeSlash+"?>",i+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.raw=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r),t.state=n.InsideTag,i+=e.value,t.state=n.CloseTag,i+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.text=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r),t.state=n.InsideTag,i+=e.value,t.state=n.CloseTag,i+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.dtdAttList=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<!ATTLIST",t.state=n.InsideTag,i+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(i+=" "+e.defaultValueType),e.defaultValue&&(i+=' "'+e.defaultValue+'"'),t.state=n.CloseTag,i+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.dtdElement=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<!ELEMENT",t.state=n.InsideTag,i+=" "+e.name+" "+e.value,t.state=n.CloseTag,i+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.dtdEntity=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<!ENTITY",t.state=n.InsideTag,e.pe&&(i+=" %"),i+=" "+e.name,e.value?i+=' "'+e.value+'"':(e.pubID&&e.sysID?i+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(i+=' SYSTEM "'+e.sysID+'"'),e.nData&&(i+=" NDATA "+e.nData)),t.state=n.CloseTag,i+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.dtdNotation=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<!NOTATION",t.state=n.InsideTag,i+=" "+e.name,e.pubID&&e.sysID?i+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?i+=' PUBLIC "'+e.pubID+'"':e.sysID&&(i+=' SYSTEM "'+e.sysID+'"'),t.state=n.CloseTag,i+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.openNode=function(e,t,r){},e.prototype.closeNode=function(e,t,r){},e.prototype.openAttribute=function(e,t,r){},e.prototype.closeAttribute=function(e,t,r){},e}()}).call(this)},6368(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||e,s),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var u,c,l=this._events[a],p=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),p){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,s),!0}for(c=1,u=new Array(p-1);c<p;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),p){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,i);break;default:if(!u)for(h=1,u=new Array(p-1);h<p;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==t||i&&!a[u].once||n&&a[u].context!==n)&&c.push(a[u]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},6376(e,t,r){(function(){var t,n,i,o,s,a,u,c,l={}.hasOwnProperty;c=r(9241).isObject,u=r(468),t=r(1737),n=r(4111),o=r(5529),i=r(7696),s=r(8012),a=r(4797),e.exports=function(e){function r(e,n,i){var o,s,a,u,l,p;if(r.__super__.constructor.call(this,e),this.type=t.DocType,e.children)for(s=0,a=(u=e.children).length;s<a;s++)if((o=u[s]).type===t.Element){this.name=o.name;break}this.documentObject=e,c(n)&&(n=(l=n).pubID,i=l.sysID),null==i&&(i=(p=[n,i])[0],n=p[1]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=i&&(this.sysID=this.stringify.dtdSysID(i))}return function(e,t){for(var r in t)l.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"entities",{get:function(){var e,r,n,i,o;for(i={},r=0,n=(o=this.children).length;r<n;r++)(e=o[r]).type!==t.EntityDeclaration||e.pe||(i[e.name]=e);return new a(i)}}),Object.defineProperty(r.prototype,"notations",{get:function(){var e,r,n,i,o;for(i={},r=0,n=(o=this.children).length;r<n;r++)(e=o[r]).type===t.NotationDeclaration&&(i[e.name]=e);return new a(i)}}),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),r.prototype.element=function(e,t){var r;return r=new i(this,e,t),this.children.push(r),this},r.prototype.attList=function(e,t,r,i,o){var s;return s=new n(this,e,t,r,i,o),this.children.push(s),this},r.prototype.entity=function(e,t){var r;return r=new o(this,!1,e,t),this.children.push(r),this},r.prototype.pEntity=function(e,t){var r;return r=new o(this,!0,e,t),this.children.push(r),this},r.prototype.notation=function(e,t){var r;return r=new s(this,e,t),this.children.push(r),this},r.prototype.toString=function(e){return this.options.writer.docType(this,this.options.writer.filterOptions(e))},r.prototype.ele=function(e,t){return this.element(e,t)},r.prototype.att=function(e,t,r,n,i){return this.attList(e,t,r,n,i)},r.prototype.ent=function(e,t){return this.entity(e,t)},r.prototype.pent=function(e,t){return this.pEntity(e,t)},r.prototype.not=function(e,t){return this.notation(e,t)},r.prototype.up=function(){return this.root()||this.documentObject},r.prototype.isEqualNode=function(e){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.name===this.name&&e.publicId===this.publicId&&e.systemId===this.systemId},r}(u)}).call(this)},6465(e,t){(function(){t.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},6585(e){var t=1e3,r=60*t,n=60*r,i=24*n,o=7*i;function s(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,a){a=a||{};var u,c,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(s){var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*o;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(u=e,(c=Math.abs(u))>=i?s(u,c,i,"day"):c>=n?s(u,c,n,"hour"):c>=r?s(u,c,r,"minute"):c>=t?s(u,c,t,"second"):u+" ms"):function(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=n?Math.round(e/n)+"h":o>=r?Math.round(e/r)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6679(e){e.exports={InvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}},6684(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.nodes.length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.item=function(e){return this.nodes[e]||null},e}()}).call(this)},6712(e,t,r){(function(){"use strict";var e,n,i,o,s,a={}.hasOwnProperty;e=r(9665),n=r(6465).defaults,o=function(e){return"string"==typeof e&&(e.indexOf("&")>=0||e.indexOf(">")>=0||e.indexOf("<")>=0)},s=function(e){return"<![CDATA["+i(e)+"]]>"},i=function(e){return e.replace("]]>","]]]]><![CDATA[>")},t.Builder=function(){function t(e){var t,r,i;for(t in this.options={},r=n[.2])a.call(r,t)&&(i=r[t],this.options[t]=i);for(t in e)a.call(e,t)&&(i=e[t],this.options[t]=i)}return t.prototype.buildObject=function(t){var r,i,u,c,l,p;return r=this.options.attrkey,i=this.options.charkey,1===Object.keys(t).length&&this.options.rootName===n[.2].rootName?t=t[l=Object.keys(t)[0]]:l=this.options.rootName,p=this,u=function(e,t){var n,c,l,h,d,f;if("object"!=typeof t)p.options.cdata&&o(t)?e.raw(s(t)):e.txt(t);else if(Array.isArray(t)){for(h in t)if(a.call(t,h))for(d in c=t[h])l=c[d],e=u(e.ele(d),l).up()}else for(d in t)if(a.call(t,d))if(c=t[d],d===r){if("object"==typeof c)for(n in c)f=c[n],e=e.att(n,f)}else if(d===i)e=p.options.cdata&&o(c)?e.raw(s(c)):e.txt(c);else if(Array.isArray(c))for(h in c)a.call(c,h)&&(e="string"==typeof(l=c[h])?p.options.cdata&&o(l)?e.ele(d).raw(s(l)).up():e.ele(d,l).up():u(e.ele(d),l).up());else"object"==typeof c?e=u(e.ele(d),c).up():"string"==typeof c&&p.options.cdata&&o(c)?e=e.ele(d).raw(s(c)).up():(null==c&&(c=""),e=e.ele(d,c.toString()).up());return e},c=e.create(l,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),u(c,t).end(this.options.renderOpts)},t}()}).call(this)},6775(e,t,r){(function(){var t,n,i,o={}.hasOwnProperty;t=r(1737),i=r(6286),n=r(8753),e.exports=function(e){function r(e,t){this.stream=e,r.__super__.constructor.call(this,t)}return function(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.endline=function(e,t,i){return e.isLastRootNode&&t.state===n.CloseTag?"":r.__super__.endline.call(this,e,t,i)},r.prototype.document=function(e,t){var r,n,i,o,s,a,u,c,l;for(n=i=0,s=(u=e.children).length;i<s;n=++i)(r=u[n]).isLastRootNode=n===e.children.length-1;for(t=this.filterOptions(t),l=[],o=0,a=(c=e.children).length;o<a;o++)r=c[o],l.push(this.writeChildNode(r,t,0));return l},r.prototype.attribute=function(e,t,n){return this.stream.write(r.__super__.attribute.call(this,e,t,n))},r.prototype.cdata=function(e,t,n){return this.stream.write(r.__super__.cdata.call(this,e,t,n))},r.prototype.comment=function(e,t,n){return this.stream.write(r.__super__.comment.call(this,e,t,n))},r.prototype.declaration=function(e,t,n){return this.stream.write(r.__super__.declaration.call(this,e,t,n))},r.prototype.docType=function(e,t,r){var i,o,s,a;if(r||(r=0),this.openNode(e,t,r),t.state=n.OpenTag,this.stream.write(this.indent(e,t,r)),this.stream.write("<!DOCTYPE "+e.root().name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(e,t,r)),t.state=n.InsideTag,o=0,s=(a=e.children).length;o<s;o++)i=a[o],this.writeChildNode(i,t,r+1);t.state=n.CloseTag,this.stream.write("]")}return t.state=n.CloseTag,this.stream.write(t.spaceBeforeSlash+">"),this.stream.write(this.endline(e,t,r)),t.state=n.None,this.closeNode(e,t,r)},r.prototype.element=function(e,r,i){var s,a,u,c,l,p,h,d,f;for(h in i||(i=0),this.openNode(e,r,i),r.state=n.OpenTag,this.stream.write(this.indent(e,r,i)+"<"+e.name),d=e.attribs)o.call(d,h)&&(s=d[h],this.attribute(s,r,i));if(c=0===(u=e.children.length)?null:e.children[0],0===u||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))r.allowEmpty?(this.stream.write(">"),r.state=n.CloseTag,this.stream.write("</"+e.name+">")):(r.state=n.CloseTag,this.stream.write(r.spaceBeforeSlash+"/>"));else if(!r.pretty||1!==u||c.type!==t.Text&&c.type!==t.Raw||null==c.value){for(this.stream.write(">"+this.endline(e,r,i)),r.state=n.InsideTag,l=0,p=(f=e.children).length;l<p;l++)a=f[l],this.writeChildNode(a,r,i+1);r.state=n.CloseTag,this.stream.write(this.indent(e,r,i)+"</"+e.name+">")}else this.stream.write(">"),r.state=n.InsideTag,r.suppressPrettyCount++,this.writeChildNode(c,r,i+1),r.suppressPrettyCount--,r.state=n.CloseTag,this.stream.write("</"+e.name+">");return this.stream.write(this.endline(e,r,i)),r.state=n.None,this.closeNode(e,r,i)},r.prototype.processingInstruction=function(e,t,n){return this.stream.write(r.__super__.processingInstruction.call(this,e,t,n))},r.prototype.raw=function(e,t,n){return this.stream.write(r.__super__.raw.call(this,e,t,n))},r.prototype.text=function(e,t,n){return this.stream.write(r.__super__.text.call(this,e,t,n))},r.prototype.dtdAttList=function(e,t,n){return this.stream.write(r.__super__.dtdAttList.call(this,e,t,n))},r.prototype.dtdElement=function(e,t,n){return this.stream.write(r.__super__.dtdElement.call(this,e,t,n))},r.prototype.dtdEntity=function(e,t,n){return this.stream.write(r.__super__.dtdEntity.call(this,e,t,n))},r.prototype.dtdNotation=function(e,t,n){return this.stream.write(r.__super__.dtdNotation.call(this,e,t,n))},r}(i)}).call(this)},6928(e){"use strict";e.exports=require("path")},6982(e){"use strict";e.exports=require("crypto")},7e3(e,t,r){"use strict";const n=r(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:r=0,maxWait:i=0,before:o=!1,after:s=!0}=t;if(!o&&!s)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let a,u,c;const l=function(...t){const n=this,l=o&&!a;return clearTimeout(a),a=setTimeout((()=>{a=void 0,u&&(clearTimeout(u),u=void 0),s&&(c=e.apply(n,t))}),r),i>0&&!u&&s&&(u=setTimeout((()=>{u=void 0,a&&(clearTimeout(a),a=void 0),c=e.apply(n,t)}),i)),l&&(c=e.apply(n,t)),c};return n(l,e),l.cancel=()=>{a&&(clearTimeout(a),a=void 0),u&&(clearTimeout(u),u=void 0)},l}},7016(e){"use strict";e.exports=require("url")},7194(e){"use strict";e.exports=require("dgram")},7260(e){(function(){e.exports=function(){function e(){}return e.prototype.hasFeature=function(e,t){return!0},e.prototype.createDocumentType=function(e,t,r){throw new Error("This DOM method is not implemented.")},e.prototype.createDocument=function(e,t,r){throw new Error("This DOM method is not implemented.")},e.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},7281(e,t,r){"use strict";e.exports=a,e.exports.default=a;const n={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},isPrerelease:{type:"boolean",description:"Is this a pre-release version"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"},url:{type:"string"}},required:["name"],additionalProperties:!1}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18 or node22",enum:["node18","node22"]},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"},permissions:{type:"object",description:"Permissions required by the module. This is used to inform the user of the permissions required by the module.\nNote: this requires the node22 or newer runtime",properties:{"worker-threads":{type:"boolean",description:"Enable if the module uses worker threads"},"child-process":{type:"boolean",description:"Enable if the module uses child processes"},"native-addons":{type:"boolean",description:"Enable if the module uses native addons"},filesystem:{type:"boolean",description:"Enable if the module requires read/write access to the filesystem"}},additionalProperties:!1}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}}}},required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]}}},i={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]},o=r(6250).A,s=new RegExp("","u");function a(e,{instancePath:t="",parentData:r,parentDataProperty:u,rootData:c=e}={}){let l=null,p=0;if(0===p){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.id&&(r="id")||void 0===e.name&&(r="name")||void 0===e.shortname&&(r="shortname")||void 0===e.description&&(r="description")||void 0===e.version&&(r="version")||void 0===e.license&&(r="license")||void 0===e.repository&&(r="repository")||void 0===e.bugs&&(r="bugs")||void 0===e.maintainers&&(r="maintainers")||void 0===e.legacyIds&&(r="legacyIds")||void 0===e.runtime&&(r="runtime")||void 0===e.manufacturer&&(r="manufacturer")||void 0===e.products&&(r="products")||void 0===e.keywords&&(r="keywords"))return a.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;if(void 0!==e.$schema){const r=p;if("string"!=typeof e.$schema)return a.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var h=r===p}else h=!0;if(h){if(void 0!==e.id){const r=p;if("string"!=typeof e.id)return a.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.name){const r=p;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.shortname){const r=p;if("string"!=typeof e.shortname)return a.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.description){const r=p;if("string"!=typeof e.description)return a.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.version){const r=p;if("string"!=typeof e.version)return a.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.isPrerelease){const r=p;if("boolean"!=typeof e.isPrerelease)return a.errors=[{instancePath:t+"/isPrerelease",schemaPath:"#/properties/isPrerelease/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.license){const r=p;if("string"!=typeof e.license)return a.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.repository){const r=p;if("string"!=typeof e.repository)return a.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.bugs){const r=p;if("string"!=typeof e.bugs)return a.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.maintainers){let r=e.maintainers;const n=p;if(p===n){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var d=!0;const e=r.length;for(let n=0;n<e;n++){let e=r[n];const i=p;if(p===i){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/maintainers/"+n,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.name&&(r="name"))return a.errors=[{instancePath:t+"/maintainers/"+n,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;{const r=p;for(const r in e)if("name"!==r&&"email"!==r&&"github"!==r&&"url"!==r)return a.errors=[{instancePath:t+"/maintainers/"+n,schemaPath:"#/properties/maintainers/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===p){if(void 0!==e.name){const r=p;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/maintainers/"+n+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=r===p}else f=!0;if(f){if(void 0!==e.email){const r=p;if("string"!=typeof e.email)return a.errors=[{instancePath:t+"/maintainers/"+n+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===p}else f=!0;if(f){if(void 0!==e.github){const r=p;if("string"!=typeof e.github)return a.errors=[{instancePath:t+"/maintainers/"+n+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===p}else f=!0;if(f)if(void 0!==e.url){const r=p;if("string"!=typeof e.url)return a.errors=[{instancePath:t+"/maintainers/"+n+"/url",schemaPath:"#/properties/maintainers/items/properties/url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===p}else f=!0}}}}}}if(!(d=i===p))break}if(d){let e,n=r.length;if(n>1)for(;n--;)for(e=n;e--;)if(o(r[n],r[e]))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1}}}h=n===p}else h=!0;if(h){if(void 0!==e.legacyIds){let r=e.legacyIds;const n=p;if(p===n){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var m=!0;const e=r.length;for(let n=0;n<e;n++){const e=p;if("string"!=typeof r[n])return a.errors=[{instancePath:t+"/legacyIds/"+n,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(m=e===p))break}if(m){let e,n=r.length;if(n>1){const i={};for(;n--;){let o=r[n];if("string"==typeof o){if("number"==typeof i[o])return e=i[o],a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;i[o]=n}}}}}}h=n===p}else h=!0;if(h){if(void 0!==e.runtime){let r=e.runtime;const i=p;if(p===i){if(!r||"object"!=typeof r||Array.isArray(r))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===r.type&&(e="type")||void 0===r.api&&(e="api")||void 0===r.apiVersion&&(e="apiVersion")||void 0===r.entrypoint&&(e="entrypoint"))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==r.type){let e=r.type;const i=p;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("node18"!==e&&"node22"!==e)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/enum",keyword:"enum",params:{allowedValues:n.properties.runtime.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var g=i===p}else g=!0;if(g){if(void 0!==r.api){let e=r.api;const i=p;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:n.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;g=i===p}else g=!0;if(g){if(void 0!==r.apiVersion){const e=p;if("string"!=typeof r.apiVersion)return a.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===p}else g=!0;if(g){if(void 0!==r.entrypoint){const e=p;if("string"!=typeof r.entrypoint)return a.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===p}else g=!0;if(g)if(void 0!==r.permissions){let e=r.permissions;const n=p;if(p===n){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const r=p;for(const r in e)if("worker-threads"!==r&&"child-process"!==r&&"native-addons"!==r&&"filesystem"!==r)return a.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===p){if(void 0!==e["worker-threads"]){const r=p;if("boolean"!=typeof e["worker-threads"])return a.errors=[{instancePath:t+"/runtime/permissions/worker-threads",schemaPath:"#/properties/runtime/properties/permissions/properties/worker-threads/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var y=r===p}else y=!0;if(y){if(void 0!==e["child-process"]){const r=p;if("boolean"!=typeof e["child-process"])return a.errors=[{instancePath:t+"/runtime/permissions/child-process",schemaPath:"#/properties/runtime/properties/permissions/properties/child-process/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;y=r===p}else y=!0;if(y){if(void 0!==e["native-addons"]){const r=p;if("boolean"!=typeof e["native-addons"])return a.errors=[{instancePath:t+"/runtime/permissions/native-addons",schemaPath:"#/properties/runtime/properties/permissions/properties/native-addons/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;y=r===p}else y=!0;if(y)if(void 0!==e.filesystem){const r=p;if("boolean"!=typeof e.filesystem)return a.errors=[{instancePath:t+"/runtime/permissions/filesystem",schemaPath:"#/properties/runtime/properties/permissions/properties/filesystem/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;y=r===p}else y=!0}}}}}g=n===p}else g=!0}}}}}h=i===p}else h=!0;if(h){if(void 0!==e.manufacturer){const r=p;if("string"!=typeof e.manufacturer)return a.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=r===p}else h=!0;if(h){if(void 0!==e.products){let r=e.products;const n=p;if(p===n){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(r.length<1)return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var b=!0;const e=r.length;for(let n=0;n<e;n++){const e=p;if("string"!=typeof r[n])return a.errors=[{instancePath:t+"/products/"+n,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(b=e===p))break}if(b){let e,n=r.length;if(n>1){const i={};for(;n--;){let o=r[n];if("string"==typeof o){if("number"==typeof i[o])return e=i[o],a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;i[o]=n}}}}}}h=n===p}else h=!0;if(h){if(void 0!==e.keywords){let r=e.keywords;const n=p;if(p===n){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var v=!0;const e=r.length;for(let n=0;n<e;n++){const e=p;if("string"!=typeof r[n])return a.errors=[{instancePath:t+"/keywords/"+n,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(v=e===p))break}if(v){let e,n=r.length;if(n>1){const i={};for(;n--;){let o=r[n];if("string"==typeof o){if("number"==typeof i[o])return e=i[o],a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i:n,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+n+" are identical)"}],!1;i[o]=n}}}}}}h=n===p}else h=!0;if(h)if(void 0!==e.bonjourQueries){let r=e.bonjourQueries;const n=p;if(p===n){if(!r||"object"!=typeof r||Array.isArray(r))return a.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(const e in r)if(s.test(e)){let n=r[e];const o=p,u=p;let c=!1,h=null;const d=p;if(p==p)if(n&&"object"==typeof n&&!Array.isArray(n)){let r;if(void 0===n.type&&(r="type")||void 0===n.protocol&&(r="protocol")){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===l?l=[n]:l.push(n),p++}else{if(void 0!==n.type){const r=p;if("string"!=typeof n.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),p++}var w=r===p}else w=!0;if(w){if(void 0!==n.protocol){let r=n.protocol;const o=p;if("string"!=typeof r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),p++}if("tcp"!==r&&"udp"!==r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===l?l=[r]:l.push(r),p++}w=o===p}else w=!0;if(w){if(void 0!==n.port){let r=n.port;const i=p;if("number"!=typeof r||!isFinite(r)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===l?l=[r]:l.push(r),p++}w=i===p}else w=!0;if(w)if(void 0!==n.txt){let r=n.txt;const i=p;if(p===i)if(r&&"object"==typeof r&&!Array.isArray(r)){for(const n in r)if(s.test(n)){const i=p;if("string"!=typeof r[n]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+n.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),p++}if(i!==p)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),p++}w=i===p}else w=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),p++}d===p&&(c=!0,h=0);const f=p;if(p===f)if(Array.isArray(n)){const r=n.length;for(let o=0;o<r;o++){let r=n[o];const a=p;if(p==p)if(r&&"object"==typeof r&&!Array.isArray(r)){let n;if(void 0===r.type&&(n="type")||void 0===r.protocol&&(n="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"};null===l?l=[r]:l.push(r),p++}else{if(void 0!==r.type){const n=p;if("string"!=typeof r.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),p++}var I=n===p}else I=!0;if(I){if(void 0!==r.protocol){let n=r.protocol;const s=p;if("string"!=typeof n){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),p++}if("tcp"!==n&&"udp"!==n){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===l?l=[r]:l.push(r),p++}I=s===p}else I=!0;if(I){if(void 0!==r.port){let n=r.port;const i=p;if("number"!=typeof n||!isFinite(n)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===l?l=[r]:l.push(r),p++}I=i===p}else I=!0;if(I)if(void 0!==r.txt){let n=r.txt;const i=p;if(p===i)if(n&&"object"==typeof n&&!Array.isArray(n)){for(const r in n)if(s.test(r)){const i=p;if("string"!=typeof n[r]){const n={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[n]:l.push(n),p++}if(i!==p)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),p++}I=i===p}else I=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),p++}if(a!==p)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===l?l=[r]:l.push(r),p++}var _;if((_=f===p)&&c?(c=!1,h=[h,1]):_&&(c=!0,h=1),!c){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:h},message:"must match exactly one schema in oneOf"};return null===l?l=[r]:l.push(r),p++,a.errors=l,!1}if(p=u,null!==l&&(u?l.length=u:l=null),o!==p)break}}h=n===p}else h=!0}}}}}}}}}}}}}}}}}return a.errors=l,0===p}},7386(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7413(e,t,r){const{InstanceStatus:n,TCPHelper:i}=r(6278);e.exports={initCompanionSatellite(){let e=this;try{void 0!==e.SOCKET_COMPANION&&(e.SOCKET_COMPANION.destroy(),delete e.SOCKET_COMPANION),void 0===e.config.host_companion&&(e.config.host_companion="127.0.0.1"),void 0===e.config.port_companion&&(e.config.port_companion=16622)}catch(t){e.log("error","Error initializing Companion Satellite API: "+t.toString())}if(void 0!==e.config.host_companion)try{e.log("info",`Opening Connection to Companion Satellite API: ${e.config.host_companion}:${e.config.port_companion}`),e.SOCKET_COMPANION=new i(e.config.host_companion,e.config.port_companion),e.receiveBuffer="",e.SOCKET_COMPANION.on("error",(t=>{e.log("error","Network error with Companion Satellite API: "+t.message),setTimeout((()=>{e.initCompanionSatellite()}),1e4)})),e.SOCKET_COMPANION.on("connect",(()=>{e.log("info","Connected to Companion Satellite API")})),e.SOCKET_COMPANION.on("data",(function(t){let r;for(e.receiveBuffer+=t.toString();-1!==(r=e.receiveBuffer.indexOf("\n"));){const t=e.receiveBuffer.slice(0,r).trim();e.receiveBuffer=e.receiveBuffer.slice(r+1);try{e.processCompanionData(t)}catch(e){console.error(e)}}}))}catch(t){e.log("error","Error initializing Companion Satellite API: "+t.toString())}},CompanionSatellite_Close(){let e=this;try{void 0!==e.SOCKET_COMPANION&&(e.sendCompanionSatelliteCommand(`REMOVE-DEVICE DEVICEID=${this.DEVICE_ID}`),e.sendCompanionSatelliteCommand("QUIT"),e.SOCKET_COMPANION.destroy(),delete e.SOCKET_COMPANION)}catch(t){e.log("error","Error closing Companion Satellite API: "+t.toString())}},processCompanionData(e){let t=this;try{let r=String(e).trim().split("\n");for(let e=0;e<r.length;e++){let n=r[e].split(" "),i=n[0];if("BEGIN"!=i)if("ADD-DEVICE"!=i)if("BRIGHTNESS"!=i)if("KEY-STATE"!=i);else{let e={number:0,type:"BUTTON",color:"",text:"",pressed:!1};const r=n.slice(1).reduce(((e,t)=>{const r=t.indexOf("=");if(-1===r)return e;const n=t.slice(0,r);let i=t.slice(r+1);return i.startsWith('"')&&i.endsWith('"')&&(i=i.slice(1,-1)),/^-?\d+$/.test(i)&&(i=Number(i)),e[n]=i,e}),{});console.log(r);let i=r.KEY;switch(e.number=1+i,e.type=r.TYPE,e.color=r.COLOR,e.text=Buffer.from(r.TEXT,"base64").toString("utf-8"),e.type){case"BUTTON":default:break;case"PAGEUP":"usp3"==t.config.model?(e.text="~UPARROW~",e.color="#00FF00"):(e.text=" ^",e.color="#00FF00");break;case"PAGEDOWN":"usp3"==t.config.model?(e.text="~DNARROW~",e.color="#00FF00"):(e.text=" v",e.color="#00FF00");break;case"PAGENUM":e.text="Pg "+e.text,e.color="#00FF00",e.fontSize=0}e.pressed="true"==n[7].replace("PRESSED=","");let o=t.getClosestUSPColor(e.color);if(o&&o.id?e.uspColor=o.id:(e.uspColor="00",o=t.COLORS[0]),t.DATA.brightness<=50){let r=t.COLORS.find((e=>e.label==o.label+"_DIM"));r&&(e.uspColor=r.id)}if("usp3"==t.config.model){let r=parseInt(e.uspColor);switch(r){case 0:0!==t.config.advanced_usp_panel_default_dark_color&&(e.uspColor=t.config.advanced_usp_panel_default_dark_color);break;case 1:case 2:case 3:case 10:case 11:case 12:case 38:case 20:case 32:case 26:case 41:case 23:case 35:case 29:e.uspColor=r;break;default:e.uspColor=t.config.advanced_usp_panel_default_unsupported_color}}else if("usp_legacy"==t.config.model){let r=parseInt(e.uspColor);switch(r){case 0:0!==t.config.advanced_usp_panel_default_dark_color&&(e.uspColorLegacy=t.config.advanced_usp_panel_default_dark_color);break;case 1:case 2:case 3:case 10:case 11:case 12:e.uspColorLegacy=r;break;default:e.uspColorLegacy=t.config.advanced_usp_panel_default_unsupported_color}}let s=e.text;s.length>0?(s.includes("\\n")&&(s=s.split("\\n").join(" ")),s.includes("_")&&(s=s.split("_").join(" "))):s="  ",e.text=s,void 0===t.config.font_size&&(t.config.font_size=0);let a=t.config.font_size;null==e.fontSize&&("auto"==a&&(a=s.length<4?2:s.length<8?1:0),e.fontSize=a),e.uspColor=String(e.uspColor).padStart(2,"0"),"usp3"==t.config.model?(e.number<=16&&(t.sendUSPCommand(`COL_${String(e.number).padStart(2,"0")}:${e.uspColor}`),t.sendUSPCommand(`TXT_${String(e.number).padStart(2,"0")}:${a}_${s}`)),t.updateInternalKey(e)):"usp_legacy"==t.config.model&&t.updateLegacyKeys(e)}else t.DATA.brightness=n[2].replace("VALUE=","");else"OK"==n[1]?(t.DATA.satelliteConnected=!0,t.checkVariables(),t.startCompanionSatellitePing()):(t.log("error","Error adding device to Companion Satellite API: "+n[1]),t.DATA.satelliteConnected=!1,t.checkVariables());else{let e="";e="usp3"==t.config.model?"TSL Products USP3":"usp_legacy"==t.config.model?"DNF Controls USP":"Unknown USP Type",t.sendCompanionSatelliteCommand(`ADD-DEVICE DEVICEID=${t.DEVICE_ID} PRODUCT_NAME="${e}" BITMAPS=false COLORS=true TEXT=true`)}}}catch(e){t.log("error","Error processing Companion Satellite API data: "+e.toString()),console.log(e)}},updateInternalKey(e){let t=this;t.config.verbose&&t.log("debug",`Updating key ${e.number}: ${e.text} ${e.color} pressed: ${e.pressed}`);for(let r=0;r<t.DATA.keys.length;r++)if(t.DATA.keys[r].number==e.number){t.DATA.keys[r]=e;break}t.DATA.keys.push(e)},startCompanionSatellitePing(){let e=this;e.COMPANION_PING_INTERVAL=setInterval((function(){e.sendCompanionSatelliteCommand("PING")}),100)},sendCompanionSatelliteCommand(e){let t=this;try{void 0!==t.SOCKET_COMPANION&&t.SOCKET_COMPANION.isConnected&&(t.config.verbose&&"PING"!==e&&t.log("debug","Sending Companion Satellite API Command: "+e),t.SOCKET_COMPANION.send(e+"\n"))}catch(e){t.log("error","Error sending Companion Satellite API Command: "+e.toString())}}}},7457(e,t,r){(function(){var t,n={}.hasOwnProperty;t=r(468),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e),this.value=""}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.substringData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.insertData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.deleteData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.replaceData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(e){return!!t.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.data===this.data},t}(t)}).call(this)},7500(e,t,r){var n;e=r.nmd(e),n=function(t){"use strict";function r(e,t){t|=0;for(var r=Math.max(e.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=e[t+i];return n}var n=function(e){var t=r(arguments,1);return function(){var n=r(arguments);return e.apply(null,t.concat(n))}},i=function(e){return function(){var t=r(arguments),n=t.pop();e.call(this,t,n)}};function o(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var s="function"==typeof setImmediate&&setImmediate,a="object"==typeof process&&"function"==typeof process.nextTick;function u(e){setTimeout(e,0)}function c(e){return function(t){var n=r(arguments,1);e((function(){t.apply(null,n)}))}}var l=c(s?setImmediate:a?process.nextTick:u);function p(e){return i((function(t,r){var n;try{n=e.apply(this,t)}catch(e){return r(e)}o(n)&&"function"==typeof n.then?n.then((function(e){h(r,null,e)}),(function(e){h(r,e.message?e:new Error(e))})):r(null,n)}))}function h(e,t,r){try{e(t,r)}catch(e){l(d,e)}}function d(e){throw e}var f="function"==typeof Symbol;function m(e){return f&&"AsyncFunction"===e[Symbol.toStringTag]}function g(e){return m(e)?p(e):e}function y(e){return function(t){var n=r(arguments,1),o=i((function(r,n){var i=this;return e(t,(function(e,t){g(e).apply(i,r.concat(t))}),n)}));return n.length?o.apply(this,n):o}}var b="object"==typeof global&&global&&global.Object===Object&&global,v="object"==typeof self&&self&&self.Object===Object&&self,w=b||v||Function("return this")(),I=w.Symbol,_=Object.prototype,E=_.hasOwnProperty,O=_.toString,S=I?I.toStringTag:void 0,C=Object.prototype.toString,T=I?I.toStringTag:void 0;function P(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":T&&T in Object(e)?function(e){var t=E.call(e,S),r=e[S];try{e[S]=void 0;var n=!0}catch(e){}var i=O.call(e);return n&&(t?e[S]=r:delete e[S]),i}(e):function(e){return C.call(e)}(e)}function N(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function A(e){return null!=e&&N(e.length)&&!function(e){if(!o(e))return!1;var t=P(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(e)}var D={};function x(){}function k(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var R="function"==typeof Symbol&&Symbol.iterator;function B(e){return null!=e&&"object"==typeof e}function F(e){return B(e)&&"[object Arguments]"==P(e)}var L=Object.prototype,M=L.hasOwnProperty,U=L.propertyIsEnumerable,j=F(function(){return arguments}())?F:function(e){return B(e)&&M.call(e,"callee")&&!U.call(e,"callee")},V=Array.isArray,G="object"==typeof t&&t&&!t.nodeType&&t,q=G&&e&&!e.nodeType&&e,K=q&&q.exports===G?w.Buffer:void 0,z=(K?K.isBuffer:void 0)||function(){return!1},$=/^(?:0|[1-9]\d*)$/;function H(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&$.test(e))&&e>-1&&e%1==0&&e<t}var Y={};Y["[object Float32Array]"]=Y["[object Float64Array]"]=Y["[object Int8Array]"]=Y["[object Int16Array]"]=Y["[object Int32Array]"]=Y["[object Uint8Array]"]=Y["[object Uint8ClampedArray]"]=Y["[object Uint16Array]"]=Y["[object Uint32Array]"]=!0,Y["[object Arguments]"]=Y["[object Array]"]=Y["[object ArrayBuffer]"]=Y["[object Boolean]"]=Y["[object DataView]"]=Y["[object Date]"]=Y["[object Error]"]=Y["[object Function]"]=Y["[object Map]"]=Y["[object Number]"]=Y["[object Object]"]=Y["[object RegExp]"]=Y["[object Set]"]=Y["[object String]"]=Y["[object WeakMap]"]=!1;var W,J="object"==typeof t&&t&&!t.nodeType&&t,Q=J&&e&&!e.nodeType&&e,X=Q&&Q.exports===J&&b.process,Z=function(){try{return Q&&Q.require&&Q.require("util").types||X&&X.binding&&X.binding("util")}catch(e){}}(),ee=Z&&Z.isTypedArray,te=ee?(W=ee,function(e){return W(e)}):function(e){return B(e)&&N(e.length)&&!!Y[P(e)]},re=Object.prototype.hasOwnProperty;var ne=Object.prototype,ie=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),oe=Object.prototype.hasOwnProperty;function se(e){return A(e)?function(e,t){var r=V(e),n=!r&&j(e),i=!r&&!n&&z(e),o=!r&&!n&&!i&&te(e),s=r||n||i||o,a=s?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],u=a.length;for(var c in e)!t&&!re.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||H(c,u))||a.push(c);return a}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||ne))return ie(e);var t,r,n=[];for(var i in Object(e))oe.call(e,i)&&"constructor"!=i&&n.push(i);return n}(e)}function ae(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function ue(e){return function(t,r,n){if(n=k(n||x),e<=0||!t)return n(null);var i=function(e){if(A(e))return function(e){var t=-1,r=e.length;return function(){return++t<r?{value:e[t],key:t}:null}}(e);var t,r,n,i,o=function(e){return R&&e[R]&&e[R]()}(e);return o?function(e){var t=-1;return function(){var r=e.next();return r.done?null:(t++,{value:r.value,key:t})}}(o):(r=se(t=e),n=-1,i=r.length,function e(){var o=r[++n];return"__proto__"===o?e():n<i?{value:t[o],key:o}:null})}(t),o=!1,s=0,a=!1;function u(e,t){if(s-=1,e)o=!0,n(e);else{if(t===D||o&&s<=0)return o=!0,n(null);a||c()}}function c(){for(a=!0;s<e&&!o;){var t=i();if(null===t)return o=!0,void(s<=0&&n(null));s+=1,r(t.value,t.key,ae(u))}a=!1}c()}}function ce(e,t,r,n){ue(t)(e,g(r),n)}function le(e,t){return function(r,n,i){return e(r,t,n,i)}}function pe(e,t,r){r=k(r||x);var n=0,i=0,o=e.length;function s(e,t){e?r(e):++i!==o&&t!==D||r(null)}for(0===o&&r(null);n<o;n++)t(e[n],n,ae(s))}var he=le(ce,1/0),de=function(e,t,r){(A(e)?pe:he)(e,g(t),r)};function fe(e){return function(t,r,n){return e(de,t,g(r),n)}}function me(e,t,r,n){n=n||x,t=t||[];var i=[],o=0,s=g(r);e(t,(function(e,t,r){var n=o++;s(e,(function(e,t){i[n]=t,r(e)}))}),(function(e){n(e,i)}))}var ge=fe(me),ye=y(ge);function be(e){return function(t,r,n,i){return e(ue(r),t,g(n),i)}}var ve=be(me),we=le(ve,1),Ie=y(we);function _e(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function Ee(e,t){return e&&function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[++n];if(!1===t(i[a],a,i))break}return e}(e,t,se)}function Oe(e){return e!=e}function Se(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r){for(var n=e.length,i=r+-1;++i<n;)if(t(e[i],i,e))return i;return-1}(e,Oe,r)}var Ce=function(e,t,n){"function"==typeof t&&(n=t,t=null),n=k(n||x);var i=se(e).length;if(!i)return n(null);t||(t=i);var o={},s=0,a=!1,u=Object.create(null),c=[],l=[],p={};function h(e,t){c.push((function(){!function(e,t){if(!a){var i=ae((function(t,i){if(s--,arguments.length>2&&(i=r(arguments,1)),t){var c={};Ee(o,(function(e,t){c[t]=e})),c[e]=i,a=!0,u=Object.create(null),n(t,c)}else o[e]=i,_e(u[e]||[],(function(e){e()})),d()}));s++;var c=g(t[t.length-1]);t.length>1?c(o,i):c(i)}}(e,t)}))}function d(){if(0===c.length&&0===s)return n(null,o);for(;c.length&&s<t;)c.shift()()}function f(t){var r=[];return Ee(e,(function(e,n){V(e)&&Se(e,t,0)>=0&&r.push(n)})),r}Ee(e,(function(t,r){if(!V(t))return h(r,[t]),void l.push(r);var n=t.slice(0,t.length-1),i=n.length;if(0===i)return h(r,t),void l.push(r);p[r]=i,_e(n,(function(o){if(!e[o])throw new Error("async.auto task `"+r+"` has a non-existent dependency `"+o+"` in "+n.join(", "));var s,a,c;a=function(){0==--i&&h(r,t)},(c=u[s=o])||(c=u[s]=[]),c.push(a)}))})),function(){for(var e=0;l.length;)e++,_e(f(l.pop()),(function(e){0==--p[e]&&l.push(e)}));if(e!==i)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),d()};function Te(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var Pe=I?I.prototype:void 0,Ne=Pe?Pe.toString:void 0;function Ae(e){if("string"==typeof e)return e;if(V(e))return Te(e,Ae)+"";if(function(e){return"symbol"==typeof e||B(e)&&"[object Symbol]"==P(e)}(e))return Ne?Ne.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}var De=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),xe="\\ud800-\\udfff",ke="["+xe+"]",Re="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Be="\\ud83c[\\udffb-\\udfff]",Fe="[^"+xe+"]",Le="(?:\\ud83c[\\udde6-\\uddff]){2}",Me="[\\ud800-\\udbff][\\udc00-\\udfff]",Ue="(?:"+Re+"|"+Be+")?",je="[\\ufe0e\\ufe0f]?",Ve=je+Ue+"(?:\\u200d(?:"+[Fe,Le,Me].join("|")+")"+je+Ue+")*",Ge="(?:"+[Fe+Re+"?",Re,Le,Me,ke].join("|")+")",qe=RegExp(Be+"(?="+Be+")|"+Ge+Ve,"g");function Ke(e){return function(e){return De.test(e)}(e)?function(e){return e.match(qe)||[]}(e):function(e){return e.split("")}(e)}var ze=/^\s+|\s+$/g;function $e(e,t,r){var n;if((e=null==(n=e)?"":Ae(n))&&(r||void 0===t))return e.replace(ze,"");if(!e||!(t=Ae(t)))return e;var i=Ke(e),o=Ke(t),s=function(e,t){for(var r=-1,n=e.length;++r<n&&Se(t,e[r],0)>-1;);return r}(i,o),a=function(e,t){for(var r=e.length;r--&&Se(t,e[r],0)>-1;);return r}(i,o)+1;return function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}(e,t,r)}(i,s,a).join("")}var He=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Ye=/,/,We=/(=.+)?(\s*)$/,Je=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function Qe(e,t){var r={};Ee(e,(function(e,t){var n,i=m(e),o=!i&&1===e.length||i&&0===e.length;if(V(e))n=e.slice(0,-1),e=e[e.length-1],r[t]=n.concat(n.length>0?s:e);else if(o)r[t]=e;else{if(n=function(e){return(e=(e=(e=e.toString().replace(Je,"")).match(He)[2].replace(" ",""))?e.split(Ye):[]).map((function(e){return $e(e.replace(We,""))}))}(e),0===e.length&&!i&&0===n.length)throw new Error("autoInject task functions require explicit parameters.");i||n.pop(),r[t]=n.concat(s)}function s(t,r){var i=Te(n,(function(e){return t[e]}));i.push(r),g(e).apply(null,i)}})),Ce(r,t)}function Xe(){this.head=this.tail=null,this.length=0}function Ze(e,t){e.length=1,e.head=e.tail=t}function et(e,t,r){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var n=g(e),i=0,o=[],s=!1;function a(e,t,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(p.started=!0,V(e)||(e=[e]),0===e.length&&p.idle())return l((function(){p.drain()}));for(var n=0,i=e.length;n<i;n++){var o={data:e[n],callback:r||x};t?p._tasks.unshift(o):p._tasks.push(o)}s||(s=!0,l((function(){s=!1,p.process()})))}function u(e){return function(t){i-=1;for(var r=0,n=e.length;r<n;r++){var s=e[r],a=Se(o,s,0);0===a?o.shift():a>0&&o.splice(a,1),s.callback.apply(s,arguments),null!=t&&p.error(t,s.data)}i<=p.concurrency-p.buffer&&p.unsaturated(),p.idle()&&p.drain(),p.process()}}var c=!1,p={_tasks:new Xe,concurrency:t,payload:r,saturated:x,unsaturated:x,buffer:t/4,empty:x,drain:x,error:x,started:!1,paused:!1,push:function(e,t){a(e,!1,t)},kill:function(){p.drain=x,p._tasks.empty()},unshift:function(e,t){a(e,!0,t)},remove:function(e){p._tasks.remove(e)},process:function(){if(!c){for(c=!0;!p.paused&&i<p.concurrency&&p._tasks.length;){var e=[],t=[],r=p._tasks.length;p.payload&&(r=Math.min(r,p.payload));for(var s=0;s<r;s++){var a=p._tasks.shift();e.push(a),o.push(a),t.push(a.data)}i+=1,0===p._tasks.length&&p.empty(),i===p.concurrency&&p.saturated();var l=ae(u(e));n(t,l)}c=!1}},length:function(){return p._tasks.length},running:function(){return i},workersList:function(){return o},idle:function(){return p._tasks.length+i===0},pause:function(){p.paused=!0},resume:function(){!1!==p.paused&&(p.paused=!1,l(p.process))}};return p}function tt(e,t){return et(e,1,t)}Xe.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},Xe.prototype.empty=function(){for(;this.head;)this.shift();return this},Xe.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},Xe.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},Xe.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):Ze(this,e)},Xe.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):Ze(this,e)},Xe.prototype.shift=function(){return this.head&&this.removeLink(this.head)},Xe.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},Xe.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,r=0;r<this.length;r++)e[r]=t.data,t=t.next;return e},Xe.prototype.remove=function(e){for(var t=this.head;t;){var r=t.next;e(t)&&this.removeLink(t),t=r}return this};var rt=le(ce,1);function nt(e,t,r,n){n=k(n||x);var i=g(r);rt(e,(function(e,r,n){i(t,e,(function(e,r){t=r,n(e)}))}),(function(e){n(e,t)}))}function it(){var e=Te(arguments,g);return function(){var t=r(arguments),n=this,i=t[t.length-1];"function"==typeof i?t.pop():i=x,nt(e,t,(function(e,t,i){t.apply(n,e.concat((function(e){var t=r(arguments,1);i(e,t)})))}),(function(e,t){i.apply(n,[e].concat(t))}))}}var ot=function(){return it.apply(null,r(arguments).reverse())},st=Array.prototype.concat,at=function(e,t,n,i){i=i||x;var o=g(n);ve(e,t,(function(e,t){o(e,(function(e){return e?t(e):t(null,r(arguments,1))}))}),(function(e,t){for(var r=[],n=0;n<t.length;n++)t[n]&&(r=st.apply(r,t[n]));return i(e,r)}))},ut=le(at,1/0),ct=le(at,1),lt=function(){var e=r(arguments),t=[null].concat(e);return function(){return arguments[arguments.length-1].apply(this,t)}};function pt(e){return e}function ht(e,t){return function(r,n,i,o){o=o||x;var s,a=!1;r(n,(function(r,n,o){i(r,(function(n,i){n?o(n):e(i)&&!s?(a=!0,s=t(!0,r),o(null,D)):o()}))}),(function(e){e?o(e):o(null,a?s:t(!1))}))}}function dt(e,t){return t}var ft=fe(ht(pt,dt)),mt=be(ht(pt,dt)),gt=le(mt,1);function yt(e){return function(t){var n=r(arguments,1);n.push((function(t){var n=r(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&_e(n,(function(t){console[e](t)})))})),g(t).apply(null,n)}}var bt=yt("dir");function vt(e,t,n){n=ae(n||x);var i=g(e),o=g(t);function s(e){if(e)return n(e);var t=r(arguments,1);t.push(a),o.apply(this,t)}function a(e,t){return e?n(e):t?void i(s):n(null)}a(null,!0)}function wt(e,t,n){n=ae(n||x);var i=g(e),o=function(e){if(e)return n(e);var s=r(arguments,1);if(t.apply(this,s))return i(o);n.apply(null,[null].concat(s))};i(o)}function It(e,t,r){wt(e,(function(){return!t.apply(this,arguments)}),r)}function _t(e,t,r){r=ae(r||x);var n=g(t),i=g(e);function o(e){if(e)return r(e);i(s)}function s(e,t){return e?r(e):t?void n(o):r(null)}i(s)}function Et(e){return function(t,r,n){return e(t,n)}}function Ot(e,t,r){de(e,Et(g(t)),r)}function St(e,t,r,n){ue(t)(e,Et(g(r)),n)}var Ct=le(St,1);function Tt(e){return m(e)?e:i((function(t,r){var n=!0;t.push((function(){var e=arguments;n?l((function(){r.apply(null,e)})):r.apply(null,e)})),e.apply(this,t),n=!1}))}function Pt(e){return!e}var Nt=fe(ht(Pt,Pt)),At=be(ht(Pt,Pt)),Dt=le(At,1);function xt(e){return function(t){return null==t?void 0:t[e]}}function kt(e,t,r,n){var i=new Array(t.length);e(t,(function(e,t,n){r(e,(function(e,r){i[t]=!!r,n(e)}))}),(function(e){if(e)return n(e);for(var r=[],o=0;o<t.length;o++)i[o]&&r.push(t[o]);n(null,r)}))}function Rt(e,t,r,n){var i=[];e(t,(function(e,t,n){r(e,(function(r,o){r?n(r):(o&&i.push({index:t,value:e}),n())}))}),(function(e){e?n(e):n(null,Te(i.sort((function(e,t){return e.index-t.index})),xt("value")))}))}function Bt(e,t,r,n){(A(t)?kt:Rt)(e,t,g(r),n||x)}var Ft=fe(Bt),Lt=be(Bt),Mt=le(Lt,1);function Ut(e,t){var r=ae(t||x),n=g(Tt(e));!function e(t){if(t)return r(t);n(e)}()}var jt=function(e,t,r,n){n=n||x;var i=g(r);ve(e,t,(function(e,t){i(e,(function(r,n){return r?t(r):t(null,{key:n,val:e})}))}),(function(e,t){for(var r={},i=Object.prototype.hasOwnProperty,o=0;o<t.length;o++)if(t[o]){var s=t[o].key,a=t[o].val;i.call(r,s)?r[s].push(a):r[s]=[a]}return n(e,r)}))},Vt=le(jt,1/0),Gt=le(jt,1),qt=yt("log");function Kt(e,t,r,n){n=k(n||x);var i={},o=g(r);ce(e,t,(function(e,t,r){o(e,t,(function(e,n){if(e)return r(e);i[t]=n,r()}))}),(function(e){n(e,i)}))}var zt=le(Kt,1/0),$t=le(Kt,1);function Ht(e,t){return t in e}function Yt(e,t){var n=Object.create(null),o=Object.create(null);t=t||pt;var s=g(e),a=i((function(e,i){var a=t.apply(null,e);Ht(n,a)?l((function(){i.apply(null,n[a])})):Ht(o,a)?o[a].push(i):(o[a]=[i],s.apply(null,e.concat((function(){var e=r(arguments);n[a]=e;var t=o[a];delete o[a];for(var i=0,s=t.length;i<s;i++)t[i].apply(null,e)}))))}));return a.memo=n,a.unmemoized=e,a}var Wt=c(a?process.nextTick:s?setImmediate:u);function Jt(e,t,n){n=n||x;var i=A(t)?[]:{};e(t,(function(e,t,n){g(e)((function(e,o){arguments.length>2&&(o=r(arguments,1)),i[t]=o,n(e)}))}),(function(e){n(e,i)}))}function Qt(e,t){Jt(de,e,t)}function Xt(e,t,r){Jt(ue(t),e,r)}var Zt=function(e,t){var r=g(e);return et((function(e,t){r(e[0],t)}),t,1)},er=function(e,t){var r=Zt(e,t);return r.push=function(e,t,n){if(null==n&&(n=x),"function"!=typeof n)throw new Error("task callback must be a function");if(r.started=!0,V(e)||(e=[e]),0===e.length)return l((function(){r.drain()}));t=t||0;for(var i=r._tasks.head;i&&t>=i.priority;)i=i.next;for(var o=0,s=e.length;o<s;o++){var a={data:e[o],priority:t,callback:n};i?r._tasks.insertBefore(i,a):r._tasks.push(a)}l(r.process)},delete r.unshift,r};function tr(e,t){if(t=k(t||x),!V(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var r=0,n=e.length;r<n;r++)g(e[r])(t)}function rr(e,t,n,i){nt(r(e).reverse(),t,n,i)}function nr(e){var t=g(e);return i((function(e,n){return e.push((function(e,t){var i;e?n(null,{error:e}):(i=arguments.length<=2?t:r(arguments,1),n(null,{value:i}))})),t.apply(this,e)}))}function ir(e){var t;return V(e)?t=Te(e,nr):(t={},Ee(e,(function(e,r){t[r]=nr.call(this,e)}))),t}function or(e,t,r,n){Bt(e,t,(function(e,t){r(e,(function(e,r){t(e,!r)}))}),n)}var sr=fe(or),ar=be(or),ur=le(ar,1);function cr(e){return function(){return e}}function lr(e,t,r){var n={times:5,intervalFunc:cr(0)};if(arguments.length<3&&"function"==typeof e?(r=t||x,t=e):(function(e,t){if("object"==typeof t)e.times=+t.times||5,e.intervalFunc="function"==typeof t.interval?t.interval:cr(+t.interval||0),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||5}}(n,e),r=r||x),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var i=g(t),o=1;!function e(){i((function(t){t&&o++<n.times&&("function"!=typeof n.errorFilter||n.errorFilter(t))?setTimeout(e,n.intervalFunc(o)):r.apply(null,arguments)}))}()}var pr=function(e,t){t||(t=e,e=null);var r=g(t);return i((function(t,n){function i(e){r.apply(null,t.concat(e))}e?lr(e,i,n):lr(i,n)}))};function hr(e,t){Jt(rt,e,t)}var dr=fe(ht(Boolean,pt)),fr=be(ht(Boolean,pt)),mr=le(fr,1);function gr(e,t,r){var n=g(t);function i(e,t){var r=e.criteria,n=t.criteria;return r<n?-1:r>n?1:0}ge(e,(function(e,t){n(e,(function(r,n){if(r)return t(r);t(null,{value:e,criteria:n})}))}),(function(e,t){if(e)return r(e);r(null,Te(t.sort(i),xt("value")))}))}function yr(e,t,r){var n=g(e);return i((function(i,o){var s,a=!1;i.push((function(){a||(o.apply(null,arguments),clearTimeout(s))})),s=setTimeout((function(){var t=e.name||"anonymous",n=new Error('Callback function "'+t+'" timed out.');n.code="ETIMEDOUT",r&&(n.info=r),a=!0,o(n)}),t),n.apply(null,i)}))}var br=Math.ceil,vr=Math.max;function wr(e,t,r,n){var i=g(r);ve(function(e,t){for(var r=-1,n=vr(br((t-e)/1),0),i=Array(n);n--;)i[++r]=e,e+=1;return i}(0,e),t,i,n)}var Ir=le(wr,1/0),_r=le(wr,1);function Er(e,t,r,n){arguments.length<=3&&(n=r,r=t,t=V(e)?[]:{}),n=k(n||x);var i=g(r);de(e,(function(e,r,n){i(t,e,r,n)}),(function(e){n(e,t)}))}function Or(e,t){var n,i=null;t=t||x,Ct(e,(function(e,t){g(e)((function(e,o){n=arguments.length>2?r(arguments,1):o,i=e,t(!e)}))}),(function(){t(i,n)}))}function Sr(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function Cr(e,t,n){n=ae(n||x);var i=g(t);if(!e())return n(null);var o=function(t){if(t)return n(t);if(e())return i(o);var s=r(arguments,1);n.apply(null,[null].concat(s))};i(o)}function Tr(e,t,r){Cr((function(){return!e.apply(this,arguments)}),t,r)}var Pr=function(e,t){if(t=k(t||x),!V(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var n=0;function i(t){var r=g(e[n++]);t.push(ae(o)),r.apply(null,t)}function o(o){if(o||n===e.length)return t.apply(null,arguments);i(r(arguments,1))}i([])},Nr={apply:n,applyEach:ye,applyEachSeries:Ie,asyncify:p,auto:Ce,autoInject:Qe,cargo:tt,compose:ot,concat:ut,concatLimit:at,concatSeries:ct,constant:lt,detect:ft,detectLimit:mt,detectSeries:gt,dir:bt,doDuring:vt,doUntil:It,doWhilst:wt,during:_t,each:Ot,eachLimit:St,eachOf:de,eachOfLimit:ce,eachOfSeries:rt,eachSeries:Ct,ensureAsync:Tt,every:Nt,everyLimit:At,everySeries:Dt,filter:Ft,filterLimit:Lt,filterSeries:Mt,forever:Ut,groupBy:Vt,groupByLimit:jt,groupBySeries:Gt,log:qt,map:ge,mapLimit:ve,mapSeries:we,mapValues:zt,mapValuesLimit:Kt,mapValuesSeries:$t,memoize:Yt,nextTick:Wt,parallel:Qt,parallelLimit:Xt,priorityQueue:er,queue:Zt,race:tr,reduce:nt,reduceRight:rr,reflect:nr,reflectAll:ir,reject:sr,rejectLimit:ar,rejectSeries:ur,retry:lr,retryable:pr,seq:it,series:hr,setImmediate:l,some:dr,someLimit:fr,someSeries:mr,sortBy:gr,timeout:yr,times:Ir,timesLimit:wr,timesSeries:_r,transform:Er,tryEach:Or,unmemoize:Sr,until:Tr,waterfall:Pr,whilst:Cr,all:Nt,allLimit:At,allSeries:Dt,any:dr,anyLimit:fr,anySeries:mr,find:ft,findLimit:mt,findSeries:gt,forEach:Ot,forEachSeries:Ct,forEachLimit:St,forEachOf:de,forEachOfSeries:rt,forEachOfLimit:ce,inject:nt,foldl:nt,foldr:rr,select:Ft,selectLimit:Lt,selectSeries:Mt,wrapSync:p};t.default=Nr,t.apply=n,t.applyEach=ye,t.applyEachSeries=Ie,t.asyncify=p,t.auto=Ce,t.autoInject=Qe,t.cargo=tt,t.compose=ot,t.concat=ut,t.concatLimit=at,t.concatSeries=ct,t.constant=lt,t.detect=ft,t.detectLimit=mt,t.detectSeries=gt,t.dir=bt,t.doDuring=vt,t.doUntil=It,t.doWhilst=wt,t.during=_t,t.each=Ot,t.eachLimit=St,t.eachOf=de,t.eachOfLimit=ce,t.eachOfSeries=rt,t.eachSeries=Ct,t.ensureAsync=Tt,t.every=Nt,t.everyLimit=At,t.everySeries=Dt,t.filter=Ft,t.filterLimit=Lt,t.filterSeries=Mt,t.forever=Ut,t.groupBy=Vt,t.groupByLimit=jt,t.groupBySeries=Gt,t.log=qt,t.map=ge,t.mapLimit=ve,t.mapSeries=we,t.mapValues=zt,t.mapValuesLimit=Kt,t.mapValuesSeries=$t,t.memoize=Yt,t.nextTick=Wt,t.parallel=Qt,t.parallelLimit=Xt,t.priorityQueue=er,t.queue=Zt,t.race=tr,t.reduce=nt,t.reduceRight=rr,t.reflect=nr,t.reflectAll=ir,t.reject=sr,t.rejectLimit=ar,t.rejectSeries=ur,t.retry=lr,t.retryable=pr,t.seq=it,t.series=hr,t.setImmediate=l,t.some=dr,t.someLimit=fr,t.someSeries=mr,t.sortBy=gr,t.timeout=yr,t.times=Ir,t.timesLimit=wr,t.timesSeries=_r,t.transform=Er,t.tryEach=Or,t.unmemoize=Sr,t.until=Tr,t.waterfall=Pr,t.whilst=Cr,t.all=Nt,t.allLimit=At,t.allSeries=Dt,t.any=dr,t.anyLimit=fr,t.anySeries=mr,t.find=ft,t.findLimit=mt,t.findSeries=gt,t.forEach=Ot,t.forEachSeries=Ct,t.forEachLimit=St,t.forEachOf=de,t.forEachOfSeries=rt,t.forEachOfLimit=ce,t.inject=nt,t.foldl=nt,t.foldr=rr,t.select=Ft,t.selectLimit=Lt,t.selectSeries=Mt,t.wrapSync=p,Object.defineProperty(t,"__esModule",{value:!0})},n(t)},7507(e,t,r){var n;e.exports=function(){if(!n){try{n=r(5753)("follow-redirects")}catch(e){}"function"!=typeof n&&(n=function(){})}n.apply(null,arguments)}},7575(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1725);class i{constructor(e){if(this.length=0,this._encoding="utf8",this._writeOffset=0,this._readOffset=0,i.isSmartBufferOptions(e))if(e.encoding&&(n.checkEncoding(e.encoding),this._encoding=e.encoding),e.size){if(!(n.isFiniteInteger(e.size)&&e.size>0))throw new Error(n.ERRORS.INVALID_SMARTBUFFER_SIZE);this._buff=Buffer.allocUnsafe(e.size)}else if(e.buff){if(!Buffer.isBuffer(e.buff))throw new Error(n.ERRORS.INVALID_SMARTBUFFER_BUFFER);this._buff=e.buff,this.length=e.buff.length}else this._buff=Buffer.allocUnsafe(4096);else{if(void 0!==e)throw new Error(n.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer.allocUnsafe(4096)}}static fromSize(e,t){return new this({size:e,encoding:t})}static fromBuffer(e,t){return new this({buff:e,encoding:t})}static fromOptions(e){return new this(e)}static isSmartBufferOptions(e){const t=e;return t&&(void 0!==t.encoding||void 0!==t.size||void 0!==t.buff)}readInt8(e){return this._readNumberValue(Buffer.prototype.readInt8,1,e)}readInt16BE(e){return this._readNumberValue(Buffer.prototype.readInt16BE,2,e)}readInt16LE(e){return this._readNumberValue(Buffer.prototype.readInt16LE,2,e)}readInt32BE(e){return this._readNumberValue(Buffer.prototype.readInt32BE,4,e)}readInt32LE(e){return this._readNumberValue(Buffer.prototype.readInt32LE,4,e)}readBigInt64BE(e){return n.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer.prototype.readBigInt64BE,8,e)}readBigInt64LE(e){return n.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer.prototype.readBigInt64LE,8,e)}writeInt8(e,t){return this._writeNumberValue(Buffer.prototype.writeInt8,1,e,t),this}insertInt8(e,t){return this._insertNumberValue(Buffer.prototype.writeInt8,1,e,t)}writeInt16BE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt16BE,2,e,t)}insertInt16BE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt16BE,2,e,t)}writeInt16LE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt16LE,2,e,t)}insertInt16LE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt16LE,2,e,t)}writeInt32BE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt32BE,4,e,t)}insertInt32BE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt32BE,4,e,t)}writeInt32LE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt32LE,4,e,t)}insertInt32LE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt32LE,4,e,t)}writeBigInt64BE(e,t){return n.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigInt64BE,8,e,t)}insertBigInt64BE(e,t){return n.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigInt64BE,8,e,t)}writeBigInt64LE(e,t){return n.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigInt64LE,8,e,t)}insertBigInt64LE(e,t){return n.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigInt64LE,8,e,t)}readUInt8(e){return this._readNumberValue(Buffer.prototype.readUInt8,1,e)}readUInt16BE(e){return this._readNumberValue(Buffer.prototype.readUInt16BE,2,e)}readUInt16LE(e){return this._readNumberValue(Buffer.prototype.readUInt16LE,2,e)}readUInt32BE(e){return this._readNumberValue(Buffer.prototype.readUInt32BE,4,e)}readUInt32LE(e){return this._readNumberValue(Buffer.prototype.readUInt32LE,4,e)}readBigUInt64BE(e){return n.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer.prototype.readBigUInt64BE,8,e)}readBigUInt64LE(e){return n.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer.prototype.readBigUInt64LE,8,e)}writeUInt8(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt8,1,e,t)}insertUInt8(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt8,1,e,t)}writeUInt16BE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt16BE,2,e,t)}insertUInt16BE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt16BE,2,e,t)}writeUInt16LE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt16LE,2,e,t)}insertUInt16LE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt16LE,2,e,t)}writeUInt32BE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt32BE,4,e,t)}insertUInt32BE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt32BE,4,e,t)}writeUInt32LE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt32LE,4,e,t)}insertUInt32LE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt32LE,4,e,t)}writeBigUInt64BE(e,t){return n.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64BE,8,e,t)}insertBigUInt64BE(e,t){return n.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64BE,8,e,t)}writeBigUInt64LE(e,t){return n.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64LE,8,e,t)}insertBigUInt64LE(e,t){return n.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64LE,8,e,t)}readFloatBE(e){return this._readNumberValue(Buffer.prototype.readFloatBE,4,e)}readFloatLE(e){return this._readNumberValue(Buffer.prototype.readFloatLE,4,e)}writeFloatBE(e,t){return this._writeNumberValue(Buffer.prototype.writeFloatBE,4,e,t)}insertFloatBE(e,t){return this._insertNumberValue(Buffer.prototype.writeFloatBE,4,e,t)}writeFloatLE(e,t){return this._writeNumberValue(Buffer.prototype.writeFloatLE,4,e,t)}insertFloatLE(e,t){return this._insertNumberValue(Buffer.prototype.writeFloatLE,4,e,t)}readDoubleBE(e){return this._readNumberValue(Buffer.prototype.readDoubleBE,8,e)}readDoubleLE(e){return this._readNumberValue(Buffer.prototype.readDoubleLE,8,e)}writeDoubleBE(e,t){return this._writeNumberValue(Buffer.prototype.writeDoubleBE,8,e,t)}insertDoubleBE(e,t){return this._insertNumberValue(Buffer.prototype.writeDoubleBE,8,e,t)}writeDoubleLE(e,t){return this._writeNumberValue(Buffer.prototype.writeDoubleLE,8,e,t)}insertDoubleLE(e,t){return this._insertNumberValue(Buffer.prototype.writeDoubleLE,8,e,t)}readString(e,t){let r;"number"==typeof e?(n.checkLengthValue(e),r=Math.min(e,this.length-this._readOffset)):(t=e,r=this.length-this._readOffset),void 0!==t&&n.checkEncoding(t);const i=this._buff.slice(this._readOffset,this._readOffset+r).toString(t||this._encoding);return this._readOffset+=r,i}insertString(e,t,r){return n.checkOffsetValue(t),this._handleString(e,!0,t,r)}writeString(e,t,r){return this._handleString(e,!1,t,r)}readStringNT(e){void 0!==e&&n.checkEncoding(e);let t=this.length;for(let e=this._readOffset;e<this.length;e++)if(0===this._buff[e]){t=e;break}const r=this._buff.slice(this._readOffset,t);return this._readOffset=t+1,r.toString(e||this._encoding)}insertStringNT(e,t,r){return n.checkOffsetValue(t),this.insertString(e,t,r),this.insertUInt8(0,t+e.length),this}writeStringNT(e,t,r){return this.writeString(e,t,r),this.writeUInt8(0,"number"==typeof t?t+e.length:this.writeOffset),this}readBuffer(e){void 0!==e&&n.checkLengthValue(e);const t="number"==typeof e?e:this.length,r=Math.min(this.length,this._readOffset+t),i=this._buff.slice(this._readOffset,r);return this._readOffset=r,i}insertBuffer(e,t){return n.checkOffsetValue(t),this._handleBuffer(e,!0,t)}writeBuffer(e,t){return this._handleBuffer(e,!1,t)}readBufferNT(){let e=this.length;for(let t=this._readOffset;t<this.length;t++)if(0===this._buff[t]){e=t;break}const t=this._buff.slice(this._readOffset,e);return this._readOffset=e+1,t}insertBufferNT(e,t){return n.checkOffsetValue(t),this.insertBuffer(e,t),this.insertUInt8(0,t+e.length),this}writeBufferNT(e,t){return void 0!==t&&n.checkOffsetValue(t),this.writeBuffer(e,t),this.writeUInt8(0,"number"==typeof t?t+e.length:this._writeOffset),this}clear(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}remaining(){return this.length-this._readOffset}get readOffset(){return this._readOffset}set readOffset(e){n.checkOffsetValue(e),n.checkTargetOffset(e,this),this._readOffset=e}get writeOffset(){return this._writeOffset}set writeOffset(e){n.checkOffsetValue(e),n.checkTargetOffset(e,this),this._writeOffset=e}get encoding(){return this._encoding}set encoding(e){n.checkEncoding(e),this._encoding=e}get internalBuffer(){return this._buff}toBuffer(){return this._buff.slice(0,this.length)}toString(e){const t="string"==typeof e?e:this._encoding;return n.checkEncoding(t),this._buff.toString(t,0,this.length)}destroy(){return this.clear(),this}_handleString(e,t,r,i){let o=this._writeOffset,s=this._encoding;"number"==typeof r?o=r:"string"==typeof r&&(n.checkEncoding(r),s=r),"string"==typeof i&&(n.checkEncoding(i),s=i);const a=Buffer.byteLength(e,s);return t?this.ensureInsertable(a,o):this._ensureWriteable(a,o),this._buff.write(e,o,a,s),t?this._writeOffset+=a:"number"==typeof r?this._writeOffset=Math.max(this._writeOffset,o+a):this._writeOffset+=a,this}_handleBuffer(e,t,r){const n="number"==typeof r?r:this._writeOffset;return t?this.ensureInsertable(e.length,n):this._ensureWriteable(e.length,n),e.copy(this._buff,n),t?this._writeOffset+=e.length:"number"==typeof r?this._writeOffset=Math.max(this._writeOffset,n+e.length):this._writeOffset+=e.length,this}ensureReadable(e,t){let r=this._readOffset;if(void 0!==t&&(n.checkOffsetValue(t),r=t),r<0||r+e>this.length)throw new Error(n.ERRORS.INVALID_READ_BEYOND_BOUNDS)}ensureInsertable(e,t){n.checkOffsetValue(t),this._ensureCapacity(this.length+e),t<this.length&&this._buff.copy(this._buff,t+e,t,this._buff.length),t+e>this.length?this.length=t+e:this.length+=e}_ensureWriteable(e,t){const r="number"==typeof t?t:this._writeOffset;this._ensureCapacity(r+e),r+e>this.length&&(this.length=r+e)}_ensureCapacity(e){const t=this._buff.length;if(e>t){let r=this._buff,n=3*t/2+1;n<e&&(n=e),this._buff=Buffer.allocUnsafe(n),r.copy(this._buff,0,0,t)}}_readNumberValue(e,t,r){this.ensureReadable(t,r);const n=e.call(this._buff,"number"==typeof r?r:this._readOffset);return void 0===r&&(this._readOffset+=t),n}_insertNumberValue(e,t,r,i){return n.checkOffsetValue(i),this.ensureInsertable(t,i),e.call(this._buff,r,i),this._writeOffset+=t,this}_writeNumberValue(e,t,r,i){if("number"==typeof i){if(i<0)throw new Error(n.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);n.checkOffsetValue(i)}const o="number"==typeof i?i:this._writeOffset;return this._ensureWriteable(t,o),e.call(this._buff,r,o),"number"==typeof i?this._writeOffset=Math.max(this._writeOffset,o+t):this._writeOffset+=t,this}}t.SmartBuffer=i},7685(e,t,r){"use strict";const n=r(4617);class i extends Error{constructor(e){super(e),this.name="TimeoutError"}}const o=(e,t,r)=>new Promise(((o,s)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void o(e);const a=setTimeout((()=>{if("function"==typeof r){try{o(r())}catch(e){s(e)}return}const n=r instanceof Error?r:new i("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),s(n)}),t);n(e.then(o,s),(()=>{clearTimeout(a)}))}));e.exports=o,e.exports.default=o,e.exports.TimeoutError=i},7687(e,t,r){"use strict";const n=r(857),i=r(9637),o=r(5884),{env:s}=process;let a;function u(e,t={}){return 0!==(r=function(e,{streamIsTTY:t,sniffFlags:r=!0}={}){const i=function(){if("FORCE_COLOR"in s)return"true"===s.FORCE_COLOR?1:"false"===s.FORCE_COLOR?0:0===s.FORCE_COLOR.length?1:Math.min(Number.parseInt(s.FORCE_COLOR,10),3)}();void 0!==i&&(a=i);const u=r?a:i;if(0===u)return 0;if(r){if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2}if(e&&!t&&void 0===u)return 0;const c=u||0;if("dumb"===s.TERM)return c;if("win32"===process.platform){const e=n.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some((e=>e in s))||"codeship"===s.CI_NAME?1:c;if("TEAMCITY_VERSION"in s)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0;if("truecolor"===s.COLORTERM)return 3;if("TERM_PROGRAM"in s){const e=Number.parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)||"COLORTERM"in s?1:c}(e,{streamIsTTY:e&&e.isTTY,...t}))&&{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3};var r}o("no-color")||o("no-colors")||o("color=false")||o("color=never")?a=0:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(a=1),e.exports={supportsColor:u,stdout:u({isTTY:i.isatty(1)}),stderr:u({isTTY:i.isatty(2)})}},7696(e,t,r){(function(){var t,n,i={}.hasOwnProperty;n=r(468),t=r(1737),e.exports=function(e){function r(e,n,i){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());i||(i="(#PCDATA)"),Array.isArray(i)&&(i="("+i.join(",")+")"),this.name=this.stringify.name(n),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(i)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},7833(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=r(736)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},7969(e){e.exports={initVariables(){let e=this,t=[];if(t.push({variableId:"usp_connected",name:"Connected to USP Panel"}),1==e.config.use_as_surface&&t.push({variableId:"companion_connected",name:"Connected to Companion Satellite API"}),"usp3"==e.config.model){for(let e=0;e<this.GPI_LIST.length;e++){let r=this.GPI_LIST[e];t.push({variableId:`gpi_${r.id}`,name:`GPI ${r.id} State`})}for(let e=0;e<this.GPO_LIST.length;e++){let r=this.GPO_LIST[e];t.push({variableId:`gpo_${r.id}`,name:`GPO ${r.id} State`})}for(let e=0;e<this.MEM_LIST.length;e++){let r=this.MEM_LIST[e];t.push({variableId:`mem_${r.id}`,name:`MEM ${r.id} State`})}if(!e.config.use_as_surface)for(let e=0;e<this.KEY_LIST.length;e++){let r=this.KEY_LIST[e];t.push({variableId:`key_${r.id}`,name:`KEY ${r.id} State`})}}e.setVariableDefinitions(t)},checkVariables(){let e=this;try{let t={};if(void 0!==e.DATA.uspConnected?t.usp_connected=e.DATA.uspConnected?"True":"False":t.usp_connected="",e.config.use_as_surface&&(void 0!==e.DATA.satelliteConnected?t.companion_connected=e.DATA.satelliteConnected?"True":"False":t.companion_connected=""),"usp3"==e.config.model){for(let r=0;r<e.DATA.gpiStates.length;r++){let n=e.DATA.gpiStates[r];t[`gpi_${n.id}`]=n.state?"On":"Off"}for(let r=0;r<e.DATA.gpoStates.length;r++){let n=e.DATA.gpoStates[r];t[`gpo_${n.id}`]=n.state?"On":"Off"}for(let r=0;r<e.DATA.memStates.length;r++){let n=e.DATA.memStates[r];t[`mem_${n.id}`]=n.state?"On":"Off"}if(!e.config.use_as_surface)for(let r=0;r<e.DATA.keyStates.length;r++){let n=e.DATA.keyStates[r];t[`key_${n.id}`]=n.state?"On":"Off"}}e.setVariableValues(t)}catch(t){e.log("error",`Error checking variables: ${t.toString()}`)}}}},8e3(e){var t=1e3,r=60*t,n=60*r,i=24*n,o=7*i;function s(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,a){a=a||{};var u,c,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(s){var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*o;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(u=e,(c=Math.abs(u))>=i?s(u,c,i,"day"):c>=n?s(u,c,n,"hour"):c>=r?s(u,c,r,"minute"):c>=t?s(u,c,t,"second"):u+" ms"):function(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=n?Math.round(e/n)+"h":o>=r?Math.round(e/r)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},8012(e,t,r){(function(){var t,n,i={}.hasOwnProperty;n=r(468),t=r(1737),e.exports=function(e){function r(e,n,i){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!i.pubID&&!i.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=t.NotationDeclaration,null!=i.pubID&&(this.pubID=this.stringify.dtdPubID(i.pubID)),null!=i.sysID&&(this.sysID=this.stringify.dtdSysID(i.sysID))}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),r.prototype.toString=function(e){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},8039(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const n=r(1635),i=r(2593),o=n.__importDefault(r(7e3)),s=r(360);function a(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#A;#G;#q;#k;#K=new Map;#z=new Map;#$=new Map;#H=new Map;#Y;get parseVariablesContext(){return this.#Y}constructor(e,t,r,n){this.#A=e,this.#G=t,this.#q=r,this.#k=n}getDefinitionIds(){return Array.from(this.#K.keys())}getInstanceIds(){return Array.from(this.#z.keys())}handleUpdateFeedbacks(e){for(const[t,r]of Object.entries(e)){const e=this.#z.get(t);if(e&&!r){const t=this.#K.get(e.feedbackId);if(t?.unsubscribe){const r={parseVariablesInString:async e=>e};Promise.resolve(t.unsubscribe(a(t.type,e),r)).catch((t=>{this.#k("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!r||r.disabled)this.#z.delete(t);else{if(this.#z.set(t,{...r}),!e){const e=this.#K.get(r.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>e};Promise.resolve(e.subscribe(a(e.type,r),t)).catch((e=>{this.#k("error",`Feedback subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)}))}}this.#W(t)}}}async handleLearnFeedback(e){const t=this.#K.get(e.feedback.feedbackId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#A({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},r)}}return{options:void 0}}#W(e){const t=this.#H.get(e);if(t)return void(t.needsRecheck=!0);const r=this.#z.get(e);if(!r)return;const n=r,i={needsRecheck:!1};this.#H.set(e,i),Promise.resolve().then((async()=>{const t=this.#K.get(n.feedbackId);let r;if(t){this.#Y=`Feedback ${n.feedbackId} (${e})`;const i={parseVariablesInString:async t=>(await this.#A({text:t,controlId:n.controlId,actionInstanceId:void 0,feedbackInstanceId:e})).text};switch(t.type){case"boolean":r=t.callback({...a("boolean",n),type:"boolean"},i);break;case"value":r=t.callback({...a("value",n),type:"value"},i);break;case"advanced":r=t.callback({...a("advanced",n),type:"advanced",image:n.image},i);break;default:(0,s.assertNever)(t)}this.#Y=void 0}const i=await r;this.#$.set(e,{id:e,controlId:n.controlId,value:i}),this.#J()})).catch((e=>{console.error(`Feedback check failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)})).finally((()=>{this.#Y=void 0,this.#H.delete(e),i.needsRecheck&&setImmediate((()=>{this.#W(e)}))}))}#J=(0,o.default)((()=>{const e=this.#$;this.#$=new Map,e.size>0&&this.#G({values:Array.from(e.values())})}),{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#K.clear();for(const[r,n]of Object.entries(e))n&&(t.push({id:r,name:n.name,description:n.description,options:(0,i.serializeIsVisibleFn)(n.options),type:n.type,defaultStyle:"boolean"===n.type?n.defaultStyle:void 0,hasLearn:!!n.learn,learnTimeout:n.learnTimeout,showInvert:"boolean"===n.type&&n.showInvert}),this.#K.set(r,n));this.#q({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,r]of this.#z.entries())this.#K.get(r.feedbackId)&&(0===t.size||t.has(r.feedbackId))&&this.#W(e)}checkFeedbacksById(e){for(const t of e)this.#W(t)}subscribeFeedbacks(e){let t=Array.from(this.#z.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.feedbackId))));for(const e of t){const t=this.#K.get(e.feedbackId);if(t?.subscribe){const r={parseVariablesInString:async e=>e};Promise.resolve(t.subscribe(a(t.type,e),r)).catch((t=>{this.#k("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeFeedbacks(e){let t=Array.from(this.#z.values());const r=new Set(e);r.size&&(t=t.filter((e=>r.has(e.feedbackId))));for(const e of t){const t=this.#K.get(e.feedbackId);if(t&&t.unsubscribe){const r={parseVariablesInString:async e=>e};Promise.resolve(t.unsubscribe(a(t.type,e),r)).catch((t=>{this.#k("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},8048(e,t,r){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(5983)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},8104(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8384(e,t,r){const{Regex:n}=r(6278);e.exports={getConfigFields:()=>[{type:"static-text",id:"info1",width:12,label:"Information",value:"This module will allow you to use a TSL Products or DNF Controls Universal Switch Panel with Companion.<hr />"},{type:"dropdown",id:"model",label:"Model of USP Panel",width:12,default:"usp3",choices:[{id:"usp3",label:"TSL Products USP3 Panels"},{id:"usp_legacy",label:"DNF Controls USP-8 or USP-16 Panel"}]},{type:"textinput",id:"host_usp",label:"IP Address of USP Panel",width:3,default:"",regex:n.IP},{type:"static-text",id:"info3",width:12,label:"",value:"<hr />"},{type:"static-text",id:"satellite_surface_info_usp_legacy",width:12,label:"Companion Satellite Surface Configuration",value:"This module allows you to use your DNF Controls USP panel as a satellite surface in Companion.",isVisible:e=>"usp_legacy"==e.model},{type:"static-text",id:"satellite_surface_info_usp3",width:12,label:"Companion Satellite Surface Configuration",value:"This module allows you to use your TSL Products USP3 panel as a satellite surface in Companion. If disabled, you can use Companion to send commands to the USP3 panel instead.",isVisible:e=>"usp3"==e.model},{type:"checkbox",id:"use_as_surface",label:"Use as a Satellite Surface in Companion",width:3,default:!0,isVisible:e=>"usp3"==e.model},{type:"textinput",id:"port_companion",label:"TCP Port configured for Companion Satellite (default: 16622)",width:3,default:"16622",regex:n.PORT,isVisible:e=>1==e.use_as_surface},{type:"checkbox",id:"auto_configure",label:"Auto-Configure USP Panel to work as a surface in Companion",width:12,default:!0,isVisible:e=>1==e.use_as_surface},{type:"checkbox",id:"already_configured",label:"Already Auto-Configured",width:12,default:!1,isVisible:e=>!1},{type:"static-text",id:"already_configured_info",width:12,label:"",value:"This panel has already been auto-configured to work as a surface in Companion.",isVisible:e=>1==e.already_configured&&1==e.use_as_surface&&1==e.auto_configure},{type:"checkbox",id:"rerun_configuration",label:"Re-run auto configuration of Panel upon saving module config",width:12,default:!1,isVisible:e=>1==e.use_as_surface&&1==e.auto_configure&&1==e.already_configured},{type:"dropdown",id:"port_usp",label:"Remote Device Port as configured on USP3 Panel",width:6,default:"50001",choices:[{id:"50001",label:"Remote Device 1: 50001"},{id:"50002",label:"Remote Device 2: 50002"},{id:"50003",label:"Remote Device 3: 50003"},{id:"50004",label:"Remote Device 4: 50004"},{id:"50005",label:"Remote Device 5: 50005"},{id:"50006",label:"Remote Device 6: 50006"},{id:"50007",label:"Remote Device 7: 50007"},{id:"50008",label:"Remote Device 8: 50008"}],isVisible:e=>"usp3"==e.model&&(0==e.auto_configure||0==e.use_as_surface)},{type:"dropdown",id:"usp_device_id",label:"Device ID to use for Remote Device Assignment",width:6,default:"0",choices:[{id:"0",label:"Device #1"},{id:"1",label:"Device #2"},{id:"2",label:"Device #3"},{id:"3",label:"Device #4"},{id:"4",label:"Device #5"},{id:"5",label:"Device #6"},{id:"6",label:"Device #7"},{id:"7",label:"Device #8"},{id:"8",label:"Device #9"},{id:"9",label:"Device #10"},{id:"10",label:"Device #11"},{id:"11",label:"Device #12"},{id:"12",label:"Device #13"},{id:"13",label:"Device #14"},{id:"14",label:"Device #15"},{id:"15",label:"Device #16"},{id:"16",label:"Device #17"},{id:"17",label:"Device #18"},{id:"18",label:"Device #19"},{id:"19",label:"Device #20"}],isVisible:e=>"usp_legacy"==e.model&&1==e.use_as_surface&&1==e.auto_configure&&!0!==e.already_configured},{type:"textinput",id:"port_usp_legacy",label:"UDP Port (SNMP) as configured on Panel to send data back to Companion",width:3,default:"1024",regex:n.Port,isVisible:e=>"usp_legacy"==e.model&&0==e.auto_configure},{type:"static-text",id:"info4",width:12,label:"Setting the USP Port",value:"This Port must be unique for each panel and Companion module instance. The commands are sent over UDP, so make sure the panel and Companion are able to communicate over the same subnet.",isVisible:e=>"usp_legacy"==e.model&&0==e.auto_configure},{type:"dropdown",id:"font_size",label:"Preferred Font Size to use on Buttons. Remember that the amount of text that can fit on a button is limited.",width:12,default:"auto",choices:[{id:"auto",label:"Auto Scale"},{id:"0",label:"Small"},{id:"1",label:"Medium"},{id:"2",label:"Large"}],isVisible:e=>1==e.use_as_surface},{type:"static-text",id:"info5",width:12,label:"",value:"<hr />",isVisible:e=>0==e.use_as_surface},{type:"checkbox",id:"polling",label:"Enable Polling - This will poll the USP panel for button states and update Companion with the current state of the panel.",width:6,default:!1,isVisible:e=>0==e.use_as_surface&&"usp3"==e.model},{type:"number",id:"poll_interval",label:"Polling Interval (ms)",min:50,max:3e4,default:1e3,width:6,isVisible:e=>1==e.polling&&0==e.use_as_surface},{type:"static-text",id:"info6",width:12,label:"",value:"<hr />"},{type:"checkbox",id:"verbose",label:"Enable Verbose Logging - This will log all commands sent to the USP panel and all responses received from the panel.",width:12},{type:"static-text",id:"info7",width:12,label:"",value:"<hr />"},{type:"checkbox",id:"advanced_config",label:"Show Advanced Configuration Options",width:12,default:!1},{type:"static-text",id:"advanced_config_info",width:12,label:"",value:"Only change these settings if you know what you are doing. These settings are not required for normal operation."},{type:"static-text",id:"advanced_config_no_settings",width:6,label:"",value:"There are no advanced settings available when not using the USP panel as a surface.",isVisible:e=>1==e.advanced_config&&0==e.use_as_surface},{type:"number",id:"advanced_config_usp_legacy_panel_delay_time",label:"DNF Controls USP Panel Delay Time between Updates (ms)",min:100,max:3e4,default:3e3,width:6,isVisible:e=>1==e.advanced_config&&"usp_legacy"==e.model},{type:"static-text",id:"advanced_config_usp_legacy_panel_delay_time_info",width:6,label:"",value:"This is the amount of time between updates sent to the DNF Controls USP panel. This older USP panel can only handle a certain amount of data at a time without crashing, so this setting can be used to slow down the updates to the panel. The default value is 3000ms (3 seconds).",isVisible:e=>1==e.advanced_config&&"usp_legacy"==e.model},{type:"dropdown",id:"advanced_usp_panel_default_unsupported_color",label:"USP Panel Default Unsupported Button Color",default:2,choices:[{id:0,label:"Dark"},{id:1,label:"Red"},{id:2,label:"Green"},{id:3,label:"Amber"}],width:6,isVisible:e=>1==e.advanced_config&&1==e.use_as_surface},{type:"static-text",id:"advanced_config_usp_panel_default_unsupported_color_info",width:6,label:"",value:"This is the default color to use for button colors that are not supported on the panel. The default value is Green.",isVisible:e=>1==e.advanced_config&&1==e.use_as_surface},{type:"dropdown",id:"advanced_usp_panel_default_dark_color",label:"USP Panel Replace Dark Button Color",default:0,choices:[{id:0,label:"Leave Dark"},{id:1,label:"Red"},{id:2,label:"Green"},{id:3,label:"Amber"}],width:6,isVisible:e=>1==e.advanced_config&&1==e.use_as_surface},{type:"static-text",id:"advanced_config_usp_panel_default_dark_color_info",width:6,label:"",value:"This is the replacement color to use for button colors when the button in Companion is set to a dark color, which can be difficult to read on the USP panel.",isVisible:e=>1==e.advanced_config&&1==e.use_as_surface}]}},8404(e,t,r){const{combineRgb:n}=r(6278);e.exports={initFeedbacks(){let e=this,t={};"usp3"==e.config.model&&(t.gpiState={type:"boolean",name:"GPI Number is in X State",description:"Show feedback for GPI State",options:[{type:"dropdown",label:"GPI Number",id:"gpi",default:this.GPI_LIST[0].id,choices:this.GPI_LIST},{type:"dropdown",label:"State",id:"state",default:"1",choices:[{id:"1",label:"On"},{id:"0",label:"Off"}]}],defaultStyle:{color:n(0,0,0),bgcolor:n(255,0,0)},callback:t=>{let r=t.options,n=e.DATA.gpiStates.find((e=>e.id==r.gpi));return!(!n||n.state!=parseInt(r.state))}},t.gpoState={type:"boolean",name:"GPO Number is in X State",description:"Show feedback for GPO State",options:[{type:"dropdown",label:"GPO Number",id:"gpo",default:this.GPO_LIST[0].id,choices:this.GPO_LIST},{type:"dropdown",label:"State",id:"state",default:"1",choices:[{id:"1",label:"On"},{id:"0",label:"Off"}]}],defaultStyle:{color:n(0,0,0),bgcolor:n(255,0,0)},callback:t=>{let r=t.options,n=e.DATA.gpoStates.find((e=>e.id==r.gpo));return!(!n||n.state!=parseInt(r.state))}},t.memState={type:"boolean",name:"Mem Number is in X State",description:"Show feedback for Mem State",options:[{type:"dropdown",label:"Mem Number",id:"mem",default:this.MEM_LIST[0].id,choices:this.MEM_LIST},{type:"dropdown",label:"State",id:"state",default:"1",choices:[{id:"1",label:"On"},{id:"0",label:"Off"}]}],defaultStyle:{color:n(0,0,0),bgcolor:n(255,0,0)},callback:t=>{let r=t.options,n=e.DATA.memStates.find((e=>e.id==r.mem));return!(!n||n.state!=parseInt(r.state))}},0==e.config.use_as_surface&&(t.keyState={type:"boolean",name:"Key Number is in X State",description:"Show feedback for Key State",options:[{type:"dropdown",label:"Key Number",id:"key",default:this.KEY_LIST[0].id,choices:this.KEY_LIST},{type:"dropdown",label:"State",id:"state",default:"1",choices:[{id:"1",label:"Pressed"},{id:"0",label:"Not Pressed"}]}],defaultStyle:{color:n(0,0,0),bgcolor:n(255,0,0)},callback:t=>{let r=t.options,n=e.DATA.keyStates.find((e=>e.id==r.key));return!(!n||n.state!=parseInt(r.state))}})),e.setFeedbackDefinitions(t)}}},8611(e){"use strict";e.exports=require("http")},8651(e,t,r){var n=r(2613),i=r(5071),o=r(6679).InvalidAsn1Error,s={size:1024,growthFactor:8};function a(e){var t,r;t=s,r=e||{},n.ok(t),n.equal(typeof t,"object"),n.ok(r),n.equal(typeof r,"object"),Object.getOwnPropertyNames(t).forEach((function(e){if(!r[e]){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n)}})),e=r,this._buf=Buffer.alloc(e.size||1024),this._size=this._buf.length,this._offset=0,this._options=e,this._seq=[]}Object.defineProperty(a.prototype,"buffer",{get:function(){if(this._seq.length)throw new o(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}}),a.prototype.writeByte=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=e},a.prototype.writeInt=function(e,t){if(!Number.isInteger(e))throw new TypeError("argument must be an integer");"number"!=typeof t&&(t=i.Integer);let r=[];for(;e<-128||e>=128;)r.push(255&e),e=Math.floor(e/256);for(r.push(255&e),this._ensure(2+r.length),this._buf[this._offset++]=t,this._buf[this._offset++]=r.length;r.length;)this._buf[this._offset++]=r.pop()},a.prototype.writeNull=function(){this.writeByte(i.Null),this.writeByte(0)},a.prototype.writeEnumeration=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");return"number"!=typeof t&&(t=i.Enumeration),this.writeInt(e,t)},a.prototype.writeBoolean=function(e,t){if("boolean"!=typeof e)throw new TypeError("argument must be a Boolean");"number"!=typeof t&&(t=i.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=e?255:0},a.prototype.writeString=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string (was: "+typeof e+")");"number"!=typeof t&&(t=i.OctetString);var r=Buffer.byteLength(e);this.writeByte(t),this.writeLength(r),r&&(this._ensure(r),this._buf.write(e,this._offset),this._offset+=r)},a.prototype.writeBuffer=function(e,t){if(!Buffer.isBuffer(e))throw new TypeError("argument must be a buffer");"number"==typeof t&&(this.writeByte(t),this.writeLength(e.length)),e.length>0&&(this._ensure(e.length),e.copy(this._buf,this._offset,0,e.length),this._offset+=e.length)},a.prototype.writeStringArray=function(e,t){if(!(e instanceof Array))throw new TypeError("argument must be an Array[String]");var r=this;e.forEach((function(e){r.writeString(e,t)}))},a.prototype.writeOID=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string");if("number"!=typeof t&&(t=i.OID),!/^([0-9]+\.){0,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");var r=e.split("."),n=[];n.push(40*parseInt(r[0],10)+parseInt(r[1],10)),r.slice(2).forEach((function(e){!function(e,t){t<128?e.push(t):t<16384?(e.push(t>>>7|128),e.push(127&t)):t<2097152?(e.push(t>>>14|128),e.push(t>>>7&255|128),e.push(127&t)):t<268435456?(e.push(t>>>21|128),e.push(t>>>14&255|128),e.push(t>>>7&255|128),e.push(127&t)):(e.push(t>>>28&255|128),e.push(t>>>21&255|128),e.push(t>>>14&255|128),e.push(t>>>7&255|128),e.push(127&t))}(n,parseInt(e,10))}));var o=this;this._ensure(2+n.length),this.writeByte(t),this.writeLength(n.length),n.forEach((function(e){o.writeByte(e)}))},a.prototype.writeLength=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");if(this._ensure(4),e<=127)this._buf[this._offset++]=e;else if(e<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=e;else if(e<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else{if(!(e<=16777215))throw new o("Length too long (> 4 bytes)");this._buf[this._offset++]=131,this._buf[this._offset++]=e>>16,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e}},a.prototype.startSequence=function(e){"number"!=typeof e&&(e=i.Sequence|i.Constructor),this.writeByte(e),this._seq.push(this._offset),this._ensure(3),this._offset+=3},a.prototype.endSequence=function(){var e=this._seq.pop(),t=e+3,r=this._offset-t;if(r<=127)this._shift(t,r,-2),this._buf[e]=r;else if(r<=255)this._shift(t,r,-1),this._buf[e]=129,this._buf[e+1]=r;else if(r<=65535)this._buf[e]=130,this._buf[e+1]=r>>8,this._buf[e+2]=r;else{if(!(r<=16777215))throw new o("Sequence too long");this._shift(t,r,1),this._buf[e]=131,this._buf[e+1]=r>>16,this._buf[e+2]=r>>8,this._buf[e+3]=r}},a.prototype._shift=function(e,t,r){n.ok(void 0!==e),n.ok(void 0!==t),n.ok(r),this._buf.copy(this._buf,e+r,e,e+t),this._offset+=r},a.prototype._ensure=function(e){if(n.ok(e),this._size-this._offset<e){var t=this._size*this._options.growthFactor;t-this._offset<e&&(t+=e);var r=Buffer.alloc(t);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=t}},e.exports=a},8753(e){(function(){e.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},8779(e,t,r){r(2613);var n=r(5071),i=r(6679).InvalidAsn1Error;function o(e){if(!e||!Buffer.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}Object.defineProperty(o.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(o.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(o.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),o.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=255&this._buf[this._offset];return e||(this._offset+=1),t},o.prototype.peek=function(){return this.readByte(!0)},o.prototype.readLength=function(e){if(void 0===e&&(e=this._offset),e>=this._size)return null;var t=255&this._buf[e++];if(null===t)return null;if(128&~t)this._len=t;else{if(0==(t&=127))throw i("Indefinite length not supported");if(this._size-e<t)return null;this._len=0;for(var r=0;r<t;r++)this._len*=256,this._len+=255&this._buf[e++]}return e},o.prototype.readSequence=function(e){var t=this.peek();if(null===t)return null;if(void 0!==e&&e!==t)throw i("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);return null===r?null:(this._offset=r,t)},o.prototype.readInt=function(e){return this._readTag(e)},o.prototype.readBoolean=function(e){return"number"!=typeof e&&(e=n.Boolean),0!==this._readTag(e)},o.prototype.readEnumeration=function(e){return"number"!=typeof e&&(e=n.Enumeration),this._readTag(e)},o.prototype.readString=function(e,t){e||(e=n.OctetString);var r=this.peek();if(null===r)return null;if(r!==e)throw i("Expected 0x"+e.toString(16)+": got 0x"+r.toString(16));var o=this.readLength(this._offset+1);if(null===o)return null;if(this.length>this._size-o)return null;if(this._offset=o,0===this.length)return t?Buffer.alloc(0):"";var s=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?s:s.toString("utf8")},o.prototype.readOID=function(e){e||(e=n.OID);var t=this.readString(e,!0);if(null===t)return null;for(var r=[],i=0,o=0;o<t.length;o++){var s=255&t[o];i<<=7,i+=127&s,128&s||(r.push(i>>>0),i=0)}return i=r.shift(),r.unshift(i%40),r.unshift(i/40|0),r.join(".")},o.prototype.readBitString=function(e){e||(e=n.BitString);var t=this.peek();if(null===t)return null;if(t!==e)throw i("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>this._size-r)return null;if(this._offset=r,0===this.length)return"";var o=this._buf[this._offset++],s=this._buf.slice(this._offset,this._offset+this.length-1),a=parseInt(s.toString("hex"),16).toString(2).padStart(8*s.length,"0");return this._offset+=this.length-1,a.substring(0,a.length-o)},o.prototype._readTag=function(e){var t=this.peek();if(null===t)return null;if(void 0!==e&&t!==e)throw i("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(0===this.length)throw i("Zero-length integer");if(this.length>this._size-r)return null;this._offset=r;for(var n=this._buf.readInt8(this._offset++),o=1;o<this.length;o++)n*=256,n+=this._buf[this._offset++];if(!Number.isSafeInteger(n))throw i("Integer not representable as javascript number");return n},e.exports=o},8805(e,t,r){(function(){"use strict";var e,n,i,o,s={}.hasOwnProperty;n=r(6465),e=r(6712),i=r(1912),o=r(2114),t.defaults=n.defaults,t.processors=o,t.ValidationError=function(){function e(e){this.message=e}return function(e,t){for(var r in t)s.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(e,Error),e}(),t.Builder=e.Builder,t.Parser=i.Parser,t.parseString=i.parseString,t.parseStringPromise=i.parseStringPromise}).call(this)},8895(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const n=r(1635).__importDefault(r(9278)),i=r(228),o=r(1400);class s extends i.EventEmitter{#F;#L;_socket;#w;#Q=!1;#X=!1;#U=!1;#j;#Z;#r;get isConnected(){return this.#Q}get isConnecting(){return this.#X}get isDestroyed(){return this.#U}constructor(e,t,r){super(),this.#F=e,this.#L=t,this.#w={reconnect_interval:2e3,reconnect:!0,...r},this._socket=new n.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",(e=>{this.#X=!1,this.#Q=!1,this.#w.reconnect&&this.#ee(),this.#V(o.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this._socket.on("ready",(()=>{this.#Q=!0,this.#X=!1,this.#V(o.InstanceStatus.Ok),this.emit("connect")})),this._socket.on("end",(()=>{this.#Q=!1,this.#V(o.InstanceStatus.Disconnected),!this.#X&&this.#w.reconnect&&this.#ee(),this.emit("end")})),this._socket.on("data",(e=>this.emit("data",e))),this._socket.on("drain",(()=>this.emit("drain"))),setImmediate((()=>{this.#U||this.connect()})),this.#r=setTimeout((()=>{this.#r=void 0,this.#U||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#F}:${this.#L} is missing an error handler!`)}),5e3)}connect(){if(this.#U)throw new Error("Cannot connect destroyed socket");return!this.#X&&(this.#X=!0,this._socket.connect(this.#L,this.#F),!0)}async send(e){if(this.#U||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#Q)return!1;try{return new Promise(((t,r)=>{this._socket.write(e,(e=>{e?r(e):t(!0)}))}))}catch(e){this.#Q=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#V(o.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#U=!0,void 0!==this.#Z&&(clearTimeout(this.#Z),this.#Z=void 0),void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#ee(){void 0!==this.#Z&&clearTimeout(this.#Z),this.#Z=setTimeout((()=>{this.#Z=void 0,this.#V(o.InstanceStatus.Connecting),this.connect()}),this.#w.reconnect_interval)}#V(e,t){this.#j!=e&&(this.#j=e,this.emit("status_change",e,t))}}t.TCPHelper=s},8983(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9023(e){"use strict";e.exports=require("util")},9077(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=function(e,t){if(!t){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'")}if(e.legacyIds.includes(e.id))throw new Error(`Manifest contains itself '${e.id}' in legacyIds`);if(!(0,n.default)(e)){const e=n.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}};const n=r(1635).__importDefault(r(7281))},9241(e){(function(){var t,r,n,i,o,s,a,u=[].slice,c={}.hasOwnProperty;t=function(){var e,t,r,n,i,s;if(s=arguments[0],i=2<=arguments.length?u.call(arguments,1):[],o(Object.assign))Object.assign.apply(null,arguments);else for(e=0,r=i.length;e<r;e++)if(null!=(n=i[e]))for(t in n)c.call(n,t)&&(s[t]=n[t]);return s},o=function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},s=function(e){var t;return!!e&&("function"==(t=typeof e)||"object"===t)},n=function(e){return o(Array.isArray)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},i=function(e){var t;if(n(e))return!e.length;for(t in e)if(c.call(e,t))return!1;return!0},a=function(e){var t,r;return s(e)&&(r=Object.getPrototypeOf(e))&&(t=r.constructor)&&"function"==typeof t&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)},r=function(e){return o(e.valueOf)?e.valueOf():e},e.exports.assign=t,e.exports.isFunction=o,e.exports.isObject=s,e.exports.isArray=n,e.exports.isEmpty=i,e.exports.isPlainObject=a,e.exports.getValue=r}).call(this)},9278(e){"use strict";e.exports=require("net")},9367(e){e.exports={initActions(){let e=this,t={};"usp3"==e.config.model&&(t.setGPO={name:"Set GPO On/Off",options:[{type:"dropdown",label:"GPO Number",id:"gpo",default:this.GPO_LIST[0].id,choices:this.GPO_LIST},{type:"dropdown",label:"GPO State",id:"state",default:"1",choices:[{id:"1",label:"On"},{id:"0",label:"Off"}]}],callback:async t=>{e.sendUSPCommand(`GPO_${t.options.gpo}:${t.options.state}`)}},t.setGPOAll={name:"Set All GPO On/Off",options:[{type:"dropdown",label:"GPO State",id:"state",default:"1",choices:[{id:"1",label:"On"},{id:"0",label:"Off"}]}],callback:async t=>{e.sendUSPCommand(`GPO_00:${t.options.state}`)}},0==this.config.use_as_surface&&(t.pressKey={name:"Press Key",options:[{type:"dropdown",label:"Key Number",id:"key",default:this.KEY_LIST[0].id,choices:this.KEY_LIST}],callback:async t=>{e.sendUSPCommand(`KYP_${t.options.key}:1`)}},t.setKeyText={name:"Set Key Text",options:[{type:"dropdown",label:"Key Number",id:"key",default:this.KEY_LIST[0].id,choices:this.KEY_LIST},{type:"textinput",label:"Text",id:"text",default:""}],callback:async t=>{void 0===e.config.font_size&&(e.config.font_size=0);let r=e.config.font_size,n=t.options.key,i=await e.parseVariablesInString(t.options.text);i.length>0?(i.includes("\\n")&&(i=i.split("\\n").join(" ")),i.includes("_")&&(i=i.split("_").join(" "))):i=" ","auto"==r&&(r=i.length<4?2:i.length<8?1:0),e.sendUSPCommand(`TXT_${String(n).padStart(2,"0")}:${r}_${i}`)}})),this.setActionDefinitions(t)}}},9637(e){"use strict";e.exports=require("tty")},9665(e,t,r){(function(){var t,n,i,o,s,a,u,c,l,p;p=r(9241),c=p.assign,l=p.isFunction,i=r(7260),o=r(1933),s=r(400),u=r(382),a=r(6775),t=r(1737),n=r(8753),e.exports.create=function(e,t,r,n){var i,s;if(null==e)throw new Error("Root element needs a name.");return n=c({},t,r,n),s=(i=new o(n)).element(e),n.headless||(i.declaration(n),null==n.pubID&&null==n.sysID||i.dtd(n)),s},e.exports.begin=function(e,t,r){var n;return l(e)&&(t=(n=[e,t])[0],r=n[1],e={}),t?new s(e,t,r):new o(e)},e.exports.stringWriter=function(e){return new u(e)},e.exports.streamWriter=function(e,t){return new a(e,t)},e.exports.implementation=new i,e.exports.nodeType=t,e.exports.writerState=n}).call(this)},9786(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyUpgradeScript=void 0,t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,r)=>{const n=[];for(const t of r.feedbacks){let r=e[t.feedbackId];if(!0===r&&(r={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),r){t.style||(t.style={});for(const[e,i]of Object.entries(r))void 0!==t.options[e]&&(t.style[i]=t.options[e],delete t.options[e],n.push(t))}}return{updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:n}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,r)=>{const n=[];for(const t of r.feedbacks){const r=e[t.feedbackId];if("string"!=typeof r)continue;const i=t.options[r];void 0!==i&&(delete t.options[r],t.isInverted="true"===i||!0===Boolean(i)||Number(i)>0,n.push(t))}return{updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:n}}},t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:[]})},9828(e,t,r){const{InstanceStatus:n}=r(6278),i=r(1323),o=r(4767),s=r(5879).K,a=[{oid:"1.3.6.1.4.1.21541.2.1.0",button:1},{oid:"1.3.6.1.4.1.21541.2.2.0",button:2},{oid:"1.3.6.1.4.1.21541.2.3.0",button:3},{oid:"1.3.6.1.4.1.21541.2.4.0",button:4},{oid:"1.3.6.1.4.1.21541.2.5.0",button:5},{oid:"1.3.6.1.4.1.21541.2.6.0",button:6},{oid:"1.3.6.1.4.1.21541.2.7.0",button:7},{oid:"1.3.6.1.4.1.21541.2.8.0",button:8},{oid:"1.3.6.1.4.1.21541.2.9.0",button:9},{oid:"1.3.6.1.4.1.21541.2.10.0",button:10},{oid:"1.3.6.1.4.1.21541.2.11.0",button:11},{oid:"1.3.6.1.4.1.21541.2.12.0",button:12},{oid:"1.3.6.1.4.1.21541.2.13.0",button:13},{oid:"1.3.6.1.4.1.21541.2.14.0",button:14},{oid:"1.3.6.1.4.1.21541.2.15.0",button:15},{oid:"1.3.6.1.4.1.21541.2.16.0",button:16}];e.exports={initUSP_Legacy:function(){let e=this;1==e.config.auto_configure&&!0!==e.config.already_configured||1==e.config.rerun_configuration?e.autoConfigureLegacyPanel():e.setupSNMP()},autoConfigureLegacyPanel:async function(){let e=this;e.log("info","Attempting to auto-configure USP legacy panel...");let t="";try{let r=e.config.host_usp.split("."),i=r[0]+"."+r[1]+"."+r[2]+".",o=(await e.parseVariablesInString("$(internal:all_ip)")).split("\\n");for(let e=0;e<o.length;e++){let r=o[e];if(r.startsWith(i)){t=r;break}}if(""==t)return e.log("error","Could not find a network interface on the same subnet as the panel - unable to auto-configure."),void e.updateStatus(n.ConnectionFailure,"See log for details.")}catch(t){return e.log("error","Error auto configuring USP legacy panel: "+t),void e.updateStatus(n.ConnectionFailure,"See log for details.")}try{i.getPortPromise({port:161,stopport:200}).then((r=>{e.log("info","Configuring Remote Device Assignment Page...");let n="";n+=`r${e.config.usp_device_id}c0=Bitfocus+Companion`,n+=`&r${e.config.usp_device_id}c1=${t}`,n+=`&r${e.config.usp_device_id}c3=${r}`,n+=`&r${e.config.usp_device_id}c2=19`;let i={data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}};(new s).post("http://"+e.config.host_usp+"/gtp_hb.htm",i,(function(t,n){e.autoConfigureLegacyPanelSwitches.bind(e)(r)})).on("error",(function(t){e.log("error","Error auto configuring USP legacy panel: "+t)}))})).catch((t=>{e.log("error","Error auto configuring USP legacy panel: "+t)}))}catch(t){return e.log("error","Error auto configuring USP legacy panel: "+t),void e.updateStatus(n.Error)}},autoConfigureLegacyPanelSwitches:function(e){let t=this;t.log("info","Configuring Switch Assignment Page...");try{let r="";for(let e=0;e<16;e++)""!==r&&(r+="&"),r+=`r${e}c0=${e}`,r+="&",r+=`r${e}c1=0`,r+="&",r+=`r${e}c2=1`,r+="&",r+=`r${e}c4=${e}`;let n={data:r,headers:{"Content-Type":"application/x-www-form-urlencoded"}};(new s).post("http://"+t.config.host_usp+"/switch.htm",n,(function(r,n){t.config.port_usp_legacy=e,t.config.already_configured=!0,t.saveConfig(t.config),t.log("info","USP legacy panel auto-configured successfully!"),t.setupSNMP.bind(t)()})).on("error",(function(e){t.log("error","Error auto configuring USP legacy panel: "+e)}))}catch(e){return t.log("error","Error auto configuring USP legacy panel: "+e),void t.updateStatus(n.Error)}},setupSNMP:function(){let e=this;try{if(""!=e.config.port_usp&&null!=e.config.port_usp){e.log("info","Initializing USP Legacy SNMP Agent"),e.log("debug","USP Legacy SNMP Agent listening on port "+e.config.port_usp_legacy);try{e.USP_LEGACY_SNMP_AGENT&&(e.USP_LEGACY_SNMP_AGENT.close(),e.USP_LEGACY_SNMP_AGENT=null),e.USP_LEGACY_SNMP_AGENT=o.createAgent({port:e.config.port_usp_legacy,accessControlModelType:o.AccessControlModelType.Simple},(function(t,r){t?(console.error(t),setTimeout(e.setupSNMP.bind(e),5e3)):e.processUSPLegacyData(r)})),this.USP_LEGACY_SNMP_AGENT.getAuthorizer().addCommunity("public");for(let t=0;t<e.DATA.keys.length;t++)e.DATA.keys[t].changed=!0;let t=e.buildKeysObj();e.currentlyUpdatingLegacyPanel=!0,e.sendUSPLegacyKeysUpdate(t),e.updateStatus(n.Ok)}catch(t){e.updateStatus(n.Error),e.log("error","Error initializing USP Legacy SNMP Agent: "+t)}}else e.updateStatus(n.Warning,"No USP port specified")}catch(t){e.updateStatus(n.Error),e.log("error","Error initializing USP SNMP Agent: "+t)}},processUSPLegacyData:function(e){let t=this;try{for(var r=0;r<e.pdu.varbinds.length;r++){let n=e.pdu.varbinds[r];if("1.3.6.1.4.1.21541.8.1.0"===n.oid)t.DATA.uspConnected=!0,t.checkVariables();else{let e=a.find((e=>e.oid==n.oid));if(e){let r=e.button,i=""==n.requestValue;if(t.config.use_as_surface)r-=1,t.sendCompanionSatelliteCommand(`KEY-PRESS DEVICEID=${t.DEVICE_ID} KEY=${r} PRESSED=${i}`);else{let e={id:r,state:i},n=!1;for(let e=0;e<t.DATA.keyStates.length;e++)if(t.DATA.keyStates[e].id==r){t.DATA.keyStates[e].state=i,n=!0;break}n||t.DATA.keyStates.push(e),t.checkVariables(),t.checkFeedbacks()}}else t.log("debug","Unknown OID: "+n.oid)}}}catch(e){t.log("error","Error processing USP Legacy data: "+e)}},updateLegacyKeys:function(e){let t=this;try{let r=!1,n=t.DATA.keys.find((t=>t.number==e.number));n&&n.text===e.text&&n.color===e.color||(r=!0),r=!0,r&&e.number<=16&&(e.changed=!0,t.updateInternalKey(e),t.queueLegacyKeyUpdate())}catch(e){t.log("error","Error updating USP legacy keys: "+e)}},queueLegacyKeyUpdate:function(){let e=this;try{e.legacy_key_interval&&(clearInterval(e.legacy_key_interval),e.legacy_key_interval=null);let t=100;1==e.currentlyUpdatingLegacyPanel&&(t=e.config.advanced_config_usp_legacy_panel_delay_time),e.legacy_key_interval=setTimeout((function(){e.log("debug","Updating USP legacy keys...");let t=e.buildKeysObj();e.currentlyUpdatingLegacyPanel=!0,e.sendUSPLegacyKeysUpdate(t)}),t)}catch(t){e.log("error","Error queuing USP legacy key update: "+t)}},buildKeysObj:function(){let e=this,t="";try{for(let r=0;r<e.DATA.keys.length;r++){let n=e.DATA.keys[r],i=n.number-1;n.number<=16&&(""!==t&&(t+="&"),t+=`r${i}c0=0`,t+="&",t+=`r${i}c2=${n.text}`,t+="&",t+=`r${i}c3=${n.text}`,t+="&",t+=`r${i}c4=${n.fontSize}`,t+="&",t+=`r${i}c5=${n.fontSize}`,t+="&",t+=`r${i}c6=${n.uspColorLegacy}`,t+="&",t+=`r${i}c7=${n.uspColorLegacy}`,t+="&",t+=`r${i}c8=0`,t+="&",t+=`r${i}c9=2`),n.changed=!1}}catch(t){e.log("error","Error building USP legacy keys: "+t)}return t},sendUSPLegacyKeysUpdate:function(e){let t=this;try{if(""!==t.config.host_usp&&void 0!==t.config.host_usp){let r={data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}};(new s).post("http://"+t.config.host_usp+"/tally.htm",r,(function(e,r){setTimeout(t.updateCurrentlyUpdatingVariable.bind(t),t.config.advanced_config_usp_legacy_panel_delay_time,!1)})).on("error",(function(e){console.log("request error",e),t.log("error","Error updating USP legacy keys: "+e)}))}else t.log("error","No USP legacy host specified, unable to update keys.")}catch(e){t.log("error","Error sending USP legacy keys update: "+e)}},updateCurrentlyUpdatingVariable:function(e){this.currentlyUpdatingLegacyPanel=e},periodicallyUpdatePanel:function(){let e=this;e.USP_LEGACY_PERIODIC_UPDATE&&(clearInterval(e.USP_LEGACY_PERIODIC_UPDATE),e.USP_LEGACY_PERIODIC_UPDATE=null),e.USP_LEGACY_PERIODIC_UPDATE=setInterval(e.queueLegacyKeyUpdate.bind(e),1e4)}}},9896(e){"use strict";e.exports=require("fs")},9967(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},9998(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let n=0,i=e.length;for(;i>0;){const o=i/2|0;let s=n+o;r(e[s],t)<=0?(n=++s,i-=o+1):i=o}return n}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);const{InstanceBase:n,InstanceStatus:i,runEntrypoint:o}=r(6278),s=r(3487),a=r(8384),u=r(9367),c=r(8404),l=r(7969),p=r(1632),h=r(7413),d=r(1084),f=r(9828),m=r(5521);o(class extends n{constructor(e){super(e),Object.assign(this,{...a,...u,...c,...l,...p,...h,...d,...f,...m}),this.SOCKET_COMPANION=void 0,this.SOCKET_USP=void 0,this.USP_LEGACY_SNMP_AGENT=void 0,this.COMPANION_PING_INTERVAL=void 0,this.USP_INTERVAL=void 0,this.USP_LEGACY_PERIODIC_UPDATE=void 0,this.DATA={satelliteConnected:!1,uspConnected:!1,keys:[],gpiStates:[{id:"01",state:!1},{id:"02",state:!1},{id:"03",state:!1},{id:"04",state:!1},{id:"05",state:!1},{id:"06",state:!1},{id:"07",state:!1},{id:"08",state:!1},{id:"09",state:!1},{id:"10",state:!1},{id:"11",state:!1},{id:"12",state:!1},{id:"13",state:!1},{id:"14",state:!1},{id:"15",state:!1},{id:"16",state:!1}],gpoStates:[{id:"01",state:!1},{id:"02",state:!1},{id:"03",state:!1},{id:"04",state:!1},{id:"05",state:!1},{id:"06",state:!1},{id:"07",state:!1},{id:"08",state:!1},{id:"09",state:!1},{id:"10",state:!1},{id:"11",state:!1},{id:"12",state:!1},{id:"13",state:!1},{id:"14",state:!1},{id:"15",state:!1},{id:"16",state:!1}],memStates:[{id:"01",state:!1},{id:"02",state:!1},{id:"03",state:!1},{id:"04",state:!1},{id:"05",state:!1},{id:"06",state:!1},{id:"07",state:!1},{id:"08",state:!1},{id:"09",state:!1},{id:"10",state:!1},{id:"11",state:!1},{id:"12",state:!1},{id:"13",state:!1},{id:"14",state:!1},{id:"15",state:!1},{id:"16",state:!1}],keyStates:[{id:"01",state:!1},{id:"02",state:!1},{id:"03",state:!1},{id:"04",state:!1},{id:"05",state:!1},{id:"06",state:!1},{id:"07",state:!1},{id:"08",state:!1},{id:"09",state:!1},{id:"10",state:!1},{id:"11",state:!1},{id:"12",state:!1},{id:"13",state:!1},{id:"14",state:!1},{id:"15",state:!1},{id:"16",state:!1}]},this.DEVICE_ID=this.id,this.currentlyUpdatingLegacyPanel=!1,this.legacy_key_interval=null,this.receiveBuffer=""}async destroy(){void 0!==this.SOCKET_COMPANION&&(this.sendCompanionSatelliteCommand("QUIT"),this.SOCKET_COMPANION.destroy(),delete this.SOCKET_COMPANION),void 0!==this.SOCKET_USP&&(this.SOCKET_USP.destroy(),delete this.SOCKET_USP),void 0!==this.COMPANION_PING_INTERVAL&&(clearInterval(this.COMPANION_PING_INTERVAL),delete this.COMPANION_PING_INTERVAL),void 0!==this.USP_INTERVAL&&(clearInterval(this.USP_INTERVAL),delete this.USP_INTERVAL),void 0!==this.USP_LEGACY_PERIODIC_UPDATE&&(clearInterval(this.USP_LEGACY_PERIODIC_UPDATE),delete this.USP_LEGACY_PERIODIC_UPDATE)}async init(e){this.configUpdated(e)}async configUpdated(e){void 0!==this.USP_INTERVAL&&(clearInterval(this.USP_INTERVAL),delete this.USP_INTERVAL),this.config=e,this.updateStatus(i.Connecting,"Connecting to panel..."),this.initActions(),this.initFeedbacks(),this.initVariables(),this.initPresets(),this.checkVariables(),this.checkFeedbacks(),1==this.config.use_as_surface&&this.CompanionSatellite_Close(),"usp3"===this.config.model?this.initUSP():"usp_legacy"==this.config.model&&(this.initCompanionSatellite(),this.initUSP_Legacy())}},s)})();