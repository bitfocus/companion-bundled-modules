(()=>{var e={131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},144:(e,t,r)=>{"use strict";const i=r(3908);e.exports=(e,t,r=!1)=>{if(e instanceof i)return e;try{return new i(e,t)}catch(e){if(!r)return null;throw e}}},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function i(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,i,o,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new n(i,o||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,i,n=[];if(0===this._eventsCount)return n;for(i in e=this._events)t.call(e,i)&&n.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,s=new Array(o);n<o;n++)s[n]=i[n].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,n,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,n),!0;case 5:return u.fn.call(u.context,t,i,n,o),!0;case 6:return u.fn.call(u.context,t,i,n,o,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var p,h=u.length;for(c=0;c<h;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,i,n){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||n&&!a.once||i&&a.context!==i||s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||n&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,r,i){let n=(255&e)<<16|(255&t)<<8|255&r;return i&&i>=0&&i<1&&(n+=16777216*Math.round(255*(1-i))),n},t.splitRgb=n,t.splitHsl=function(e){const t=n(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=n(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=n(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()},t.parseEscapeCharacters=function(e){return e.replaceAll("\\n","\n").replaceAll("\\r","\r").replaceAll("\\t","\t").replaceAll("\\f","\f").replaceAll("\\v","\v").replaceAll("\\b","\b").replaceAll("\\\\","\\").replaceAll("\\x00","\0").replaceAll("\\x01","").replaceAll("\\x02","").replaceAll("\\x03","")},t.substituteEscapeCharacters=function(e){return e.replaceAll("\n","\\n").replaceAll("\r","\\r").replaceAll("\t","\\t").replaceAll("\f","\\f").replaceAll("\v","\\v").replaceAll("\b","\\b").replaceAll("\\","\\\\").replaceAll("\0","\\x00").replaceAll("","\\x01").replaceAll("","\\x02").replaceAll("","\\x03")};const i=r(6284);function n(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,i.colord)(e).isValid()){const t=(0,i.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}},560:(e,t,r)=>{"use strict";const i=r(3908);e.exports=(e,t,r)=>new i(e,r).compare(new i(t,r))},1118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const i=r(1635).__importDefault(r(228)),n=r(2203),o=r(8895);class s extends i.default{#e;#t;#r;get isConnected(){return this.#e.isConnected}get isConnecting(){return this.#e.isConnecting}get isDestroyed(){return this.#e.isDestroyed}constructor(e,t,r){super(),this.#e=new o.TCPHelper(e,t,r),this.#t=new a,this.#e._socket.pipe(this.#t),this.#e.on("connect",()=>this.emit("connect")),this.#e.on("end",()=>this.emit("end")),this.#e.on("error",e=>this.emit("error",e)),this.#e.on("status_change",(e,t)=>this.emit("status_change",e,t)),this.#t.on("iac",(e,t)=>this.emit("iac",e,t)),this.#t.on("sb",e=>this.emit("sb",e)),this.#t.on("data",e=>this.emit("data",e)),this.#t.on("drain",()=>this.emit("drain")),this.#r=setTimeout(()=>{this.#r=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)},5e3)}connect(){return this.#e.connect()}async send(e){return this.#e.send(e)}destroy(){this.#e.destroy(),void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this.#t.removeAllListeners(),this.#t.destroy()}}t.TelnetHelper=s;class a extends n.Transform{#i;#n;#o;constructor(e){super(e),this.#i=Buffer.alloc(0),this.#n=Buffer.alloc(0),this.#o=0}_transform(e,t,r){for(let t=0;t<e.length;++t)this.#s(e[t]);const i=this.#a();i.length&&this.push(i),r()}#s(e){if(0===this.#o){if(255===e)return void(this.#o=255);this.#i=Buffer.concat([this.#i,Buffer.from([e])])}else if(255===this.#o)switch(e){case 250:case 251:case 252:case 253:case 254:this.#o=e;break;default:this.#o=0}else{if(this.#o>=251&&this.#o<=254){let t;switch(this.#o){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#o=0)}if(250===this.#o){if(240===e)return this.emit("sb",this.#n),this.#o=0,void(this.#n=Buffer.alloc(0));this.#n=Buffer.concat([this.#n,Buffer.from([e])])}}}#a(){const e=this.#i;return this.#i=Buffer.alloc(0),e}}},1123:e=>{"use strict";const t=/^[0-9]+$/,r=(e,r)=>{if("number"==typeof e&&"number"==typeof r)return e===r?0:e<r?-1:1;const i=t.test(e),n=t.test(r);return i&&n&&(e=+e,r=+r),e===r?0:i&&!n?-1:n&&!i?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},1158:(e,t,r)=>{"use strict";const i=r(5424),n=r(9814),o={left:"low",top:"low",low:"low",center:"centre",centre:"centre",right:"high",bottom:"high",high:"high"},s=["failOn","limitInputPixels","unlimited","animated","autoOrient","density","ignoreIcc","page","pages","sequentialRead","jp2","openSlide","pdf","raw","svg","tiff","failOnError","openSlideLevel","pdfBackground","tiffSubifd"];function a(e){const t=s.filter(t=>i.defined(e[t])).map(t=>[t,e[t]]);return t.length?Object.fromEntries(t):void 0}function l(e,t,r){const n={autoOrient:!1,failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(i.string(e))n.file=e;else if(i.buffer(e)){if(0===e.length)throw Error("Input Buffer is empty");n.buffer=e}else if(i.arrayBuffer(e)){if(0===e.byteLength)throw Error("Input bit Array is empty");n.buffer=Buffer.from(e,0,e.byteLength)}else if(i.typedArray(e)){if(0===e.length)throw Error("Input Bit Array is empty");n.buffer=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}else if(i.plainObject(e)&&!i.defined(t))a(t=e)&&(n.buffer=[]);else if(!i.defined(e)&&!i.defined(t)&&i.object(r)&&r.allowStream)n.buffer=[];else{if(!Array.isArray(e))throw new Error(`Unsupported input '${e}' of type ${typeof e}${i.defined(t)?" when also providing options of type "+typeof t:""}`);if(!(e.length>1))throw new Error("Expected at least two images to join");if(this.options.joining)throw new Error("Recursive join is unsupported");this.options.joining=!0,this.options.join=e.map(e=>this._createInputDescriptor(e))}if(i.object(t)){if(i.defined(t.failOnError)){if(!i.bool(t.failOnError))throw i.invalidParameterError("failOnError","boolean",t.failOnError);n.failOn=t.failOnError?"warning":"none"}if(i.defined(t.failOn)){if(!i.string(t.failOn)||!i.inArray(t.failOn,["none","truncated","error","warning"]))throw i.invalidParameterError("failOn","one of: none, truncated, error, warning",t.failOn);n.failOn=t.failOn}if(i.defined(t.autoOrient)){if(!i.bool(t.autoOrient))throw i.invalidParameterError("autoOrient","boolean",t.autoOrient);n.autoOrient=t.autoOrient}if(i.defined(t.density)){if(!i.inRange(t.density,1,1e5))throw i.invalidParameterError("density","number between 1 and 100000",t.density);n.density=t.density}if(i.defined(t.ignoreIcc)){if(!i.bool(t.ignoreIcc))throw i.invalidParameterError("ignoreIcc","boolean",t.ignoreIcc);n.ignoreIcc=t.ignoreIcc}if(i.defined(t.limitInputPixels))if(i.bool(t.limitInputPixels))n.limitInputPixels=t.limitInputPixels?Math.pow(16383,2):0;else{if(!i.integer(t.limitInputPixels)||!i.inRange(t.limitInputPixels,0,Number.MAX_SAFE_INTEGER))throw i.invalidParameterError("limitInputPixels","positive integer",t.limitInputPixels);n.limitInputPixels=t.limitInputPixels}if(i.defined(t.unlimited)){if(!i.bool(t.unlimited))throw i.invalidParameterError("unlimited","boolean",t.unlimited);n.unlimited=t.unlimited}if(i.defined(t.sequentialRead)){if(!i.bool(t.sequentialRead))throw i.invalidParameterError("sequentialRead","boolean",t.sequentialRead);n.sequentialRead=t.sequentialRead}if(i.defined(t.raw)){if(!(i.object(t.raw)&&i.integer(t.raw.width)&&t.raw.width>0&&i.integer(t.raw.height)&&t.raw.height>0&&i.integer(t.raw.channels)&&i.inRange(t.raw.channels,1,4)))throw new Error("Expected width, height and channels for raw pixel input");switch(n.rawWidth=t.raw.width,n.rawHeight=t.raw.height,n.rawChannels=t.raw.channels,e.constructor){case Uint8Array:case Uint8ClampedArray:n.rawDepth="uchar";break;case Int8Array:n.rawDepth="char";break;case Uint16Array:n.rawDepth="ushort";break;case Int16Array:n.rawDepth="short";break;case Uint32Array:n.rawDepth="uint";break;case Int32Array:n.rawDepth="int";break;case Float32Array:n.rawDepth="float";break;case Float64Array:n.rawDepth="double";break;default:n.rawDepth="uchar"}if(n.rawPremultiplied=!1,i.defined(t.raw.premultiplied)){if(!i.bool(t.raw.premultiplied))throw i.invalidParameterError("raw.premultiplied","boolean",t.raw.premultiplied);n.rawPremultiplied=t.raw.premultiplied}if(n.rawPageHeight=0,i.defined(t.raw.pageHeight)){if(!(i.integer(t.raw.pageHeight)&&t.raw.pageHeight>0&&t.raw.pageHeight<=t.raw.height))throw i.invalidParameterError("raw.pageHeight","positive integer",t.raw.pageHeight);if(t.raw.height%t.raw.pageHeight!==0)throw new Error(`Expected raw.height ${t.raw.height} to be a multiple of raw.pageHeight ${t.raw.pageHeight}`);n.rawPageHeight=t.raw.pageHeight}}if(i.defined(t.animated)){if(!i.bool(t.animated))throw i.invalidParameterError("animated","boolean",t.animated);n.pages=t.animated?-1:1}if(i.defined(t.pages)){if(!i.integer(t.pages)||!i.inRange(t.pages,-1,1e5))throw i.invalidParameterError("pages","integer between -1 and 100000",t.pages);n.pages=t.pages}if(i.defined(t.page)){if(!i.integer(t.page)||!i.inRange(t.page,0,1e5))throw i.invalidParameterError("page","integer between 0 and 100000",t.page);n.page=t.page}if(i.object(t.openSlide)&&i.defined(t.openSlide.level)){if(!i.integer(t.openSlide.level)||!i.inRange(t.openSlide.level,0,256))throw i.invalidParameterError("openSlide.level","integer between 0 and 256",t.openSlide.level);n.openSlideLevel=t.openSlide.level}else if(i.defined(t.level)){if(!i.integer(t.level)||!i.inRange(t.level,0,256))throw i.invalidParameterError("level","integer between 0 and 256",t.level);n.openSlideLevel=t.level}if(i.object(t.tiff)&&i.defined(t.tiff.subifd)){if(!i.integer(t.tiff.subifd)||!i.inRange(t.tiff.subifd,-1,1e5))throw i.invalidParameterError("tiff.subifd","integer between -1 and 100000",t.tiff.subifd);n.tiffSubifd=t.tiff.subifd}else if(i.defined(t.subifd)){if(!i.integer(t.subifd)||!i.inRange(t.subifd,-1,1e5))throw i.invalidParameterError("subifd","integer between -1 and 100000",t.subifd);n.tiffSubifd=t.subifd}if(i.object(t.svg)){if(i.defined(t.svg.stylesheet)){if(!i.string(t.svg.stylesheet))throw i.invalidParameterError("svg.stylesheet","string",t.svg.stylesheet);n.svgStylesheet=t.svg.stylesheet}if(i.defined(t.svg.highBitdepth)){if(!i.bool(t.svg.highBitdepth))throw i.invalidParameterError("svg.highBitdepth","boolean",t.svg.highBitdepth);n.svgHighBitdepth=t.svg.highBitdepth}}if(i.object(t.pdf)&&i.defined(t.pdf.background)?n.pdfBackground=this._getBackgroundColourOption(t.pdf.background):i.defined(t.pdfBackground)&&(n.pdfBackground=this._getBackgroundColourOption(t.pdfBackground)),i.object(t.jp2)&&i.defined(t.jp2.oneshot)){if(!i.bool(t.jp2.oneshot))throw i.invalidParameterError("jp2.oneshot","boolean",t.jp2.oneshot);n.jp2Oneshot=t.jp2.oneshot}if(i.defined(t.create)){if(!(i.object(t.create)&&i.integer(t.create.width)&&t.create.width>0&&i.integer(t.create.height)&&t.create.height>0&&i.integer(t.create.channels)))throw new Error("Expected valid width, height and channels to create a new input image");if(n.createWidth=t.create.width,n.createHeight=t.create.height,n.createChannels=t.create.channels,n.createPageHeight=0,i.defined(t.create.pageHeight)){if(!(i.integer(t.create.pageHeight)&&t.create.pageHeight>0&&t.create.pageHeight<=t.create.height))throw i.invalidParameterError("create.pageHeight","positive integer",t.create.pageHeight);if(t.create.height%t.create.pageHeight!==0)throw new Error(`Expected create.height ${t.create.height} to be a multiple of create.pageHeight ${t.create.pageHeight}`);n.createPageHeight=t.create.pageHeight}if(i.defined(t.create.noise)){if(!i.object(t.create.noise))throw new Error("Expected noise to be an object");if("gaussian"!==t.create.noise.type)throw new Error("Only gaussian noise is supported at the moment");if(n.createNoiseType=t.create.noise.type,!i.inRange(t.create.channels,1,4))throw i.invalidParameterError("create.channels","number between 1 and 4",t.create.channels);if(n.createNoiseMean=128,i.defined(t.create.noise.mean)){if(!i.number(t.create.noise.mean)||!i.inRange(t.create.noise.mean,0,1e4))throw i.invalidParameterError("create.noise.mean","number between 0 and 10000",t.create.noise.mean);n.createNoiseMean=t.create.noise.mean}if(n.createNoiseSigma=30,i.defined(t.create.noise.sigma)){if(!i.number(t.create.noise.sigma)||!i.inRange(t.create.noise.sigma,0,1e4))throw i.invalidParameterError("create.noise.sigma","number between 0 and 10000",t.create.noise.sigma);n.createNoiseSigma=t.create.noise.sigma}}else{if(!i.defined(t.create.background))throw new Error("Expected valid noise or background to create a new input image");if(!i.inRange(t.create.channels,3,4))throw i.invalidParameterError("create.channels","number between 3 and 4",t.create.channels);n.createBackground=this._getBackgroundColourOption(t.create.background)}delete n.buffer}if(i.defined(t.text)){if(!i.object(t.text)||!i.string(t.text.text))throw new Error("Expected a valid string to create an image with text.");if(n.textValue=t.text.text,i.defined(t.text.height)&&i.defined(t.text.dpi))throw new Error("Expected only one of dpi or height");if(i.defined(t.text.font)){if(!i.string(t.text.font))throw i.invalidParameterError("text.font","string",t.text.font);n.textFont=t.text.font}if(i.defined(t.text.fontfile)){if(!i.string(t.text.fontfile))throw i.invalidParameterError("text.fontfile","string",t.text.fontfile);n.textFontfile=t.text.fontfile}if(i.defined(t.text.width)){if(!(i.integer(t.text.width)&&t.text.width>0))throw i.invalidParameterError("text.width","positive integer",t.text.width);n.textWidth=t.text.width}if(i.defined(t.text.height)){if(!(i.integer(t.text.height)&&t.text.height>0))throw i.invalidParameterError("text.height","positive integer",t.text.height);n.textHeight=t.text.height}if(i.defined(t.text.align)){if(!i.string(t.text.align)||!i.string(this.constructor.align[t.text.align]))throw i.invalidParameterError("text.align","valid alignment",t.text.align);n.textAlign=this.constructor.align[t.text.align]}if(i.defined(t.text.justify)){if(!i.bool(t.text.justify))throw i.invalidParameterError("text.justify","boolean",t.text.justify);n.textJustify=t.text.justify}if(i.defined(t.text.dpi)){if(!i.integer(t.text.dpi)||!i.inRange(t.text.dpi,1,1e6))throw i.invalidParameterError("text.dpi","integer between 1 and 1000000",t.text.dpi);n.textDpi=t.text.dpi}if(i.defined(t.text.rgba)){if(!i.bool(t.text.rgba))throw i.invalidParameterError("text.rgba","bool",t.text.rgba);n.textRgba=t.text.rgba}if(i.defined(t.text.spacing)){if(!i.integer(t.text.spacing)||!i.inRange(t.text.spacing,-1e6,1e6))throw i.invalidParameterError("text.spacing","integer between -1000000 and 1000000",t.text.spacing);n.textSpacing=t.text.spacing}if(i.defined(t.text.wrap)){if(!i.string(t.text.wrap)||!i.inArray(t.text.wrap,["word","char","word-char","none"]))throw i.invalidParameterError("text.wrap","one of: word, char, word-char, none",t.text.wrap);n.textWrap=t.text.wrap}delete n.buffer}if(i.defined(t.join)){if(!i.defined(this.options.join))throw new Error("Expected input to be an array of images to join");if(i.defined(t.join.animated)){if(!i.bool(t.join.animated))throw i.invalidParameterError("join.animated","boolean",t.join.animated);n.joinAnimated=t.join.animated}if(i.defined(t.join.across)){if(!i.integer(t.join.across)||!i.inRange(t.join.across,1,1e6))throw i.invalidParameterError("join.across","integer between 1 and 100000",t.join.across);n.joinAcross=t.join.across}if(i.defined(t.join.shim)){if(!i.integer(t.join.shim)||!i.inRange(t.join.shim,0,1e6))throw i.invalidParameterError("join.shim","integer between 0 and 100000",t.join.shim);n.joinShim=t.join.shim}if(i.defined(t.join.background)&&(n.joinBackground=this._getBackgroundColourOption(t.join.background)),i.defined(t.join.halign)){if(!i.string(t.join.halign)||!i.string(this.constructor.align[t.join.halign]))throw i.invalidParameterError("join.halign","valid alignment",t.join.halign);n.joinHalign=this.constructor.align[t.join.halign]}if(i.defined(t.join.valign)){if(!i.string(t.join.valign)||!i.string(this.constructor.align[t.join.valign]))throw i.invalidParameterError("join.valign","valid alignment",t.join.valign);n.joinValign=this.constructor.align[t.join.valign]}}}else if(i.defined(t))throw new Error("Invalid input options "+t);return n}function c(e,t,r){Array.isArray(this.options.input.buffer)?i.buffer(e)?(0===this.options.input.buffer.length&&this.on("finish",()=>{this.streamInFinished=!0}),this.options.input.buffer.push(e),r()):r(new Error("Non-Buffer data on Writable Stream")):r(new Error("Unexpected data on Writable Stream"))}function u(){this._isStreamInput()&&(this.options.input.buffer=Buffer.concat(this.options.input.buffer))}function d(){return Array.isArray(this.options.input.buffer)}function p(e){const t=Error();return i.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),n.metadata(this.options,(r,n)=>{r?e(i.nativeError(r,t)):e(null,n)})}):n.metadata(this.options,(r,n)=>{r?e(i.nativeError(r,t)):e(null,n)}),this):this._isStreamInput()?new Promise((e,r)=>{const o=()=>{this._flattenBufferIn(),n.metadata(this.options,(n,o)=>{n?r(i.nativeError(n,t)):e(o)})};this.writableFinished?o():this.once("finish",o)}):new Promise((e,r)=>{n.metadata(this.options,(n,o)=>{n?r(i.nativeError(n,t)):e(o)})})}function h(e){const t=Error();return i.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),n.stats(this.options,(r,n)=>{r?e(i.nativeError(r,t)):e(null,n)})}):n.stats(this.options,(r,n)=>{r?e(i.nativeError(r,t)):e(null,n)}),this):this._isStreamInput()?new Promise((e,r)=>{this.on("finish",function(){this._flattenBufferIn(),n.stats(this.options,(n,o)=>{n?r(i.nativeError(n,t)):e(o)})})}):new Promise((e,r)=>{n.stats(this.options,(n,o)=>{n?r(i.nativeError(n,t)):e(o)})})}e.exports=function(e){Object.assign(e.prototype,{_inputOptionsFromObject:a,_createInputDescriptor:l,_write:c,_flattenBufferIn:u,_isStreamInput:d,metadata:p,stats:h}),e.align=o}},1271:(e,t,r)=>{e.exports=r(6530).default},1313:(e,t,r)=>{"use strict";const{spawnSync:i}=r(1421),{createHash:n}=r(7598),o=r(6170),s=r(4089),a=r(7638),l=r(4647),{config:c,engines:u,optionalDependencies:d}=r(7816),p=process.env.npm_package_config_libvips||c.libvips,h=o(p).version,f={encoding:"utf8",shell:!0},m=()=>l.isNonGlibcLinuxSync()?l.familySync():"",g=()=>{if(b())return"wasm32";const{npm_config_arch:e,npm_config_platform:t,npm_config_libc:r}=process.env,i="string"==typeof r?r:m();return`${t||process.platform}${i}-${e||process.arch}`},b=()=>{const{CC:e}=process.env;return Boolean(e&&e.endsWith("/emcc"))},y=e=>n("sha512").update(e).digest("hex"),v=()=>"win32"!==process.platform?(i("pkg-config --modversion vips-cpp",{...f,env:{...process.env,PKG_CONFIG_PATH:w()}}).stdout||"").trim():"",w=()=>"win32"!==process.platform?[(i('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',f).stdout||"").trim(),process.env.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":"):"",E=(e,t,r)=>(r&&r(`Detected ${t}, skipping search for globally-installed libvips`),e);e.exports={minimumLibvipsVersion:h,prebuiltPlatforms:["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-ppc64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-arm64","win32-ia32","win32-x64"],buildPlatformArch:g,buildSharpLibvipsIncludeDir:()=>{try{return r(1650)(`./sharp-libvips-dev-${g()}/include`)}catch{try{return r(Object(function(){var e=new Error("Cannot find module '@img/sharp-libvips-dev/include'");throw e.code="MODULE_NOT_FOUND",e}()))}catch{}}return""},buildSharpLibvipsCPlusPlusDir:()=>{try{return r(Object(function(){var e=new Error("Cannot find module '@img/sharp-libvips-dev/cplusplus'");throw e.code="MODULE_NOT_FOUND",e}()))}catch{}return""},buildSharpLibvipsLibDir:()=>{try{return r(5035)(`./sharp-libvips-dev-${g()}/lib`)}catch{try{return r(3527)(`./sharp-libvips-${g()}/lib`)}catch{}}return""},isUnsupportedNodeRuntime:()=>{if("node"===process.release?.name&&process.versions&&!a(process.versions.node,u.node))return{found:process.versions.node,expected:u.node}},runtimePlatformArch:()=>`${process.platform}${m()}-${process.arch}`,log:e=>{e instanceof Error?console.error(`sharp: Installation error: ${e.message}`):console.log(`sharp: ${e}`)},yarnLocator:()=>{try{const e=y(`imgsharp-libvips-${g()}`),t=o(d[`@img/sharp-libvips-${g()}`],{includePrerelease:!0}).version;return y(`${e}npm:${t}`).slice(0,10)}catch{}return""},spawnRebuild:()=>i("node-gyp rebuild --directory=src "+(b()?"--nodedir=emscripten":""),{...f,stdio:"inherit"}).status,globalLibvipsVersion:v,pkgConfigPath:w,useGlobalLibvips:e=>{if(!0===Boolean(process.env.SHARP_IGNORE_GLOBAL_LIBVIPS))return E(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS",e);if(!0===Boolean(process.env.SHARP_FORCE_GLOBAL_LIBVIPS))return E(!0,"SHARP_FORCE_GLOBAL_LIBVIPS",e);if("darwin"===process.platform&&"x64"===process.arch&&"sysctl.proc_translated: 1"===(i("sysctl sysctl.proc_translated",f).stdout||"").trim())return E(!1,"Rosetta",e);const t=v();return!!t&&s(t,h)}}},1400:(e,t)=>{"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(r||(t.InstanceStatus=r={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(i||(t.Regex=i={}))},1421:e=>{"use strict";e.exports=require("node:child_process")},1632:(e,t,r)=>{const{combineRgb:i}=r(6278);e.exports={initPresets:function(){let e=this,t=[];const r=i(255,255,255),n=i(0,0,0),o=i(255,0,0),s=i(0,255,0);if(t=[{category:"General",type:"button",name:"Set Converter Mode to Encoder",style:{text:"Encoder",size:"18",color:r,bgcolor:n},steps:[{down:[{actionId:"modeSwitch",options:{mode:"encoder"}}],up:[]}],feedbacks:[{feedbackId:"mode",options:{mode:"encoder"},style:{color:r,bgcolor:o}}]},{category:"General",type:"button",name:"Set Converter Mode to Decoder",style:{text:"Decoder",size:"18",color:r,bgcolor:n},steps:[{down:[{actionId:"modeSwitch",options:{mode:"decoder"}}],up:[]}],feedbacks:[{feedbackId:"mode",options:{mode:"decoder"},style:{color:r,bgcolor:o}}]},{category:"General",type:"button",name:"Toggle Converter Mode",style:{text:"Toggle Mode",size:"18",color:r,bgcolor:n},steps:[{down:[{actionId:"toggleMode"}],up:[]}]},{category:"General",type:"button",name:"Display Current Mode",style:{text:"Mode:\\n$(kiloview:mode)",size:"auto",color:r,bgcolor:n},steps:[],feedbacks:[]}],"encoder"==e.STATE.mode)t.push({category:"Encoder",type:"button",name:"Encoder status",style:{text:"Online\\n$(kiloview:video_signal)",size:"auto",color:r,bgcolor:n},steps:[],feedbacks:[{feedbackId:"video_signal",options:{compare:"online"},style:{color:r,bgcolor:s}},{feedbackId:"video_signal",options:{compare:"offline"},style:{color:r,bgcolor:o}}]});else{t.push({category:"Decoder",type:"button",name:"Online State",style:{text:"$(kiloview:online_state)",size:"auto",color:r,bgcolor:n},steps:[],feedbacks:[{feedbackId:"online",options:{compare:"online"},style:{color:r,bgcolor:s}},{feedbackId:"online",options:{compare:"offline"},style:{color:r,bgcolor:o}}]});for(let i=1;i<=e.CHOICES_PRESETS.length;i++)t.push({category:"Decoder",type:"button",name:"Go to Preset "+i,style:{text:`$(kiloview:preset${i}_channel_name)`,size:"14",color:r,bgcolor:n},steps:[{down:[{actionId:"setPreset",options:{preset:String(i)}}],up:[]}],feedbacks:[{feedbackId:"preset_current",options:{preset:String(i),compare:!0},style:{color:r,bgcolor:o}}]})}t.push({category:"General",type:"button",name:"Encoder/Decoder Resolution",style:{text:"$(kiloview:resolution)",size:"auto",color:r,bgcolor:n},steps:[],feedbacks:[]}),t.push({category:"General",type:"button",name:"Encoder/Decoder Bitrate",style:{text:"$(kiloview:bitrate)",size:"auto",color:r,bgcolor:n},steps:[],feedbacks:[]}),e.setPresetDefinitions(t)}}},1635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>M,__assign:()=>o,__asyncDelegator:()=>_,__asyncGenerator:()=>S,__asyncValues:()=>O,__await:()=>I,__awaiter:()=>f,__classPrivateFieldGet:()=>N,__classPrivateFieldIn:()=>R,__classPrivateFieldSet:()=>T,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>L,__esDecorate:()=>c,__exportStar:()=>b,__extends:()=>n,__generator:()=>m,__importDefault:()=>C,__importStar:()=>j,__makeTemplateObject:()=>k,__metadata:()=>h,__param:()=>l,__propKey:()=>d,__read:()=>v,__rest:()=>s,__rewriteRelativeImportExtension:()=>D,__runInitializers:()=>u,__setFunctionName:()=>p,__spread:()=>w,__spreadArray:()=>P,__spreadArrays:()=>E,__values:()=>y,default:()=>F});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},o.apply(this,arguments)};function s(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}function a(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function l(e,t){return function(r,i){t(r,i,e)}}function c(e,t,r,i,n,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,l=i.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?i.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,i.name):{}),p=!1,h=r.length-1;h>=0;h--){var f={};for(var m in i)f[m]="access"===m?{}:i[m];for(var m in i.access)f.access[m]=i.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var g=(0,r[h])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=s(g.get))&&(d.get=a),(a=s(g.set))&&(d.set=a),(a=s(g.init))&&n.unshift(a)}else(a=s(g))&&("field"===l?n.unshift(a):d[c]=a)}u&&Object.defineProperty(u,i.name,d),p=!0}function u(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,i){return new(r||(r=Promise))(function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})}function m(e,t){var r,i,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((n=(n=o.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}var g=Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};function b(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function E(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i}function P(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function I(e){return this instanceof I?(this.v=e,this):new I(e)}function S(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),o=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),i[Symbol.asyncIterator]=function(){return this},i;function s(e,t){n[e]&&(i[e]=function(t){return new Promise(function(r,i){o.push([e,t,r,i])>1||a(e,t)})},t&&(i[e]=t(i[e])))}function a(e,t){try{(r=n[e](t)).value instanceof I?Promise.resolve(r.value.v).then(l,c):u(o[0][2],r)}catch(e){u(o[0][3],e)}var r}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function _(e){var t,r;return t={},i("next"),i("throw",function(e){throw e}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:I(e[i](t)),done:!1}:n?n(t):t}:n}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise(function(i,n){!function(e,t,r,i){Promise.resolve(i).then(function(t){e({value:t,done:r})},t)}(i,n,(t=e[r](t)).done,t.value)})}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},A=function(e){return A=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},A(e)};function j(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=A(e),i=0;i<r.length;i++)"default"!==r[i]&&g(t,e,r[i]);return x(t,e),t}function C(e){return e&&e.__esModule?e:{default:e}}function N(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function T(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function M(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],r&&(n=i)}if("function"!=typeof i)throw new TypeError("Object not disposable.");n&&(i=function(){try{n.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t}var $="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function L(e){function t(t){e.error=e.hasError?new $(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,i=0;return function n(){for(;r=e.stack.pop();)try{if(!r.async&&1===i)return i=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var o=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(o).then(n,function(e){return t(e),n()})}else i|=1}catch(e){t(e)}if(1===i)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function D(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,i,n,o){return r?t?".jsx":".js":!i||n&&o?i+n+"."+o.toLowerCase()+"js":e}):e}const F={__extends:n,__assign:o,__rest:s,__decorate:a,__param:l,__esDecorate:c,__runInitializers:u,__propKey:d,__setFunctionName:p,__metadata:h,__awaiter:f,__generator:m,__createBinding:g,__exportStar:b,__values:y,__read:v,__spread:w,__spreadArrays:E,__spreadArray:P,__await:I,__asyncGenerator:S,__asyncDelegator:_,__asyncValues:O,__makeTemplateObject:k,__importStar:j,__importDefault:C,__classPrivateFieldGet:N,__classPrivateFieldSet:T,__classPrivateFieldIn:R,__addDisposableResource:M,__disposeResources:L,__rewriteRelativeImportExtension:D}},1649:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const i=r(1635),n=r(360),o=i.__importDefault(r(3290)),s=r(2593),a=r(1706),l=r(8039),c=r(4044),u=r(4289),d=r(2365);t.InstanceBase=class{#l;#c;id;#u=new o.default({concurrency:1});#d=!1;#p=!1;#h={};#f={};#m;#g;#b=new Map;#y=new Map;#v=new Map;#w;#E;get instanceOptions(){return this.#w}get label(){return this.#E}constructor(e){if(!(0,s.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#w={disableVariableValidation:!1},this.#l=new c.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),upgradeActionsAndFeedbacks:this._handleUpgradeActionsAndFeedbacks.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:async()=>{},sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},e=>{process.send(e)},5e3),process.on("message",e=>{this.#l.receivedMessage(e)});const t=async e=>e.text.includes("$(")?this.#l.sendWithCb("parseVariablesInString",e):{text:e.text,variableIds:void 0};this.#m=new u.ActionManager(t,e=>this.#l.sendWithNoCb("setActionDefinitions",e),e=>this.#l.sendWithNoCb("setCustomVariable",e),this.log.bind(this)),this.#g=new l.FeedbackManager(t,e=>this.#l.sendWithNoCb("updateFeedbackValues",e),e=>this.#l.sendWithNoCb("setFeedbackDefinitions",e),this.log.bind(this)),this.#c=e.upgradeScripts,this.id=e.id,this.#E=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#u.add(async()=>{if(this.#d)throw new Error("Already initialized");if(this.#h=e.config,this.#f=e.secrets,this.#E=e.label,e.isFirstInit){const t={},r={},i=this.getConfigFields();for(const e of i)"default"in e&&(e.type.startsWith("secret")?r[e.id]=e.default:t[e.id]=e.default);this.#h=t,this.#f=r,this.saveConfig(this.#h,this.#f),e.lastUpgradeIndex=this.#c.length-1}const{updatedConfig:t,updatedSecrets:r}=(0,a.runThroughUpgradeScripts)([],[],e.lastUpgradeIndex,this.#c,this.#h,this.#f,!1);this.#h=t??this.#h,this.#f=r??this.#f;try{await this.init(this.#h,!!e.isFirstInit,this.#f),this.#d=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}return{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#c.length-1,updatedConfig:this.#h,updatedSecrets:this.#f}})}async _handleDestroy(){await this.#u.add(async()=>{if(!this.#d)throw new Error("Not initialized");await this.destroy(),this.#d=!1})}async _handleConfigUpdateAndLabel(e){await this.#u.add(async()=>{if(!this.#d)throw new Error("Not initialized");this.#E=e.label,this.#h=e.config,await this.configUpdated(this.#h,this.#f)})}async _handleExecuteAction(e){return this.#m.handleExecuteAction(e)}async _handleUpdateFeedbacks(e){this.#g.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e){this.#m.handleUpdateActions(e.actions)}async _handleUpgradeActionsAndFeedbacks(e){return(0,a.runThroughUpgradeScripts)(e.actions,e.feedbacks,null,this.#c,this.#h,this.#f,!0)}async _handleGetConfigFields(e){return{fields:(0,s.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#m.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#g.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#p)return}else if(!this.#p)return;if(!this.handleStartStopRecordActions)throw this.#p=!1,new Error("Recording actions is not supported by this module!");this.#p=e.recording,this.handleStartStopRecordActions(this.#p)}async _handleSharedUdpSocketMessage(e){for(const t of this.#b.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#b.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e,t){e&&(this.#h=e),t&&(this.#f=t),this.#l.sendWithNoCb("saveConfig",{config:e,secrets:t})}setActionDefinitions(e){this.#m.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#g.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[r,i]of Object.entries(e))i&&t.push({...i,id:r});this.#l.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],r=[];this.#y.clear();for(const i of e)t.push({id:i.variableId,name:i.name}),this.#y.set(i.variableId,i),this.#v.has(i.variableId)||(this.#v.set(i.variableId,""),r.push({id:i.variableId,value:""}));if(!this.#w.disableVariableValidation){const e=new Set(this.#y.keys());for(const t of this.#v.keys())e.has(t)||(this.#v.delete(t),r.push({id:t,value:void 0}))}this.#l.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:r})}setVariableValues(e){const t=[];for(const[r,i]of Object.entries(e))this.#w.disableVariableValidation?(void 0===i?this.#v.delete(r):this.#v.set(r,i),t.push({id:r,value:i})):this.#y.has(r)?(this.#v.set(r,i??""),t.push({id:r,value:i??""})):t.push({id:r,value:void 0});this.#l.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#v.get(e)}async parseVariablesInString(e){const t=this.#g.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),e.includes("$(")?(await this.#l.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text:e}checkFeedbacks(...e){this.#g.checkFeedbacks(e)}checkFeedbacksById(...e){this.#g.checkFeedbacksById(e)}subscribeActions(...e){this.#m.subscribeActions(e)}unsubscribeActions(...e){this.#m.unsubscribeActions(e)}subscribeFeedbacks(...e){this.#g.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#g.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#p)throw new Error("Not currently recording actions");this.#l.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}oscSend(e,t,r,i){this.#l.sendWithNoCb("send-osc",(0,n.literal)({host:e,port:t,path:r,args:i}))}updateStatus(e,t){this.#l.sendWithNoCb("set-status",(0,n.literal)({status:e,message:t??null}))}log(e,t){this.#l.sendWithNoCb("log-message",(0,n.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const r="string"==typeof e?{type:e}:e,i=new d.SharedUdpSocketImpl(this.#l,this.#b,r);return t&&i.on("message",t),i}}},1650:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=1650,e.exports=t},1706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=function(e,t,r,o,s,a,l){const c=new Map,u=e=>{let t=c.get(e);return t||(t={actions:[],feedbacks:[],config:!1},c.set(e,t)),t};for(const t of e){const e=t?.upgradeIndex??r;t&&"number"==typeof e&&u(e).actions.push(t.id)}for(const e of t){const t=e?.upgradeIndex??r;e&&"number"==typeof t&&u(t).feedbacks.push(e.id)}if(!l)for(let e=r??-1;e<o.length;e++)u(e).config=!0;const d=Object.fromEntries(e.map(e=>[e.id,e])),p=Object.fromEntries(t.map(e=>[e.id,e])),h={},f={};let m,g;if(c.size>0){const e=Array.from(c.keys()).sort(),t=Math.min(...e,r??-1)+1,l=[],u=[],b=o.length;for(let e=t;e<b;e++){const t=c.get(e-1);t&&(l.push(...t.actions),u.push(...t.feedbacks));const r=!!t?.config;if(!r&&0===l.length&&0===u.length)continue;const b=m??s,y=g??a,v=(0,o[e])({currentConfig:n(b)},{config:r?b:null,secrets:r?y:null,actions:l.map(e=>{const t=d[e];if(t)return(0,i.literal)({id:t.id,controlId:t.controlId,actionId:t.actionId,options:void 0!==t.options?n(t.options):{}})}).filter(e=>!!e),feedbacks:u.map(e=>{const t=p[e];if(t)return(0,i.literal)({id:t.id,controlId:t.controlId,feedbackId:t.feedbackId,options:void 0!==t.options?n(t.options):{},isInverted:t.isInverted})}).filter(e=>!!e)});r&&v.updatedConfig&&(m=v.updatedConfig),r&&v.updatedSecrets&&(g=v.updatedSecrets);for(const t of v.updatedActions)if(t){const r=d[t.id];r&&(r.actionId=t.actionId,r.options=t.options,r.upgradeIndex=e,f[t.id]=r)}for(const t of v.updatedFeedbacks)if(t){const r=p[t.id];r&&(r.feedbackId=t.feedbackId,r.options=t.options,r.upgradeIndex=e,h[t.id]={...r,style:h[t.id]?.style??t.style,isInverted:t.isInverted??!1})}}for(const[e,t]of Object.entries(d))f[e]||"number"!=typeof t?.upgradeIndex||(f[e]=t);for(const[e,t]of Object.entries(p))h[e]||"number"!=typeof t?.upgradeIndex||(h[e]=t)}return{updatedActions:Object.values(f),updatedFeedbacks:Object.values(h),updatedConfig:m,updatedSecrets:g,latestUpgradeIndex:o.length-1}};const i=r(360);function n(e){return JSON.parse(JSON.stringify(e))}},1943:e=>{"use strict";e.exports=require("fs/promises")},2017:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var i,n,o;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(n=i;0!==n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=i;0!==n--;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=i;0!==n--;){var s=o[n];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r}},2018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1635);i.__exportStar(r(3730),t),i.__exportStar(r(1649),t),i.__exportStar(r(7386),t),i.__exportStar(r(1400),t),i.__exportStar(r(8983),t),i.__exportStar(r(8104),t),i.__exportStar(r(3258),t),i.__exportStar(r(131),t),i.__exportStar(r(3371),t),i.__exportStar(r(9786),t),i.__exportStar(r(6132),t)},2111:(e,t,r)=>{"use strict";const i=r(4641),n=r(3999),o=r(5580),s=r(4089),a=r(7059),l=r(5200);e.exports=(e,t,r,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return i(e,r,c);case"!=":return n(e,r,c);case">":return o(e,r,c);case">=":return s(e,r,c);case"<":return a(e,r,c);case"<=":return l(e,r,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},2203:e=>{"use strict";e.exports=require("stream")},2365:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const i=r(1635).__importDefault(r(228)),n=r(360);class o extends i.default{#l;#P;#w;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#o&&"object"==typeof this.#o?this.#o:void 0}#o="pending";constructor(e,t,r){super(),this.#l=e,this.#P=t,this.#w={...r}}bind(e,t,r){if(this.#o&&"object"==typeof this.#o)throw new Error("Socket is already bound");switch(this.#o){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,n.assertNever)(this.#o),new Error("Invalid socket state")}this.#o="binding",r&&this.on("listening",r),this.#l.sendWithCb("sharedUdpSocketJoin",{family:this.#w.type,portNumber:e}).then(t=>{this.#o={portNumber:e,handleId:t},this.#P.set(t,this),this.emit("listening")},e=>{this.#o="closed",this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}close(e){if(this.#o&&"object"==typeof this.#o);else switch(this.#o){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,n.assertNever)(this.#o),new Error("Invalid socket state")}const t=this.#o.handleId;this.#o="closed",e&&this.on("close",e),this.#l.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then(()=>{this.#P.delete(t),this.emit("close")},e=>{this.#P.delete(t),this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}send(e,t,r,i,n,o){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof r){if("number"!=typeof i||"string"!=typeof n)throw new Error("Invalid arguments");if(void 0!==o&&"function"!=typeof o)throw new Error("Invalid arguments");const s=this.#I(e,t,r);this.#S(s,i,n,o)}else{if("string"!=typeof r)throw new Error("Invalid arguments");{if(void 0!==i&&"function"!=typeof i)throw new Error("Invalid arguments");const n=this.#I(e,0,void 0);this.#S(n,t,r,i)}}}#I(e,t,r){let i;if("string"==typeof e)i=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))i=e;else{if(Array.isArray(e))return Buffer.from(e);i=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return i.subarray(t,void 0!==r?r+t:void 0)}#S(e,t,r,i){if(!this.#o||"object"!=typeof this.#o)throw new Error("Socket is not open");this.#l.sendWithCb("sharedUdpSocketSend",{handleId:this.#o.handleId,message:e,address:r,port:t}).then(()=>{i?.()},e=>{this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#o="fatalError";const t=this.boundState;t&&this.#P.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=o},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeIsVisibleFn=function(e){return(e??[]).map(e=>"isVisibleExpression"in e&&"string"==typeof e.isVisibleExpression?{...e,isVisibleFnType:"expression",isVisibleFn:e.isVisibleExpression,isVisible:void 0,isVisibleExpression:void 0}:"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisibleFnType:"function",isVisible:void 0,isVisibleExpression:void 0}:{...e,isVisible:void 0,isVisibleFn:void 0,isVisibleFnType:void 0,isVisibleExpression:void 0})},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},2837:(e,t,r)=>{"use strict";const i=r(6760),n=r(5424),o=r(9814),s=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),a=/\.(jp[2x]|j2[kc])$/i,l=()=>new Error("JP2 output requires libvips with support for OpenJPEG"),c=e=>1<<31-Math.clz32(Math.ceil(Math.log2(e)));function u(e,t){let r;if(n.string(e)?n.string(this.options.input.file)&&i.resolve(this.options.input.file)===i.resolve(e)?r=new Error("Cannot use same file for input and output"):a.test(i.extname(e))&&!this.constructor.format.jp2k.output.file&&(r=l()):r=new Error("Missing output file path"),!r){this.options.fileOut=e;const r=Error();return this._pipeline(t,r)}return n.fn(t)?(t(r),this):Promise.reject(r)}function d(e,t){n.object(e)?this._setBooleanOption("resolveWithObject",e.resolveWithObject):this.options.resolveWithObject&&(this.options.resolveWithObject=!1),this.options.fileOut="";const r=Error();return this._pipeline(n.fn(e)?e:t,r)}function p(){return this.options.keepMetadata|=1,this}function h(e){if(!n.object(e))throw n.invalidParameterError("exif","object",e);for(const[t,r]of Object.entries(e)){if(!n.object(r))throw n.invalidParameterError(t,"object",r);for(const[e,i]of Object.entries(r)){if(!n.string(i))throw n.invalidParameterError(`${t}.${e}`,"string",i);this.options.withExif[`exif-${t.toLowerCase()}-${e}`]=i}}return this.options.withExifMerge=!1,this.keepExif()}function f(e){return this.withExif(e),this.options.withExifMerge=!0,this}function m(){return this.options.keepMetadata|=8,this}function g(e,t){if(!n.string(e))throw n.invalidParameterError("icc","string",e);if(this.options.withIccProfile=e,this.keepIccProfile(),n.object(t)&&n.defined(t.attach)){if(!n.bool(t.attach))throw n.invalidParameterError("attach","boolean",t.attach);t.attach||(this.options.keepMetadata&=-9)}return this}function b(){return this.options.keepMetadata|=2,this}function y(e){if(!(n.string(e)&&e.length>0))throw n.invalidParameterError("xmp","non-empty string",e);return this.options.withXmp=e,this.options.keepMetadata|=2,this}function v(){return this.options.keepMetadata=31,this}function w(e){if(this.keepMetadata(),this.withIccProfile("srgb"),n.object(e)){if(n.defined(e.orientation)){if(!n.integer(e.orientation)||!n.inRange(e.orientation,1,8))throw n.invalidParameterError("orientation","integer between 1 and 8",e.orientation);this.options.withMetadataOrientation=e.orientation}if(n.defined(e.density)){if(!(n.number(e.density)&&e.density>0))throw n.invalidParameterError("density","positive number",e.density);this.options.withMetadataDensity=e.density}n.defined(e.icc)&&this.withIccProfile(e.icc),n.defined(e.exif)&&this.withExifMerge(e.exif)}return this}function E(e,t){const r=s.get((n.object(e)&&n.string(e.id)?e.id:e).toLowerCase());if(!r)throw n.invalidParameterError("format",`one of: ${[...s.keys()].join(", ")}`,e);return this[r](t)}function P(e){if(n.object(e)){if(n.defined(e.quality)){if(!n.integer(e.quality)||!n.inRange(e.quality,1,100))throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.jpegQuality=e.quality}if(n.defined(e.progressive)&&this._setBooleanOption("jpegProgressive",e.progressive),n.defined(e.chromaSubsampling)){if(!n.string(e.chromaSubsampling)||!n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);this.options.jpegChromaSubsampling=e.chromaSubsampling}const t=n.bool(e.optimizeCoding)?e.optimizeCoding:e.optimiseCoding;if(n.defined(t)&&this._setBooleanOption("jpegOptimiseCoding",t),n.defined(e.mozjpeg)){if(!n.bool(e.mozjpeg))throw n.invalidParameterError("mozjpeg","boolean",e.mozjpeg);e.mozjpeg&&(this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3)}const r=n.bool(e.trellisQuantization)?e.trellisQuantization:e.trellisQuantisation;n.defined(r)&&this._setBooleanOption("jpegTrellisQuantisation",r),n.defined(e.overshootDeringing)&&this._setBooleanOption("jpegOvershootDeringing",e.overshootDeringing);const i=n.bool(e.optimizeScans)?e.optimizeScans:e.optimiseScans;n.defined(i)&&(this._setBooleanOption("jpegOptimiseScans",i),i&&(this.options.jpegProgressive=!0));const o=n.number(e.quantizationTable)?e.quantizationTable:e.quantisationTable;if(n.defined(o)){if(!n.integer(o)||!n.inRange(o,0,8))throw n.invalidParameterError("quantisationTable","integer between 0 and 8",o);this.options.jpegQuantisationTable=o}}return this._updateFormatOut("jpeg",e)}function I(e){if(n.object(e)){if(n.defined(e.progressive)&&this._setBooleanOption("pngProgressive",e.progressive),n.defined(e.compressionLevel)){if(!n.integer(e.compressionLevel)||!n.inRange(e.compressionLevel,0,9))throw n.invalidParameterError("compressionLevel","integer between 0 and 9",e.compressionLevel);this.options.pngCompressionLevel=e.compressionLevel}n.defined(e.adaptiveFiltering)&&this._setBooleanOption("pngAdaptiveFiltering",e.adaptiveFiltering);const t=e.colours||e.colors;if(n.defined(t)){if(!n.integer(t)||!n.inRange(t,2,256))throw n.invalidParameterError("colours","integer between 2 and 256",t);this.options.pngBitdepth=c(t)}if(n.defined(e.palette)?this._setBooleanOption("pngPalette",e.palette):[e.quality,e.effort,e.colours,e.colors,e.dither].some(n.defined)&&this._setBooleanOption("pngPalette",!0),this.options.pngPalette){if(n.defined(e.quality)){if(!n.integer(e.quality)||!n.inRange(e.quality,0,100))throw n.invalidParameterError("quality","integer between 0 and 100",e.quality);this.options.pngQuality=e.quality}if(n.defined(e.effort)){if(!n.integer(e.effort)||!n.inRange(e.effort,1,10))throw n.invalidParameterError("effort","integer between 1 and 10",e.effort);this.options.pngEffort=e.effort}if(n.defined(e.dither)){if(!n.number(e.dither)||!n.inRange(e.dither,0,1))throw n.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);this.options.pngDither=e.dither}}}return this._updateFormatOut("png",e)}function S(e){if(n.object(e)){if(n.defined(e.quality)){if(!n.integer(e.quality)||!n.inRange(e.quality,1,100))throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.webpQuality=e.quality}if(n.defined(e.alphaQuality)){if(!n.integer(e.alphaQuality)||!n.inRange(e.alphaQuality,0,100))throw n.invalidParameterError("alphaQuality","integer between 0 and 100",e.alphaQuality);this.options.webpAlphaQuality=e.alphaQuality}if(n.defined(e.lossless)&&this._setBooleanOption("webpLossless",e.lossless),n.defined(e.nearLossless)&&this._setBooleanOption("webpNearLossless",e.nearLossless),n.defined(e.smartSubsample)&&this._setBooleanOption("webpSmartSubsample",e.smartSubsample),n.defined(e.smartDeblock)&&this._setBooleanOption("webpSmartDeblock",e.smartDeblock),n.defined(e.preset)){if(!n.string(e.preset)||!n.inArray(e.preset,["default","photo","picture","drawing","icon","text"]))throw n.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",e.preset);this.options.webpPreset=e.preset}if(n.defined(e.effort)){if(!n.integer(e.effort)||!n.inRange(e.effort,0,6))throw n.invalidParameterError("effort","integer between 0 and 6",e.effort);this.options.webpEffort=e.effort}n.defined(e.minSize)&&this._setBooleanOption("webpMinSize",e.minSize),n.defined(e.mixed)&&this._setBooleanOption("webpMixed",e.mixed)}return k(e,this.options),this._updateFormatOut("webp",e)}function _(e){if(n.object(e)){n.defined(e.reuse)&&this._setBooleanOption("gifReuse",e.reuse),n.defined(e.progressive)&&this._setBooleanOption("gifProgressive",e.progressive);const t=e.colours||e.colors;if(n.defined(t)){if(!n.integer(t)||!n.inRange(t,2,256))throw n.invalidParameterError("colours","integer between 2 and 256",t);this.options.gifBitdepth=c(t)}if(n.defined(e.effort)){if(!n.number(e.effort)||!n.inRange(e.effort,1,10))throw n.invalidParameterError("effort","integer between 1 and 10",e.effort);this.options.gifEffort=e.effort}if(n.defined(e.dither)){if(!n.number(e.dither)||!n.inRange(e.dither,0,1))throw n.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);this.options.gifDither=e.dither}if(n.defined(e.interFrameMaxError)){if(!n.number(e.interFrameMaxError)||!n.inRange(e.interFrameMaxError,0,32))throw n.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",e.interFrameMaxError);this.options.gifInterFrameMaxError=e.interFrameMaxError}if(n.defined(e.interPaletteMaxError)){if(!n.number(e.interPaletteMaxError)||!n.inRange(e.interPaletteMaxError,0,256))throw n.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",e.interPaletteMaxError);this.options.gifInterPaletteMaxError=e.interPaletteMaxError}if(n.defined(e.keepDuplicateFrames)){if(!n.bool(e.keepDuplicateFrames))throw n.invalidParameterError("keepDuplicateFrames","boolean",e.keepDuplicateFrames);this._setBooleanOption("gifKeepDuplicateFrames",e.keepDuplicateFrames)}}return k(e,this.options),this._updateFormatOut("gif",e)}function O(e){if(!this.constructor.format.jp2k.output.buffer)throw l();if(n.object(e)){if(n.defined(e.quality)){if(!n.integer(e.quality)||!n.inRange(e.quality,1,100))throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.jp2Quality=e.quality}if(n.defined(e.lossless)){if(!n.bool(e.lossless))throw n.invalidParameterError("lossless","boolean",e.lossless);this.options.jp2Lossless=e.lossless}if(n.defined(e.tileWidth)){if(!n.integer(e.tileWidth)||!n.inRange(e.tileWidth,1,32768))throw n.invalidParameterError("tileWidth","integer between 1 and 32768",e.tileWidth);this.options.jp2TileWidth=e.tileWidth}if(n.defined(e.tileHeight)){if(!n.integer(e.tileHeight)||!n.inRange(e.tileHeight,1,32768))throw n.invalidParameterError("tileHeight","integer between 1 and 32768",e.tileHeight);this.options.jp2TileHeight=e.tileHeight}if(n.defined(e.chromaSubsampling)){if(!n.string(e.chromaSubsampling)||!n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);this.options.jp2ChromaSubsampling=e.chromaSubsampling}}return this._updateFormatOut("jp2",e)}function k(e,t){if(n.object(e)&&n.defined(e.loop)){if(!n.integer(e.loop)||!n.inRange(e.loop,0,65535))throw n.invalidParameterError("loop","integer between 0 and 65535",e.loop);t.loop=e.loop}if(n.object(e)&&n.defined(e.delay))if(n.integer(e.delay)&&n.inRange(e.delay,0,65535))t.delay=[e.delay];else{if(!(Array.isArray(e.delay)&&e.delay.every(n.integer)&&e.delay.every(e=>n.inRange(e,0,65535))))throw n.invalidParameterError("delay","integer or an array of integers between 0 and 65535",e.delay);t.delay=e.delay}}function x(e){if(n.object(e)){if(n.defined(e.quality)){if(!n.integer(e.quality)||!n.inRange(e.quality,1,100))throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.tiffQuality=e.quality}if(n.defined(e.bitdepth)){if(!n.integer(e.bitdepth)||!n.inArray(e.bitdepth,[1,2,4,8]))throw n.invalidParameterError("bitdepth","1, 2, 4 or 8",e.bitdepth);this.options.tiffBitdepth=e.bitdepth}if(n.defined(e.tile)&&this._setBooleanOption("tiffTile",e.tile),n.defined(e.tileWidth)){if(!(n.integer(e.tileWidth)&&e.tileWidth>0))throw n.invalidParameterError("tileWidth","integer greater than zero",e.tileWidth);this.options.tiffTileWidth=e.tileWidth}if(n.defined(e.tileHeight)){if(!(n.integer(e.tileHeight)&&e.tileHeight>0))throw n.invalidParameterError("tileHeight","integer greater than zero",e.tileHeight);this.options.tiffTileHeight=e.tileHeight}if(n.defined(e.miniswhite)&&this._setBooleanOption("tiffMiniswhite",e.miniswhite),n.defined(e.pyramid)&&this._setBooleanOption("tiffPyramid",e.pyramid),n.defined(e.xres)){if(!(n.number(e.xres)&&e.xres>0))throw n.invalidParameterError("xres","number greater than zero",e.xres);this.options.tiffXres=e.xres}if(n.defined(e.yres)){if(!(n.number(e.yres)&&e.yres>0))throw n.invalidParameterError("yres","number greater than zero",e.yres);this.options.tiffYres=e.yres}if(n.defined(e.compression)){if(!n.string(e.compression)||!n.inArray(e.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))throw n.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",e.compression);this.options.tiffCompression=e.compression}if(n.defined(e.predictor)){if(!n.string(e.predictor)||!n.inArray(e.predictor,["none","horizontal","float"]))throw n.invalidParameterError("predictor","one of: none, horizontal, float",e.predictor);this.options.tiffPredictor=e.predictor}if(n.defined(e.resolutionUnit)){if(!n.string(e.resolutionUnit)||!n.inArray(e.resolutionUnit,["inch","cm"]))throw n.invalidParameterError("resolutionUnit","one of: inch, cm",e.resolutionUnit);this.options.tiffResolutionUnit=e.resolutionUnit}}return this._updateFormatOut("tiff",e)}function A(e){return this.heif({...e,compression:"av1"})}function j(e){if(!n.object(e))throw n.invalidParameterError("options","Object",e);if(!n.string(e.compression)||!n.inArray(e.compression,["av1","hevc"]))throw n.invalidParameterError("compression","one of: av1, hevc",e.compression);if(this.options.heifCompression=e.compression,n.defined(e.quality)){if(!n.integer(e.quality)||!n.inRange(e.quality,1,100))throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.heifQuality=e.quality}if(n.defined(e.lossless)){if(!n.bool(e.lossless))throw n.invalidParameterError("lossless","boolean",e.lossless);this.options.heifLossless=e.lossless}if(n.defined(e.effort)){if(!n.integer(e.effort)||!n.inRange(e.effort,0,9))throw n.invalidParameterError("effort","integer between 0 and 9",e.effort);this.options.heifEffort=e.effort}if(n.defined(e.chromaSubsampling)){if(!n.string(e.chromaSubsampling)||!n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);this.options.heifChromaSubsampling=e.chromaSubsampling}if(n.defined(e.bitdepth)){if(!n.integer(e.bitdepth)||!n.inArray(e.bitdepth,[8,10,12]))throw n.invalidParameterError("bitdepth","8, 10 or 12",e.bitdepth);if(8!==e.bitdepth&&this.constructor.versions.heif)throw n.invalidParameterError("bitdepth when using prebuilt binaries",8,e.bitdepth);this.options.heifBitdepth=e.bitdepth}return this._updateFormatOut("heif",e)}function C(e){if(n.object(e)){if(n.defined(e.quality)){if(!n.integer(e.quality)||!n.inRange(e.quality,1,100))throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);this.options.jxlDistance=e.quality>=30?.1+.09*(100-e.quality):53/3e3*e.quality*e.quality-1.15*e.quality+25}else if(n.defined(e.distance)){if(!n.number(e.distance)||!n.inRange(e.distance,0,15))throw n.invalidParameterError("distance","number between 0.0 and 15.0",e.distance);this.options.jxlDistance=e.distance}if(n.defined(e.decodingTier)){if(!n.integer(e.decodingTier)||!n.inRange(e.decodingTier,0,4))throw n.invalidParameterError("decodingTier","integer between 0 and 4",e.decodingTier);this.options.jxlDecodingTier=e.decodingTier}if(n.defined(e.lossless)){if(!n.bool(e.lossless))throw n.invalidParameterError("lossless","boolean",e.lossless);this.options.jxlLossless=e.lossless}if(n.defined(e.effort)){if(!n.integer(e.effort)||!n.inRange(e.effort,1,9))throw n.invalidParameterError("effort","integer between 1 and 9",e.effort);this.options.jxlEffort=e.effort}}return k(e,this.options),this._updateFormatOut("jxl",e)}function N(e){if(n.object(e)&&n.defined(e.depth)){if(!n.string(e.depth)||!n.inArray(e.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))throw n.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",e.depth);this.options.rawDepth=e.depth}return this._updateFormatOut("raw")}function T(e){if(n.object(e)){if(n.defined(e.size)){if(!n.integer(e.size)||!n.inRange(e.size,1,8192))throw n.invalidParameterError("size","integer between 1 and 8192",e.size);this.options.tileSize=e.size}if(n.defined(e.overlap)){if(!n.integer(e.overlap)||!n.inRange(e.overlap,0,8192))throw n.invalidParameterError("overlap","integer between 0 and 8192",e.overlap);if(e.overlap>this.options.tileSize)throw n.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,e.overlap);this.options.tileOverlap=e.overlap}if(n.defined(e.container)){if(!n.string(e.container)||!n.inArray(e.container,["fs","zip"]))throw n.invalidParameterError("container","one of: fs, zip",e.container);this.options.tileContainer=e.container}if(n.defined(e.layout)){if(!n.string(e.layout)||!n.inArray(e.layout,["dz","google","iiif","iiif3","zoomify"]))throw n.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",e.layout);this.options.tileLayout=e.layout}if(n.defined(e.angle)){if(!n.integer(e.angle)||e.angle%90)throw n.invalidParameterError("angle","positive/negative multiple of 90",e.angle);this.options.tileAngle=e.angle}if(this._setBackgroundColourOption("tileBackground",e.background),n.defined(e.depth)){if(!n.string(e.depth)||!n.inArray(e.depth,["onepixel","onetile","one"]))throw n.invalidParameterError("depth","one of: onepixel, onetile, one",e.depth);this.options.tileDepth=e.depth}if(n.defined(e.skipBlanks)){if(!n.integer(e.skipBlanks)||!n.inRange(e.skipBlanks,-1,65535))throw n.invalidParameterError("skipBlanks","integer between -1 and 255/65535",e.skipBlanks);this.options.tileSkipBlanks=e.skipBlanks}else n.defined(e.layout)&&"google"===e.layout&&(this.options.tileSkipBlanks=5);const t=n.bool(e.center)?e.center:e.centre;if(n.defined(t)&&this._setBooleanOption("tileCentre",t),n.defined(e.id)){if(!n.string(e.id))throw n.invalidParameterError("id","string",e.id);this.options.tileId=e.id}if(n.defined(e.basename)){if(!n.string(e.basename))throw n.invalidParameterError("basename","string",e.basename);this.options.tileBasename=e.basename}}if(n.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if("input"!==this.options.formatOut)throw n.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function R(e){if(!n.plainObject(e))throw n.invalidParameterError("options","object",e);if(!n.integer(e.seconds)||!n.inRange(e.seconds,0,3600))throw n.invalidParameterError("seconds","integer between 0 and 3600",e.seconds);return this.options.timeoutSeconds=e.seconds,this}function M(e,t){return n.object(t)&&!1===t.force||(this.options.formatOut=e),this}function $(e,t){if(!n.bool(t))throw n.invalidParameterError(e,"boolean",t);this.options[e]=t}function L(){if(!this.options.streamOut){this.options.streamOut=!0;const e=Error();this._pipeline(void 0,e)}}function D(e,t){return"function"==typeof e?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),o.pipeline(this.options,(r,i,o)=>{r?e(n.nativeError(r,t)):e(null,i,o)})}):o.pipeline(this.options,(r,i,o)=>{r?e(n.nativeError(r,t)):e(null,i,o)}),this):this.options.streamOut?(this._isStreamInput()?(this.once("finish",()=>{this._flattenBufferIn(),o.pipeline(this.options,(e,r,i)=>{e?this.emit("error",n.nativeError(e,t)):(this.emit("info",i),this.push(r)),this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished&&this.emit("finish")):o.pipeline(this.options,(e,r,i)=>{e?this.emit("error",n.nativeError(e,t)):(this.emit("info",i),this.push(r)),this.push(null),this.on("end",()=>this.emit("close"))}),this):this._isStreamInput()?new Promise((e,r)=>{this.once("finish",()=>{this._flattenBufferIn(),o.pipeline(this.options,(i,o,s)=>{i?r(n.nativeError(i,t)):this.options.resolveWithObject?e({data:o,info:s}):e(o)})})}):new Promise((e,r)=>{o.pipeline(this.options,(i,o,s)=>{i?r(n.nativeError(i,t)):this.options.resolveWithObject?e({data:o,info:s}):e(o)})})}e.exports=function(e){Object.assign(e.prototype,{toFile:u,toBuffer:d,keepExif:p,withExif:h,withExifMerge:f,keepIccProfile:m,withIccProfile:g,keepXmp:b,withXmp:y,keepMetadata:v,withMetadata:w,toFormat:E,jpeg:P,jp2:O,png:I,webp:S,tiff:x,avif:A,heif:j,jxl:C,gif:_,raw:N,tile:T,timeout:R,_updateFormatOut:M,_setBooleanOption:$,_read:L,_pipeline:D})}},2926:(e,t,r)=>{"use strict";const i=r(4806);r(1158)(i),r(9212)(i),r(6317)(i),r(6491)(i),r(9684)(i),r(3897)(i),r(2837)(i),r(8398)(i),e.exports=i},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(6368),n=r(6641),o=r(4774),s=()=>{},a=new n.TimeoutError;t.default=class extends i{constructor(e){var t,r,i,n;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=s,this._resolveIdle=s,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(n=null===(i=e.interval)||void 0===i?void 0:i.toString())&&void 0!==n?n:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=s,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=s,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,i)=>{this._queue.enqueue(async()=>{this._pendingCount++,this._intervalCount++;try{const o=void 0===this._timeout&&void 0===t.timeout?e():n.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&i(a)});r(await o)}catch(e){i(e)}this._next()},t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3487:e=>{e.exports=[function(e,t){return{updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}}]},3527:(e,t,r)=>{var i={"./sharp-libvips-linux-x64/lib":6912};function n(e){var t=o(e);return r(t)}function o(e){if(!r.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=3527},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3897:(e,t,r)=>{"use strict";const i=r(5424),n={and:"and",or:"or",eor:"eor"};function o(){return this.options.removeAlpha=!0,this}function s(e){if(i.defined(e)){if(!i.number(e)||!i.inRange(e,0,1))throw i.invalidParameterError("alpha","number between 0 and 1",e);this.options.ensureAlpha=e}else this.options.ensureAlpha=1;return this}function a(e){const t={red:0,green:1,blue:2,alpha:3};if(Object.keys(t).includes(e)&&(e=t[e]),!i.integer(e)||!i.inRange(e,0,4))throw i.invalidParameterError("channel","integer or one of: red, green, blue, alpha",e);return this.options.extractChannel=e,this}function l(e,t){return Array.isArray(e)?e.forEach(function(e){this.options.joinChannelIn.push(this._createInputDescriptor(e,t))},this):this.options.joinChannelIn.push(this._createInputDescriptor(e,t)),this}function c(e){if(!i.string(e)||!i.inArray(e,["and","or","eor"]))throw i.invalidParameterError("boolOp","one of: and, or, eor",e);return this.options.bandBoolOp=e,this}e.exports=function(e){Object.assign(e.prototype,{removeAlpha:o,ensureAlpha:s,extractChannel:a,joinChannel:l,bandbool:c}),e.bool=n}},3904:(e,t,r)=>{"use strict";const i=Symbol("SemVer ANY");class n{static get ANY(){return i}constructor(e,t){if(t=o(t),e instanceof n){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===i?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new u(r[2],this.options.loose):this.semver=i}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===i||e===i)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):!((t=o(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=n;const o=r(8587),{safeRe:s,t:a}=r(9718),l=r(2111),c=r(7272),u=r(3908),d=r(8311)},3908:(e,t,r)=>{"use strict";const i=r(7272),{MAX_LENGTH:n,MAX_SAFE_INTEGER:o}=r(6874),{safeRe:s,t:a}=r(9718),l=r(8587),{compareIdentifiers:c}=r(1123);class u{constructor(e,t){if(t=l(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>n)throw new TypeError(`version is longer than ${n} characters`);i("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(i("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],n=e.prerelease[t];if(i("prerelease compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return c(r,n)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const r=this.build[t],n=e.build[t];if(i("build compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return c(r,n)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?s[a.PRERELEASELOOSE]:s[a.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let i=this.prerelease.length;for(;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);if(-1===i){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let i=[t,e];!1===r&&(i=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},3999:(e,t,r)=>{"use strict";const i=r(560);e.exports=(e,t,r)=>0!==i(e,t,r)},4044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const i=r(1635),n=r(360),o=i.__importDefault(r(6022));t.IpcWrapper=class{#_;#O;#k;#x=1;#A=new Map;constructor(e,t,r){this.#_=e,this.#O=t,this.#k=r}async sendWithCb(e,t,r,i=0){i<=0&&(i=this.#k);const n={timeout:void 0,resolve:()=>null,reject:()=>null},s=new Promise((e,t)=>{n.resolve=e,n.reject=t});this.#x>268435456&&(this.#x=1);const a=this.#x++;this.#A.set(a,n),this.#O({direction:"call",name:String(e),payload:o.default.stringify(t),callbackId:a});const l=new Error("Call timed out");return n.timeout=setTimeout(()=>{n.reject(r?r():l),this.#A.delete(a)},i),s}sendWithNoCb(e,t){this.#O({direction:"call",name:String(e),payload:o.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#_[e.name];if(!t)return void(e.callbackId&&this.#O({direction:"response",callbackId:e.callbackId,success:!1,payload:o.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?o.default.parse(e.payload):void 0).then(t=>{e.callbackId&&this.#O({direction:"response",callbackId:e.callbackId,success:!0,payload:o.default.stringify(t)})},t=>{e.callbackId&&this.#O({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):o.default.stringify(t)})});break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#A.get(e.callbackId);if(this.#A.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const r=e.payload?o.default.parse(e.payload):void 0;if(e.success)t.resolve(r);else{let e=r;r&&"object"==typeof r&&"message"in r&&(e=new Error(r.message),r.stack&&(e.stack=r.stack)),t.reject(e)}break}default:(0,n.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},4089:(e,t,r)=>{"use strict";const i=r(560);e.exports=(e,t,r)=>i(e,t,r)>=0},4289:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const i=r(2593);function n(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#j;#C;#N;#T;#R=new Map;#M=new Map;constructor(e,t,r,i){this.#j=e,this.#C=t,this.#N=r,this.#T=i}async handleExecuteAction(e){const t=this.#R.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const r={parseVariablesInString:async t=>(await this.#j({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:(t,r)=>{this.#N({customVariableId:t,value:r,controlId:e.action.controlId})}};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},r)}handleUpdateActions(e){for(const[t,r]of Object.entries(e)){const e=this.#M.get(t);if(e){const t=this.#R.get(e.actionId);if(t?.unsubscribe&&!t.skipUnsubscribeOnOptionsChange){const r={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(n(e),r)).catch(t=>{this.#T("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}if(!r||r.disabled)this.#M.delete(t);else{this.#M.set(t,r);const e=this.#R.get(r.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during subscribe")}};Promise.resolve(e.subscribe(n(r),t)).catch(e=>{this.#T("error",`Action subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)})}}}}async handleLearnAction(e){const t=this.#R.get(e.action.actionId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#j({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during learn")}};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},r)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#R.clear();for(const[r,n]of Object.entries(e))n&&(t.push({id:r,name:n.name,description:n.description,options:(0,i.serializeIsVisibleFn)(n.options),optionsToIgnoreForSubscribe:n.optionsToIgnoreForSubscribe,hasLearn:!!n.learn,learnTimeout:n.learnTimeout,hasLifecycleFunctions:!!n.subscribe||!!n.unsubscribe}),this.#R.set(r,n));this.#C({actions:t})}subscribeActions(e){let t=Array.from(this.#M.values());const r=new Set(e);r.size&&(t=t.filter(e=>r.has(e.actionId)));for(const e of t){const t=this.#R.get(e.actionId);if(t?.subscribe){const r={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during subscribe")}};Promise.resolve(t.subscribe(n(e),r)).catch(t=>{this.#T("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}unsubscribeActions(e){let t=Array.from(this.#M.values());const r=new Set(e);r.size&&(t=t.filter(e=>r.has(e.actionId)));for(const e of t){const t=this.#R.get(e.actionId);if(t&&t.unsubscribe){const r={parseVariablesInString:async e=>e,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(n(e),r)).catch(t=>{this.#T("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}}},4322:(e,t,r)=>{"use strict";const i=r(9896),n=2048;e.exports={LDD_PATH:"/usr/bin/ldd",SELF_PATH:"/proc/self/exe",readFileSync:e=>{const t=i.openSync(e,"r"),r=Buffer.alloc(n),o=i.readSync(t,r,0,n,0);return i.close(t,()=>{}),r.subarray(0,o)},readFile:e=>new Promise((t,r)=>{i.open(e,"r",(e,o)=>{if(e)r(e);else{const e=Buffer.alloc(n);i.read(o,e,0,n,0,(r,n)=>{t(e.subarray(0,n)),i.close(o,()=>{})})}})})}},4326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=function(e,t){Promise.resolve().then(async()=>{if(u)throw new Error("runEntrypoint can only be called once");if(u=!0,t||(t=[]),!Array.isArray(t))throw new Error("upgradeScripts must be an array");for(const e of t)if("function"!=typeof e)throw new Error("upgradeScripts must be an array of functions");const r=process.env.MODULE_MANIFEST;if(!r)throw new Error("Module initialise is missing MODULE_MANIFEST");const i=await o.default.readFile(r),d=JSON.parse(i.toString());if(d.runtime?.api!==n.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!d.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let p=d.runtime.apiVersion;if("0.0.0"===p)try{const e=await o.default.readFile(l.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(p=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const h=process.env.CONNECTION_ID;if("string"!=typeof h||!h)throw new Error("Module initialise is missing CONNECTION_ID");const f=process.env.VERIFICATION_TOKEN;if("string"!=typeof f||!f)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const m=new a.IpcWrapper({},e=>{process.send(e)},5e3);process.once("message",e=>{m.receivedMessage(e)}),c=new e((0,s.literal)({id:h,upgradeScripts:t,_isInstanceBaseProps:!0})),m.sendWithCb("register",{apiVersion:p,connectionId:h,verificationToken:f}).then(()=>{console.log("Module-host accepted registration")},e=>{console.error("Module registration failed",e),process.exit(11)})}).catch(e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)})};const i=r(1635),n=r(9967),o=i.__importDefault(r(1943)),s=r(360),a=r(4044),l=i.__importDefault(r(6928));let c,u=!1},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then(e=>new Promise(e=>{e(t())}).then(()=>e),e=>new Promise(e=>{e(t())}).then(()=>{throw e})))},4641:(e,t,r)=>{"use strict";const i=r(560);e.exports=(e,t,r)=>0===i(e,t,r)},4647:(e,t,r)=>{"use strict";const i=r(5317),{isLinux:n,getReport:o}=r(5760),{LDD_PATH:s,SELF_PATH:a,readFile:l,readFileSync:c}=r(4322),{interpreterPath:u}=r(9880);let d,p,h;const f="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true";let m="";const g=()=>m||new Promise(e=>{i.exec(f,(t,r)=>{m=t?" ":r,e(m)})}),b=()=>{if(!m)try{m=i.execSync(f,{encoding:"utf8"})}catch(e){m=" "}return m},y="glibc",v=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,w="musl",E=e=>e.includes("libc.musl-")||e.includes("ld-musl-"),P=()=>{const e=o();return e.header&&e.header.glibcVersionRuntime?y:Array.isArray(e.sharedObjects)&&e.sharedObjects.some(E)?w:null},I=e=>{const[t,r]=e.split(/[\r\n]+/);return t&&t.includes(y)?y:r&&r.includes(w)?w:null},S=e=>{if(e){if(e.includes("/ld-musl-"))return w;if(e.includes("/ld-linux-"))return y}return null},_=e=>(e=e.toString()).includes("musl")?w:e.includes("GNU C Library")?y:null,O=async()=>{let e=null;if(n()&&(e=await(async()=>{if(void 0!==d)return d;d=null;try{const e=await l(a),t=u(e);d=S(t)}catch(e){}return d})(),!e&&(e=await(async()=>{if(void 0!==p)return p;p=null;try{const e=await l(s);p=_(e)}catch(e){}return p})(),e||(e=P()),!e))){const t=await g();e=I(t)}return e},k=()=>{let e=null;if(n()&&(e=(()=>{if(void 0!==d)return d;d=null;try{const e=c(a),t=u(e);d=S(t)}catch(e){}return d})(),!e&&(e=(()=>{if(void 0!==p)return p;p=null;try{const e=c(s);p=_(e)}catch(e){}return p})(),e||(e=P()),!e))){const t=b();e=I(t)}return e},x=()=>{const e=o();return e.header&&e.header.glibcVersionRuntime?e.header.glibcVersionRuntime:null},A=e=>e.trim().split(/\s+/)[1],j=e=>{const[t,r,i]=e.split(/[\r\n]+/);return t&&t.includes(y)?A(t):r&&i&&r.includes(w)?A(i):null};e.exports={GLIBC:y,MUSL:w,family:O,familySync:k,isNonGlibcLinux:async()=>n()&&await O()!==y,isNonGlibcLinuxSync:()=>n()&&k()!==y,version:async()=>{let e=null;if(n()&&(e=await(async()=>{if(void 0!==h)return h;h=null;try{const e=(await l(s)).match(v);e&&(h=e[1])}catch(e){}return h})(),e||(e=x()),!e)){const t=await g();e=j(t)}return e},versionSync:()=>{let e=null;if(n()&&(e=(()=>{if(void 0!==h)return h;h=null;try{const e=c(s).match(v);e&&(h=e[1])}catch(e){}return h})(),e||(e=x()),!e)){const t=b();e=j(t)}return e}}},4774:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const n=i.default(this._queue,r,(e,t)=>t.priority-e.priority);this._queue.splice(n,0,r)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(e=>e.run)}get size(){return this._queue.length}}},4806:(e,t,r)=>{"use strict";const i=r(7975),n=r(7075),o=r(5424);r(9814);const s=i.debuglog("sharp"),a=function(e,t){if(1===arguments.length&&!o.defined(e))throw new Error("Invalid input");return this instanceof a?(n.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBefore:!1,orientBefore:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,precision:"integer",minAmpl:.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,dilateWidth:0,erodeWidth:0,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,withXmp:"",resolveWithObject:!1,loop:-1,delay:[],jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpSmartDeblock:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifKeepDuplicateFrames:!1,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],pdfBackground:[255,255,255,255],debuglog:e=>{this.emit("warning",e),s(e)},queueListener:function(e){a.queue.emit("change",e)}},this.options.input=this._createInputDescriptor(e,t,{allowStream:!0}),this):new a(e,t)};Object.setPrototypeOf(a.prototype,n.Duplex.prototype),Object.setPrototypeOf(a,n.Duplex),Object.assign(a.prototype,{clone:function(){const e=this.constructor.call(),{debuglog:t,queueListener:r,...i}=this.options;return e.options=structuredClone(i),e.options.debuglog=t,e.options.queueListener=r,this._isStreamInput()&&this.on("finish",()=>{this._flattenBufferIn(),e.options.input.buffer=this.options.input.buffer,e.emit("finish")}),e}}),e.exports=a},4865:e=>{"use strict";const t=(e,t,i,n)=>{if("length"===i||"prototype"===i)return;if("arguments"===i||"caller"===i)return;const o=Object.getOwnPropertyDescriptor(e,i),s=Object.getOwnPropertyDescriptor(t,i);!r(o,s)&&n||Object.defineProperty(e,i,s)},r=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},i=(e,t)=>`/* Wrapped ${e}*/\n${t}`,n=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),o=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,r,{ignoreNonConfigurable:s=!1}={})=>{const{name:a}=e;for(const i of Reflect.ownKeys(r))t(e,r,i,s);return((e,t)=>{const r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)})(e,r),((e,t,r)=>{const s=""===r?"":`with ${r.trim()}() `,a=i.bind(null,s,t.toString());Object.defineProperty(a,"name",o),Object.defineProperty(e,"toString",{...n,value:a})})(e,r,a),e}},5035:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=5035,e.exports=t},5158:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5200:(e,t,r)=>{"use strict";const i=r(560);e.exports=(e,t,r)=>i(e,t,r)<=0},5317:e=>{"use strict";e.exports=require("child_process")},5373:e=>{"use strict";e.exports=JSON.parse('{"aom":"3.13.1","archive":"3.8.1","cairo":"1.18.4","cgif":"0.5.0","exif":"0.6.25","expat":"2.7.2","ffi":"3.5.2","fontconfig":"2.17.1","freetype":"2.14.1","fribidi":"1.0.16","glib":"2.86.0","harfbuzz":"11.5.0","heif":"1.20.2","highway":"1.3.0","imagequant":"2.4.1","lcms":"2.17","mozjpeg":"4.1.5","pango":"1.57.0","pixman":"0.46.4","png":"1.6.50","proxy-libintl":"0.5","rsvg":"2.61.1","spng":"0.7.4","tiff":"4.7.0","vips":"8.17.2","webp":"1.6.0","xml2":"2.15.0","zlib-ng":"2.2.5"}')},5424:e=>{"use strict";const t=function(e){return null!=e};e.exports={defined:t,object:function(e){return"object"==typeof e},plainObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},fn:function(e){return"function"==typeof e},bool:function(e){return"boolean"==typeof e},buffer:function(e){return e instanceof Buffer},typedArray:function(e){if(t(e))switch(e.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},arrayBuffer:function(e){return e instanceof ArrayBuffer},string:function(e){return"string"==typeof e&&e.length>0},number:function(e){return"number"==typeof e&&!Number.isNaN(e)},integer:function(e){return Number.isInteger(e)},inRange:function(e,t,r){return e>=t&&e<=r},inArray:function(e,t){return t.includes(e)},invalidParameterError:function(e,t,r){return new Error(`Expected ${t} for ${e} but received ${r} of type ${typeof r}`)},nativeError:function(e,t){return t.message=e.message,t}}},5521:e=>{e.exports={POLLINGRATE:1e3,POLLINGRATE_SOURCES:1e4,RECONNECT_TIME:3e4,DEVICE:void 0,CHOICES_SOURCES:[{id:"null",url:"",label:"- No sources available -"}],STATE:{mode:"N/A"},CHOICES_CONVERTER_MODES:[{id:"encoder",label:"Encoder"},{id:"decoder",label:"Decoder"}],CHOICES_PRESETS:[{id:"1",label:"Preset 1"},{id:"2",label:"Preset 2"},{id:"3",label:"Preset 3"},{id:"4",label:"Preset 4"},{id:"5",label:"Preset 5"},{id:"6",label:"Preset 6"},{id:"7",label:"Preset 7"},{id:"8",label:"Preset 8"},{id:"9",label:"Preset 9"}],INTERVAL:null,INTERVAL_SOURCES:null,RECONNECT_INTERVAL:null,PICS:{NOSIGNAL:void 0,SPLASH:void 0,UNSUPPORT_CODEC:void 0,UNSUPPORT:void 0}}},5580:(e,t,r)=>{"use strict";const i=r(560);e.exports=(e,t,r)=>i(e,t,r)>0},5760:e=>{"use strict";const t=()=>"linux"===process.platform;let r=null;e.exports={isLinux:t,getReport:()=>{if(!r)if(t()&&process.report){const e=process.report.excludeNetwork;process.report.excludeNetwork=!0,r=process.report.getReport(),process.report.excludeNetwork=e}else r={};return r}}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===i(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var n=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=n,t.convertMapToObject=function(e){return Array.from(e).reduce(function(e,t){var i,n,o=(n=2,function(e){if(Array.isArray(e))return e}(i=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){a=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw n}}return o}}(i,n)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(e,t):void 0}}(i,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=o[0],a=o[1];return e[s]=a,e},{})},t.isArguments=function(e){return null!=e&&n(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var o={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=o,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(o.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var r=Object.create(null),i=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},n=function(e){return"="===e?-1:r[e]},o=0;o<64;o++)r[i(o)]=o;var s=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],r=0;r<e;r++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},a={encode:function(e){if("string"==typeof e){var t=e;e=s(t.length);for(var r=0;r<t.length;r++){var n=t.charCodeAt(r);if(n>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[r]=n}}for(var o=[],a=null,l=null,c=null,u=null,d=0;d<e.length;d++)switch(d%3){case 0:a=e[d]>>2&63,l=(3&e[d])<<4;break;case 1:l|=e[d]>>4&15,c=(15&e[d])<<2;break;case 2:c|=e[d]>>6&3,u=63&e[d],o.push(i(a)),o.push(i(l)),o.push(i(c)),o.push(i(u)),a=null,l=null,c=null,u=null}return null!=a&&(o.push(i(a)),o.push(i(l)),null==c?o.push("="):o.push(i(c)),null==u&&o.push("=")),o.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var r=s(t),i=null,o=null,a=null,l=0,c=0;c<e.length;c++){var u=e.charAt(c),d=n(u);switch(c%4){case 0:if(d<0)throw new Error("invalid base64 string");i=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");i|=d>>4,r[l++]=i,o=(15&d)<<4;break;case 2:d>=0&&(o|=d>>2,r[l++]=o,a=(3&d)<<6);break;case 3:d>=0&&(r[l++]=a|d)}}return r},newBinary:s};t.Base64=a},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function e(t,n,o,s,a){var l=n[t];switch(r(l)){case"string":return i(l);case"number":return isFinite(l)?String(l):"null";case"boolean":return String(l);case"object":if(!l)return"null";var c,u=s+o,d=[];if(Array.isArray(l)||{}.hasOwnProperty.call(l,"callee")){for(var p=l.length,h=0;h<p;h+=1)d[h]=e(h,l,o,u,a)||"null";return c=0===d.length?"[]":u?"[\n"+u+d.join(",\n"+u)+"\n"+s+"]":"["+d.join(",")+"]"}var f=Object.keys(l);return a&&(f=f.sort()),f.forEach(function(t){(c=e(t,l,o,u,a))&&d.push(i(t)+(u?": ":":")+c)}),c=0===d.length?"{}":u?"{\n"+u+d.join(",\n"+u)+"\n"+s+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var r=Object.assign({indent:"",canonical:!1},t);if(!0===r.indent)r.indent="  ";else if("number"==typeof r.indent){for(var i="",o=0;o<r.indent;o++)i+=" ";r.indent=i}return n("",{"":e},r.indent,"",r.canonical)},e.exports=t.default}],r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,i),o.exports}var n={};!function(){var e=n,t=i(2).Base64,r=i(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var o=i(1),s={};e.EJSON=s;var a=new Map;s.addType=function(e,t){if(a.has(e))throw new Error("Type ".concat(e," already present"));a.set(e,t)};var l=[{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$date")&&1===(0,o.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$regexp")&&(0,o.hasOwn)(e,"$flags")&&2===(0,o.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$InfNaN")&&1===(0,o.lengthOf)(e)},matchObject:o.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$binary")&&1===(0,o.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,o.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$escape")&&1===(0,o.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var r=(0,o.lengthOf)(e);1!==r&&2!==r||(t=l.some(function(t){return t.matchJSONValue(e)}))}return t},toJSONValue:function(e){var t={};return(0,o.keysOf)(e).forEach(function(r){t[r]=s.toJSONValue(e[r])}),{$escape:t}},fromJSONValue:function(e){var t={};return(0,o.keysOf)(e.$escape).forEach(function(r){t[r]=s.fromJSONValue(e.$escape[r])}),t}},{matchJSONValue:function(e){return(0,o.hasOwn)(e,"$type")&&(0,o.hasOwn)(e,"$value")&&2===(0,o.lengthOf)(e)},matchObject:function(e){return s._isCustomType(e)},toJSONValue:function(e){var t=r._noYieldsAllowed(function(){return e.toJSONValue()});return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!a.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var i=a.get(t);return r._noYieldsAllowed(function(){return i(e.$value)})}}];s._isCustomType=function(e){return e&&(0,o.isFunction)(e.toJSONValue)&&(0,o.isFunction)(e.typeName)&&a.has(e.typeName())},s._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?a:(0,o.convertMapToObject)(a)},s._getConverters=function(){return l};var c=function(e){for(var t=0;t<l.length;t++){var r=l[t];if(r.matchObject(e))return r.toJSONValue(e)}},u=function e(t){if(null===t)return null;var r=c(t);return void 0!==r?r:(0,o.isObject)(t)?((0,o.keysOf)(t).forEach(function(r){var i=t[r];if((0,o.isObject)(i)||void 0===i||(0,o.isInfOrNaN)(i)){var n=c(i);n?t[r]=n:e(i)}}),t):t};s._adjustTypesToJSONValue=u,s.toJSONValue=function(e){var t=c(e);if(void 0!==t)return t;var r=e;return(0,o.isObject)(e)&&(r=s.clone(e),u(r)),r};var d=function(e){if((0,o.isObject)(e)&&null!==e){var t=(0,o.keysOf)(e);if(t.length<=2&&t.every(function(e){return"string"==typeof e&&"$"===e.substr(0,1)}))for(var r=0;r<l.length;r++){var i=l[r];if(i.matchJSONValue(e))return i.fromJSONValue(e)}}return e},p=function e(t){if(null===t)return null;var r=d(t);return r!==t?r:(0,o.isObject)(t)?((0,o.keysOf)(t).forEach(function(r){var i=t[r];if((0,o.isObject)(i)){var n=d(i);if(i!==n)return void(t[r]=n);e(i)}}),t):t};s._adjustTypesFromJSONValue=p,s.fromJSONValue=function(e){var t=d(e);return t===e&&(0,o.isObject)(e)&&(t=s.clone(e),p(t)),t},s.stringify=(0,o.handleError)(function(e,t){var r=s.toJSONValue(e);return t&&(t.canonical||t.indent)?i(4)(r,t):JSON.stringify(r)}),s.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return s.fromJSONValue(JSON.parse(e))},s.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},s.equals=function(e,t,r){var i,n=!(!r||!r.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,o.isObject)(e)||!(0,o.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(s.isBinary(e)&&s.isBinary(t)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}if((0,o.isFunction)(e.equals))return e.equals(t,r);if((0,o.isFunction)(t.equals))return t.equals(e,r);var a,l=Array.isArray(e),c=Array.isArray(t);if(l!==c)return!1;if(l&&c){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!s.equals(e[i],t[i],r))return!1;return!0}switch(s._isCustomType(e)+s._isCustomType(t)){case 1:return!1;case 2:return s.equals(s.toJSONValue(e),s.toJSONValue(t))}var u=(0,o.keysOf)(e),d=(0,o.keysOf)(t);return n?(i=0,a=u.every(function(n){return!(i>=d.length||n!==d[i]||!s.equals(e[n],t[d[i]],r)||(i++,0))})):(i=0,a=u.every(function(n){return!!(0,o.hasOwn)(t,n)&&!!s.equals(e[n],t[n],r)&&(i++,!0)})),a&&i===d.length},s.clone=function(e){var t;if(!(0,o.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(s.isBinary(e)){t=s.newBinary(e.length);for(var r=0;r<e.length;r++)t[r]=e[r];return t}return Array.isArray(e)?e.map(s.clone):(0,o.isArguments)(e)?Array.from(e).map(s.clone):(0,o.isFunction)(e.clone)?e.clone():s._isCustomType(e)?s.fromJSONValue(s.clone(s.toJSONValue(e)),!0):(t={},(0,o.keysOf)(e).forEach(function(r){t[r]=s.clone(e[r])}),t)},s.newBinary=t.newBinary}(),e.exports=n.EJSON}()},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var i=r(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return i.TCPHelper}});var n=r(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return n.TelnetHelper}});var o=r(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return o.UDPHelper}})},6170:(e,t,r)=>{"use strict";const i=r(3908),n=r(144),{safeRe:o,t:s}=r(9718);e.exports=(e,t)=>{if(e instanceof i)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){const i=t.includePrerelease?o[s.COERCERTLFULL]:o[s.COERCERTL];let n;for(;(n=i.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&n.index+n[0].length===r.index+r[0].length||(r=n),i.lastIndex=n.index+n[1].length+n[2].length;i.lastIndex=-1}else r=e.match(t.includePrerelease?o[s.COERCEFULL]:o[s.COERCE]);if(null===r)return null;const a=r[2],l=r[3]||"0",c=r[4]||"0",u=t.includePrerelease&&r[5]?`-${r[5]}`:"",d=t.includePrerelease&&r[6]?`+${r[6]}`:"";return n(`${a}.${l}.${c}${u}${d}`,t)}},6250:(e,t,r)=>{"use strict";const i=r(2017);i.code='require("ajv/dist/runtime/equal").default',t.A=i},6259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const i=r(1635).__importDefault(r(7194)),n=r(228),o=r(1400);class s extends n.EventEmitter{#$;#L;#D;#w;#F=!1;#V;#r;get isDestroyed(){return this.#F}constructor(e,t,r){super(),this.#$=e,this.#L=t,this.#w={...r},this.#D=i.default.createSocket("udp4");try{this.#D.bind(this.#w.bind_port||0,this.#w.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#w.bind_ip||"0.0.0.0"}:${this.#w.bind_port||0}`)}void 0!==this.#w.ttl&&this.#D.setTTL(this.#w.ttl),void 0!==this.#w.multicast_ttl&&this.#D.setMulticastTTL(this.#w.multicast_ttl),this.#D.on("error",e=>{this.#U(o.InstanceStatus.UnknownError,e.message),this.emit("error",e)}),this.#D.on("listening",()=>{this.#w.broadcast&&this.#D.setBroadcast(!0),this.#w.multicast_interface&&this.#D.setMulticastInterface(this.#w.multicast_interface),this.#U(o.InstanceStatus.Ok),this.emit("listening")}),this.#D.on("message",(e,t)=>this.emit("data",e,t)),this.#r=setTimeout(()=>{this.#F||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#$}:${this.#L} is missing an error handler!`)},5e3)}async send(e){if(this.#F)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise((t,r)=>{this.#D.send(e,this.#L,this.#$,e=>{e?r(e):t()})})}destroy(){this.#F=!0,void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this.#D.removeAllListeners(),this.#D.close(),this.removeAllListeners()}#U(e,t){this.#V!=e&&(this.#V=e,this.emit("status_change",e,t))}}t.UDPHelper=s},6260:e=>{"use strict";e.exports=JSON.parse('{"name":"@img/sharp-libvips-linux-x64","version":"1.2.3","description":"Prebuilt libvips and dependencies for use with sharp on Linux (glibc) x64","author":"Lovell Fuller <npm@lovell.info>","homepage":"https://sharp.pixelplumbing.com","repository":{"type":"git","url":"git+https://github.com/lovell/sharp-libvips.git","directory":"npm/linux-x64"},"license":"LGPL-3.0-or-later","funding":{"url":"https://opencollective.com/libvips"},"preferUnplugged":true,"publishConfig":{"access":"public"},"files":["lib","versions.json"],"type":"commonjs","exports":{"./lib":"./lib/index.js","./package":"./package.json","./versions":"./versions.json"},"config":{"glibc":">=2.26"},"os":["linux"],"libc":["glibc"],"cpu":["x64"]}')},6278:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.substituteEscapeCharacters=t.parseEscapeCharacters=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const i=r(1635);i.__exportStar(r(9077),t),i.__exportStar(r(2018),t),i.__exportStar(r(4581),t),i.__exportStar(r(5158),t);var n=r(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return n.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return n.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return n.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return n.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return n.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return n.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return n.assertNever}}),Object.defineProperty(t,"parseEscapeCharacters",{enumerable:!0,get:function(){return n.parseEscapeCharacters}}),Object.defineProperty(t,"substituteEscapeCharacters",{enumerable:!0,get:function(){return n.substituteEscapeCharacters}}),i.__exportStar(r(6160),t);var o=r(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return o.runEntrypoint}})},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r={grad:.9,turn:360,rad:360/(2*Math.PI)},i=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},n=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},o=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},s=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},a=function(e){return{r:o(e.r,0,255),g:o(e.g,0,255),b:o(e.b,0,255),a:o(e.a)}},l=function(e){return{r:n(e.r),g:n(e.g),b:n(e.b),a:n(e.a,3)}},c=/^#([0-9a-f]{3,8})$/i,u=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,r=e.g,i=e.b,n=e.a,o=Math.max(t,r,i),s=o-Math.min(t,r,i),a=s?o===t?(r-i)/s:o===r?2+(i-t)/s:4+(t-r)/s:0;return{h:60*(a<0?a+6:a),s:o?s/o*100:0,v:o/255*100,a:n}},p=function(e){var t=e.h,r=e.s,i=e.v,n=e.a;t=t/360*6,r/=100,i/=100;var o=Math.floor(t),s=i*(1-r),a=i*(1-(t-o)*r),l=i*(1-(1-t+o)*r),c=o%6;return{r:255*[i,a,s,s,l,i][c],g:255*[l,i,i,a,s,s][c],b:255*[s,s,l,i,i,a][c],a:n}},h=function(e){return{h:s(e.h),s:o(e.s,0,100),l:o(e.l,0,100),a:o(e.a)}},f=function(e){return{h:n(e.h),s:n(e.s),l:n(e.l),a:n(e.a,3)}},m=function(e){return p((r=(t=e).s,{h:t.h,s:(r*=((i=t.l)<50?i:100-i)/100)>0?2*r/(i+r)*100:0,v:i+r,a:t.a}));var t,r,i},g=function(e){return{h:(t=d(e)).h,s:(n=(200-(r=t.s))*(i=t.v)/100)>0&&n<200?r*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,r,i,n},b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,E={string:[[function(e){var t=c.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?n(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?n(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=v.exec(e)||w.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=b.exec(e)||y.exec(e);if(!t)return null;var i,n,o=h({h:(i=t[1],n=t[2],void 0===n&&(n="deg"),Number(i)*(r[n]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return m(o)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,n=e.b,o=e.a,s=void 0===o?1:o;return i(t)&&i(r)&&i(n)?a({r:Number(t),g:Number(r),b:Number(n),a:Number(s)}):null},"rgb"],[function(e){var t=e.h,r=e.s,n=e.l,o=e.a,s=void 0===o?1:o;if(!i(t)||!i(r)||!i(n))return null;var a=h({h:Number(t),s:Number(r),l:Number(n),a:Number(s)});return m(a)},"hsl"],[function(e){var t=e.h,r=e.s,n=e.v,a=e.a,l=void 0===a?1:a;if(!i(t)||!i(r)||!i(n))return null;var c=function(e){return{h:s(e.h),s:o(e.s,0,100),v:o(e.v,0,100),a:o(e.a)}}({h:Number(t),s:Number(r),v:Number(n),a:Number(l)});return p(c)},"hsv"]]},P=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0](e);if(i)return[i,t[r][1]]}return[null,void 0]},I=function(e){return"string"==typeof e?P(e.trim(),E.string):"object"==typeof e&&null!==e?P(e,E.object):[null,void 0]},S=function(e,t){var r=g(e);return{h:r.h,s:o(r.s+100*t,0,100),l:r.l,a:r.a}},_=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},O=function(e,t){var r=g(e);return{h:r.h,s:r.s,l:o(r.l+100*t,0,100),a:r.a}},k=function(){function e(e){this.parsed=I(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return n(_(this.rgba),2)},e.prototype.isDark=function(){return _(this.rgba)<.5},e.prototype.isLight=function(){return _(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=l(this.rgba)).r,r=e.g,i=e.b,s=(o=e.a)<1?u(n(255*o)):"","#"+u(t)+u(r)+u(i)+s;var e,t,r,i,o,s},e.prototype.toRgb=function(){return l(this.rgba)},e.prototype.toRgbString=function(){return t=(e=l(this.rgba)).r,r=e.g,i=e.b,(n=e.a)<1?"rgba("+t+", "+r+", "+i+", "+n+")":"rgb("+t+", "+r+", "+i+")";var e,t,r,i,n},e.prototype.toHsl=function(){return f(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=f(g(this.rgba))).h,r=e.s,i=e.l,(n=e.a)<1?"hsla("+t+", "+r+"%, "+i+"%, "+n+")":"hsl("+t+", "+r+"%, "+i+"%)";var e,t,r,i,n},e.prototype.toHsv=function(){return e=d(this.rgba),{h:n(e.h),s:n(e.s),v:n(e.v),a:n(e.a,3)};var e},e.prototype.invert=function(){return x({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),x(S(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),x(S(this.rgba,-e))},e.prototype.grayscale=function(){return x(S(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),x(O(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),x(O(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?x({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):n(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?x({h:e,s:t.s,l:t.l,a:t.a}):n(t.h)},e.prototype.isEqual=function(e){return this.toHex()===x(e).toHex()},e}(),x=function(e){return e instanceof k?e:new k(e)},A=[];t.Colord=k,t.colord=x,t.extend=function(e){e.forEach(function(e){A.indexOf(e)<0&&(e(k,E),A.push(e))})},t.getFormat=function(e){return I(e)[1]},t.random=function(){return new k({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6317:(e,t,r)=>{"use strict";const i=r(5424),n={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function o(e){if(!Array.isArray(e))throw i.invalidParameterError("images to composite","array",e);return this.options.composite=e.map(e=>{if(!i.object(e))throw i.invalidParameterError("image to composite","object",e);const t=this._inputOptionsFromObject(e),r={input:this._createInputDescriptor(e.input,t,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(i.defined(e.blend)){if(!i.string(n[e.blend]))throw i.invalidParameterError("blend","valid blend name",e.blend);r.blend=n[e.blend]}if(i.defined(e.tile)){if(!i.bool(e.tile))throw i.invalidParameterError("tile","boolean",e.tile);r.tile=e.tile}if(i.defined(e.left)){if(!i.integer(e.left))throw i.invalidParameterError("left","integer",e.left);r.left=e.left}if(i.defined(e.top)){if(!i.integer(e.top))throw i.invalidParameterError("top","integer",e.top);r.top=e.top}if(i.defined(e.top)!==i.defined(e.left))throw new Error("Expected both left and top to be set");if(r.hasOffset=i.integer(e.top)&&i.integer(e.left),i.defined(e.gravity))if(i.integer(e.gravity)&&i.inRange(e.gravity,0,8))r.gravity=e.gravity;else{if(!i.string(e.gravity)||!i.integer(this.constructor.gravity[e.gravity]))throw i.invalidParameterError("gravity","valid gravity",e.gravity);r.gravity=this.constructor.gravity[e.gravity]}if(i.defined(e.premultiplied)){if(!i.bool(e.premultiplied))throw i.invalidParameterError("premultiplied","boolean",e.premultiplied);r.premultiplied=e.premultiplied}return r}),this}e.exports=function(e){e.prototype.composite=o,e.blend=n}},6368:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function i(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,i,o,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new n(i,o||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,i,n=[];if(0===this._eventsCount)return n;for(i in e=this._events)t.call(e,i)&&n.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,s=new Array(o);n<o;n++)s[n]=i[n].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,n,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,n),!0;case 5:return u.fn.call(u.context,t,i,n,o),!0;case 6:return u.fn.call(u.context,t,i,n,o,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var p,h=u.length;for(c=0;c<h;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,i,n){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||n&&!a.once||i&&a.context!==i||s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||n&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},6491:(e,t,r)=>{"use strict";const i=r(5424),n={integer:"integer",float:"float",approximate:"approximate"};function o(e,t){if(!i.defined(e))return this.autoOrient();if((this.options.angle||this.options.rotationAngle)&&(this.options.debuglog("ignoring previous rotate options"),this.options.angle=0,this.options.rotationAngle=0),!i.integer(e)||e%90){if(!i.number(e))throw i.invalidParameterError("angle","numeric",e);this.options.rotationAngle=e,i.object(t)&&t.background&&this._setBackgroundColourOption("rotationBackground",t.background)}else this.options.angle=e;return this}function s(){return this.options.input.autoOrient=!0,this}function a(e){return this.options.flip=!i.bool(e)||e,this}function l(e){return this.options.flop=!i.bool(e)||e,this}function c(e,t){const r=[].concat(...e);if(4!==r.length||!r.every(i.number))throw i.invalidParameterError("matrix","1x4 or 2x2 array",e);if(this.options.affineMatrix=r,i.defined(t)){if(!i.object(t))throw i.invalidParameterError("options","object",t);if(this._setBackgroundColourOption("affineBackground",t.background),i.defined(t.idx)){if(!i.number(t.idx))throw i.invalidParameterError("options.idx","number",t.idx);this.options.affineIdx=t.idx}if(i.defined(t.idy)){if(!i.number(t.idy))throw i.invalidParameterError("options.idy","number",t.idy);this.options.affineIdy=t.idy}if(i.defined(t.odx)){if(!i.number(t.odx))throw i.invalidParameterError("options.odx","number",t.odx);this.options.affineOdx=t.odx}if(i.defined(t.ody)){if(!i.number(t.ody))throw i.invalidParameterError("options.ody","number",t.ody);this.options.affineOdy=t.ody}if(i.defined(t.interpolator)){if(!i.inArray(t.interpolator,Object.values(this.constructor.interpolators)))throw i.invalidParameterError("options.interpolator","valid interpolator name",t.interpolator);this.options.affineInterpolator=t.interpolator}}return this}function u(e,t,r){if(i.defined(e))if(i.bool(e))this.options.sharpenSigma=e?-1:0;else if(i.number(e)&&i.inRange(e,.01,1e4)){if(this.options.sharpenSigma=e,i.defined(t)){if(!i.number(t)||!i.inRange(t,0,1e4))throw i.invalidParameterError("flat","number between 0 and 10000",t);this.options.sharpenM1=t}if(i.defined(r)){if(!i.number(r)||!i.inRange(r,0,1e4))throw i.invalidParameterError("jagged","number between 0 and 10000",r);this.options.sharpenM2=r}}else{if(!i.plainObject(e))throw i.invalidParameterError("sigma","number between 0.01 and 10000",e);if(!i.number(e.sigma)||!i.inRange(e.sigma,1e-6,10))throw i.invalidParameterError("options.sigma","number between 0.000001 and 10",e.sigma);if(this.options.sharpenSigma=e.sigma,i.defined(e.m1)){if(!i.number(e.m1)||!i.inRange(e.m1,0,1e6))throw i.invalidParameterError("options.m1","number between 0 and 1000000",e.m1);this.options.sharpenM1=e.m1}if(i.defined(e.m2)){if(!i.number(e.m2)||!i.inRange(e.m2,0,1e6))throw i.invalidParameterError("options.m2","number between 0 and 1000000",e.m2);this.options.sharpenM2=e.m2}if(i.defined(e.x1)){if(!i.number(e.x1)||!i.inRange(e.x1,0,1e6))throw i.invalidParameterError("options.x1","number between 0 and 1000000",e.x1);this.options.sharpenX1=e.x1}if(i.defined(e.y2)){if(!i.number(e.y2)||!i.inRange(e.y2,0,1e6))throw i.invalidParameterError("options.y2","number between 0 and 1000000",e.y2);this.options.sharpenY2=e.y2}if(i.defined(e.y3)){if(!i.number(e.y3)||!i.inRange(e.y3,0,1e6))throw i.invalidParameterError("options.y3","number between 0 and 1000000",e.y3);this.options.sharpenY3=e.y3}}else this.options.sharpenSigma=-1;return this}function d(e){if(i.defined(e)){if(!i.integer(e)||!i.inRange(e,1,1e3))throw i.invalidParameterError("size","integer between 1 and 1000",e);this.options.medianSize=e}else this.options.medianSize=3;return this}function p(e){let t;if(i.number(e))t=e;else if(i.plainObject(e)){if(!i.number(e.sigma))throw i.invalidParameterError("options.sigma","number between 0.3 and 1000",t);if(t=e.sigma,"precision"in e){if(!i.string(n[e.precision]))throw i.invalidParameterError("precision","one of: integer, float, approximate",e.precision);this.options.precision=n[e.precision]}if("minAmplitude"in e){if(!i.number(e.minAmplitude)||!i.inRange(e.minAmplitude,.001,1))throw i.invalidParameterError("minAmplitude","number between 0.001 and 1",e.minAmplitude);this.options.minAmpl=e.minAmplitude}}if(i.defined(e))if(i.bool(e))this.options.blurSigma=e?-1:0;else{if(!i.number(t)||!i.inRange(t,.3,1e3))throw i.invalidParameterError("sigma","number between 0.3 and 1000",t);this.options.blurSigma=t}else this.options.blurSigma=-1;return this}function h(e){if(i.defined(e)){if(!(i.integer(e)&&e>0))throw i.invalidParameterError("dilate","positive integer",h);this.options.dilateWidth=e}else this.options.dilateWidth=1;return this}function f(e){if(i.defined(e)){if(!(i.integer(e)&&e>0))throw i.invalidParameterError("erode","positive integer",f);this.options.erodeWidth=e}else this.options.erodeWidth=1;return this}function m(e){return this.options.flatten=!i.bool(e)||e,i.object(e)&&this._setBackgroundColourOption("flattenBackground",e.background),this}function g(){return this.options.unflatten=!0,this}function b(e,t){if(i.defined(e)){if(!i.number(e)||!i.inRange(e,1,3))throw i.invalidParameterError("gamma","number between 1.0 and 3.0",e);this.options.gamma=e}else this.options.gamma=2.2;if(i.defined(t)){if(!i.number(t)||!i.inRange(t,1,3))throw i.invalidParameterError("gammaOut","number between 1.0 and 3.0",t);this.options.gammaOut=t}else this.options.gammaOut=this.options.gamma;return this}function y(e){if(this.options.negate=!i.bool(e)||e,i.plainObject(e)&&"alpha"in e){if(!i.bool(e.alpha))throw i.invalidParameterError("alpha","should be boolean value",e.alpha);this.options.negateAlpha=e.alpha}return this}function v(e){if(i.plainObject(e)){if(i.defined(e.lower)){if(!i.number(e.lower)||!i.inRange(e.lower,0,99))throw i.invalidParameterError("lower","number between 0 and 99",e.lower);this.options.normaliseLower=e.lower}if(i.defined(e.upper)){if(!i.number(e.upper)||!i.inRange(e.upper,1,100))throw i.invalidParameterError("upper","number between 1 and 100",e.upper);this.options.normaliseUpper=e.upper}}if(this.options.normaliseLower>=this.options.normaliseUpper)throw i.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function w(e){return this.normalise(e)}function E(e){if(!i.plainObject(e))throw i.invalidParameterError("options","plain object",e);if(!(i.integer(e.width)&&e.width>0))throw i.invalidParameterError("width","integer greater than zero",e.width);if(this.options.claheWidth=e.width,!(i.integer(e.height)&&e.height>0))throw i.invalidParameterError("height","integer greater than zero",e.height);if(this.options.claheHeight=e.height,i.defined(e.maxSlope)){if(!i.integer(e.maxSlope)||!i.inRange(e.maxSlope,0,100))throw i.invalidParameterError("maxSlope","integer between 0 and 100",e.maxSlope);this.options.claheMaxSlope=e.maxSlope}return this}function P(e){if(!(i.object(e)&&Array.isArray(e.kernel)&&i.integer(e.width)&&i.integer(e.height)&&i.inRange(e.width,3,1001)&&i.inRange(e.height,3,1001)&&e.height*e.width===e.kernel.length))throw new Error("Invalid convolution kernel");return i.integer(e.scale)||(e.scale=e.kernel.reduce(function(e,t){return e+t},0)),e.scale<1&&(e.scale=1),i.integer(e.offset)||(e.offset=0),this.options.convKernel=e,this}function I(e,t){if(i.defined(e))if(i.bool(e))this.options.threshold=e?128:0;else{if(!i.integer(e)||!i.inRange(e,0,255))throw i.invalidParameterError("threshold","integer between 0 and 255",e);this.options.threshold=e}else this.options.threshold=128;return i.object(t)&&!0!==t.greyscale&&!0!==t.grayscale?this.options.thresholdGrayscale=!1:this.options.thresholdGrayscale=!0,this}function S(e,t,r){if(this.options.boolean=this._createInputDescriptor(e,r),!i.string(t)||!i.inArray(t,["and","or","eor"]))throw i.invalidParameterError("operator","one of: and, or, eor",t);return this.options.booleanOp=t,this}function _(e,t){if(!i.defined(e)&&i.number(t)?e=1:i.number(e)&&!i.defined(t)&&(t=0),i.defined(e))if(i.number(e))this.options.linearA=[e];else{if(!(Array.isArray(e)&&e.length&&e.every(i.number)))throw i.invalidParameterError("a","number or array of numbers",e);this.options.linearA=e}else this.options.linearA=[];if(i.defined(t))if(i.number(t))this.options.linearB=[t];else{if(!(Array.isArray(t)&&t.length&&t.every(i.number)))throw i.invalidParameterError("b","number or array of numbers",t);this.options.linearB=t}else this.options.linearB=[];if(this.options.linearA.length!==this.options.linearB.length)throw new Error("Expected a and b to be arrays of the same length");return this}function O(e){if(!Array.isArray(e))throw i.invalidParameterError("inputMatrix","array",e);if(3!==e.length&&4!==e.length)throw i.invalidParameterError("inputMatrix","3x3 or 4x4 array",e.length);const t=e.flat().map(Number);if(9!==t.length&&16!==t.length)throw i.invalidParameterError("inputMatrix","cardinality of 9 or 16",t.length);return this.options.recombMatrix=t,this}function k(e){if(!i.plainObject(e))throw i.invalidParameterError("options","plain object",e);if("brightness"in e){if(!(i.number(e.brightness)&&e.brightness>=0))throw i.invalidParameterError("brightness","number above zero",e.brightness);this.options.brightness=e.brightness}if("saturation"in e){if(!(i.number(e.saturation)&&e.saturation>=0))throw i.invalidParameterError("saturation","number above zero",e.saturation);this.options.saturation=e.saturation}if("hue"in e){if(!i.integer(e.hue))throw i.invalidParameterError("hue","number",e.hue);this.options.hue=e.hue%360}if("lightness"in e){if(!i.number(e.lightness))throw i.invalidParameterError("lightness","number",e.lightness);this.options.lightness=e.lightness}return this}e.exports=function(e){Object.assign(e.prototype,{autoOrient:s,rotate:o,flip:a,flop:l,affine:c,sharpen:u,erode:f,dilate:h,median:d,blur:p,flatten:m,unflatten:g,gamma:b,negate:y,normalise:v,normalize:w,clahe:E,convolve:P,threshold:I,boolean:S,linear:_,recomb:O,modulate:k})}},6530:e=>{var t,r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,s={};((e,t)=>{for(var i in t)r(e,i,{get:t[i],enumerable:!0})})(s,{default:()=>$}),e.exports=(t=s,((e,t,s,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of n(t))o.call(e,s)||undefined===s||r(e,s,{get:()=>t[s],enumerable:!(a=i(t,s))||a.enumerable});return e})(r({},"__esModule",{value:!0}),t));var a={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},l=Object.create(null);for(const e in a)Object.hasOwn(a,e)&&(l[a[e]]=e);var c={to:{},get:{}};function u(e,t,r){return Math.min(Math.max(t,e),r)}function d(e){const t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}c.get=function(e){let t,r;switch(e.slice(0,3).toLowerCase()){case"hsl":t=c.get.hsl(e),r="hsl";break;case"hwb":t=c.get.hwb(e),r="hwb";break;default:t=c.get.rgb(e),r="rgb"}return t?{model:r,value:t}:null},c.get.rgb=function(e){if(!e)return null;let t,r,i,n=[0,0,0,1];if(t=e.match(/^#([a-f\d]{6})([a-f\d]{2})?$/i)){for(i=t[2],t=t[1],r=0;r<3;r++){const e=2*r;n[r]=Number.parseInt(t.slice(e,e+2),16)}i&&(n[3]=Number.parseInt(i,16)/255)}else if(t=e.match(/^#([a-f\d]{3,4})$/i)){for(t=t[1],i=t[3],r=0;r<3;r++)n[r]=Number.parseInt(t[r]+t[r],16);i&&(n[3]=Number.parseInt(i+i,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[\s,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/)){for(r=0;r<3;r++)n[r]=Number.parseInt(t[r+1],10);t[4]&&(n[3]=t[5]?.01*Number.parseFloat(t[4]):Number.parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[\s,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:Object.hasOwn(a,t[1])?(n=a[t[1]],n[3]=1,n):null:null;for(r=0;r<3;r++)n[r]=Math.round(2.55*Number.parseFloat(t[r+1]));t[4]&&(n[3]=t[5]?.01*Number.parseFloat(t[4]):Number.parseFloat(t[4]))}for(r=0;r<3;r++)n[r]=u(n[r],0,255);return n[3]=u(n[3],0,1),n},c.get.hsl=function(e){if(!e)return null;const t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[,|/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){const e=Number.parseFloat(t[4]);return[(Number.parseFloat(t[1])%360+360)%360,u(Number.parseFloat(t[2]),0,100),u(Number.parseFloat(t[3]),0,100),u(Number.isNaN(e)?1:e,0,1)]}return null},c.get.hwb=function(e){if(!e)return null;const t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*[\s,]\s*([+-]?[\d.]+)%\s*[\s,]\s*([+-]?[\d.]+)%\s*(?:[\s,]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){const e=Number.parseFloat(t[4]);return[(Number.parseFloat(t[1])%360+360)%360,u(Number.parseFloat(t[2]),0,100),u(Number.parseFloat(t[3]),0,100),u(Number.isNaN(e)?1:e,0,1)]}return null},c.to.hex=function(...e){return"#"+d(e[0])+d(e[1])+d(e[2])+(e[3]<1?d(Math.round(255*e[3])):"")},c.to.rgb=function(...e){return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},c.to.rgb.percent=function(...e){const t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+r+"%, "+i+"%)":"rgba("+t+"%, "+r+"%, "+i+"%, "+e[3]+")"},c.to.hsl=function(...e){return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},c.to.hwb=function(...e){let t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},c.to.keyword=function(...e){return l[e.slice(0,3)]};var p=c,h={};for(const e of Object.keys(a))h[a[e]]=e;var f={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},m=f,g=(6/29)**3;function b(e){const t=e>.0031308?1.055*e**(1/2.4)-.055:12.92*e;return Math.min(Math.max(0,t),1)}function y(e){return e>.04045?((e+.055)/1.055)**2.4:e/12.92}for(const e of Object.keys(f)){if(!("channels"in f[e]))throw new Error("missing channels property: "+e);if(!("labels"in f[e]))throw new Error("missing channel labels property: "+e);if(f[e].labels.length!==f[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:r}=f[e];delete f[e].channels,delete f[e].labels,Object.defineProperty(f[e],"channels",{value:t}),Object.defineProperty(f[e],"labels",{value:r})}function v(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}function w(e,t){return function(r){return t(e(r))}}function E(e,t){const r=[t[e].parent,e];let i=m[t[e].parent][e],n=t[e].parent;for(;t[n].parent;)r.unshift(t[n].parent),i=w(m[t[n].parent][n],i),n=t[n].parent;return i.conversion=r,i}f.rgb.hsl=function(e){const t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.min(t,r,i),o=Math.max(t,r,i),s=o-n;let a,l;switch(o){case n:a=0;break;case t:a=(r-i)/s;break;case r:a=2+(i-t)/s;break;case i:a=4+(t-r)/s}a=Math.min(60*a,360),a<0&&(a+=360);const c=(n+o)/2;return l=o===n?0:c<=.5?s/(o+n):s/(2-o-n),[a,100*l,100*c]},f.rgb.hsv=function(e){let t,r,i,n,o;const s=e[0]/255,a=e[1]/255,l=e[2]/255,c=Math.max(s,a,l),u=c-Math.min(s,a,l),d=function(e){return(c-e)/6/u+.5};if(0===u)n=0,o=0;else{switch(o=u/c,t=d(s),r=d(a),i=d(l),c){case s:n=i-r;break;case a:n=1/3+t-i;break;case l:n=2/3+r-t}n<0?n+=1:n>1&&(n-=1)}return[360*n,100*o,100*c]},f.rgb.hwb=function(e){const t=e[0],r=e[1];let i=e[2];const n=f.rgb.hsl(e)[0],o=1/255*Math.min(t,Math.min(r,i));return i=1-1/255*Math.max(t,Math.max(r,i)),[n,100*o,100*i]},f.rgb.oklab=function(e){const t=y(e[0]/255),r=y(e[1]/255),i=y(e[2]/255),n=Math.cbrt(.4122214708*t+.5363325363*r+.0514459929*i),o=Math.cbrt(.2119034982*t+.6806995451*r+.1073969566*i),s=Math.cbrt(.0883024619*t+.2817188376*r+.6299787005*i);return[100*(.2104542553*n+.793617785*o-.0040720468*s),100*(1.9779984951*n-2.428592205*o+.4505937099*s),100*(.0259040371*n+.7827717662*o-.808675766*s)]},f.rgb.cmyk=function(e){const t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.min(1-t,1-r,1-i);return[100*((1-t-n)/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-i-n)/(1-n)||0),100*n]},f.rgb.keyword=function(e){const t=h[e];if(t)return t;let r,i=Number.POSITIVE_INFINITY;for(const t of Object.keys(a)){const n=v(e,a[t]);n<i&&(i=n,r=t)}return r},f.keyword.rgb=function(e){return a[e]},f.rgb.xyz=function(e){const t=y(e[0]/255),r=y(e[1]/255),i=y(e[2]/255);return[100*(.4124564*t+.3575761*r+.1804375*i),100*(.2126729*t+.7151522*r+.072175*i),100*(.0193339*t+.119192*r+.9503041*i)]},f.rgb.lab=function(e){const t=f.rgb.xyz(e);let r=t[0],i=t[1],n=t[2];return r/=95.047,i/=100,n/=108.883,r=r>g?r**(1/3):7.787*r+16/116,i=i>g?i**(1/3):7.787*i+16/116,n=n>g?n**(1/3):7.787*n+16/116,[116*i-16,500*(r-i),200*(i-n)]},f.hsl.rgb=function(e){const t=e[0]/360,r=e[1]/100,i=e[2]/100;let n,o;if(0===r)return o=255*i,[o,o,o];const s=i<.5?i*(1+r):i+r-i*r,a=2*i-s,l=[0,0,0];for(let e=0;e<3;e++)n=t+1/3*-(e-1),n<0&&n++,n>1&&n--,o=6*n<1?a+6*(s-a)*n:2*n<1?s:3*n<2?a+(s-a)*(2/3-n)*6:a,l[e]=255*o;return l},f.hsl.hsv=function(e){const t=e[0];let r=e[1]/100,i=e[2]/100,n=r;const o=Math.max(i,.01);return i*=2,r*=i<=1?i:2-i,n*=o<=1?o:2-o,[t,100*(0===i?2*n/(o+n):2*r/(i+r)),(i+r)/2*100]},f.hsv.rgb=function(e){const t=e[0]/60,r=e[1]/100;let i=e[2]/100;const n=Math.floor(t)%6,o=t-Math.floor(t),s=255*i*(1-r),a=255*i*(1-r*o),l=255*i*(1-r*(1-o));switch(i*=255,n){case 0:return[i,l,s];case 1:return[a,i,s];case 2:return[s,i,l];case 3:return[s,a,i];case 4:return[l,s,i];case 5:return[i,s,a]}},f.hsv.hsl=function(e){const t=e[0],r=e[1]/100,i=e[2]/100,n=Math.max(i,.01);let o,s;s=(2-r)*i;const a=(2-r)*n;return o=r*n,o/=a<=1?a:2-a,o=o||0,s/=2,[t,100*o,100*s]},f.hwb.rgb=function(e){const t=e[0]/360;let r=e[1]/100,i=e[2]/100;const n=r+i;let o;n>1&&(r/=n,i/=n);const s=Math.floor(6*t),a=1-i;o=6*t-s,1&s&&(o=1-o);const l=r+o*(a-r);let c,u,d;switch(s){default:case 6:case 0:c=a,u=l,d=r;break;case 1:c=l,u=a,d=r;break;case 2:c=r,u=a,d=l;break;case 3:c=r,u=l,d=a;break;case 4:c=l,u=r,d=a;break;case 5:c=a,u=r,d=l}return[255*c,255*u,255*d]},f.cmyk.rgb=function(e){const t=e[0]/100,r=e[1]/100,i=e[2]/100,n=e[3]/100;return[255*(1-Math.min(1,t*(1-n)+n)),255*(1-Math.min(1,r*(1-n)+n)),255*(1-Math.min(1,i*(1-n)+n))]},f.xyz.rgb=function(e){const t=e[0]/100,r=e[1]/100,i=e[2]/100;let n,o,s;return n=3.2404542*t+-1.5371385*r+-.4985314*i,o=-.969266*t+1.8760108*r+.041556*i,s=.0556434*t+-.2040259*r+1.0572252*i,n=b(n),o=b(o),s=b(s),[255*n,255*o,255*s]},f.xyz.lab=function(e){let t=e[0],r=e[1],i=e[2];return t/=95.047,r/=100,i/=108.883,t=t>g?t**(1/3):7.787*t+16/116,r=r>g?r**(1/3):7.787*r+16/116,i=i>g?i**(1/3):7.787*i+16/116,[116*r-16,500*(t-r),200*(r-i)]},f.xyz.oklab=function(e){const t=e[0]/100,r=e[1]/100,i=e[2]/100,n=Math.cbrt(.8189330101*t+.3618667424*r-.1288597137*i),o=Math.cbrt(.0329845436*t+.9293118715*r+.0361456387*i),s=Math.cbrt(.0482003018*t+.2643662691*r+.633851707*i);return[100*(.2104542553*n+.793617785*o-.0040720468*s),100*(1.9779984951*n-2.428592205*o+.4505937099*s),100*(.0259040371*n+.7827717662*o-.808675766*s)]},f.oklab.oklch=function(e){return f.lab.lch(e)},f.oklab.xyz=function(e){const t=e[0]/100,r=e[1]/100,i=e[2]/100,n=(.999999998*t+.396337792*r+.215803758*i)**3,o=(1.000000008*t-.105561342*r-.063854175*i)**3,s=(1.000000055*t-.089484182*r-1.291485538*i)**3;return[100*(1.227013851*n-.55779998*o+.281256149*s),100*(-.040580178*n+1.11225687*o-.071676679*s),100*(-.076381285*n-.421481978*o+1.58616322*s)]},f.oklab.rgb=function(e){const t=e[0]/100,r=e[1]/100,i=e[2]/100,n=(t+.3963377774*r+.2158037573*i)**3,o=(t-.1055613458*r-.0638541728*i)**3,s=(t-.0894841775*r-1.291485548*i)**3;return[255*b(4.0767416621*n-3.3077115913*o+.2309699292*s),255*b(-1.2684380046*n+2.6097574011*o-.3413193965*s),255*b(-.0041960863*n-.7034186147*o+1.707614701*s)]},f.oklch.oklab=function(e){return f.lch.lab(e)},f.lab.xyz=function(e){let t,r,i;r=(e[0]+16)/116,t=e[1]/500+r,i=r-e[2]/200;const n=r**3,o=t**3,s=i**3;return r=n>g?n:(r-16/116)/7.787,t=o>g?o:(t-16/116)/7.787,i=s>g?s:(i-16/116)/7.787,t*=95.047,r*=100,i*=108.883,[t,r,i]},f.lab.lch=function(e){const t=e[0],r=e[1],i=e[2];let n;return n=360*Math.atan2(i,r)/2/Math.PI,n<0&&(n+=360),[t,Math.sqrt(r*r+i*i),n]},f.lch.lab=function(e){const t=e[0],r=e[1],i=e[2]/360*2*Math.PI;return[t,r*Math.cos(i),r*Math.sin(i)]},f.rgb.ansi16=function(e,t=null){const[r,i,n]=e;let o=null===t?f.rgb.hsv(e)[2]:t;if(o=Math.round(o/50),0===o)return 30;let s=30+(Math.round(n/255)<<2|Math.round(i/255)<<1|Math.round(r/255));return 2===o&&(s+=60),s},f.hsv.ansi16=function(e){return f.rgb.ansi16(f.hsv.rgb(e),e[2])},f.rgb.ansi256=function(e){const t=e[0],r=e[1],i=e[2];return t>>4==r>>4&&r>>4==i>>4?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(i/255*5)},f.ansi16.rgb=function(e){let t=(e=e[0])%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const r=.5*(Math.trunc(e>50)+1);return[(1&t)*r*255,(t>>1&1)*r*255,(t>>2&1)*r*255]},f.ansi256.rgb=function(e){if((e=e[0])>=232){const t=10*(e-232)+8;return[t,t,t]}let t;return e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},f.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".slice(t.length)+t},f.hex.rgb=function(e){const t=e.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!t)return[0,0,0];let r=t[0];3===t[0].length&&(r=[...r].map(e=>e+e).join(""));const i=Number.parseInt(r,16);return[i>>16&255,i>>8&255,255&i]},f.rgb.hcg=function(e){const t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.max(Math.max(t,r),i),o=Math.min(Math.min(t,r),i),s=n-o;let a;return a=s<=0?0:n===t?(r-i)/s%6:n===r?2+(i-t)/s:4+(t-r)/s,a/=6,a%=1,[360*a,100*s,100*(s<1?o/(1-s):0)]},f.hsl.hcg=function(e){const t=e[1]/100,r=e[2]/100,i=r<.5?2*t*r:2*t*(1-r);let n=0;return i<1&&(n=(r-.5*i)/(1-i)),[e[0],100*i,100*n]},f.hsv.hcg=function(e){const t=e[1]/100,r=e[2]/100,i=t*r;let n=0;return i<1&&(n=(r-i)/(1-i)),[e[0],100*i,100*n]},f.hcg.rgb=function(e){const t=e[0]/360,r=e[1]/100,i=e[2]/100;if(0===r)return[255*i,255*i,255*i];const n=[0,0,0],o=t%1*6,s=o%1,a=1-s;let l=0;switch(Math.floor(o)){case 0:n[0]=1,n[1]=s,n[2]=0;break;case 1:n[0]=a,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=s;break;case 3:n[0]=0,n[1]=a,n[2]=1;break;case 4:n[0]=s,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=a}return l=(1-r)*i,[255*(r*n[0]+l),255*(r*n[1]+l),255*(r*n[2]+l)]},f.hcg.hsv=function(e){const t=e[1]/100,r=t+e[2]/100*(1-t);let i=0;return r>0&&(i=t/r),[e[0],100*i,100*r]},f.hcg.hsl=function(e){const t=e[1]/100,r=e[2]/100*(1-t)+.5*t;let i=0;return r>0&&r<.5?i=t/(2*r):r>=.5&&r<1&&(i=t/(2*(1-r))),[e[0],100*i,100*r]},f.hcg.hwb=function(e){const t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},f.hwb.hcg=function(e){const t=e[1]/100,r=1-e[2]/100,i=r-t;let n=0;return i<1&&(n=(r-i)/(1-i)),[e[0],100*i,100*n]},f.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},f.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},f.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},f.gray.hsl=function(e){return[0,0,e[0]]},f.gray.hsv=f.gray.hsl,f.gray.hwb=function(e){return[0,100,e[0]]},f.gray.cmyk=function(e){return[0,0,0,e[0]]},f.gray.lab=function(e){return[e[0],0,0]},f.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".slice(r.length)+r},f.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};var P=function(e){const t=function(e){const t=function(){const e={},t=Object.keys(m);for(let{length:r}=t,i=0;i<r;i++)e[t[i]]={distance:-1,parent:null};return e}(),r=[e];for(t[e].distance=0;r.length>0;){const e=r.pop(),i=Object.keys(m[e]);for(let{length:n}=i,o=0;o<n;o++){const n=i[o],s=t[n];-1===s.distance&&(s.distance=t[e].distance+1,s.parent=e,r.unshift(n))}}return t}(e),r={},i=Object.keys(t);for(let{length:e}=i,n=0;n<e;n++){const e=i[n];null!==t[e].parent&&(r[e]=E(e,t))}return r},I={},S=Object.keys(m);function _(e){const t=function(...t){const r=t[0];return null==r?r:(r.length>1&&(t=r),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}function O(e){const t=function(...t){const r=t[0];if(null==r)return r;r.length>1&&(t=r);const i=e(t);if("object"==typeof i)for(let{length:e}=i,t=0;t<e;t++)i[t]=Math.round(i[t]);return i};return"conversion"in e&&(t.conversion=e.conversion),t}for(const e of S){I[e]={},Object.defineProperty(I[e],"channels",{value:m[e].channels}),Object.defineProperty(I[e],"labels",{value:m[e].labels});const t=P(e),r=Object.keys(t);for(const i of r){const r=t[i];I[e][i]=O(r),I[e][i].raw=_(r)}}var k=I,x=["keyword","gray","hex"],A={};for(const e of Object.keys(k))A[[...k[e].labels].sort().join("")]=e;var j={};function C(e,t){if(!(this instanceof C))return new C(e,t);if(t&&t in x&&(t=null),t&&!(t in k))throw new Error("Unknown model: "+t);let r,i;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof C)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if("string"==typeof e){const t=p.get(e);if(null===t)throw new Error("Unable to parse color from string: "+e);this.model=t.model,i=k[this.model].channels,this.color=t.value.slice(0,i),this.valpha="number"==typeof t.value[i]?t.value[i]:1}else if(e.length>0){this.model=t||"rgb",i=k[this.model].channels;const r=Array.prototype.slice.call(e,0,i);this.color=M(r,i),this.valpha="number"==typeof e[i]?e[i]:1}else if("number"==typeof e)this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;const t=Object.keys(e);"alpha"in e&&(t.splice(t.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);const i=t.sort().join("");if(!(i in A))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=A[i];const{labels:n}=k[this.model],o=[];for(r=0;r<n.length;r++)o.push(e[n[r]]);this.color=M(o)}if(j[this.model])for(i=k[this.model].channels,r=0;r<i;r++){const e=j[this.model][r];e&&(this.color[r]=e(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}C.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in p.to?this:this.rgb();t=t.round("number"==typeof e?e:1);const r=1===t.valpha?t.color:[...t.color,this.valpha];return p.to[t.model](...r)},percentString(e){const t=this.rgb().round("number"==typeof e?e:1),r=1===t.valpha?t.color:[...t.color,this.valpha];return p.to.rgb.percent(...r)},array(){return 1===this.valpha?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:t}=k[this.model],{labels:r}=k[this.model];for(let i=0;i<t;i++)e[r[i]]=this.color[i];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new C([...this.color.map(N(e)),this.valpha],this.model)},alpha(e){return void 0!==e?new C([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:T("rgb",0,R(255)),green:T("rgb",1,R(255)),blue:T("rgb",2,R(255)),hue:T(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:T("hsl",1,R(100)),lightness:T("hsl",2,R(100)),saturationv:T("hsv",1,R(100)),value:T("hsv",2,R(100)),chroma:T("hcg",1,R(100)),gray:T("hcg",2,R(100)),white:T("hwb",1,R(100)),wblack:T("hwb",2,R(100)),cyan:T("cmyk",0,R(100)),magenta:T("cmyk",1,R(100)),yellow:T("cmyk",2,R(100)),black:T("cmyk",3,R(100)),x:T("xyz",0,R(95.047)),y:T("xyz",1,R(100)),z:T("xyz",2,R(108.833)),l:T("lab",0,R(100)),a:T("lab",1),b:T("lab",2),keyword(e){return void 0!==e?new C(e):k[this.model].keyword(this.color)},hex(e){return void 0!==e?new C(e):p.to.hex(...this.rgb().round().color)},hexa(e){if(void 0!==e)return new C(e);const t=this.rgb().round().color;let r=Math.round(255*this.valpha).toString(16).toUpperCase();return 1===r.length&&(r="0"+r),p.to.hex(...t)+r},rgbNumber(){const e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity(){const e=this.rgb().color,t=[];for(const[r,i]of e.entries()){const e=i/255;t[r]=e<=.04045?e/12.92:((e+.055)/1.055)**2.4}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){const t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level(e){const t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(2126*e[0]+7152*e[1]+722*e[2])/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){const t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){const t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){const t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){const t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){const t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){const t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){const e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return C.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const t=this.hsl();let r=t.color[0];return r=(r+e)%360,r=r<0?360+r:r,t.color[0]=r,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const r=e.rgb(),i=this.rgb(),n=void 0===t?.5:t,o=2*n-1,s=r.alpha()-i.alpha(),a=((o*s===-1?o:(o+s)/(1+o*s))+1)/2,l=1-a;return C.rgb(a*r.red()+l*i.red(),a*r.green()+l*i.green(),a*r.blue()+l*i.blue(),r.alpha()*n+i.alpha()*(1-n))}};for(const e of Object.keys(k)){if(x.includes(e))continue;const{channels:t}=k[e];C.prototype[e]=function(...t){return this.model===e?new C(this):t.length>0?new C(t,e):new C([...(r=k[this.model][e].raw(this.color),Array.isArray(r)?r:[r]),this.valpha],e);var r},C[e]=function(...r){let i=r[0];return"number"==typeof i&&(i=M(r,t)),new C(i,e)}}function N(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}function T(e,t,r){e=Array.isArray(e)?e:[e];for(const i of e)(j[i]||=[])[t]=r;return e=e[0],function(i){let n;return void 0!==i?(r&&(i=r(i)),n=this[e](),n.color[t]=i,n):(n=this[e]().color[t],r&&(n=r(n)),n)}}function R(e){return function(t){return Math.max(0,Math.min(e,t))}}function M(e,t){for(let r=0;r<t;r++)"number"!=typeof e[r]&&(e[r]=0);return e}var $=C},6641:(e,t,r)=>{"use strict";const i=r(4617);class n extends Error{constructor(e){super(e),this.name="TimeoutError"}}const o=(e,t,r)=>new Promise((o,s)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void o(e);const a=setTimeout(()=>{if("function"==typeof r){try{o(r())}catch(e){s(e)}return}const i=r instanceof Error?r:new n("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),s(i)},t);i(e.then(o,s),()=>{clearTimeout(a)})});e.exports=o,e.exports.default=o,e.exports.TimeoutError=n},6672:(e,t,r)=>{const{InstanceStatus:i}=r(6278),n=r(7814);e.exports={async initConnection(){let e=this;if(clearInterval(e.INTERVAL),clearInterval(e.INTERVAL_SOURCES),clearInterval(e.RECONNECT_INTERVAL),e.config.host&&""!==e.config.host){e.updateStatus(i.Connecting),e.log("info",`Opening connection to ${e.config.host}`),e.STATE.mode=e.config.mode,e.DEVICE=new n(e.config.host,e.config.username,e.config.password);let t=!1;if(!1===e.config.useAuth)e.log("info","No authentication required. Connecting to device..."),t=!0;else try{e.log("info","Attempting to authorize..."),t=await e.DEVICE.authorize()}catch(t){return void("KiloviewNDIError"===t.name?(e.log("error","Authorization failed. Check your username and password and try again."),e.updateStatus(i.ConnectionFailure,"Authorization Failed. See log.")):(e.log("error","Could not reach device. Retrying in 30 seconds."),e.updateStatus(i.ConnectionFailure),e.startReconnectInterval()))}!0===t?(e.updateStatus(i.Ok),e.alias=e.DEVICE.alias,e.log("info",`Connected to Device with user: ${e.alias}`),this.initActions(),this.initFeedbacks(),this.initVariables(),this.initPresets(),await new Promise(e=>setTimeout(e,8e3)),e.checkState(),e.startInterval(),e.startNDISourcesInterval(),e.config.picManage):(e.log("error","Authorization failed. Check your username and password and try again."),e.updateStatus(i.ConnectionFailure,"Authorization Failed. See log."))}},startReconnectInterval:function(){let e=this;e.updateStatus(i.ConnectionFailure,"Reconnecting"),void 0!==e.RECONNECT_INTERVAL&&(clearInterval(e.RECONNECT_INTERVAL),e.RECONNECT_INTERVAL=void 0),e.log("info","Attempting to reconnect in 30 seconds..."),e.RECONNECT_INTERVAL=setTimeout(e.initConnection.bind(this),3e4)},startInterval:function(){let e=this;e.config.polling?((void 0===e.config.pollingrate||e.config.pollingrate<1e3)&&(e.config.pollingrate=1e3),e.log("info",`Starting Update Interval: Fetching new data from Device every ${e.config.pollingrate}ms.`),e.INTERVAL=setInterval(e.checkState.bind(e),parseInt(e.config.pollingrate))):e.log("info","Polling is disabled. Module will not request new data at a regular rate. Feedbacks and Variables will not update.")},async startNDISourcesInterval(){let e=this;e.config.polling?((void 0===e.config.pollingrate_sources||e.config.pollingrate_sources<1e3)&&(e.config.pollingrate_sources=1e4),e.INTERVAL_SOURCES=setInterval(e.checkSources.bind(e),parseInt(e.config.pollingrate_sources))):e.log("info","Polling is disabled. Module will not request new NDI sources at a regular rate.")},async checkState(){let e=this;if(e.DEVICE){try{const t=await e.DEVICE.modeGet();"encoder"!==t.data.mode&&"decoder"!==t.data.mode||(e.STATE.mode=t.data.mode,e.updateStatus(i.Ok))}catch(t){return e.log("error","Error getting mode: "+t.message),e.updateStatus(i.ConnectionFailure),void(e.STATE.mode="N/A")}try{if("decoder"===e.STATE.mode){const t=await e.DEVICE.decoderCurrentStatus();e.STATE.info=t;const r=await e.DEVICE.decoderPresets();JSON.stringify(e.STATE.presets)!==JSON.stringify(r)&&(e.log("info","NDI Presets have changed. Updating Presets..."),e.STATE.presets=r,e.initActions(),e.initPresets())}else if("encoder"==e.STATE.mode){const t=await e.DEVICE.encoderNdiStatus();e.STATE.info=t}}catch(e){console.log("Error with info: "+e.message)}try{const t=await e.DEVICE.sysServerInfo();e.STATE.server_info=t}catch(e){console.log("Error with server_info: "+e.message)}e.config.picManage,e.checkFeedbacks(),e.checkVariables()}},async checkSources(){let e=this;if(!e.DEVICE)return;let t=[];if("decoder"===e.STATE.mode){const r=await e.DEVICE.decoderDiscoveryGet();r&&r.data instanceof Array?r.data.forEach(e=>{t.push({id:Buffer.from(e.name+":"+e.url).toString("base64"),label:e.name}),e.children?.length&&e.children.forEach(e=>{t.push({id:Buffer.from(e.name+":"+e.url).toString("base64"),label:e.name})})}):t=[{id:"null",url:"",label:"- No sources available -"}]}else"encoder"===e.STATE.mode&&(t=[{id:"null",url:"",label:"- No sources available -"}]);JSON.stringify(e.CHOICES_SOURCES)!==JSON.stringify(t)&&(e.log("info","NDI Sources have changed. Updating Choices."),e.CHOICES_SOURCES=t,e.initActions(),e.initFeedbacks(),e.initVariables(),e.initPresets())},async picManageAdd(e,t){let r=this;if(r.DEVICE)try{r.log("info",`Adding Picture: ${e}`),await r.DEVICE.picManageAdd(e,t)}catch(e){console.log("Error with picManageAdd: "+e.message)}},async picManageReset(e){let t=this;if(t.DEVICE)try{t.log("info",`Resetting Picture: ${e}`),await t.DEVICE.picManageReset(e)}catch(e){console.log("Error with picManageReset: "+e.message)}},async getPics(){let e=this;if(e.DEVICE)try{e.config.verbose&&(e.log("info","Fetching Pictures from Picture Management..."),console.log("now: "+(new Date).toLocaleTimeString()));let t=await e.fetchAndEncodeImage("NOSIGNAL"),r=await e.fetchAndEncodeImage("SPLASH"),i=await e.fetchAndEncodeImage("UNSUPPORT_CODEC"),n=await e.fetchAndEncodeImage("UNSUPPORT");e.PICS.NOSIGNAL_FULL!==t&&(e.PICS.NOSIGNAL_FULL=t,e.PICS.NOSIGNAL=await e.resize(t)),e.PICS.SPLASH_FULL!==r&&(e.PICS.SPLASH_FULL=r,e.PICS.SPLASH=await e.resize(r)),e.PICS.UNSUPPORT_CODEC_FULL!==i&&(e.PICS.UNSUPPORT_CODEC_FULL=i,e.PICS.UNSUPPORT_CODEC=await e.resize(i)),e.PICS.UNSUPPORT_FULL!==n&&(e.PICS.UNSUPPORT_FULL=n,e.PICS.UNSUPPORT=await e.resize(n)),e.config.verbose&&console.log("done: "+(new Date).toLocaleTimeString())}catch(e){console.log("Error with getPics(): "+e.message)}},async fetchAndEncodeImage(e){let t=this;try{const r=await fetch(`http://${t.config.host}/img/${e}.png`),i=await r.arrayBuffer();return Buffer.from(i).toString("base64")}catch(e){return void console.error("Error fetching or encoding image:",e)}},async resize(e){const t=r(2926);console.log("Resizing image...");const i=Buffer.from(e,"base64");return(await t(i).resize(72,72,{fit:"inside",background:{r:0,g:0,b:0,alpha:0}}).toBuffer()).toString("base64")}}},6760:e=>{"use strict";e.exports=require("node:path")},6874:e=>{"use strict";const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},6912:e=>{e.exports=__dirname},6928:e=>{"use strict";e.exports=require("path")},7e3:(e,t,r)=>{"use strict";const i=r(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:r=0,maxWait:n=0,before:o=!1,after:s=!0}=t;if(!o&&!s)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let a,l,c;const u=function(...t){const i=this,u=o&&!a;return clearTimeout(a),a=setTimeout(()=>{a=void 0,l&&(clearTimeout(l),l=void 0),s&&(c=e.apply(i,t))},r),n>0&&!l&&s&&(l=setTimeout(()=>{l=void 0,a&&(clearTimeout(a),a=void 0),c=e.apply(i,t)},n)),u&&(c=e.apply(i,t)),c};return i(u,e),u.cancel=()=>{a&&(clearTimeout(a),a=void 0),l&&(clearTimeout(l),l=void 0)},u}},7059:(e,t,r)=>{"use strict";const i=r(560);e.exports=(e,t,r)=>i(e,t,r)<0},7075:e=>{"use strict";e.exports=require("node:stream")},7194:e=>{"use strict";e.exports=require("dgram")},7272:e=>{"use strict";const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},7281:(e,t,r)=>{"use strict";e.exports=a,e.exports.default=a;const i={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},isPrerelease:{type:"boolean",description:"Is this a pre-release version"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"},url:{type:"string"}},required:["name"],additionalProperties:!1}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18 or node22",enum:["node18","node22"]},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"},permissions:{type:"object",description:"Permissions required by the module. This is used to inform the user of the permissions required by the module.\nNote: this requires the node22 or newer runtime",properties:{"worker-threads":{type:"boolean",description:"Enable if the module uses worker threads"},"child-process":{type:"boolean",description:"Enable if the module uses child processes"},"native-addons":{type:"boolean",description:"Enable if the module uses native addons"},filesystem:{type:"boolean",description:"Enable if the module requires read/write access to the filesystem"}},additionalProperties:!1}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}}}},required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]}}},n={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]},o=r(6250).A,s=new RegExp("","u");function a(e,{instancePath:t="",parentData:r,parentDataProperty:l,rootData:c=e}={}){let u=null,d=0;if(0===d){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.id&&(r="id")||void 0===e.name&&(r="name")||void 0===e.shortname&&(r="shortname")||void 0===e.description&&(r="description")||void 0===e.version&&(r="version")||void 0===e.license&&(r="license")||void 0===e.repository&&(r="repository")||void 0===e.bugs&&(r="bugs")||void 0===e.maintainers&&(r="maintainers")||void 0===e.legacyIds&&(r="legacyIds")||void 0===e.runtime&&(r="runtime")||void 0===e.manufacturer&&(r="manufacturer")||void 0===e.products&&(r="products")||void 0===e.keywords&&(r="keywords"))return a.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;if(void 0!==e.$schema){const r=d;if("string"!=typeof e.$schema)return a.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var p=r===d}else p=!0;if(p){if(void 0!==e.id){const r=d;if("string"!=typeof e.id)return a.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.name){const r=d;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.shortname){const r=d;if("string"!=typeof e.shortname)return a.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.description){const r=d;if("string"!=typeof e.description)return a.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.version){const r=d;if("string"!=typeof e.version)return a.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.isPrerelease){const r=d;if("boolean"!=typeof e.isPrerelease)return a.errors=[{instancePath:t+"/isPrerelease",schemaPath:"#/properties/isPrerelease/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.license){const r=d;if("string"!=typeof e.license)return a.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.repository){const r=d;if("string"!=typeof e.repository)return a.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.bugs){const r=d;if("string"!=typeof e.bugs)return a.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.maintainers){let r=e.maintainers;const i=d;if(d===i){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var h=!0;const e=r.length;for(let i=0;i<e;i++){let e=r[i];const n=d;if(d===n){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/maintainers/"+i,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.name&&(r="name"))return a.errors=[{instancePath:t+"/maintainers/"+i,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;{const r=d;for(const r in e)if("name"!==r&&"email"!==r&&"github"!==r&&"url"!==r)return a.errors=[{instancePath:t+"/maintainers/"+i,schemaPath:"#/properties/maintainers/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===d){if(void 0!==e.name){const r=d;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/maintainers/"+i+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=r===d}else f=!0;if(f){if(void 0!==e.email){const r=d;if("string"!=typeof e.email)return a.errors=[{instancePath:t+"/maintainers/"+i+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.github){const r=d;if("string"!=typeof e.github)return a.errors=[{instancePath:t+"/maintainers/"+i+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f)if(void 0!==e.url){const r=d;if("string"!=typeof e.url)return a.errors=[{instancePath:t+"/maintainers/"+i+"/url",schemaPath:"#/properties/maintainers/items/properties/url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0}}}}}}if(!(h=n===d))break}if(h){let e,i=r.length;if(i>1)for(;i--;)for(e=i;e--;)if(o(r[i],r[e]))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1}}}p=i===d}else p=!0;if(p){if(void 0!==e.legacyIds){let r=e.legacyIds;const i=d;if(d===i){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var m=!0;const e=r.length;for(let i=0;i<e;i++){const e=d;if("string"!=typeof r[i])return a.errors=[{instancePath:t+"/legacyIds/"+i,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(m=e===d))break}if(m){let e,i=r.length;if(i>1){const n={};for(;i--;){let o=r[i];if("string"==typeof o){if("number"==typeof n[o])return e=n[o],a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;n[o]=i}}}}}}p=i===d}else p=!0;if(p){if(void 0!==e.runtime){let r=e.runtime;const n=d;if(d===n){if(!r||"object"!=typeof r||Array.isArray(r))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===r.type&&(e="type")||void 0===r.api&&(e="api")||void 0===r.apiVersion&&(e="apiVersion")||void 0===r.entrypoint&&(e="entrypoint"))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==r.type){let e=r.type;const n=d;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("node18"!==e&&"node22"!==e)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/enum",keyword:"enum",params:{allowedValues:i.properties.runtime.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var g=n===d}else g=!0;if(g){if(void 0!==r.api){let e=r.api;const n=d;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:i.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;g=n===d}else g=!0;if(g){if(void 0!==r.apiVersion){const e=d;if("string"!=typeof r.apiVersion)return a.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===d}else g=!0;if(g){if(void 0!==r.entrypoint){const e=d;if("string"!=typeof r.entrypoint)return a.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===d}else g=!0;if(g)if(void 0!==r.permissions){let e=r.permissions;const i=d;if(d===i){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const r=d;for(const r in e)if("worker-threads"!==r&&"child-process"!==r&&"native-addons"!==r&&"filesystem"!==r)return a.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===d){if(void 0!==e["worker-threads"]){const r=d;if("boolean"!=typeof e["worker-threads"])return a.errors=[{instancePath:t+"/runtime/permissions/worker-threads",schemaPath:"#/properties/runtime/properties/permissions/properties/worker-threads/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var b=r===d}else b=!0;if(b){if(void 0!==e["child-process"]){const r=d;if("boolean"!=typeof e["child-process"])return a.errors=[{instancePath:t+"/runtime/permissions/child-process",schemaPath:"#/properties/runtime/properties/permissions/properties/child-process/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;b=r===d}else b=!0;if(b){if(void 0!==e["native-addons"]){const r=d;if("boolean"!=typeof e["native-addons"])return a.errors=[{instancePath:t+"/runtime/permissions/native-addons",schemaPath:"#/properties/runtime/properties/permissions/properties/native-addons/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;b=r===d}else b=!0;if(b)if(void 0!==e.filesystem){const r=d;if("boolean"!=typeof e.filesystem)return a.errors=[{instancePath:t+"/runtime/permissions/filesystem",schemaPath:"#/properties/runtime/properties/permissions/properties/filesystem/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;b=r===d}else b=!0}}}}}g=i===d}else g=!0}}}}}p=n===d}else p=!0;if(p){if(void 0!==e.manufacturer){const r=d;if("string"!=typeof e.manufacturer)return a.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.products){let r=e.products;const i=d;if(d===i){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(r.length<1)return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var y=!0;const e=r.length;for(let i=0;i<e;i++){const e=d;if("string"!=typeof r[i])return a.errors=[{instancePath:t+"/products/"+i,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(y=e===d))break}if(y){let e,i=r.length;if(i>1){const n={};for(;i--;){let o=r[i];if("string"==typeof o){if("number"==typeof n[o])return e=n[o],a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;n[o]=i}}}}}}p=i===d}else p=!0;if(p){if(void 0!==e.keywords){let r=e.keywords;const i=d;if(d===i){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var v=!0;const e=r.length;for(let i=0;i<e;i++){const e=d;if("string"!=typeof r[i])return a.errors=[{instancePath:t+"/keywords/"+i,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(v=e===d))break}if(v){let e,i=r.length;if(i>1){const n={};for(;i--;){let o=r[i];if("string"==typeof o){if("number"==typeof n[o])return e=n[o],a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;n[o]=i}}}}}}p=i===d}else p=!0;if(p)if(void 0!==e.bonjourQueries){let r=e.bonjourQueries;const i=d;if(d===i){if(!r||"object"!=typeof r||Array.isArray(r))return a.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(const e in r)if(s.test(e)){let i=r[e];const o=d,l=d;let c=!1,p=null;const h=d;if(d==d)if(i&&"object"==typeof i&&!Array.isArray(i)){let r;if(void 0===i.type&&(r="type")||void 0===i.protocol&&(r="protocol")){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===u?u=[i]:u.push(i),d++}else{if(void 0!==i.type){const r=d;if("string"!=typeof i.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[r]:u.push(r),d++}var w=r===d}else w=!0;if(w){if(void 0!==i.protocol){let r=i.protocol;const o=d;if("string"!=typeof r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[r]:u.push(r),d++}if("tcp"!==r&&"udp"!==r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:n.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===u?u=[r]:u.push(r),d++}w=o===d}else w=!0;if(w){if(void 0!==i.port){let r=i.port;const n=d;if("number"!=typeof r||!isFinite(r)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===u?u=[r]:u.push(r),d++}w=n===d}else w=!0;if(w)if(void 0!==i.txt){let r=i.txt;const n=d;if(d===n)if(r&&"object"==typeof r&&!Array.isArray(r)){for(const i in r)if(s.test(i)){const n=d;if("string"!=typeof r[i]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+i.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[r]:u.push(r),d++}if(n!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===u?u=[r]:u.push(r),d++}w=n===d}else w=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===u?u=[r]:u.push(r),d++}h===d&&(c=!0,p=0);const f=d;if(d===f)if(Array.isArray(i)){const r=i.length;for(let o=0;o<r;o++){let r=i[o];const a=d;if(d==d)if(r&&"object"==typeof r&&!Array.isArray(r)){let i;if(void 0===r.type&&(i="type")||void 0===r.protocol&&(i="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:i},message:"must have required property '"+i+"'"};null===u?u=[r]:u.push(r),d++}else{if(void 0!==r.type){const i=d;if("string"!=typeof r.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[r]:u.push(r),d++}var E=i===d}else E=!0;if(E){if(void 0!==r.protocol){let i=r.protocol;const s=d;if("string"!=typeof i){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[r]:u.push(r),d++}if("tcp"!==i&&"udp"!==i){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:n.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===u?u=[r]:u.push(r),d++}E=s===d}else E=!0;if(E){if(void 0!==r.port){let i=r.port;const n=d;if("number"!=typeof i||!isFinite(i)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===u?u=[r]:u.push(r),d++}E=n===d}else E=!0;if(E)if(void 0!==r.txt){let i=r.txt;const n=d;if(d===n)if(i&&"object"==typeof i&&!Array.isArray(i)){for(const r in i)if(s.test(r)){const n=d;if("string"!=typeof i[r]){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[i]:u.push(i),d++}if(n!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===u?u=[r]:u.push(r),d++}E=n===d}else E=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+o,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===u?u=[r]:u.push(r),d++}if(a!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===u?u=[r]:u.push(r),d++}var P;if((P=f===d)&&c?(c=!1,p=[p,1]):P&&(c=!0,p=1),!c){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:p},message:"must match exactly one schema in oneOf"};return null===u?u=[r]:u.push(r),d++,a.errors=u,!1}if(d=l,null!==u&&(l?u.length=l:u=null),o!==d)break}}p=i===d}else p=!0}}}}}}}}}}}}}}}}}return a.errors=u,0===d}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7418:(e,t,r)=>{var i={"./sharp-libvips-linux-x64/package":6260};function n(e){var t=o(e);return r(t)}function o(e){if(!r.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=7418},7598:e=>{"use strict";e.exports=require("node:crypto")},7638:(e,t,r)=>{"use strict";const i=r(8311);e.exports=(e,t,r)=>{try{t=new i(t,r)}catch(e){return!1}return t.test(e)}},7695:(e,t,r)=>{var i={"./sharp-libvips-linux-x64/versions":5373};function n(e){var t=o(e);return r(t)}function o(e){if(!r.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=7695},7814:(e,t,r)=>{e.exports=class{connection_info={ip:"",username:"",password:""};session={token:"",session:""};apiVersion="v1";constructor(e,t,r,i=2e3){this.connection_info={ip:e,username:t,password:r},this.baseURL=`http://${e}/api/${this.apiVersion}`,this.authorized=!1}setAuthorized(e){this.authorized=e}async authorize(){try{const{username:e,password:t}=this.connection_info,r=new URLSearchParams;r.append("username",e),r.append("password",t);const i=await fetch(`${this.baseURL}/user/authorize`,{method:"POST",body:r});let n=await i.json();if(n&&"error"===n.result){let e=new Error(n.msg);throw e.name="KiloviewNDIError",e}return this.session={token:n.data.token,session:n.data.session},this.alias=n.data.alias,this.headers={"API-Session":this.session.session,"API-Token":this.session.token,"Content-Type":"application/json"},this.authorized=!0,!0}catch(e){throw e}}async authPost(e,t){this.authorized||await this.authorize();let r={method:"POST",headers:this.headers};t&&(r.body=JSON.stringify(t));const i=await fetch(`${this.baseURL}${e}`,r);let n=await i.json();if(n&&"auth-failed"===n.result)return await this.authorize(),this.authPost(e,t);if(n&&"error"===n.result){console.log(n);let e=new Error(n.msg);throw e.name="KiloviewNDIError",e}return n}async modeGet(){return await this.authPost("/mode/get")}async modeSwitch(e){return await this.authPost("/mode/switch",{mode:e})}modeStatus(){return this.authPost("/mode/status")}decoderDiscoveryGet(){return this.authPost("/decoder/discovery/get")}decoderCurrentStatus(){return this.authPost("/decoder/current/status")}decoderCurrentSetPreset(e){return this.authPost("/decoder/current/set",{id:e})}decoderCurrentSetUrl(e,t){return this.authPost("/decoder/current/set",{name:e,url:t})}decoderPresets(){return this.authPost("/decoder/preset/status")}decoderPresetAdd(e,t,r,i){return this.authPost("/decoder/preset/add",{id:e,name:t,url:r,group:i})}decoderPresetRemove(e){return this.authPost("/decoder/preset/remove",{id:e})}decoderPresetSetBlank(e){return this.authPost("/decoder/preset/set_blank",{color:e})}decoderSetOutputResolution(e){return this.authPost("/decoder/output/set",{resolution:e})}decoderSetOutputFrameRate(e){return this.authPost("/decoder/output/set",{frame_rate:e})}decoderSetOutputAudioSampleRate(e){return this.authPost("/decoder/output/set",{sample_rate:e})}encoderNdiStatus(){return this.authPost("/encoder/ndi/status")}encoderNdiGetConfig(){return this.authPost("/encoder/ndi/get_config")}encoderNdiSetAudioSignalType(e){return this.authPost("/encoder/ndi/set_audio",{type:e})}encoderNdiSetAudioVolume(e){return this.authPost("/encoder/ndi/set_audio",{volume:e})}tallyGet(){return this.authPost("/tally/get")}tallySet(e,t){return this.authPost("/tally/set",{pgm:e,pvw:t})}encoderNdiSetConfig(e){return this.authPost("/encoder/ndi/set_config",e)}sysServerInfo(){return this.authPost("/sys/server_info")}sysReconnect(){return this.authPost("/sys/reconnect")}sysReboot(){return this.authPost("/sys/reboot")}sysRestore(){return this.authPost("/sys/restore")}picManageAdd(e,t){const{exec:i}=r(5317);i(`curl -X POST http://${this.connection_info.ip}/api/pic/add.json \t\t-H "API-Token: ${this.session.token}" \t\t-F "upload=@${t}" \t\t-F "name=${e}" \t\t-F "size_w=1920" \t\t-F "size_h=1080"`,(e,t,r)=>{})}picManageReset(e){let t={"API-Session":this.session.session,"API-Token":this.session.token,"Content-Type":"application/json"};fetch(`http://${this.connection_info.ip}/api/pic/resetPic.json`,{method:"POST",body:JSON.stringify({name:e}),headers:t}).then(e=>e.json()).then(e=>{console.log("Response:",e)}).catch(e=>{console.error("Error:",e)})}}},7816:e=>{"use strict";e.exports=JSON.parse('{"name":"sharp","description":"High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images","version":"0.34.4","author":"Lovell Fuller <npm@lovell.info>","homepage":"https://sharp.pixelplumbing.com","contributors":["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unnebck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix Bnemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","Jrmy Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kotovec <jarda.kotesovec@gmail.com>","Kenric D\'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O\'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Choucio <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>","Don Denton <don@happycollision.com>"],"scripts":{"install":"node install/check.js","clean":"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*","test":"npm run test-lint && npm run test-unit && npm run test-licensing && npm run test-types","test-lint":"semistandard && cpplint","test-unit":"nyc --reporter=lcov --reporter=text --check-coverage --branches=100 mocha","test-licensing":"license-checker --production --summary --onlyAllow=\\"Apache-2.0;BSD;ISC;LGPL-3.0-or-later;MIT\\"","test-leak":"./test/leak/leak.sh","test-types":"tsd","package-from-local-build":"node npm/from-local-build.js","package-release-notes":"node npm/release-notes.js","docs-build":"node docs/build.mjs","docs-serve":"cd docs && npm start","docs-publish":"cd docs && npm run build && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},"type":"commonjs","main":"lib/index.js","types":"lib/index.d.ts","files":["install","lib","src/*.{cc,h,gyp}"],"repository":{"type":"git","url":"git://github.com/lovell/sharp.git"},"keywords":["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],"dependencies":{"@img/colour":"^1.0.0","detect-libc":"^2.1.0","semver":"^7.7.2"},"optionalDependencies":{"@img/sharp-darwin-arm64":"0.34.4","@img/sharp-darwin-x64":"0.34.4","@img/sharp-libvips-darwin-arm64":"1.2.3","@img/sharp-libvips-darwin-x64":"1.2.3","@img/sharp-libvips-linux-arm":"1.2.3","@img/sharp-libvips-linux-arm64":"1.2.3","@img/sharp-libvips-linux-ppc64":"1.2.3","@img/sharp-libvips-linux-s390x":"1.2.3","@img/sharp-libvips-linux-x64":"1.2.3","@img/sharp-libvips-linuxmusl-arm64":"1.2.3","@img/sharp-libvips-linuxmusl-x64":"1.2.3","@img/sharp-linux-arm":"0.34.4","@img/sharp-linux-arm64":"0.34.4","@img/sharp-linux-ppc64":"0.34.4","@img/sharp-linux-s390x":"0.34.4","@img/sharp-linux-x64":"0.34.4","@img/sharp-linuxmusl-arm64":"0.34.4","@img/sharp-linuxmusl-x64":"0.34.4","@img/sharp-wasm32":"0.34.4","@img/sharp-win32-arm64":"0.34.4","@img/sharp-win32-ia32":"0.34.4","@img/sharp-win32-x64":"0.34.4"},"devDependencies":{"@emnapi/runtime":"^1.5.0","@img/sharp-libvips-dev":"1.2.3","@img/sharp-libvips-dev-wasm32":"1.2.3","@img/sharp-libvips-win32-arm64":"1.2.3","@img/sharp-libvips-win32-ia32":"1.2.3","@img/sharp-libvips-win32-x64":"1.2.3","@types/node":"*","cc":"^3.0.1","emnapi":"^1.5.0","exif-reader":"^2.0.2","extract-zip":"^2.0.1","icc":"^3.0.0","jsdoc-to-markdown":"^9.1.2","license-checker":"^25.0.1","mocha":"^11.7.2","node-addon-api":"^8.5.0","node-gyp":"^11.4.2","nyc":"^17.1.0","semistandard":"^17.0.0","tar-fs":"^3.1.1","tsd":"^0.33.0"},"license":"Apache-2.0","engines":{"node":"^18.17.0 || ^20.3.0 || >=21.0.0"},"config":{"libvips":">=8.17.2"},"funding":{"url":"https://opencollective.com/libvips"},"semistandard":{"env":["mocha"]},"cc":{"linelength":"120","filter":["build/include"]},"nyc":{"include":["lib"]},"tsd":{"directory":"test/types/"}}')},7969:e=>{e.exports={initVariables(){let e=this,t=[];if(t.push({variableId:"mode",name:"Current Converter Mode"}),t.push({variableId:"alias",name:"Authorized User"}),t.push({variableId:"resolution",name:"Resolution"}),t.push({variableId:"audio_format",name:"Audio Format"}),"encoder"==e.STATE.mode)t.push({variableId:"video_signal",name:"Video Signal Present"}),t.push({variableId:"bitrate",name:"NDI Bitrate"});else{t.push({variableId:"codec",name:"NDI Codec"}),t.push({variableId:"streamname",name:"NDI Stream Name"}),t.push({variableId:"online_state",name:"NDI Source Online"});for(let r=1;r<=e.CHOICES_PRESETS.length;r++)t.push({variableId:"preset"+r+"_enabled",name:"Preset "+r+" Enabled"}),t.push({variableId:"preset"+r+"_group",name:"Preset "+r+" Group"}),t.push({variableId:"preset"+r+"_name",name:"Preset "+r+" Name"}),t.push({variableId:"preset"+r+"_device_name",name:"Preset "+r+" Device Name"}),t.push({variableId:"preset"+r+"_channel_name",name:"Preset "+r+" Channel Name"}),t.push({variableId:"preset"+r+"_url",name:"Preset "+r+" URL"}),t.push({variableId:"preset"+r+"_ip",name:"Preset "+r+" IP"}),t.push({variableId:"preset"+r+"_online",name:"Preset "+r+" Online"}),t.push({variableId:"preset"+r+"_current",name:"Preset "+r+" Current"})}t.push({variableId:"cpu_cores",name:"CPU Cores"}),t.push({variableId:"cpu_payload",name:"CPU Payload"}),t.push({variableId:"mem_used",name:"Memory Used"}),t.push({variableId:"mem_total",name:"Memory Total"}),t.push({variableId:"start_time",name:"Device Start Time"}),t.push({variableId:"persis",name:"Device Uptime"}),e.setVariableDefinitions(t)},checkVariables(){let e=this;try{let t={};if(t.mode="encoder"===e.STATE.mode?"Encoder":"Decoder",t.alias=e.alias||"",t.resolution=e.STATE.info.data.resolution||"",t.audio_format=e.STATE.info.data.audio_format||"",e.STATE.info)if("encoder"===e.STATE.mode)t.device_name=e.STATE.info.data.device_name,t.video_signal=e.STATE.info.data.video_signal?"True":"False",t.bitrate=e.STATE.info.data.bitrate;else if(t.codec=e.STATE.info.data.codec,t.streamname=e.STATE.info.data.name||"",t.online_state=e.STATE.info.data.online?"True":"False",e.STATE.presets)for(let r=1;r<=e.CHOICES_PRESETS.length;r++){let i=e.STATE.presets.data.find(e=>e.id.toString()==r.toString());i&&(t["preset"+r+"_enabled"]=i.enable?"True":"False",t["preset"+r+"_group"]=i.group,t["preset"+r+"_name"]=i.name,t["preset"+r+"_device_name"]=i.device_name,t["preset"+r+"_channel_name"]=i.channel_name,t["preset"+r+"_url"]=i.url,t["preset"+r+"_ip"]=i.ip,t["preset"+r+"_online"]=i.online?"True":"False",t["preset"+r+"_current"]=i.current?"True":"False")}e.STATE.server_info&&(t.cpu_cores=e.STATE.server_info.data.cpu_cores,t.cpu_payload=e.STATE.server_info.data.cpu_payload,t.mem_used=e.STATE.server_info.data.mem_used,t.mem_total=e.STATE.server_info.data.mem_total,t.start_time=e.STATE.server_info.data.start_time,t.persis=e.STATE.server_info.data.persis),e.setVariableValues(t)}catch(t){e.log("error","Error setting Variables: "+String(t))}}}},7975:e=>{"use strict";e.exports=require("node:util")},8039:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const i=r(1635),n=r(2593),o=i.__importDefault(r(7e3)),s=r(360);function a(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#j;#B;#q;#T;#z=new Map;#H=new Map;#G=new Map;#W=new Map;#J;get parseVariablesContext(){return this.#J}constructor(e,t,r,i){this.#j=e,this.#B=t,this.#q=r,this.#T=i}getDefinitionIds(){return Array.from(this.#z.keys())}getInstanceIds(){return Array.from(this.#H.keys())}handleUpdateFeedbacks(e){for(const[t,r]of Object.entries(e)){const e=this.#H.get(t);if(e&&!r){const t=this.#z.get(e.feedbackId);if(t?.unsubscribe){const r={parseVariablesInString:async e=>e};Promise.resolve(t.unsubscribe(a(t.type,e),r)).catch(t=>{this.#T("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}if(!r||r.disabled)this.#H.delete(t);else{if(this.#H.set(t,{...r}),!e){const e=this.#z.get(r.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>e};Promise.resolve(e.subscribe(a(e.type,r),t)).catch(e=>{this.#T("error",`Feedback subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)})}}this.#Q(t)}}}async handleLearnFeedback(e){const t=this.#z.get(e.feedback.feedbackId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#j({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},r)}}return{options:void 0}}#Q(e){const t=this.#W.get(e);if(t)return void(t.needsRecheck=!0);const r=this.#H.get(e);if(!r)return;const i=r,n={needsRecheck:!1};this.#W.set(e,n),Promise.resolve().then(async()=>{const t=this.#z.get(i.feedbackId);let r;if(t){this.#J=`Feedback ${i.feedbackId} (${e})`;const n={parseVariablesInString:async t=>(await this.#j({text:t,controlId:i.controlId,actionInstanceId:void 0,feedbackInstanceId:e})).text};switch(t.type){case"boolean":r=t.callback({...a("boolean",i),type:"boolean"},n);break;case"value":r=t.callback({...a("value",i),type:"value"},n);break;case"advanced":r=t.callback({...a("advanced",i),type:"advanced",image:i.image},n);break;default:(0,s.assertNever)(t)}this.#J=void 0}const n=await r;this.#G.set(e,{id:e,controlId:i.controlId,value:n}),this.#X()}).catch(e=>{console.error(`Feedback check failed: ${JSON.stringify(i)} - ${e?.message??e} ${e?.stack}`)}).finally(()=>{this.#J=void 0,this.#W.delete(e),n.needsRecheck&&setImmediate(()=>{this.#Q(e)})})}#X=(0,o.default)(()=>{const e=this.#G;this.#G=new Map,e.size>0&&this.#B({values:Array.from(e.values())})},{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#z.clear();for(const[r,i]of Object.entries(e))i&&(t.push({id:r,name:i.name,description:i.description,options:(0,n.serializeIsVisibleFn)(i.options),type:i.type,defaultStyle:"boolean"===i.type?i.defaultStyle:void 0,hasLearn:!!i.learn,learnTimeout:i.learnTimeout,showInvert:"boolean"===i.type&&i.showInvert}),this.#z.set(r,i));this.#q({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,r]of this.#H.entries())this.#z.get(r.feedbackId)&&(0===t.size||t.has(r.feedbackId))&&this.#Q(e)}checkFeedbacksById(e){for(const t of e)this.#Q(t)}subscribeFeedbacks(e){let t=Array.from(this.#H.values());const r=new Set(e);r.size&&(t=t.filter(e=>r.has(e.feedbackId)));for(const e of t){const t=this.#z.get(e.feedbackId);if(t?.subscribe){const r={parseVariablesInString:async e=>e};Promise.resolve(t.subscribe(a(t.type,e),r)).catch(t=>{this.#T("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}unsubscribeFeedbacks(e){let t=Array.from(this.#H.values());const r=new Set(e);r.size&&(t=t.filter(e=>r.has(e.feedbackId)));for(const e of t){const t=this.#z.get(e.feedbackId);if(t&&t.unsubscribe){const r={parseVariablesInString:async e=>e};Promise.resolve(t.unsubscribe(a(t.type,e),r)).catch(t=>{this.#T("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}}},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8161:e=>{"use strict";e.exports=require("node:os")},8311:(e,t,r)=>{"use strict";const i=/\s+/g;class n{constructor(e,t){if(t=s(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(i," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!b(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&m)|(this.options.loose&&g))+":"+e,r=o.get(t);if(r)return r;const i=this.options.loose,n=i?u[d.HYPHENRANGELOOSE]:u[d.HYPHENRANGE];e=e.replace(n,j(this.options.includePrerelease)),l("hyphen replace",e),e=e.replace(u[d.COMPARATORTRIM],p),l("comparator trim",e),e=e.replace(u[d.TILDETRIM],h),l("tilde trim",e),e=e.replace(u[d.CARETTRIM],f),l("caret trim",e);let s=e.split(" ").map(e=>w(e,this.options)).join(" ").split(/\s+/).map(e=>A(e,this.options));i&&(s=s.filter(e=>(l("loose invalid filter",e,this.options),!!e.match(u[d.COMPARATORLOOSE])))),l("range list",s);const c=new Map,y=s.map(e=>new a(e,this.options));for(const e of y){if(b(e))return[e];c.set(e.value,e)}c.size>1&&c.has("")&&c.delete("");const v=[...c.values()];return o.set(t,v),v}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>v(r,t)&&e.set.some(e=>v(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(C(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const o=new(r(8794)),s=r(8587),a=r(3904),l=r(7272),c=r(3908),{safeRe:u,t:d,comparatorTrimReplace:p,tildeTrimReplace:h,caretTrimReplace:f}=r(9718),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:g}=r(6874),b=e=>"<0.0.0-0"===e.value,y=e=>""===e.value,v=(e,t)=>{let r=!0;const i=e.slice();let n=i.pop();for(;r&&i.length;)r=i.every(e=>n.intersects(e,t)),n=i.pop();return r},w=(e,t)=>(e=e.replace(u[d.BUILD],""),l("comp",e,t),e=S(e,t),l("caret",e),e=P(e,t),l("tildes",e),e=O(e,t),l("xrange",e),e=x(e,t),l("stars",e),e),E=e=>!e||"x"===e.toLowerCase()||"*"===e,P=(e,t)=>e.trim().split(/\s+/).map(e=>I(e,t)).join(" "),I=(e,t)=>{const r=t.loose?u[d.TILDELOOSE]:u[d.TILDE];return e.replace(r,(t,r,i,n,o)=>{let s;return l("tilde",e,t,r,i,n,o),E(r)?s="":E(i)?s=`>=${r}.0.0 <${+r+1}.0.0-0`:E(n)?s=`>=${r}.${i}.0 <${r}.${+i+1}.0-0`:o?(l("replaceTilde pr",o),s=`>=${r}.${i}.${n}-${o} <${r}.${+i+1}.0-0`):s=`>=${r}.${i}.${n} <${r}.${+i+1}.0-0`,l("tilde return",s),s})},S=(e,t)=>e.trim().split(/\s+/).map(e=>_(e,t)).join(" "),_=(e,t)=>{l("caret",e,t);const r=t.loose?u[d.CARETLOOSE]:u[d.CARET],i=t.includePrerelease?"-0":"";return e.replace(r,(t,r,n,o,s)=>{let a;return l("caret",e,t,r,n,o,s),E(r)?a="":E(n)?a=`>=${r}.0.0${i} <${+r+1}.0.0-0`:E(o)?a="0"===r?`>=${r}.${n}.0${i} <${r}.${+n+1}.0-0`:`>=${r}.${n}.0${i} <${+r+1}.0.0-0`:s?(l("replaceCaret pr",s),a="0"===r?"0"===n?`>=${r}.${n}.${o}-${s} <${r}.${n}.${+o+1}-0`:`>=${r}.${n}.${o}-${s} <${r}.${+n+1}.0-0`:`>=${r}.${n}.${o}-${s} <${+r+1}.0.0-0`):(l("no pr"),a="0"===r?"0"===n?`>=${r}.${n}.${o}${i} <${r}.${n}.${+o+1}-0`:`>=${r}.${n}.${o}${i} <${r}.${+n+1}.0-0`:`>=${r}.${n}.${o} <${+r+1}.0.0-0`),l("caret return",a),a})},O=(e,t)=>(l("replaceXRanges",e,t),e.split(/\s+/).map(e=>k(e,t)).join(" ")),k=(e,t)=>{e=e.trim();const r=t.loose?u[d.XRANGELOOSE]:u[d.XRANGE];return e.replace(r,(r,i,n,o,s,a)=>{l("xRange",e,r,i,n,o,s,a);const c=E(n),u=c||E(o),d=u||E(s),p=d;return"="===i&&p&&(i=""),a=t.includePrerelease?"-0":"",c?r=">"===i||"<"===i?"<0.0.0-0":"*":i&&p?(u&&(o=0),s=0,">"===i?(i=">=",u?(n=+n+1,o=0,s=0):(o=+o+1,s=0)):"<="===i&&(i="<",u?n=+n+1:o=+o+1),"<"===i&&(a="-0"),r=`${i+n}.${o}.${s}${a}`):u?r=`>=${n}.0.0${a} <${+n+1}.0.0-0`:d&&(r=`>=${n}.${o}.0${a} <${n}.${+o+1}.0-0`),l("xRange return",r),r})},x=(e,t)=>(l("replaceStars",e,t),e.trim().replace(u[d.STAR],"")),A=(e,t)=>(l("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),j=e=>(t,r,i,n,o,s,a,l,c,u,d,p)=>`${r=E(i)?"":E(n)?`>=${i}.0.0${e?"-0":""}`:E(o)?`>=${i}.${n}.0${e?"-0":""}`:s?`>=${r}`:`>=${r}${e?"-0":""}`} ${l=E(c)?"":E(u)?`<${+c+1}.0.0-0`:E(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),C=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(l(e[r].semver),e[r].semver!==a.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}},8384:(e,t,r)=>{const{Regex:i}=r(6278);e.exports={getConfigFields(){let e=this;return[{type:"static-text",id:"info",width:12,label:"Information",value:"This modules controls Kiloview NDI devices. You may need to enable HTTP API access for the user account you are using on the Kiloview device."},{type:"static-text",id:"hr1",width:12,label:" ",value:"<hr />"},{type:"textinput",id:"host",label:"IP Address",width:6,default:"",regex:i.IP},{type:"static-text",id:"hr2",width:12,label:" ",value:"<hr />"},{type:"checkbox",id:"useAuth",label:"Use Authentication",width:6,default:!0},{type:"textinput",label:"Username",id:"username",width:3,default:"admin",isVisible:e=>!0===e.useAuth},{type:"textinput",label:"Password",id:"password",width:3,default:"admin",isVisible:e=>!0===e.useAuth},{type:"static-text",id:"hr3",width:12,label:" ",value:"<hr />"},{type:"dropdown",id:"mode",label:"Default Mode (if not known yet)",width:4,default:e.CHOICES_CONVERTER_MODES[0].id,choices:e.CHOICES_CONVERTER_MODES},{type:"static-text",id:"hr4",width:12,label:" ",value:"<hr />"},{type:"checkbox",id:"polling",label:"Enable Polling (necessary for feedbacks and variables)",default:!1,width:3},{type:"textinput",id:"pollingrate",label:"Polling Rate for Current State (in ms)",default:e.POLLINGRATE,width:3,isVisible:e=>!0===e.polling},{type:"textinput",id:"pollingrate_sources",label:"Polling Rate for new NDI Sources (in ms)",default:e.POLLINGRATE_SOURCES,width:3,isVisible:e=>!0===e.polling&&"decoder"===e.mode},{type:"static-text",id:"hr5",width:12,label:" ",value:"<hr />"},{type:"checkbox",id:"picManage",label:"Enable Picture Management Functions",default:!1,width:3},{type:"static-text",id:"picManageInfo",width:9,label:" ",value:"Enabling Picture Management will allow you to upload and reset pictures on the device."},{type:"checkbox",id:"verbose",label:"Enable Verbose Logging",default:!1,width:3},{type:"static-text",id:"verboseInfo",width:9,label:" ",value:"Enabling Verbose Logging will push all incoming and outgoing data to the log, which is helpful for debugging."}]}}},8398:(e,t,r)=>{"use strict";const i=r(8474),n=r(4647),o=r(5424),{runtimePlatformArch:s}=r(1313),a=r(9814),l=s(),c=a.libvipsVersion(),u=a.format();u.heif.output.alias=["avif","heic"],u.jpeg.output.alias=["jpe","jpg"],u.tiff.output.alias=["tif"],u.jp2k.output.alias=["j2c","j2k","jp2","jpx"];const d={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"};let p={vips:c.semver};if(!c.isGlobal)if(c.isWasm)try{p=r(Object(function(){var e=new Error("Cannot find module '@img/sharp-wasm32/versions'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(e){}else try{p=r(7695)(`./sharp-${l}/versions`)}catch(e){try{p=r(8503)(`./sharp-libvips-${l}/versions`)}catch(e){}}function h(e){return o.bool(e)?e?a.cache(50,20,100):a.cache(0,0,0):o.object(e)?a.cache(e.memory,e.files,e.items):a.cache()}function f(e){return a.concurrency(o.integer(e)?e:null)}p.sharp=r(7816).version,p.heif&&u.heif&&(u.heif.input.fileSuffix=[".avif"],u.heif.output.alias=["avif"]),h(!0),n.familySync()!==n.GLIBC||a._isUsingJemalloc()?n.familySync()===n.MUSL&&1024===a.concurrency()&&a.concurrency(r(8161).availableParallelism()):a.concurrency(1);const m=new i.EventEmitter;function g(){return a.counters()}function b(e){return a.simd(o.bool(e)?e:null)}function y(e){if(!o.object(e))throw o.invalidParameterError("options","object",e);if(!Array.isArray(e.operation)||!e.operation.every(o.string))throw o.invalidParameterError("operation","Array<string>",e.operation);a.block(e.operation,!0)}function v(e){if(!o.object(e))throw o.invalidParameterError("options","object",e);if(!Array.isArray(e.operation)||!e.operation.every(o.string))throw o.invalidParameterError("operation","Array<string>",e.operation);a.block(e.operation,!1)}e.exports=function(e){e.cache=h,e.concurrency=f,e.counters=g,e.simd=b,e.format=u,e.interpolators=d,e.versions=p,e.queue=m,e.block=y,e.unblock=v}},8404:(e,t,r)=>{const{combineRgb:i}=r(6278);e.exports={initFeedbacks:function(){let e=this,t={};const r=i(255,255,255),n=i(255,0,0);t.mode={type:"boolean",name:"Converter Mode",description:"Change the button color based on the Converter Mode",defaultStyle:{color:r,bgcolor:n},options:[{type:"dropdown",label:"Converter Mode",id:"mode",default:e.CHOICES_CONVERTER_MODES[0].id,choices:e.CHOICES_CONVERTER_MODES}],callback:function(t,r){return t.options.mode==e.STATE.mode}},"encoder"===e.STATE.mode?(t.videoSignal={type:"boolean",name:"Encoder Video Signal is Online/Offline",description:"If video signal is online or offline, change the colors of the button",defaultStyle:{color:r,bgcolor:n},options:[{type:"dropdown",label:"Change color if source is",id:"compare",default:"online",choices:[{id:"online",label:"Online"},{id:"offline",label:"Offline"}]}],callback:function(t,r){let i=t.options;return"online"===i.compare&&!0===e.STATE.info.data.video_signal||"offline"===i.compare&&!1===e.STATE.info.data.video_signal}},t.audioSignal={type:"boolean",name:"Encoder Audio Source is Online/Offline",description:"If audio source is online or offline, change the colors of the button",defaultStyle:{color:r,bgcolor:n},options:[{type:"dropdown",label:"Change color if source is",id:"compare",default:"online",choices:[{id:"online",label:"Online"},{id:"offline",label:"Offline"}]}],callback:function(t,r){let i=t.options;return"online"===i.compare&&!0===e.STATE.info.data.audio_signal||"offline"===i.compare&&!1===e.STATE.info.dta.audio_signal}}):(t.online={type:"boolean",name:"Selected NDI Source is Online/Offline",description:"If selected NDI source is online or offline, change the colors of the button",defaultStyle:{color:r,bgcolor:n},options:[{type:"dropdown",label:"Change color if source is",id:"compare",default:"online",choices:[{id:"online",label:"Online"},{id:"offline",label:"Offline"}]}],callback:function(t,r){let i=t.options;return"online"===i.compare&&!0===e.STATE?.info?.data?.online||"offline"===i.compare&&!1===e.STATE?.info?.data?.online}},t.preset_enabled={type:"boolean",name:"Selected Preset is Enabled",description:"If selected preset is enabled, change the colors of the button",defaultStyle:{color:r,bgcolor:n},options:[{type:"dropdown",label:"Preset",id:"preset",default:e.CHOICES_PRESETS[0].id,choices:e.CHOICES_PRESETS}],callback:function(t,r){let i=t.options,n=e.STATE.presets.data.find(e=>e.id.toString()===i.preset.toString());return!(!n||!n.enable)}},t.preset_current={type:"boolean",name:"Selected Preset is Current Preset",description:"If selected preset is the current preset, change the colors of the button",defaultStyle:{color:r,bgcolor:n},options:[{type:"dropdown",label:"Preset",id:"preset",default:e.CHOICES_PRESETS[0].id,choices:e.CHOICES_PRESETS},{type:"dropdown",label:"Change color if preset is",id:"compare",default:!0,choices:[{id:!0,label:"Current"},{id:!1,label:"Not Current"}]}],callback:function(t,r){let i=t.options;if(e.STATE.presets&&e.STATE.presets.data){let t=e.STATE.presets.data.find(e=>e.id.toString()===i.preset.toString());if(t&&t.current==i.compare)return!0}return!1}}),e.config.picManage,e.setFeedbackDefinitions(t)}}},8474:e=>{"use strict";e.exports=require("node:events")},8503:(e,t,r)=>{var i={"./sharp-libvips-linux-x64/versions":5373};function n(e){var t=o(e);return r(t)}function o(e){if(!r.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=8503},8587:e=>{"use strict";const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},8678:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=8678,e.exports=t},8794:e=>{"use strict";e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},8895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const i=r(1635).__importDefault(r(9278)),n=r(228),o=r(1400);class s extends n.EventEmitter{#$;#L;_socket;#w;#Y=!1;#K=!1;#F=!1;#V;#Z;#r;get isConnected(){return this.#Y}get isConnecting(){return this.#K}get isDestroyed(){return this.#F}constructor(e,t,r){super(),this.#$=e,this.#L=t,this.#w={reconnect_interval:2e3,reconnect:!0,...r},this._socket=new i.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",e=>{this.#K=!1,this.#Y=!1,this.#w.reconnect&&this.#ee(),this.#U(o.InstanceStatus.UnknownError,e.message),this.emit("error",e)}),this._socket.on("ready",()=>{this.#Y=!0,this.#K=!1,this.#U(o.InstanceStatus.Ok),this.emit("connect")}),this._socket.on("end",()=>{this.#Y=!1,this.#U(o.InstanceStatus.Disconnected),!this.#K&&this.#w.reconnect&&this.#ee(),this.emit("end")}),this._socket.on("data",e=>this.emit("data",e)),this._socket.on("drain",()=>this.emit("drain")),setImmediate(()=>{this.#F||this.connect()}),this.#r=setTimeout(()=>{this.#r=void 0,this.#F||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#$}:${this.#L} is missing an error handler!`)},5e3)}connect(){if(this.#F)throw new Error("Cannot connect destroyed socket");return!this.#K&&(this.#K=!0,this._socket.connect(this.#L,this.#$),!0)}async send(e){if(this.#F||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#Y)return!1;try{return new Promise((t,r)=>{this._socket.write(e,e=>{e?r(e):t(!0)})})}catch(e){this.#Y=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#U(o.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#F=!0,void 0!==this.#Z&&(clearTimeout(this.#Z),this.#Z=void 0),void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#ee(){void 0!==this.#Z&&clearTimeout(this.#Z),this.#Z=setTimeout(()=>{this.#Z=void 0,this.#U(o.InstanceStatus.Connecting),this.connect()},this.#w.reconnect_interval)}#U(e,t){this.#V!=e&&(this.#V=e,this.emit("status_change",e,t))}}t.TCPHelper=s},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9077:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=function(e,t){if(!t){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'")}if(e.legacyIds.includes(e.id))throw new Error(`Manifest contains itself '${e.id}' in legacyIds`);if(!(0,i.default)(e)){const e=i.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}};const i=r(1635).__importDefault(r(7281))},9212:(e,t,r)=>{"use strict";const i=r(5424),n={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},o={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},s={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},a={entropy:16,attention:17},l={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3",mks2013:"mks2013",mks2021:"mks2021"},c={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},u={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function d(e){return e.angle%360!=0||0!==e.rotationAngle}function p(e){return-1!==e.width||-1!==e.height}function h(e,t,r){if(p(this.options)&&this.options.debuglog("ignoring previous resize options"),-1!==this.options.widthPost&&this.options.debuglog("operation order will be: extract, resize, extract"),i.defined(e))if(i.object(e)&&!i.defined(r))r=e;else{if(!(i.integer(e)&&e>0))throw i.invalidParameterError("width","positive integer",e);this.options.width=e}else this.options.width=-1;if(i.defined(t)){if(!(i.integer(t)&&t>0))throw i.invalidParameterError("height","positive integer",t);this.options.height=t}else this.options.height=-1;if(i.object(r)){if(i.defined(r.width)){if(!(i.integer(r.width)&&r.width>0))throw i.invalidParameterError("width","positive integer",r.width);this.options.width=r.width}if(i.defined(r.height)){if(!(i.integer(r.height)&&r.height>0))throw i.invalidParameterError("height","positive integer",r.height);this.options.height=r.height}if(i.defined(r.fit)){const e=u[r.fit];if(!i.string(e))throw i.invalidParameterError("fit","valid fit",r.fit);this.options.canvas=e}if(i.defined(r.position)){const e=i.integer(r.position)?r.position:a[r.position]||o[r.position]||n[r.position];if(!i.integer(e)||!i.inRange(e,0,8)&&!i.inRange(e,16,17))throw i.invalidParameterError("position","valid position/gravity/strategy",r.position);this.options.position=e}if(this._setBackgroundColourOption("resizeBackground",r.background),i.defined(r.kernel)){if(!i.string(l[r.kernel]))throw i.invalidParameterError("kernel","valid kernel name",r.kernel);this.options.kernel=l[r.kernel]}i.defined(r.withoutEnlargement)&&this._setBooleanOption("withoutEnlargement",r.withoutEnlargement),i.defined(r.withoutReduction)&&this._setBooleanOption("withoutReduction",r.withoutReduction),i.defined(r.fastShrinkOnLoad)&&this._setBooleanOption("fastShrinkOnLoad",r.fastShrinkOnLoad)}return d(this.options)&&p(this.options)&&(this.options.rotateBefore=!0),this}function f(e){if(i.integer(e)&&e>0)this.options.extendTop=e,this.options.extendBottom=e,this.options.extendLeft=e,this.options.extendRight=e;else{if(!i.object(e))throw i.invalidParameterError("extend","integer or object",e);if(i.defined(e.top)){if(!(i.integer(e.top)&&e.top>=0))throw i.invalidParameterError("top","positive integer",e.top);this.options.extendTop=e.top}if(i.defined(e.bottom)){if(!(i.integer(e.bottom)&&e.bottom>=0))throw i.invalidParameterError("bottom","positive integer",e.bottom);this.options.extendBottom=e.bottom}if(i.defined(e.left)){if(!(i.integer(e.left)&&e.left>=0))throw i.invalidParameterError("left","positive integer",e.left);this.options.extendLeft=e.left}if(i.defined(e.right)){if(!(i.integer(e.right)&&e.right>=0))throw i.invalidParameterError("right","positive integer",e.right);this.options.extendRight=e.right}if(this._setBackgroundColourOption("extendBackground",e.background),i.defined(e.extendWith)){if(!i.string(s[e.extendWith]))throw i.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",e.extendWith);this.options.extendWith=s[e.extendWith]}}return this}function m(e){const t=p(this.options)||-1!==this.options.widthPre?"Post":"Pre";return-1!==this.options[`width${t}`]&&this.options.debuglog("ignoring previous extract options"),["left","top","width","height"].forEach(function(r){const n=e[r];if(!(i.integer(n)&&n>=0))throw i.invalidParameterError(r,"integer",n);this.options[r+("left"===r||"top"===r?"Offset":"")+t]=n},this),d(this.options)&&!p(this.options)&&(-1!==this.options.widthPre&&-1!==this.options.widthPost||(this.options.rotateBefore=!0)),this.options.input.autoOrient&&(this.options.orientBefore=!0),this}function g(e){if(this.options.trimThreshold=10,i.defined(e)){if(!i.object(e))throw i.invalidParameterError("trim","object",e);if(i.defined(e.background)&&this._setBackgroundColourOption("trimBackground",e.background),i.defined(e.threshold)){if(!(i.number(e.threshold)&&e.threshold>=0))throw i.invalidParameterError("threshold","positive number",e.threshold);this.options.trimThreshold=e.threshold}i.defined(e.lineArt)&&this._setBooleanOption("trimLineArt",e.lineArt)}return d(this.options)&&(this.options.rotateBefore=!0),this}e.exports=function(e){Object.assign(e.prototype,{resize:h,extend:f,extract:m,trim:g}),e.gravity=n,e.strategy=a,e.kernel=l,e.fit=c,e.position=o}},9278:e=>{"use strict";e.exports=require("net")},9367:e=>{e.exports={initActions:function(){let e=this,t={};t.modeSwitch={name:"Set Mode",options:[{type:"dropdown",label:"Mode",id:"mode",default:e.CHOICES_CONVERTER_MODES[0].id,choices:e.CHOICES_CONVERTER_MODES}],callback:function(t){let r=t.options;e.DEVICE.modeSwitch(r.mode)}},t.toggleMode={name:"Toggle Mode",callback:function(t){e.STATE.mode&&"encoder"===e.STATE.mode?e.DEVICE.modeSwitch("decoder"):e.DEVICE.modeSwitch("encoder")}},t.reboot={name:"Reboot Device",callback:function(t){e.DEVICE.sysReboot()}},t.reconnect={name:"Reset all NDI Connections",callback:function(t){e.DEVICE.sysReconnect()}},t.restore={name:"Restore to Factory Settings",callback:function(t){e.DEVICE.sysRestore()}},"encoder"===e.STATE.mode?(t.encoder_setType={name:"Set NDI Type",options:[{type:"dropdown",label:"Type",id:"type",default:"tcp",choices:[{id:"tcp",label:"TCP"},{id:"multicast",label:"Multicast"}]}],callback:function(t){let r=t.options;e.DEVICE.encoderSetType(r.type)}},t.encoder_setAudioSignalType={name:"Set Audio Signal Type",options:[{type:"dropdown",label:"Audio Signal Type",id:"type",default:"embedded",choices:[{id:"embedded",label:"Embedded"},{id:"analog",label:"Analog"}]}],callback:function(t){let r=t.options;e.DEVICE.encoderNdiSetAudioSignalType(r.type)}},t.encoder_setVolume={name:"Set Audio Volume",options:[{type:"number",label:"Volume",id:"volume",tooltip:"(0-200)",min:0,max:200,default:100,step:1,required:!0,range:!1}],callback:function(t){let r=t.options;e.DEVICE.encoderNdiSetAudioVolume(r.volume)}}):(t.setPreset={name:"Set Preset",options:[{type:"dropdown",label:"Preset",id:"preset",default:e.CHOICES_PRESETS[0].id,choices:e.CHOICES_PRESETS}],callback:async function(t){let r=t.options;e.DEVICE.decoderCurrentSetPreset(r.preset)}},t.setSource={name:"Select NDI Source",options:[{type:"dropdown",label:"Source",id:"url",default:e.CHOICES_SOURCES[0].id,choices:e.CHOICES_SOURCES}],callback:function(t){let r=t.options,[i,n,o]=Buffer.from(r.url,"base64").toString().split(/:/);e.DEVICE.decoderCurrentSetUrl(i,n+":"+o)}},t.refreshSources={name:"Refresh NDI Sources",callback:function(t){e.checkSources()}},t.setOutputResolution={name:"Set Output Resolution",options:[{type:"dropdown",label:"Resolution",id:"resolution",default:"auto",choices:[{id:"auto",label:"Auto"},{id:"deint",label:"Deinterlaced (Progressive)"}]}],callback:function(t){let r=t.options;e.DEVICE.decoderSetOutputResolution(r.resolution)}},t.setOutputFrameRate={name:"Set Output Frame Rate",options:[{type:"dropdown",label:"Frame Rate",id:"frameate",default:0,choices:[{id:0,label:"Use NDI Source Frame Rate"},{id:23.98,label:"23.98"},{id:24,label:"24"},{id:25,label:"25"},{id:29.97,label:"29.97"},{id:30,label:"30"},{id:50,label:"50"},{id:59.94,label:"59.94"},{id:60,label:"60"}]}],callback:function(t){let r=t.options;e.DEVICE.decoderSetOutputFrameRate(r.frame_rate)}},t.setOutputAudioSampleRate={name:"Set Output Audio Sample Rate",options:[{type:"dropdown",label:"Sample Rate",id:"sample_rate",default:0,choices:[{id:0,label:"Use NDI Source Sample Rate"},{id:44100,label:"44.1 kHz"},{id:48e3,label:"48 kHz"}]}],callback:function(t){let r=t.options;e.DEVICE.decoderSetOutputAudioSampleRate(r.sample_rate)}}),1==e.config.picManage&&(t.picManageAdd={name:"Picture Management: Change Image",options:[{type:"dropdown",label:"Image Type",id:"name",default:"NOSIGNAL",choices:[{id:"NOSIGNAL",label:"No Signal"},{id:"SPLASH",label:"Decoding Mode"},{id:"UNSUPPORT_CODEC",label:"Unsupported Codec"},{id:"UNSUPPORT",label:"Unsupported Resolution"}]},{type:"textinput",label:"Image Path",id:"path",default:"",useVariables:!0}],callback:async function(t){let r=t.options.name,i=await e.parseVariablesInString(t.options.path);e.DEVICE.picManageAdd(r,i)}},t.picManageReset={name:"Picture Management: Reset Image",options:[{type:"dropdown",label:"Image Type",id:"name",default:"NOSIGNAL",choices:[{id:"NOSIGNAL",label:"No Signal"},{id:"SPLASH",label:"Decoding Mode"},{id:"UNSUPPORT_CODEC",label:"Unsupported Codec"},{id:"UNSUPPORT",label:"Unsupported Resolution"}]}],callback:function(t){let r=t.options.name;e.DEVICE.picManageReset(r)}}),e.setActionDefinitions(t)}}},9684:(e,t,r)=>{"use strict";const i=r(1271),n=r(5424),o={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function s(e){return this._setBackgroundColourOption("tint",e),this}function a(e){return this.options.greyscale=!n.bool(e)||e,this}function l(e){return this.greyscale(e)}function c(e){if(!n.string(e))throw n.invalidParameterError("colourspace","string",e);return this.options.colourspacePipeline=e,this}function u(e){return this.pipelineColourspace(e)}function d(e){if(!n.string(e))throw n.invalidParameterError("colourspace","string",e);return this.options.colourspace=e,this}function p(e){return this.toColourspace(e)}function h(e){if(n.object(e)||n.string(e)){const t=i(e);return[t.red(),t.green(),t.blue(),Math.round(255*t.alpha())]}throw n.invalidParameterError("background","object or string",e)}function f(e,t){n.defined(t)&&(this.options[e]=h(t))}e.exports=function(e){Object.assign(e.prototype,{tint:s,greyscale:a,grayscale:l,pipelineColourspace:c,pipelineColorspace:u,toColourspace:d,toColorspace:p,_getBackgroundColourOption:h,_setBackgroundColourOption:f}),e.colourspace=o,e.colorspace=o}},9718:(e,t,r)=>{"use strict";const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:o}=r(6874),s=r(7272),a=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.safeSrc=[],d=t.t={};let p=0;const h="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",o],[h,n]],m=(e,t,r)=>{const i=(e=>{for(const[t,r]of f)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),n=p++;s(e,n,t),d[e]=n,c[n]=t,u[n]=i,a[n]=new RegExp(t,r?"g":void 0),l[n]=new RegExp(i,r?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),m("MAINVERSION",`(${c[d.NUMERICIDENTIFIER]})\\.(${c[d.NUMERICIDENTIFIER]})\\.(${c[d.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${c[d.NUMERICIDENTIFIERLOOSE]})\\.(${c[d.NUMERICIDENTIFIERLOOSE]})\\.(${c[d.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${c[d.NONNUMERICIDENTIFIER]}|${c[d.NUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${c[d.NONNUMERICIDENTIFIER]}|${c[d.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASE",`(?:-(${c[d.PRERELEASEIDENTIFIER]}(?:\\.${c[d.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${c[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[d.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${h}+`),m("BUILD",`(?:\\+(${c[d.BUILDIDENTIFIER]}(?:\\.${c[d.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${c[d.MAINVERSION]}${c[d.PRERELEASE]}?${c[d.BUILD]}?`),m("FULL",`^${c[d.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${c[d.MAINVERSIONLOOSE]}${c[d.PRERELEASELOOSE]}?${c[d.BUILD]}?`),m("LOOSE",`^${c[d.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${c[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${c[d.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${c[d.XRANGEIDENTIFIER]})(?:\\.(${c[d.XRANGEIDENTIFIER]})(?:\\.(${c[d.XRANGEIDENTIFIER]})(?:${c[d.PRERELEASE]})?${c[d.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${c[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[d.XRANGEIDENTIFIERLOOSE]})(?:${c[d.PRERELEASELOOSE]})?${c[d.BUILD]}?)?)?`),m("XRANGE",`^${c[d.GTLT]}\\s*${c[d.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${c[d.GTLT]}\\s*${c[d.XRANGEPLAINLOOSE]}$`),m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),m("COERCE",`${c[d.COERCEPLAIN]}(?:$|[^\\d])`),m("COERCEFULL",c[d.COERCEPLAIN]+`(?:${c[d.PRERELEASE]})?`+`(?:${c[d.BUILD]})?(?:$|[^\\d])`),m("COERCERTL",c[d.COERCE],!0),m("COERCERTLFULL",c[d.COERCEFULL],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${c[d.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",m("TILDE",`^${c[d.LONETILDE]}${c[d.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${c[d.LONETILDE]}${c[d.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${c[d.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",m("CARET",`^${c[d.LONECARET]}${c[d.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${c[d.LONECARET]}${c[d.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${c[d.GTLT]}\\s*(${c[d.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${c[d.GTLT]}\\s*(${c[d.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${c[d.GTLT]}\\s*(${c[d.LOOSEPLAIN]}|${c[d.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${c[d.XRANGEPLAIN]})\\s+-\\s+(${c[d.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${c[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[d.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyUpgradeScript=void 0,t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,r)=>{const i=[];for(const t of r.feedbacks){let r=e[t.feedbackId];if(!0===r&&(r={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),r){t.style||(t.style={});for(const[e,n]of Object.entries(r))void 0!==t.options[e]&&(t.style[n]=t.options[e],delete t.options[e],i.push(t))}}return{updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:i}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,r)=>{const i=[];for(const t of r.feedbacks){const r=e[t.feedbackId];if("string"!=typeof r)continue;const n=t.options[r];void 0!==n&&(delete t.options[r],t.isInverted="true"===n||!0===Boolean(n)||Number(n)>0,i.push(t))}return{updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:i}}},t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedSecrets:null,updatedActions:[],updatedFeedbacks:[]})},9814:(e,t,r)=>{"use strict";const{familySync:i,versionSync:n}=r(4647),{runtimePlatformArch:o,isUnsupportedNodeRuntime:s,prebuiltPlatforms:a,minimumLibvipsVersion:l}=r(1313),c=o(),u=[`../src/build/Release/sharp-${c}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${c}/sharp.node`,"@img/sharp-wasm32/sharp.node"];let d,p;const h=[];for(d of u)try{p=r(8678)(d);break}catch(e){h.push(e)}if(p&&d.startsWith("@img/sharp-linux-x64")&&!p._isUsingX64V2()){const e=new Error("Prebuilt binaries for linux-x64 require v2 microarchitecture");e.code="Unsupported CPU",h.push(e),p=null}if(!p){const[e,t,o]=["linux","darwin","win32"].map(e=>c.startsWith(e)),u=[`Could not load the "sharp" module using the ${c} runtime`];h.forEach(e=>{"MODULE_NOT_FOUND"!==e.code&&u.push(`${e.code}: ${e.message}`)});const d=h.map(e=>e.message).join(" ");if(u.push("Possible solutions:"),s()){const{found:e,expected:t}=s();u.push("- Please upgrade Node.js:",`    Found ${e}`,`    Requires ${t}`)}else if(a.includes(c)){const[e,t]=c.split("-"),r=e.endsWith("musl")?" --libc=musl":"";u.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${e.replace("musl","")}${r} --cpu=${t} sharp`)}else u.push(`- Manually install libvips >= ${l}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if(e&&/(symbol not found|CXXABI_)/i.test(d))try{const{config:e}=r(7418)(`./sharp-libvips-${c}/package`),t=`${i()} ${n()}`,o=`${e.musl?"musl":"glibc"} ${e.musl||e.glibc}`;u.push("- Update your OS:",`    Found ${t}`,`    Requires ${o}`)}catch(e){}throw e&&/\/snap\/core[0-9]{2}/.test(d)&&u.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node"),t&&/Incompatible library version/.test(d)&&u.push("- Update Homebrew:","    brew update && brew upgrade vips"),h.some(e=>"ERR_DLOPEN_DISABLED"===e.code)&&u.push("- Run Node.js without using the --no-addons flag"),o&&/The specified procedure could not be found/.test(d)&&u.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp"),u.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),new Error(u.join("\n"))}e.exports=p},9880:e=>{"use strict";e.exports={interpreterPath:e=>{if(e.length<64)return null;if(2135247942!==e.readUInt32BE(0))return null;if(2!==e.readUInt8(4))return null;if(1!==e.readUInt8(5))return null;const t=e.readUInt32LE(32),r=e.readUInt16LE(54),i=e.readUInt16LE(56);for(let n=0;n<i;n++){const i=t+n*r;if(3===e.readUInt32LE(i)){const t=e.readUInt32LE(i+8),r=e.readUInt32LE(i+32);return e.subarray(t,t+r).toString().replace(/\0.*$/g,"")}}return null}}},9896:e=>{"use strict";e.exports=require("fs")},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let i=0,n=e.length;for(;n>0;){const o=n/2|0;let s=i+o;r(e[s],t)<=0?(i=++s,n-=o+1):n=o}return i}}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const{InstanceBase:i,InstanceStatus:n,runEntrypoint:o}=r(6278),s=r(3487),a=r(8384),l=r(9367),c=r(8404),u=r(7969),d=r(1632),p=r(6672),h=r(5521);o(class extends i{constructor(e){super(e),Object.assign(this,{...a,...l,...c,...u,...d,...p,...h})}async init(e){this.configUpdated(e)}async destroy(){try{clearInterval(this.INTERVAL),clearInterval(this.INTERVAL_SOURCES),clearInterval(this.RECONNECT_INTERVAL)}catch(e){this.log("error","destroy error:"+e)}}async configUpdated(e){this.config=e,this.initActions(),this.initFeedbacks(),this.initVariables(),this.initPresets(),this.initConnection()}},s)})();