(()=>{var e={131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},147:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n="OutOfSync",i="Offline",o=r(1462)("client-request-handler"),a=s(r(2180)),u=r(3725),c=s(r(1306));class l{constructor(e,t){if(new.target===l)throw new TypeError("Cannot instantiate ModbusClientRequestHandler directly.");this._socket=e,this._timeout=t,this._state="offline"}get state(){return this._state}get requestCount(){return this._requests.length}registerRequest(e){const t=new c.default(e,this._timeout);return this._requests.push(t),this._flush(),t.promise}handle(e){if(o("incoming response"),!e)return void o("well, sorry I was wrong, no response at all");const t=this._currentRequest;if(!t)return void o("no current request, no idea where this came from");const r=t.request;return!1===e.body.isException&&e.body.fc!==r.body.fc?(o("something is weird, request fc and response fc do not match."),t.reject(new u.UserRequestError({err:n,message:"request fc and response fc does not match.",request:r})),void this._clearAllRequests()):e.body instanceof a.default?(o("response is a exception"),t.reject(new u.UserRequestError({err:"ModbusException",message:"A Modbus Exception Occurred - See Response Body",request:r,response:e})),this._clearCurrentRequest(),void this._flush()):(o("resolving request"),t.resolve(e),this._clearCurrentRequest(),void this._flush())}manuallyRejectCurrentRequest(){this._currentRequest&&(this._currentRequest.reject(new u.UserRequestError({err:"ManuallyCleared",message:"the request was manually cleared",request:this._currentRequest.request})),this._flush())}manuallyRejectRequests(e){for(let t=0;t<e;t++)this.manuallyRejectCurrentRequest()}manuallylRejectAllRequests(){this.manuallyRejectRequests(this.requestCount)}customErrorRequest(e){this._currentRequest&&this._currentRequest.reject(e)}_clearCurrentRequest(){this._currentRequest&&(this._currentRequest.done(),this._currentRequest=null)}_clearAllRequests(){for(this._clearCurrentRequest();this._requests.length>0;){const e=this._requests.shift();e&&e.reject(new u.UserRequestError({err:n,message:"rejecting because of earlier OutOfSync error",request:e.request}))}}_onConnect(){this._state="online"}_onClose(){this._state="offline",this._currentRequest&&this._currentRequest.reject(new u.UserRequestError({err:i,message:"connection to modbus server closed",request:this._currentRequest.request})),this._clearAllRequests()}_flush(){if(o("flushing"),null!==this._currentRequest)return void o("executing another request, come back later");if(0===this._requests.length)return void o("no request to be executed");if(this._currentRequest=this._requests.shift(),"offline"===this._state)return o("rejecting request immediatly, client offline"),this._currentRequest&&this._currentRequest.reject(new u.UserRequestError({err:i,message:"no connection to modbus server",request:this._currentRequest.request})),this._clearCurrentRequest(),void setTimeout(this._flush.bind(this),0);const e=this._currentRequest&&this._currentRequest.createPayload();o("flushing new request",e),this._currentRequest&&this._currentRequest.start(()=>{this._clearCurrentRequest(),this._flush()}),this._socket.write(e,e=>{o("request fully flushed, ( error:",e,")")})}}t.default=l},181:e=>{"use strict";e.exports=require("buffer")},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function s(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,s,i,o){if("function"!=typeof s)throw new TypeError("The listener must be a function");var a=new n(s,i||e,o),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new s:delete e._events[t]}function a(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,s,n=[];if(0===this._eventsCount)return n;for(s in e=this._events)t.call(e,s)&&n.push(r?s.slice(1):s);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=r?r+e:e,s=this._events[t];if(!s)return[];if(s.fn)return[s.fn];for(var n=0,i=s.length,o=new Array(i);n<i;n++)o[n]=s[n].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,s=this._events[t];return s?s.fn?1:s.length:0},a.prototype.emit=function(e,t,s,n,i,o){var a=r?r+e:e;if(!this._events[a])return!1;var u,c,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,s),!0;case 4:return l.fn.call(l.context,t,s,n),!0;case 5:return l.fn.call(l.context,t,s,n,i),!0;case 6:return l.fn.call(l.context,t,s,n,i,o),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,s);break;case 4:l[c].fn.call(l[c].context,t,s,n);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},a.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,s,n){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||n&&!a.once||s&&a.context!==s||o(this,i);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==t||n&&!a[u].once||s&&a[u].context!==s)&&c.push(a[u]);c.length?this._events[i]=1===c.length?c[0]:c:o(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,r,s){let n=(255&e)<<16|(255&t)<<8|255&r;return s&&s>=0&&s<1&&(n+=16777216*Math.round(255*(1-s))),n},t.splitRgb=n,t.splitHsl=function(e){const t=n(e);return(0,s.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=n(e);return(0,s.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=n(e);return(0,s.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()},t.parseEscapeCharacters=function(e){return e.replaceAll("\\n","\n").replaceAll("\\r","\r").replaceAll("\\t","\t").replaceAll("\\f","\f").replaceAll("\\v","\v").replaceAll("\\b","\b").replaceAll("\\\\","\\").replaceAll("\\x00","\0").replaceAll("\\x01","").replaceAll("\\x02","").replaceAll("\\x03","")},t.substituteEscapeCharacters=function(e){return e.replaceAll("\n","\\n").replaceAll("\r","\\r").replaceAll("\t","\\t").replaceAll("\f","\\f").replaceAll("\v","\\v").replaceAll("\b","\\b").replaceAll("\\","\\\\").replaceAll("\0","\\x00").replaceAll("","\\x01").replaceAll("","\\x02").replaceAll("","\\x03")};const s=r(6284);function n(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,s.colord)(e).isValid()){const t=(0,s.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}},708:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(8255));class i extends n.default{}t.default=i},853:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(2180);t.ExceptionResponseBody=s.default,t.isExceptionResponseBody=s.isExceptionResponseBody;var n=r(5644);t.ReadCoilsResponseBody=n.default;var i=r(2827);t.ReadDiscreteInputsResponseBody=i.default;var o=r(8500);t.ReadHoldingRegistersResponseBody=o.default;var a=r(4187);t.ReadInputRegistersResponseBody=a.default;var u=r(8255);t.ModbusResponseBody=u.default;var c=r(7141);t.ResponseFactory=c.default;var l=r(2094);t.WriteMultipleCoilsResponseBody=l.default;var d=r(5608);t.WriteMultipleRegistersResponseBody=d.default;var f=r(1043);t.WriteSingleCoilResponseBody=f.default;var h=r(1413);t.WriteSingleRegisterResponseBody=h.default},857:e=>{"use strict";e.exports=require("os")},949:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("rtu-response-handler"),i=s(r(8637)),o=s(r(9390));class a extends i.default{constructor(){super(),this._messages=[]}handleData(e){for(n("receiving new data"),this._buffer=Buffer.concat([this._buffer,e]),n("buffer",this._buffer);;){const e=o.default.fromBuffer(this._buffer);if(!e)return void n("not enough data available to parse");n("crc",e.crc),n("reset buffer from",this._buffer.length,"to",this._buffer.length-e.byteCount),this._buffer=this._buffer.slice(e.byteCount),this._messages.push(e)}}shift(){return this._messages.shift()}}t.default=a},1043:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(708));class o extends i.default{get address(){return this._address}get value(){return 65280===this._value}get byteCount(){return 5}static fromRequest(e){const t=e.address,r=e.value;return new o(t,r)}static fromBuffer(e){const t=e.readUInt8(0),r=e.readUInt16BE(1),s=65280===e.readUInt16BE(3);return t!==n.FC.WRITE_SINGLE_COIL?null:new o(r,s)}constructor(e,t){super(n.FC.WRITE_SINGLE_COIL),this._address=e,this._value=65280===t?65280:0}createPayload(){const e=Buffer.alloc(this.byteCount);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._address,1),e.writeUInt16BE(this._value,3),e}}t.default=o},1118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const s=r(1635).__importDefault(r(228)),n=r(2203),i=r(8895);class o extends s.default{#e;#t;#r;get isConnected(){return this.#e.isConnected}get isConnecting(){return this.#e.isConnecting}get isDestroyed(){return this.#e.isDestroyed}constructor(e,t,r){super(),this.#e=new i.TCPHelper(e,t,r),this.#t=new a,this.#e._socket.pipe(this.#t),this.#e.on("connect",()=>this.emit("connect")),this.#e.on("end",()=>this.emit("end")),this.#e.on("error",e=>this.emit("error",e)),this.#e.on("status_change",(e,t)=>this.emit("status_change",e,t)),this.#t.on("iac",(e,t)=>this.emit("iac",e,t)),this.#t.on("sb",e=>this.emit("sb",e)),this.#t.on("data",e=>this.emit("data",e)),this.#t.on("drain",()=>this.emit("drain")),this.#r=setTimeout(()=>{this.#r=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)},5e3)}connect(){return this.#e.connect()}async send(e){return this.#e.send(e)}destroy(){this.#e.destroy(),void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this.#t.removeAllListeners(),this.#t.destroy()}}t.TelnetHelper=o;class a extends n.Transform{#s;#n;#i;constructor(e){super(e),this.#s=Buffer.alloc(0),this.#n=Buffer.alloc(0),this.#i=0}_transform(e,t,r){for(let t=0;t<e.length;++t)this.#o(e[t]);const s=this.#a();s.length&&this.push(s),r()}#o(e){if(0===this.#i){if(255===e)return void(this.#i=255);this.#s=Buffer.concat([this.#s,Buffer.from([e])])}else if(255===this.#i)switch(e){case 250:case 251:case 252:case 253:case 254:this.#i=e;break;default:this.#i=0}else{if(this.#i>=251&&this.#i<=254){let t;switch(this.#i){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#i=0)}if(250===this.#i){if(240===e)return this.emit("sb",this.#n),this.#i=0,void(this.#n=Buffer.alloc(0));this.#n=Buffer.concat([this.#n,Buffer.from([e])])}}}#a(){const e=this.#s;return this.#s=Buffer.alloc(0),e}}},1142:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(4732)),i=r(1462)("modbus-server-request-handler");t.default=class{constructor(e){this._fromBuffer=e,this._requests=[],this._buffer=Buffer.alloc(0)}shift(){return this._requests.shift()}handle(e){for(this._buffer=Buffer.concat([this._buffer,e]),i("this._buffer",this._buffer);;){const e=this._fromBuffer(this._buffer);if(i("request",e),!e)return;if(e instanceof n.default&&e.corrupted){const t=this._buffer.slice(0,e.byteCount).toString("hex");i(`request message was corrupt: ${t}`)}else this._requests.unshift(e);this._buffer=this._buffer.slice(e.byteCount)}}}},1273:(e,t,r)=>{"use strict";e.exports=function(e){function t(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return s.colors[Math.abs(t)%s.colors.length]}function s(e){var r;function o(){if(o.enabled){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=o,a=Number(new Date),u=a-(r||a);i.diff=u,i.prev=r,i.curr=a,r=a,t[0]=s.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,r){if("%%"===e)return e;c++;var n=s.formatters[r];if("function"==typeof n){var o=t[c];e=n.call(i,o),t.splice(c,1),c--}return e}),s.formatArgs.call(i,t),(i.log||s.log).apply(i,t)}}return o.namespace=e,o.enabled=s.enabled(e),o.useColors=s.useColors(),o.color=t(e),o.destroy=n,o.extend=i,"function"==typeof s.init&&s.init(o),s.instances.push(o),o}function n(){var e=s.instances.indexOf(this);return-1!==e&&(s.instances.splice(e,1),!0)}function i(e,t){return s(this.namespace+(void 0===t?":":t)+e)}return s.debug=s,s.default=s,s.coerce=function(e){return e instanceof Error?e.stack||e.message:e},s.disable=function(){s.enable("")},s.enable=function(e){var t;s.save(e),s.names=[],s.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?s.skips.push(new RegExp("^"+e.substr(1)+"$")):s.names.push(new RegExp("^"+e+"$")));for(t=0;t<s.instances.length;t++){var i=s.instances[t];i.enabled=s.enabled(i.namespace)}},s.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=s.skips.length;t<r;t++)if(s.skips[t].test(e))return!1;for(t=0,r=s.names.length;t<r;t++)if(s.names[t].test(e))return!0;return!1},s.humanize=r(6585),Object.keys(e).forEach(function(t){s[t]=e[t]}),s.instances=[],s.names=[],s.skips=[],s.formatters={},s.selectColor=t,s.enable(s.load()),s}},1306:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(3725),n=r(6818),i=r(1462)("user-request");t.default=class{constructor(e,t=5e3){i("creating new user request with timeout",t),this._request=e,this._timeout=t,this._metrics=new n.UserRequestMetrics,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}createPayload(){return this._request.createPayload()}start(e){this._metrics.startedAt=new Date,this._timer=setTimeout(()=>{this._reject(new s.UserRequestError({err:"Timeout",message:"Req timed out",request:this._request})),e()},this._timeout)}get metrics(){return this._metrics}done(){clearTimeout(this._timer)}get request(){return this._request}get timeout(){return this._timeout}get promise(){return this._promise}resolve(e){return this._metrics.receivedAt=new Date,i("request completed in %d ms (sat in cue %d ms)",this.metrics.transferTime,this.metrics.waitTime),this._resolve({metrics:this.metrics,request:this._request,response:e})}get reject(){return this._reject}}},1318:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s},o=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),e.exports=(0,i.default)("ccitt",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=void 0!==t?~~t:65535,s=0;s<e.length;s++){var i=e[s];r=65535&(o[255&(r>>8^i)]^r<<8)}return r})},1400:(e,t)=>{"use strict";var r,s;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(r||(t.InstanceStatus=r={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(s||(t.Regex=s={}))},1413:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(708));class o extends i.default{get address(){return this._address}get value(){return this._value}get byteCount(){return 5}static fromRequest(e){const t=e.address,r=e.value;return new o(t,r)}static fromBuffer(e){const t=e.readUInt8(0),r=e.readUInt16BE(1),s=e.readUInt16BE(3);return t!==n.FC.WRITE_SINGLE_HOLDING_REGISTER?null:new o(r,s)}constructor(e,t){super(n.FC.WRITE_SINGLE_HOLDING_REGISTER),this._address=e,this._value=t}createPayload(){const e=Buffer.alloc(5);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._address,1),e.writeUInt16BE(this._value,3),e}}t.default=o},1451:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("rtu-client-request-handler"),i=s(r(8809)),o=s(r(147)),a=s(r(4732)),u=r(3725);class c extends o.default{constructor(e,t,r=5e3){super(e,r),this._address=t,this._requests=[],this._currentRequest=null,this._socket.on("open",this._onConnect.bind(this)),this._socket.isOpen&&this._onConnect()}register(e){n("registrating new request");const t=new a.default(this._address,e);return super.registerRequest(t)}handle(e){if(n("new response coming in"),!e)return;const t=this._currentRequest;if(!t)return void n("something is strange, received a respone without a request");const r=Buffer.concat([Buffer.from([e.address]),e.body.createPayload()]);n("create crc from response",r);const s=i.default.crc16modbus(r);if(e.crc!==s)return n("CRC does not match",e.crc,"!==",s),t.reject(new u.UserRequestError({err:"crcMismatch",message:"the response payload does not match the crc",request:t.request,response:e})),void this._clearAllRequests();super.handle(e)}get address(){return this._address}}t.default=c},1462:(e,t,r)=>{"use strict";"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(3782):e.exports=r(4140)},1635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>T,__assign:()=>i,__asyncDelegator:()=>R,__asyncGenerator:()=>C,__asyncValues:()=>O,__await:()=>E,__awaiter:()=>p,__classPrivateFieldGet:()=>q,__classPrivateFieldIn:()=>j,__classPrivateFieldSet:()=>M,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>U,__esDecorate:()=>c,__exportStar:()=>b,__extends:()=>n,__generator:()=>y,__importDefault:()=>B,__importStar:()=>A,__makeTemplateObject:()=>S,__metadata:()=>h,__param:()=>u,__propKey:()=>d,__read:()=>m,__rest:()=>o,__rewriteRelativeImportExtension:()=>N,__runInitializers:()=>l,__setFunctionName:()=>f,__spread:()=>v,__spreadArray:()=>w,__spreadArrays:()=>I,__values:()=>_,default:()=>F});var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};function o(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]])}return r}function a(e,t,r,s){var n,i=arguments.length,o=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(i<3?n(o):i>3?n(t,r,o):n(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}function u(e,t){return function(r,s){t(r,s,e)}}function c(e,t,r,s,n,i){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,u=s.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!t&&e?s.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,s.name):{}),f=!1,h=r.length-1;h>=0;h--){var p={};for(var y in s)p[y]="access"===y?{}:s[y];for(var y in s.access)p.access[y]=s.access[y];p.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(e||null))};var g=(0,r[h])("accessor"===u?{get:d.get,set:d.set}:d[c],p);if("accessor"===u){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=o(g.get))&&(d.get=a),(a=o(g.set))&&(d.set=a),(a=o(g.init))&&n.unshift(a)}else(a=o(g))&&("field"===u?n.unshift(a):d[c]=a)}l&&Object.defineProperty(l,s.name,d),f=!0}function l(e,t,r){for(var s=arguments.length>2,n=0;n<t.length;n++)r=s?t[n].call(e,r):t[n].call(e);return s?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((s=s.apply(e,t||[])).next())})}function y(e,t){var r,s,n,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(i=0)),i;)try{if(r=1,s&&(n=2&a[0]?s.return:a[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,a[1])).done)return n;switch(s=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,s=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],s=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var g=Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]};function b(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function I(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var s=Array(e),n=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,a=i.length;o<a;o++,n++)s[n]=i[o];return s}function w(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function C(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,n=r.apply(e,t||[]),i=[];return s=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),s[Symbol.asyncIterator]=function(){return this},s;function o(e,t){n[e]&&(s[e]=function(t){return new Promise(function(r,s){i.push([e,t,r,s])>1||a(e,t)})},t&&(s[e]=t(s[e])))}function a(e,t){try{(r=n[e](t)).value instanceof E?Promise.resolve(r.value.v).then(u,c):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function R(e){var t,r;return t={},s("next"),s("throw",function(e){throw e}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(s,n){t[s]=e[s]?function(t){return(r=!r)?{value:E(e[s](t)),done:!1}:n?n(t):t}:n}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=_(e),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(r){t[r]=e[r]&&function(t){return new Promise(function(s,n){!function(e,t,r,s){Promise.resolve(s).then(function(t){e({value:t,done:r})},t)}(s,n,(t=e[r](t)).done,t.value)})}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var k=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},P=function(e){return P=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},P(e)};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=P(e),s=0;s<r.length;s++)"default"!==r[s]&&g(t,e,r[s]);return k(t,e),t}function B(e){return e&&e.__esModule?e:{default:e}}function q(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)}function M(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r}function j(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function T(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var s,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(void 0===s){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],r&&(n=s)}if("function"!=typeof s)throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:s,async:r})}else r&&e.stack.push({async:!0});return t}var x="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var s=new Error(r);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function U(e){function t(t){e.error=e.hasError?new x(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,s=0;return function n(){for(;r=e.stack.pop();)try{if(!r.async&&1===s)return s=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(i).then(n,function(e){return t(e),n()})}else s|=1}catch(e){t(e)}if(1===s)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function N(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,s,n,i){return r?t?".jsx":".js":!s||n&&i?s+n+"."+i.toLowerCase()+"js":e}):e}const F={__extends:n,__assign:i,__rest:o,__decorate:a,__param:u,__esDecorate:c,__runInitializers:l,__propKey:d,__setFunctionName:f,__metadata:h,__awaiter:p,__generator:y,__createBinding:g,__exportStar:b,__values:_,__read:m,__spread:v,__spreadArrays:I,__spreadArray:w,__await:E,__asyncGenerator:C,__asyncDelegator:R,__asyncValues:O,__makeTemplateObject:S,__importStar:A,__importDefault:B,__classPrivateFieldGet:q,__classPrivateFieldSet:M,__classPrivateFieldIn:j,__addDisposableResource:T,__disposeResources:U,__rewriteRelativeImportExtension:N}},1649:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const s=r(1635),n=r(360),i=s.__importDefault(r(3290)),o=r(2593),a=r(1706),u=r(8039),c=r(4044),l=r(4289),d=r(2365);t.InstanceBase=class{#u;#c;id;#l=new i.default({concurrency:1});#d=!1;#f=!1;#h={};#p;#y;#g=new Map;#b=new Map;#_=new Map;#m;#v;get instanceOptions(){return this.#m}get label(){return this.#v}constructor(e){if(!(0,o.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#m={disableVariableValidation:!1},this.#u=new c.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:this._handleVariablesChanged.bind(this),sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},e=>{process.send(e)},5e3),process.on("message",e=>{this.#u.receivedMessage(e)}),this.#p=new l.ActionManager(async e=>this.#u.sendWithCb("parseVariablesInString",e),e=>this.#u.sendWithNoCb("setActionDefinitions",e),e=>this.#u.sendWithNoCb("setCustomVariable",e),this.log.bind(this)),this.#y=new u.FeedbackManager(async e=>this.#u.sendWithCb("parseVariablesInString",e),e=>this.#u.sendWithNoCb("updateFeedbackValues",e),e=>this.#u.sendWithNoCb("setFeedbackDefinitions",e),this.log.bind(this)),this.#c=e.upgradeScripts,this.id=e.id,this.#v=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#l.add(async()=>{if(this.#d)throw new Error("Already initialized");const t=e.actions,r=e.feedbacks;if(this.#h=e.config,this.#v=e.label,e.isFirstInit){const t={},r=this.getConfigFields();for(const e of r)"default"in e&&(t[e.id]=e.default);this.#h=t,this.saveConfig(this.#h),e.lastUpgradeIndex=this.#c.length-1}const{updatedActions:s,updatedFeedbacks:n,updatedConfig:i}=(0,a.runThroughUpgradeScripts)(t,r,e.lastUpgradeIndex,this.#c,this.#h,!1);this.#h=i??this.#h;const o=this.#u.sendWithCb("upgradedItems",{updatedActions:s,updatedFeedbacks:n});try{await this.init(this.#h,!!e.isFirstInit),this.#d=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}finally{await o}return setImmediate(()=>{this._handleUpdateActions({actions:t},!0).catch(e=>{this.log("error",`Receive actions failed: ${e}`)}),this._handleUpdateFeedbacks({feedbacks:r},!0).catch(e=>{this.log("error",`Receive feedbacks failed: ${e}`)})}),{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#c.length-1,updatedConfig:this.#h}})}async _handleDestroy(){await this.#l.add(async()=>{if(!this.#d)throw new Error("Not initialized");await this.destroy(),this.#d=!1})}async _handleConfigUpdateAndLabel(e){await this.#l.add(async()=>{if(!this.#d)throw new Error("Not initialized");this.#v=e.label,this.#h=e.config,await this.configUpdated(this.#h)})}async _handleExecuteAction(e){return this.#p.handleExecuteAction(e)}async _handleUpdateFeedbacks(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)({},e.feedbacks,null,this.#c,this.#h,!0);this.#u.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch(e=>{this.log("error",`Failed to save upgraded feedbacks: ${e}`)})}this.#y.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)(e.actions,{},null,this.#c,this.#h,!0);this.#u.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch(e=>{this.log("error",`Failed to save upgraded actions: ${e}`)})}this.#p.handleUpdateActions(e.actions)}async _handleGetConfigFields(e){return{fields:(0,o.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#p.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#y.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#f)return}else if(!this.#f)return;if(!this.handleStartStopRecordActions)throw this.#f=!1,new Error("Recording actions is not supported by this module!");this.#f=e.recording,this.handleStartStopRecordActions(this.#f)}async _handleVariablesChanged(e){this.#y.handleVariablesChanged(e)}async _handleSharedUdpSocketMessage(e){for(const t of this.#g.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#g.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e){this.#h=e,this.#u.sendWithNoCb("saveConfig",{config:e})}setActionDefinitions(e){this.#p.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#y.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[r,s]of Object.entries(e))s&&t.push({...s,id:r});this.#u.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],r=[];this.#b.clear();for(const s of e)t.push({id:s.variableId,name:s.name}),this.#b.set(s.variableId,s),this.#_.has(s.variableId)||(this.#_.set(s.variableId,""),r.push({id:s.variableId,value:""}));if(!this.#m.disableVariableValidation){const e=new Set(this.#b.keys());for(const t of this.#_.keys())e.has(t)||(this.#_.delete(t),r.push({id:t,value:void 0}))}this.#u.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:r})}setVariableValues(e){const t=[];for(const[r,s]of Object.entries(e))this.#m.disableVariableValidation?(void 0===s?this.#_.delete(r):this.#_.set(r,s),t.push({id:r,value:s})):this.#b.has(r)?(this.#_.set(r,s??""),t.push({id:r,value:s??""})):t.push({id:r,value:void 0});this.#u.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#_.get(e)}async parseVariablesInString(e){const t=this.#y.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),(await this.#u.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text}checkFeedbacks(...e){this.#y.checkFeedbacks(e)}checkFeedbacksById(...e){this.#y.checkFeedbacksById(e)}subscribeActions(...e){this.#p.subscribeActions(e)}unsubscribeActions(...e){this.#p.unsubscribeActions(e)}subscribeFeedbacks(...e){this.#y.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#y.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#f)throw new Error("Not currently recording actions");this.#u.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}oscSend(e,t,r,s){this.#u.sendWithNoCb("send-osc",(0,n.literal)({host:e,port:t,path:r,args:s}))}updateStatus(e,t){this.#u.sendWithNoCb("set-status",(0,n.literal)({status:e,message:t??null}))}log(e,t){this.#u.sendWithNoCb("log-message",(0,n.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const r="string"==typeof e?{type:e}:e,s=new d.SharedUdpSocketImpl(this.#u,this.#g,r);return t&&s.on("message",t),s}}},1706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=function(e,t,r,i,o,a){const u=new Map,c=e=>{let t=u.get(e);return t||(t={actions:[],feedbacks:[],config:!1},u.set(e,t)),t};for(const t of Object.values(e)){const e=t?.upgradeIndex??r;t&&"number"==typeof e&&c(e).actions.push(t.id)}for(const e of Object.values(t)){const t=e?.upgradeIndex??r;e&&"number"==typeof t&&c(t).feedbacks.push(e.id)}if(!a)for(let e=r??-1;e<i.length;e++)c(e).config=!0;const l={},d={};let f;if(u.size>0){const a=Array.from(u.keys()).sort(),c=Math.min(...a,r??-1)+1,h=[],p=[],y=i.length;for(let r=c;r<y;r++){const a=u.get(r-1);a&&(h.push(...a.actions),p.push(...a.feedbacks));const c=!!a?.config;if(!c&&0===h.length&&0===p.length)continue;const y=f??o,g=(0,i[r])({currentConfig:n(y)},{config:c?y:null,actions:h.map(t=>{const r=e[t];if(r)return(0,s.literal)({id:r.id,controlId:r.controlId,actionId:r.actionId,options:void 0!==r.options?n(r.options):{}})}).filter(e=>!!e),feedbacks:p.map(e=>{const r=t[e];if(r)return(0,s.literal)({id:r.id,controlId:r.controlId,feedbackId:r.feedbackId,options:void 0!==r.options?n(r.options):{},isInverted:r.isInverted})}).filter(e=>!!e)});c&&g.updatedConfig&&(f=g.updatedConfig);for(const t of g.updatedActions)if(t){const r=e[t.id];r&&(r.actionId=t.actionId,r.options=t.options,d[t.id]=r)}for(const e of g.updatedFeedbacks)if(e){const r=t[e.id];r&&(r.feedbackId=e.feedbackId,r.options=e.options,l[e.id]={...r,style:l[e.id]?.style??e.style,isInverted:e.isInverted??!1})}}for(const[t,r]of Object.entries(e))d[t]||"number"!=typeof r?.upgradeIndex||(d[t]=r);for(const[e,r]of Object.entries(t))l[e]||"number"!=typeof r?.upgradeIndex||(l[e]=r)}return{updatedActions:d,updatedFeedbacks:l,updatedConfig:f}};const s=r(360);function n(e){return JSON.parse(JSON.stringify(e))}},1723:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(3682);t.ExceptionRequestBody=s.default,t.isExceptionRequestBody=s.isExceptionRequestBody;var n=r(5994);t.ReadCoilsRequestBody=n.default,t.isReadCoilsRequestBody=n.isReadCoilsRequestBody;var i=r(8313);t.ReadDiscreteInputsRequestBody=i.default,t.isReadDiscreteInputsRequestBody=i.isReadDiscreteInputsRequestBody;var o=r(6046);t.ReadHoldingRegistersRequestBody=o.default,t.isReadHoldingRegistersRequestBody=o.isReadHoldingRegistersRequestBody;var a=r(5445);t.ReadInputRegistersRequestBody=a.default,t.isReadInputRegistersRequestBody=a.isReadInputRegistersRequestBody;var u=r(8575);t.ModbusRequestBody=u.default,t.isModbusRequestBody=u.isModbusRequestBody;var c=r(3621);t.RequestFactory=c.default;var l=r(7936);t.WriteMultipleCoilsRequestBody=l.default,t.isWriteMultipleCoilsRequestBody=l.isWriteMultipleCoilsRequestBody;var d=r(6618);t.WriteMultipleRegistersRequestBody=d.default,t.isWriteMultipleRegistersRequestBody=d.isWriteMultipleRegistersRequestBody;var f=r(7161);t.WriteSingleCoilRequestBody=f.default,t.isWriteSingleCoilRequestBody=f.isWriteSingleCoilRequestBody;var h=r(8163);t.WriteSingleRegisterRequestBody=h.default,t.isWriteSingleRegisterRequestBody=h.isWriteSingleRegisterRequestBody},1943:e=>{"use strict";e.exports=require("fs/promises")},2004:(e,t,r)=>{"use strict";function s(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),s(r(6869)),s(r(2125))},2017:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var s,n,i;if(Array.isArray(t)){if((s=t.length)!=r.length)return!1;for(n=s;0!==n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((s=(i=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=s;0!==n--;)if(!Object.prototype.hasOwnProperty.call(r,i[n]))return!1;for(n=s;0!==n--;){var o=i[n];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}},2018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(1635);s.__exportStar(r(3730),t),s.__exportStar(r(1649),t),s.__exportStar(r(7386),t),s.__exportStar(r(1400),t),s.__exportStar(r(8983),t),s.__exportStar(r(8104),t),s.__exportStar(r(3258),t),s.__exportStar(r(131),t),s.__exportStar(r(3371),t),s.__exportStar(r(9786),t),s.__exportStar(r(6132),t)},2052:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s},o=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),e.exports=(0,i.default)("crc-16",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=~~t,s=0;s<e.length;s++){var i=e[s];r=65535&(o[255&(r^i)]^r>>8)}return r})},2075:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=function(e,r){return t(e,r)>>>0};return r.signed=t,r.unsigned=r,r.model=e,r}},2094:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(708));class o extends i.default{get start(){return this._start}get quantity(){return this._quantity}get count(){return this.quantity}get byteCount(){return 5}static fromRequest(e){const t=e.address,r=e.quantity;return new o(t,r)}static fromBuffer(e){const t=e.readUInt8(0),r=e.readUInt16BE(1),s=e.readUInt16BE(3);return t!==n.FC.WRITE_MULTIPLE_COILS?null:new o(r,s)}constructor(e,t){super(n.FC.WRITE_MULTIPLE_COILS),this._start=e,this._quantity=t}createPayload(){const e=Buffer.alloc(this.byteCount);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._start,1),e.writeUInt16BE(this._quantity,3),e}}t.default=o},2125:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.READ_COIL=1]="READ_COIL",e[e.READ_DISCRETE_INPUT=2]="READ_DISCRETE_INPUT",e[e.READ_HOLDING_REGISTERS=3]="READ_HOLDING_REGISTERS",e[e.READ_INPUT_REGISTERS=4]="READ_INPUT_REGISTERS",e[e.WRITE_SINGLE_COIL=5]="WRITE_SINGLE_COIL",e[e.WRITE_SINGLE_HOLDING_REGISTER=6]="WRITE_SINGLE_HOLDING_REGISTER",e[e.WRITE_MULTIPLE_COILS=15]="WRITE_MULTIPLE_COILS",e[e.WRITE_MULTIPLE_HOLDING_REGISTERS=16]="WRITE_MULTIPLE_HOLDING_REGISTERS"}(r=t.FC||(t.FC={})),t.isFunctionCode=function(e){return void 0!==r[e]}},2180:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8255));class o extends i.default{get code(){return this._code}get message(){return n.errorCodeToMessage(this._code)}get byteCount(){return 2}get isException(){return!0}static fromBuffer(e){const t=e.readUInt8(0)-128,r=e.readUInt8(1);if(!n.isFunctionCode(t))throw Error("InvalidFunctionCode");return new o(t,r)}static fromRequest(e){return new o(e.fc,e.code)}constructor(e,t){super(e,!0),this._code=t}createPayload(){const e=Buffer.alloc(2);return e.writeUInt8(this._fc+128,0),e.writeUInt8(this._code,1),e}}t.default=o,t.isExceptionResponseBody=function(e){return e instanceof o}},2203:e=>{"use strict";e.exports=require("stream")},2365:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const s=r(1635).__importDefault(r(228)),n=r(360);class i extends s.default{#u;#I;#m;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#i&&"object"==typeof this.#i?this.#i:void 0}#i="pending";constructor(e,t,r){super(),this.#u=e,this.#I=t,this.#m={...r}}bind(e,t,r){if(this.#i&&"object"==typeof this.#i)throw new Error("Socket is already bound");switch(this.#i){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,n.assertNever)(this.#i),new Error("Invalid socket state")}this.#i="binding",r&&this.on("listening",r),this.#u.sendWithCb("sharedUdpSocketJoin",{family:this.#m.type,portNumber:e}).then(t=>{this.#i={portNumber:e,handleId:t},this.#I.set(t,this),this.emit("listening")},e=>{this.#i="closed",this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}close(e){if(this.#i&&"object"==typeof this.#i);else switch(this.#i){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,n.assertNever)(this.#i),new Error("Invalid socket state")}const t=this.#i.handleId;this.#i="closed",e&&this.on("close",e),this.#u.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then(()=>{this.#I.delete(t),this.emit("close")},e=>{this.#I.delete(t),this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}send(e,t,r,s,n,i){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof r){if("number"!=typeof s||"string"!=typeof n)throw new Error("Invalid arguments");if(void 0!==i&&"function"!=typeof i)throw new Error("Invalid arguments");const o=this.#w(e,t,r);this.#E(o,s,n,i)}else{if("string"!=typeof r)throw new Error("Invalid arguments");{if(void 0!==s&&"function"!=typeof s)throw new Error("Invalid arguments");const n=this.#w(e,0,void 0);this.#E(n,t,r,s)}}}#w(e,t,r){let s;if("string"==typeof e)s=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))s=e;else{if(Array.isArray(e))return Buffer.from(e);s=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return s.subarray(t,void 0!==r?r+t:void 0)}#E(e,t,r,s){if(!this.#i||"object"!=typeof this.#i)throw new Error("Socket is not open");this.#u.sendWithCb("sharedUdpSocketSend",{handleId:this.#i.handleId,message:e,address:r,port:t}).then(()=>{s?.()},e=>{this.emit("error",e instanceof Error?e:new Error(e))}).catch(()=>null)}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#i="fatalError";const t=this.boundState;t&&this.#I.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=i},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeIsVisibleFn=function(e){return(e??[]).map(e=>"isVisibleExpression"in e&&"string"==typeof e.isVisibleExpression?{...e,isVisibleFnType:"expression",isVisibleFn:e.isVisibleExpression,isVisible:void 0,isVisibleExpression:void 0}:"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisibleFnType:"function",isVisible:void 0,isVisibleExpression:void 0}:{...e,isVisible:void 0,isVisibleFn:void 0,isVisibleFnType:void 0,isVisibleExpression:void 0})},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},2607:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(1462)("modbus-client"),n=r(1723);class i{constructor(e){if(new.target===i)throw new TypeError("Cannot instantiate ModbusClient directly.");if(this._socket=e,!e)throw new Error("NoSocketException.");this._socket.on("data",this._onData.bind(this))}get connectionState(){return this._requestHandler.state}get socket(){return this._socket}get requestCount(){return this._requestHandler.requestCount}readCoils(e,t){let r;s("issuing new read coils request");try{r=new n.ReadCoilsRequestBody(e,t)}catch(e){return s("unknown request error occurred"),Promise.reject(e)}return this._requestHandler.register(r)}readDiscreteInputs(e,t){let r;s("issuing new read discrete inputs request");try{r=new n.ReadDiscreteInputsRequestBody(e,t)}catch(e){return s("unknown request error occurred"),Promise.reject(e)}return this._requestHandler.register(r)}readHoldingRegisters(e,t){let r;s("issuing new read holding registers request");try{r=new n.ReadHoldingRegistersRequestBody(e,t)}catch(e){return s("unknown request error occurred"),Promise.reject(e)}return this._requestHandler.register(r)}readInputRegisters(e,t){let r;s("issuing new read input registers request");try{r=new n.ReadInputRegistersRequestBody(e,t)}catch(e){return s("unknown request error occurred"),Promise.reject(e)}return this._requestHandler.register(r)}writeSingleCoil(e,t){let r;s("issuing new write single coil request");try{r=new n.WriteSingleCoilRequestBody(e,t)}catch(e){return s("unknown request error occurred"),Promise.reject(e)}return this._requestHandler.register(r)}writeSingleRegister(e,t){let r;s("issuing new write single register request");try{r=new n.WriteSingleRegisterRequestBody(e,t)}catch(e){return s("unknown request error occurred"),Promise.reject(e)}return this._requestHandler.register(r)}writeMultipleCoils(e,t,r=0){let i;s("issuing new write multiple coils request");try{i=t instanceof Buffer?new n.WriteMultipleCoilsRequestBody(e,t,r):new n.WriteMultipleCoilsRequestBody(e,t)}catch(e){return s("unknown request error occurred"),Promise.reject(e)}return this._requestHandler.register(i)}writeMultipleRegisters(e,t){let r;s("issuing new write multiple registers request");try{r=new n.WriteMultipleRegistersRequestBody(e,t)}catch(e){return s("unknown request error occurred"),Promise.reject(e)}return this._requestHandler.register(r)}manuallyClearRequests(e){return this._requestHandler.manuallyRejectRequests(e)}manuallyRejectCurrentRequest(){return this._requestHandler.manuallyRejectCurrentRequest()}customErrorRequest(e){return this._requestHandler.customErrorRequest(e)}_onData(e){for(s("received data"),this._responseHandler.handleData(e);;){const e=this._responseHandler.shift();if(!e)return;this.unitId===e.unitId&&this._requestHandler.handle(e)}}}t.default=i},2635:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(2607)),i=s(r(1451)),o=s(r(949));class a extends n.default{constructor(e,t,r=5e3){super(e),this._requestHandler=new i.default(e,t,r),this._responseHandler=new o.default}get slaveId(){return this._requestHandler.address}get unitId(){return this._requestHandler.address}}t.default=a},2677:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s};e.exports=(0,i.default)("xmodem",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=void 0!==t?~~t:0,s=0;s<e.length;s++){var i=r>>>8&255;i^=255&e[s],r=r<<8&65535,r^=i^=i>>>4,r^=i=i<<5&65535,r^=i=i<<7&65535}return r})},2715:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LIMITS={COIL_MAX:1,COIL_MIN:0,ERROR_CODE_THRESHOLD:128,REGISTER_MAX:65535,REGISTER_MIN:0,UINT16_MAX:65535,UINT16_MIN:0}},2767:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(2715))},2827:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(7059)),i=r(2004),o=s(r(6342)),{bufferToArrayStatus:a,arrayStatusToBuffer:u}=n.default;class c extends o.default{get discrete(){return this._discrete}get valuesAsArray(){return this._valuesAsArray}get valuesAsBuffer(){return this._valuesAsBuffer}get numberOfBytes(){return this._numberOfBytes}get byteCount(){return this._numberOfBytes+2}static fromRequest(e,t){const r=a(t),s=e.start,n=s+e.count,i=r.slice(s,n);return new c(i,Math.ceil(i.length/8))}static fromBuffer(e){try{const t=e.readUInt8(0),r=e.readUInt8(1),s=e.slice(2,2+r);return s.length!==r||t!==i.FC.READ_DISCRETE_INPUT?null:new c(s,r)}catch(e){return null}}constructor(e,t){if(super(i.FC.READ_DISCRETE_INPUT),this._discrete=e,this._numberOfBytes=t,e instanceof Array)this._valuesAsArray=e,this._valuesAsBuffer=u(e);else{if(!(e instanceof Buffer))throw new Error("InvalidType_MustBeBufferOrArray");this._valuesAsBuffer=e,this._valuesAsArray=a(e)}}createPayload(){const e=Buffer.alloc(this.byteCount);return e.writeUInt8(this._fc,0),e.writeUInt8(this._numberOfBytes,1),this._valuesAsBuffer.copy(e,2),e}}t.default=c},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3290:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(6368),n=r(6641),i=r(4774),o=()=>{},a=new n.TimeoutError;t.default=class extends s{constructor(e){var t,r,s,n;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=o,this._resolveIdle=o,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:i.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(n=null===(s=e.interval)||void 0===s?void 0:s.toString())&&void 0!==n?n:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=o,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=o,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,s)=>{this._queue.enqueue(async()=>{this._pendingCount++,this._intervalCount++;try{const i=void 0===this._timeout&&void 0===t.timeout?e():n.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&s(a)});r(await i)}catch(e){s(e)}this._next()},t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3571:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{get body(){return this._body}static fromRequest(e,t){throw new TypeError("Cannot call fromRequest directly from abstract class")}}},3578:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s},o=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),e.exports=(0,i.default)("dallas-1-wire",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=~~t,s=0;s<e.length;s++){var i=e[s];r=255&o[255&(r^i)]}return r})},3621:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(3682)),o=s(r(5994)),a=s(r(8313)),u=s(r(6046)),c=s(r(5445)),l=s(r(7936)),d=s(r(6618)),f=s(r(7161)),h=s(r(8163)),p=s(r(1462)).default("request-factory");t.default=class{static fromBuffer(e){try{const t=e.readUInt8(0);if(p("fc",t,"payload",e),n.isFunctionCode(t))switch(t){case n.FC.READ_COIL:return o.default.fromBuffer(e);case n.FC.READ_DISCRETE_INPUT:return a.default.fromBuffer(e);case n.FC.READ_HOLDING_REGISTERS:return u.default.fromBuffer(e);case n.FC.READ_INPUT_REGISTERS:return c.default.fromBuffer(e);case n.FC.WRITE_SINGLE_COIL:return f.default.fromBuffer(e);case n.FC.WRITE_SINGLE_HOLDING_REGISTER:return h.default.fromBuffer(e);case n.FC.WRITE_MULTIPLE_COILS:return l.default.fromBuffer(e);case n.FC.WRITE_MULTIPLE_HOLDING_REGISTERS:return d.default.fromBuffer(e)}if(t<=43)return p("Illegal Function (fc %d)",t),new i.default(t,1)}catch(e){return p("Exception while reading function code",e),null}}}},3682:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get code(){return this._code}get name(){return"ExceptionRequest"}get count(){return 0}get byteCount(){return 2}get isException(){return!0}static fromBuffer(e){try{const t=e.readUInt8(0);return t>43?null:new o(t,1)}catch(e){return null}}constructor(e,t){if(!n.isFunctionCode(e))throw Error("InvalidFunctionCode");super(e),this._code=t}createPayload(){const e=Buffer.alloc(2);return e.writeUInt8(this._fc,0),e.writeUInt8(this._code,1),e}}t.default=o,t.isExceptionRequestBody=function(e){return e instanceof o}},3725:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserRequestError=class{constructor({err:e,message:t,response:r,request:s}){this.err=e,this.message=t,this.request=s,this.response=r}},t.isUserRequestError=function e(t){return t instanceof e||"object"==typeof t&&void 0!==t.err&&"string"==typeof t.err&&void 0!==t.message&&"string"==typeof t.message}},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3782:(e,t,r)=>{"use strict";function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":s(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var s=0,n=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(s++,"%c"===e&&(n=s))}),t.splice(n,0,r)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=r(1273)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},3835:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(3725))},3839:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s},o=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),e.exports=(0,i.default)("kermit",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=void 0!==t?~~t:0,s=0;s<e.length;s++){var i=e[s];r=65535&(o[255&(r^i)]^r>>8)}return r})},4044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const s=r(1635),n=r(360),i=s.__importDefault(r(6022));t.IpcWrapper=class{#C;#R;#O;#S=1;#k=new Map;constructor(e,t,r){this.#C=e,this.#R=t,this.#O=r}async sendWithCb(e,t,r,s=0){s<=0&&(s=this.#O);const n={timeout:void 0,resolve:()=>null,reject:()=>null},o=new Promise((e,t)=>{n.resolve=e,n.reject=t});this.#S>268435456&&(this.#S=1);const a=this.#S++;this.#k.set(a,n),this.#R({direction:"call",name:String(e),payload:i.default.stringify(t),callbackId:a});const u=new Error("Call timed out");return n.timeout=setTimeout(()=>{n.reject(r?r():u),this.#k.delete(a)},s),o}sendWithNoCb(e,t){this.#R({direction:"call",name:String(e),payload:i.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#C[e.name];if(!t)return void(e.callbackId&&this.#R({direction:"response",callbackId:e.callbackId,success:!1,payload:i.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?i.default.parse(e.payload):void 0).then(t=>{e.callbackId&&this.#R({direction:"response",callbackId:e.callbackId,success:!0,payload:i.default.stringify(t)})},t=>{e.callbackId&&this.#R({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):i.default.stringify(t)})});break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#k.get(e.callbackId);if(this.#k.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const r=e.payload?i.default.parse(e.payload):void 0;if(e.success)t.resolve(r);else{let e=r;r&&"object"==typeof r&&"message"in r&&(e=new Error(r.message),r.stack&&(e.stack=r.stack)),t.reject(e)}break}default:(0,n.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},4082:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(853),i=r(1723),o=s(r(7059)),a=r(2004),{bufferToArrayStatus:u,arrayStatusToBuffer:c}=o.default,l=r(1462)("modbus tcp response handler");t.default=class{constructor(e,t){this._server=e,this._fromRequest=t}handle(e,t){if(!e)return null;if(i.isExceptionRequestBody(e.body)){const r=n.ExceptionResponseBody.fromRequest(e.body),s=this._fromRequest(e,r);return t(s.createPayload()),s}const r=e.body.fc;if(a.isFunctionCode(r))switch(r){case a.FC.READ_COIL:return this._handleReadCoil(e,t);case a.FC.READ_DISCRETE_INPUT:return this._handleDiscreteInput(e,t);case a.FC.READ_HOLDING_REGISTERS:return this._handleReadHoldingRegisters(e,t);case a.FC.READ_INPUT_REGISTERS:return this._handleReadInputRegisters(e,t);case a.FC.WRITE_SINGLE_COIL:return this._handleWriteSingleCoil(e,t);case a.FC.WRITE_SINGLE_HOLDING_REGISTER:return this._handleWriteSingleHoldingRegister(e,t);case a.FC.WRITE_MULTIPLE_COILS:return this._handleWriteMultipleCoils(e,t);case a.FC.WRITE_MULTIPLE_HOLDING_REGISTERS:return this._handleWriteMultipleHoldingRegisters(e,t)}}_handleReadCoil(e,t){if(!i.isReadCoilsRequestBody(e.body))throw new Error(`InvalidRequestClass - Expected ReadCoilsRequestBody but received ${e.body.name}`);if(!this._server.coils)return l("no coils buffer on server, trying readCoils handler"),void this._server.emit("readCoils",e,t);this._server.emit("preReadCoils",e,t);const r=n.ReadCoilsResponseBody.fromRequest(e.body,this._server.coils),s=this._fromRequest(e,r);return t(s.createPayload()),this._server.emit("postReadCoils",e,t),s}_handleDiscreteInput(e,t){if(!i.isReadDiscreteInputsRequestBody(e.body))throw new Error(`InvalidRequestClass - Expected ReadDiscreteInputsRequestBody but received ${e.body.name}`);if(!this._server.discrete)return l("no discrete input buffer on server, trying readDiscreteInputs handler"),void this._server.emit("readDiscreteInputs",e,t);this._server.emit("preReadDiscreteInputs",e,t);const r=n.ReadDiscreteInputsResponseBody.fromRequest(e.body,this._server.discrete),s=this._fromRequest(e,r);return t(s.createPayload()),this._server.emit("postReadDiscreteInputs",e,t),s}_handleReadHoldingRegisters(e,t){if(!i.isReadHoldingRegistersRequestBody(e.body)){const t=`InvalidRequestClass - Expected ReadHoldingRegistersRequestBody but received ${e.body.name}`;throw new Error(t)}if(!this._server.holding)return l("no holding register buffer on server, trying readHoldingRegisters handler"),void this._server.emit("readHoldingRegisters",e,t);this._server.emit("preReadHoldingRegisters",e,t);const r=n.ReadHoldingRegistersResponseBody.fromRequest(e.body,this._server.holding),s=this._fromRequest(e,r);return t(s.createPayload()),this._server.emit("postReadHoldingRegisters",e,t),s}_handleReadInputRegisters(e,t){if(!i.isReadInputRegistersRequestBody(e.body))throw new Error(`InvalidRequestClass - Expected ReadInputRegistersRequestBody but received ${e.body.name}`);if(!this._server.input)return l("no input register buffer on server, trying readInputRegisters handler"),void this._server.emit("readInputRegisters",e,t);this._server.emit("preReadInputRegisters",e,t);const r=n.ReadInputRegistersResponseBody.fromRequest(e.body,this._server.input),s=this._fromRequest(e,r);return t(s.createPayload()),this._server.emit("postReadInputRegisters",e,t),s}_handleWriteSingleCoil(e,t){if(!i.isWriteSingleCoilRequestBody(e.body))throw new Error(`InvalidRequestClass - Expected WriteSingleCoilRequestBody but received ${e.body.name}`);if(!this._server.coils)return l("no coils buffer on server, trying writeSingleCoil handler"),void this._server.emit("writeSingleCoil",e,t);this._server.emit("preWriteSingleCoil",e,t);const r=n.WriteSingleCoilResponseBody.fromRequest(e.body),s=e.body.address;l("Writing value %d to address %d",e.body.value,s);const o=this._server.coils.readUInt8(Math.floor(s/8));let a;if(65280!==e.body.value&&0!==e.body.value){l("illegal data value");const r=new n.ExceptionResponseBody(e.body.fc,3),s=this._fromRequest(e,r);return t(s.createPayload()),s}if(a=65280===e.body.value?o|Math.pow(2,s%8):o&~Math.pow(2,s%8),r.address/8>this._server.coils.length){l("illegal data address");const r=new n.ExceptionResponseBody(e.body.fc,2),s=this._fromRequest(e,r);return t(s.createPayload()),s}this._server.coils.writeUInt8(a,Math.floor(s/8));const u=this._fromRequest(e,r);return t(u.createPayload()),this._server.emit("postWriteSingleCoil",e,t),u}_handleWriteSingleHoldingRegister(e,t){if(!i.isWriteSingleRegisterRequestBody(e.body))throw new Error(`InvalidRequestClass - Expected WriteSingleRegisterRequestBody but received ${e.body.name}`);if(!this._server.holding)return l("no register buffer on server, trying writeSingleRegister handler"),void this._server.emit("writeSingleRegister",e,t);this._server.emit("preWriteSingleRegister",e,t);const r=n.WriteSingleRegisterResponseBody.fromRequest(e.body);if(2*r.address>this._server.holding.length){l("illegal data address");const r=new n.ExceptionResponseBody(e.body.fc,2),s=this._fromRequest(e,r);return t(s.createPayload()),s}this._server.holding.writeUInt16BE(r.value,2*r.address);const s=this._fromRequest(e,r);return t(s.createPayload()),this._server.emit("postWriteSingleRegister",e,t),s}_handleWriteMultipleCoils(e,t){if(!i.isWriteMultipleCoilsRequestBody(e.body))throw new Error(`InvalidRequestClass - Expected WriteMultipleCoilsRequestBody but received ${e.body.name}`);if(!this._server.coils)return l("no coils buffer on server, trying writeMultipleCoils handler"),void this._server.emit("writeMultipleCoils",e,t);this._server.emit("preWriteMultipleCoils",e,t);const r=n.WriteMultipleCoilsResponseBody.fromRequest(e.body),s=u(this._server.coils),o=u(e.body.valuesAsBuffer),a=e.body.address,d=a+e.body.quantity,f=s.map((e,t)=>{let r=e;if(t>=a&&t<d){const t=o.shift();r=void 0!==t?t:e}return r});this._server.emit("writeMultipleCoils",this._server.coils,s),this._server.coils.fill(c(f)),this._server.emit("postWriteMultipleCoils",this._server.coils,f);const h=this._fromRequest(e,r);return t(h.createPayload()),this._server.emit("postWriteMultipleCoils",e,t),h}_handleWriteMultipleHoldingRegisters(e,t){if(!i.isWriteMultipleRegistersRequestBody(e.body))throw new Error(`InvalidRequestClass - Expected WriteMultipleRegistersRequestBody but received ${e.body.name}`);if(!this._server.holding)return l("no register buffer on server, trying writeMultipleRegisters handler"),void this._server.emit("writeMultipleRegisters",e,t);this._server.emit("preWriteMultipleRegisters",e,t);const r=n.WriteMultipleRegistersResponseBody.fromRequest(e.body);if(2*e.body.address+e.body.values.length>this._server.holding.length){l("illegal data address");const r=new n.ExceptionResponseBody(e.body.fc,2),s=this._fromRequest(e,r);return t(s.createPayload()),s}this._server.emit("writeMultipleRegisters",this._server.holding),l("Request Body: ",e.body),this._server.holding.fill(new Uint8Array(e.body.values),2*e.body.address,2*e.body.address+e.body.values.length),this._server.emit("postWriteMultipleRegisters",this._server.holding);const s=this._fromRequest(e,r);return t(s.createPayload()),this._server.emit("postWriteMultipleRegisters",e,t),s}}},4140:(e,t,r)=>{"use strict";var s=r(9637),n=r(9023);t.init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),s=0;s<r.length;s++)e.inspectOpts[r[s]]=t.inspectOpts[r[s]]},t.log=function(){return process.stderr.write(n.format.apply(n,arguments)+"\n")},t.formatArgs=function(r){var s=this.namespace;if(this.useColors){var n=this.color,i="[3"+(n<8?n:"8;5;"+n),o="  ".concat(i,";1m").concat(s," [0m");r[0]=o+r[0].split("\n").join("\n"+o),r.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+s+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):s.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var i=r(7687);i&&(i.stderr||i).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),s=process.env[t];return s=!!/^(yes|on|true|enabled)$/i.test(s)||!/^(no|off|false|disabled)$/i.test(s)&&("null"===s?null:Number(s)),e[r]=s,e},{}),e.exports=r(1273)(t);var o=e.exports.formatters;o.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).split("\n").map(function(e){return e.trim()}).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}},4187:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(6342));class o extends i.default{get byteCount(){return this._bufferLength}get values(){return this._values}get valuesAsArray(){return this._valuesAsArray}get valuesAsBuffer(){return this._valuesAsBuffer}get length(){return this._values.length}static fromRequest(e,t){const r=2*e.start,s=r+2*e.count,n=t.slice(r,s);return new o(n.length,n)}static fromBuffer(e){const t=e.readUInt8(0),r=e.readUInt8(1),s=e.slice(2,2+r);if(t!==n.FC.READ_INPUT_REGISTERS)return null;const i=[];for(let e=0;e<r;e+=2)i.push(s.readUInt16BE(e));return new o(r,i,s)}constructor(e,t,r){if(super(n.FC.READ_INPUT_REGISTERS),this._byteCount=e,this._values=t,this._bufferLength=2,t instanceof Array)this._valuesAsArray=t,this._valuesAsBuffer=Buffer.from(t),this._bufferLength+=2*t.length;else{if(!(t instanceof Buffer))throw new Error("InvalidType_MustBeBufferOrArray");this._valuesAsArray=Uint16Array.from(t),this._valuesAsBuffer=t,this._bufferLength+=t.length}r instanceof Buffer&&(this._valuesAsBuffer=r)}createPayload(){if(this._values instanceof Buffer){let e=Buffer.alloc(2);return e.writeUInt8(this._fc,0),e.writeUInt8(this._byteCount,1),e=Buffer.concat([e,this._values]),e}if(this._values instanceof Array){const e=Buffer.alloc(this._byteCount+2);return e.writeUInt8(this._fc,0),e.writeUInt8(this._byteCount,1),this._values.forEach((t,r)=>{e.writeUInt16BE(Math.max(0,Math.min(65535,t)),2+2*r)}),e}throw new Error("this._values is not an instance of a Buffer or an Array")}}t.default=o},4215:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=s(r(5585));t.ModbusTCPClient=i.default;const o=s(r(2635));t.ModbusRTUClient=o.default;const a=s(r(8885));t.ModbusTCPServer=a.default;const u=s(r(4375));t.ModbusRTUServer=u.default;const c=n(r(2004)),l=n(r(8421)),d=n(r(1723)),f=n(r(853)),h=s(r(1306)),p=r(2767);t.client={RTU:o.default,TCP:i.default},t.server={RTU:u.default,TCP:a.default},t.requests=Object.assign({},d,{UserRequest:h.default}),t.responses=f,t.codes=c,t.errors=l,t.limits=p.LIMITS;var y=r(5783);t.ModbusAbstractRequest=y.default;var g=r(3571);t.ModbusAbstractResponse=g.default;var b=r(147);t.MBClientRequestHandler=b.default;var _=r(8637);t.ModbusClientResponseHandler=_.default;var m=r(2607);t.ModbusClient=m.default;var v=r(9326);t.ModbusTCPRequest=v.default;var I=r(8656);t.ModbusTCPResponse=I.default;var w=r(4732);t.ModbusRTURequest=w.default;var E=r(9390);t.ModbusRTUResponse=E.default;var C=r(3725);t.UserRequestError=C.UserRequestError;var R=r(1306);t.UserRequest=R.default;var O=r(6818);t.UserRequestMetrics=O.UserRequestMetrics},4241:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("tcp-client-request-handler"),i=s(r(147)),o=s(r(9326)),a=r(3725);class u extends i.default{constructor(e,t,r=5e3){super(e,r),this._requestId=0,this._unitId=t,this._requests=[],this._currentRequest=null,this._socket.on("connect",this._onConnect.bind(this)),this._socket.on("close",this._onClose.bind(this))}register(e){this._requestId=(this._requestId+1)%65535,n("registrating new request","transaction id",this._requestId,"unit id",this._unitId,"length",e.byteCount);const t=new o.default(this._requestId,0,e.byteCount+1,this._unitId,e);return super.registerRequest(t)}handle(e){if(!e)return;const t=this._currentRequest;if(!t)return void n("something is strange, received a respone without a request");const r=t.request;return e.id!==r.id?(n("something weird is going on, response transition id does not equal request transition id",e.id,r.id),t.reject(new a.UserRequestError({err:"OutOfSync",message:"request fc and response fc does not match.",request:r})),void this._clearAllRequests()):0!==e.protocol?(n("server responds with wrong protocol version"),t.reject(new a.UserRequestError({err:"Protocol",message:"Unknown protocol version "+e.protocol,request:r})),void this._clearAllRequests()):void super.handle(e)}}t.default=u},4289:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const s=r(2593);function n(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#P;#A;#B;#q;#M=new Map;#j=new Map;constructor(e,t,r,s){this.#P=e,this.#A=t,this.#B=r,this.#q=s}async handleExecuteAction(e){const t=this.#M.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:(t,r)=>{this.#B({customVariableId:t,value:r,controlId:e.action.controlId})}};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},r)}handleUpdateActions(e){for(const[t,r]of Object.entries(e)){const e=this.#j.get(t);if(e){const t=this.#M.get(e.actionId);if(t?.unsubscribe){const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(n(e),r)).catch(t=>{this.#q("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}if(!r||r.disabled)this.#j.delete(t);else{this.#j.set(t,r);const e=this.#M.get(r.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#P({text:e,controlId:r.controlId,actionInstanceId:r.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(e.subscribe(n(r),t)).catch(e=>{this.#q("error",`Action subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)})}}}}async handleLearnAction(e){const t=this.#M.get(e.action.actionId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during learn")}};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},r)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#M.clear();for(const[r,n]of Object.entries(e))n&&(t.push({id:r,name:n.name,description:n.description,options:(0,s.serializeIsVisibleFn)(n.options),hasLearn:!!n.learn,learnTimeout:n.learnTimeout,hasLifecycleFunctions:!!n.subscribe||!!n.unsubscribe}),this.#M.set(r,n));this.#A({actions:t})}subscribeActions(e){let t=Array.from(this.#j.values());const r=new Set(e);r.size&&(t=t.filter(e=>r.has(e.actionId)));for(const e of t){const t=this.#M.get(e.actionId);if(t?.subscribe){const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during subscribe")}};Promise.resolve(t.subscribe(n(e),r)).catch(t=>{this.#q("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}unsubscribeActions(e){let t=Array.from(this.#j.values());const r=new Set(e);r.size&&(t=t.filter(e=>r.has(e.actionId)));for(const e of t){const t=this.#M.get(e.actionId);if(t&&t.unsubscribe){const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text,setCustomVariableValue:()=>{throw new Error("setCustomVariableValue is not available during unsubscribe")}};Promise.resolve(t.unsubscribe(n(e),r)).catch(t=>{this.#q("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}}},4326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=function(e,t){Promise.resolve().then(async()=>{if(l)throw new Error("runEntrypoint can only be called once");if(l=!0,t||(t=[]),!Array.isArray(t))throw new Error("upgradeScripts must be an array");for(const e of t)if("function"!=typeof e)throw new Error("upgradeScripts must be an array of functions");const r=process.env.MODULE_MANIFEST;if(!r)throw new Error("Module initialise is missing MODULE_MANIFEST");const s=await i.default.readFile(r),d=JSON.parse(s.toString());if(d.runtime?.api!==n.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!d.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let f=d.runtime.apiVersion;if("0.0.0"===f)try{const e=await i.default.readFile(u.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(f=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const h=process.env.CONNECTION_ID;if("string"!=typeof h||!h)throw new Error("Module initialise is missing CONNECTION_ID");const p=process.env.VERIFICATION_TOKEN;if("string"!=typeof p||!p)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const y=new a.IpcWrapper({},e=>{process.send(e)},5e3);process.once("message",e=>{y.receivedMessage(e)}),c=new e((0,o.literal)({id:h,upgradeScripts:t,_isInstanceBaseProps:!0})),y.sendWithCb("register",{apiVersion:f,connectionId:h,verificationToken:p}).then(()=>{console.log("Module-host accepted registration")},e=>{console.error("Module registration failed",e),process.exit(11)})}).catch(e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)})};const s=r(1635),n=r(9967),i=s.__importDefault(r(1943)),o=r(360),a=r(4044),u=s.__importDefault(r(6928));let c,l=!1},4375:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(8859)),i=s(r(5971)),o=s(r(4732)),a=s(r(9390));class u extends i.default{constructor(e,t){super(t),this._socket=e;const r=o.default.fromBuffer,s=a.default.fromRequest,i=new n.default(this,e,r,s);this.emit("connection",i)}}t.default=u},4434:e=>{"use strict";e.exports=require("events")},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then(e=>new Promise(e=>{e(t())}).then(()=>e),e=>new Promise(e=>{e(t())}).then(()=>{throw e})))},4732:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("rtu-request"),i=r(8809),o=s(r(5783)),a=s(r(3621));class u extends o.default{constructor(e,t,r=!1){super(),this._address=e,this._body=t,this._corrupted=r}get address(){return this._address}get slaveId(){return this.address}get unitId(){return this.address}get crc(){return this._crc}get name(){return this._body.name}get corrupted(){return!0===this._corrupted}get body(){return this._body}get byteCount(){return this.body.byteCount+3}static fromBuffer(e){try{if(e.length<3)return n("not enough data in the buffer yet"),null;const t=e.readUInt8(0);n(`rtu header complete, address, ${t}`),n("buffer",e);const r=a.default.fromBuffer(e.slice(1));if(!r)return null;const s=1+r.byteCount,o=i.crc16modbus(e.slice(0,s)),c=e.readUInt16LE(s);return new u(t,r,o!==c)}catch(e){return n("not enough data to create a rtu request",e),null}}createPayload(){const e=this._body.createPayload();this._crc=i.crc16modbus(Buffer.concat([Buffer.from([this._address]),e]));const t=Buffer.alloc(2);t.writeUInt16LE(this._crc,0);const r=Buffer.from([this._address]);return Buffer.concat([r,e,t])}}t.default=u},4774:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const n=s.default(this._queue,r,(e,t)=>t.priority-e.priority);this._queue.splice(n,0,r)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(e=>e.run)}get size(){return this._queue.length}}},4865:e=>{"use strict";const t=(e,t,s,n)=>{if("length"===s||"prototype"===s)return;if("arguments"===s||"caller"===s)return;const i=Object.getOwnPropertyDescriptor(e,s),o=Object.getOwnPropertyDescriptor(t,s);!r(i,o)&&n||Object.defineProperty(e,s,o)},r=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},s=(e,t)=>`/* Wrapped ${e}*/\n${t}`,n=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),i=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,r,{ignoreNonConfigurable:o=!1}={})=>{const{name:a}=e;for(const s of Reflect.ownKeys(r))t(e,r,s,o);return((e,t)=>{const r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)})(e,r),((e,t,r)=>{const o=""===r?"":`with ${r.trim()}() `,a=s.bind(null,o,t.toString());Object.defineProperty(a,"name",i),Object.defineProperty(e,"toString",{...n,value:a})})(e,r,a),e}},5445:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get start(){return this._start}get count(){return this._count}get name(){return"ReadInputRegisters"}get byteCount(){return 5}static fromBuffer(e){try{const t=e.readUInt8(0),r=e.readUInt16BE(1),s=e.readUInt16BE(3);return t!==n.FC.READ_INPUT_REGISTERS?null:new o(r,s)}catch(e){return null}}constructor(e,t){if(super(n.FC.READ_INPUT_REGISTERS),e>65535)throw new Error("InvalidStartAddress");if(t>2e3)throw new Error("InvalidQuantity");this._start=e,this._count=t}createPayload(){const e=Buffer.alloc(5);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._start,1),e.writeUInt16BE(this._count,3),e}}t.default=o,t.isReadInputRegistersRequestBody=function(e){return e instanceof o}},5585:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(2607)),i=s(r(4241)),o=s(r(8883));class a extends n.default{constructor(e,t=1,r=5e3){super(e),this._requestHandler=new i.default(e,t,r),this._responseHandler=new o.default,this._unitId=t,this._timeout=r}get slaveId(){return this._unitId}get unitId(){return this._unitId}}t.default=a},5608:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(708));class o extends i.default{get start(){return this._start}get quantity(){return this._quantity}get count(){return this.quantity}get byteCount(){return 5}static fromRequest(e){const t=e.address,r=e.quantity;return new o(t,r)}static fromBuffer(e){const t=e.readUInt8(0),r=e.readUInt16BE(1),s=e.readUInt16BE(3);return t!==n.FC.WRITE_MULTIPLE_HOLDING_REGISTERS?null:new o(r,s)}constructor(e,t){super(n.FC.WRITE_MULTIPLE_HOLDING_REGISTERS),this._start=e,this._quantity=t}createPayload(){const e=Buffer.alloc(this.byteCount);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._start,1),e.writeUInt16BE(this._quantity,3),e}}t.default=o},5644:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("read-coils-response"),i=s(r(7059)),o=r(2004),a=s(r(6342)),{bufferToArrayStatus:u,arrayStatusToBuffer:c}=i.default;class l extends a.default{get values(){return this._coils}get valuesAsArray(){return this._valuesAsArray}get valuesAsBuffer(){return this._valuesAsBuffer}get numberOfBytes(){return this._numberOfBytes}get byteCount(){return this._numberOfBytes+2}static fromRequest(e,t){const r=u(t),s=e.start,n=s+e.count,i=r.slice(s,n);return new l(i,Math.ceil(i.length/8))}static fromBuffer(e){try{const t=e.readUInt8(0),r=e.readUInt8(1),s=e.slice(2,2+r);return s.length!==r||t!==o.FC.READ_COIL?null:new l(s,r)}catch(e){return n("no valid read coils response body in the buffer yet"),null}}constructor(e,t){if(super(o.FC.READ_COIL),this._coils=e,this._numberOfBytes=t,e instanceof Array)this._valuesAsArray=e,this._valuesAsBuffer=c(e);else{if(!(e instanceof Buffer))throw new Error("InvalidCoilsInput");this._valuesAsBuffer=e,this._valuesAsArray=u(e)}}createPayload(){const e=Buffer.alloc(this.byteCount);return e.writeUInt8(this._fc,0),e.writeUInt8(this._numberOfBytes,1),this._valuesAsBuffer.copy(e,2),e}}t.default=l},5783:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{}r.fromBuffer=e=>{throw new TypeError("Cannot call from buffer from base abstract class")},t.default=r,t.isModbusRequest=function(e){return void 0!==e.body}},5884:e=>{"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",s=t.indexOf(r+e),n=t.indexOf("--");return-1!==s&&(-1===n||s<n)}},5971:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4434),n={coils:Buffer.alloc(1024),discrete:Buffer.alloc(1024),holding:Buffer.alloc(1024),input:Buffer.alloc(1024)};class i extends s.EventEmitter{get _coils(){return this._options.coils}get _discrete(){return this._options.discrete}get _holding(){return this._options.holding}get _input(){return this._options.input}constructor(e=n){super(),this._options=Object.assign({},n,e)}get coils(){return this._coils}get discrete(){return this._discrete}get holding(){return this._holding}get input(){return this._input}on(e,t){return super.on(e,t)}emit(e,...t){return super.emit(e,...t)}}t.default=i},5994:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get start(){return this._start}get count(){return this._count}get name(){return"ReadCoils"}get byteCount(){return 5}static fromBuffer(e){try{if(e.readUInt8(0)!==n.FC.READ_COIL)return null;const t=e.readUInt16BE(1),r=e.readUInt16BE(3);return new o(t,r)}catch(e){return null}}constructor(e,t){if(super(n.FC.READ_COIL),this._start=e,this._count=t,this._start>65535)throw new Error("InvalidStartAddress");if(this._count>2e3)throw new Error("InvalidQuantity")}createPayload(){const e=Buffer.alloc(5);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._start,1),e.writeUInt16BE(this._count,3),e}}t.default=o,t.isReadCoilsRequestBody=function(e){return e instanceof o}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===s(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var n=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=n,t.convertMapToObject=function(e){return Array.from(e).reduce(function(e,t){var s,n,i=(n=2,function(e){if(Array.isArray(e))return e}(s=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var s,n,i=[],o=!0,a=!1;try{for(r=r.call(e);!(o=(s=r.next()).done)&&(i.push(s.value),!t||i.length!==t);o=!0);}catch(e){a=!0,n=e}finally{try{o||null==r.return||r.return()}finally{if(a)throw n}}return i}}(s,n)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?r(e,t):void 0}}(s,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],a=i[1];return e[o]=a,e},{})},t.isArguments=function(e){return null!=e&&n(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var i={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=i,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(i.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var r=Object.create(null),s=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},n=function(e){return"="===e?-1:r[e]},i=0;i<64;i++)r[s(i)]=i;var o=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],r=0;r<e;r++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},a={encode:function(e){if("string"==typeof e){var t=e;e=o(t.length);for(var r=0;r<t.length;r++){var n=t.charCodeAt(r);if(n>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[r]=n}}for(var i=[],a=null,u=null,c=null,l=null,d=0;d<e.length;d++)switch(d%3){case 0:a=e[d]>>2&63,u=(3&e[d])<<4;break;case 1:u|=e[d]>>4&15,c=(15&e[d])<<2;break;case 2:c|=e[d]>>6&3,l=63&e[d],i.push(s(a)),i.push(s(u)),i.push(s(c)),i.push(s(l)),a=null,u=null,c=null,l=null}return null!=a&&(i.push(s(a)),i.push(s(u)),null==c?i.push("="):i.push(s(c)),null==l&&i.push("=")),i.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var r=o(t),s=null,i=null,a=null,u=0,c=0;c<e.length;c++){var l=e.charAt(c),d=n(l);switch(c%4){case 0:if(d<0)throw new Error("invalid base64 string");s=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");s|=d>>4,r[u++]=s,i=(15&d)<<4;break;case 2:d>=0&&(i|=d>>2,r[u++]=i,a=(3&d)<<6);break;case 3:d>=0&&(r[u++]=a|d)}}return r},newBinary:o};t.Base64=a},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function s(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function e(t,n,i,o,a){var u=n[t];switch(r(u)){case"string":return s(u);case"number":return isFinite(u)?String(u):"null";case"boolean":return String(u);case"object":if(!u)return"null";var c,l=o+i,d=[];if(Array.isArray(u)||{}.hasOwnProperty.call(u,"callee")){for(var f=u.length,h=0;h<f;h+=1)d[h]=e(h,u,i,l,a)||"null";return c=0===d.length?"[]":l?"[\n"+l+d.join(",\n"+l)+"\n"+o+"]":"["+d.join(",")+"]"}var p=Object.keys(u);return a&&(p=p.sort()),p.forEach(function(t){(c=e(t,u,i,l,a))&&d.push(s(t)+(l?": ":":")+c)}),c=0===d.length?"{}":l?"{\n"+l+d.join(",\n"+l)+"\n"+o+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var r=Object.assign({indent:"",canonical:!1},t);if(!0===r.indent)r.indent="  ";else if("number"==typeof r.indent){for(var s="",i=0;i<r.indent;i++)s+=" ";r.indent=s}return n("",{"":e},r.indent,"",r.canonical)},e.exports=t.default}],r={};function s(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,s),i.exports}var n={};!function(){var e=n,t=s(2).Base64,r=s(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var i=s(1),o={};e.EJSON=o;var a=new Map;o.addType=function(e,t){if(a.has(e))throw new Error("Type ".concat(e," already present"));a.set(e,t)};var u=[{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$date")&&1===(0,i.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$regexp")&&(0,i.hasOwn)(e,"$flags")&&2===(0,i.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$InfNaN")&&1===(0,i.lengthOf)(e)},matchObject:i.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$binary")&&1===(0,i.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,i.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$escape")&&1===(0,i.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var r=(0,i.lengthOf)(e);1!==r&&2!==r||(t=u.some(function(t){return t.matchJSONValue(e)}))}return t},toJSONValue:function(e){var t={};return(0,i.keysOf)(e).forEach(function(r){t[r]=o.toJSONValue(e[r])}),{$escape:t}},fromJSONValue:function(e){var t={};return(0,i.keysOf)(e.$escape).forEach(function(r){t[r]=o.fromJSONValue(e.$escape[r])}),t}},{matchJSONValue:function(e){return(0,i.hasOwn)(e,"$type")&&(0,i.hasOwn)(e,"$value")&&2===(0,i.lengthOf)(e)},matchObject:function(e){return o._isCustomType(e)},toJSONValue:function(e){var t=r._noYieldsAllowed(function(){return e.toJSONValue()});return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!a.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var s=a.get(t);return r._noYieldsAllowed(function(){return s(e.$value)})}}];o._isCustomType=function(e){return e&&(0,i.isFunction)(e.toJSONValue)&&(0,i.isFunction)(e.typeName)&&a.has(e.typeName())},o._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?a:(0,i.convertMapToObject)(a)},o._getConverters=function(){return u};var c=function(e){for(var t=0;t<u.length;t++){var r=u[t];if(r.matchObject(e))return r.toJSONValue(e)}},l=function e(t){if(null===t)return null;var r=c(t);return void 0!==r?r:(0,i.isObject)(t)?((0,i.keysOf)(t).forEach(function(r){var s=t[r];if((0,i.isObject)(s)||void 0===s||(0,i.isInfOrNaN)(s)){var n=c(s);n?t[r]=n:e(s)}}),t):t};o._adjustTypesToJSONValue=l,o.toJSONValue=function(e){var t=c(e);if(void 0!==t)return t;var r=e;return(0,i.isObject)(e)&&(r=o.clone(e),l(r)),r};var d=function(e){if((0,i.isObject)(e)&&null!==e){var t=(0,i.keysOf)(e);if(t.length<=2&&t.every(function(e){return"string"==typeof e&&"$"===e.substr(0,1)}))for(var r=0;r<u.length;r++){var s=u[r];if(s.matchJSONValue(e))return s.fromJSONValue(e)}}return e},f=function e(t){if(null===t)return null;var r=d(t);return r!==t?r:(0,i.isObject)(t)?((0,i.keysOf)(t).forEach(function(r){var s=t[r];if((0,i.isObject)(s)){var n=d(s);if(s!==n)return void(t[r]=n);e(s)}}),t):t};o._adjustTypesFromJSONValue=f,o.fromJSONValue=function(e){var t=d(e);return t===e&&(0,i.isObject)(e)&&(t=o.clone(e),f(t)),t},o.stringify=(0,i.handleError)(function(e,t){var r=o.toJSONValue(e);return t&&(t.canonical||t.indent)?s(4)(r,t):JSON.stringify(r)}),o.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return o.fromJSONValue(JSON.parse(e))},o.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},o.equals=function(e,t,r){var s,n=!(!r||!r.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,i.isObject)(e)||!(0,i.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(o.isBinary(e)&&o.isBinary(t)){if(e.length!==t.length)return!1;for(s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0}if((0,i.isFunction)(e.equals))return e.equals(t,r);if((0,i.isFunction)(t.equals))return t.equals(e,r);var a,u=Array.isArray(e),c=Array.isArray(t);if(u!==c)return!1;if(u&&c){if(e.length!==t.length)return!1;for(s=0;s<e.length;s++)if(!o.equals(e[s],t[s],r))return!1;return!0}switch(o._isCustomType(e)+o._isCustomType(t)){case 1:return!1;case 2:return o.equals(o.toJSONValue(e),o.toJSONValue(t))}var l=(0,i.keysOf)(e),d=(0,i.keysOf)(t);return n?(s=0,a=l.every(function(n){return!(s>=d.length||n!==d[s]||!o.equals(e[n],t[d[s]],r)||(s++,0))})):(s=0,a=l.every(function(n){return!!(0,i.hasOwn)(t,n)&&!!o.equals(e[n],t[n],r)&&(s++,!0)})),a&&s===d.length},o.clone=function(e){var t;if(!(0,i.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(o.isBinary(e)){t=o.newBinary(e.length);for(var r=0;r<e.length;r++)t[r]=e[r];return t}return Array.isArray(e)?e.map(o.clone):(0,i.isArguments)(e)?Array.from(e).map(o.clone):(0,i.isFunction)(e.clone)?e.clone():o._isCustomType(e)?o.fromJSONValue(o.clone(o.toJSONValue(e)),!0):(t={},(0,i.keysOf)(e).forEach(function(r){t[r]=o.clone(e[r])}),t)},o.newBinary=t.newBinary}(),e.exports=n.EJSON}()},6045:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s},o=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),e.exports=(0,i.default)("crc-16-modbus",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=void 0!==t?~~t:65535,s=0;s<e.length;s++){var i=e[s];r=65535&(o[255&(r^i)]^r>>8)}return r})},6046:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get start(){return this._start}get count(){return this._count}get byteCount(){return 5}get name(){return"ReadHoldingRegisters"}static fromBuffer(e){try{const t=e.readUInt8(0),r=e.readUInt16BE(1),s=e.readUInt16BE(3);return t!==n.FC.READ_HOLDING_REGISTERS?null:new o(r,s)}catch(e){return null}}constructor(e,t){if(super(n.FC.READ_HOLDING_REGISTERS),e>65535)throw new Error("InvalidStartAddress");if(t>2e3)throw new Error("InvalidQuantity");this._start=e,this._count=t}createPayload(){const e=Buffer.alloc(5);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._start,1),e.writeUInt16BE(this._count,3),e}}t.default=o,t.isReadHoldingRegistersRequestBody=function(e){return e instanceof o}},6079:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=["InvalidStartAddress","InvalidQuantity","InvalidArraySize","InvalidBufferSize","InvalidCoilsInput","InvalidType_MustBeBufferOrArray","InvalidValue"];t.isInternalException=function(e){return"object"==typeof e&&!!r.includes(e.message)}},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var s=r(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return s.TCPHelper}});var n=r(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return n.TelnetHelper}});var i=r(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return i.UDPHelper}})},6250:(e,t,r)=>{"use strict";const s=r(2017);s.code='require("ajv/dist/runtime/equal").default',t.A=s},6259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const s=r(1635).__importDefault(r(7194)),n=r(228),i=r(1400);class o extends n.EventEmitter{#T;#x;#U;#m;#N=!1;#F;#r;get isDestroyed(){return this.#N}constructor(e,t,r){super(),this.#T=e,this.#x=t,this.#m={...r},this.#U=s.default.createSocket("udp4");try{this.#U.bind(this.#m.bind_port||0,this.#m.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#m.bind_ip||"0.0.0.0"}:${this.#m.bind_port||0}`)}void 0!==this.#m.ttl&&this.#U.setTTL(this.#m.ttl),void 0!==this.#m.multicast_ttl&&this.#U.setMulticastTTL(this.#m.multicast_ttl),this.#U.on("error",e=>{this.#D(i.InstanceStatus.UnknownError,e.message),this.emit("error",e)}),this.#U.on("listening",()=>{this.#m.broadcast&&this.#U.setBroadcast(!0),this.#m.multicast_interface&&this.#U.setMulticastInterface(this.#m.multicast_interface),this.#D(i.InstanceStatus.Ok),this.emit("listening")}),this.#U.on("message",(e,t)=>this.emit("data",e,t)),this.#r=setTimeout(()=>{this.#N||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#T}:${this.#x} is missing an error handler!`)},5e3)}async send(e){if(this.#N)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise((t,r)=>{this.#U.send(e,this.#x,this.#T,e=>{e?r(e):t()})})}destroy(){this.#N=!0,void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this.#U.removeAllListeners(),this.#U.close(),this.removeAllListeners()}#D(e,t){this.#F!=e&&(this.#F=e,this.emit("status_change",e,t))}}t.UDPHelper=o},6278:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.substituteEscapeCharacters=t.parseEscapeCharacters=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const s=r(1635);s.__exportStar(r(9077),t),s.__exportStar(r(2018),t),s.__exportStar(r(4581),t);var n=r(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return n.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return n.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return n.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return n.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return n.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return n.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return n.assertNever}}),Object.defineProperty(t,"parseEscapeCharacters",{enumerable:!0,get:function(){return n.parseEscapeCharacters}}),Object.defineProperty(t,"substituteEscapeCharacters",{enumerable:!0,get:function(){return n.substituteEscapeCharacters}}),s.__exportStar(r(6160),t);var i=r(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return i.runEntrypoint}})},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r={grad:.9,turn:360,rad:360/(2*Math.PI)},s=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},n=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},i=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},o=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},a=function(e){return{r:i(e.r,0,255),g:i(e.g,0,255),b:i(e.b,0,255),a:i(e.a)}},u=function(e){return{r:n(e.r),g:n(e.g),b:n(e.b),a:n(e.a,3)}},c=/^#([0-9a-f]{3,8})$/i,l=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,r=e.g,s=e.b,n=e.a,i=Math.max(t,r,s),o=i-Math.min(t,r,s),a=o?i===t?(r-s)/o:i===r?2+(s-t)/o:4+(t-r)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:n}},f=function(e){var t=e.h,r=e.s,s=e.v,n=e.a;t=t/360*6,r/=100,s/=100;var i=Math.floor(t),o=s*(1-r),a=s*(1-(t-i)*r),u=s*(1-(1-t+i)*r),c=i%6;return{r:255*[s,a,o,o,u,s][c],g:255*[u,s,s,a,o,o][c],b:255*[o,o,u,s,s,a][c],a:n}},h=function(e){return{h:o(e.h),s:i(e.s,0,100),l:i(e.l,0,100),a:i(e.a)}},p=function(e){return{h:n(e.h),s:n(e.s),l:n(e.l),a:n(e.a,3)}},y=function(e){return f((r=(t=e).s,{h:t.h,s:(r*=((s=t.l)<50?s:100-s)/100)>0?2*r/(s+r)*100:0,v:s+r,a:t.a}));var t,r,s},g=function(e){return{h:(t=d(e)).h,s:(n=(200-(r=t.s))*(s=t.v)/100)>0&&n<200?r*s/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,r,s,n},b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,I={string:[[function(e){var t=c.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?n(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?n(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=m.exec(e)||v.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=b.exec(e)||_.exec(e);if(!t)return null;var s,n,i=h({h:(s=t[1],n=t[2],void 0===n&&(n="deg"),Number(s)*(r[n]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return y(i)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,n=e.b,i=e.a,o=void 0===i?1:i;return s(t)&&s(r)&&s(n)?a({r:Number(t),g:Number(r),b:Number(n),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,r=e.s,n=e.l,i=e.a,o=void 0===i?1:i;if(!s(t)||!s(r)||!s(n))return null;var a=h({h:Number(t),s:Number(r),l:Number(n),a:Number(o)});return y(a)},"hsl"],[function(e){var t=e.h,r=e.s,n=e.v,a=e.a,u=void 0===a?1:a;if(!s(t)||!s(r)||!s(n))return null;var c=function(e){return{h:o(e.h),s:i(e.s,0,100),v:i(e.v,0,100),a:i(e.a)}}({h:Number(t),s:Number(r),v:Number(n),a:Number(u)});return f(c)},"hsv"]]},w=function(e,t){for(var r=0;r<t.length;r++){var s=t[r][0](e);if(s)return[s,t[r][1]]}return[null,void 0]},E=function(e){return"string"==typeof e?w(e.trim(),I.string):"object"==typeof e&&null!==e?w(e,I.object):[null,void 0]},C=function(e,t){var r=g(e);return{h:r.h,s:i(r.s+100*t,0,100),l:r.l,a:r.a}},R=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},O=function(e,t){var r=g(e);return{h:r.h,s:r.s,l:i(r.l+100*t,0,100),a:r.a}},S=function(){function e(e){this.parsed=E(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return n(R(this.rgba),2)},e.prototype.isDark=function(){return R(this.rgba)<.5},e.prototype.isLight=function(){return R(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=u(this.rgba)).r,r=e.g,s=e.b,o=(i=e.a)<1?l(n(255*i)):"","#"+l(t)+l(r)+l(s)+o;var e,t,r,s,i,o},e.prototype.toRgb=function(){return u(this.rgba)},e.prototype.toRgbString=function(){return t=(e=u(this.rgba)).r,r=e.g,s=e.b,(n=e.a)<1?"rgba("+t+", "+r+", "+s+", "+n+")":"rgb("+t+", "+r+", "+s+")";var e,t,r,s,n},e.prototype.toHsl=function(){return p(g(this.rgba))},e.prototype.toHslString=function(){return t=(e=p(g(this.rgba))).h,r=e.s,s=e.l,(n=e.a)<1?"hsla("+t+", "+r+"%, "+s+"%, "+n+")":"hsl("+t+", "+r+"%, "+s+"%)";var e,t,r,s,n},e.prototype.toHsv=function(){return e=d(this.rgba),{h:n(e.h),s:n(e.s),v:n(e.v),a:n(e.a,3)};var e},e.prototype.invert=function(){return k({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),k(C(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),k(C(this.rgba,-e))},e.prototype.grayscale=function(){return k(C(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),k(O(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),k(O(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?k({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):n(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=g(this.rgba);return"number"==typeof e?k({h:e,s:t.s,l:t.l,a:t.a}):n(t.h)},e.prototype.isEqual=function(e){return this.toHex()===k(e).toHex()},e}(),k=function(e){return e instanceof S?e:new S(e)},P=[];t.Colord=S,t.colord=k,t.extend=function(e){e.forEach(function(e){P.indexOf(e)<0&&(e(S,I),P.push(e))})},t.getFormat=function(e){return E(e)[1]},t.random=function(){return new S({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6342:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(8255));class i extends n.default{constructor(e){super(e)}get fc(){return this._fc}}t.default=i},6368:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function s(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,s,i,o){if("function"!=typeof s)throw new TypeError("The listener must be a function");var a=new n(s,i||e,o),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new s:delete e._events[t]}function a(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,s,n=[];if(0===this._eventsCount)return n;for(s in e=this._events)t.call(e,s)&&n.push(r?s.slice(1):s);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=r?r+e:e,s=this._events[t];if(!s)return[];if(s.fn)return[s.fn];for(var n=0,i=s.length,o=new Array(i);n<i;n++)o[n]=s[n].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,s=this._events[t];return s?s.fn?1:s.length:0},a.prototype.emit=function(e,t,s,n,i,o){var a=r?r+e:e;if(!this._events[a])return!1;var u,c,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,s),!0;case 4:return l.fn.call(l.context,t,s,n),!0;case 5:return l.fn.call(l.context,t,s,n,i),!0;case 6:return l.fn.call(l.context,t,s,n,i,o),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,s);break;case 4:l[c].fn.call(l[c].context,t,s,n);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},a.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,s,n){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||n&&!a.once||s&&a.context!==s||o(this,i);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==t||n&&!a[u].once||s&&a[u].context!==s)&&c.push(a[u]);c.length?this._events[i]=1===c.length?c[0]:c:o(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},6585:e=>{var t=1e3,r=60*t,s=60*r,n=24*s,i=7*n;function o(e,t,r,s){var n=t>=1.5*r;return Math.round(e/r)+" "+s+(n?"s":"")}e.exports=function(e,a){a=a||{};var u,c,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*i;case"days":case"day":case"d":return a*n;case"hours":case"hour":case"hrs":case"hr":case"h":return a*s;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(u=e,(c=Math.abs(u))>=n?o(u,c,n,"day"):c>=s?o(u,c,s,"hour"):c>=r?o(u,c,r,"minute"):c>=t?o(u,c,t,"second"):u+" ms"):function(e){var i=Math.abs(e);return i>=n?Math.round(e/n)+"d":i>=s?Math.round(e/s)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6618:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get address(){return this._address}get quantity(){return this._quantity}get count(){return this.quantity}get values(){return this._values}get valuesAsArray(){return this._valuesAsArray}get valuesAsBuffer(){return this._valuesAsBuffer}get byteCount(){return this._byteCount}get numberOfBytes(){return this._numberOfBytes}get name(){return"WriteMultipleRegisters"}static fromBuffer(e){try{const t=e.readUInt8(0),r=e.readUInt16BE(1),s=e.readUInt8(5),i=e.slice(6,6+s);return t!==n.FC.WRITE_MULTIPLE_HOLDING_REGISTERS?null:new o(r,i)}catch(e){return null}}constructor(e,t){if(super(n.FC.WRITE_MULTIPLE_HOLDING_REGISTERS),e>65535)throw new Error("InvalidStartAddress");if(Array.isArray(t)&&t.length>123)throw new Error("InvalidArraySize");if(t instanceof Buffer&&t.length>246)throw new Error("InvalidBufferSize");if(this._address=e,this._values=t,this._values instanceof Buffer){this._byteCount=Math.min(this._values.length+6,246),this._numberOfBytes=this._values.length,this._quantity=Math.floor(this._values.length/2),this._valuesAsBuffer=this._values,this._valuesAsArray=[];for(let e=0;e<this._values.length;e+=2)this._valuesAsArray.push(this._values.readUInt16BE(e))}else{if(!(this._values instanceof Array))throw new Error("InvalidType_MustBeBufferOrArray");this._valuesAsArray=this._values,this._byteCount=Math.min(2*this._values.length+6,246),this._numberOfBytes=Math.floor(2*this._values.length),this._quantity=this._values.length,this._valuesAsBuffer=Buffer.alloc(this._numberOfBytes),this._values.forEach((e,t)=>{this._valuesAsBuffer.writeUInt16BE(e,2*t)})}}createPayload(){const e=Buffer.alloc(6+this._numberOfBytes);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._address,1),e.writeUInt16BE(this._quantity,3),e.writeUInt8(this._numberOfBytes,5),this._valuesAsBuffer.copy(e,6),e}}t.default=o,t.isWriteMultipleRegistersRequestBody=function(e){return e instanceof o}},6641:(e,t,r)=>{"use strict";const s=r(4617);class n extends Error{constructor(e){super(e),this.name="TimeoutError"}}const i=(e,t,r)=>new Promise((i,o)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void i(e);const a=setTimeout(()=>{if("function"==typeof r){try{i(r())}catch(e){o(e)}return}const s=r instanceof Error?r:new n("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),o(s)},t);s(e.then(i,o),()=>{clearTimeout(a)})});e.exports=i,e.exports.default=i,e.exports.TimeoutError=n},6649:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s},o=[0,8801531,9098509,825846,9692897,1419802,1651692,10452759,10584377,2608578,2839604,11344079,3303384,11807523,12104405,4128302,12930697,4391538,5217156,13227903,5679208,13690003,14450021,5910942,6606768,14844747,15604413,6837830,16197969,7431594,8256604,16494759,840169,9084178,8783076,18463,10434312,1670131,1434117,9678590,11358416,2825259,2590173,10602790,4109873,12122826,11821884,3289031,13213536,5231515,4409965,12912278,5929345,14431610,13675660,5693559,6823513,15618722,14863188,6588335,16513208,8238147,7417269,16212302,1680338,10481449,9664223,1391140,9061683,788936,36926,8838341,12067563,4091408,3340262,11844381,2868234,11372785,10555655,2579964,14478683,5939616,5650518,13661357,5180346,13190977,12967607,4428364,8219746,16457881,16234863,7468436,15633027,6866552,6578062,14816117,1405499,9649856,10463030,1698765,8819930,55329,803287,9047340,11858690,3325945,4072975,12086004,2561507,10574104,11387118,2853909,13647026,5664841,5958079,14460228,4446803,12949160,13176670,5194661,7454091,16249200,16476294,8201341,14834538,6559633,6852199,15647388,3360676,11864927,12161705,4185682,10527045,2551230,2782280,11286707,9619101,1346150,1577872,10379115,73852,8875143,9172337,899466,16124205,7357910,8182816,16421083,6680524,14918455,15678145,6911546,5736468,13747439,14507289,5968354,12873461,4334094,5159928,13170435,4167245,12180150,11879232,3346363,11301036,2767959,2532769,10545498,10360692,1596303,1360505,9604738,913813,9157998,8856728,92259,16439492,8164415,7343561,16138546,6897189,15692510,14936872,6662099,5986813,14488838,13733104,5750795,13156124,5174247,4352529,12855018,2810998,11315341,10498427,2522496,12124823,4148844,3397530,11901793,9135439,862644,110658,8912057,1606574,10407765,9590435,1317464,15706879,6940164,6651890,14889737,8145950,16384229,16161043,7394792,5123014,13133629,12910283,4370992,14535975,5997020,5707818,13718737,2504095,10516836,11329682,2796649,11916158,3383173,4130419,12143240,8893606,129117,876971,9121104,1331783,9576124,10389322,1625009,14908182,6633453,6925851,15721184,7380471,16175372,16402682,8127489,4389423,12891860,13119266,5137369,13704398,5722165,6015427,14517560];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),e.exports=(0,i.default)("crc-24",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=void 0!==t?~~t:11994318,s=0;s<e.length;s++){var i=e[s];r=16777215&(o[255&(r>>16^i)]^r<<8)}return r})},6818:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserRequestMetrics=class{constructor(){this.createdAt=new Date,this.startedAt=new Date,this.receivedAt=new Date}get transferTime(){return this.receivedAt.getTime()-this.startedAt.getTime()}get waitTime(){return this.startedAt.getTime()-this.createdAt.getTime()}toJSON(){return Object.assign({},this,{transferTime:this.transferTime})}}},6869:(e,t)=>{"use strict";function r(e){switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 10:case 11:return!0;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorMessages={1:"ILLEGAL FUNCTION",2:"ILLEGAL DATA ADDRESS",3:"ILLEGAL DATA VALUE",4:"SLAVE DEVICE FAILURE",5:"ACKNOWLEDGE",6:"SLAVE DEVICE BUSY",8:"MEMORY PARITY ERROR",10:"GATEWAY PATH UNAVAILABLE",11:"GATEWAY TARGET DEVICE FAILED TO RESPOND"},t.errorCodeToMessage=function(e){if(r(e))return t.ErrorMessages[e];throw new Error("")},t.isErrorCode=r},6928:e=>{"use strict";e.exports=require("path")},7e3:(e,t,r)=>{"use strict";const s=r(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:r=0,maxWait:n=0,before:i=!1,after:o=!0}=t;if(!i&&!o)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let a,u,c;const l=function(...t){const s=this,l=i&&!a;return clearTimeout(a),a=setTimeout(()=>{a=void 0,u&&(clearTimeout(u),u=void 0),o&&(c=e.apply(s,t))},r),n>0&&!u&&o&&(u=setTimeout(()=>{u=void 0,a&&(clearTimeout(a),a=void 0),c=e.apply(s,t)},n)),l&&(c=e.apply(s,t)),c};return s(l,e),l.cancel=()=>{a&&(clearTimeout(a),a=void 0),u&&(clearTimeout(u),u=void 0)},l}},7059:(e,t,r)=>{"use strict";const s=r(1462)("buffer-utils");e.exports=class{static bufferShift(e,t,r){const n=(e-=1)%8,i=Math.floor(e/8),o=Math.floor(t/8)-i+1,a=Buffer.allocUnsafe(o);a[0]=r[0]<<n,s("buffer[0] = %s ( %s << %d )",a[0].toString(2),r[0].toString(2),n);const u=Buffer.concat([r,Buffer.alloc(1)],r.length+1);for(let t=1;t<o;t++)a[t]=(u[t]<<n)+(u[t-1]>>8-n),s("buffer[%d] = %s ( %s << %d + %s >> %d)",t,a[t].toString(2),u[t].toString(2),n,u[t-1].toString(2),8-e);return a}static firstByte(e,t,r){return r+(t&255>>8-(e-=1)%8)}static lastByte(e,t,r){return r+(t&255<<e%8)}static bufferToArrayStatus(e){const t=[];let r,s,n;if(!(e instanceof Buffer))return t;for(let i=0;i<8*e.length;i+=1){r=i%8,s=Math.floor(i/8),n=e.readUInt8(s);const o=(n&Math.pow(2,r))>0;t.push(o?1:0)}return t}static arrayStatusToBuffer(e){const t=e instanceof Array?Math.ceil(e.length/8):0,r=Buffer.alloc(t);if(!(e instanceof Array))return r;let s,n,i;for(let t=0;t<e.length;t+=1)s=Math.floor(t/8),n=t%8,i=r.readUInt8(s),i+=e[t]?Math.pow(2,n):0,r.writeUInt8(i,s);return r}}},7141:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("response-factory"),i=r(2004),o=s(r(2180)),a=s(r(5644)),u=s(r(2827)),c=s(r(8500)),l=s(r(4187)),d=s(r(2094)),f=s(r(5608)),h=s(r(1043)),p=s(r(1413));t.default=class{static fromBuffer(e){try{const t=e.readUInt8(0);return n("fc",t,"payload",e),t>128?o.default.fromBuffer(e):t===i.FC.READ_COIL?a.default.fromBuffer(e):t===i.FC.READ_DISCRETE_INPUT?u.default.fromBuffer(e):t===i.FC.READ_HOLDING_REGISTERS?c.default.fromBuffer(e):t===i.FC.READ_INPUT_REGISTERS?l.default.fromBuffer(e):t===i.FC.WRITE_SINGLE_COIL?h.default.fromBuffer(e):t===i.FC.WRITE_SINGLE_HOLDING_REGISTER?p.default.fromBuffer(e):t===i.FC.WRITE_MULTIPLE_COILS?d.default.fromBuffer(e):t===i.FC.WRITE_MULTIPLE_HOLDING_REGISTERS?f.default.fromBuffer(e):null}catch(e){return n("when NoSuchIndex Exception, the buffer does not contain a complete message"),n(e),null}}}},7161:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get address(){return this._address}get value(){return this._value?65280:0}get byteCount(){return 5}get count(){return 1}get name(){return"WriteSingleCoil"}static fromBuffer(e){try{const t=e.readUInt8(0),r=e.readUInt16BE(1),s=65280===e.readUInt16BE(3);return t!==n.FC.WRITE_SINGLE_COIL?null:new o(r,s)}catch(e){return null}}constructor(e,t){if(super(n.FC.WRITE_SINGLE_COIL),e>65535)throw new Error("InvalidStartAddress");this._address=e,this._value=t}createPayload(){const e=Buffer.alloc(5);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._address,1),e.writeUInt16BE(this._value?65280:0,3),e}}t.default=o,t.isWriteSingleCoilRequestBody=function(e){return e instanceof o}},7194:e=>{"use strict";e.exports=require("dgram")},7281:(e,t,r)=>{"use strict";e.exports=a,e.exports.default=a;const s={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},isPrerelease:{type:"boolean",description:"Is this a pre-release version"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"},url:{type:"string"}},required:["name"],additionalProperties:!1}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18 or node22",enum:["node18","node22"]},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"},permissions:{type:"object",description:"Permissions required by the module. This is used to inform the user of the permissions required by the module.\nNote: this requires the node22 or newer runtime",properties:{"worker-threads":{type:"boolean",description:"Enable if the module uses worker threads"},"child-process":{type:"boolean",description:"Enable if the module uses child processes"},"native-addons":{type:"boolean",description:"Enable if the module uses native addons"},filesystem:{type:"boolean",description:"Enable if the module requires read/write access to the filesystem"}},additionalProperties:!1}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}}}},required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]}}},n={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},port:{type:"number"},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}}}},required:["type","protocol"]},i=r(6250).A,o=new RegExp("","u");function a(e,{instancePath:t="",parentData:r,parentDataProperty:u,rootData:c=e}={}){let l=null,d=0;if(0===d){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.id&&(r="id")||void 0===e.name&&(r="name")||void 0===e.shortname&&(r="shortname")||void 0===e.description&&(r="description")||void 0===e.version&&(r="version")||void 0===e.license&&(r="license")||void 0===e.repository&&(r="repository")||void 0===e.bugs&&(r="bugs")||void 0===e.maintainers&&(r="maintainers")||void 0===e.legacyIds&&(r="legacyIds")||void 0===e.runtime&&(r="runtime")||void 0===e.manufacturer&&(r="manufacturer")||void 0===e.products&&(r="products")||void 0===e.keywords&&(r="keywords"))return a.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;if(void 0!==e.$schema){const r=d;if("string"!=typeof e.$schema)return a.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=r===d}else f=!0;if(f){if(void 0!==e.id){const r=d;if("string"!=typeof e.id)return a.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.name){const r=d;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.shortname){const r=d;if("string"!=typeof e.shortname)return a.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.description){const r=d;if("string"!=typeof e.description)return a.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.version){const r=d;if("string"!=typeof e.version)return a.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.isPrerelease){const r=d;if("boolean"!=typeof e.isPrerelease)return a.errors=[{instancePath:t+"/isPrerelease",schemaPath:"#/properties/isPrerelease/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.license){const r=d;if("string"!=typeof e.license)return a.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.repository){const r=d;if("string"!=typeof e.repository)return a.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.bugs){const r=d;if("string"!=typeof e.bugs)return a.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.maintainers){let r=e.maintainers;const s=d;if(d===s){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var h=!0;const e=r.length;for(let s=0;s<e;s++){let e=r[s];const n=d;if(d===n){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/maintainers/"+s,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===e.name&&(r="name"))return a.errors=[{instancePath:t+"/maintainers/"+s,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;{const r=d;for(const r in e)if("name"!==r&&"email"!==r&&"github"!==r&&"url"!==r)return a.errors=[{instancePath:t+"/maintainers/"+s,schemaPath:"#/properties/maintainers/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===d){if(void 0!==e.name){const r=d;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/maintainers/"+s+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var p=r===d}else p=!0;if(p){if(void 0!==e.email){const r=d;if("string"!=typeof e.email)return a.errors=[{instancePath:t+"/maintainers/"+s+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p){if(void 0!==e.github){const r=d;if("string"!=typeof e.github)return a.errors=[{instancePath:t+"/maintainers/"+s+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0;if(p)if(void 0!==e.url){const r=d;if("string"!=typeof e.url)return a.errors=[{instancePath:t+"/maintainers/"+s+"/url",schemaPath:"#/properties/maintainers/items/properties/url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=r===d}else p=!0}}}}}}if(!(h=n===d))break}if(h){let e,s=r.length;if(s>1)for(;s--;)for(e=s;e--;)if(i(r[s],r[e]))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"}],!1}}}f=s===d}else f=!0;if(f){if(void 0!==e.legacyIds){let r=e.legacyIds;const s=d;if(d===s){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var y=!0;const e=r.length;for(let s=0;s<e;s++){const e=d;if("string"!=typeof r[s])return a.errors=[{instancePath:t+"/legacyIds/"+s,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(y=e===d))break}if(y){let e,s=r.length;if(s>1){const n={};for(;s--;){let i=r[s];if("string"==typeof i){if("number"==typeof n[i])return e=n[i],a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"}],!1;n[i]=s}}}}}}f=s===d}else f=!0;if(f){if(void 0!==e.runtime){let r=e.runtime;const n=d;if(d===n){if(!r||"object"!=typeof r||Array.isArray(r))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===r.type&&(e="type")||void 0===r.api&&(e="api")||void 0===r.apiVersion&&(e="apiVersion")||void 0===r.entrypoint&&(e="entrypoint"))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==r.type){let e=r.type;const n=d;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("node18"!==e&&"node22"!==e)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/enum",keyword:"enum",params:{allowedValues:s.properties.runtime.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var g=n===d}else g=!0;if(g){if(void 0!==r.api){let e=r.api;const n=d;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:s.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;g=n===d}else g=!0;if(g){if(void 0!==r.apiVersion){const e=d;if("string"!=typeof r.apiVersion)return a.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===d}else g=!0;if(g){if(void 0!==r.entrypoint){const e=d;if("string"!=typeof r.entrypoint)return a.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=e===d}else g=!0;if(g)if(void 0!==r.permissions){let e=r.permissions;const s=d;if(d===s){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const r=d;for(const r in e)if("worker-threads"!==r&&"child-process"!==r&&"native-addons"!==r&&"filesystem"!==r)return a.errors=[{instancePath:t+"/runtime/permissions",schemaPath:"#/properties/runtime/properties/permissions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"}],!1;if(r===d){if(void 0!==e["worker-threads"]){const r=d;if("boolean"!=typeof e["worker-threads"])return a.errors=[{instancePath:t+"/runtime/permissions/worker-threads",schemaPath:"#/properties/runtime/properties/permissions/properties/worker-threads/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var b=r===d}else b=!0;if(b){if(void 0!==e["child-process"]){const r=d;if("boolean"!=typeof e["child-process"])return a.errors=[{instancePath:t+"/runtime/permissions/child-process",schemaPath:"#/properties/runtime/properties/permissions/properties/child-process/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;b=r===d}else b=!0;if(b){if(void 0!==e["native-addons"]){const r=d;if("boolean"!=typeof e["native-addons"])return a.errors=[{instancePath:t+"/runtime/permissions/native-addons",schemaPath:"#/properties/runtime/properties/permissions/properties/native-addons/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;b=r===d}else b=!0;if(b)if(void 0!==e.filesystem){const r=d;if("boolean"!=typeof e.filesystem)return a.errors=[{instancePath:t+"/runtime/permissions/filesystem",schemaPath:"#/properties/runtime/properties/permissions/properties/filesystem/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;b=r===d}else b=!0}}}}}g=s===d}else g=!0}}}}}f=n===d}else f=!0;if(f){if(void 0!==e.manufacturer){const r=d;if("string"!=typeof e.manufacturer)return a.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===d}else f=!0;if(f){if(void 0!==e.products){let r=e.products;const s=d;if(d===s){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(r.length<1)return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var _=!0;const e=r.length;for(let s=0;s<e;s++){const e=d;if("string"!=typeof r[s])return a.errors=[{instancePath:t+"/products/"+s,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(_=e===d))break}if(_){let e,s=r.length;if(s>1){const n={};for(;s--;){let i=r[s];if("string"==typeof i){if("number"==typeof n[i])return e=n[i],a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"}],!1;n[i]=s}}}}}}f=s===d}else f=!0;if(f){if(void 0!==e.keywords){let r=e.keywords;const s=d;if(d===s){if(!Array.isArray(r))return a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var m=!0;const e=r.length;for(let s=0;s<e;s++){const e=d;if("string"!=typeof r[s])return a.errors=[{instancePath:t+"/keywords/"+s,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(m=e===d))break}if(m){let e,s=r.length;if(s>1){const n={};for(;s--;){let i=r[s];if("string"==typeof i){if("number"==typeof n[i])return e=n[i],a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"}],!1;n[i]=s}}}}}}f=s===d}else f=!0;if(f)if(void 0!==e.bonjourQueries){let r=e.bonjourQueries;const s=d;if(d===s){if(!r||"object"!=typeof r||Array.isArray(r))return a.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(const e in r)if(o.test(e)){let s=r[e];const i=d,u=d;let c=!1,f=null;const h=d;if(d==d)if(s&&"object"==typeof s&&!Array.isArray(s)){let r;if(void 0===s.type&&(r="type")||void 0===s.protocol&&(r="protocol")){const s={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===l?l=[s]:l.push(s),d++}else{if(void 0!==s.type){const r=d;if("string"!=typeof s.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}var v=r===d}else v=!0;if(v){if(void 0!==s.protocol){let r=s.protocol;const i=d;if("string"!=typeof r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}if("tcp"!==r&&"udp"!==r){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:n.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===l?l=[r]:l.push(r),d++}v=i===d}else v=!0;if(v){if(void 0!==s.port){let r=s.port;const n=d;if("number"!=typeof r||!isFinite(r)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===l?l=[r]:l.push(r),d++}v=n===d}else v=!0;if(v)if(void 0!==s.txt){let r=s.txt;const n=d;if(d===n)if(r&&"object"==typeof r&&!Array.isArray(r)){for(const s in r)if(o.test(s)){const n=d;if("string"!=typeof r[s]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+s.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}if(n!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),d++}v=n===d}else v=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),d++}h===d&&(c=!0,f=0);const p=d;if(d===p)if(Array.isArray(s)){const r=s.length;for(let i=0;i<r;i++){let r=s[i];const a=d;if(d==d)if(r&&"object"==typeof r&&!Array.isArray(r)){let s;if(void 0===r.type&&(s="type")||void 0===r.protocol&&(s="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:s},message:"must have required property '"+s+"'"};null===l?l=[r]:l.push(r),d++}else{if(void 0!==r.type){const s=d;if("string"!=typeof r.type){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}var I=s===d}else I=!0;if(I){if(void 0!==r.protocol){let s=r.protocol;const o=d;if("string"!=typeof s){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[r]:l.push(r),d++}if("tcp"!==s&&"udp"!==s){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:n.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===l?l=[r]:l.push(r),d++}I=o===d}else I=!0;if(I){if(void 0!==r.port){let s=r.port;const n=d;if("number"!=typeof s||!isFinite(s)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/port",schemaPath:"#/definitions/bonjourQuery/properties/port/type",keyword:"type",params:{type:"number"},message:"must be number"};null===l?l=[r]:l.push(r),d++}I=n===d}else I=!0;if(I)if(void 0!==r.txt){let s=r.txt;const n=d;if(d===n)if(s&&"object"==typeof s&&!Array.isArray(s)){for(const r in s)if(o.test(r)){const n=d;if("string"!=typeof s[r]){const s={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[s]:l.push(s),d++}if(n!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),d++}I=n===d}else I=!0}}}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[r]:l.push(r),d++}if(a!==d)break}}else{const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===l?l=[r]:l.push(r),d++}var w;if((w=p===d)&&c?(c=!1,f=[f,1]):w&&(c=!0,f=1),!c){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:f},message:"must match exactly one schema in oneOf"};return null===l?l=[r]:l.push(r),d++,a.errors=l,!1}if(d=u,null!==l&&(u?l.length=u:l=null),i!==d)break}}f=s===d}else f=!0}}}}}}}}}}}}}}}}}return a.errors=l,0===d}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7687:(e,t,r)=>{"use strict";const s=r(857),n=r(9637),i=r(5884),{env:o}=process;let a;function u(e,t={}){return 0!==(r=function(e,{streamIsTTY:t,sniffFlags:r=!0}={}){const n=function(){if("FORCE_COLOR"in o)return"true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(Number.parseInt(o.FORCE_COLOR,10),3)}();void 0!==n&&(a=n);const u=r?a:n;if(0===u)return 0;if(r){if(i("color=16m")||i("color=full")||i("color=truecolor"))return 3;if(i("color=256"))return 2}if(e&&!t&&void 0===u)return 0;const c=u||0;if("dumb"===o.TERM)return c;if("win32"===process.platform){const e=s.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(e=>e in o)||"codeship"===o.CI_NAME?1:c;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=Number.parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:c}(e,{streamIsTTY:e&&e.isTTY,...t}))&&{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3};var r}i("no-color")||i("no-colors")||i("color=false")||i("color=never")?a=0:(i("color")||i("colors")||i("color=true")||i("color=always"))&&(a=1),e.exports={supportsColor:u,stdout:u({isTTY:n.isatty(1)}),stderr:u({isTTY:n.isatty(2)})}},7871:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s},o=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),e.exports=(0,i.default)("crc-8",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=~~t,s=0;s<e.length;s++){var i=e[s];r=255&o[255&(r^i)]}return r})},7936:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get address(){return this._address}get values(){return this._values}get valuesAsArray(){return this._valuesAsArray}get valuesAsBuffer(){return this._valuesAsBuffer}get quantity(){return this._quantity}get count(){return this.quantity}get byteCount(){return this._byteCount}get numberOfBytes(){return this._numberOfBytes}get name(){return"WriteMultipleCoils"}static fromBuffer(e){try{if(e.readUInt8(0)!==n.FC.WRITE_MULTIPLE_COILS)return null;const t=e.readUInt16BE(1),r=e.readUInt16BE(3),s=e.readUInt8(5),i=e.slice(6,6+s);return new o(t,i,r)}catch(e){return null}}constructor(e,t,r){if(super(n.FC.WRITE_MULTIPLE_COILS),e>65535)throw new Error("InvalidStartAddress");if(Array.isArray(t)&&t.length>15744)throw new Error("InvalidArraySize");if(t instanceof Buffer){if(t.length>1968)throw new Error("InvalidBufferSize");if(void 0!==r&&8*t.length<r)throw new Error("InvalidBufferSize")}if(this._address=e,this._values=t,this._quantity=r||t.length,this._numberOfBytes=Math.ceil(this._quantity/8),this._values instanceof Buffer){this._valuesAsBuffer=this._values,this._byteCount=Math.ceil(this._quantity/8)+6,this._valuesAsArray=[];for(let e=0;e<this._quantity;e+=1){const t=e%8,r=Math.floor(e/8),s=this._values.readUInt8(r);this._valuesAsArray.push((s&Math.pow(2,t))>0)}}else{if(!(this._values instanceof Array))throw new Error("InvalidType_MustBeBufferOrArray");{this._byteCount=Math.ceil(this._values.length/8)+6,this._valuesAsArray=this._values;const e=Math.min(1968,this._values.length);let t=0,r=0,s=0;const n=Buffer.allocUnsafe(this._numberOfBytes);for(let i=0;i<e;i+=1)t+=this._values[i]?Math.pow(2,s):0,s=(s+1)%8,0!==s&&i!==e-1||(n.writeUInt8(t,r),r+=1,t=0);this._valuesAsBuffer=n}}}createPayload(){const e=Buffer.alloc(this._byteCount);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._address,1),e.writeUInt16BE(this._quantity,3),e.writeUInt8(this._numberOfBytes,5),this._valuesAsBuffer.copy(e,6,0,this._byteCount),e}}t.default=o,t.isWriteMultipleCoilsRequestBody=function(e){return e instanceof o}},8039:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const s=r(1635),n=r(2593),i=s.__importDefault(r(7e3));function o(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#P;#V;#L;#q;#W=new Map;#H=new Map;#$=new Map;#G=new Map;#J;get parseVariablesContext(){return this.#J}constructor(e,t,r,s){this.#P=e,this.#V=t,this.#L=r,this.#q=s}getDefinitionIds(){return Array.from(this.#W.keys())}getInstanceIds(){return Array.from(this.#H.keys())}handleUpdateFeedbacks(e){for(const[t,r]of Object.entries(e)){const e=this.#H.get(t);if(e){const t=this.#W.get(e.feedbackId);if(t?.unsubscribe){const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(o(t.type,e),r)).catch(t=>{this.#q("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}if(!r||r.disabled)this.#H.delete(t);else{this.#H.set(t,{...r,referencedVariables:null});const e=this.#W.get(r.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#P({text:e,controlId:r.controlId,actionInstanceId:void 0,feedbackInstanceId:r.id})).text};Promise.resolve(e.subscribe(o(e.type,r),t)).catch(e=>{this.#q("error",`Feedback subscribe failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)})}this.#z(t)}}}async handleLearnFeedback(e){const t=this.#W.get(e.feedback.feedbackId);if(t&&t.learn){const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},r)}}return{options:void 0}}handleVariablesChanged(e){if(!e.variablesIds.length)return;const t=new Set(e.variablesIds);for(const t of this.#G.values())for(const r of e.variablesIds)t.changedVariables.add(r);const r=new Set;for(const e of this.#H.values())if(!this.#G.has(e.id)&&e.referencedVariables)for(const s of e.referencedVariables)if(t.has(s)){r.add(e.id);break}for(const e of r)setImmediate(()=>{this.#z(e)})}#z(e){const t=this.#G.get(e);if(t)return void(t.needsRecheck=!0);const r=this.#H.get(e);if(!r)return;const s=r,n={needsRecheck:!1,changedVariables:new Set};this.#G.set(e,n),Promise.resolve().then(async()=>{const t=this.#W.get(s.feedbackId);let r;const n=new Set;if(t){this.#J=`Feedback ${s.feedbackId} (${e})`;const i={parseVariablesInString:async t=>{const r=await this.#P({text:t,controlId:s.controlId,actionInstanceId:void 0,feedbackInstanceId:e});if(r.variableIds&&r.variableIds.length)for(const e of r.variableIds)n.add(e);return r.text}};r="boolean"===t.type?t.callback({...o("boolean",s),type:"boolean"},i):t.callback({...o("advanced",s),type:"advanced",image:s.image},i),this.#J=void 0}const i=await r;this.#$.set(e,{id:e,controlId:s.controlId,value:i}),this.#Q(),s.referencedVariables=n.size>0?Array.from(n):null}).catch(e=>{console.error(`Feedback check failed: ${JSON.stringify(s)} - ${e?.message??e} ${e?.stack}`)}).finally(()=>{this.#J=void 0,this.#G.delete(e);let t=!1;if(s.referencedVariables)for(const e of s.referencedVariables)if(n.changedVariables.has(e)){t=!0;break}(t||n.needsRecheck)&&setImmediate(()=>{this.#z(e)})})}#Q=(0,i.default)(()=>{const e=this.#$;this.#$=new Map,e.size>0&&this.#V({values:Array.from(e.values())})},{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#W.clear();for(const[r,s]of Object.entries(e))s&&(t.push({id:r,name:s.name,description:s.description,options:(0,n.serializeIsVisibleFn)(s.options),type:s.type,defaultStyle:"boolean"===s.type?s.defaultStyle:void 0,hasLearn:!!s.learn,learnTimeout:s.learnTimeout,showInvert:"boolean"===s.type&&s.showInvert}),this.#W.set(r,s));this.#L({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,r]of this.#H.entries())this.#W.get(r.feedbackId)&&(0===t.size||t.has(r.feedbackId))&&this.#z(e)}checkFeedbacksById(e){for(const t of e)this.#z(t)}subscribeFeedbacks(e){let t=Array.from(this.#H.values());const r=new Set(e);r.size&&(t=t.filter(e=>r.has(e.feedbackId)));for(const e of t){const t=this.#W.get(e.feedbackId);if(t?.subscribe){const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.subscribe(o(t.type,e),r)).catch(t=>{this.#q("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}unsubscribeFeedbacks(e){let t=Array.from(this.#H.values());const r=new Set(e);r.size&&(t=t.filter(e=>r.has(e.feedbackId)));for(const e of t){const t=this.#W.get(e.feedbackId);if(t&&t.unsubscribe){const r={parseVariablesInString:async t=>(await this.#P({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(o(t.type,e),r)).catch(t=>{this.#q("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)})}}}}},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8163:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get address(){return this._address}get value(){return this._value}get name(){return"WriteSingleRegister"}get quantity(){return 1}get count(){return 1}get byteCount(){return 5}static fromBuffer(e){try{const t=e.readUInt8(0),r=e.readUInt16BE(1),s=e.readUInt16BE(3);return t!==n.FC.WRITE_SINGLE_HOLDING_REGISTER?null:new o(r,s)}catch(e){return null}}constructor(e,t){if(super(n.FC.WRITE_SINGLE_HOLDING_REGISTER),e>65535)throw new Error("InvalidStartAddress");if(!Number.isInteger(t)||t<0||t>65535)throw new Error("InvalidValue");this._address=e,this._value=t}createPayload(){const e=Buffer.alloc(5);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._address,1),e.writeUInt16BE(this._value,3),e}}t.default=o,t.isWriteSingleRegisterRequestBody=function(e){return e instanceof o}},8255:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(2004);t.default=class{get fc(){return this._fc}get isException(){return!1}static fromRequest(e,t){throw new TypeError("Cannot call from request from abstract class")}constructor(e,t=!1){if(!1===t&&!s.isFunctionCode(e))throw Error("InvalidFunctionCode");this._fc=e}}},8313:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2004),i=s(r(8575));class o extends i.default{get start(){return this._start}get count(){return this._count}get name(){return"ReadDiscreteInput"}get byteCount(){return 5}static fromBuffer(e){try{if(e.readUInt8(0)!==n.FC.READ_DISCRETE_INPUT)return null;const t=e.readUInt16BE(1),r=e.readUInt16BE(3);return new o(t,r)}catch(e){return null}}constructor(e,t){if(super(n.FC.READ_DISCRETE_INPUT),e>65535)throw new Error("InvalidStartAddress");if(t>2e3)throw new Error("InvalidQuantity");this._start=e,this._count=t}createPayload(){const e=Buffer.alloc(5);return e.writeUInt8(this._fc,0),e.writeUInt16BE(this._start,1),e.writeUInt16BE(this._count,3),e}}t.default=o,t.isReadDiscreteInputsRequestBody=function(e){return e instanceof o}},8421:(e,t,r)=>{"use strict";function s(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),s(r(6079)),s(r(3835));var n=r(2180);t.isExceptionResponseBody=n.isExceptionResponseBody;var i=r(3682);t.isExceptionRequestBody=i.isExceptionRequestBody},8500:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("ReadHoldingRegistersResponseBody"),i=r(2004),o=s(r(6342));class a extends o.default{get byteCount(){return this._bufferLength}get values(){return this._values}get valuesAsArray(){return this._valuesAsArray}get valuesAsBuffer(){return this._valuesAsBuffer}get length(){return this._values.length}static fromRequest(e,t){const r=2*e.start,s=2*e.start+2*e.count,n=t.slice(r,s);return new a(n.length,n)}static fromBuffer(e){const t=e.readUInt8(0),r=e.readUInt8(1),s=e.slice(2,2+r);if(t!==i.FC.READ_HOLDING_REGISTERS)return null;const n=[];for(let e=0;e<r;e+=2)n.push(s.readUInt16BE(e));return new a(r,n,s)}constructor(e,t,r){if(super(i.FC.READ_HOLDING_REGISTERS),this._byteCount=e,this._values=t,this._bufferLength=2,n("ReadHoldingRegistersResponseBody values",t),t instanceof Array)this._valuesAsArray=t,this._valuesAsBuffer=Buffer.from(t),this._bufferLength+=2*t.length;else{if(!(t instanceof Buffer))throw new Error("InvalidType_MustBeBufferOrArray");this._valuesAsArray=Uint16Array.from(t),this._valuesAsBuffer=t,this._bufferLength+=t.length}r instanceof Buffer&&(this._valuesAsBuffer=r)}createPayload(){if(this._values instanceof Buffer){let e=Buffer.alloc(2);return e.writeUInt8(this._fc,0),e.writeUInt8(this._byteCount,1),e=Buffer.concat([e,this._values]),e}if(this._values instanceof Array){const e=Buffer.alloc(this._byteCount+2);return e.writeUInt8(this._fc,0),e.writeUInt8(this._byteCount,1),this._values.forEach((t,r)=>{e.writeUInt16BE(Math.max(0,Math.min(65535,t)),2*r+2)}),e}throw new Error("InvalidType_MustBeBufferOrArray")}}t.default=a},8575:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),s(r(1462)).default("request-body");class n{constructor(e){if(new.target===n)throw new TypeError("Cannot construct ModbusRequestBody directly.");this._fc=e}get fc(){return this._fc}get isException(){return!1}get isModbusRequestBody(){return!0}}t.default=n,t.isModbusRequestBody=function(e){return!!e.isModbusRequestBody}},8637:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this._buffer=Buffer.alloc(0)}shift(){return this._messages.shift()}}},8656:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("tcp-response"),i=s(r(3571)),o=s(r(7141));class a extends i.default{constructor(e,t,r,s,n){super(),this._id=e,this._protocol=t,this._bodyLength=r,this._unitId=s,this._body=n}get id(){return this._id}get protocol(){return this._protocol}get bodyLength(){return this._bodyLength}get byteCount(){return this._bodyLength+6}get unitId(){return this._unitId}get slaveId(){return this._unitId}get address(){return this._unitId}get body(){return this._body}static fromRequest(e,t){return new a(e.id,e.protocol,t.byteCount+1,e.unitId,t)}static fromBuffer(e){try{const t=e.readUInt16BE(0),r=e.readUInt16BE(2),s=e.readUInt16BE(4),i=e.readUInt8(6);n("tcp header complete, id",t,"protocol",r,"length",s,"unitId",i),n("buffer",e);const u=o.default.fromBuffer(e.slice(7,7+s-1));return u?(n("buffer contains a valid response body"),new a(t,r,s,i,u)):(n("not enough data for a response body"),null)}catch(e){return n("not enough data available"),null}}createPayload(){const e=Buffer.alloc(this.byteCount);return e.writeUInt16BE(this._id,0),e.writeUInt16BE(this._protocol,2),e.writeUInt16BE(this._bodyLength,4),e.writeUInt8(this._unitId,6),this._body.createPayload().copy(e,7),e}}t.default=a},8809:(e,t,r)=>{"use strict";e.exports={crc1:r(9328),crc8:r(7871),crc81wire:r(3578),crc16:r(2052),crc16ccitt:r(1318),crc16modbus:r(6045),crc16xmodem:r(2677),crc16kermit:r(3839),crc24:r(6649),crc32:r(8970)}},8859:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("modbus tcp client socket"),i=s(r(1142)),o=s(r(4082));t.default=class{constructor(e,t,r,s){this._server=e,this._socket=t,this._requestHandler=new i.default(r),this._responseHandler=new o.default(this._server,s),this._socket.on("data",this._onData.bind(this))}get socket(){return this._socket}get server(){return this._server}_onData(e){for(n("new data coming in"),this._requestHandler.handle(e);;){const e=this._requestHandler.shift();if(!e){n("no request to process");break}this._responseHandler.handle(e,e=>{this._socket.write(e,()=>{n("response flushed",e)})})}}}},8883:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("tcp-response-handler"),i=s(r(8637)),o=s(r(8656));class a extends i.default{constructor(){super(),this._buffer=Buffer.alloc(0),this._messages=[]}handleData(e){for(n("receiving new data",e),this._buffer=Buffer.concat([this._buffer,e]),n("buffer",this._buffer);;){const e=o.default.fromBuffer(this._buffer);if(!e)return void n("not enough data available to parse");n("response id",e.id,"protocol",e.protocol,"length",e.bodyLength,"unit",e.unitId),n("reset buffer from",this._buffer.length,"to",this._buffer.length-e.byteCount),this._messages.push(e),this._buffer=this._buffer.slice(e.byteCount)}}}t.default=a},8885:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("modbus tcp server"),i=s(r(5971)),o=s(r(8859)),a=s(r(9326)),u=s(r(8656));class c extends i.default{constructor(e,t){super(t),this._server=e,e.on("connection",this._onConnection.bind(this))}_onConnection(e){n("new connection coming in");const t=a.default.fromBuffer,r=u.default.fromRequest,s=new o.default(this,e,t,r);this.emit("connection",s)}}t.default=c},8895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const s=r(1635).__importDefault(r(9278)),n=r(228),i=r(1400);class o extends n.EventEmitter{#T;#x;_socket;#m;#Y=!1;#Z=!1;#N=!1;#F;#K;#r;get isConnected(){return this.#Y}get isConnecting(){return this.#Z}get isDestroyed(){return this.#N}constructor(e,t,r){super(),this.#T=e,this.#x=t,this.#m={reconnect_interval:2e3,reconnect:!0,...r},this._socket=new s.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",e=>{this.#Z=!1,this.#Y=!1,this.#m.reconnect&&this.#X(),this.#D(i.InstanceStatus.UnknownError,e.message),this.emit("error",e)}),this._socket.on("ready",()=>{this.#Y=!0,this.#Z=!1,this.#D(i.InstanceStatus.Ok),this.emit("connect")}),this._socket.on("end",()=>{this.#Y=!1,this.#D(i.InstanceStatus.Disconnected),!this.#Z&&this.#m.reconnect&&this.#X(),this.emit("end")}),this._socket.on("data",e=>this.emit("data",e)),this._socket.on("drain",()=>this.emit("drain")),setImmediate(()=>{this.#N||this.connect()}),this.#r=setTimeout(()=>{this.#r=void 0,this.#N||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#T}:${this.#x} is missing an error handler!`)},5e3)}connect(){if(this.#N)throw new Error("Cannot connect destroyed socket");return!this.#Z&&(this.#Z=!0,this._socket.connect(this.#x,this.#T),!0)}async send(e){if(this.#N||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#Y)return!1;try{return new Promise((t,r)=>{this._socket.write(e,e=>{e?r(e):t(!0)})})}catch(e){this.#Y=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#D(i.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#N=!0,void 0!==this.#K&&(clearTimeout(this.#K),this.#K=void 0),void 0!==this.#r&&(clearTimeout(this.#r),this.#r=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#X(){void 0!==this.#K&&clearTimeout(this.#K),this.#K=setTimeout(()=>{this.#K=void 0,this.#D(i.InstanceStatus.Connecting),this.connect()},this.#m.reconnect_interval)}#D(e,t){this.#F!=e&&(this.#F=e,this.emit("status_change",e,t))}}t.TCPHelper=o},8970:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s},o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),e.exports=(0,i.default)("crc-32",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=0===t?0:-1^t,s=0;s<e.length;s++){var i=e[s];r=o[255&(r^i)]^r>>>8}return-1^r})},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9023:e=>{"use strict";e.exports=require("util")},9077:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=function(e,t){if(!t){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'")}if(e.legacyIds.includes(e.id))throw new Error(`Manifest contains itself '${e.id}' in legacyIds`);if(!(0,s.default)(e)){const e=s.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}};const s=r(1635).__importDefault(r(7281))},9278:e=>{"use strict";e.exports=require("net")},9326:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("tcp-request"),i=s(r(5783)),o=s(r(3621));class a extends i.default{constructor(e,t,r,s,n){super(),this._id=e,this._protocol=t,this._length=r,this._unitId=s,this._body=n}get id(){return this._id}get protocol(){return this._protocol}get length(){return this._length}get unitId(){return this._unitId}get address(){return this.unitId}get slaveId(){return this.unitId}get name(){return this._body.name}get body(){return this._body}get corrupted(){return!1}get byteCount(){return this._length+6}static fromBuffer(e){try{if(e.length<7)return n("no enough data in the buffer yet"),null;const t=e.readUInt16BE(0),r=e.readUInt16BE(2),s=e.readUInt16BE(4),i=e.readUInt8(6);n("tcp header complete, id",t,"protocol",r,"length",s,"unitId",i),n("buffer",e);const u=o.default.fromBuffer(e.slice(7,6+s));return u?new a(t,r,s,i,u):null}catch(e){return n("not enough data to create a tcp request",e),null}}createPayload(){const e=this._body.createPayload(),t=Buffer.alloc(7+this._body.byteCount);return t.writeUInt16BE(this._id,0),t.writeUInt16BE(0,2),t.writeUInt16BE(this._body.byteCount+1,4),t.writeUInt8(this._unitId,6),e.copy(t,7),t}}t.default=a},9328:(e,t,r)=>{"use strict";var s,n=r(181),i=(s=r(2075))&&s.__esModule?s:{default:s};e.exports=(0,i.default)("crc1",function(e,t){n.Buffer.isBuffer(e)||(e=(0,n.Buffer)(e));for(var r=~~t,s=0,i=0;i<e.length;i++)s+=e[i];return(r+=s%256)%256})},9390:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1462)("rtu-response"),i=r(8809),o=s(r(3571)),a=s(r(7141));class u extends o.default{constructor(e,t,r){super(),this._address=e,this._crc=t,this._body=r}get address(){return this._address}get crc(){return this._crc}get body(){return this._body}get byteCount(){return this._body.byteCount+3}get slaveId(){return this._address}get unitId(){return this._address}static fromRequest(e,t){return new u(e.address,void 0,t)}static fromBuffer(e){if(e.length<1)return null;const t=e.readUInt8(0);n("address",t,"buffer",e);const r=a.default.fromBuffer(e.slice(1));if(!r)return null;let s;try{s=e.readUInt16LE(1+r.byteCount)}catch(e){return n("If NoSuchIndexException, it is probably serial and not all data has arrived"),null}return new u(t,s,r)}createPayload(){const e=Buffer.alloc(this.byteCount);return e.writeUInt8(this._address,0),this._body.createPayload().copy(e,1),this._crc=i.crc16modbus(e.slice(0,this.byteCount-2)),e.writeUInt16LE(this._crc,this.byteCount-2),e}}t.default=u},9637:e=>{"use strict";e.exports=require("tty")},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyUpgradeScript=void 0,t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,r)=>{const s=[];for(const t of r.feedbacks){let r=e[t.feedbackId];if(!0===r&&(r={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),r){t.style||(t.style={});for(const[e,n]of Object.entries(r))void 0!==t.options[e]&&(t.style[n]=t.options[e],delete t.options[e],s.push(t))}}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:s}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,r)=>{const s=[];for(const t of r.feedbacks){const r=e[t.feedbackId];if("string"!=typeof r)continue;const n=t.options[r];void 0!==n&&(delete t.options[r],t.isInverted="true"===n||!0===n||Number(n)>0,s.push(t))}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:s}}},t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedActions:[],updatedFeedbacks:[]})},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let s=0,n=e.length;for(;n>0;){const i=n/2|0;let o=s+i;r(e[o],t)<=0?(s=++o,n-=i+1):n=i}return s}}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=r(6278),t=r(4215);class s extends e.InstanceBase{config;pollTimeout;socket;client;constructor(e){super(e)}async init(t){this.config=t,this.updateStatus(e.InstanceStatus.Ok),this.updateActions(),this.updateFeedbacks(),this.updateVariableDefinitions(),this.initConnection()}async destroy(){this.log("debug","destroy")}async configUpdated(e){this.config=e,this.socket&&(clearTimeout(this.pollTimeout),this.socket.destroy(),this.socket=void 0),this.initConnection()}async initConnection(){try{this.updateStatus(e.InstanceStatus.Connecting),this.log("info","Connecting..."+JSON.stringify(this.config));const r={host:this.config.host||"127.0.0.1",port:this.config.port||502},s=new e.TCPHelper(r.host,r.port),n=new t.client.TCP(s._socket,1);this.client=n,s.on("status_change",(e,t)=>{this.updateStatus(e,t)}),s.on("error",e=>{this.log("error","error "+e)}),s.on("connect",()=>{this.log("info","Connected to Modbus server!");const e={},t=async()=>{try{const t=await n.readDiscreteInputs(0,8),r=Object.fromEntries(t.response.body.valuesAsArray.slice(0,8).map((e,t)=>[`input${t+1}_status`,Boolean(e)]).filter(([t,r])=>e[t]!==r));Object.values(r).length>0&&(this.setVariableValues(r),this.checkFeedbacks("InputState"))}catch(e){console.error(e)}this.pollTimeout=setTimeout(t,100)};t()})}catch(e){this.log("error","Error when initializing Modbus connection "+e)}}getConfigFields(){return[{type:"textinput",id:"host",label:"Target IP",width:8,regex:e.Regex.IP},{type:"number",id:"port",label:"Target Port",width:4,min:1,max:65535,default:502}]}updateActions(){var e;(e=this).setActionDefinitions({output_relay:{name:"Set output relay status",options:[{id:"output",type:"textinput",label:"Output",default:"1",useVariables:!0},{id:"status",type:"textinput",label:"Status (1 = on, 0 = off)",default:"1",useVariables:!0}],callback:async t=>{if(e.client){const r=parseInt(await e.parseVariablesInString(t.options.output)),s=parseInt(await e.parseVariablesInString(t.options.status));e.log("info",r+" "+s),isNaN(r)||isNaN(s)||e.client.writeSingleCoil(r-1,1===s).catch(e=>console.error(e))}}}})}updateFeedbacks(){var t;(t=this).setFeedbackDefinitions({InputState:{name:"Input State",type:"boolean",defaultStyle:{bgcolor:(0,e.combineRgb)(255,0,0),color:(0,e.combineRgb)(0,0,0)},options:[{id:"input_number",type:"number",label:"Input Number",default:1,min:1,max:8}],callback:e=>!!t.getVariableValue(`input${e.options.input_number}_status`)}})}updateVariableDefinitions(){!function(e){const t=[];for(let e=1;e<=8;e++)t.push({variableId:`input${e}_status`,name:`Input ${e} Status`});e.setVariableDefinitions(t)}(this)}}(0,e.runEntrypoint)(s,[])})()})();