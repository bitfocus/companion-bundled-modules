(()=>{var e={7169:(e,t,i)=>{"use strict";const r=i(2017);r.code='require("ajv/dist/runtime/equal").default',t.A=r},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var i={grad:.9,turn:360,rad:360/(2*Math.PI)},r=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},n=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=Math.pow(10,t)),Math.round(i*e)/i+0},s=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=1),e>i?i:e>t?e:t},a=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},o=function(e){return{r:s(e.r,0,255),g:s(e.g,0,255),b:s(e.b,0,255),a:s(e.a)}},c=function(e){return{r:n(e.r),g:n(e.g),b:n(e.b),a:n(e.a,3)}},l=/^#([0-9a-f]{3,8})$/i,h=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},u=function(e){var t=e.r,i=e.g,r=e.b,n=e.a,s=Math.max(t,i,r),a=s-Math.min(t,i,r),o=a?s===t?(i-r)/a:s===i?2+(r-t)/a:4+(t-i)/a:0;return{h:60*(o<0?o+6:o),s:s?a/s*100:0,v:s/255*100,a:n}},d=function(e){var t=e.h,i=e.s,r=e.v,n=e.a;t=t/360*6,i/=100,r/=100;var s=Math.floor(t),a=r*(1-i),o=r*(1-(t-s)*i),c=r*(1-(1-t+s)*i),l=s%6;return{r:255*[r,o,a,a,c,r][l],g:255*[c,r,r,o,a,a][l],b:255*[a,a,c,r,r,o][l],a:n}},p=function(e){return{h:a(e.h),s:s(e.s,0,100),l:s(e.l,0,100),a:s(e.a)}},f=function(e){return{h:n(e.h),s:n(e.s),l:n(e.l),a:n(e.a,3)}},g=function(e){return d((i=(t=e).s,{h:t.h,s:(i*=((r=t.l)<50?r:100-r)/100)>0?2*i/(r+i)*100:0,v:r+i,a:t.a}));var t,i,r},m=function(e){return{h:(t=u(e)).h,s:(n=(200-(i=t.s))*(r=t.v)/100)>0&&n<200?i*r/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,i,r,n},b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,A=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,I={string:[[function(e){var t=l.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?n(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?n(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=A.exec(e)||_.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:o({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=b.exec(e)||y.exec(e);if(!t)return null;var r,n,s=p({h:(r=t[1],n=t[2],void 0===n&&(n="deg"),Number(r)*(i[n]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return g(s)},"hsl"]],object:[[function(e){var t=e.r,i=e.g,n=e.b,s=e.a,a=void 0===s?1:s;return r(t)&&r(i)&&r(n)?o({r:Number(t),g:Number(i),b:Number(n),a:Number(a)}):null},"rgb"],[function(e){var t=e.h,i=e.s,n=e.l,s=e.a,a=void 0===s?1:s;if(!r(t)||!r(i)||!r(n))return null;var o=p({h:Number(t),s:Number(i),l:Number(n),a:Number(a)});return g(o)},"hsl"],[function(e){var t=e.h,i=e.s,n=e.v,o=e.a,c=void 0===o?1:o;if(!r(t)||!r(i)||!r(n))return null;var l=function(e){return{h:a(e.h),s:s(e.s,0,100),v:s(e.v,0,100),a:s(e.a)}}({h:Number(t),s:Number(i),v:Number(n),a:Number(c)});return d(l)},"hsv"]]},v=function(e,t){for(var i=0;i<t.length;i++){var r=t[i][0](e);if(r)return[r,t[i][1]]}return[null,void 0]},w=function(e){return"string"==typeof e?v(e.trim(),I.string):"object"==typeof e&&null!==e?v(e,I.object):[null,void 0]},E=function(e,t){var i=m(e);return{h:i.h,s:s(i.s+100*t,0,100),l:i.l,a:i.a}},k=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},O=function(e,t){var i=m(e);return{h:i.h,s:i.s,l:s(i.l+100*t,0,100),a:i.a}},C=function(){function e(e){this.parsed=w(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return n(k(this.rgba),2)},e.prototype.isDark=function(){return k(this.rgba)<.5},e.prototype.isLight=function(){return k(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=c(this.rgba)).r,i=e.g,r=e.b,a=(s=e.a)<1?h(n(255*s)):"","#"+h(t)+h(i)+h(r)+a;var e,t,i,r,s,a},e.prototype.toRgb=function(){return c(this.rgba)},e.prototype.toRgbString=function(){return t=(e=c(this.rgba)).r,i=e.g,r=e.b,(n=e.a)<1?"rgba("+t+", "+i+", "+r+", "+n+")":"rgb("+t+", "+i+", "+r+")";var e,t,i,r,n},e.prototype.toHsl=function(){return f(m(this.rgba))},e.prototype.toHslString=function(){return t=(e=f(m(this.rgba))).h,i=e.s,r=e.l,(n=e.a)<1?"hsla("+t+", "+i+"%, "+r+"%, "+n+")":"hsl("+t+", "+i+"%, "+r+"%)";var e,t,i,r,n},e.prototype.toHsv=function(){return e=u(this.rgba),{h:n(e.h),s:n(e.s),v:n(e.v),a:n(e.a,3)};var e},e.prototype.invert=function(){return S({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),S(E(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),S(E(this.rgba,-e))},e.prototype.grayscale=function(){return S(E(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),S(O(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),S(O(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?S({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):n(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=m(this.rgba);return"number"==typeof e?S({h:e,s:t.s,l:t.l,a:t.a}):n(t.h)},e.prototype.isEqual=function(e){return this.toHex()===S(e).toHex()},e}(),S=function(e){return e instanceof C?e:new C(e)},T=[];t.Colord=C,t.colord=S,t.extend=function(e){e.forEach((function(e){T.indexOf(e)<0&&(e(C,I),T.push(e))}))},t.getFormat=function(e){return w(e)[1]},t.random=function(){return new C({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===r(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var n=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=n,t.convertMapToObject=function(e){return Array.from(e).reduce((function(e,t){var r,n,s=(n=2,function(e){if(Array.isArray(e))return e}(r=t)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,s=[],a=!0,o=!1;try{for(i=i.call(e);!(a=(r=i.next()).done)&&(s.push(r.value),!t||s.length!==t);a=!0);}catch(e){o=!0,n=e}finally{try{a||null==i.return||i.return()}finally{if(o)throw n}}return s}}(r,n)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=s[0],o=s[1];return e[a]=o,e}),{})},t.isArguments=function(e){return null!=e&&n(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var s={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=s,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(s.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var i=Object.create(null),r=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},n=0;n<64;n++)i[r(n)]=n;var s=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],i=0;i<e;i++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},a={encode:function(e){if("string"==typeof e){var t=e;e=s(t.length);for(var i=0;i<t.length;i++){var n=t.charCodeAt(i);if(n>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[i]=n}}for(var a=[],o=null,c=null,l=null,h=null,u=0;u<e.length;u++)switch(u%3){case 0:o=e[u]>>2&63,c=(3&e[u])<<4;break;case 1:c|=e[u]>>4&15,l=(15&e[u])<<2;break;case 2:l|=e[u]>>6&3,h=63&e[u],a.push(r(o)),a.push(r(c)),a.push(r(l)),a.push(r(h)),o=null,c=null,l=null,h=null}return null!=o&&(a.push(r(o)),a.push(r(c)),null==l?a.push("="):a.push(r(l)),null==h&&a.push("=")),a.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var r,n=s(t),a=null,o=null,c=null,l=0,h=0;h<e.length;h++){var u="="===(r=e.charAt(h))?-1:i[r];switch(h%4){case 0:if(u<0)throw new Error("invalid base64 string");a=u<<2;break;case 1:if(u<0)throw new Error("invalid base64 string");a|=u>>4,n[l++]=a,o=(15&u)<<4;break;case 2:u>=0&&(o|=u>>2,n[l++]=o,c=(3&u)<<6);break;case 3:u>=0&&(n[l++]=c|u)}}return n},newBinary:s};t.Base64=a},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function e(t,n,s,a,o){var c=n[t];switch(i(c)){case"string":return r(c);case"number":return isFinite(c)?String(c):"null";case"boolean":return String(c);case"object":if(!c)return"null";var l,h=a+s,u=[];if(Array.isArray(c)||{}.hasOwnProperty.call(c,"callee")){for(var d=c.length,p=0;p<d;p+=1)u[p]=e(p,c,s,h,o)||"null";return l=0===u.length?"[]":h?"[\n"+h+u.join(",\n"+h)+"\n"+a+"]":"["+u.join(",")+"]"}var f=Object.keys(c);return o&&(f=f.sort()),f.forEach((function(t){(l=e(t,c,s,h,o))&&u.push(r(t)+(h?": ":":")+l)})),l=0===u.length?"{}":h?"{\n"+h+u.join(",\n"+h)+"\n"+a+"}":"{"+u.join(",")+"}"}};t.default=function(e,t){var i=Object.assign({indent:"",canonical:!1},t);if(!0===i.indent)i.indent="  ";else if("number"==typeof i.indent){for(var r="",s=0;s<i.indent;s++)r+=" ";i.indent=r}return n("",{"":e},i.indent,"",i.canonical)},e.exports=t.default}],i={};function r(e){var n=i[e];if(void 0!==n)return n.exports;var s=i[e]={exports:{}};return t[e](s,s.exports,r),s.exports}var n={};!function(){var e=n,t=r(2).Base64,i=r(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var s=r(1),a={};e.EJSON=a;var o=new Map;a.addType=function(e,t){if(o.has(e))throw new Error("Type ".concat(e," already present"));o.set(e,t)};var c=[{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$date")&&1===(0,s.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$regexp")&&(0,s.hasOwn)(e,"$flags")&&2===(0,s.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$InfNaN")&&1===(0,s.lengthOf)(e)},matchObject:s.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$binary")&&1===(0,s.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,s.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$escape")&&1===(0,s.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var i=(0,s.lengthOf)(e);1!==i&&2!==i||(t=c.some((function(t){return t.matchJSONValue(e)})))}return t},toJSONValue:function(e){var t={};return(0,s.keysOf)(e).forEach((function(i){t[i]=a.toJSONValue(e[i])})),{$escape:t}},fromJSONValue:function(e){var t={};return(0,s.keysOf)(e.$escape).forEach((function(i){t[i]=a.fromJSONValue(e.$escape[i])})),t}},{matchJSONValue:function(e){return(0,s.hasOwn)(e,"$type")&&(0,s.hasOwn)(e,"$value")&&2===(0,s.lengthOf)(e)},matchObject:function(e){return a._isCustomType(e)},toJSONValue:function(e){var t=i._noYieldsAllowed((function(){return e.toJSONValue()}));return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!o.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var r=o.get(t);return i._noYieldsAllowed((function(){return r(e.$value)}))}}];a._isCustomType=function(e){return e&&(0,s.isFunction)(e.toJSONValue)&&(0,s.isFunction)(e.typeName)&&o.has(e.typeName())},a._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?o:(0,s.convertMapToObject)(o)},a._getConverters=function(){return c};var l=function(e){for(var t=0;t<c.length;t++){var i=c[t];if(i.matchObject(e))return i.toJSONValue(e)}},h=function e(t){if(null===t)return null;var i=l(t);return void 0!==i?i:(0,s.isObject)(t)?((0,s.keysOf)(t).forEach((function(i){var r=t[i];if((0,s.isObject)(r)||void 0===r||(0,s.isInfOrNaN)(r)){var n=l(r);n?t[i]=n:e(r)}})),t):t};a._adjustTypesToJSONValue=h,a.toJSONValue=function(e){var t=l(e);if(void 0!==t)return t;var i=e;return(0,s.isObject)(e)&&(i=a.clone(e),h(i)),i};var u=function(e){if((0,s.isObject)(e)&&null!==e){var t=(0,s.keysOf)(e);if(t.length<=2&&t.every((function(e){return"string"==typeof e&&"$"===e.substr(0,1)})))for(var i=0;i<c.length;i++){var r=c[i];if(r.matchJSONValue(e))return r.fromJSONValue(e)}}return e},d=function e(t){if(null===t)return null;var i=u(t);return i!==t?i:(0,s.isObject)(t)?((0,s.keysOf)(t).forEach((function(i){var r=t[i];if((0,s.isObject)(r)){var n=u(r);if(r!==n)return void(t[i]=n);e(r)}})),t):t};a._adjustTypesFromJSONValue=d,a.fromJSONValue=function(e){var t=u(e);return t===e&&(0,s.isObject)(e)&&(t=a.clone(e),d(t)),t},a.stringify=(0,s.handleError)((function(e,t){var i=a.toJSONValue(e);return t&&(t.canonical||t.indent)?r(4)(i,t):JSON.stringify(i)})),a.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return a.fromJSONValue(JSON.parse(e))},a.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},a.equals=function(e,t,i){var r,n=!(!i||!i.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,s.isObject)(e)||!(0,s.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(a.isBinary(e)&&a.isBinary(t)){if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}if((0,s.isFunction)(e.equals))return e.equals(t,i);if((0,s.isFunction)(t.equals))return t.equals(e,i);var o,c=Array.isArray(e),l=Array.isArray(t);if(c!==l)return!1;if(c&&l){if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(!a.equals(e[r],t[r],i))return!1;return!0}switch(a._isCustomType(e)+a._isCustomType(t)){case 1:return!1;case 2:return a.equals(a.toJSONValue(e),a.toJSONValue(t))}var h=(0,s.keysOf)(e),u=(0,s.keysOf)(t);return n?(r=0,o=h.every((function(n){return!(r>=u.length||n!==u[r]||!a.equals(e[n],t[u[r]],i)||(r++,0))}))):(r=0,o=h.every((function(n){return!!(0,s.hasOwn)(t,n)&&!!a.equals(e[n],t[n],i)&&(r++,!0)}))),o&&r===u.length},a.clone=function(e){var t;if(!(0,s.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(a.isBinary(e)){t=a.newBinary(e.length);for(var i=0;i<e.length;i++)t[i]=e[i];return t}return Array.isArray(e)?e.map(a.clone):(0,s.isArguments)(e)?Array.from(e).map(a.clone):(0,s.isFunction)(e.clone)?e.clone():a._isCustomType(e)?a.fromJSONValue(a.clone(a.toJSONValue(e)),!0):(t={},(0,s.keysOf)(e).forEach((function(i){t[i]=a.clone(e[i])})),t)},a.newBinary=t.newBinary}(),e.exports=n.EJSON}()},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,i="~";function r(){}function n(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function s(e,t,r,s,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new n(r,s||e,a),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),o.prototype.eventNames=function(){var e,r,n=[];if(0===this._eventsCount)return n;for(r in e=this._events)t.call(e,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},o.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,a=new Array(s);n<s;n++)a[n]=r[n].fn;return a},o.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,n,s,a){var o=i?i+e:e;if(!this._events[o])return!1;var c,l,h=this._events[o],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,r),!0;case 4:return h.fn.call(h.context,t,r,n),!0;case 5:return h.fn.call(h.context,t,r,n,s),!0;case 6:return h.fn.call(h.context,t,r,n,s,a),!0}for(l=1,c=new Array(u-1);l<u;l++)c[l-1]=arguments[l];h.fn.apply(h.context,c)}else{var d,p=h.length;for(l=0;l<p;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),u){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,r);break;case 4:h[l].fn.call(h[l].context,t,r,n);break;default:if(!c)for(d=1,c=new Array(u-1);d<u;d++)c[d-1]=arguments[d];h[l].fn.apply(h[l].context,c)}}return!0},o.prototype.on=function(e,t,i){return s(this,e,t,i,!1)},o.prototype.once=function(e,t,i){return s(this,e,t,i,!0)},o.prototype.removeListener=function(e,t,r,n){var s=i?i+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||n&&!o.once||r&&o.context!==r||a(this,s);else{for(var c=0,l=[],h=o.length;c<h;c++)(o[c].fn!==t||n&&!o[c].once||r&&o[c].context!==r)&&l.push(o[c]);l.length?this._events[s]=1===l.length?l[0]:l:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o},2017:e=>{"use strict";e.exports=function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;var r,n,s;if(Array.isArray(t)){if((r=t.length)!=i.length)return!1;for(n=r;0!=n--;)if(!e(t[n],i[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((r=(s=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(i,s[n]))return!1;for(n=r;0!=n--;){var a=s[n];if(!e(t[a],i[a]))return!1}return!0}return t!=t&&i!=i}},4865:e=>{"use strict";const t=(e,t,r,n)=>{if("length"===r||"prototype"===r)return;if("arguments"===r||"caller"===r)return;const s=Object.getOwnPropertyDescriptor(e,r),a=Object.getOwnPropertyDescriptor(t,r);!i(s,a)&&n||Object.defineProperty(e,r,a)},i=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},r=(e,t)=>`/* Wrapped ${e}*/\n${t}`,n=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),s=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,i,{ignoreNonConfigurable:a=!1}={})=>{const{name:o}=e;for(const r of Reflect.ownKeys(i))t(e,i,r,a);return((e,t)=>{const i=Object.getPrototypeOf(t);i!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,i)})(e,i),((e,t,i)=>{const a=""===i?"":`with ${i.trim()}() `,o=r.bind(null,a,t.toString());Object.defineProperty(o,"name",s),Object.defineProperty(e,"toString",{...n,value:o})})(e,i,o),e}},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},3290:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(228),n=i(7685),s=i(4774),a=()=>{},o=new n.TimeoutError;t.default=class extends r{constructor(e){var t,i,r,n;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=a,this._resolveIdle=a,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:s.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(i=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==i?i:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(n=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==n?n:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=a,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=a,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((i,r)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const s=void 0===this._timeout&&void 0===t.timeout?e():n.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&r(o)}));i(await s)}catch(e){r(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i){let r=0,n=e.length;for(;n>0;){const s=n/2|0;let a=r+s;i(e[a],t)<=0?(r=++a,n-=s+1):n=s}return r}},4774:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const i={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(i);const n=r.default(this._queue,i,((e,t)=>t.priority-e.priority));this._queue.splice(n,0,i)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},7685:(e,t,i)=>{"use strict";const r=i(4617);class n extends Error{constructor(e){super(e),this.name="TimeoutError"}}const s=(e,t,i)=>new Promise(((s,a)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void s(e);const o=setTimeout((()=>{if("function"==typeof i){try{s(i())}catch(e){a(e)}return}const r=i instanceof Error?i:new n("string"==typeof i?i:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),a(r)}),t);r(e.then(s,a),(()=>{clearTimeout(o)}))}));e.exports=s,e.exports.default=s,e.exports.TimeoutError=n},5913:(e,t,i)=>{"use strict";let r=i(2582),n=[function(){},function(e,t,i,r){if(r===t.length)throw new Error("Ran out of data");let n=t[r];e[i]=n,e[i+1]=n,e[i+2]=n,e[i+3]=255},function(e,t,i,r){if(r+1>=t.length)throw new Error("Ran out of data");let n=t[r];e[i]=n,e[i+1]=n,e[i+2]=n,e[i+3]=t[r+1]},function(e,t,i,r){if(r+2>=t.length)throw new Error("Ran out of data");e[i]=t[r],e[i+1]=t[r+1],e[i+2]=t[r+2],e[i+3]=255},function(e,t,i,r){if(r+3>=t.length)throw new Error("Ran out of data");e[i]=t[r],e[i+1]=t[r+1],e[i+2]=t[r+2],e[i+3]=t[r+3]}],s=[function(){},function(e,t,i,r){let n=t[0];e[i]=n,e[i+1]=n,e[i+2]=n,e[i+3]=r},function(e,t,i){let r=t[0];e[i]=r,e[i+1]=r,e[i+2]=r,e[i+3]=t[1]},function(e,t,i,r){e[i]=t[0],e[i+1]=t[1],e[i+2]=t[2],e[i+3]=r},function(e,t,i){e[i]=t[0],e[i+1]=t[1],e[i+2]=t[2],e[i+3]=t[3]}];function a(e,t,i,r,s,a){let o=e.width,c=e.height,l=e.index;for(let e=0;e<c;e++)for(let c=0;c<o;c++){let o=i(c,e,l);n[r](t,s,o,a),a+=r}return a}function o(e,t,i,r,n,a){let o=e.width,c=e.height,l=e.index;for(let e=0;e<c;e++){for(let c=0;c<o;c++){let o=n.get(r),h=i(c,e,l);s[r](t,o,h,a)}n.resetAfterLine()}}t.dataToBitMap=function(e,t){let i,n,s=t.width,c=t.height,l=t.depth,h=t.bpp,u=t.interlace;8!==l&&(i=function(e,t){let i=[],r=0;function n(){if(r===e.length)throw new Error("Ran out of data");let n,s,a,o,c,l,h,u,d=e[r];switch(r++,t){default:throw new Error("unrecognised depth");case 16:h=e[r],r++,i.push((d<<8)+h);break;case 4:h=15&d,u=d>>4,i.push(u,h);break;case 2:c=3&d,l=d>>2&3,h=d>>4&3,u=d>>6&3,i.push(u,h,l,c);break;case 1:n=1&d,s=d>>1&1,a=d>>2&1,o=d>>3&1,c=d>>4&1,l=d>>5&1,h=d>>6&1,u=d>>7&1,i.push(u,h,l,c,o,a,s,n)}}return{get:function(e){for(;i.length<e;)n();let t=i.slice(0,e);return i=i.slice(e),t},resetAfterLine:function(){i.length=0},end:function(){if(r!==e.length)throw new Error("extra data found")}}}(e,l)),n=l<=8?Buffer.alloc(s*c*4):new Uint16Array(s*c*4);let d,p,f=Math.pow(2,l)-1,g=0;if(u)d=r.getImagePasses(s,c),p=r.getInterlaceIterator(s,c);else{let e=0;p=function(){let t=e;return e+=4,t},d=[{width:s,height:c}]}for(let t=0;t<d.length;t++)8===l?g=a(d[t],n,p,h,e,g):o(d[t],n,p,h,i,f);if(8===l){if(g!==e.length)throw new Error("extra data found")}else i.end();return n}},1638:(e,t,i)=>{"use strict";let r=i(6402);e.exports=function(e,t,i,n){let s=-1!==[r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(n.colorType);if(n.colorType===n.inputColorType){let t=function(){let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256!==new Int16Array(e)[0]}();if(8===n.bitDepth||16===n.bitDepth&&t)return e}let a=16!==n.bitDepth?e:new Uint16Array(e.buffer),o=255,c=r.COLORTYPE_TO_BPP_MAP[n.inputColorType];4!==c||n.inputHasAlpha||(c=3);let l=r.COLORTYPE_TO_BPP_MAP[n.colorType];16===n.bitDepth&&(o=65535,l*=2);let h=Buffer.alloc(t*i*l),u=0,d=0,p=n.bgColor||{};function f(){let e,t,i,c=o;switch(n.inputColorType){case r.COLORTYPE_COLOR_ALPHA:c=a[u+3],e=a[u],t=a[u+1],i=a[u+2];break;case r.COLORTYPE_COLOR:e=a[u],t=a[u+1],i=a[u+2];break;case r.COLORTYPE_ALPHA:c=a[u+1],e=a[u],t=e,i=e;break;case r.COLORTYPE_GRAYSCALE:e=a[u],t=e,i=e;break;default:throw new Error("input color type:"+n.inputColorType+" is not supported at present")}return n.inputHasAlpha&&(s||(c/=o,e=Math.min(Math.max(Math.round((1-c)*p.red+c*e),0),o),t=Math.min(Math.max(Math.round((1-c)*p.green+c*t),0),o),i=Math.min(Math.max(Math.round((1-c)*p.blue+c*i),0),o))),{red:e,green:t,blue:i,alpha:c}}void 0===p.red&&(p.red=o),void 0===p.green&&(p.green=o),void 0===p.blue&&(p.blue=o);for(let e=0;e<i;e++)for(let e=0;e<t;e++){let e=f();switch(n.colorType){case r.COLORTYPE_COLOR_ALPHA:case r.COLORTYPE_COLOR:8===n.bitDepth?(h[d]=e.red,h[d+1]=e.green,h[d+2]=e.blue,s&&(h[d+3]=e.alpha)):(h.writeUInt16BE(e.red,d),h.writeUInt16BE(e.green,d+2),h.writeUInt16BE(e.blue,d+4),s&&h.writeUInt16BE(e.alpha,d+6));break;case r.COLORTYPE_ALPHA:case r.COLORTYPE_GRAYSCALE:{let t=(e.red+e.green+e.blue)/3;8===n.bitDepth?(h[d]=t,s&&(h[d+1]=e.alpha)):(h.writeUInt16BE(t,d),s&&h.writeUInt16BE(e.alpha,d+2));break}default:throw new Error("unrecognised color Type "+n.colorType)}u+=c,d+=l}return h}},9402:(e,t,i)=>{"use strict";let r=i(9023),n=i(2203),s=e.exports=function(){n.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};r.inherits(s,n),s.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t}),process.nextTick(function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},s.prototype.write=function(e,t){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let i;return i=Buffer.isBuffer(e)?e:Buffer.from(e,t||this._encoding),this._buffers.push(i),this._buffered+=i.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused},s.prototype.end=function(e,t){e&&this.write(e,t),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},s.prototype.destroySoon=s.prototype.end,s.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},s.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},s.prototype._processReadAllowingLess=function(e){this._reads.shift();let t=this._buffers[0];t.length>e.length?(this._buffered-=e.length,this._buffers[0]=t.slice(e.length),e.func.call(this,t.slice(0,e.length))):(this._buffered-=t.length,this._buffers.shift(),e.func.call(this,t))},s.prototype._processRead=function(e){this._reads.shift();let t=0,i=0,r=Buffer.alloc(e.length);for(;t<e.length;){let n=this._buffers[i++],s=Math.min(n.length,e.length-t);n.copy(r,t,0,s),t+=s,s!==n.length&&(this._buffers[--i]=n.slice(s))}i>0&&this._buffers.splice(0,i),this._buffered-=e.length,e.func.call(this,r)},s.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let e=this._reads[0];if(e.allowLess)this._processReadAllowingLess(e);else{if(!(this._buffered>=e.length))break;this._processRead(e)}}this._buffers&&!this.writable&&this._end()}catch(e){this.emit("error",e)}}},6402:e=>{"use strict";e.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},7613:e=>{"use strict";let t=[];!function(){for(let e=0;e<256;e++){let i=e;for(let e=0;e<8;e++)1&i?i=3988292384^i>>>1:i>>>=1;t[e]=i}}();let i=e.exports=function(){this._crc=-1};i.prototype.write=function(e){for(let i=0;i<e.length;i++)this._crc=t[255&(this._crc^e[i])]^this._crc>>>8;return!0},i.prototype.crc32=function(){return~this._crc},i.crc32=function(e){let i=-1;for(let r=0;r<e.length;r++)i=t[255&(i^e[r])]^i>>>8;return~i}},947:(e,t,i)=>{"use strict";let r=i(276),n={0:function(e,t,i,r,n){for(let s=0;s<i;s++)r[n+s]=e[t+s]},1:function(e,t,i,r,n,s){for(let a=0;a<i;a++){let i=a>=s?e[t+a-s]:0,o=e[t+a]-i;r[n+a]=o}},2:function(e,t,i,r,n){for(let s=0;s<i;s++){let a=t>0?e[t+s-i]:0,o=e[t+s]-a;r[n+s]=o}},3:function(e,t,i,r,n,s){for(let a=0;a<i;a++){let o=a>=s?e[t+a-s]:0,c=t>0?e[t+a-i]:0,l=e[t+a]-(o+c>>1);r[n+a]=l}},4:function(e,t,i,n,s,a){for(let o=0;o<i;o++){let c=o>=a?e[t+o-a]:0,l=t>0?e[t+o-i]:0,h=t>0&&o>=a?e[t+o-(i+a)]:0,u=e[t+o]-r(c,l,h);n[s+o]=u}}},s={0:function(e,t,i){let r=0,n=t+i;for(let i=t;i<n;i++)r+=Math.abs(e[i]);return r},1:function(e,t,i,r){let n=0;for(let s=0;s<i;s++){let i=s>=r?e[t+s-r]:0,a=e[t+s]-i;n+=Math.abs(a)}return n},2:function(e,t,i){let r=0,n=t+i;for(let s=t;s<n;s++){let n=t>0?e[s-i]:0,a=e[s]-n;r+=Math.abs(a)}return r},3:function(e,t,i,r){let n=0;for(let s=0;s<i;s++){let a=s>=r?e[t+s-r]:0,o=t>0?e[t+s-i]:0,c=e[t+s]-(a+o>>1);n+=Math.abs(c)}return n},4:function(e,t,i,n){let s=0;for(let a=0;a<i;a++){let o=a>=n?e[t+a-n]:0,c=t>0?e[t+a-i]:0,l=t>0&&a>=n?e[t+a-(i+n)]:0,h=e[t+a]-r(o,c,l);s+=Math.abs(h)}return s}};e.exports=function(e,t,i,r,a){let o;if("filterType"in r&&-1!==r.filterType){if("number"!=typeof r.filterType)throw new Error("unrecognised filter types");o=[r.filterType]}else o=[0,1,2,3,4];16===r.bitDepth&&(a*=2);let c=t*a,l=0,h=0,u=Buffer.alloc((c+1)*i),d=o[0];for(let t=0;t<i;t++){if(o.length>1){let t=1/0;for(let i=0;i<o.length;i++){let r=s[o[i]](e,h,c,a);r<t&&(d=o[i],t=r)}}u[l]=d,l++,n[d](e,h,c,u,l,a),l+=c,h+=c}return u}},2170:(e,t,i)=>{"use strict";let r=i(9023),n=i(9402),s=i(695),a=e.exports=function(e){n.call(this);let t=[],i=this;this._filter=new s(e,{read:this.read.bind(this),write:function(e){t.push(e)},complete:function(){i.emit("complete",Buffer.concat(t))}}),this._filter.start()};r.inherits(a,n)},6479:(e,t,i)=>{"use strict";let r=i(1402),n=i(695);t.process=function(e,t){let i=[],s=new r(e);return new n(t,{read:s.read.bind(s),write:function(e){i.push(e)},complete:function(){}}).start(),s.process(),Buffer.concat(i)}},695:(e,t,i)=>{"use strict";let r=i(2582),n=i(276);function s(e,t,i){let r=e*t;return 8!==i&&(r=Math.ceil(r/(8/i))),r}let a=e.exports=function(e,t){let i=e.width,n=e.height,a=e.interlace,o=e.bpp,c=e.depth;if(this.read=t.read,this.write=t.write,this.complete=t.complete,this._imageIndex=0,this._images=[],a){let e=r.getImagePasses(i,n);for(let t=0;t<e.length;t++)this._images.push({byteWidth:s(e[t].width,o,c),height:e[t].height,lineIndex:0})}else this._images.push({byteWidth:s(i,o,c),height:n,lineIndex:0});this._xComparison=8===c?o:16===c?2*o:1};a.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},a.prototype._unFilterType1=function(e,t,i){let r=this._xComparison,n=r-1;for(let s=0;s<i;s++){let i=e[1+s],a=s>n?t[s-r]:0;t[s]=i+a}},a.prototype._unFilterType2=function(e,t,i){let r=this._lastLine;for(let n=0;n<i;n++){let i=e[1+n],s=r?r[n]:0;t[n]=i+s}},a.prototype._unFilterType3=function(e,t,i){let r=this._xComparison,n=r-1,s=this._lastLine;for(let a=0;a<i;a++){let i=e[1+a],o=s?s[a]:0,c=a>n?t[a-r]:0,l=Math.floor((c+o)/2);t[a]=i+l}},a.prototype._unFilterType4=function(e,t,i){let r=this._xComparison,s=r-1,a=this._lastLine;for(let o=0;o<i;o++){let i=e[1+o],c=a?a[o]:0,l=o>s?t[o-r]:0,h=o>s&&a?a[o-r]:0,u=n(l,c,h);t[o]=i+u}},a.prototype._reverseFilterLine=function(e){let t,i=e[0],r=this._images[this._imageIndex],n=r.byteWidth;if(0===i)t=e.slice(1,n+1);else switch(t=Buffer.alloc(n),i){case 1:this._unFilterType1(e,t,n);break;case 2:this._unFilterType2(e,t,n);break;case 3:this._unFilterType3(e,t,n);break;case 4:this._unFilterType4(e,t,n);break;default:throw new Error("Unrecognised filter type - "+i)}this.write(t),r.lineIndex++,r.lineIndex>=r.height?(this._lastLine=null,this._imageIndex++,r=this._images[this._imageIndex]):this._lastLine=t,r?this.read(r.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}},4721:e=>{"use strict";e.exports=function(e,t,i=!1){let r=t.depth,n=t.width,s=t.height,a=t.colorType,o=t.transColor,c=t.palette,l=e;return 3===a?function(e,t,i,r,n){let s=0;for(let a=0;a<r;a++)for(let r=0;r<i;r++){let i=n[e[s]];if(!i)throw new Error("index "+e[s]+" not in palette");for(let e=0;e<4;e++)t[s+e]=i[e];s+=4}}(e,l,n,s,c):(o&&function(e,t,i,r,n){let s=0;for(let a=0;a<r;a++)for(let r=0;r<i;r++){let i=!1;if(1===n.length?n[0]===e[s]&&(i=!0):n[0]===e[s]&&n[1]===e[s+1]&&n[2]===e[s+2]&&(i=!0),i)for(let e=0;e<4;e++)t[s+e]=0;s+=4}}(e,l,n,s,o),8===r||i||(16===r&&(l=Buffer.alloc(n*s*4)),function(e,t,i,r,n){let s=Math.pow(2,n)-1,a=0;for(let n=0;n<r;n++)for(let r=0;r<i;r++){for(let i=0;i<4;i++)t[a+i]=Math.floor(255*e[a+i]/s+.5);a+=4}}(e,l,n,s,r))),l}},2582:(e,t)=>{"use strict";let i=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];t.getImagePasses=function(e,t){let r=[],n=e%8,s=t%8,a=(e-n)/8,o=(t-s)/8;for(let e=0;e<i.length;e++){let t=i[e],c=a*t.x.length,l=o*t.y.length;for(let e=0;e<t.x.length&&t.x[e]<n;e++)c++;for(let e=0;e<t.y.length&&t.y[e]<s;e++)l++;c>0&&l>0&&r.push({width:c,height:l,index:e})}return r},t.getInterlaceIterator=function(e){return function(t,r,n){let s=t%i[n].x.length,a=(t-s)/i[n].x.length*8+i[n].x[s],o=r%i[n].y.length;return 4*a+((r-o)/i[n].y.length*8+i[n].y[o])*e*4}}},8:(e,t,i)=>{"use strict";let r=i(9023),n=i(2203),s=i(6402),a=i(3769),o=e.exports=function(e){n.call(this);let t=e||{};this._packer=new a(t),this._deflate=this._packer.createDeflate(),this.readable=!0};r.inherits(o,n),o.prototype.pack=function(e,t,i,r){this.emit("data",Buffer.from(s.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(t,i)),r&&this.emit("data",this._packer.packGAMA(r));let n=this._packer.filterData(e,t,i);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(e){this.emit("data",this._packer.packIDAT(e))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(n)}},1497:(e,t,i)=>{"use strict";let r=!0,n=i(3106);n.deflateSync||(r=!1);let s=i(6402),a=i(3769);e.exports=function(e,t){if(!r)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let i=new a(t||{}),o=[];o.push(Buffer.from(s.PNG_SIGNATURE)),o.push(i.packIHDR(e.width,e.height)),e.gamma&&o.push(i.packGAMA(e.gamma));let c=i.filterData(e.data,e.width,e.height),l=n.deflateSync(c,i.getDeflateOptions());if(c=null,!l||!l.length)throw new Error("bad png - invalid compressed data response");return o.push(i.packIDAT(l)),o.push(i.packIEND()),Buffer.concat(o)}},3769:(e,t,i)=>{"use strict";let r=i(6402),n=i(7613),s=i(1638),a=i(947),o=i(3106),c=e.exports=function(e){if(this._options=e,e.deflateChunkSize=e.deflateChunkSize||32768,e.deflateLevel=null!=e.deflateLevel?e.deflateLevel:9,e.deflateStrategy=null!=e.deflateStrategy?e.deflateStrategy:3,e.inputHasAlpha=null==e.inputHasAlpha||e.inputHasAlpha,e.deflateFactory=e.deflateFactory||o.createDeflate,e.bitDepth=e.bitDepth||8,e.colorType="number"==typeof e.colorType?e.colorType:r.COLORTYPE_COLOR_ALPHA,e.inputColorType="number"==typeof e.inputColorType?e.inputColorType:r.COLORTYPE_COLOR_ALPHA,-1===[r.COLORTYPE_GRAYSCALE,r.COLORTYPE_COLOR,r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(e.colorType))throw new Error("option color type:"+e.colorType+" is not supported at present");if(-1===[r.COLORTYPE_GRAYSCALE,r.COLORTYPE_COLOR,r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(e.inputColorType))throw new Error("option input color type:"+e.inputColorType+" is not supported at present");if(8!==e.bitDepth&&16!==e.bitDepth)throw new Error("option bit depth:"+e.bitDepth+" is not supported at present")};c.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},c.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},c.prototype.filterData=function(e,t,i){let n=s(e,t,i,this._options),o=r.COLORTYPE_TO_BPP_MAP[this._options.colorType];return a(n,t,i,this._options,o)},c.prototype._packChunk=function(e,t){let i=t?t.length:0,r=Buffer.alloc(i+12);return r.writeUInt32BE(i,0),r.writeUInt32BE(e,4),t&&t.copy(r,8),r.writeInt32BE(n.crc32(r.slice(4,r.length-4)),r.length-4),r},c.prototype.packGAMA=function(e){let t=Buffer.alloc(4);return t.writeUInt32BE(Math.floor(e*r.GAMMA_DIVISION),0),this._packChunk(r.TYPE_gAMA,t)},c.prototype.packIHDR=function(e,t){let i=Buffer.alloc(13);return i.writeUInt32BE(e,0),i.writeUInt32BE(t,4),i[8]=this._options.bitDepth,i[9]=this._options.colorType,i[10]=0,i[11]=0,i[12]=0,this._packChunk(r.TYPE_IHDR,i)},c.prototype.packIDAT=function(e){return this._packChunk(r.TYPE_IDAT,e)},c.prototype.packIEND=function(){return this._packChunk(r.TYPE_IEND,null)}},276:e=>{"use strict";e.exports=function(e,t,i){let r=e+t-i,n=Math.abs(r-e),s=Math.abs(r-t),a=Math.abs(r-i);return n<=s&&n<=a?e:s<=a?t:i}},7089:(e,t,i)=>{"use strict";let r=i(9023),n=i(3106),s=i(9402),a=i(2170),o=i(336),c=i(5913),l=i(4721),h=e.exports=function(e){s.call(this),this._parser=new o(e,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=e,this.writable=!0,this._parser.start()};r.inherits(h,s),h.prototype._handleError=function(e){this.emit("error",e),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},h.prototype._inflateData=function(e){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=n.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let e=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,t=Math.max(e,n.Z_MIN_CHUNK);this._inflate=n.createInflate({chunkSize:t});let i=e,r=this.emit.bind(this,"error");this._inflate.on("error",(function(e){i&&r(e)})),this._filter.on("complete",this._complete.bind(this));let s=this._filter.write.bind(this._filter);this._inflate.on("data",(function(e){i&&(e.length>i&&(e=e.slice(0,i)),i-=e.length,s(e))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(e)},h.prototype._handleMetaData=function(e){this._metaData=e,this._bitmapInfo=Object.create(e),this._filter=new a(this._bitmapInfo)},h.prototype._handleTransColor=function(e){this._bitmapInfo.transColor=e},h.prototype._handlePalette=function(e){this._bitmapInfo.palette=e},h.prototype._simpleTransparency=function(){this._metaData.alpha=!0},h.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},h.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},h.prototype._complete=function(e){if(this.errord)return;let t;try{let i=c.dataToBitMap(e,this._bitmapInfo);t=l(i,this._bitmapInfo,this._options.skipRescale),i=null}catch(e){return void this._handleError(e)}this.emit("parsed",t)}},4346:(e,t,i)=>{"use strict";let r=!0,n=i(3106),s=i(9874);n.deflateSync||(r=!1);let a=i(1402),o=i(6479),c=i(336),l=i(5913),h=i(4721);e.exports=function(e,t){if(!r)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let i,u,d,p=[],f=new a(e),g=new c(t,{read:f.read.bind(f),error:function(e){i=e},metadata:function(e){u=e},gamma:function(e){d=e},palette:function(e){u.palette=e},transColor:function(e){u.transColor=e},inflateData:function(e){p.push(e)},simpleTransparency:function(){u.alpha=!0}});if(g.start(),f.process(),i)throw i;let m,b=Buffer.concat(p);if(p.length=0,u.interlace)m=n.inflateSync(b);else{let e=(1+(u.width*u.bpp*u.depth+7>>3))*u.height;m=s(b,{chunkSize:e,maxLength:e})}if(b=null,!m||!m.length)throw new Error("bad png - invalid inflate data response");let y=o.process(m,u);b=null;let A=l.dataToBitMap(y,u);y=null;let _=h(A,u,t.skipRescale);return u.data=_,u.gamma=d||0,u}},336:(e,t,i)=>{"use strict";let r=i(6402),n=i(7613),s=e.exports=function(e,t){this._options=e,e.checkCRC=!1!==e.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[r.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[r.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[r.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[r.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[r.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[r.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=t.read,this.error=t.error,this.metadata=t.metadata,this.gamma=t.gamma,this.transColor=t.transColor,this.palette=t.palette,this.parsed=t.parsed,this.inflateData=t.inflateData,this.finished=t.finished,this.simpleTransparency=t.simpleTransparency,this.headersFinished=t.headersFinished||function(){}};s.prototype.start=function(){this.read(r.PNG_SIGNATURE.length,this._parseSignature.bind(this))},s.prototype._parseSignature=function(e){let t=r.PNG_SIGNATURE;for(let i=0;i<t.length;i++)if(e[i]!==t[i])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},s.prototype._parseChunkBegin=function(e){let t=e.readUInt32BE(0),i=e.readUInt32BE(4),s="";for(let t=4;t<8;t++)s+=String.fromCharCode(e[t]);let a=Boolean(32&e[4]);if(this._hasIHDR||i===r.TYPE_IHDR){if(this._crc=new n,this._crc.write(Buffer.from(s)),this._chunks[i])return this._chunks[i](t);a?this.read(t+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+s))}else this.error(new Error("Expected IHDR on beggining"))},s.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},s.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},s.prototype._parseChunkEnd=function(e){let t=e.readInt32BE(0),i=this._crc.crc32();this._options.checkCRC&&i!==t?this.error(new Error("Crc error - "+t+" - "+i)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},s.prototype._handleIHDR=function(e){this.read(e,this._parseIHDR.bind(this))},s.prototype._parseIHDR=function(e){this._crc.write(e);let t=e.readUInt32BE(0),i=e.readUInt32BE(4),n=e[8],s=e[9],a=e[10],o=e[11],c=e[12];if(8!==n&&4!==n&&2!==n&&1!==n&&16!==n)return void this.error(new Error("Unsupported bit depth "+n));if(!(s in r.COLORTYPE_TO_BPP_MAP))return void this.error(new Error("Unsupported color type"));if(0!==a)return void this.error(new Error("Unsupported compression method"));if(0!==o)return void this.error(new Error("Unsupported filter method"));if(0!==c&&1!==c)return void this.error(new Error("Unsupported interlace method"));this._colorType=s;let l=r.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:t,height:i,depth:n,interlace:Boolean(c),palette:Boolean(s&r.COLORTYPE_PALETTE),color:Boolean(s&r.COLORTYPE_COLOR),alpha:Boolean(s&r.COLORTYPE_ALPHA),bpp:l,colorType:s}),this._handleChunkEnd()},s.prototype._handlePLTE=function(e){this.read(e,this._parsePLTE.bind(this))},s.prototype._parsePLTE=function(e){this._crc.write(e);let t=Math.floor(e.length/3);for(let i=0;i<t;i++)this._palette.push([e[3*i],e[3*i+1],e[3*i+2],255]);this.palette(this._palette),this._handleChunkEnd()},s.prototype._handleTRNS=function(e){this.simpleTransparency(),this.read(e,this._parseTRNS.bind(this))},s.prototype._parseTRNS=function(e){if(this._crc.write(e),this._colorType===r.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(e.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(let t=0;t<e.length;t++)this._palette[t][3]=e[t];this.palette(this._palette)}this._colorType===r.COLORTYPE_GRAYSCALE&&this.transColor([e.readUInt16BE(0)]),this._colorType===r.COLORTYPE_COLOR&&this.transColor([e.readUInt16BE(0),e.readUInt16BE(2),e.readUInt16BE(4)]),this._handleChunkEnd()},s.prototype._handleGAMA=function(e){this.read(e,this._parseGAMA.bind(this))},s.prototype._parseGAMA=function(e){this._crc.write(e),this.gamma(e.readUInt32BE(0)/r.GAMMA_DIVISION),this._handleChunkEnd()},s.prototype._handleIDAT=function(e){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-e,this._parseIDAT.bind(this,e))},s.prototype._parseIDAT=function(e,t){if(this._crc.write(t),this._colorType===r.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(t);let i=e-t.length;i>0?this._handleIDAT(i):this._handleChunkEnd()},s.prototype._handleIEND=function(e){this.read(e,this._parseIEND.bind(this))},s.prototype._parseIEND=function(e){this._crc.write(e),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}},2122:(e,t,i)=>{"use strict";let r=i(4346),n=i(1497);t.read=function(e,t){return r(e,t||{})},t.write=function(e,t){return n(e,t)}},9904:(e,t,i)=>{"use strict";let r=i(9023),n=i(2203),s=i(7089),a=i(8),o=i(2122),c=t.O=function(e){n.call(this),e=e||{},this.width=0|e.width,this.height=0|e.height,this.data=this.width>0&&this.height>0?Buffer.alloc(4*this.width*this.height):null,e.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new s(e),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(e){this.data=e,this.emit("parsed",e)}.bind(this)),this._packer=new a(e),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};r.inherits(c,n),c.sync=o,c.prototype.pack=function(){return this.data&&this.data.length?(process.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},c.prototype.parse=function(e,t){if(t){let e,i;e=function(e){this.removeListener("error",i),this.data=e,t(null,this)}.bind(this),i=function(i){this.removeListener("parsed",e),t(i,null)}.bind(this),this.once("parsed",e),this.once("error",i)}return this.end(e),this},c.prototype.write=function(e){return this._parser.write(e),!0},c.prototype.end=function(e){this._parser.end(e)},c.prototype._metadata=function(e){this.width=e.width,this.height=e.height,this.emit("metadata",e)},c.prototype._gamma=function(e){this.gamma=e},c.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},c.bitblt=function(e,t,i,r,n,s,a,o){if(r|=0,n|=0,s|=0,a|=0,o|=0,(i|=0)>e.width||r>e.height||i+n>e.width||r+s>e.height)throw new Error("bitblt reading outside image");if(a>t.width||o>t.height||a+n>t.width||o+s>t.height)throw new Error("bitblt writing outside image");for(let c=0;c<s;c++)e.data.copy(t.data,(o+c)*t.width+a<<2,(r+c)*e.width+i<<2,(r+c)*e.width+i+n<<2)},c.prototype.bitblt=function(e,t,i,r,n,s,a){return c.bitblt(this,e,t,i,r,n,s,a),this},c.adjustGamma=function(e){if(e.gamma){for(let t=0;t<e.height;t++)for(let i=0;i<e.width;i++){let r=e.width*t+i<<2;for(let t=0;t<3;t++){let i=e.data[r+t]/255;i=Math.pow(i,1/2.2/e.gamma),e.data[r+t]=Math.round(255*i)}}e.gamma=0}},c.prototype.adjustGamma=function(){c.adjustGamma(this)}},9874:(e,t,i)=>{"use strict";let r=i(2613).ok,n=i(3106),s=i(9023),a=i(181).kMaxLength;function o(e){if(!(this instanceof o))return new o(e);e&&e.chunkSize<n.Z_MIN_CHUNK&&(e.chunkSize=n.Z_MIN_CHUNK),n.Inflate.call(this,e),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,e&&null!=e.maxLength&&(this._maxLength=e.maxLength)}function c(e,t){t&&process.nextTick(t),e._handle&&(e._handle.close(),e._handle=null)}function l(e,t){return function(e,t){if("string"==typeof t&&(t=Buffer.from(t)),!(t instanceof Buffer))throw new TypeError("Not a string or buffer");let i=e._finishFlushFlag;return null==i&&(i=n.Z_FINISH),e._processChunk(t,i)}(new o(t),e)}o.prototype._processChunk=function(e,t,i){if("function"==typeof i)return n.Inflate._processChunk.call(this,e,t,i);let s,o,l=this,h=e&&e.length,u=this._chunkSize-this._offset,d=this._maxLength,p=0,f=[],g=0;function m(e,t){if(l._hadError)return;let i=u-t;if(r(i>=0,"have should not go down"),i>0){let e=l._buffer.slice(l._offset,l._offset+i);if(l._offset+=i,e.length>d&&(e=e.slice(0,d)),f.push(e),g+=e.length,d-=e.length,0===d)return!1}return(0===t||l._offset>=l._chunkSize)&&(u=l._chunkSize,l._offset=0,l._buffer=Buffer.allocUnsafe(l._chunkSize)),0===t&&(p+=h-e,h=e,!0)}this.on("error",(function(e){s=e})),r(this._handle,"zlib binding closed");do{o=this._handle.writeSync(t,e,p,h,this._buffer,this._offset,u),o=o||this._writeState}while(!this._hadError&&m(o[0],o[1]));if(this._hadError)throw s;if(g>=a)throw c(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+a.toString(16)+" bytes");let b=Buffer.concat(f,g);return c(this),b},s.inherits(o,n.Inflate),e.exports=t=l,t.Inflate=o,t.createInflate=function(e){return new o(e)},t.inflateSync=l},1402:e=>{"use strict";let t=e.exports=function(e){this._buffer=e,this._reads=[]};t.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t})},t.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let e=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=e.length||e.allowLess))break;{this._reads.shift();let t=this._buffer;this._buffer=t.slice(e.length),e.func.call(this,t.slice(0,e.length))}}if(this._reads.length>0)throw new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw new Error("unrecognised content at end of stream")}},2613:e=>{"use strict";e.exports=require("assert")},181:e=>{"use strict";e.exports=require("buffer")},7194:e=>{"use strict";e.exports=require("dgram")},1943:e=>{"use strict";e.exports=require("fs/promises")},9278:e=>{"use strict";e.exports=require("net")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},9023:e=>{"use strict";e.exports=require("util")},3106:e=>{"use strict";e.exports=require("zlib")},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4326:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=void 0;const r=i(1635),n=i(9967),s=r.__importDefault(i(1943)),a=i(360),o=i(4044),c=r.__importDefault(i(6928));let l,h=!1;t.runEntrypoint=function(e,t){Promise.resolve().then((async()=>{if(h)throw new Error("runEntrypoint can only be called once");h=!0;const i=process.env.MODULE_MANIFEST;if(!i)throw new Error("Module initialise is missing MODULE_MANIFEST");const r=await s.default.readFile(i),u=JSON.parse(r.toString());if(u.runtime?.api!==n.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!u.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let d=u.runtime.apiVersion;if("0.0.0"===d)try{const e=await s.default.readFile(c.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(d=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const p=process.env.CONNECTION_ID;if("string"!=typeof p||!p)throw new Error("Module initialise is missing CONNECTION_ID");const f=process.env.VERIFICATION_TOKEN;if("string"!=typeof f||!f)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const g=new o.IpcWrapper({},(e=>{process.send(e)}),5e3);process.once("message",(e=>{g.receivedMessage(e)})),l=new e((0,a.literal)({id:p,upgradeScripts:t,_isInstanceBaseProps:!0})),g.sendWithCb("register",{apiVersion:d,connectionId:p,verificationToken:f}).then((()=>{console.log("Module-host accepted registration")}),(e=>{console.error("Module registration failed",e),process.exit(11)}))})).catch((e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)}))}},6160:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var r=i(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return r.TCPHelper}});var n=i(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return n.TelnetHelper}});var s=i(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return s.UDPHelper}})},8895:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const r=i(1635).__importDefault(i(9278)),n=i(228),s=i(1400);class a extends n.EventEmitter{#e;#t;_socket;#i;#r=!1;#n=!1;#s=!1;#a;#o;#c;get isConnected(){return this.#r}get isConnecting(){return this.#n}get isDestroyed(){return this.#s}constructor(e,t,i){super(),this.#e=e,this.#t=t,this.#i={reconnect_interval:2e3,reconnect:!0,...i},this._socket=new r.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",(e=>{this.#n=!1,this.#r=!1,this.#i.reconnect&&this.#l(),this.#h(s.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this._socket.on("ready",(()=>{this.#r=!0,this.#n=!1,this.#h(s.InstanceStatus.Ok),this.emit("connect")})),this._socket.on("end",(()=>{this.#r=!1,this.#h(s.InstanceStatus.Disconnected),!this.#n&&this.#i.reconnect&&this.#l(),this.emit("end")})),this._socket.on("data",(e=>this.emit("data",e))),this._socket.on("drain",(()=>this.emit("drain"))),setImmediate((()=>{this.#s||this.connect()})),this.#c=setTimeout((()=>{this.#c=void 0,this.#s||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}connect(){if(this.#s)throw new Error("Cannot connect destroyed socket");return!this.#n&&(this.#n=!0,this._socket.connect(this.#t,this.#e),!0)}async send(e){if(this.#s||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#r)return!1;try{return new Promise(((t,i)=>{this._socket.write(e,(e=>{e?i(e):t(!0)}))}))}catch(e){this.#r=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#h(s.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#s=!0,void 0!==this.#o&&(clearTimeout(this.#o),this.#o=void 0),void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#l(){void 0!==this.#o&&clearTimeout(this.#o),this.#o=setTimeout((()=>{this.#o=void 0,this.#h(s.InstanceStatus.Connecting),this.connect()}),this.#i.reconnect_interval)}#h(e,t){this.#a!=e&&(this.#a=e,this.emit("status_change",e,t))}}t.TCPHelper=a},1118:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const r=i(1635).__importDefault(i(228)),n=i(2203),s=i(8895);class a extends r.default{#u;#d;#c;get isConnected(){return this.#u.isConnected}get isConnecting(){return this.#u.isConnecting}get isDestroyed(){return this.#u.isDestroyed}constructor(e,t,i){super(),this.#u=new s.TCPHelper(e,t,i),this.#d=new o,this.#u._socket.pipe(this.#d),this.#u.on("connect",(()=>this.emit("connect"))),this.#u.on("end",(()=>this.emit("end"))),this.#u.on("error",(e=>this.emit("error",e))),this.#u.on("status_change",((e,t)=>this.emit("status_change",e,t))),this.#d.on("iac",((e,t)=>this.emit("iac",e,t))),this.#d.on("sb",(e=>this.emit("sb",e))),this.#d.on("data",(e=>this.emit("data",e))),this.#d.on("drain",(()=>this.emit("drain"))),this.#c=setTimeout((()=>{this.#c=void 0,this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)}),5e3)}connect(){return this.#u.connect()}async send(e){return this.#u.send(e)}destroy(){this.#u.destroy(),void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this.#d.removeAllListeners(),this.#d.destroy()}}t.TelnetHelper=a;class o extends n.Transform{#p;#f;#g;constructor(e){super(e),this.#p=Buffer.alloc(0),this.#f=Buffer.alloc(0),this.#g=0}_transform(e,t,i){for(let t=0;t<e.length;++t)this.#m(e[t]);const r=this.#b();r.length&&this.push(r),i()}#m(e){if(0===this.#g){if(255===e)return void(this.#g=255);this.#p=Buffer.concat([this.#p,Buffer.from([e])])}else if(255===this.#g)switch(e){case 250:case 251:case 252:case 253:case 254:this.#g=e;break;default:this.#g=0}else{if(this.#g>=251&&this.#g<=254){let t;switch(this.#g){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#g=0)}if(250===this.#g){if(240===e)return this.emit("sb",this.#f),this.#g=0,void(this.#f=Buffer.alloc(0));this.#f=Buffer.concat([this.#f,Buffer.from([e])])}}}#b(){const e=this.#p;return this.#p=Buffer.alloc(0),e}}},6259:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const r=i(1635).__importDefault(i(7194)),n=i(228),s=i(1400);class a extends n.EventEmitter{#e;#t;#y;#i;#s=!1;#a;#c;get isDestroyed(){return this.#s}constructor(e,t,i){super(),this.#e=e,this.#t=t,this.#i={...i},this.#y=r.default.createSocket("udp4");try{this.#y.bind(this.#i.bind_port||0,this.#i.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#i.bind_ip||"0.0.0.0"}:${this.#i.bind_port||0}`)}this.#i.broadcast&&this.#y.setBroadcast(!0),void 0!==this.#i.ttl&&this.#y.setTTL(this.#i.ttl),void 0!==this.#i.multicast_ttl&&this.#y.setMulticastTTL(this.#i.multicast_ttl),this.#y.on("error",(e=>{this.#h(s.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this.#y.on("listening",(()=>{this.#i.multicast_interface&&this.#y.setMulticastInterface(this.#i.multicast_interface),this.#h(s.InstanceStatus.Ok),this.emit("listening")})),this.#y.on("message",(e=>this.emit("data",e))),this.#c=setTimeout((()=>{this.#s||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}async send(e){if(this.#s)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise(((t,i)=>{this.#y.send(e,this.#t,this.#e,(e=>{e?i(e):t()}))}))}destroy(){this.#s=!0,void 0!==this.#c&&(clearTimeout(this.#c),this.#c=void 0),this.#y.removeAllListeners(),this.#y.close(),this.removeAllListeners()}#h(e,t){this.#a!=e&&(this.#a=e,this.emit("status_change",e,t))}}t.UDPHelper=a},4044:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const r=i(1635),n=i(360),s=r.__importDefault(i(6022));t.IpcWrapper=class{#A;#_;#I;#v=1;#w=new Map;constructor(e,t,i){this.#A=e,this.#_=t,this.#I=i}async sendWithCb(e,t,i,r=0){r<=0&&(r=this.#I);const n={timeout:void 0,resolve:()=>null,reject:()=>null},a=new Promise(((e,t)=>{n.resolve=e,n.reject=t}));this.#v>268435456&&(this.#v=1);const o=this.#v++;this.#w.set(o,n),this.#_({direction:"call",name:String(e),payload:s.default.stringify(t),callbackId:o});const c=new Error("Call timed out");return n.timeout=setTimeout((()=>{n.reject(i?i():c),this.#w.delete(o)}),r),a}sendWithNoCb(e,t){this.#_({direction:"call",name:String(e),payload:s.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#A[e.name];if(!t)return void(e.callbackId&&this.#_({direction:"response",callbackId:e.callbackId,success:!1,payload:s.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?s.default.parse(e.payload):void 0).then((t=>{e.callbackId&&this.#_({direction:"response",callbackId:e.callbackId,success:!0,payload:s.default.stringify(t)})}),(t=>{e.callbackId&&this.#_({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):s.default.stringify(t)})}));break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#w.get(e.callbackId);if(this.#w.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const i=e.payload?s.default.parse(e.payload):void 0;if(e.success)t.resolve(i);else{let e=i;i&&"object"==typeof i&&"message"in i&&(e=new Error(i.message),i.stack&&(e.stack=i.stack)),t.reject(e)}break}default:(0,n.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},6278:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const r=i(1635);r.__exportStar(i(9077),t),r.__exportStar(i(2018),t),r.__exportStar(i(4581),t);var n=i(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return n.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return n.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return n.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return n.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return n.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return n.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return n.assertNever}}),r.__exportStar(i(6160),t);var s=i(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return s.runEntrypoint}})},4289:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const r=i(2593);function n(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#E;#k;#O;#C=new Map;#S=new Map;constructor(e,t,i){this.#E=e,this.#k=t,this.#O=i}async handleExecuteAction(e){const t=this.#C.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},i)}handleUpdateActions(e){for(const[t,i]of Object.entries(e)){const e=this.#S.get(t);if(e){const t=this.#C.get(e.actionId);if(t?.unsubscribe){const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(n(e),i)).catch((t=>{this.#O("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!i||i.disabled)this.#S.delete(t);else{this.#S.set(t,i);const e=this.#C.get(i.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#E({text:e,controlId:i.controlId,actionInstanceId:i.id,feedbackInstanceId:void 0})).text};Promise.resolve(e.subscribe(n(i),t)).catch((e=>{this.#O("error",`Action subscribe failed: ${JSON.stringify(i)} - ${e?.message??e} ${e?.stack}`)}))}}}}async handleLearnAction(e){const t=this.#C.get(e.action.actionId);if(t&&t.learn){const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},i)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#C.clear();for(const[i,n]of Object.entries(e))n&&(t.push({id:i,name:n.name,description:n.description,options:(0,r.serializeIsVisibleFn)(n.options),hasLearn:!!n.learn,learnTimeout:n.learnTimeout}),this.#C.set(i,n));this.#k({actions:t})}_getAllActions(){return Array.from(this.#S.values()).map((e=>({id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options})))}subscribeActions(e){let t=Array.from(this.#S.values());const i=new Set(e);i.size&&(t=t.filter((e=>i.has(e.actionId))));for(const e of t){const t=this.#C.get(e.actionId);if(t?.subscribe){const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.subscribe(n(e),i)).catch((t=>{this.#O("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeActions(e){let t=Array.from(this.#S.values());const i=new Set(e);i.size&&(t=t.filter((e=>i.has(e.actionId))));for(const e of t){const t=this.#C.get(e.actionId);if(t&&t.unsubscribe){const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(n(e),i)).catch((t=>{this.#O("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInstanceBaseProps=t.serializeIsVisibleFn=void 0,t.serializeIsVisibleFn=function(e){return(e??[]).map((e=>"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisible:void 0}:{...e,isVisibleFn:void 0}))},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},8039:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const r=i(1635),n=i(2593),s=r.__importDefault(i(7e3));function a(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#E;#T;#N;#O;#P=new Map;#M=new Map;#x=new Map;#R=new Map;#D;get parseVariablesContext(){return this.#D}constructor(e,t,i,r){this.#E=e,this.#T=t,this.#N=i,this.#O=r}getDefinitionIds(){return Array.from(this.#P.keys())}getInstanceIds(){return Array.from(this.#M.keys())}handleUpdateFeedbacks(e){for(const[t,i]of Object.entries(e)){const e=this.#M.get(t);if(e){const t=this.#P.get(e.feedbackId);if(t?.unsubscribe){const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(a(t.type,e),i)).catch((t=>{this.#O("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!i||i.disabled)this.#M.delete(t);else{this.#M.set(t,{...i,referencedVariables:null});const e=this.#P.get(i.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#E({text:e,controlId:i.controlId,actionInstanceId:void 0,feedbackInstanceId:i.id})).text};Promise.resolve(e.subscribe(a(e.type,i),t)).catch((e=>{this.#O("error",`Feedback subscribe failed: ${JSON.stringify(i)} - ${e?.message??e} ${e?.stack}`)}))}this.#L(t)}}}async handleLearnFeedback(e){const t=this.#P.get(e.feedback.feedbackId);if(t&&t.learn){const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},i)}}return{options:void 0}}handleVariablesChanged(e){if(!e.variablesIds.length)return;const t=new Set(e.variablesIds);for(const t of this.#R.values())for(const i of e.variablesIds)t.changedVariables.add(i);const i=new Set;for(const e of this.#M.values())if(!this.#R.has(e.id)&&e.referencedVariables)for(const r of e.referencedVariables)if(t.has(r)){i.add(e.id);break}for(const e of i)setImmediate((()=>{this.#L(e)}))}#L(e){const t=this.#R.get(e);if(t)return void(t.needsRecheck=!0);const i=this.#M.get(e);if(!i)return;const r=i,n={needsRecheck:!1,changedVariables:new Set};this.#R.set(e,n),Promise.resolve().then((async()=>{const t=this.#P.get(r.feedbackId);let i;const n=new Set;if(t){this.#D=`Feedback ${r.feedbackId} (${e})`;const s={parseVariablesInString:async t=>{const i=await this.#E({text:t,controlId:r.controlId,actionInstanceId:void 0,feedbackInstanceId:e});if(i.variableIds&&i.variableIds.length)for(const e of i.variableIds)n.add(e);return i.text}};i="boolean"===t.type?t.callback({...a("boolean",r),type:"boolean"},s):t.callback({...a("advanced",r),type:"advanced",image:r.image},s),this.#D=void 0}const s=await i;this.#x.set(e,{id:e,controlId:r.controlId,value:s}),this.#F(),r.referencedVariables=n.size>0?Array.from(n):null})).catch((e=>{console.error(`Feedback check failed: ${JSON.stringify(r)} - ${e?.message??e} ${e?.stack}`)})).finally((()=>{this.#D=void 0,this.#R.delete(e);let t=!1;if(r.referencedVariables)for(const e of r.referencedVariables)if(n.changedVariables.has(e)){t=!0;break}(t||n.needsRecheck)&&setImmediate((()=>{this.#L(e)}))}))}#F=(0,s.default)((()=>{const e=this.#x;this.#x=new Map,e.size>0&&this.#T({values:Array.from(e.values())})}),{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#P.clear();for(const[i,r]of Object.entries(e))r&&(t.push({id:i,name:r.name,description:r.description,options:(0,n.serializeIsVisibleFn)(r.options),type:r.type,defaultStyle:"boolean"===r.type?r.defaultStyle:void 0,hasLearn:!!r.learn,learnTimeout:r.learnTimeout,showInvert:"boolean"===r.type&&r.showInvert}),this.#P.set(i,r));this.#N({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,i]of this.#M.entries())this.#P.get(i.feedbackId)&&(0===t.size||t.has(i.feedbackId))&&this.#L(e)}checkFeedbacksById(e){for(const t of e)this.#L(t)}_getAllFeedbacks(){return Array.from(this.#M.values()).map((e=>({id:e.id,feedbackId:e.feedbackId,controlId:e.controlId,options:e.options})))}subscribeFeedbacks(e){let t=Array.from(this.#M.values());const i=new Set(e);i.size&&(t=t.filter((e=>i.has(e.feedbackId))));for(const e of t){const t=this.#P.get(e.feedbackId);if(t?.subscribe){const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.subscribe(a(t.type,e),i)).catch((t=>{this.#O("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeFeedbacks(e){let t=Array.from(this.#M.values());const i=new Set(e);i.size&&(t=t.filter((e=>i.has(e.feedbackId))));for(const e of t){const t=this.#P.get(e.feedbackId);if(t&&t.unsubscribe){const i={parseVariablesInString:async t=>(await this.#E({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(a(t.type,e),i)).catch((t=>{this.#O("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},1706:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=void 0;const r=i(360);function n(e){return JSON.parse(JSON.stringify(e))}t.runThroughUpgradeScripts=function(e,t,i,s,a,o){const c=new Map,l=e=>{let t=c.get(e);return t||(t={actions:[],feedbacks:[],config:!1},c.set(e,t)),t};for(const t of Object.values(e)){const e=t?.upgradeIndex??i;t&&"number"==typeof e&&l(e).actions.push(t.id)}for(const e of Object.values(t)){const t=e?.upgradeIndex??i;e&&"number"==typeof t&&l(t).feedbacks.push(e.id)}if(!o)for(let e=i??-1;e<s.length;e++)l(e).config=!0;const h={},u={};let d;if(c.size>0){const o=Array.from(c.keys()).sort(),l=Math.min(...o,i??-1)+1,p=[],f=[],g=s.length;for(let i=l;i<g;i++){const o=c.get(i-1);o&&(p.push(...o.actions),f.push(...o.feedbacks));const l=!!o?.config;if(!l&&0===p.length&&0===f.length)continue;const g=d??a,m=(0,s[i])({currentConfig:n(g)},{config:l?g:null,actions:p.map((t=>{const i=e[t];if(i)return(0,r.literal)({id:i.id,controlId:i.controlId,actionId:i.actionId,options:void 0!==i.options?n(i.options):{}})})).filter((e=>!!e)),feedbacks:f.map((e=>{const i=t[e];if(i)return(0,r.literal)({id:i.id,controlId:i.controlId,feedbackId:i.feedbackId,options:void 0!==i.options?n(i.options):{},isInverted:i.isInverted})})).filter((e=>!!e))});l&&m.updatedConfig&&(d=m.updatedConfig);for(const t of m.updatedActions)if(t){const i=e[t.id];i&&(i.actionId=t.actionId,i.options=t.options,u[t.id]=i)}for(const e of m.updatedFeedbacks)if(e){const i=t[e.id];i&&(i.feedbackId=e.feedbackId,i.options=e.options,h[e.id]={...i,style:h[e.id]?.style??e.style,isInverted:e.isInverted??!1})}}for(const[t,i]of Object.entries(e))u[t]||"number"!=typeof i?.upgradeIndex||(u[t]=i);for(const[e,i]of Object.entries(t))h[e]||"number"!=typeof i?.upgradeIndex||(h[e]=i)}return{updatedActions:u,updatedFeedbacks:h,updatedConfig:d}}},9077:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=void 0;const r=i(1635).__importDefault(i(7281));t.validateManifest=function(e){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'");if(!(0,r.default)(e)){const e=r.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}}},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1649:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const r=i(1635),n=i(360),s=r.__importDefault(i(3290)),a=i(2593),o=i(1706),c=i(8039),l=i(4044),h=i(4289),u=i(2365);t.InstanceBase=class{#j;#U;id;#B=new s.default({concurrency:1});#V=!1;#G=!1;#H={};#Y;#Q;#z=new Map;#W=new Map;#$=new Map;#i;#J;get instanceOptions(){return this.#i}get label(){return this.#J}constructor(e){if(!(0,a.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.createSharedUdpSocket=this.createSharedUdpSocket.bind(this),this.#i={disableVariableValidation:!1},this.#j=new l.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:this._handleVariablesChanged.bind(this),sharedUdpSocketMessage:this._handleSharedUdpSocketMessage.bind(this),sharedUdpSocketError:this._handleSharedUdpSocketError.bind(this)},(e=>{process.send(e)}),5e3),process.on("message",(e=>{this.#j.receivedMessage(e)})),this.#Y=new h.ActionManager((async e=>this.#j.sendWithCb("parseVariablesInString",e)),(e=>this.#j.sendWithNoCb("setActionDefinitions",e)),this.log.bind(this)),this.#Q=new c.FeedbackManager((async e=>this.#j.sendWithCb("parseVariablesInString",e)),(e=>this.#j.sendWithNoCb("updateFeedbackValues",e)),(e=>this.#j.sendWithNoCb("setFeedbackDefinitions",e)),this.log.bind(this)),this.#U=e.upgradeScripts,this.id=e.id,this.#J=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#B.add((async()=>{if(this.#V)throw new Error("Already initialized");const t=e.actions,i=e.feedbacks;if(this.#H=e.config,this.#J=e.label,e.isFirstInit){const t={},i=this.getConfigFields();for(const e of i)"default"in e&&(t[e.id]=e.default);this.#H=t,this.saveConfig(this.#H),e.lastUpgradeIndex=this.#U.length-1}const{updatedActions:r,updatedFeedbacks:n,updatedConfig:s}=(0,o.runThroughUpgradeScripts)(t,i,e.lastUpgradeIndex,this.#U,this.#H,!1);this.#H=s??this.#H;const a=this.#j.sendWithCb("upgradedItems",{updatedActions:r,updatedFeedbacks:n});try{await this.init(this.#H,!!e.isFirstInit),this.#V=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}finally{await a}return setImmediate((()=>{this._handleUpdateActions({actions:t},!0).catch((e=>{this.log("error",`Receive actions failed: ${e}`)})),this._handleUpdateFeedbacks({feedbacks:i},!0).catch((e=>{this.log("error",`Receive feedbacks failed: ${e}`)}))})),{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#U.length-1,updatedConfig:this.#H}}))}async _handleDestroy(){await this.#B.add((async()=>{if(!this.#V)throw new Error("Not initialized");await this.destroy(),this.#V=!1}))}async _handleConfigUpdateAndLabel(e){await this.#B.add((async()=>{if(!this.#V)throw new Error("Not initialized");this.#J=e.label,this.#H=e.config,await this.configUpdated(this.#H)}))}async _handleExecuteAction(e){return this.#Y.handleExecuteAction(e)}async _handleUpdateFeedbacks(e,t){if(!t){const t=(0,o.runThroughUpgradeScripts)({},e.feedbacks,null,this.#U,this.#H,!0);this.#j.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded feedbacks: ${e}`)}))}this.#Q.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e,t){if(!t){const t=(0,o.runThroughUpgradeScripts)(e.actions,{},null,this.#U,this.#H,!0);this.#j.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded actions: ${e}`)}))}this.#Y.handleUpdateActions(e.actions)}async _handleGetConfigFields(e){return{fields:(0,a.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#Y.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#Q.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#G)return}else if(!this.#G)return;if(!this.handleStartStopRecordActions)throw this.#G=!1,new Error("Recording actions is not supported by this module!");this.#G=e.recording,this.handleStartStopRecordActions(this.#G)}async _handleVariablesChanged(e){this.#Q.handleVariablesChanged(e)}async _handleSharedUdpSocketMessage(e){for(const t of this.#z.values())t.handleId===e.handleId&&t.receiveSocketMessage(e)}async _handleSharedUdpSocketError(e){for(const t of this.#z.values())t.handleId===e.handleId&&t.receiveSocketError(e.error)}saveConfig(e){this.#H=e,this.#j.sendWithNoCb("saveConfig",{config:e})}setActionDefinitions(e){this.#Y.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#Q.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[i,r]of Object.entries(e))r&&t.push({...r,id:i});this.#j.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],i=[];this.#W.clear();for(const r of e)t.push({id:r.variableId,name:r.name}),this.#W.set(r.variableId,r),this.#$.has(r.variableId)||(this.#$.set(r.variableId,""),i.push({id:r.variableId,value:""}));if(!this.#i.disableVariableValidation){const e=new Set(this.#W.keys());for(const t of this.#$.keys())e.has(t)||(this.#$.delete(t),i.push({id:t,value:void 0}))}this.#j.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:i})}setVariableValues(e){const t=[];for(const[i,r]of Object.entries(e))this.#i.disableVariableValidation?(void 0===r?this.#$.delete(i):this.#$.set(i,r),t.push({id:i,value:r})):this.#W.has(i)?(this.#$.set(i,r??""),t.push({id:i,value:r??""})):t.push({id:i,value:void 0});this.#j.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#$.get(e)}async parseVariablesInString(e){const t=this.#Q.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),(await this.#j.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text}checkFeedbacks(...e){this.#Q.checkFeedbacks(e)}checkFeedbacksById(...e){this.#Q.checkFeedbacksById(e)}_getAllActions(){return this.#Y._getAllActions()}subscribeActions(...e){this.#Y.subscribeActions(e)}unsubscribeActions(...e){this.#Y.unsubscribeActions(e)}_getAllFeedbacks(){return this.#Q._getAllFeedbacks()}subscribeFeedbacks(...e){this.#Q.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#Q.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#G)throw new Error("Not currently recording actions");this.#j.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options,delay:e.delay})}setCustomVariableValue(e,t){this.#j.sendWithNoCb("setCustomVariable",{customVariableId:e,value:t})}oscSend(e,t,i,r){this.#j.sendWithNoCb("send-osc",(0,n.literal)({host:e,port:t,path:i,args:r}))}updateStatus(e,t){this.#j.sendWithNoCb("set-status",(0,n.literal)({status:e,message:t??null}))}log(e,t){this.#j.sendWithNoCb("log-message",(0,n.literal)({level:e,message:t}))}createSharedUdpSocket(e,t){const i="string"==typeof e?{type:e}:e,r=new u.SharedUdpSocketImpl(this.#j,this.#z,i);return t&&r.on("message",t),r}}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1400:(e,t)=>{"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,function(e){e.Ok="ok",e.Connecting="connecting",e.Disconnected="disconnected",e.ConnectionFailure="connection_failure",e.BadConfig="bad_config",e.UnknownError="unknown_error",e.UnknownWarning="unknown_warning",e.AuthenticationFailure="authentication_failure"}(i||(t.InstanceStatus=i={})),function(e){e.IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",e.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",e.BOOLEAN="/^(true|false|0|1)$/i",e.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",e.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",e.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",e.FLOAT="/^([0-9]*\\.)?[0-9]+$/",e.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",e.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",e.NUMBER="/^\\d+$/",e.SIGNED_NUMBER="/^[+-]?\\d+$/",e.SOMETHING="/^.+$/",e.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"}(r||(t.Regex=r={}))},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2018:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(1635);r.__exportStar(i(3730),t),r.__exportStar(i(1649),t),r.__exportStar(i(7386),t),r.__exportStar(i(1400),t),r.__exportStar(i(8983),t),r.__exportStar(i(8104),t),r.__exportStar(i(3258),t),r.__exportStar(i(131),t),r.__exportStar(i(3371),t),r.__exportStar(i(9786),t),r.__exportStar(i(6132),t)},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2365:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedUdpSocketImpl=void 0;const r=i(1635).__importDefault(i(228)),n=i(360);class s extends r.default{#j;#Z;#i;get handleId(){return this.boundState?.handleId}get portNumber(){return this.boundState?.portNumber}get boundState(){return this.#g&&"object"==typeof this.#g?this.#g:void 0}#g="pending";constructor(e,t,i){super(),this.#j=e,this.#Z=t,this.#i={...i}}bind(e,t,i){if(this.#g&&"object"==typeof this.#g)throw new Error("Socket is already bound");switch(this.#g){case"fatalError":throw new Error("Socket has encountered fatal error");case"binding":throw new Error("Socket is already bound");case"closed":throw new Error("Socket is closing");case"pending":break;default:throw(0,n.assertNever)(this.#g),new Error("Invalid socket state")}this.#g="binding",i&&this.on("listening",i),this.#j.sendWithCb("sharedUdpSocketJoin",{family:this.#i.type,portNumber:e}).then((t=>{this.#g={portNumber:e,handleId:t},this.#Z.set(t,this),this.emit("listening")}),(e=>{this.#g="closed",this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}close(e){if(this.#g&&"object"==typeof this.#g);else switch(this.#g){case"fatalError":throw new Error("Socket has encountered fatal error");case"pending":case"closed":case"binding":throw new Error("Socket is not open");default:throw(0,n.assertNever)(this.#g),new Error("Invalid socket state")}const t=this.#g.handleId;this.#g="closed",e&&this.on("close",e),this.#j.sendWithCb("sharedUdpSocketLeave",{handleId:t}).then((()=>{this.#Z.delete(t),this.emit("close")}),(e=>{this.#Z.delete(t),this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}send(e,t,i,r,n,s){if("number"!=typeof t)throw new Error("Invalid arguments");if("number"==typeof i){if("number"!=typeof r||"string"!=typeof n)throw new Error("Invalid arguments");if(void 0!==s&&"number"!=typeof s)throw new Error("Invalid arguments");const a=this.#q(e,t,i);this.#X(a,r,n,s)}else{if("string"!=typeof i)throw new Error("Invalid arguments");{if(void 0!==r&&"function"!=typeof r)throw new Error("Invalid arguments");const n=this.#q(e,0,void 0);this.#X(n,t,i,r)}}}#q(e,t,i){let r;if("string"==typeof e)r=Buffer.from(e,"utf-8");else if(Buffer.isBuffer(e))r=e;else{if(Array.isArray(e))return Buffer.from(e);r=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return r.subarray(t,void 0!==i?i+t:void 0)}#X(e,t,i,r){if(!this.#g||"object"!=typeof this.#g)throw new Error("Socket is not open");this.#j.sendWithCb("sharedUdpSocketSend",{handleId:this.#g.handleId,message:e,address:i,port:t}).then((()=>{r?.()}),(e=>{this.emit("error",e instanceof Error?e:new Error(e))})).catch((()=>null))}receiveSocketMessage(e){try{this.emit("message",e.message,e.source)}catch(e){}}receiveSocketError(e){this.#g="fatalError";const t=this.boundState;t&&this.#Z.delete(t.handleId);try{this.emit("error",e)}catch(e){}}}t.SharedUdpSocketImpl=s},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=t.CreateConvertToBooleanFeedbackUpgradeScript=t.EmptyUpgradeScript=void 0,t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}),t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,i)=>{const r=[];for(const t of i.feedbacks){let i=e[t.feedbackId];if(!0===i&&(i={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),i){t.style||(t.style={});for(const[e,n]of Object.entries(i))void 0!==t.options[e]&&(t.style[n]=t.options[e],delete t.options[e],r.push(t))}}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:r}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,i)=>{const r=[];for(const t of i.feedbacks){const i=e[t.feedbackId];if("string"!=typeof i)continue;const n=t.options[i];void 0!==n&&(delete t.options[i],t.isInverted="true"===n||!0===n||Number(n)>0,r.push(t))}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:r}}}},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},360:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.assertNever=t.literal=void 0;const r=i(6284);function n(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,r.colord)(e).isValid()){const t=(0,r.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,i,r){let n=(255&e)<<16|(255&t)<<8|255&i;return r&&r>=0&&r<1&&(n+=16777216*Math.round(255*(1-r))),n},t.splitRgb=n,t.splitHsl=function(e){const t=n(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=n(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=n(e);return(0,r.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()}},7281:(e,t,i)=>{"use strict";e.exports=c,e.exports.default=c;const r={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"}},required:["name"]}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18"},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"},minItems:1},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{oneOf:[{$ref:"#/definitions/bonjourQuery"},{type:"array",items:{$ref:"#/definitions/bonjourQuery"}}]}},additionalProperties:!1}},additionalProperties:!1,required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"],definitions:{bonjourQuery:{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1}}},n={type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1},s=Object.prototype.hasOwnProperty,a=i(7169).A,o=new RegExp("","u");function c(e,{instancePath:t="",parentData:i,parentDataProperty:l,rootData:h=e}={}){let u=null,d=0;if(0===d){if(!e||"object"!=typeof e||Array.isArray(e))return c.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let i;if(void 0===e.id&&(i="id")||void 0===e.name&&(i="name")||void 0===e.shortname&&(i="shortname")||void 0===e.description&&(i="description")||void 0===e.version&&(i="version")||void 0===e.license&&(i="license")||void 0===e.repository&&(i="repository")||void 0===e.bugs&&(i="bugs")||void 0===e.maintainers&&(i="maintainers")||void 0===e.legacyIds&&(i="legacyIds")||void 0===e.runtime&&(i="runtime")||void 0===e.manufacturer&&(i="manufacturer")||void 0===e.products&&(i="products")||void 0===e.keywords&&(i="keywords"))return c.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:i},message:"must have required property '"+i+"'"}],!1;{const i=d;for(const i in e)if(!s.call(r.properties,i))return c.errors=[{instancePath:t,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:i},message:"must NOT have additional properties"}],!1;if(i===d){if(void 0!==e.$schema){const i=d;if("string"!=typeof e.$schema)return c.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var p=i===d}else p=!0;if(p){if(void 0!==e.id){const i=d;if("string"!=typeof e.id)return c.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.name){const i=d;if("string"!=typeof e.name)return c.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.shortname){const i=d;if("string"!=typeof e.shortname)return c.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.description){const i=d;if("string"!=typeof e.description)return c.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.version){const i=d;if("string"!=typeof e.version)return c.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.license){const i=d;if("string"!=typeof e.license)return c.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.repository){const i=d;if("string"!=typeof e.repository)return c.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.bugs){const i=d;if("string"!=typeof e.bugs)return c.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.maintainers){let i=e.maintainers;const r=d;if(d===r){if(!Array.isArray(i))return c.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var f=!0;const e=i.length;for(let r=0;r<e;r++){let e=i[r];const n=d;if(d===n){if(!e||"object"!=typeof e||Array.isArray(e))return c.errors=[{instancePath:t+"/maintainers/"+r,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let i;if(void 0===e.name&&(i="name"))return c.errors=[{instancePath:t+"/maintainers/"+r,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:i},message:"must have required property '"+i+"'"}],!1;if(void 0!==e.name){const i=d;if("string"!=typeof e.name)return c.errors=[{instancePath:t+"/maintainers/"+r+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var g=i===d}else g=!0;if(g){if(void 0!==e.email){const i=d;if("string"!=typeof e.email)return c.errors=[{instancePath:t+"/maintainers/"+r+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=i===d}else g=!0;if(g)if(void 0!==e.github){const i=d;if("string"!=typeof e.github)return c.errors=[{instancePath:t+"/maintainers/"+r+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=i===d}else g=!0}}}if(!(f=n===d))break}if(f){let e,r=i.length;if(r>1)for(;r--;)for(e=r;e--;)if(a(i[r],i[e]))return c.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1}}}p=r===d}else p=!0;if(p){if(void 0!==e.legacyIds){let i=e.legacyIds;const r=d;if(d===r){if(!Array.isArray(i))return c.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var m=!0;const e=i.length;for(let r=0;r<e;r++){const e=d;if("string"!=typeof i[r])return c.errors=[{instancePath:t+"/legacyIds/"+r,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(m=e===d))break}if(m){let e,r=i.length;if(r>1){const n={};for(;r--;){let s=i[r];if("string"==typeof s){if("number"==typeof n[s])return e=n[s],c.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;n[s]=r}}}}}}p=r===d}else p=!0;if(p){if(void 0!==e.runtime){let i=e.runtime;const n=d;if(d===n){if(!i||"object"!=typeof i||Array.isArray(i))return c.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===i.type&&(e="type")||void 0===i.api&&(e="api")||void 0===i.apiVersion&&(e="apiVersion")||void 0===i.entrypoint&&(e="entrypoint"))return c.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==i.type){const e=d;if("string"!=typeof i.type)return c.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var b=e===d}else b=!0;if(b){if(void 0!==i.api){let e=i.api;const n=d;if("string"!=typeof e)return c.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return c.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:r.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;b=n===d}else b=!0;if(b){if(void 0!==i.apiVersion){const e=d;if("string"!=typeof i.apiVersion)return c.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=e===d}else b=!0;if(b)if(void 0!==i.entrypoint){const e=d;if("string"!=typeof i.entrypoint)return c.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;b=e===d}else b=!0}}}}p=n===d}else p=!0;if(p){if(void 0!==e.manufacturer){const i=d;if("string"!=typeof e.manufacturer)return c.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;p=i===d}else p=!0;if(p){if(void 0!==e.products){let i=e.products;const r=d;if(d===r){if(!Array.isArray(i))return c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(i.length<1)return c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var y=!0;const e=i.length;for(let r=0;r<e;r++){const e=d;if("string"!=typeof i[r])return c.errors=[{instancePath:t+"/products/"+r,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(y=e===d))break}if(y){let e,r=i.length;if(r>1){const n={};for(;r--;){let s=i[r];if("string"==typeof s){if("number"==typeof n[s])return e=n[s],c.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;n[s]=r}}}}}}p=r===d}else p=!0;if(p){if(void 0!==e.keywords){let i=e.keywords;const r=d;if(d===r){if(!Array.isArray(i))return c.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var A=!0;const e=i.length;for(let r=0;r<e;r++){const e=d;if("string"!=typeof i[r])return c.errors=[{instancePath:t+"/keywords/"+r,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(A=e===d))break}if(A){let e,r=i.length;if(r>1){const n={};for(;r--;){let s=i[r];if("string"==typeof s){if("number"==typeof n[s])return e=n[s],c.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i:r,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+r+" are identical)"}],!1;n[s]=r}}}}}}p=r===d}else p=!0;if(p)if(void 0!==e.bonjourQueries){let i=e.bonjourQueries;const r=d;if(d===r){if(!i||"object"!=typeof i||Array.isArray(i))return c.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const e=d;for(const e in i)if(!o.test(e))return c.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"}],!1;if(e===d)for(const e in i)if(o.test(e)){let r=i[e];const s=d,a=d;let l=!1,h=null;const p=d;if(d==d)if(r&&"object"==typeof r&&!Array.isArray(r)){let i;if(void 0===r.type&&(i="type")||void 0===r.protocol&&(i="protocol")){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:i},message:"must have required property '"+i+"'"};null===u?u=[r]:u.push(r),d++}else{const i=d;for(const i in r)if("type"!==i&&"protocol"!==i&&"txt"!==i){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:i},message:"must NOT have additional properties"};null===u?u=[r]:u.push(r),d++;break}if(i===d){if(void 0!==r.type){const i=d;if("string"!=typeof r.type){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[i]:u.push(i),d++}var _=i===d}else _=!0;if(_){if(void 0!==r.protocol){let i=r.protocol;const s=d;if("string"!=typeof i){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[i]:u.push(i),d++}if("tcp"!==i&&"udp"!==i){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:n.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===u?u=[i]:u.push(i),d++}_=s===d}else _=!0;if(_)if(void 0!==r.txt){let i=r.txt;const n=d;if(d===n)if(i&&"object"==typeof i&&!Array.isArray(i)){const r=d;for(const r in i)if(!o.test(r)){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===u?u=[i]:u.push(i),d++;break}if(r===d)for(const r in i)if(o.test(r)){const n=d;if("string"!=typeof i[r]){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[i]:u.push(i),d++}if(n!==d)break}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===u?u=[i]:u.push(i),d++}_=n===d}else _=!0}}}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===u?u=[i]:u.push(i),d++}p===d&&(l=!0,h=0);const f=d;if(d===f)if(Array.isArray(r)){const i=r.length;for(let s=0;s<i;s++){let i=r[s];const a=d;if(d==d)if(i&&"object"==typeof i&&!Array.isArray(i)){let r;if(void 0===i.type&&(r="type")||void 0===i.protocol&&(r="protocol")){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s,schemaPath:"#/definitions/bonjourQuery/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===u?u=[i]:u.push(i),d++}else{const r=d;for(const r in i)if("type"!==r&&"protocol"!==r&&"txt"!==r){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s,schemaPath:"#/definitions/bonjourQuery/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===u?u=[i]:u.push(i),d++;break}if(r===d){if(void 0!==i.type){const r=d;if("string"!=typeof i.type){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/type",schemaPath:"#/definitions/bonjourQuery/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[i]:u.push(i),d++}var I=r===d}else I=!0;if(I){if(void 0!==i.protocol){let r=i.protocol;const a=d;if("string"!=typeof r){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[i]:u.push(i),d++}if("tcp"!==r&&"udp"!==r){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/protocol",schemaPath:"#/definitions/bonjourQuery/properties/protocol/enum",keyword:"enum",params:{allowedValues:n.properties.protocol.enum},message:"must be equal to one of the allowed values"};null===u?u=[i]:u.push(i),d++}I=a===d}else I=!0;if(I)if(void 0!==i.txt){let r=i.txt;const n=d;if(d===n)if(r&&"object"==typeof r&&!Array.isArray(r)){const i=d;for(const i in r)if(!o.test(i)){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:i},message:"must NOT have additional properties"};null===u?u=[r]:u.push(r),d++;break}if(i===d)for(const i in r)if(o.test(i)){const n=d;if("string"!=typeof r[i]){const r={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/txt/"+i.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/bonjourQuery/properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"};null===u?u=[r]:u.push(r),d++}if(n!==d)break}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s+"/txt",schemaPath:"#/definitions/bonjourQuery/properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"};null===u?u=[i]:u.push(i),d++}I=n===d}else I=!0}}}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+s,schemaPath:"#/definitions/bonjourQuery/type",keyword:"type",params:{type:"object"},message:"must be object"};null===u?u=[i]:u.push(i),d++}if(a!==d)break}}else{const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===u?u=[i]:u.push(i),d++}var v;if((v=f===d)&&l?(l=!1,h=[h,1]):v&&(l=!0,h=1),!l){const i={instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//oneOf",keyword:"oneOf",params:{passingSchemas:h},message:"must match exactly one schema in oneOf"};return null===u?u=[i]:u.push(i),d++,c.errors=u,!1}if(d=a,null!==u&&(a?u.length=a:u=null),s!==d)break}}}p=r===d}else p=!0}}}}}}}}}}}}}}}}}}return c.errors=u,0===d}},7e3:(e,t,i)=>{"use strict";const r=i(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:i=0,maxWait:n=0,before:s=!1,after:a=!0}=t;if(!s&&!a)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let o,c,l;const h=function(...t){const r=this,h=s&&!o;return clearTimeout(o),o=setTimeout((()=>{o=void 0,c&&(clearTimeout(c),c=void 0),a&&(l=e.apply(r,t))}),i),n>0&&!c&&a&&(c=setTimeout((()=>{c=void 0,o&&(clearTimeout(o),o=void 0),l=e.apply(r,t)}),n)),h&&(l=e.apply(r,t)),l};return r(h,e),h.cancel=()=>{o&&(clearTimeout(o),o=void 0),c&&(clearTimeout(c),c=void 0)},h}},1635:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__addDisposableResource:()=>R,__assign:()=>s,__asyncDelegator:()=>k,__asyncGenerator:()=>E,__asyncValues:()=>O,__await:()=>w,__awaiter:()=>f,__classPrivateFieldGet:()=>P,__classPrivateFieldIn:()=>x,__classPrivateFieldSet:()=>M,__createBinding:()=>m,__decorate:()=>o,__disposeResources:()=>L,__esDecorate:()=>l,__exportStar:()=>b,__extends:()=>n,__generator:()=>g,__importDefault:()=>N,__importStar:()=>T,__makeTemplateObject:()=>C,__metadata:()=>p,__param:()=>c,__propKey:()=>u,__read:()=>A,__rest:()=>a,__runInitializers:()=>h,__setFunctionName:()=>d,__spread:()=>_,__spreadArray:()=>v,__spreadArrays:()=>I,__values:()=>y,default:()=>F});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var s=function(){return s=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},s.apply(this,arguments)};function a(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]])}return i}function o(e,t,i,r){var n,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,i,a):n(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a}function c(e,t){return function(i,r){t(i,r,e)}}function l(e,t,i,r,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=r.kind,l="getter"===c?"get":"setter"===c?"set":"value",h=!t&&e?r.static?e:e.prototype:null,u=t||(h?Object.getOwnPropertyDescriptor(h,r.name):{}),d=!1,p=i.length-1;p>=0;p--){var f={};for(var g in r)f[g]="access"===g?{}:r[g];for(var g in r.access)f.access[g]=r.access[g];f.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,i[p])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(u.get=o),(o=a(m.set))&&(u.set=o),(o=a(m.init))&&n.unshift(o)}else(o=a(m))&&("field"===c?n.unshift(o):u[l]=o)}h&&Object.defineProperty(h,r.name,u),d=!0}function h(e,t,i){for(var r=arguments.length>2,n=0;n<t.length;n++)i=r?t[n].call(e,i):t[n].call(e);return r?i:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,i){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,i,r){return new(i||(i=Promise))((function(n,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))}function g(e,t){var i,r,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(c){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(s=0)),s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}var m=Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]};function b(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||m(t,e,i)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function A(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,s=i.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(A(arguments[t]));return e}function I(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<i;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,n++)r[n]=s[a];return r}function v(e,t,i){if(i||2===arguments.length)for(var r,n=0,s=t.length;n<s;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function E(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=i.apply(e,t||[]),s=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",(function(e){return function(t){return Promise.resolve(t).then(e,l)}})),r[Symbol.asyncIterator]=function(){return this},r;function a(e,t){n[e]&&(r[e]=function(t){return new Promise((function(i,r){s.push([e,t,i,r])>1||o(e,t)}))},t&&(r[e]=t(r[e])))}function o(e,t){try{(i=n[e](t)).value instanceof w?Promise.resolve(i.value.v).then(c,l):h(s[0][2],i)}catch(e){h(s[0][3],e)}var i}function c(e){o("next",e)}function l(e){o("throw",e)}function h(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}}function k(e){var t,i;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,n){t[r]=e[r]?function(t){return(i=!i)?{value:w(e[r](t)),done:!1}:n?n(t):t}:n}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=y(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise((function(r,n){!function(e,t,i,r){Promise.resolve(r).then((function(t){e({value:t,done:i})}),t)}(r,n,(t=e[i](t)).done,t.value)}))}}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var S=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&m(t,e,i);return S(t,e),t}function N(e){return e&&e.__esModule?e:{default:e}}function P(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)}function M(e,t,i,r,n){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(e,i):n?n.value=i:t.set(e,i),i}function x(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function R(e,t,i){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,n;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],i&&(n=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");n&&(r=function(){try{n.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:i})}else i&&e.stack.push({async:!0});return t}var D="function"==typeof SuppressedError?SuppressedError:function(e,t,i){var r=new Error(i);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function L(e){function t(t){e.error=e.hasError?new D(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var i,r=0;return function n(){for(;i=e.stack.pop();)try{if(!i.async&&1===r)return r=0,e.stack.push(i),Promise.resolve().then(n);if(i.dispose){var s=i.dispose.call(i.value);if(i.async)return r|=2,Promise.resolve(s).then(n,(function(e){return t(e),n()}))}else r|=1}catch(e){t(e)}if(1===r)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}const F={__extends:n,__assign:s,__rest:a,__decorate:o,__param:c,__metadata:p,__awaiter:f,__generator:g,__createBinding:m,__exportStar:b,__values:y,__read:A,__spread:_,__spreadArrays:I,__spreadArray:v,__await:w,__asyncGenerator:E,__asyncDelegator:k,__asyncValues:O,__makeTemplateObject:C,__importStar:T,__importDefault:N,__classPrivateFieldGet:P,__classPrivateFieldSet:M,__classPrivateFieldIn:x,__addDisposableResource:R,__disposeResources:L}}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,i),s.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=i(6278);const t={Dfrs:[{id:1,label:"DFR 1"},{id:2,label:"DFR 2"}],IntellimixModes:[{id:"CLASSIC",label:"Classic"},{id:"SMOOTH",label:"Smooth"},{id:"EXTREME",label:"Extreme"},{id:"CUSTOM",label:"Custom"},{id:"MANUAL",label:"Manual"},{id:"CUSTOM_PRESET",label:"Custom Preset"}],Mixers:[{id:"A",label:"Mix A"},{id:"B",label:"Mix B"}],Mute:[{id:"ON",label:"Mute"},{id:"OFF",label:"Unmute"},{id:"TOGGLE",label:"Toggle Mute/Unmute"}],OnOff:[{id:"ON",label:"On"},{id:"OFF",label:"Off"}],OnOffToggle:[{id:"ON",label:"On"},{id:"OFF",label:"Off"},{id:"TOGGLE",label:"Toggle"}]},r={Dfr:{type:"dropdown",label:"DFR #",id:"dfr",default:1,choices:t.Dfrs},GainInc:{type:"number",label:"Gain Value (dB)",id:"gain",min:.1,max:120,step:.1,default:3,required:!0,range:!0},GainSet:{type:"number",label:"Gain Value (dB)",id:"gain",min:-110,max:18,step:.1,default:0,required:!0,range:!0},IntellimixMode:{type:"dropdown",label:"IntelliMix Mode",id:"choice",default:"CLASSIC",choices:t.IntellimixModes},Mixer:{type:"dropdown",label:"Mix",id:"mix",default:"A",choices:t.Mixers},Mute:{type:"dropdown",label:"Mute/Unmute/Toggle",id:"choice",default:"ON",choices:t.Mute},Name:{type:"textinput",label:"Name (31 characters max)",id:"name",default:"",regex:"/^.{1,31}[^{}]$/"},OnOff:{type:"dropdown",label:"Set On/Off",id:"choice",default:"ON",choices:t.OnOff},OnOffToggle:{type:"dropdown",label:"Set On/Off/Toggle",id:"choice",default:"TOGGLE",choices:t.OnOffToggle}};function n(){this.setupChannelChoices(),this.setActionDefinitions({chan_name:{name:"Set channel name",options:[this.CHANNELS_FIELD(),r.Name],callback:({options:e})=>{let t=`SET ${e.channel} CHAN_NAME {${e.name}}`;this.sendCommand(t)}},audio_mute:{name:"Set channel mute",options:[this.CHANNELS_FIELD(),r.Mute],callback:({options:e})=>{let t=`SET ${e.channel} AUDIO_MUTE ${e.choice}`;this.sendCommand(t)}},audio_gain:{name:"Set audio gain of channel",options:[this.CHANNELS_FIELD(),r.GainSet],callback:({options:e})=>{let t=10*(e.gain+110),i=`SET ${e.channel} AUDIO_GAIN_HI_RES ${t}`;this.sendCommand(i)}},audio_gain_inc:{name:"Increase audio gain of channel",options:[this.CHANNELS_FIELD(),r.GainInc],callback:({options:e})=>{let t=10*e.gain,i=`SET ${e.channel} AUDIO_GAIN_HI_RES INC ${t}`;this.sendCommand(i)}},audio_gain_dec:{name:"Decrease audio gain of channel",options:[this.CHANNELS_FIELD(),r.GainInc],callback:({options:e})=>{let t=10*e.gain,i=`SET ${e.channel} AUDIO_GAIN_HI_RES DEC ${t}`;this.sendCommand(i)}},always_on_enable:{name:"Set channel always on in mix",options:[r.Mixer,this.CHANNELS_FIELD("I"),r.OnOffToggle],callback:({options:e})=>{let t=`SET ${e.channel} ALWAYS_ON_ENABLE_${e.mix} ${e.choice}`;this.sendCommand(t)}},intellimix_mode:{name:"Set IntelliMix Mode",options:[this.CHANNELS_FIELD("M"),r.IntellimixMode],callback:({options:e})=>{let t=`SET ${e.channel} INTELLIMIX_MODE ${e.choice}`;this.sendCommand(t)}},dfr_assigned_chan:{name:"Set DFR assigned channel",options:[r.Dfr,this.CHANNELS_FIELD("IMU")],callback:({options:e})=>{let t=`SET DFR${e.dfr}_ASSIGN_CHAN ${e.channel}`;this.sendCommand(t)}},dfr_bypass:{name:"Set DFR bypass",options:[r.Dfr,r.OnOff],callback:({options:e})=>{let t=`SET DFR${e.dfr}_BYPASS ${e.choice}`;this.sendCommand(t)}},dfr_clear:{name:"Clear DFR filters",options:[r.Dfr],callback:({options:e})=>{let t=`SET DFR${e.dfr}_CLEAR_ALL_FILTERS ON`;this.sendCommand(t)}},dfr_freeze:{name:"Set DFR freeze",options:[r.Dfr,r.OnOff],callback:({options:e})=>{let t=`SET DFR${e.dfr}_FREEZE ${e.choice}`;this.sendCommand(t)}},auto_link_mode:{name:"Set auto link mode",options:[r.OnOff],callback:({options:e})=>{let t=`SET AUTO_LINK_MODE ${e.choice}`;this.sendCommand(t)}},flash_lights:{name:"Flash lights on the mixer",tooltip:"It will automatically turn off after 30 seconds",options:[],callback:()=>{this.sendCommand("SET FLASH ON")}}})}function s(){this.setFeedbackDefinitions({input_levels:{type:"advanced",name:"Input Levels Display",description:"Provide a visual display of the input levels.",options:[],callback:e=>({alignment:"center:top",imageBuffers:[{buffer:this.api.getInputLevelsIcon(e.image)}],size:"8",text:"IN: 123456789"})},output_levels:{type:"advanced",name:"Output Levels Display",description:"Provide a visual display of the output levels.",options:[],callback:e=>({alignment:"center:top",imageBuffers:[{buffer:this.api.getOutputLevelsIcon(e.image)}],size:"8",text:"OUT: 12345678"})},mixer_levels:{type:"advanced",name:"Mixer Levels Display",description:"Provide a visual display of the mixer levels.",options:[],callback:e=>({alignment:"center:top",imageBuffers:[{buffer:this.api.getMixerLevelsIcon(e.image)}],size:"8",text:"MIX  A   B  OUT\\n\\n LIM              LIM"})},channel_status:{type:"advanced",name:"Channel Status Display",description:"Provide a visual display of the channel's status.",options:[this.CHANNELS_FIELD("IA")],callback:e=>{let t=e.options,i=this.api.getChannel(parseInt(t.channel)),r={alignment:"left:top",imageBuffers:[{buffer:this.api.getChannelIcon(parseInt(t.channel),e.image)}],size:"8",text:""};return r.text+="  "+i.name+"\\n",r.text+="  "+i.audioGain2+"\\n",r.text+=9==parseInt(t.channel)?"":"          A     B\\n  ON",r}},mixer_status:{type:"advanced",name:"Mix Status Display",description:"Provide a visual display of the mix's status.",options:[this.CHANNELS_FIELD("M")],callback:e=>{let t=e.options,i=this.api.getChannel(parseInt(t.channel)),r={alignment:"left:top",imageBuffers:[{buffer:this.api.getMixerIcon(parseInt(t.channel),e.image)}],size:"8",text:""};return r.text+=i.name+"\\n",r.text+=("CUSTOM_PRESET"==i.intellimixMode?"PRESET":i.intellimixMode)+"\\n",r.text+=i.audioGain2+"\\n",r.text+="               LIM",r}},audio_mute:{type:"boolean",name:"Channel Mute",description:"Change color if the selected channel is muted.",defaultStyle:{color:(0,e.combineRgb)(0,0,0),bgcolor:(0,e.combineRgb)(255,255,0)},options:[this.CHANNELS_FIELD(),r.OnOff],callback:({options:e})=>this.api.getChannel(parseInt(e.channel)).audioMute==e.choice},audio_gain:{type:"boolean",name:"Channel Gain",description:"Change color if the channel gain it set to a level.",defaultStyle:{color:(0,e.combineRgb)(0,0,0),bgcolor:(0,e.combineRgb)(255,255,0)},options:[this.CHANNELS_FIELD(),r.GainSet],callback:({options:e})=>this.api.getChannel(parseInt(e.channel)).audioGain==e.gain},always_on_enable:{type:"boolean",name:"Channel Always On in Mix",description:"Change color if the channel is set always on in the mix.",defaultStyle:{color:(0,e.combineRgb)(0,0,0),bgcolor:(0,e.combineRgb)(255,255,0)},options:[r.Mixer,this.CHANNELS_FIELD("I")],callback:({options:e})=>"A"==e.mix&&"ON"==this.api.getChannel(parseInt(e.channel)).alwaysOnA||"B"==e.mix&&"ON"==this.api.getChannel(parseInt(e.channel)).alwaysOnB},intellimix_mode:{type:"boolean",name:"IntelliMix Mode",description:"Change color if the mixer's IntelliMix mode is selected.",defaultStyle:{color:(0,e.combineRgb)(0,0,0),bgcolor:(0,e.combineRgb)(255,255,0)},options:[this.CHANNELS_FIELD("M"),r.IntellimixMode],callback:({options:e})=>this.api.getChannel(parseInt(e.channel)).intellimixMode==e.choice},dfr_assigned_chan:{type:"boolean",name:"DFR Assigned Channel",description:"Change color if the selected channel is assigned to the DFR.",defaultStyle:{color:(0,e.combineRgb)(0,0,0),bgcolor:(0,e.combineRgb)(255,255,0)},options:[r.Dfr,this.CHANNELS_FIELD("IMU")],callback:({options:e})=>this.api.getDfr(parseInt(e.dfr)).assignedChan==e.channel},dfr_bypass:{type:"boolean",name:"DFR Bypassed",description:"Change color if the selected DFR is set to bypass.",defaultStyle:{color:(0,e.combineRgb)(0,0,0),bgcolor:(0,e.combineRgb)(255,255,0)},options:[r.Dfr],callback:({options:e})=>"ON"==this.api.getDfr(parseInt(e.dfr)).bypass},dfr_freeze:{type:"boolean",name:"DFR Frozen",description:"Change color if the selected DFR is frozen.",defaultStyle:{color:(0,e.combineRgb)(255,255,255),bgcolor:(0,e.combineRgb)(0,0,255)},options:[r.Dfr],callback:({options:e})=>"ON"==this.api.getDfr(parseInt(e.dfr)).frozen},auto_link_mode:{type:"boolean",name:"Auto Link Mode Enabled",description:"Change color if auto link mode is enabled.",defaultStyle:{color:(0,e.combineRgb)(0,0,0),bgcolor:(0,e.combineRgb)(255,255,0)},options:[],callback:()=>"ON"==this.api.getMixer().autoLinkMode}})}function a(){var e=[];for(let t=1;t<=19;t++){let i=this.api.getChannel(t).prefix,r=t>=1&&t<=8?`Channel ${t}`:9==t?"Aux In":t>=10&&t<=17?" Output "+(t-9):18==t?"Mix A":"Mix B";e.push({variableId:`${i}_name`,name:`${r} Name`}),t<=8?(e.push({variableId:`${i}_audio_gain`,name:`${r} Gain`}),e.push({variableId:`${i}_audio_mute`,name:`${r} Mute`}),e.push({variableId:`${i}_always_on_enable_a`,name:`${r} Always On Enable A`}),e.push({variableId:`${i}_always_on_enable_b`,name:`${r} Always On Enable B`}),e.push({variableId:`${i}_input_audio_gate_a`,name:`${r} Input Gate A`}),e.push({variableId:`${i}_input_audio_gate_b`,name:`${r} Input Gate B`})):9==t?(e.push({variableId:`${i}_audio_gain`,name:`${r} Gain`}),e.push({variableId:`${i}_audio_mute`,name:`${r} Mute`})):t>=18&&(e.push({variableId:`${i}_audio_gain`,name:`${r} Gain`}),e.push({variableId:`${i}_audio_mute`,name:`${r} Mute`}),e.push({variableId:`${i}_intellimix_mode`,name:`${r} IntelliMix Mode`}),e.push({variableId:`${i}_limiter_engaged`,name:`${r} Limited Engaged`})),e.push({variableId:`${i}_clip_indicator`,name:`${r} Clip Indicator`})}for(let t=1;t<=2;t++)e.push({variableId:`dfr${t}_assigned_chan`,name:`DFR ${t} Assigned Channel`}),e.push({variableId:`dfr${t}_bypass`,name:`DFR ${t} Bypass`}),e.push({variableId:`dfr${t}_freeze`,name:`DFR ${t} Freeze`});e.push({variableId:"device_id",name:"Device ID"}),e.push({variableId:"auto_link_mode",name:"Auto Link Mode"}),e.push({variableId:"meter_rate",name:"Meter Rate"}),this.setVariableDefinitions(e)}var o=i(9904);const c=(t,i,r,n,s=10)=>(t=parseInt(t,s),i=parseInt(i,s),r=parseInt(r,s),n=parseInt(n,s),!(isNaN(t)||isNaN(i)||isNaN(r)||isNaN(n))&&16777216*t+(0,e.combineRgb)(i,r,n));class l{constructor(e,t){this.width=e,this.height=t,this.buffer=Buffer.alloc(this.height*this.width*4)}pixel(e,t,i){if(e<0||e>=this.width)return;if(t<0||t>=this.height)return;let r=4*(t*this.width+e),n=Math.floor(i/16777216)/255,s=this.buffer.readUInt8(r),a=this.buffer.readUInt8(r+1),o=this.buffer.readUInt8(r+2),l=this.buffer.readUInt8(r+3),h=i>>16&255,u=i>>8&255,d=255&i,p=i/16777216;return this.buffer.writeUInt32BE(c(s+(1-s)*p,a*(1-n)+h*n,o*(1-n)+u*n,l*(1-n)+d*n),r),!0}drawFromPNGdata(e,t=0,i=0,r=72,n=58){let s=o.O.sync.read(e);for(let e=0;e<s.height;e++)for(let r=0;r<s.width;r++){let n=s.width*e+r<<2,a=s.data[n],o=s.data[n+1],l=s.data[n+2],h=s.data[n+3];h>0&&this.pixel(t+r,i+e,c(h,a,o,l))}}toBase64(){return this.buffer.toString("base64")}}class h{constructor(e){this.instance=e,this.savedIcons={},this.AUDIO={0:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABH0lEQVQoka3SvSvFURzH8df1UIjFw2K9iYhFESN1FxFZDFiEIjH7B5SB3Wq6JnnYDMpdRFLKokxkJ6z61rn8uKtTZ/h9en/f53NOv1yhUFjALp4wVZ3P5y/QiDbUVuHSz7qpwTim8YKzCD6wX2aq0uwm5uI7iBMMJKAliK6MtCOCRTwijt+OkYO0v6W/VgSreMcDuqP6ORrQjLogSpmRUkgnMYHncvCJYvaUFqylC+aCOMZQAjaC6MlIOyNYStVL5erFv9KK6vHqr7gPx3+9ekX1IwwnYD2Ivoy0N4KV9BbX2IqREP6SVlSfTz/LFfJRPa7dinbUB3GbmbgN6Rhm0kmnEcTV97LSJsxiNIIgDjGSgOUgBjPS/gg28IY77HwBh9s9kKLHTIUAAAAASUVORK5CYII=","base64"),1:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABJElEQVQoka3SvytFYRzH8ZdfhVj8WKw3EbEoYlV3EZHFgMWPgcTsH1AWu9XE6MdGKXcRSQaLMpFdYTz65rkc7uo5neF8en/fz+d5OlXFYnEBO3jCVE2hULhAE9pRV41LP+umFuOYxgtOI3jHXpmpTrObmIvvII4xmIDWILpz0s4IlvCI2H47Rg7S+y39tSJYxRse0BPVz9GIFtQHUcqNlEI6iQk8l4MP7Od3acVaOmBVEEcYTsBGEL05aVcEy6l6qVx9/6+0onrc+ivuw/Fft15R/RAjCVgPoj8n7YtgJd3FNbZiJIS/pBXV59PPcoVCVI9jt6EDDUHc5iZuQzqGmbTTSQRx9N0fKNMsMyszKvsKzmTfz3JIh3LSgSAWZV5l7mS6PgGMikrPua7+EAAAAABJRU5ErkJggg==","base64"),2:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABJElEQVQoka3SMS9kURjG8d9YEhEUJvsJJkLIaiSEdpNphNhodzWYggi1L7CJRq9VjRIlicQ0siKi2GYTFdETtjzyxpnZu0bp3NziPPm///Pck1uqVqtL2MEtvn2qVCpn6MVndHXg3L912YlZLOAexxE8Y6/JdOTZLfyIfRBHmMhAOYjhgnQwghXcII7fjpH9/Lak/60I1vCEPxiJ6qfowQC6g2gURhohnccc7prBX9SLp5Sxnj+wFMQhpjKwGcRoQToUQS1XbzSr199K26rHrT/gdzg+6tbbqh9gOgMbQYwVpF8iWM13cYGfMRLClrQktVdfzD/LL1RIHqXWsxvEVWHiKoh+SU0yE753pX34jq+vUXJSkNaCmCxMjAexLHmQXEuGXgARkE/dp6oXNAAAAABJRU5ErkJggg==","base64"),3:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABKUlEQVQoka3SMUtcQRiF4edqBAmaIot/wEtYUUwTUKwD24iSYJtNE90mbEidn5DG3tZq02ppQHAtRJDFwkZIZbBf0ZQjH9xdRzelc5niHt7vnDPDFI1G4wu2cYWP42VZHmEKM5gYw4mHdfYCa9jANQ5CuMPugBmrZn+gGf9B7GOpAmpBzGWmb0LYwh9E/M8Y+VXtoemjFcJX3OIS81H9EC/xGpNBdLORbph+wDr+DoR/6OQpNbSrAxZB7GGlAr4HsZCZ1kNoVdW7g+qdp6Yj1ePW+7gIj+e4dZKapC3ZkBQhHEvD71uYvs1MF4NoSq4kp5LZQhptOiJ8rh7LKcrwuMlSdoLoZRO9IF5JWpLVCPhvyjQ+4f3gLL8z01YQy9nEuyA2JX3JuaR+D/oCW+MvbGkzAAAAAElFTkSuQmCC","base64"),4:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABLElEQVQokXXSPy9kURjH8c/4k4igIN6AidgQGsmKmkwjhGjZZplGiNpL0Gg3225FS0kiMQqRyGQLjURF9P6WR564w5Hh3Nzi/PL9fc9zT26pUqn8xg5usNBaLpdP0IV+tLfgzMe6aMMsFnGHwwie8a/BtBTdLSzHPogD/CyAviB+ZNLBCFZxjTh+Oyp7xfsu/bQiWMMTrjAcox+jE73oCKKWVWohncccbhvBC3bzU/qwXnxgKYh9TBbAZhAjmXQogmoxeq0x+m4uLUnNo8et3+MyHCSP0vvzp+nWg+iULEumw/el9NPoUTnNpBtBjGWN0SBCeCM5lwx8KW0KfhU/yznK4XjITvkbRD1r1IPokVQlM9+O3o0lTL1FyVEmrQYxkTXGg1iR3Ev+S4ZeARuPYNvim9rUAAAAAElFTkSuQmCC","base64"),5:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABNElEQVQokXXSPS9lURiG4ev4SCaCgvgDTiaE0EiIeuQ0MjITnaDBaYSop9FrtKJVUUxDSSIZCpGITKGRqHz0GMolb+zDkmPWzi7Wk/u515u1d6lSqcxhHdf42Vgul/+gFV1obsCJ93XWhO+YxB32I3jCVo1pKLq/MBP7IPYwXACdQfRm0q8RLOAKcfxaVHaK9036YUWwiH+4RF+MfogWdOBLEEdZ5SikPzCBm1rwjO0aUkqrOjGFW/wOYhejBbAS0v5M2hNBtRg9TlsLx4dVkupHj1u/x0U4SB6lt2ej7taDaJHMSMbC96k0Rl8qvk0pKseZdDmIwawxEEQIryWnku5PpXXBbPGznKIcjofslM0gzrPGeRDtkqpk/L+jt2Ea316j5CCTVoMYyRpDQcxL7iV/JT0v5Atjrl7N7oUAAAAASUVORK5CYII=","base64"),6:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABK0lEQVQokXWSvy9DYRiFn1ssTVka/4AbaUNYJMRM7iKkYlUL7iLEbLF3sYrEZGJlZFKDNJHGYJGYKvb6Nb5y+Mrb3Hpv7vCdPOe85365UZIk68AB0AKW++I4vgYKwDAwkANu+Zu7fmARWAFegEsJH8BJh8kF7x5Q1VnEBTAdgKKIsgsdlbAJPAFaX5PlLLzfE9k+XSPLFvAOPAJjInTIB+pYRN1Z6gqtAEvAc0f4BE599SKwHT4wEnEOzAZgV8S4Cy1JSEN1batlmkZYtrpuvQ08KAOMN+z3Oczcuog8RhVjXnk9Q7uqy3LjQndETDrHhAgFtjAaGCM9QzPCWvhZGkCsjFe35UhE0zmaIoYwUoyFf6sPAqvA3I9kXLnQVMSMc0yJ2MBoY9xjlL4ADWNkTEiBhPwAAAAASUVORK5CYII=","base64"),7:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABLElEQVQokXXSMU9TURjG8d8tsjTo0vgFuCElGF1INMyaLkSCYQUWpAuR8A3YXViNCZNhcJYRJ8tgSEzD4GLCYgl7URmPeeEWTtNy7nTe/J//ee7JKVqt1gb20MObibIsv2EKjzFZw3d368cDvMYKLnAUg3/4NGCKtHud3cRvHARxiOcV0AjpbCadqVX4GeL49+EYWjVGB1v4i1+Yi0hs6hWwH0QnS3SixzKWcD4YXOFzLm3gXfWDRRBfsFABO0E8yaTNGLSr6p2x1QtptHrceh8/w0HyR7r9PozcehB1yZrkVfjGSoeqR+Q4k24H8SxLPA0ihD3JiWR6rHRksF49lhOU4bjMTvkYRDdLdIN4JGlLFu+t/hCreHkzSr5m0nYQL7LEfBBvJX3JqaT5H33XZYdBhu4/AAAAAElFTkSuQmCC","base64"),10:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABO0lEQVQokX3Qv0vbURSG8U+iQpW6mLq4BlEsdilU2rFKllIRXBy0S2gFpdT/QnDoLK6lQzqV/tgchGaRigiCi+Ci4q62Ha+ccIPfJNALd3l5znPfcyXqievESWIigttEyne7jH335zCIocRKYi6hlHSeUq1WG8VbnONzP37gWcYqIZ0szIyXM36GX9iKkS/5tk6565FWsI4/OMVUX7Va3cMQRvAgiGZhohnSBczjsh38Q6MoreA9FmOVIL7jeQY2gnhckE5E8C5Xb7arN7qlPdXruMZJOKJ6rP0Q8XMDPb8e0te51BV2I/iLT/+t/g0vMvAhiCcF6XQEa/kvDrAZIyHskPZUf4ML/EY1qsfajzCGwSCOChNHIX2FpfzSzwhi9Z2idBjLmI0giK94mYHVIGYK0qcRbOAGx/h4B4zHSr1YWkXQAAAAAElFTkSuQmCC","base64"),11:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABPUlEQVQokX3SsUvVYRTG8Y9XA5NcMhfXS1wpbAmKXJW7iBG0OKiL5aCI/RdBf0G4SoOOppuC0F1CCXFwCVpS3C+a44kjr/rTC56Xd3l4zvd9zuEVzAXt4ChopHAWRLlfa/jppn6loy+YCcYDXeF2dTWbzUF8xF9868EmXhXbQEKHKz1Pa8X+Bz/wJVvWy72s2p1HLoVFnOM3nnXX6/Vd9OExetPRqnS0EvoOb3FyJVxgrQodwBLe5yjp+I43xfApHc8r0EYK8yV66yr62l1oR/Q5tHGUjIyeYz9Cbu5Bx9YTOllCnWI7hX9YvTf6BkaLYTkdLyrQkRQWyi728TlbEngL2hF9FsfYQz2j59hPMISH6TiodBwkdAJT5aWtFHL0lRtT6BemhbH8XynsiOszn9DXFejLdHwQ2sKh0PgPkXZX/GyEUR0AAAAASUVORK5CYII=","base64"),12:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABOElEQVQokX3RQUuUURiG4WtGgxisRdIvGGLCyE2g1DaZTRiC22xjzcII/RdBv0DchgtbasuCoNlIEoOL2QhtMtqPlcs33vGMfY7R+Tibh/u9z3POJ1gNBkE/aGXwM4iyN+vY93d9SaIRrAQLgVq4uGrtdvsmnuMbtifxDnMFm07p7crMrXrBv+ITXufI27KHqz52yDB4gV84wsxEs9n8iAZu4GoS3cpEN6VLeIzvo+AUO1XpNF5iOa+SxB7uF2AjiTsVaSuDTqneHVXfGZdeqr6KAfrpyOp57Snky1259OopXSylfuB9Br/x5r/Vd/GgAOtJzFakdzNYK29xgFc5ksJzaS3/9nj1pzjGZzQJJ+L820qiV5noJXFd6AiP0vdP6TU8wcOzKHyoSDtJzFcm7iXxTBgIh0LrDxZ8XQrF1VyNAAAAAElFTkSuQmCC","base64"),13:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABOklEQVQokW3RQUvUURTG4WfGAhnKhUNfwEEmjNwESutiNmIIbtWNOZsw/Bx+gmgbLnRby4KgcSGCSAs3QhuN9qPm8siR/+RtxnO5m5ffec977hWsB/3gJGincBlEdT/UceCujpJoBKvB60At/F+1TqfzBBs4w84DfMFchTXT9GnRM12v8F/4ge1s2avubdWHhtwK73CFU8yMtVqt72hgEuNJ9IqOXpou4Q1+D4Rr7JamTWxiOVdJ4jNeVsBWEs8K03YK3Sp6bxB9d9h0JPo6+jhJj4yeaz9CvtzDkVdP08Uq1B98TeEvPt1BoSlsCstCLYV98e+8T9PZwvR5EqvCuXAoTNXyc4eTjghrOMchWulxUUz5mMRx0XGcxITQFRZywL1THmMFrwa7fCtMu0nMFx0vkngr9IWfQvsG/u5pEONyWCsAAAAASUVORK5CYII=","base64"),14:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABKklEQVQokXXQMWuTURTG8V+igwTqYOkXMEhKxS5CS+eWLIIIrqZL2yyi9HP4CcS9Q7q2a6HQOJRCKQ5ZhC7GLxAjHY+c9E29qfG83OXh//zvea9gJxgFg6CVwTiI6nyu49zfuUyiEXSCrUAtzE6t3W4vYQ8/cPAQx1irsMWULhedZ/UKv8YZPmXlsDqTqd+7ZBK8x298x8qDZrN5igae4FES/aLRT+kbvMbPaXCDXildxAe8zV9J4ggbFbCfxPNC2sqgW63en67eK6U1914oKzsYYZAOwljcfXNeXWgIHWErfXOlM6tn5Wsh/ZjEatF4kUQKh8KF8HSu9J9gG0NcoJmOX8UtX5K4KhpXSTwWusKr/66+gHfYvI3CSSHtJrFeNF4msSuMhG9C6w8ge24IIPMKjwAAAABJRU5ErkJggg==","base64"),15:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABMElEQVQokXXQsUqcURCG4WdXi7CghZIbcAkbFNMISmplGyEIdiGmUbeRBO/A3iuQ9BZa2GgbCMQUIohY2Ag2ai5gY7CcMOtvPJrNHE4zvN87wwiWg25wHrSycRtE9bfqOPJYJ0k0gqVgLlALT6vWbrdfYhVX2B7EAaYrbDSlr4vMq3qFX+I7NjOyW/1e1Z8N6TXW8BsXGB9oNpvf0MAIXiRxWCQOU7qAd7h5aNxh5wGpxYZRvMdP7CWxj7cVsJ7SiULaykanWj2nbabj6T08u1BGltHFeToIt+Lv63N1oSEsCXPp6yvN1T9hsTdV+FFIPyfxpkhMJpHCa+FYGOsr/afxEdc4RjMdv4opX5I4LRKnSQwLHWH+v6sP4QNm71vhayHtJDFTJKaSWBG6wpnQ+gPo93Dbhk3zoAAAAABJRU5ErkJggg==","base64"),16:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABJklEQVQokXXQsUrbURTH8U/EKVCX4AsoJcWii1BxNmQpSKGrukSziOIbuPsEUujoYNd27dR0EKFIhyyCi+kLpBHHI6f9a2+aeC53uIfv73sOV9AJhkE/aGZjFER1T2dw4V/9SKIebAetQC2MV63dbs9jD7c4m8UXvKmwRkpfFZmXMxV+g284ycin6v6pWhyPT8nIPu5wjaUk8lGvgI9J9IpEL6XvsIlfj417nJfSBg7wPqcm8RnrFXCUxOtC2sxGt1o9p51MbFrz3w9lpIMh+ukgjMTTmfLrQl3YFlrpmyodWz0j3wvpYRIrRWI5iRQOhEthYap0orGDAS6xmI7fxZQPSVwViask5oSu8PbZ1V9gCxt/W+FrIe0msVYkVpPYFYbCT6H5ABJPcXk0xsCyAAAAAElFTkSuQmCC","base64"),17:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAQAAAAqCAYAAACUV/o4AAABHUlEQVQokXXQsS6kURjG8d9MVJPQTNyAjYzY2EZC1KuTiESLxu40suIO9K5AJEqFmlZlFCIRUWgkGtzAIMp38/LhDOOcnOJ78n/+5/2OYDXoBldBK4PHIKqzXcepj3WeRCNYDmYDtdC7Bmwaxl/cYm8Ah5iqsGZKx4rOaL3Cb3CMrVps9krrny55CdbwhGuMZyU/GhWwm0SnaHRyjgXM4/4teMZ+KW3iHxbz35I4wEwFbCTxs5C2MmhXo3f6jl7z6YWysoourtJBeBTvu8+rCw1hWZhNX19pz+hZOSmk60n8KhoTSaTwTjgTRvpKvwQruMMZfqTjobhlJ4mLonGRxJDQFua+HX0QS/j9GoWjQtpOYrpoTCbxR+gKl0LrP4H4b9NTQGIlAAAAAElFTkSuQmCC","base64")},this.DFR={1:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAACUAAAANCAYAAAAuYadYAAAAqklEQVQ4jWP8//8/g6ur63+GQQJ2797NyOji4gJ20PuE9wPuKsEFgmCaiWGQOIgByR0s6BJnos+g8E2WmuCUQ5bHpw8XAOnBpg7DUdgcgszHZxk+fegAmwdhgImgd2gACDkYa0jhA8g+RDcYnxwyIBS1JDuKkGWEQoEYQPXogzmM6o4CGQrD5PiaGIfB5LGpAxeeg6WcYoAWoEwMSCXpQAOYOwZf3bd7NyMAx59UvJV43fIAAAAASUVORK5CYII=","base64"),2:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAACUAAAANCAYAAAAuYadYAAAAqElEQVQ4jWP8//8/g6ur63+GQQJ2797NyOji4gJ20PuE9wPuKsEFgmCaiWGQOIgByR0s6BJnos+g8E2WmuCUQ5bHpw+fHdjUYTgKm0OQ+fgsw6cPlzg2dUw4baARwOcpGMAaUvgAvqAnFC3EqiPZUYSiD1e0ITuIUGhRPfpgDqMEYA0pYqOBkMNw6SWUU8GF52AppxigBSgTA1JJOtAA5o7BV/ft3s0IAOG+WAzByncwAAAAAElFTkSuQmCC","base64")},this.GATE={ON:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAALElEQVQImWN0cXH5z4ADsICI9wnvMaQFFwgyMOHSBQI0kgQ7CGQ5BmBgYAAAaMYFn77EueIAAAAASUVORK5CYII=","base64"),OFF:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAALElEQVQImWN0cXH5z4ADsICIe/fuYUgrKSkxMOHSBQI0kgQ7CGQ5BmBgYAAAZ7IFQxStQrMAAAAASUVORK5CYII=","base64")},this.LIMITER={ON:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAAKElEQVQImWN0cXH5z4ADsICI3Xv2YEi7urgwMOHSBQI0ksTtWgYGBgCEkAalo1QB7gAAAABJRU5ErkJggg==","base64"),OFF:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAALElEQVQImWN0cXH5z4ADsICIe/fuYUgrKSkxMOHSBQI0kgQ7CGQ5BmBgYAAAZ7IFQxStQrMAAAAASUVORK5CYII=","base64")},this.MUTE={ON:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFEGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDUgNzkuMTY0NTkwLCAyMDIwLzEyLzA5LTExOjU3OjQ0ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTAzLTE4VDAwOjQ5LTA0OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wMy0xOFQwMDo1ODowMS0wNDowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wMy0xOFQwMDo1ODowMS0wNDowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNTcwY2Q5MC0xYzg3LTUxNGEtYWE2ZC1lYmRiOTM3YWYyMDEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzU3MGNkOTAtMWM4Ny01MTRhLWFhNmQtZWJkYjkzN2FmMjAxIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MzU3MGNkOTAtMWM4Ny01MTRhLWFhNmQtZWJkYjkzN2FmMjAxIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDozNTcwY2Q5MC0xYzg3LTUxNGEtYWE2ZC1lYmRiOTM3YWYyMDEiIHN0RXZ0OndoZW49IjIwMjEtMDMtMThUMDA6NDktMDQ6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4xIChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5vb0K2AAAAbUlEQVQokY2QSxKAMAhDXxzvf+W4sF8ElZkuSvMaggwGhE1Svam1eYxHiVDpLx3SEE0wdYhOE/wAAM6W5RZKNLcq4+bUfIYwy1hAcdQCzKAd/AXZ+yJmzgek5TzBMGqdqYPJct4zFY4VtArj3RfEeiceJAL/4wAAAABJRU5ErkJggg==","base64"),OFF:Buffer.from("iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDUgNzkuMTY0NTkwLCAyMDIwLzEyLzA5LTExOjU3OjQ0ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTAzLTE4VDAwOjQ5OjEwLTA0OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wMy0xOFQwMDo1MDoxNi0wNDowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wMy0xOFQwMDo1MDoxNi0wNDowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphNmNlYzVkOC0zZWQzLTA0NDctOTM3ZS03NDI5MzM2ZTg2ODQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6YTZjZWM1ZDgtM2VkMy0wNDQ3LTkzN2UtNzQyOTMzNmU4Njg0IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YTZjZWM1ZDgtM2VkMy0wNDQ3LTkzN2UtNzQyOTMzNmU4Njg0Ij4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDphNmNlYzVkOC0zZWQzLTA0NDctOTM3ZS03NDI5MzM2ZTg2ODQiIHN0RXZ0OndoZW49IjIwMjEtMDMtMThUMDA6NDk6MTAtMDQ6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4xIChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5L/IQVAAAAS0lEQVQoka3RQQoAIAwDwVT8/5frSShoVgUDXpShkkZmCjIfo162C7DEoe0EQggkqZuvWOAmIXDomG8IF1dRlHOEVMTzchFSEbb6AaByDBtQJQehAAAAAElFTkSuQmCC","base64")}}drawFromPNGdata(e,t,i,r,n,s){if(void 0!==t)try{e.drawFromPNGdata(t,i,r,n,s)}catch(e){return}}getChannelStatus(e,t,i,r,n,s,a){let o;if(e&&e.width&&e.height){let c=e.width+"x"+e.height+`Ia${t}`+(null!==i?`b${i}`:"")+(null!==r?`c${r}`:"")+(null!==n?`d${n}`:"")+`e${s}`+(null!==a?`f${a}`:"");if(void 0===this.savedIcons[c]){let h=new l(e.width,e.height);null!==i?(this.drawFromPNGdata(h,this.AUDIO[t],59,13,4,42),this.drawFromPNGdata(h,this.AUDIO[i],65,13,4,42),this.drawFromPNGdata(h,this.MUTE[s],44,41,13,13)):(this.drawFromPNGdata(h,this.AUDIO[t],65,13,4,42),this.drawFromPNGdata(h,this.MUTE[s],49,41,13,13)),null!==r&&this.drawFromPNGdata(h,this.GATE[r],21,29,7,7),null!==n&&this.drawFromPNGdata(h,this.GATE[n],38,29,7,7),null!==a&&a>0&&this.drawFromPNGdata(h,this.DFR[a],4,41,37,13),o=h.toBase64(),this.savedIcons[c]=o}else o=this.savedIcons[c]}return o}getInputLevels(e,t,i,r,n,s,a,o,c,h){let u;if(e&&e.width&&e.height){let d=`${e.width}x${e.height}I${t}_${i}_${r}_${n}_${s}_${a}_${o}_${c}_${h}`;if(void 0===this.savedIcons[d]){let p=new l(e.width,e.height);this.drawFromPNGdata(p,this.AUDIO[t],6,14,4,42),this.drawFromPNGdata(p,this.AUDIO[i],13,14,4,42),this.drawFromPNGdata(p,this.AUDIO[r],20,14,4,42),this.drawFromPNGdata(p,this.AUDIO[n],27,14,4,42),this.drawFromPNGdata(p,this.AUDIO[s],34,14,4,42),this.drawFromPNGdata(p,this.AUDIO[a],41,14,4,42),this.drawFromPNGdata(p,this.AUDIO[o],48,14,4,42),this.drawFromPNGdata(p,this.AUDIO[c],55,14,4,42),this.drawFromPNGdata(p,this.AUDIO[h],62,14,4,42),u=p.toBase64(),this.savedIcons[d]=u}else u=this.savedIcons[d]}return u}getMixLevels(e,t,i,r,n,s,a){let o,c=`${e.width}x${e.height}ML${t}_${i}_${r}_${n}_${s}_${a}`;if(void 0===this.savedIcons[c]){let h=new l(e.width,e.height);this.drawFromPNGdata(h,this.AUDIO[t],28,14,4,42),this.drawFromPNGdata(h,this.AUDIO[i],38,14,4,42),this.drawFromPNGdata(h,this.LIMITER[r],11,31,7,7),this.drawFromPNGdata(h,this.LIMITER[n],54,31,7,7),this.drawFromPNGdata(h,this.MUTE[s],9,41,13,13),this.drawFromPNGdata(h,this.MUTE[a],52,41,13,13),o=h.toBase64(),this.savedIcons[c]=o}else o=this.savedIcons[c];return o}getMixStatus(e,t,i,r){let n;if(e&&e.width&&e.height){let s=`${e.width}x${e.height}MS${t}_${i}_${r}`;if(void 0===this.savedIcons[s]){let a=new l(e.width,e.height);this.drawFromPNGdata(a,this.AUDIO[t],65,13,4,42),this.drawFromPNGdata(a,this.LIMITER[i],51,29,7,7),this.drawFromPNGdata(a,this.MUTE[r],49,41,13,13),n=a.toBase64(),this.savedIcons[s]=n}else n=this.savedIcons[s]}return n}getOutputLevels(e,t,i,r,n,s,a,o,c){let h;if(e&&e.width&&e.height){let u=`${e.width}x${e.height}O${t}_${i}_${r}_${n}_${s}_${a}_${o}_${c}`;if(void 0===this.savedIcons[u]){let d=new l(e.width,e.height);this.drawFromPNGdata(d,this.AUDIO[t],10,14,4,42),this.drawFromPNGdata(d,this.AUDIO[i],17,14,4,42),this.drawFromPNGdata(d,this.AUDIO[r],24,14,4,42),this.drawFromPNGdata(d,this.AUDIO[n],31,14,4,42),this.drawFromPNGdata(d,this.AUDIO[s],38,14,4,42),this.drawFromPNGdata(d,this.AUDIO[a],45,14,4,42),this.drawFromPNGdata(d,this.AUDIO[o],52,14,4,42),this.drawFromPNGdata(d,this.AUDIO[c],59,14,4,42),h=d.toBase64(),this.savedIcons[u]=h}else h=this.savedIcons[u]}return h}}const u={1:"Channel 1",2:"Channel 2",3:"Channel 3",4:"Channel 4",5:"Channel 5",6:"Channel 6",7:"Channel 7",8:"Channel 8",9:"Aux In",10:"Direct Out 1",11:"Direct Out 2",12:"Direct Out 3",13:"Direct Out 4",14:"Direct Out 5",15:"Direct Out 6",16:"Direct Out 7",17:"Direct Out 8",18:"Mix A",19:"Mix B"};class d{constructor(e){this.instance=e,this.icons=new h(e),this.mixer={deviceId:"",autoLinkMode:"Unknown",meterRate:0},this.channels=[],this.dfrs=[]}getChannel(e){return void 0===this.channels[e]&&(this.channels[e]={prefix:e>=1&&e<=9?`in_${e}`:e>=10&&e<=17?"out_"+(e-9):18==e?"mix_a":"mix_b",name:u[e],audioGain:0,audioGain2:"+0 dB",audioMute:"OFF",alwaysOnA:"Unknown",alwaysOnB:"Unknown",intellimixMode:"Unknown",audioGateA:"OFF",audioGateB:"OFF",limiterEngaged:"OFF",audioClip:"OFF",audioLevel:0,audioBitmap:0}),this.channels[e]}getChannelIcon(e,t){let i,r,n,s,a,o,c=this.getChannel(e),l=this.getChannel(e+9);return i=c.audioBitmap,r=9==e?null:l.audioBitmap,n=9==e?null:c.audioGateA,s=9==e?null:c.audioGateB,a=c.audioMute,o=9==e?null:this.getDfr(1).assignedChan==e?1:this.getDfr(2).assignedChan==e?2:0,this.icons.getChannelStatus(t,i,r,n,s,a,o)}getDfr(e){return void 0===this.dfrs[e]&&(this.dfrs[e]={assignedChan:20,bypass:"Unknown",freeze:"Unknown"}),this.dfrs[e]}getInputLevelsIcon(e){return this.icons.getInputLevels(e,this.getChannel(1).audioBitmap,this.getChannel(2).audioBitmap,this.getChannel(3).audioBitmap,this.getChannel(4).audioBitmap,this.getChannel(5).audioBitmap,this.getChannel(6).audioBitmap,this.getChannel(7).audioBitmap,this.getChannel(8).audioBitmap,this.getChannel(9).audioBitmap)}getLevelBitmap(e,t){let i;return i=e>=-6?17:e>=-9?7:e>=-12?6:e>=-18?5:e>=-24?4:e>=-36?3:e>=-48?2:e>=-60?1:0,"ON"==t&&i<10&&(i+=10),i}getMixer(){return this.mixer}getMixerIcon(e,t){let i=this.getChannel(e);return this.icons.getMixStatus(t,i.audioBitmap,i.limiterEngaged,i.audioMute)}getMixerLevelsIcon(e){return this.icons.getMixLevels(e,this.getChannel(18).audioBitmap,this.getChannel(19).audioBitmap,this.getChannel(18).limiterEngaged,this.getChannel(19).limiterEngaged,this.getChannel(18).audioMute,this.getChannel(19).audioMute)}getOutputLevelsIcon(e){return this.icons.getOutputLevels(e,this.getChannel(10).audioBitmap,this.getChannel(11).audioBitmap,this.getChannel(12).audioBitmap,this.getChannel(13).audioBitmap,this.getChannel(14).audioBitmap,this.getChannel(15).audioBitmap,this.getChannel(16).audioBitmap,this.getChannel(17).audioBitmap)}parseSample(e){if(Array.isArray(e)){if(19!=e.length)return void console.log(`unexpected SAMPLE length response: ${e.length}`);for(let t=1;t<=e.length;t++){let i=this.getChannel(t);i.audioLevel=void 0===e[t-1]||isNaN(e[t-1])?i.audioLevel:parseInt(e[t-1],10)-120,i.audioBitmap=this.getLevelBitmap(i.audioLevel,i.audioClip)}}this.instance.checkFeedbacks("input_levels","output_levels","mixer_levels","channel_status","mixer_status")}updateChannel(e,t,i){let r=this.getChannel(e),n=r.prefix;"UNKN"!=i&&"UNKNOWN"!=i||(i="Unknown"),t.match(/AUDIO_GAIN/)?(r.audioGain=(parseInt(i)-1100)/10,r.audioGain2=(-110==r.audioGain?"-INF":r.audioGain.toString())+" dB",this.instance.setVariableValues({[`${n}_audio_gain`]:"units"==this.instance.config.variableFormat?r.audioGain2:r.audioGain}),this.instance.checkFeedbacks("input_levels","output_levels","mixer_levels","channel_status","mixer_status","audio_gain"),this.instance.recordScmAction("audio_gain",{channel:e,gain:r.audioGain},`audio_gain ${e}`)):"AUDIO_LEVEL"==t?(r.audioLevel=parseInt(i)-120,r.audioBitmap=this.getLevelBitmap(r.audioLevel,r.audioClip),this.instance.checkFeedbacks("input_levels","output_levels","mixer_levels","channel_status","mixer_status")):"AUDIO_MUTE"==t?(r.audioMute=i,this.instance.setVariableValues({[`${n}_audio_mute`]:i}),this.instance.checkFeedbacks("channel_status","mixer_status","audio_mute"),this.instance.recordScmAction("audio_mute",{channel:e,choice:r.audioMute},`audio_mute ${e}`)):"ALWAYS_ON_ENABLE_A"==t?(r.alwaysOnA=i,this.instance.setVariableValues({[`${n}_always_on_enable_a`]:i}),this.instance.checkFeedbacks("always_on_enable"),this.instance.recordScmAction("always_on_enable",{channel:e,mix:"A",choice:r.alwaysOnA},`always_on_enable A ${e}`)):"ALWAYS_ON_ENABLE_B"==t?(r.alwaysOnB=i,this.instance.setVariableValues({[`${n}_always_on_enable_b`]:i}),this.instance.checkFeedbacks("always_on_enable"),this.instance.recordScmAction("always_on_enable",{channel:e,mix:"B",choice:r.alwaysOnB},`always_on_enable B ${e}`)):"CHAN_NAME"==t?(r.name=i.trim(),this.instance.setVariableValues({[`${n}_name`]:r.name}),!0===this.initDone&&(this.instance.updateActions(),this.instance.updateFeedbacks()),(e<10||e>17)&&this.instance.recordScmAction("chan_name",{channel:e,name:r.name},`chan_name ${e}`)):"INTELLIMIX_MODE"==t?(r.intellimixMode=i,this.instance.setVariableValues({[`${n}_intellimix_mode`]:i}),this.instance.checkFeedbacks("mixer_status","intellimix_mode"),this.instance.recordScmAction("intellimix_mode",{channel:e,choice:r.intellimixMode},`intellimix_mode ${e}`)):"INPUT_AUDIO_GATE_A"==t?(r.audioGateA=i,this.instance.setVariableValues({[`${n}_input_audio_gate_a`]:i})):"INPUT_AUDIO_GATE_B"==t?(r.audioGateB=i,this.instance.setVariableValues({[`${n}_input_audio_gate_b`]:i})):"LIMITER_ENGAGED"==t?(r.limiterEngaged=i,this.instance.setVariableValues({[`${n}_limiter_engaged`]:i}),this.instance.checkFeedbacks("mixer_levels","mixer_status")):t.match(/_CLIP_INDICATOR/)&&(r.audioClip=i,this.instance.setVariableValues({[`${n}_clip_indicator`]:i}),this.instance.checkFeedbacks("input_levels","output_levels","mixer_levels","channel_status","mixer_status"))}updateDfr(e,t,i){let r=this.getDfr(e),n=`dfr${e}_`;"UNKN"!=i&&"UNKNOWN"!=i||(i="Unknown"),t.match(/_ASSIGNED_CHAN/)?(r.assignedChan=parseInt(i),this.instance.setVariableValues({[`${n}assigned_chan`]:r.assignedChan}),this.instance.checkFeedbacks("dfr_assigned_chan"),this.instance.recordScmAction("dfr_assigned_chan",{dfr:e,channel:r.assignedChan},`dfr_assigned_chan ${e}`)):t.match(/_BYPASS/)?(r.bypass=i,this.instance.setVariableValues({[`${n}bypass`]:r.bypass}),this.instance.checkFeedbacks("dfr_bypass"),this.instance.recordScmAction("dfr_bypass",{dfr:e,choice:r.bypass},`dfr_bypass ${e}`)):t.match(/_FREEZE/)&&(r.freeze=i,this.instance.setVariableValues({[`${n}freeze`]:r.freeze}),this.instance.checkFeedbacks("dfr_freeze"),this.instance.recordScmAction("dfr_freeze",{dfr:e,choice:r.freeze},`dfr_freeze ${e}`))}updateMixer(e,t){"UNKN"!=t&&"UNKNOWN"!=t||(t="Unknown"),"DEVICE_ID"==e?(this.mixer.deviceId=t.replace("{","").replace("}","").trim(),this.instance.setVariableValues({device_id:this.mixer.deviceId})):"AUTO_LINK_MODE"==e?(this.mixer.autoLinkMode=t,this.instance.setVariableValues({auto_link_mode:this.mixer.autoLinkMode}),this.instance.checkFeedbacks("auto_link_mode")):"METER_RATE"==e&&(this.mixer.meterRate=parseInt(t),this.instance.setVariableValues({meter_rate:this.mixer.meterRate.toString()+("units"==this.instance.config.variableFormat?" ms":"")}))}}class p extends e.InstanceBase{constructor(e){super(e),this.updateActions=n.bind(this),this.updateFeedbacks=s.bind(this),this.updateVariables=a.bind(this)}async configUpdated(e){let t,i=!1;(this.config.host!=e.bonjour_host?.split(":")[0]||e.host)&&(i=!0),this.config.meteringOn!==e.meteringOn?t=!0===e.meteringOn?"< SET METER_RATE "+this.config.meteringInterval+" >\r\n":"< SET METER_RATE 0 >\r\n":this.config.meteringRate!=e.meteringRate&&!0===this.config.meteringOn&&(t="< SET METER_RATE "+e.meteringInterval+" >\r\n"),this.config=e,this.config.host=e.bonjour_host?.split(":")[0]||e.host,this.config.port=e.bonjour_host?2202:e.port,this.updateActions(),this.updateFeedbacks(),this.updateVariables(),!0===i||void 0===this.socket?this.initTCP():void 0!==t&&this.socket.send(t)}async destroy(){void 0!==this.socket&&(this.socket.destroy(),delete this.socket,this.initDone=!1),void 0!==this.heartbeatInterval&&clearInterval(this.heartbeatInterval),void 0!==this.heartbeatTimeout&&clearTimeout(this.heartbeatTimeout),this.log("debug","destroy",this.id)}getConfigFields(){return[{type:"bonjour-device",id:"bonjour_host",label:"Bonjour Host",width:8,regex:e.Regex.HOSTNAME},{type:"textinput",id:"host",label:"Target IP",width:6,regex:e.Regex.IP,isVisible:e=>!e.bonjour_host},{type:"number",id:"port",label:"Target Port",default:2202,width:3,min:1,max:65534,isVisible:e=>!e.bonjour_host},{type:"checkbox",id:"meteringOn",label:"Enable Metering?",width:2,default:!0},{type:"number",id:"meteringInterval",label:"Metering Interval (in ms)",width:4,min:250,max:99999,default:1e3,required:!0},{type:"dropdown",id:"variableFormat",label:"Variable Format",choices:[{id:"units",label:"Include Units"},{id:"numeric",label:"Numeric Only"}],width:6,default:"units",tooltip:"Changing this setting will apply to new values received.  To refresh all variables with the new setting, disable and re-enable the connection after saving these settings."}]}async init(e){this.config=e,this.config.host=e.bonjour_host?.split(":")[0]||e.host,this.config.port=e.bonjour_host?2202:e.port,this.initDone=!1,this.heartbeatInterval=null,this.heartbeatTimeout=null,this.CHOICES_CHANNELS=[],this.CHOICES_CHANNELS_I=[],this.CHOICES_CHANNELS_IA=[],this.CHOICES_CHANNELS_IMU=[],this.CHOICES_CHANNELS_M=[],void 0===this.config.variableFormat&&(this.config.variableFormat="units"),this.updateStatus("disconnected","Connecting"),this.api=new d(this),this.setupFields(),this.updateActions(),this.updateVariables(),this.updateFeedbacks(),this.initTCP()}initTCP(){this.receiveBuffer="",void 0!==this.socket&&(this.socket.destroy(),delete this.socket,this.initDone=!1),void 0!==this.heartbeatInterval&&clearInterval(this.heartbeatInterval),void 0!==this.heartbeatTimeout&&clearTimeout(this.heartbeatTimeout),void 0===this.config.port&&(this.config.port=2202),this.config.host&&(this.socket=new e.TCPHelper(this.config.host,this.config.port),this.socket.on("status_change",((e,t)=>{this.updateStatus(e,t)})),this.socket.on("error",(e=>{this.log("error",`Network error: ${e.message}`)})),this.socket.on("connect",(()=>{this.log("debug","Connected");let e="< GET DEVICE_ID >\r\n";e+="< GET FLASH >\r\n",e+="< GET AUTO_LINK_MODE >\r\n",e+="< GET 0 AUDIO_GAIN_HI_RES >\r\n",e+="< GET 0 AUDIO_MUTE >\r\n",e+="< GET 0 CHAN_NAME >\r\n",e+="< GET 0 ALWAYS_ON_ENABLE_A >\r\n",e+="< GET 0 ALWAYS_ON_ENABLE_B >\r\n",e+="< GET 18 INTELLIMIX_MODE >\r\n",e+="< GET 19 INTELLIMIX_MODE >\r\n",e+="< GET DFR1_ASSIGNED_CHAN >\r\n",e+="< GET DFR2_ASSIGNED_CHAN >\r\n",e+="< GET DFR1_BYPASS >\r\n",e+="< GET DFR2_BYPASS >\r\n",e+="< GET DFR1_FREEZE >\r\n",e+="< GET DFR2_FREEZE >\r\n",e+="< GET 0 INPUT_AUDIO_GATE_A >\r\n",e+="< GET 0 INPUT_AUDIO_GATE_B >\r\n",e+="< GET 0 LIMITER_ENGAGED >\r\n",e+="< GET 0 AUDIO_IN_CLIP_INDICATOR >\r\n",e+="< GET 0 AUDIO_OUT_CLIP_INDICATOR >\r\n",!0===this.config.meteringOn&&(e+=`< SET METER_RATE ${this.config.meteringInterval} >\r\n`),this.socket.send(e),this.heartbeatInterval=setInterval((()=>{this.socket.send("< GET METER_RATE >")}),3e4),this.initDone=!0,this.updateActions(),this.updateFeedbacks()})),this.socket.on("data",(e=>{let t=0,i="",r=0;for(this.receiveBuffer+=e;-1!==(t=this.receiveBuffer.indexOf(">",r));)i=this.receiveBuffer.substr(r,t-r),r=t+1,this.socket.emit("receiveline",i.toString());this.receiveBuffer=this.receiveBuffer.substr(r)})),this.socket.on("receiveline",(e=>{this.processShureCommand(e.replace("< ","").trim()),e.match(/METER_RATE/)&&(void 0!==this.heartbeatTimeout&&clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=setTimeout(this.initTCP.bind(this),6e4))})))}processShureCommand(e){if(("string"==typeof e||e instanceof String)&&e.length>0){let t=e.split(" "),i=t.shift(),r=parseInt(t[0]);if("REP"==i)if(t[0].match(/DFR1/))this.api.updateDfr(1,t[0],t[1]);else if(t[0].match(/DFR2/))this.api.updateDfr(2,t[0],t[1]);else if(isNaN(r))this.api.updateMixer(t[0],t[1]);else if("CHAN_NAME"==t[1]){let i=e.split("{");if(i=null!=i[1]?i[1].split("}"):void 0,void 0===i[0])return;this.api.updateChannel(r,t[1],i[0])}else this.api.updateChannel(r,t[1],t[2]);else"SAMPLE"==i&&this.api.parseSample(t)}}sendCommand(e){void 0!==e&&(void 0!==this.socket&&this.socket.isConnected?this.socket.send(`< ${e} >\r\n`):this.log("debug","Socket not connected :("))}setupChannelChoices(){let e;this.CHOICES_CHANNELS=[],this.CHOICES_CHANNELS_I=[],this.CHOICES_CHANNELS_IA=[],this.CHOICES_CHANNELS_IMU=[],this.CHOICES_CHANNELS_M=[];for(let t=1;t<=8;t++)e=`Channel ${t}`,""!=this.api.getChannel(t).name&&this.api.getChannel(t).name!==e&&(e+=` (${this.api.getChannel(t).name})`),this.CHOICES_CHANNELS.push({id:t,label:e}),this.CHOICES_CHANNELS_I.push({id:t,label:e}),this.CHOICES_CHANNELS_IA.push({id:t,label:e}),this.CHOICES_CHANNELS_IMU.push({id:t,label:e});e="Aux In",""!=this.api.getChannel(9).name&&this.api.getChannel(9).name!==e&&(e+=` (${this.api.getChannel(9).name})`),this.CHOICES_CHANNELS.push({id:9,label:e}),this.CHOICES_CHANNELS_IA.push({id:9,label:e}),e="Mix A",""!=this.api.getChannel(18).name&&this.api.getChannel(18).name!==e&&(e+=` (${this.api.getChannel(18).name})`),this.CHOICES_CHANNELS.push({id:18,label:e}),this.CHOICES_CHANNELS_IMU.push({id:18,label:e}),this.CHOICES_CHANNELS_M.push({id:18,label:e}),e="Mix B",""!=this.api.getChannel(19).name&&this.api.getChannel(19).name!==e&&(e+=` (${this.api.getChannel(19).name})`),this.CHOICES_CHANNELS.push({id:19,label:e}),this.CHOICES_CHANNELS_IMU.push({id:19,label:e}),this.CHOICES_CHANNELS_M.push({id:19,label:e}),this.CHOICES_CHANNELS_IMU.push({id:20,label:"Unassigned"})}setupFields(){this.CHANNELS_FIELD=function(e="IAM"){let t={type:"dropdown",label:"Channel",id:"channel",default:"1"};return"IAM"==e?t.choices=this.CHOICES_CHANNELS:"I"==e?t.choices=this.CHOICES_CHANNELS_I:"IA"==e?t.choices=this.CHOICES_CHANNELS_IA:"IMU"==e?t.choices=this.CHOICES_CHANNELS_IMU:"M"==e&&(t.choices=this.CHOICES_CHANNELS_M,t.default="18"),t}}handleStartStopRecordActions(e){this.isRecordingActions=e}recordScmAction(e,t,i){this.isRecordingActions&&this.recordAction({actionId:e,options:t},i)}}(0,e.runEntrypoint)(p,[(0,e.CreateConvertToBooleanFeedbackUpgradeScript)({audio_mute:!0,audio_gain:!0,always_on_enable:!0,intellimix_mode:!0,dfr_assigned_chan:!0,dfr_bypass:!0,dfr_freeze:!0,auto_link_mode:!0})])})()})();